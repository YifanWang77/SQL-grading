submission_id,submitted_answer,submission_time,exercise_id,is_correct,student_id,category
1409,"SELECT SUM(first_name)
FROM person 
WHERE year_born == 1935;
",2018-08-22 09:03:34.219155+10,1,0,240,noninterpretable
53,"SELECT COUNT(*) FROM (SELECT DISTINCT person.id FROM person,writer
WHERE person.id=writer.id AND person.year_born=1935);",2018-08-10 12:31:49.231881+10,1,1,12,correct
54,"SELECT COUNT(*) FROM (SELECT DISTINCT person.id FROM person,writer
WHERE person.id=writer.id AND person.year_born=1935);",2018-08-10 12:32:19.970559+10,1,1,12,correct
55,"SELECT COUNT(*) FROM (SELECT person.id FROM person,writer
WHERE person.id=writer.id AND person.year_born=1935);",2018-08-10 12:35:12.280294+10,1,0,12,partially correct
56,"SELECT production_year, COUNT(*) FROM movie 
WHERE production_year>=1991 AND production_year<=1993
GROUP BY production_year;",2018-08-10 12:48:24.607193+10,2,1,12,correct
57,"SELECT COUNT(*) FROM person
WHERE person.id NOT IN 
(SELECT director.id FROM director);",2018-08-10 12:51:54.063001+10,12,1,12,correct
58,"SELECT p.id, p.first_name, p.last_name FROM person p 
WHERE p.id IN
(SELECT d.id FROM director d, writer w
WHERE d.id=w.id AND d.title=w.title AND d.production_year=w.production_year
GROUP BY d.id
HAVING COUNT(*)>=2);",2018-08-10 13:01:57.66289+10,4,1,12,correct
59,"SELECT mw.title, mw.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS mw
WHERE mw.first_name='Kevin' AND mw.last_name='Williamson';",2018-08-10 13:08:43.24407+10,5,1,12,correct
60,"SELECT country FROM restriction
WHERE LOWER(title)='shakespeare in love' AND description='M';",2018-08-10 14:56:33.969809+10,6,1,12,correct
61,"SELECT id, first_name, last_name FROM person
WHERE year_born= (SELECT MAX(year_born) FROM person);
",2018-08-10 14:59:15.472475+10,7,1,12,correct
62,"SELECT title, production_year, first_name, last_name FROM (movie_award NATURAL JOIN director NATURAL JOIN person)
WHERE LOWER(award_name)='bafta film award' AND LOWER(category)='best film' AND LOWER(result)='won';",2018-08-10 15:05:45.500574+10,8,1,12,correct
63,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person 
WHERE 
	LOWER(first_name)='woody' 
	AND LOWER(last_name)='allen' 
	AND LOWER(result)='won' 
	AND year_of_award>=1991 
	AND year_of_award<=1995;",2018-08-10 15:12:38.825937+10,9,1,12,correct
64,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person 
WHERE 
	LOWER(first_name)='woody' 
	AND LOWER(last_name)='allen' 
	AND LOWER(result)='won';",2018-08-10 15:12:55.933048+10,9,1,12,correct
65,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person 
WHERE 
	LOWER(first_name)='woody' 
	AND LOWER(last_name)='allen';",2018-08-10 15:13:06.079342+10,9,0,12,partially correct
66,"SELECT id FROM role NATURAL JOIN appearance
WHERE LOWER(title)='psycho' AND production_year=1960
GROUP BY id
HAVING COUNT(*)=1
EXCEPT
SELECT id FROM role NATURAL JOIN appearance
WHERE LOWER(title)!='psycho';
",2018-08-10 15:24:56.660332+10,10,0,12,partially correct
67,"SELECT id FROM role NATURAL JOIN appearance
WHERE LOWER(title)='psycho' AND production_year=1960
GROUP BY id
HAVING COUNT(*)=1;
",2018-08-10 15:25:14.53488+10,10,1,12,correct
68,"SELECT title, production_year FROM movie
EXCEPT
SELECT title, production_year FROM movie_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM crew_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM director_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM writer_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM actor_award WHERE LOWER(result)='won';",2018-08-10 15:30:59.995148+10,11,0,12,partially correct
69,"SELECT COUNT(*) FROM (
SELECT title, production_year FROM movie
EXCEPT
SELECT title, production_year FROM movie_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM crew_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM director_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM writer_award WHERE LOWER(result)='won'
EXCEPT
SELECT title, production_year FROM actor_award WHERE LOWER(result)='won');",2018-08-10 15:31:45.672595+10,11,1,12,correct
70,"SELECT id FROM person
WHERE year_born = 
	(SELECT MAX(year_born) FROM
		(SELECT id, year_born FROM person
		WHERE year_born!=(SELECT MAX(year_born) FROM person)) AS t1);

",2018-08-10 15:39:52.082944+10,3,1,12,correct
71,"SELECT id, award_name, year_of_award, category FROM director_award NATURAL JOIN director
WHERE id IN (
	SELECT id FROM director_award NATURAL JOIN director
	WHERE lower(result)='nominated'
	EXCEPT
	SELECT id FROM director_award NATURAL JOIN director
	WHERE lower(result)='won');",2018-08-10 15:49:06.016302+10,13,1,12,correct
72,"SELECT t1.id FROM 
	(SELECT id, COUNT(*) AS num FROM
	  (SELECT id, title, production_year FROM director
	  UNION
	  SELECT id, title, production_year FROM writer)
	GROUP BY id) as t1
WHERE t1.num=
  (SELECT MAX(num) FROM
	(SELECT id, COUNT(*) AS num FROM
	  (SELECT id, title, production_year FROM director
	  UNION
	  SELECT id, title, production_year FROM writer)
	GROUP BY id));",2018-08-10 16:09:30.925353+10,14,1,12,correct
73,"SELECT first_name, last_name, description FROM
role NATURAL JOIN person
WHERE id=
(SELECT id FROM
	(SELECT id, COUNT(*) AS num FROM role
	GROUP BY id)
WHERE num=
	(SELECT MAX(num) FROM
		(SELECT id, COUNT(*) AS num FROM role
		GROUP BY id)));

",2018-08-10 16:25:39.381005+10,15,0,12,partially correct
74,"SELECT first_name, last_name, title, production_year, description FROM
role NATURAL JOIN person
WHERE id=
(SELECT id FROM
	(SELECT id, COUNT(*) AS num FROM role
	GROUP BY id)
WHERE num=
	(SELECT MAX(num) FROM
		(SELECT id, COUNT(*) AS num FROM role
		GROUP BY id)));

",2018-08-10 16:26:42.70713+10,15,1,12,correct
75,"SELECT first_name, last_name, description FROM
role NATURAL JOIN person
WHERE id=
(SELECT id FROM
	(SELECT id, COUNT(*) AS num FROM role
	GROUP BY id)
WHERE num=
	(SELECT MAX(num) FROM
		(SELECT id, COUNT(*) AS num FROM role
		GROUP BY id)));

",2018-08-10 16:27:02.037079+10,15,0,12,partially correct
76,"SELECT first_name, last_name, title, production_year, description FROM
role NATURAL JOIN person
WHERE id=
(SELECT id FROM
	(SELECT id, COUNT(*) AS num FROM role
	GROUP BY id)
WHERE num=
	(SELECT MAX(num) FROM
		(SELECT id, COUNT(*) AS num FROM role
		GROUP BY id)));

",2018-08-10 16:27:21.668076+10,15,1,12,correct
79,SELECT * FROM writer;,2018-08-11 16:18:54.424825+10,1,0,21,partially correct
80,"SELECT count(*)
FROM Person
WHERE EXISTS (SELECT * FROM Writer WHERE Writer.id = Person.id AND Person.year_born = 1935);",2018-08-11 16:20:46.592316+10,1,1,21,correct
9587,;,2018-08-31 09:48:01.189289+10,8,0,417,noninterpretable
81,"SELECT Movie.production_year,count(*) FROM Movie
WHERE Movie.production_year=1993 OR
Movie.production_year=1992 OR
Movie.production_year=1991;",2018-08-11 16:25:50.140689+10,2,0,21,partially correct
82,"SELECT production_year,count(*) FROM Movie
WHERE production_year=1993 OR
production_year=1992 OR
production_year=1991
GROUP BY production_year;",2018-08-11 16:27:00.217577+10,2,1,21,correct
83,"SELECT count(*)
FROM Person
WHERE NOT EXISTS (SELECT * FROM Director);",2018-08-11 16:29:34.861376+10,12,0,21,partially correct
84,"SELECT count(*)
FROM Person
WHERE NOT EXISTS (SELECT * FROM Director WHERE Person.id=Director.id);",2018-08-11 16:30:19.525304+10,12,1,21,correct
85,"SELECT COUNT(*) FROM writer INNER JOIN person
USING(id)
WHERE year_born = 1935;",2018-08-11 16:52:22.230862+10,1,0,25,partially correct
86,"SELECT COUNT(*) FROM writer INNER JOIN person
USING(id)
WHERE year_born = 1935;",2018-08-11 16:52:34.777523+10,1,0,25,partially correct
87,SELECT * FROM movie;,2018-08-11 16:55:40.914418+10,1,0,25,partially correct
88,"SELECT COUNT(*) FROM writer INNER JOIN person
USING(id)
WHERE year_born = 1935;",2018-08-11 16:55:52.370821+10,1,0,25,partially correct
89,"SELECT * FROM person INNER JOIN writer
USING id;",2018-08-11 17:01:59.820065+10,1,0,25,noninterpretable
90,"select count(*)
from Writer natural join Person
where year_born='1935';",2018-08-11 17:09:37.776617+10,1,0,28,partially correct
91,"select m.production_year, count(*)
from Movie m 
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-11 17:16:28.423854+10,2,1,28,correct
92,"SELECT * FROM person INNER JOIN writer
USING (id)

GROUP BY writer.id
HAVING year_born = 1935;
",2018-08-11 17:19:21.977222+10,1,0,25,partially correct
93,"select d.id, p.first_name,p.last_name
from director d natural join writer w natural join person p
where d.id=w.id
group by d.id having count(*)>=2;",2018-08-11 17:35:17.163716+10,4,1,28,correct
94,"SELECT first_name, last_name 
FROM person p INNER JOIN writer w
ON w.id = p.id
WHERE p.year_born = 1935;",2018-08-11 17:37:42.211264+10,1,0,25,partially correct
95,"select r.country 
from restriction r
where r.title = 'Shakespeare in Love' and r.description ='M';",2018-08-11 17:47:31.654574+10,6,1,28,correct
96,"select id,first_name,last_name 
from person 
order by year_born ASC
limit 1;",2018-08-11 17:48:44.562361+10,7,0,28,partially correct
97,"select id,first_name,last_name,year_born
from person 
order by year_born DESC;",2018-08-11 17:50:20.025346+10,7,0,28,partially correct
98,"select id,first_name,last_name
from person 
order by year_born DESC;",2018-08-11 17:50:29.339212+10,7,0,28,partially correct
99,"select id,first_name,last_name
from person 
order by year_born DESC
limit 1;",2018-08-11 17:50:41.080856+10,7,1,28,correct
100,"select m.title,m.production_year,first_name,last_name
from movie m natural join director d natural join person p natural join movie_award a
where award_name = 'BAFTA Film Award' and category = 'best film';
",2018-08-11 17:57:10.410871+10,8,0,28,partially correct
101,"select count(*)
from writer w natural join person p natural join writer_award a
where first_name is 'Woody' and last_name = 'Allen';",2018-08-11 18:07:50.652884+10,9,0,28,partially correct
102,"select count(*)
from writer w natural join person p natural join writer_award a
where first_name = 'Woody' and last_name = 'Allen' and year_of_award>='1991' and year_of_award<=1995 and result ='won';",2018-08-11 18:10:02.104604+10,9,1,28,correct
103,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-11 18:12:22.092287+10,1,1,28,correct
104,"select count (*)
from director natural join person p
where p.id not in(
select p.id
from director d natural join movie natural join person p);",2018-08-11 18:20:32.511802+10,12,0,28,partially correct
105,"select count (*)
from person p
where p.id not in(
select p.id
from director d natural join movie natural join person p);",2018-08-11 18:21:05.861382+10,12,1,28,correct
106,"select m.title, m.production_year
from movie m natural join writer natural join person
where first_name = 'Kevin' and last_name ='Williamson';",2018-08-11 18:23:19.893221+10,5,1,28,correct
107,"select m.title,m.production_year,first_name,last_name
from movie m natural join director d natural join person p natural join movie_award a
where award_name = 'BAFTA Film Award' and category = 'best film' and result='won';
",2018-08-11 18:24:16.71004+10,8,1,28,correct
108,"SELECT COUNT(*) FROM person 
WHERE EXISTS (SELECT * FROM writer 
			WHERE person.id = writer.id
			AND year_born = 1935);",2018-08-11 18:47:48.213581+10,1,1,25,correct
109,SELECT COUNT(*) FROM writer LEFT JOIN person on person.id = writer.id WHERE year_born = 1935;,2018-08-11 19:00:30.788341+10,1,0,39,partially correct
110,SELECT COUNT(DISTINCT person.id) FROM writer LEFT JOIN person on person.id = writer.id WHERE year_born = 1935;,2018-08-11 19:11:03.714388+10,1,1,39,correct
111,"select id
from person
where id ='00000842';",2018-08-11 20:14:31.606437+10,3,0,28,cheating
112,"SELECT COUNT(id) from PERSON
where year_born > 1935;
",2018-08-11 20:26:11.125072+10,1,0,45,partially correct
113,"SELECT COUNT(id) from PERSON
where year_born = 1935;
",2018-08-11 20:28:40.685777+10,1,0,45,partially correct
114,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-11 20:32:12.944035+10,1,1,45,correct
115,"SELECT count(title) FROM Movie
WHERE production_year = 1991 or 1992 or 1993;",2018-08-11 20:35:47.454462+10,2,0,45,partially correct
116,"select count(w.id)
from person as p
inner join writer as w
on w.id = p.id
where p.year_born = '1935';",2018-08-11 21:29:18.387495+10,1,0,43,partially correct
117,"WITH m1 AS (SELECT DISTINCT COUNT(title) a FROM movie
		WHERE production_year = 1993),
		m2 AS (SELECT DISTINCT COUNT(title) b FROM movie
		WHERE production_year = 1992),
		m3 AS (SELECT DISTINCT COUNT(title) c FROM movie
		WHERE production_year = 1991)
		SELECT (SELECT a FROM m1) + (SELECT B FROM m2) + (SELECT c FROM m3);",2018-08-11 21:32:42.471167+10,2,0,25,partially correct
118,"SELECT production_year, count(*) FROM movie
WHERE production_year >= 1993 AND production_year <= 1991
GROUP BY title;",2018-08-11 21:37:09.17679+10,2,0,25,partially correct
119,"SELECT production_year, count(*) FROM movie
WHERE production_year <= 1993 AND production_year >= 1991
GROUP BY production_year;",2018-08-11 21:38:28.042428+10,2,1,25,correct
120,"SELECT DISTINCT COUNT(p.id) FROM person p 
WHERE p.id NOT IN (SELECT d.id FROM director d)
;",2018-08-11 21:53:02.460629+10,12,1,25,correct
121,"SELECT p.id, p.first_name, p.last_name FROM person p INNER JOIN director d
USING(id)
INNER JOIN writer w
USING(id)
WHERE d.id = w.id
GROUP BY d.id
HAVING COUNT(d.title) > 2
;",2018-08-11 22:02:23.418915+10,4,1,25,correct
122,"SELECT m.title, m.production_year FROM movie m INNER JOIN writer w
ON m.title = w.title
INNER JOIN person p 
USING(ID)
WHERE first_name = 'Kevin'
AND last_name = 'Williamson';",2018-08-11 22:10:40.105947+10,5,1,25,correct
123,"SELECT distinct R.country FROM restriction R InNER JOIN movie M 
USING (title)
WHERE description = 'M'
GROUP BY title
;
",2018-08-11 22:20:54.481831+10,6,0,25,partially correct
124,"select production_year,count(*)
from movie
where production_year in (select production_year
	from movie 
	where production_year >= 1991 and production_year < 1993);",2018-08-11 22:24:47.044918+10,2,0,43,partially correct
125,"select production_year,count(*)
from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-11 22:25:56.314934+10,2,1,43,correct
126,"select count(*)
from person p
where not exists (select * 
			from director d
			where p.id = d.id );",2018-08-11 22:28:36.566707+10,12,1,43,correct
127,"select p.id,p.first_name,p.last_name
from person p); ",2018-08-11 22:37:37.330817+10,4,0,43,noninterpretable
128,SELECT COUNT(p.ID) FROM PERSON p NATURAL JOIN WRITER w WHERE p.ID = w.ID AND p.year_born = 1935;,2018-08-11 22:41:18.199428+10,1,0,38,partially correct
129,SELECT COUNT(*) FROM PERSON p NATURAL JOIN WRITER w WHERE p.ID = w.ID AND p.year_born = 1935;,2018-08-11 22:45:32.668863+10,1,0,38,partially correct
130,"select haha.title,haha.production_year
from (writer w natural join person p) as haha
where haha.first_name = 'Kevin' and haha.last_name = 'Williamson';",2018-08-11 22:46:40.60636+10,5,1,43,correct
131,"SELECT country FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-11 22:49:00.497773+10,6,1,25,correct
132,"select country
from restriction
where country in (select country
		from restriction
		where title = 'Shakespeare' and description = 'M');",2018-08-11 22:52:33.90496+10,6,0,43,partially correct
133,"SELECT p.id,p.first_name,p.last_name FROM person p
WHERE year_born = (SELECT MIN(year_born) FROM person);",2018-08-11 22:53:04.30219+10,7,0,25,partially correct
134,"select id,first_name,last_name
from person
group by year_born
order by year_born Desc
limit 1;",2018-08-11 22:57:00.060514+10,7,1,43,correct
135,"SELECT p.id,p.first_name,p.last_name FROM person p
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-11 23:01:19.756611+10,7,1,25,correct
136,"SELECT m.title, m.production_year,p.first_name,p.last_name FROM person p INNER JOIN director d
USING(id)
INNER JOIN movie_award
USING(title)
INNER JOIN movie m
USING(title)
WHERE award_name = 'BAFTA Film Award'
AND category = 'best film';",2018-08-11 23:15:02.757415+10,8,0,25,partially correct
137,"SELECT m.title, m.production_year,p.first_name,p.last_name FROM person p INNER JOIN director d
USING(id)
INNER JOIN movie_award m
USING(title)
WHERE award_name = 'BAFTA Film Award'
AND category = 'best film';",2018-08-11 23:17:11.935621+10,8,0,25,partially correct
138,"SELECT m.title, m.production_year,p.first_name,p.last_name FROM person p INNER JOIN director d
USING(id)
INNER JOIN movie_award ma
USING(title)
INNER JOIN movie m
USING(title)
WHERE award_name = 'BAFTA Film Award'
AND category = 'Best Film';",2018-08-11 23:18:33.894823+10,8,0,25,partially correct
139,"SELECT ma.title,ma.production_year,p.first_name,p.last_name FROM person p INNER JOIN director
USING(id)
INNER JOIN movie_award ma
USING
(production_year)
WHERE award_name = 'BAFTA Film Award'
AND category = 'Best Film';",2018-08-11 23:23:52.65696+10,8,0,25,partially correct
140,"SELECT COUNT(p.ID) FROM person p WHERE EXISTS 
	(SELECT 1 FROM writer w WHERE p.ID = w.ID AND p.year_born = 1935);",2018-08-12 00:29:26.834063+10,1,1,38,correct
141,"SELECT movie_award.title FROM movie_award INNER JOIN restriction
USING(production_year)
WHERE result = 'won'
AND award_name = 'BAFTA Film Award'
AND category = 'Best Film';",2018-08-12 10:29:37.766022+10,8,0,25,partially correct
142,"SELECT COUNT(W.id), P.year_born
FROM PERSON AS P, WRITER AS W
WHERE P.year_born = '1935'

;",2018-08-12 10:37:56.047581+10,1,0,55,partially correct
143,"SELECT ma.title,ma.production_year,p.first_name,p.last_name 
FROM (SELECT title, production_year FROM movie_award
	WHERE lower(award_name) = 'bafta film award'
	AND lower(category) = 'best film') ma INNER JOIN director d
							ON d.production_year = ma.production_year AND d.title = ma.title
							INNER JOIN person p
							ON p.id = d.id;",2018-08-12 10:54:14.319083+10,8,0,25,partially correct
144,"select h.title,h.production_year,h.first_name,h.last_name
from (person p natural join director d natural join movie_award m) as h
where lower(h.award_name) = 'bafta film award' and lower(h.category) = 'best film';
",2018-08-12 12:09:20.935069+10,8,0,43,partially correct
145,"select h.title,h.production_year,h.first_name,h.last_name
from (person p natural join director d natural join movie_award m) as h
where lower(h.award_name) = 'bafta film award' and lower(h.category) = 'best film' and lower(h.result) = 'won';
",2018-08-12 12:12:06.290148+10,8,1,43,correct
146,"select count(*)
from writer_award wa inner join
	person p 
where wa.id = p.id and
 lower(p.first_name) = 'woody' and 
	lower(p.last_name) = 'allen' and
	wa.production_year in (1991,1992,1993,1994,1995);",2018-08-12 12:33:23.907826+10,9,1,43,correct
147,"SELECT id FROM PERSON
WHERE [year_born] = 1935;
",2018-08-12 12:51:36.518835+10,1,0,49,partially correct
148,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-12 12:57:52.012281+10,1,1,49,correct
149,"SELECT count(*)
FROM movie m 
WHERE EXISTS (SELECT production_year FROM movie WHERE 1991 <production_year<1993 );",2018-08-12 13:13:59.790818+10,2,0,49,partially correct
150,"SELECT ma.title,ma.production_year,p.first_name,p.last_name FROM 
											(SELECT title,production_year FROM movie_award
											WHERE LOWER(result) = 'won'
											AND LOWER(award_name) = 'bafta film award'
											AND LOWER(category) = 'best film') ma
											INNER JOIN director d 
											ON d.title = ma.title AND  d.production_year = ma.production_year
											INNER JOIN person p
											ON p.id = d.id;",2018-08-12 14:47:02.151477+10,8,1,25,correct
151,"SELECT count(*) FROM writer w INNER JOIN person p
USING(id)
INNER JOIN writer_award
USING(id,title,production_year)
WHERE year_of_award >= 1991 AND year_of_award <= 1995
AND result = 'won'
AND lower(first_name) = 'woody' AND lower(last_name) = 'allen';",2018-08-12 15:04:39.694712+10,9,1,25,correct
152,"
	
	SELECT DISTINCT COUNT(title) FROM movie
	WHERE title NOT IN (SELECT title FROM movie_award
					UNION
					SELECT title FROM writer_award
					UNION
					SELECT title FROM crew_award
					UNION
					SELECT title FROM director_award
					UNION
					SELECT title FROM actor_award);",2018-08-12 17:01:24.924839+10,11,0,25,partially correct
153,"
	
	SELECT DISTINCT COUNT(title) FROM movie
	WHERE title NOT IN (SELECT title FROM movie_award
					UNION
					SELECT title FROM writer_award
					UNION
					SELECT title FROM crew_award
					UNION
					SELECT title FROM director_award
					UNION
					SELECT title FROM actor_award);",2018-08-12 17:01:35.479303+10,11,0,25,partially correct
154,"SELECT COUNT(*) AS writersBorn1935
FROM (writer w NATURAL JOIN person p) writers
WHERE p.year_born = 1935;",2018-08-12 17:09:04.347134+10,1,0,56,partially correct
155,"SELECT m.production_year, COUNT(*)
FROM movie m
WHERE m.production_year IN (1993, 1992, 1991)
GROUP BY m.production_year;",2018-08-12 17:28:38.807426+10,2,1,56,correct
156,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year
ORDER BY production_year DESC;",2018-08-12 17:29:18.84775+10,2,1,49,correct
157,"SELECT count(title) FROM movie
	WHERE title NOT IN 




(SELECT title FROM movie_award);",2018-08-12 17:29:36.444732+10,11,0,25,partially correct
158,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w
			WHERE p.id = w.id
			AND p.year_born = 1935);",2018-08-12 17:45:34.090245+10,1,1,56,correct
159,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN (SELECT d.id FROM director d);",2018-08-12 17:48:52.050936+10,12,1,56,correct
160,"SELECT count(title) FROM movie
	WHERE title NOT IN 
					(SELECT title FROM movie_award
					UNION
					SELECT title FROM writer_award
					UNION
					SELECT title FROM crew_award
					UNION
					SELECT title FROM director_award
					UNION
					SELECT title FROM actor_award);


",2018-08-12 17:57:51.077872+10,11,0,25,partially correct
161,"SELECT count(*) FROM movie
	WHERE title NOT IN 
					(SELECT title FROM movie_award
					WHERE lower(result) = 'won'
					UNION
					SELECT title FROM writer_award
					WHERE lower(result) = 'won'
					UNION
					SELECT title FROM crew_award
					WHERE lower(result) = 'won'
					UNION
					SELECT title FROM director_award
					WHERE lower(result) = 'won'
					UNION
					SELECT title FROM actor_award
					WHERE lower(result) = 'won');
",2018-08-12 19:01:03.626884+10,11,0,25,partially correct
162,SELECT COUNT(*) FROM person WHERE year_born = 1935;,2018-08-12 20:14:57.946042+10,1,0,69,partially correct
163,"SELECT COUNT(*) FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-12 20:28:16.418559+10,1,1,69,correct
164,SELECT COUNT(*) FROM movie m WHERE m.production_year = 1993 OR  m.production_year = 1992 OR m.production_year = 1991;,2018-08-12 20:31:05.505491+10,2,0,69,partially correct
165,"SELECT COUNT(*) FROM movie m WHERE m.production_year IN (1993,1992,1991);",2018-08-12 20:31:48.024731+10,2,0,69,partially correct
166,"SELECT production_year, count(*) FROM movie WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-12 20:39:31.176388+10,2,1,69,correct
167,SELECT count(*) FROM person p WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);,2018-08-12 20:45:57.846334+10,12,1,69,correct
168,"SELECT id, first_name, last_name FROM person p 
	WHERE EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-12 21:00:21.819207+10,4,0,69,partially correct
169,select * from scene;,2018-08-12 21:51:10.206238+10,10,0,43,partially correct
170,"select count(*)
from movie
where not exists (select *
			from movie_award natural join crew_award natural join director_award 
				natural join writer_award natural join actor_award natural join movie);",2018-08-12 21:59:49.360167+10,11,0,43,partially correct
171,"select *
from person p 
limit (1);",2018-08-12 22:14:50.465517+10,3,0,43,partially correct
358,SELECT COUNT(*) FROM person WHERE NOT EXISTS( SELECT * FROM director WHERE person.id=director.id);,2018-08-14 21:59:17.228+10,12,1,100,correct
172,"SELECT dw.id, dw.first_name, dw.last_name FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw
	GROUP BY dw.id
	HAVING COUNT(*) > 1;",2018-08-12 22:18:13.078619+10,4,1,69,correct
173,"SELECT title, production_year FROM (movie m NATURAL JOIN person p) WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-12 22:23:01.309167+10,5,0,69,partially correct
174,"select *
from director_award d;",2018-08-12 22:25:30.760438+10,13,0,43,partially correct
175,"select * 
form movie
limit 1;",2018-08-12 22:29:24.256625+10,14,0,43,noninterpretable
179,"Select Count(distinct w.id) from
Person p
Inner Join
Writer w
On p.id = w.id
where p.year_born = '1935';
",2018-08-12 22:46:45.981084+10,1,1,71,correct
180,"SELECT mw.title, mw.production_year FROM (writer w NATURAL JOIN person p) AS mw 
	WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-12 22:48:30.014202+10,5,1,69,correct
181,"Select production_year, Count(production_year)  from movie
where production_year = '1991' or production_year = '1992' or production_year = '1993'
Group By production_year;",2018-08-12 22:54:05.933847+10,2,1,71,correct
182,"Select count(person) from
Person
Left Outer Join
Director;",2018-08-12 22:57:36.652252+10,12,0,71,noninterpretable
183,"Select count(distinct p.id) from
Person p
Left Outer Join
Director d; ",2018-08-12 22:58:29.321246+10,12,0,71,partially correct
184,"Select count(distinct p.id) from
Person p
where not exists(Select id from Director d where p.id = d.id);",2018-08-12 23:01:43.703845+10,12,1,71,correct
185,SELECT country FROM restriction WHERE title = 'Shakespeare in Love' AND description = 'M';,2018-08-12 23:02:18.410328+10,6,1,69,correct
186,"SELECT id, first_name, last_name FROM person
ORDER BY year_born ASC
LIMIT 1;",2018-08-12 23:04:37.675153+10,7,0,69,partially correct
187,"SELECT id, first_name, last_name FROM person
ORDER BY year_born DESC
LIMIT 1;",2018-08-12 23:04:56.625071+10,7,1,69,correct
188,"SELECT title, production_year, first_name, last_name FROM (movie m NATURAL JOIN director d NATURAL JOIN movie_award a NATURAL JOIN person p)
	WHERE a.award_name = 'BAFTA Film Award' AND a.category = 'Best Film' AND p.id = d.id;",2018-08-12 23:24:08.455399+10,8,0,69,partially correct
189,"SELECT COUNT(*) 
FROM PERSON p 
WHERE EXISTS
            (SELECT *
			FROM WRITER w
		   WHERE w.id=p.id
		    GROUP BY w.id
		     HAVING year_born=1935);",2018-08-13 00:46:58.126921+10,1,1,67,correct
190,"SELECT production_year,COUNT(*)
     FROM MOVIE
	 WHERE production_year<=1993 AND production_year>=1991
	 GROUP BY production_year;",2018-08-13 00:58:47.992877+10,2,1,67,correct
191,"SELECT COUNT(*)
   FROM PERSON p
   WHERE NOT EXISTS
          (SELECT *
		  FROM DIRECTOR d
		   WHERE p.id=d.id
		  );",2018-08-13 01:10:58.745008+10,12,1,67,correct
192,SELECT COUNT(id) FROM PERSON WHERE year_born == 1935;,2018-08-13 09:43:44.083106+10,1,0,78,noninterpretable
193,"select count(*)
from writer
where production_y
ear=1935;",2018-08-13 09:57:07.122313+10,1,0,79,noninterpretable
194,"Select production_year, count(*)
from movie m
where exists (m.production_year=1993 or m.production_year=1992 or m.production_year=1991);",2018-08-13 10:07:09.777725+10,2,0,79,noninterpretable
195,"Select production_year, count(*)
from movie 
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;
",2018-08-13 10:13:30.380825+10,2,1,79,correct
196,"select count(*)
from person p
where not exists (select *
                  from director d
                  where p.id=d.id);",2018-08-13 10:23:52.381984+10,12,1,79,correct
197,"select ids, first name, last name
from person p
where exists (select count(*)
              from;",2018-08-13 10:34:58.534381+10,4,0,79,noninterpretable
198,"select count(*)
from writer w
where exists (select *
              from person p
			  p.year_born=1935);",2018-08-13 10:39:52.238484+10,1,0,79,noninterpretable
199,"select p.id, p.first_name, p.last_name
from person p natural join writer w natural join director d
group by p.id
having count(*)>1;",2018-08-13 10:47:11.963242+10,4,1,79,correct
200,"SELECT COUNT(*) FROM WRITER W INNER JOIN PERSON P ON W.id = P.id WHERE P.year_born like ""%1935%"";",2018-08-13 11:01:40.543417+10,1,0,46,partially correct
201,SELECT COUNT(*) from WRITER where WRITER.id=PERSON.id AND PERSON.year_born=1935;,2018-08-13 11:39:14.186975+10,1,0,85,noninterpretable
202,SELECT COUNT(*) from WRITER where (SELECT id FROM PERSON WHERE WRITER.id=PERSON.id AND PERSON.year_born=1935);,2018-08-13 11:40:57.60643+10,1,0,85,partially correct
203,SELECT COUNT(*) from PERSON where EXISTS (SELECT * FROM WRITER WHERE WRITER.id=PERSON.id AND PERSON.year_born=1935);,2018-08-13 11:42:57.11344+10,1,1,85,correct
204,SELECT COUNT(*) from PERSON where (SELECT id FROM WRITER WHERE WRITER.id=PERSON.id AND PERSON.year_born=1935);,2018-08-13 11:45:54.231068+10,1,1,85,correct
205,"select count(*)
from person p
where exists (select *
              from writer w
			 where p.id=w.id and p.year_born=1935);",2018-08-13 12:39:43.53617+10,1,1,79,correct
206,"select m.title, m.production_year 
from (movie natural join writer natural join person) as m
where m.first_name=Kevin and m.last_name=Williamson
group by m.title;",2018-08-13 12:48:36.091508+10,5,0,79,noninterpretable
207,"select m.title, m.production_year 
from (writer natural join person) as m
where m.first_name='Kevin' and m.last_name='Williamson'
group by m.title;",2018-08-13 12:53:46.525856+10,5,1,79,correct
208,"select r.country
from restriction r
where r.title='Shakespeare in Love' and description='M'
group by r.country;",2018-08-13 13:17:50.715269+10,6,1,79,correct
209,"select p.id, p.first_name, p.last_name
from person p
where max(p.year_born);",2018-08-13 13:23:01.625779+10,7,0,79,noninterpretable
210,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born)
                  from person p);
",2018-08-13 13:28:06.071229+10,7,1,79,correct
211,"select b.title, b.production_year, b.first_name, b.last_name
from(person natural join director natural join Movie_Award)as b
where b.category= 'Best Film' and b.result='BAFTA Film Award';",2018-08-13 13:37:43.392775+10,8,0,79,partially correct
212,"select b.title, b.production_year, b.first_name, b.last_name
from(person natural join director natural join movie_award)as b
where b.category= 'Best Film' and b.award_name='BAFTA Film Award' and b.result='won';",2018-08-13 13:42:40.973961+10,8,0,79,partially correct
213,"select b2.title, b2.production_year, b2.first_name, b2.last_name
from(person natural join director natural join movie_award)as b2
where b2.category= 'Best Film' and b2.award_name= 'BAFTA Film Award' and b2.result= 'won';",2018-08-13 14:06:06.642849+10,8,0,79,partially correct
214,"SELECT COUNT(*)
FROM writer, person
WHERE person.year_born = 1935 AND person.id = writer.id;",2018-08-13 14:18:19.826056+10,1,0,24,partially correct
215,"select * from person
where person.year_born=1935;",2018-08-13 14:20:04.94127+10,1,0,83,partially correct
216,"select count(*) from person
where person.year_born=1935;",2018-08-13 14:21:13.026114+10,1,0,83,partially correct
217,"select count(*)
from (writer_award natural join person) as b
where b.first_name='Woody' and b.last_name= 'Allen' and b.year_of_award>1990 and  b.year_of_award<1996;",2018-08-13 14:24:42.408849+10,9,0,79,partially correct
218,"select count(*) as numer_of_award
from (writer_award natural join person) as b
where b.first_name='Woody' and b.last_name= 'Allen' and b.year_of_award>=1991 and  b.year_of_award<=1995 and result= 'won';",2018-08-13 14:28:04.506049+10,9,1,79,correct
219,"SELECT production_year, COUNT(*)
FROM movie AS m
WHERE m.production_year >= 1991 AND m.production_year <=1993
GROUP BY production_year;",2018-08-13 14:29:50.025129+10,2,1,24,correct
220,"select t.id
from (scene natural join role) as t
where t.title= 'Psycho'and t.production_year='1960' and t.scene_no= 'one';",2018-08-13 14:38:49.802067+10,10,0,79,partially correct
221,"select count(writer.id)
from writer 
join person on writer.id = person.id
where person.year_born = '1935';",2018-08-13 14:45:31.397726+10,1,0,93,partially correct
1458,"select count(*) from writer
where production_year=1935;",2018-08-22 12:55:42.53224+10,1,0,248,partially correct
222,"select count(distinct writer.id)
from writer 
join person on writer.id = person.id
where person.year_born = 1935;",2018-08-13 14:48:13.117145+10,1,1,93,correct
224,"SELECT ma.title, ma.production_year, first_name, last_name 
	FROM (SELECT title, production_year
		FROM movie_award
		WHERE lower(award_name) = 'bafta film award'
		AND lower(category) = 'best film'
		AND lower(result) = 'won') AS ma,


		person AS p, director AS d


	WHERE ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-13 14:53:54.625711+10,8,1,69,correct
225,;,2018-08-13 14:57:08.465184+10,11,0,79,noninterpretable
226,"SELECT count(*)
FROM person
WHERE person.id NOT IN (SELECT id from director); ",2018-08-13 14:59:53.888027+10,12,1,24,correct
227,";
",2018-08-13 15:04:07.201153+10,3,0,79,noninterpretable
228,"SELECT count(*) FROM writer_award WHERE
	(year_of_award > 1991) AND (year_of_award <= 1995)  
;",2018-08-13 15:04:18.935006+10,9,0,69,partially correct
229,"select d.id, d.award_name, d.year_of_award, d.category
from (Director_Award natural join person) as d
where lower(d.result)= 'no';",2018-08-13 15:26:26.384215+10,13,0,79,partially correct
230,"select b2.title, b2.production_year, b2.first_name, b2.last_name
from(person natural join director natural join movie_award)as b2
where lower(b2.category)= 'best film' and lower(b2.award_name)= 'bafta film award' and lower(b2.result)= 'won';",2018-08-13 15:32:03.38096+10,8,1,79,correct
231,"select t.id
from (scene natural join role natural join appearance) as t
where lower(t.title)= 'psycho'and t.production_year = 1960 
GROUP BY t.id
HAVING count(*)=1;
",2018-08-13 15:52:02.275513+10,10,0,79,partially correct
232,"select count(*)
from (person natural join writer)as r
where r.year_born=1935;",2018-08-13 15:57:43.801905+10,1,0,79,partially correct
233,"sELECT
    w.title, w.production_year
FROM
    writer w
WHERE exists(select p.id 
               from person p 
where p.id=w.id 
AND lower(first_name)= 'kevin'
                      AND lower(last_name)= 'williamson');

           ",2018-08-13 16:21:56.073733+10,5,1,79,correct
234,SELECT*FROM database schema WHERE bron = '1935'; ,2018-08-13 19:21:45.61864+10,1,0,100,noninterpretable
235,SELECT*FROM person WHERE year_born = '1935'; ,2018-08-13 19:25:22.378351+10,1,0,100,partially correct
236,SELECT count(*) FROM person WHERE year_born = '1935'; ,2018-08-13 19:27:11.806042+10,1,0,100,partially correct
237,SELECT COUNT(*) FROM person WHERE (year_born = '1935'AND job = 'writer');,2018-08-13 19:34:45.929299+10,1,0,100,noninterpretable
238,SELECT COUNT(*) FROM person WHERE EXISTS (SELECT * FROM writer WHERE person.id = writer.id AND year_born = '1935');,2018-08-13 19:46:24.711455+10,1,1,100,correct
239,SELECT id FROM WRITER INNER JOIN PERSON ON id = id;,2018-08-13 21:57:19.78978+10,1,0,98,noninterpretable
240,"select count(*)
from person p
where exists(select *
                from writer w
                 where w.id=p.id and year_born=1935);",2018-08-13 22:02:29.74439+10,1,1,79,correct
241,"SELECT COUNT (*)
 FROM PERSON p
 WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id = p.id AND p.year_born =1935);",2018-08-13 22:07:45.183229+10,1,1,98,correct
242,"SELECT COUNT(DISTINCT Writer.Id) FROM Writer INNER JOIN Person ON Writer.Id=Person.Id
WHERE Year_born=1935;
",2018-08-13 22:13:45.523365+10,1,1,77,correct
243,"SELECT COUNT (DISTINCT w.id) FROM WRITER w INNER JOIN PERSON p ON w.id = p.id 
 WHERE p.year_born = 1935;",2018-08-13 22:21:02.462431+10,1,1,98,correct
244,"select ma.title, ma.production_year, p.first_name, p.last_name
from  Movie_Award ma, director d,person p
where p.id=d.id
AND ma.title=d.title
AND d.production_year=ma.production_year
AND lower(ma.result)='won'
AND lower(ma.category)= 'best film'
And lower(ma.award_name)='bafta film award';",2018-08-13 22:26:48.58341+10,8,1,79,correct
245,SELECT COUNT (DISTINCT w.id) from WRITER w INNER JOIN PERSON p ON w.id = p.id WHERE year_born = 1935;,2018-08-13 22:30:33.507801+10,1,1,99,correct
246,"SELECT production_year, COUNT(*) AS 'number of movies'
 FROM MOVIE
 WHERE production_year in (1993, 1992, 1991)
 GROUP BY production_year;",2018-08-13 22:35:40.932739+10,2,1,98,correct
247,"select count(*)
from movie 
where not exists( select *
                    from (Movie_Award natural join crew_Award natural join director_award natural join writer_award natural join actor_award) As tt
                          where lower(tt.result)='won');",2018-08-13 22:37:08.463497+10,11,0,79,partially correct
248,"SELECT production_year, COUNT (MOVIE.production_year) from MOVIE WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year;",2018-08-13 22:44:56.088672+10,2,1,99,correct
249,"SELECT production_year, COUNT (MOVIE.production_year) from MOVIE WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year;",2018-08-13 22:45:11.304017+10,2,1,99,correct
250,"select id 
from person p
where p.year_born = (select max(haha.year_born) from
	(select p.year_born
	from person p 
	where p.year_born != (select max(p.year_born)
					from person p)) as haha);",2018-08-13 22:48:26.920019+10,3,1,43,correct
251,"SELECT Production_year, COUNT(Movie.Production_year) FROM MOVIE
Where Production_year>1990 and Production_year<1994
Group by Movie.Production_year;",2018-08-13 22:48:54.73335+10,2,1,77,correct
252,"select p.id
from person p
where p.year_born= (select max(p.year_born)
                        from person p
                     where p.year_born < (select max(p.year_born)from person p));",2018-08-13 22:51:36.161251+10,3,1,79,correct
253,"select d.id, d.award_name, d.year_of_award, d.category
from (Director_Award natural join person) as d
where lower(d.result)= 'nominated' and not exists lower(d.result)='won';",2018-08-13 22:57:16.381743+10,13,0,79,noninterpretable
254,;,2018-08-13 23:04:33.846779+10,15,0,79,noninterpretable
255,"select d.id,d1.award_name,d1.year_of_award,d1.category
from director_award d1,director d
where d.title = d1.title and
d.production_year = d1.production_year and
lower(result) != 'won' and 
lower(result) = 'nominated';",2018-08-13 23:05:46.675536+10,13,1,43,correct
256,"WITH blam AS (SELECT * FROM appearance app INNER JOIN role r
USING(title,production_year,description)
INNER JOIN scene
USING(title,production_year,scene_no)
INNER JOIN person p 
USING(id)
WHERE lower(title) = 'psycho'
AND
production_year = 1960)


SELECT id FROM blam
GROUP BY description
HAVING count(description) = 1


;",2018-08-13 23:14:14.383606+10,10,1,25,correct
257,"
from 1935;",2018-08-13 23:17:10.298831+10,1,0,105,noninterpretable
258,"SELECT COUNT (*)
 FROM PERSON p
 WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id = d.id);",2018-08-13 23:18:37.17674+10,12,1,98,correct
259,"SELECT COUNT(Person.Id) FROM Person
WHERE NOT EXISTS (Select Director.Id FROM Director where Person.Id=Director.Id);",2018-08-13 23:27:57.297973+10,12,1,77,correct
260,select count (*) from PERSON where not exists (select * from DIRECTOR where DIRECTOR.id = PERSON.id);,2018-08-13 23:28:35.2216+10,12,1,99,correct
261,"with haha as (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id)
select haha.id 
from haha
where haha.NoOfWorkedON = (select max(NoOfWorkedON)
					from haha);",2018-08-13 23:34:34.399047+10,14,1,43,correct
262,"SELECT p.id, p.first_name, p.last_name
 FROM PERSON p
 WHERE p.id in(SELECT d.id FROM DIRECTOR d NATURAL JOIN MOVIE e GROUP BY id HAVING COUNT (*) > 1);",2018-08-13 23:51:08.534202+10,4,0,98,partially correct
263,"SELECT dw.id, dw.first_name, dw.last_name
FROM (PERSON p NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING COUNT (*) > 1;",2018-08-13 23:53:57.615951+10,4,1,98,correct
264,"SELECT p.id, p.first_name, p.last_name
 FROM PERSON p
 WHERE p.id in(SELECT d.id FROM DIRECTOR d NATURAL JOIN WRITER e GROUP BY d.id HAVING COUNT (d.id) > 1);",2018-08-14 00:16:28.766021+10,4,1,98,correct
265,"SELECT Director.Id, COUNT(Director.ID) AS NumberOfDirector FROM Director NATURAL JOIN Writer
Group By Director.Id HAVING NumberOfDirector>1;",2018-08-14 00:18:24.78803+10,4,0,77,partially correct
266,select d.id from DIRECTOR d where exists (select * from DIRECTOR d natural join WRITER w) group by d.id having count (*) >= 2;,2018-08-14 00:20:10.592113+10,4,0,99,partially correct
267,"select p.id, p.first_name, p.last_name from PERSON p where exists (select d.id from DIRECTOR d natural join WRITER w where p.id = d.id group by d.id having count (*) >= 2);",2018-08-14 00:39:48.711895+10,4,1,99,correct
268,"SELECT Id, First_Name, Last_Name, COUNT(Director.ID) AS NumberOfWD FROM Director NATURAL JOIN Writer NATURAL JOIN PERSON
Group By Person.Id HAVING NumberOfWD>1;
",2018-08-14 00:53:21.188324+10,4,0,77,partially correct
269,"SELECT Id, First_Name, Last_Name, COUNT(Director.ID) AS NumberOfWD FROM Director NATURAL JOIN Writer NATURAL JOIN PERSON
Group By Person.Id HAVING NumberOfWD>1;
",2018-08-14 00:53:40.085787+10,4,0,77,partially correct
270,"SELECT Id, First_Name, Last_Name FROM Director NATURAL JOIN Writer NATURAL JOIN PERSON
Group By Person.Id HAVING Count(*)>1;
",2018-08-14 00:54:52.489112+10,4,1,77,correct
271,"Select movie.title, movie.production_year From MOVIE INNER JOIN writer on Movie.Title=Writer.title inner join person on writer.id=person.id
WHERE Person.first_name = 'Kevin' and Person.Last_name = 'Williamson';",2018-08-14 01:28:06.901538+10,5,1,77,correct
272,"Select movie.title, movie.production_year From MOVIE INNER JOIN writer on Movie.Title=Writer.title inner join person on writer.id=person.id
WHERE Person.first_name = 'Kevin' and Person.Last_name = 'Williamson';
",2018-08-14 01:43:54.148932+10,5,1,77,correct
273,"select p.id
from person p
where p.year_born= (select max(p.year_born)
                        from person p
                     where p.year_born < (select max(p.year_born)from person p));",2018-08-14 01:48:12.255044+10,3,1,79,correct
274,"SELECT Country from RESTRICTION
Where RESTRICTION.title='Shakespeare in Love' and RESTRICTION.description='M';",2018-08-14 01:49:32.98315+10,6,1,77,correct
275,"SELECT id, first_name, last_name, max(year_born) from person;",2018-08-14 02:00:35.027609+10,7,0,77,partially correct
276,"SELECT id, first_name, last_name FROM person
WHERE year_born=(SELECT max (year_born) FROM person);",2018-08-14 02:10:19.798636+10,7,1,77,correct
277,"SELECT Movie_award.title, Movie_award.production_year, Movie_award.award_name, Movie_award.category, person.first_name, person.last_name 
from person inner join director on person.id=director.id inner join Movie on director.title=movie.title inner join movie_award on movie.title=movie_award.title
Where award_name='BAFTA Film Award' and category='best film';
",2018-08-14 03:01:21.745489+10,8,0,77,partially correct
278,"SELECT Movie_award.title, Movie_award.production_year, person.first_name, person.last_name 
from person inner join director on person.id=director.id inner join Movie on director.title=movie.title inner join movie_award on movie.title=movie_award.title
Where award_name='BAFTA Film Award' and category='best film';
",2018-08-14 03:05:27.031273+10,8,0,77,partially correct
279,"SELECT Movie_award.title, Movie_award.production_year, person.first_name, person.last_name 
from person inner join director on person.id=director.id inner join Movie on director.title=movie.title inner join movie_award on movie.title=movie_award.title
Where award_name='BAFTA Film Award' and category='best film' and result='won';",2018-08-14 03:16:10.771642+10,8,1,77,correct
280,"SELECT id, first_name, last_name FROM person
WHERE year_born=(SELECT max (year_born) FROM person);
",2018-08-14 03:17:21.421407+10,8,0,77,partially correct
281,"SELECT Movie_award.title, Movie_award.production_year, person.first_name, person.last_name 
from person inner join director on person.id=director.id inner join Movie on director.title=movie.title inner join movie_award on movie.title=movie_award.title
Where award_name='BAFTA Film Award' and category='best film' and result='won';
",2018-08-14 03:18:12.513758+10,8,1,77,correct
282,"SELECT Count(writer_award.id) From writer_award inner join person on writer_award.id=person.id
Where first_name='Woody' and last_name='Allen' and result='won' and year_of_award>1990 and year_of_award<1996;
",2018-08-14 03:36:00.910462+10,9,1,77,correct
283,"SELECT  Role.id
from Appearance inner join role on Appearance.title=Role.title
Where Appearance.title='Psycho' and Appearance.production_year='1960' and Appearance.scene_no='1'
Group By Role.id;
",2018-08-14 04:03:21.071959+10,10,0,77,partially correct
284,"SELECT  Role.id
from Appearance inner join role on Appearance.title=Role.title
Where Appearance.title='Psycho' and Appearance.production_year='1960' and Appearance.scene_no='1'
Group By Role.id having count (Role.id)=1;
",2018-08-14 04:04:40.307669+10,10,0,77,partially correct
285,"SELECT id from Appearance natural join role
Where Appearance.title='Psycho' and Appearance.production_year='1960' and Appearance.scene_no='1'
Order by Role.id DESC;
",2018-08-14 04:11:27.272355+10,10,0,77,partially correct
287,"select count(*)
from writer, person
where writer.id = person.id
and person.year_born = 1935;",2018-08-14 10:37:37.343344+10,1,0,110,partially correct
288,"select p.id, p.first_name, p.last_name
from person p, writer w , director d
where p.id=w.id
AND w.id=d.id
AND d.title=w.title
AND d.production_year= w.production_year
group by p.id
having count(*)>1;",2018-08-14 10:40:04.026605+10,4,1,79,correct
289,"select production_year, count(*)
from movie
where production_year=1993
or production_year=1992
or production_year=1991
group by production_year;",2018-08-14 10:46:55.009004+10,2,1,110,correct
290,;,2018-08-14 10:48:32.975473+10,14,0,79,noninterpretable
291,"select count(*)
from person left join director on person.id = director.id
where director.id = null;
",2018-08-14 10:53:22.480431+10,12,0,110,partially correct
292,"select count(*)
from person 
where not exists (select * from director where director.id = person.id);",2018-08-14 10:56:41.306611+10,12,1,110,correct
293,"select count(writer.id)
from writer, person
where writer.id= person.id
and person.year_born=1935;",2018-08-14 11:04:12.536756+10,1,0,108,partially correct
294,"select count(*),production_year 
from movie 
where production_year=1993
or production_year=1992
or production_year=1991;",2018-08-14 11:11:51.709253+10,2,0,108,partially correct
295,"select count(*),production_year 
from movie 
where production_year=1993
or production_year=1992
or production_year=1991
group by production_year;",2018-08-14 11:12:22.669564+10,2,1,108,correct
296,"select production_year,count(*)
from movie 
where production_year=1993
or production_year=1992
or production_year=1991
group by production_year;",2018-08-14 11:12:57.212655+10,2,1,108,correct
297,"select count(*)
from person
where not exists (select * from director where director.id = person.id);",2018-08-14 11:14:08.869755+10,12,1,108,correct
298,"select id, first_name, last_name

from person, (select count(*)as c from director, writer where director.id = writer.id and director.id = person.id) as test

where test.c>1;",2018-08-14 11:22:32.323826+10,4,0,108,noninterpretable
299,"select count*)
from person
where exists (person.id = writer.id and person.year_born = 1935);",2018-08-14 11:23:50.902869+10,1,0,108,noninterpretable
300,"select count(*)
from person
where exists (select * from writer where person.id = writer.id and person.year_born = 1935);",2018-08-14 11:24:27.671154+10,1,1,108,correct
301,"select id, first_name, last_name
from (person as p natural join director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-14 11:31:27.654656+10,4,1,108,correct
302,"select title, production_year
from (movie natural join writer natural join person) as c
where c.first_name= ""Kevin"" and c.last_name = ""Williamson"";",2018-08-14 11:34:12.495814+10,5,1,108,correct
303,"select country
from restriction
where title=""Shakespeare in Love"" 
and description = ""M"";",2018-08-14 11:36:29.524255+10,6,1,108,correct
304,"select id, first_name, last_name
from person as p
having p.year_born > any person.year_born;",2018-08-14 11:39:52.664594+10,7,0,108,noninterpretable
305,"select id, first_name, last_name
from person as p
where p.year_born = (select max(year_born) from person);",2018-08-14 11:40:36.682207+10,7,1,108,correct
306,"Select count(*)
FROM person p
WHERE exists(SELECT *
FROM writer w
WHERE w.id = p.id 
AND p.year_born = 1935);
",2018-08-14 12:32:24.421921+10,1,1,105,correct
307,;,2018-08-14 12:35:16.39977+10,2,0,105,noninterpretable
308,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-14 12:38:48.989336+10,2,1,105,correct
309,"SELECT production_year, COUNT(*) FROM movie WHERE production_year IN ('1991','1992','1993') GROUP BY production_year;",2018-08-14 14:22:13.985041+10,2,1,100,correct
310,SELECT COUNT(*) FROM person WHERE EXISTS( SELECT * FROM director WHERE person.id!=director.id);,2018-08-14 15:07:57.910744+10,12,0,100,partially correct
311,select count(*) from writer w natural join person p where w.id = p.id and p.year_born = 1935; ,2018-08-14 16:40:24.81577+10,1,0,58,partially correct
312,select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935); ,2018-08-14 16:43:34.265501+10,1,1,58,correct
313,"select w.* from WRITER w where (select year_born='1935' from Person where p.Person id= w.Writer id);
",2018-08-14 16:44:15.099805+10,1,0,76,noninterpretable
314,"select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935);
",2018-08-14 16:47:11.302446+10,1,1,76,correct
315,"select m.production_year, count(*) as NumbersOfMovies from movie m where m.production_year in (1993,1992,1991) group by m.production_year;",2018-08-14 16:56:19.049035+10,2,1,58,correct
316,"select count(*), production_year from movie having production_year= '1993'AND '1992' AND '1991' group by production_year;",2018-08-14 17:07:29.82496+10,2,0,76,noninterpretable
317,"select production_year,count(*) from movie where production_year >1990 AND production_year< 1994 group by production_year;",2018-08-14 17:09:08.916236+10,2,1,76,correct
318,"select count(id)
from person
where year_born=1935;",2018-08-14 17:16:14.937713+10,1,0,118,partially correct
319,"Select count(*) from person p where not exists (select * from director d where d.id = p.id);
",2018-08-14 18:11:29.055068+10,12,1,76,correct
320,"select count(year_born)
from PERSON
where year_born='1935';",2018-08-14 18:41:20.93908+10,1,0,94,partially correct
321,"Select p.id, p.first_name, p.last_name from person p where min (d.title) = 2 (select d.title from director d where d.title = w.title);",2018-08-14 18:42:21.092398+10,4,0,76,noninterpretable
322,"select count(*)
from person p 
where exists 
(select * from writer w where p.id=w.id and p.year_born=1935);",2018-08-14 18:51:22.472923+10,1,1,94,correct
323,"select product_year count (*) as NumberofMovie
from movie m
where m.product_year='1993' or m.product_year='1992' or m.product_year='1991'
group by e.title;",2018-08-14 19:03:50.263557+10,2,0,94,noninterpretable
324,"select count(*)
from (person inner join writer on person.id = writer.id) as t
where t.year_born = 1935;",2018-08-14 19:07:07.312339+10,1,0,110,partially correct
325,"select production_year ,count (*) 
from movie m
where m.production_year>1990 and m.production_year<1994
group by m.production_year;",2018-08-14 19:10:39.834224+10,2,1,94,correct
326,"select production_year,count(*)
from movie
where production_year>1990
and production_year<1994
group by production_year;",2018-08-14 19:12:05.825562+10,2,1,110,correct
327,"select count(*) 
from person p
where not exists (select * from director d where p.id=d.id);
",2018-08-14 19:16:18.429364+10,12,1,94,correct
328,"SELECT COUNT(w.id) FROM writer w, person p
WHERE w.id = p.id AND year_born =  1935;",2018-08-14 19:25:46.40201+10,1,0,120,partially correct
329,"select count(*)
from person 
where not exists (select * from director where person.id=director.id);",2018-08-14 19:27:09.75789+10,12,1,110,correct
330,;,2018-08-14 19:31:56.197762+10,4,0,94,noninterpretable
331,"select id, first_name, last_name
from person as p
where (select count(*) from director as d, writer as w where d.id=w.id and d.id=p.id group by d.id)>2;",2018-08-14 19:32:41.847932+10,4,1,110,correct
332,"select id, first_name, last_name
from person as p
where (select count(*) from director as d, writer as w where d.id=w.id and d.id=p.id )>2;",2018-08-14 19:33:48.917507+10,4,1,110,correct
333,"
SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-14 19:36:45.68164+10,4,1,94,correct
334,"select title, production_year
from (writer inner join person on writer.id=person.id) as t
where t.first_name = 'Kevin'
and t.last_name=""Williamson"";",2018-08-14 19:38:12.290931+10,5,1,110,correct
335,"select country
from restriction
where title='Shakespeare in Love'
and description='M';",2018-08-14 19:40:58.076408+10,6,1,110,correct
336,"select dw.first_name, dw.last_name, dw.id
from (person natural join director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-14 19:46:08.350492+10,4,1,94,correct
337,"SELECT production_year, COUNT(production_year) 
FROM movie
where production_year = 1991 or production_year = 1992 or production_year = 1993;",2018-08-14 19:51:20.798195+10,2,0,120,partially correct
338,"select id, first_name, last_name
from person as p
where p.year_born=(select max(year_born) from person );",2018-08-14 19:53:12.157745+10,7,1,110,correct
339,"select distinct ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma inner join director as d on ma.title=d.title inner join person as p on d.id=p.id;
",2018-08-14 19:59:31.689229+10,8,0,110,partially correct
340,"Select dw.id, dw.first_name, dw.last_name from (person p natural join director natural join writer) as dw group by dw.id having count(*)>1; ",2018-08-14 20:01:18.048595+10,4,1,76,correct
341,"select distinct ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma inner join director as d on ma.title=d.title inner join person as p on d.id=p.id
where ma.award_name='BAFTA Film Award'
and ma.result='won'
and ma.category='best film';
",2018-08-14 20:06:25.426378+10,8,1,110,correct
342,"select mw.title, mw.production_year from (movie m natural join writer natural join person) as mw group by title having first_name = 'Kevin' and last_name = 'Williamson';",2018-08-14 20:08:30.767148+10,5,1,76,correct
343,"select count(*)
from person as p
where exists (select * from writer w where w.id = p.id AND p.year_born = 1935);
",2018-08-14 20:15:31.042837+10,1,1,110,correct
344,"select count(*)
from writer_award as wa inner join writer as w on wa.id=w.id inner join person as p on w.id = p.id
where p.first_name='Woody'
and p.last_name='Allen';

",2018-08-14 20:26:30.010057+10,9,0,110,partially correct
345,"select count(*)
from writer_award as wa inner join writer as w on wa.id=w.id and wa.title= w.title inner join person as p on w.id = p.id
where p.first_name='Woody'
and p.last_name='Allen'
and result = 'won';
",2018-08-14 20:30:39.550456+10,9,1,110,correct
346,"select p.id
from person p,role r,movie m
where r.id=p.id
AND m.title=r.title
ANd r.production_year=m.production_year
AND lower(m.title)='psycho'
AND r.production_year=1960
group by p.id
having count(*)=1;


",2018-08-14 20:34:30.790756+10,10,0,79,partially correct
347,"select mr.country from (movie m natural join restriction_category natural join restriction) as mr where mr.title = 'Shakespeare in Love' and mr.descripton = 'M';
",2018-08-14 20:49:57.617743+10,6,0,76,noninterpretable
348,"select  country from restriction where title = 'Shakespeare in Love' and description = 'M' ;
",2018-08-14 20:52:07.310538+10,6,1,76,correct
349,"select 
     r.id
from 
    appearance a,
    role r,
    scene s
where s.title = a.title
AND s.title = r.title
ANd r.production_year = a.production_year
AND s.production_year = r.production_year
AND a.production_year=s.production_year
AND s.scene_no=a.scene_no
AND lower(a.title) = 'psycho'
AND a.production_year = 1960
AND a.description=r.description
group by r.id
having count(*)=1;


",2018-08-14 20:52:48.848924+10,10,1,79,correct
350,"select p.id, p.first_name, p.last_name from person p where p.year_born = (select max(p.year_born) from person p) ;",2018-08-14 21:07:12.29267+10,7,1,76,correct
351,"SELECT Count(*)
FROM person;",2018-08-14 21:17:33.303483+10,1,0,122,partially correct
352,;,2018-08-14 21:22:02.437034+10,2,0,122,noninterpretable
353,;,2018-08-14 21:24:26.293255+10,4,0,122,noninterpretable
354,;,2018-08-14 21:33:15.945782+10,8,0,122,noninterpretable
355,;,2018-08-14 21:41:56.253252+10,11,0,122,noninterpretable
356,;,2018-08-14 21:45:56.065018+10,13,0,122,noninterpretable
357,"(select m.title, m.production_year
from movie_award m
where m.award_name = 'BAFTA Film Award' and m.category = 'Best Film')
UNION
(select p.first_name, p.last_name from person p where director id = p.id);",2018-08-14 21:58:22.552787+10,8,0,76,noninterpretable
6093,"select *
from movie m
where m.title = 'Psycho';",2018-08-30 00:35:49.767039+10,10,0,357,partially correct
359,"select p.first_name, p.last_name, wa.count(*) from writer_award wa, person p where wa.year_of_award between 1991 and 1995 
and wa.id = p.id and p.first_name = 'Woody'and p.last_name = 'Allen';
",2018-08-14 22:32:09.625818+10,9,0,76,noninterpretable
360,"SELECT first_name,last_name,id FROM person WHERE EXISTS(SELECT*FROM director WHERE director.id=person.id AND EXISTS (SELECT*FROM writer WHERE writer.id=director.id));",2018-08-14 22:33:09.915871+10,4,0,100,partially correct
361,"SELECT COUNT(writers_1935)
FROM(SELECT id, year_born
	FROM person, writer;",2018-08-14 22:35:58.647124+10,1,0,124,noninterpretable
362,"SELECT count(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);",2018-08-14 22:38:22.879595+10,1,1,124,correct
363,"select count(*)
from person p
where exists(select * from writer w where w.id = p.id)
and year_born = '1935';",2018-08-14 22:44:36.666065+10,1,1,43,correct
364,"SELECT first_name,last_name,id FROM person WHERE EXISTS(SELECT*FROM director WHERE director.id=person.id AND EXISTS (SELECT*FROM writer WHERE writer.id=director.id GROUP BY id HAVING COUNT(*)>1));",2018-08-14 22:44:53.199746+10,4,1,100,correct
365,"SELECT id,first_name,last_name FROM person WHERE EXISTS(SELECT*FROM director WHERE director.id=person.id AND EXISTS (SELECT*FROM writer WHERE writer.id=director.id GROUP BY id HAVING COUNT(*)>1));",2018-08-14 22:45:47.567259+10,4,1,100,correct
366,"select production_year,count(*)
from movie
where production_year in (1991,1992,1993) 
group by production_year;",2018-08-14 22:49:14.181329+10,2,1,43,correct
367,"SELECT title, production_year, COUNT(production_year)
FROM movie m
WHERE EXISTS(m.production_year=1991, 1992, 1993)
GROUP BY m.production_year;",2018-08-14 22:49:18.483573+10,2,0,124,noninterpretable
368,"select p.id 
from
person p, 
role r,
scene s,
movie m
where 
p.id = r.id 
and m.title = s.title
and r.title = m.title
and r.production_year = m. production_year
and m.title = 'Psycho'
and m.production_year = 1960
and s.count(*) = 1;",2018-08-14 22:49:30.35859+10,10,0,76,noninterpretable
369,"select count(*)
from person p 
where not exists(select * from director d where p.id = d.id);",2018-08-14 22:50:49.370367+10,12,1,43,correct
370,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;",2018-08-14 22:52:04.545869+10,2,1,124,correct
371,"SELECT COUNT(*)
FROM(;",2018-08-14 22:55:16.905674+10,12,0,124,noninterpretable
372,"select p.id,p.first_name,p.last_name
from person p
where exists (select * from writer w where p.id = w.id and 
			where exists(select * from director d where w.id = d.id))
group by (p.id,p.first_name,p.last_name)
having count(*) > 2;",2018-08-14 22:56:43.557115+10,4,0,43,noninterpretable
373,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d
				WHERE d.id=p.id);",2018-08-14 22:57:02.107415+10,12,1,124,correct
374,"SELECT id, first_name, last_name
;",2018-08-14 23:00:45.767237+10,4,0,124,noninterpretable
375,"select w.title, w.production_year
from writer w inner join person p
where lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';",2018-08-14 23:01:15.159439+10,5,0,43,partially correct
376,"select distinct w.title, w.production_year
from writer w inner join person p
where lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';",2018-08-14 23:01:41.436577+10,5,0,43,partially correct
377,"select distinct w.title, w.production_year
from writer w inner join person p
on w.id = p.id
where lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';",2018-08-14 23:02:05.992874+10,5,1,43,correct
378,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-14 23:07:03.985791+10,4,1,124,correct
379,"SELECT DISTINCT title,production_year FROM(SELECT*FROM person NATURE JOIN movie INNER JOIN writer) WHERE first_name='Kevin' AND last_name='Williamson';",2018-08-14 23:09:58.985139+10,5,0,100,partially correct
380,"SELECT title, production_year
FROM writer, person
WHERE(writer.id=person.id AND person.first_name='Kevin' AND person.last_name='Williamson');",2018-08-14 23:17:34.493986+10,5,1,124,correct
381,"SELECT country
FROM restriction
WHERE(restriction.title='Shakespeare in Love' AND restriction.description='M');",2018-08-14 23:27:08.667462+10,6,1,124,correct
382,"SELECT DISTINCT title,production_year FROM writer WHERE EXISTS(SELECT*FROM person WHERE person.id=writer.id AND first_name='Kevin' AND last_name='Williamson');",2018-08-14 23:30:07.700723+10,5,1,100,correct
383,SELECT country FROM restriction WHERE title='Shakespeare in Love' AND  description='M';,2018-08-14 23:37:58.952597+10,6,1,100,correct
384,"SELECT id, first_name, last_name
FROM person
WHERE HAVING MAX(year_born);",2018-08-14 23:40:49.96781+10,7,0,124,noninterpretable
385,"SELECT id,first_name,last_name FROM person GROUP BY id HAVING MAX(year_born);",2018-08-14 23:49:01.547697+10,7,0,100,partially correct
386,"SELECT id,first_name,last_name FROM (SELECT MAX(year_born),id,first_name,last_name FROM person);",2018-08-14 23:52:10.480962+10,7,1,100,correct
387,"SELECT id, first_name, last_name
FROM person
WHERE person.year_born=(SELECT MAX(year_born) FROM person);",2018-08-14 23:59:01.201341+10,7,1,124,correct
388,"select count(*) from movie m where not exists
(
select * from movie m, award a, movie_award ma, crew_award ca, director_award da, writer_award wa, 
actor_award aw
where 
m.title = ma.title
and m.production_year = ma.production_year
m.title = ca.title
and m.production_year = ca.production_year
and m.title = sa.title
and m.production_year = sa.production_year
and m.title = wa.title
and m.production_year = wa.production_year
and m.title =aw.title
and m.production_year = aw.production_year
);",2018-08-15 00:06:28.722373+10,11,0,76,noninterpretable
389,"SELECT writer.id,COUNT(*)
FROM person,writer
where person.id = writer.id
AND person.year_born = '1935'
GROUP BY writer.id;
",2018-08-15 00:06:36.025794+10,1,0,68,partially correct
390,"SELECT m.production_year as productionyear, SUM(production_year)
FROM movie m
Group BY m.production_year
HAVING m.production_year = '1993'OR m.production_year = '1992'OR m.production_year = '1991';",2018-08-15 00:14:09.243107+10,2,0,68,partially correct
391,select id from person where year_born < any (select max (year_born) from person p); ,2018-08-15 00:14:36.24421+10,3,0,76,noninterpretable
392,"SELECT title,production_year,category,first_name,last_name FROM (movie_award NATURE JOIN director) WHERE award_name='BAFTA Film Award' AND category='Best Film';",2018-08-15 00:16:23.686043+10,8,0,100,noninterpretable
393,select id from person where year_born = (select max (year_born) from person where year_born < (select max(year_born) from person)); ,2018-08-15 00:16:58.45017+10,3,1,76,correct
394,"SELECT m.title,m.production_year,first_name,last_name FROM director,(SELECT title,production_year FROM movie_award WHERE award_name='BAFTA Film Award' AND category='best film' AND result='won') AS m,person WHERE director.title=m.title AND director.id=person.id;
",2018-08-15 00:31:12.156656+10,8,1,100,correct
395,"select p.id, da.award_name, da.year_of_award, da.category 
from director_award da, person p, director d
where 
 (select count (*) from director_award da where da.result= 'nominate' > 0) and p.id = d.id
and d.title = da.title
and d.production_year = da.production_year
and da.result = 'not won'
group by p.id;",2018-08-15 00:35:36.949881+10,13,0,76,partially correct
396,"select d.id, da.award_name, da.year_of_award, da.category 
from director_award da, director d
where d.title = da.title and d.production_year = da.production_year and da.result = 'nominated' and d.id not in ( 
select id
from director_award da, director d
where da.result = 'won'
and d.title = da.title 
and d.production_year = da.production_year);
",2018-08-15 00:39:38.34284+10,13,1,76,correct
397,"select wd.id from (writer natural join director) as wd 
where max(wd.titlenumbers) = (select wd.titlenumbers from wd);",2018-08-15 00:59:25.019207+10,14,0,76,noninterpretable
398,"SELECT count(*)
FROM writer
WHERE year = 1935;",2018-08-15 02:18:30.727036+10,1,0,107,noninterpretable
399,"SELECT production_year, count(*)
FROM movie
WHERE production_year = 1993,1992 and 1991;
",2018-08-15 02:24:57.989353+10,2,0,107,noninterpretable
400,select count(id) as Num_of_writers from Person where year_born = 1935;,2018-08-15 03:20:37.264782+10,1,0,126,partially correct
401,select count(id) as Num_of_writers from Person where id in (select id from Writer) and year_born = 1935;,2018-08-15 03:24:49.718554+10,1,1,126,correct
402,"select production_year, count(*) from Movie where production_year in (1993,1992,1991) group by production_year;",2018-08-15 03:27:14.768813+10,2,1,126,correct
403,"WITH born_same AS (SELECT * FROM person p1 INNER JOIN person p2
WHERE p1.id != p2.id AND p1.year_born = p2.year_born),

youngest AS (SELECT id FROM born_same
WHERE year_born IN (SELECT MAX(year_born) FROM born_same)),

without_youngest AS (SELECT * FROM born_same 
				WHERE id NOT IN (SELECT id FROM youngest))

SELECT DISTINCT id FROM without_youngest
WHERE year_born = (SELECT MAX(year_born) FROM without_youngest)



;
",2018-08-15 08:27:07.018888+10,3,0,25,partially correct
404,select w.production_year from WRITER w inner join PERSON p on p.id = w.id where p.first_name = 'Kevin' and p.last_name = 'Williamson';,2018-08-15 08:54:22.078824+10,5,0,99,partially correct
405,"select w.title, w.production_year from WRITER w inner join PERSON p on p.id = w.id where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-15 08:55:06.785414+10,5,1,99,correct
406,select r.country from RESTRICTION r where r.title = 'Shakespeare in Love' and r.description = 'M';,2018-08-15 09:01:31.209432+10,6,1,99,correct
407,"select p.id, p.first_name, p.last_name from PERSON p where MAX(p.year_born);",2018-08-15 09:06:25.166063+10,7,0,99,noninterpretable
408,"select p.id, p.first_name, p.last_name from PERSON p where p.year_born = (select max(year_born) from PERSON);",2018-08-15 09:09:39.455288+10,7,1,99,correct
409,"select title, production_year 
from movie m
where exists ( select * from (writer w natural join person p) as wp where m.title=wp.title and wp.first_name='Kevin' and wp.last_name='Williamson');",2018-08-15 10:29:07.982554+10,5,1,94,correct
410,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-15 10:37:01.837985+10,5,1,94,correct
411,"select country
from restriction
where title='Shakespace in Love' 
and description='M';",2018-08-15 10:43:47.404647+10,6,0,94,partially correct
412,"select country
from restriction
where title='Shakespeare in Love' 
and description='M';",2018-08-15 10:44:20.020631+10,6,1,94,correct
413,"select id, first_name, last_name ,min(year_born)
from person;",2018-08-15 10:54:02.120757+10,7,0,94,partially correct
414,"select id, first_name, last_name ,max(year_born)
from person;",2018-08-15 10:54:42.933492+10,7,0,94,partially correct
415,"
SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE p.year_born=
(select max(year_born) from person);
   
    
      ",2018-08-15 11:01:29.63518+10,7,1,94,correct
416,"select count(*) as counter
from writer w natural join person p natural join writer_award a
where first_name = 'Woody' and last_name = 'Allen' and year_of_award>='1991' and year_of_award<=1995 and result ='won';",2018-08-15 11:17:17.272154+10,9,1,28,correct
417,"select m.title, m. production_year, dp.first_name, dp.last_name
from movie_award m, (director natural join person)as dp
where dp.title=m.title
and m.category='Best Film' and m.award_name='BAFTA Film Award';",2018-08-15 11:19:23.397976+10,8,0,94,partially correct
418,"select count(*)
from writer_award wa
where exists( select * from person p where wa.id=p.id and p.first_name='Woody' and p.last_name='Allen' and wa.year_of_award>1990 and wa.year_of_award<1996);
",2018-08-15 11:38:58.69785+10,9,0,94,partially correct
419,"select count(*)
from writer_award wa
where exists( select *
from person p
where wa.id=p.id 
and wa.result='won'
and p.first_name='Woody' 
and p.last_name='Allen' 
and wa.year_of_award>1990 
and wa.year_of_award<1996);
",2018-08-15 11:44:45.682889+10,9,1,94,correct
420,"select id 
from role r
where exists(
select *
from scene s
where s.title='Psycho' and s.production_year='1960' and s.scene_no='one' and r.title=s.title );",2018-08-15 12:43:13.061853+10,10,0,94,partially correct
421,"select id 
from role r
where exists(
select *
from scene s
where s.title='Psycho' and s.production_year='1960'  and r.title=s.title );",2018-08-15 12:44:38.971862+10,10,0,94,partially correct
422,"select id 
from role r
where exists(
select *
from scene s, appearance a
where s.title='Psycho' and s.production_year='1960'  and r.title=s.title and r.title=a.title );",2018-08-15 12:46:26.162575+10,10,0,94,partially correct
423,"select id 
from role r
where exists(
select *
from scene s, appearance a
where s.title='Psycho' and s.production_year='1960'
and r.title=s.title and r.title=a.title
and r.production_year=s.production_year and s.production_year=a.production_year);",2018-08-15 12:49:12.591571+10,10,0,94,partially correct
424,"select id 
from role r
where exists(
select *
from scene s, appearance a
where s.title='Psycho' and s.production_year='1960'
and r.title=s.title and r.title=a.title
and r.production_year=s.production_year and s.production_year=a.production_year)
group by r.id
having count(*)=1;",2018-08-15 12:51:54.82809+10,10,0,94,partially correct
425,"select id 
from role r
where exists(
select *
from scene s, appearance a
where s.title='Psycho' and s.production_year='1960'
and r.title=s.title and r.title=a.title
and r.production_year=s.production_year and s.production_year=a.production_year
   AND s.scene_no = a.scene_no)
group by r.id
having count(*)=1;",2018-08-15 12:52:45.477406+10,10,0,94,partially correct
426,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-15 12:54:39.549894+10,10,1,94,correct
427,"select movie_award.title,movie_award.production_year,dp.first_name,dp.last_name
from movie_award,director natural join person as dp
where movie_award.category='Best Film' and movie_award.award_name='BAFTA Film Award' and result ='won';",2018-08-15 12:54:44.606039+10,8,0,134,partially correct
428,"select count(*)
from movie m
where not exists(
select *
from (movie_award ma natural join crew_award ca natural join director_award da natural join writer_award wa natural join actor_award aa) as abc
where m.title=abc.title);",2018-08-15 13:00:41.108724+10,11,0,94,partially correct
429,"select count(*)
from movie m
where not exists(
select *
from (movie_award ma natural join crew_award ca natural join director_award da natural join writer_award wa natural join actor_award aa) as abc
where abc.result='won' and m.title=abc.title);",2018-08-15 13:02:10.047592+10,11,0,94,partially correct
430,"select count(*)
from movie m
where not exists(
select *
from (movie_award ma natural join crew_award ca natural join director_award da 
        natural join writer_award wa natural join actor_award aa) as abc
where abc.result='won' and m.title=abc.title and abc.production_year=m.production_year);",2018-08-15 13:11:21.323704+10,11,0,94,partially correct
431,select * from Person where year_born = 1935;,2018-08-15 13:13:33.987018+10,1,0,137,partially correct
432,select * from Person where year_born = 1935;,2018-08-15 13:14:07.137634+10,1,0,137,partially correct
433,"select id
from person p
where ;",2018-08-15 13:15:01.781047+10,3,0,94,noninterpretable
434,"select p.id
from person p
where p.year_born=(select max(year_born)
from person p
where year_born<(select max(year_born) from person));",2018-08-15 13:18:36.234939+10,3,1,94,correct
435,"Select production_year,count(*) from Movie where production_year=1991 or production_year=1992 or production_year=1993 group by production_year;",2018-08-15 13:24:12.69969+10,2,1,85,correct
436,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where exists (d.title=da.title and da.production_year=d.production_year)
and not exists(da.result='won');",2018-08-15 13:38:09.727293+10,13,0,94,noninterpretable
437,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title and da.production_year=d.production_year
and not exists (select * from director_award where da.result='won');",2018-08-15 13:45:14.897746+10,13,1,94,correct
438,"select id 
from director d, writer w, (director union writer)as dw
where distinct n;",2018-08-15 13:49:34.748202+10,14,0,94,noninterpretable
439,"select count(id)-(select count(id) from (select distinct id from director)) from person;
",2018-08-15 13:49:38.119351+10,12,1,85,correct
440,"select count(*), production_year from movie where production_year in (1993,1992,1991);",2018-08-15 13:50:00.491827+10,2,0,137,partially correct
510,select count(*) from person p where not exists (select * from director d where d.id = p.id);,2018-08-15 20:09:23.746062+10,12,1,58,correct
441,"select p.first_name, p.last_name, r.title, r.production_year,r.description
from person p, role r
where id=(select max(count(*)) from role group by id);",2018-08-15 13:56:34.882109+10,15,0,94,noninterpretable
442,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-15 14:17:50.897855+10,2,1,137,correct
443,SELECT COUNT(*) FROM writer_award WHERE year_of_award BETWEEN 1991 AND 1995 AND EXISTS (SELECT id FROM person WHERE first_name='Woody'AND last_name='Allen' AND person.id=writer_award.id);,2018-08-15 14:23:09.936321+10,9,0,100,partially correct
444,SELECT COUNT(*) AS name_of_award FROM writer_award WHERE year_of_award BETWEEN 1991 AND 1995 AND result='won' AND EXISTS (SELECT id FROM person WHERE first_name='Woody'AND last_name='Allen' AND person.id=writer_award.id);,2018-08-15 14:26:58.331316+10,9,1,100,correct
445,select *from director ;,2018-08-15 14:30:38.709891+10,12,0,137,partially correct
446,"select m.title, m. production_year, dp.first_name, dp.last_name
from movie_award m, (director natural join person)as dp
where dp.title=m.title
and m.category='best film' and m.award_name='BAFTA Film Award';",2018-08-15 15:14:02.781294+10,8,0,94,partially correct
447,"select m.title, m. production_year, dp.first_name, dp.last_name
from movie_award m, (director natural join person)as dp
where dp.title=m.title
and m.category='best film' and m.award_name='BAFTA Film Award'and m.result='won';",2018-08-15 15:15:55.038783+10,8,1,94,correct
448,"select m.title, m. production_year, dp.first_name, dp.last_name
from movie_award m, (director natural join person)as dp
where dp.title=m.title
and m.category='best film' and m.award_name='BAFTA Film Award'and m.result='won';",2018-08-15 15:18:51.87542+10,8,1,94,correct
449,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id
FROM person p, writer w
WHERE p.id = w.id AND p.year_born = 1935);",2018-08-15 15:24:18.03118+10,1,1,27,correct
450,"SELECT *
FROM Movie 
WHERE production_year IN (1991, 1992, 1993);",2018-08-15 15:28:01.875489+10,2,0,27,partially correct
451,"SELECT production_year, COUNT(*)
FROM Movie 
WHERE production_year IN (1991, 1992, 1993)
GROUP BY production_year;",2018-08-15 15:31:06.401143+10,2,1,27,correct
452,"SELECT production_year, COUNT(*)
FROM Movie 
WHERE production_year IN (1991, 1992, 1993)
GROUP BY production_year;",2018-08-15 15:31:06.607787+10,2,1,27,correct
453,"select movie_award.title,movie_award.production_year,dp.first_name,dp.last_name
from movie_award,(director natural join person) as dp
where movie_award.title = dp.title and movie_award.production_year = dp.production_year and lower(movie_award.category)='best film' and lower(movie_award.award_name)='bafta film award' and movie_award.result ='won';",2018-08-15 15:32:05.016+10,8,1,134,correct
454,"SELECT COUNT(*)
FROM writer, person
WHERE writer.id = person.id AND year_born = 1935;",2018-08-15 15:40:11.359479+10,1,0,144,partially correct
455,"Select * from person
where year_born = 1935;",2018-08-15 15:40:14.175855+10,1,0,123,partially correct
456,"SELECT *
FROM person p
WHERE p.id NOT IN
	(SELECT d.id
	FROM director d, person p
	WHERE d.id = p.id);
",2018-08-15 15:43:39.221321+10,12,0,27,partially correct
457,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN
	(SELECT d.id
	FROM director d, person p
	WHERE d.id = p.id);
",2018-08-15 15:44:00.029426+10,12,1,27,correct
458,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-15 15:44:28.102126+10,1,1,144,correct
459,"Select production_year, count(production_year) from movie where production_year between 1991 and 1993 group by production_year;",2018-08-15 15:52:23.440892+10,2,1,123,correct
460,"select * 
from person
left join person on person.id = director.id;
",2018-08-15 16:00:15.17536+10,12,0,123,noninterpretable
461,"Select count(*) 
from person 
where not exists 
(SELECT * 
FROM director 
WHERE person.id = director.id);",2018-08-15 16:07:25.366962+10,12,1,123,correct
462,"select id, first_name, last_name
from person
where director.title = writer.title;",2018-08-15 16:11:59.450135+10,4,0,123,noninterpretable
463,"SELECT person.id, person.first_name, person.last_name
FROM (SELECT director.id AS DId
	FROM director INNER JOIN writer
		ON director.id = writer.id
	GROUP BY director.id
	HAVING count(*) > 2) INNER JOIN person
		ON person.id = DId;
",2018-08-15 16:14:56.103671+10,4,1,27,correct
464,"SELECT kw.title, kw.production_year
FROM person NATURAL JOIN writer AS kw
WHERE person.first_name = 'Kevin' AND person.last_name = 'Williamson';",2018-08-15 16:21:53.86585+10,5,1,27,correct
465,"SELECT country 
FROM restriction
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-15 16:25:58.542153+10,6,1,27,correct
466,"SELECT person.id, person.first_name, person.last_name
FROM(SELECT person.id, max(year_born)
FROM person) NATURAL JOIN person;",2018-08-15 16:35:14.860961+10,7,1,27,correct
467,"SELECT m.title, m.production_year
FROM movie m, movie_award ma
WHERE m.title = ma.title 
	AND m.production_year = ma.production_year
	AND lower(ma.award_name) = 'bafta film award' 
	AND lower(ma.category) = 'best film';",2018-08-15 16:42:55.005597+10,8,0,27,partially correct
468,"SELECT title, production_year, first_name, last_name
FROM movie m NATURAL JOIN movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE lower(award_name) = 'bafta film award' 
	AND lower(category) = 'best film';",2018-08-15 16:58:16.876735+10,8,0,27,partially correct
469,"SELECT *
FROM movie m NATURAL JOIN movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE lower(award_name) = 'bafta film award' 
	AND lower(category) = 'best film'
	AND lower(result) = 'won';",2018-08-15 16:59:46.783065+10,8,0,27,partially correct
470,"SELECT title, production_year, first_name, last_name
FROM movie m NATURAL JOIN movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE lower(award_name) = 'bafta film award' 
	AND lower(category) = 'best film'
	AND lower(result) = 'won';",2018-08-15 17:00:35.138196+10,8,1,27,correct
471,"SELECT 
FROM person p NATURAL JOIN writer_award wa
WHERE lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen'
	AND wa.year_of_award BETWEEN 1991 AND 1995;",2018-08-15 17:10:33.714894+10,9,0,27,noninterpretable
472,"SELECT COUNT(*)
FROM person p NATURAL JOIN writer_award wa
WHERE lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen'
	AND wa.year_of_award BETWEEN 1991 AND 1995
	AND lower(wa.result = 'won');",2018-08-15 17:11:26.6959+10,9,1,27,correct
473,"SELECT id, count(*)
FROM appearance NATURAL JOIN (SELECT id, description FROM role)
WHERE lower(title) = 'psycho'
GROUP BY description
HAVING count(*) = 1;",2018-08-15 17:26:41.26095+10,10,0,27,partially correct
474,select count(w.id) from writer as w inner join person as p on w.id = p.id where p.year_born = 1935;,2018-08-15 17:27:14.100982+10,1,0,66,partially correct
475,"select count(distinct w.id) from writer as w, person as p where w.id = p.id and p.year_born = 1935;",2018-08-15 17:33:35.545723+10,1,1,66,correct
476,"SELECT COUNT(*)
FROM writer, person
WHERE writer.id = person.id AND person.year_born ='1935';",2018-08-15 17:36:18.231984+10,1,0,147,partially correct
477,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-15 17:37:10.184263+10,1,1,147,correct
478,"select production_year, count(*) from movie group by production_year having production_year = 1993 OR production_year = 1992 OR production_year = 1991;",2018-08-15 17:44:32.421693+10,2,1,66,correct
479,"SELECT id
FROM appearance a NATURAL JOIN role r
WHERE a.title = 'Psycho' AND a.production_year = 1960
GROUP BY id
HAVING count(*) = 1;",2018-08-15 17:46:42.429362+10,10,1,27,correct
480,"select count(*) from person as p, director as d where d.id != p.id;",2018-08-15 17:51:01.062072+10,12,0,66,partially correct
481,select count(p.id) from person as p left join director as d on p.id = d.id where d.id is null;,2018-08-15 17:53:50.940333+10,12,1,66,correct
482,"select p.id, p.first_name, p.last_name 
from person as p,(select id, COUNT(title) as num from movie natural join director natural join writer group by id) as t
where t.num > 2  and t.id = p.id ;
",2018-08-15 18:18:23.526207+10,4,0,66,partially correct
511,"SELECT COUNT(*) AS number_of_the_awards
FROM 
	writer_award AS wa,
	person  p,
	writer  w
	
WHERE
	p.id=w.id
	AND w.id=wa.id
	AND lower(p.first_name)='woody' 
	AND lower(p.last_name)='allen' 
	AND wa.year_of_award>=1991 
	AND wa.year_of_award<=1995
	AND lower(result)='won'
	AND wa.production_year=w.production_year;",2018-08-15 20:14:09.184561+10,9,1,124,correct
9671,SELECT ;,2018-08-31 10:19:15.217809+10,11,0,445,noninterpretable
483,"SELECT m.title, m.production_year
FROM movie m
EXCEPT
SELECT DISTINCT aw.title, aw.production_year 
FROM
	(SELECT ma.title, ma.production_year, ma.award_name, ma.result FROM movie_award ma
	UNION
	SELECT ca.title, ca.production_year, ca.award_name, ca.result FROM crew_award ca
	UNION 
	SELECT da.title, da.production_year, da.award_name, da.result FROM director_award da
	UNION
	SELECT wa.title, wa.production_year, wa.award_name, wa.result FROM writer_award wa
	UNION
	SELECT aa.title, aa.production_year, aa.award_name, aa.result FROM actor_award aa) AS aw
WHERE lower(result) = 'won';",2018-08-15 18:18:52.954705+10,11,0,27,partially correct
484,"SELECT COUNT(*)
FROM
(SELECT m.title, m.production_year
FROM movie m
EXCEPT
SELECT DISTINCT aw.title, aw.production_year 
FROM
	(SELECT ma.title, ma.production_year, ma.award_name, ma.result FROM movie_award ma
	UNION
	SELECT ca.title, ca.production_year, ca.award_name, ca.result FROM crew_award ca
	UNION 
	SELECT da.title, da.production_year, da.award_name, da.result FROM director_award da
	UNION
	SELECT wa.title, wa.production_year, wa.award_name, wa.result FROM writer_award wa
	UNION
	SELECT aa.title, aa.production_year, aa.award_name, aa.result FROM actor_award aa) AS aw
WHERE lower(result) = 'won');",2018-08-15 18:19:35.36694+10,11,1,27,correct
485,"SELECT COUNT(*)
FROM
	(SELECT m.title, m.production_year
	FROM movie m
	EXCEPT
	SELECT DISTINCT aw.title, aw.production_year 
	FROM
		(SELECT ma.title, ma.production_year, ma.award_name, ma.result FROM movie_award ma
		UNION
		SELECT ca.title, ca.production_year, ca.award_name, ca.result FROM crew_award ca
		UNION 
		SELECT da.title, da.production_year, da.award_name, da.result FROM director_award da
		UNION
		SELECT wa.title, wa.production_year, wa.award_name, wa.result FROM writer_award wa
		UNION
		SELECT aa.title, aa.production_year, aa.award_name, aa.result FROM actor_award aa) AS aw
	WHERE lower(result) = 'won');",2018-08-15 18:19:52.153557+10,11,1,27,correct
486,"select person.first_name, person.last_name, person.id from person, (select new.id, count(new.id) as produce_num 
from (select w.id  from writer as w, director as d where w.id = d.id AND w.title = d.title) as new group by new.id) as new2
where person.id = new2.id AND new2.produce_num >= 2;
",2018-08-15 18:36:00.922231+10,4,1,66,correct
487,"select person.id, person.first_name, person.last_name from person, (select new.id, count(new.id) as produce_num 
from (select w.id  from writer as w, director as d where w.id = d.id AND w.title = d.title) as new group by new.id) as new2
where person.id = new2.id AND new2.produce_num >= 2;
",2018-08-15 18:36:50.41973+10,4,1,66,correct
488,"select title, production_year
from person natural join writer natural join movie
where first_name = 'Kevin' and last_name = 'Williamson'; ",2018-08-15 18:40:57.965102+10,5,1,66,correct
489,"SELECT * 
FROM person
WHERE year_born = 
	(SELECT max(year_born) FROM 
		(SELECT *
		FROM person

		EXCEPT

		SELECT *
		FROM person
		WHERE year_born = (SELECT max(year_born) FROM person)));",2018-08-15 18:44:51.583629+10,3,0,27,partially correct
490,"SELECT id 
FROM person
WHERE year_born = 
	(SELECT max(year_born) FROM 
		(SELECT *
		FROM person

		EXCEPT

		SELECT *
		FROM person
		WHERE year_born = (SELECT max(year_born) FROM person)));",2018-08-15 18:45:10.815738+10,3,1,27,correct
491,"select country
from restriction natural join movie where title = 'Shakespeare in Love' and description ='M';",2018-08-15 18:53:11.51628+10,6,0,66,partially correct
492,"select r.country
from restriction as r, movie as m where r.title = m.title and r.title = 'Shakespeare in Love' and description ='M';",2018-08-15 18:57:57.010181+10,6,1,66,correct
493,"SELECT id, award_name, year_of_award, category
FROM director_award NATURAL JOIN director
WHERE id IN
	(SELECT DISTINCT id
	FROM director_award NATURAL JOIN director

	EXCEPT

	SELECT DISTINCT id
	FROM director_award NATURAL JOIN director
	WHERE lower(result) = 'won');",2018-08-15 19:00:37.084029+10,13,1,27,correct
494,"select id, first_name, last_name from person where year_born = (select MAX(year_born) from person);",2018-08-15 19:02:24.417183+10,7,1,66,correct
495,"SELECT title, production_year, first_name, last_name
FROM(SELECT ;",2018-08-15 19:13:22.129642+10,8,0,124,noninterpretable
496,"SELECT production_year, first_name, last_name, year_born
FROM Writer, Person
WHERE Person.id = Writer.production_year AND Person.year_born = 1935;",2018-08-15 19:19:07.704099+10,1,0,148,partially correct
497,"select distinct m.title, m.production_year, p.first_name, p.last_name
from movie_award as ma, movie as m, director as d, person as p 
where m.title = ma.title 
AND m.production_year = ma.production_year 
AND p.id = d.id 
AND m.title = d.title 
AND m.production_year = d.production_year
AND ma.award_name = 'BAFTA Film Award' AND LOWER(ma.category) = 'best film';",2018-08-15 19:19:51.782837+10,8,0,66,partially correct
498,"select distinct m.title, m.production_year, p.first_name, p.last_name
from movie_award as ma, movie as m, director as d, person as p 
where m.title = ma.title 
AND m.production_year = ma.production_year 
AND p.id = d.id 
AND m.title = d.title 
AND m.production_year = d.production_year
AND ma.award_name = 'BAFTA Film Award' AND ma.category = 'best film' AND ma.result = 'won';",2018-08-15 19:23:22.537463+10,8,1,66,correct
499,"select distinct m.title, m.production_year, p.first_name, p.last_name
from movie_award as ma, movie as m, director as d, person as p 
where m.title = ma.title 
AND m.production_year = ma.production_year 
AND p.id = d.id 
AND m.title = d.title 
AND m.production_year = d.production_year
AND ma.award_name = 'BAFTA Film Award' AND ma.category = 'best film' AND ma.result = 'won';",2018-08-15 19:23:49.866993+10,8,1,66,correct
500,"WITH test AS
(SELECT DISTINCT id AS id, COUNT(*) AS unique_movies
FROM
	(SELECT d.id, d.title, d.production_year FROM director d
	 union
	 SELECT w.id, w.title, w.production_year FROM writer w)
GROUP BY id)

SELECT id
FROM test
WHERE unique_movies = (SELECT max(unique_movies) FROM test);
",2018-08-15 19:26:34.391568+10,14,1,27,correct
501,"WITH test AS 
	(SELECT id, count(*) AS total
	FROM role
	GROUP BY id)

SELECT first_name, last_name, role.*
FROM test NATURAL JOIN person NATURAL JOIN role
WHERE total = (SELECT max(total) FROM test);",2018-08-15 19:34:39.370255+10,15,0,27,partially correct
502,"WITH test AS 
	(SELECT id, count(*) AS total
	FROM role
	GROUP BY id)

SELECT first_name, last_name, role.title, role.production_year, role.description
FROM test NATURAL JOIN person NATURAL JOIN role
WHERE total = (SELECT max(total) FROM test);",2018-08-15 19:36:01.460373+10,15,1,27,correct
503,"SELECT COUNT(*)
FROM Person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id = person.id AND person.year_born = 1935);
",2018-08-15 19:38:45.140781+10,1,1,148,correct
504,"select count(*) from writer_award wa, writer w, person p 
where wa.id = w.id
AND wa.title = w.title
AND wa.production_year = w.production_year
AND w.id = p.id
AND p.first_name = 'Woody'
AND p.last_name = 'Allen'
AND wa.result = 'won';",2018-08-15 19:38:49.653844+10,9,1,66,correct
505,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM(SELECT title, production_year
		FROM movie_award
		WHERE
		lower(award_name)='bafta film award' 
		AND lower(category)='best film' 
		AND lower(result)='won') AS ma,
	person AS p,
	director AS d
WHERE 
		ma.title=d.title
		AND ma.production_year=d.production_year
		AND p.id=d.id;",2018-08-15 19:39:02.471431+10,8,1,124,correct
506,"SELECT COUNT (*),production_year FROM movie
WHERE production_year IN (1991,1992,1993)
GROUP BY production_year;",2018-08-15 19:49:03.80987+10,2,1,148,correct
507,"SELECT production_year, COUNT (*) 
FROM movie
WHERE production_year IN (1991,1992,1993)
GROUP BY production_year;",2018-08-15 19:51:13.546365+10,2,1,148,correct
508,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS(SELECT * FROM director WHERE director.id = person.id);",2018-08-15 19:57:51.637029+10,12,1,148,correct
509,"SELECT COUNT(*)
FROM 
	writer_award AS wa,
	person AS p
WHERE
	(p.id=wa.id,
	AND lower(p.first_name)='woody',
	AND lower(p.last_name)='allen',
	AND wa.producton_year>1990,
	AND wa.production_year<1996);",2018-08-15 20:00:59.167896+10,9,0,124,noninterpretable
9672,;,2018-08-31 10:19:33.478687+10,11,0,401,noninterpretable
512,"select p.id, p.first_name, p.last_name from (select id from (select * from director d natural join writer w where d.id = w.id and d.title = w.title and d.production_year = w.production_year) l group by id having count(*) >= 2) l left join person p where p.id = l.id;",2018-08-15 20:28:03.612766+10,4,1,58,correct
513,"select w.title, w.production_year from person p natural join writer w where p.id = w.id and p.first_name = ""Kevin"" and p.last_name = ""Williamson"";",2018-08-15 20:37:43.487816+10,5,1,58,correct
514,"select country from restriction r where r.title = ""Shakespeare in Love"" and r.description = ""M"";",2018-08-15 20:42:32.189629+10,6,1,58,correct
515,"select id, first_name, last_name from (select id, first_name, last_name, max(year_born) from person); ",2018-08-15 20:52:35.173074+10,7,1,58,correct
516,"SELECT person.id, person.first_name, person.last_name
FROM director NATURAL JOIN writer
ON director.title = writer.title
GROUP BY person.id, person.first_name, person.last_name
HAVING COUNT(director.title)>1;",2018-08-15 21:55:50.220202+10,4,0,148,noninterpretable
517,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-15 21:59:59.761691+10,4,1,148,correct
518,"select p.id,p.first_name,p.last_name
from writer w
inner join 
person p
on p.id = w.id
group by p.id
having count(*) > 1;",2018-08-15 22:22:27.833465+10,4,0,43,partially correct
519,"select hehe.id,hehe.first_name,hehe.last_name
from (writer w
inner join 
director d
on w.id =d.id and w.title = d.title and w.production_year = d.production_year
inner join
person p
on d.id = p.id) as hehe
group by hehe.id
having count(*) > 1;",2018-08-15 22:29:16.347113+10,4,1,43,correct
520,"SELECT id
FROM(SELECT id, title, production_year
FROM 
	scene s,
	movie m,
	role r,
	person p
WHERE
	p.id=r.id
	AND lower(m.title)='psycho'
	AND m.production_year='1960'
	AND s.title=m.title
	AND m.title=r.title
	AND s.production_year=m.production_year
	AND m.production_year=r.production_year),
person p
WHERE HAVING COUNT(id)=1;",2018-08-15 22:34:14.456319+10,10,0,124,noninterpretable
521,"select r1.country
from restriction r1
where lower(r1.title) = ""shakespeare in love"" and  exists(
select * from restriction r2 where lower(r2.description) = ""m"");",2018-08-15 22:36:06.819743+10,6,0,43,partially correct
522,"select r1.country
from restriction r1
where lower(r1.title) = ""shakespeare in love"" and  exists(
select * from restriction r2 where 
r1.title = r2.title and
r1.production_year = r2.production_year and
r1.description = r2.description and
r1.country = r2.country and 
lower(r2.description) = ""m"");",2018-08-15 22:38:45.200527+10,6,1,43,correct
523,"select id,first_name,last_name
from person
order by year_born desc
limit 1;",2018-08-15 22:40:19.867362+10,7,1,43,correct
524,"SELECT r.id
FROM 
	role r,
	scene s,
	appearance a
WHERE
	s.title=a.title
	AND a.title=r.title
	AND s.production_year=a.production_year
	AND a.production_year=r.production_year
	AND s.scene_no=a.scene_no
	AND r.description=a.description
	AND lower(a.title)='psycho'
	AND a.production_year=1960
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-15 22:46:02.181509+10,10,1,124,correct
525,"select ha.title,ha.production_year,ha.first_name,ha.last_name
from (person natural join
	director natural join
	movie_award) as ha
where lower(ha.award_name) = ""bafta film award"" and 
	lower(ha.category) = ""best film"" and
	lower(ha.result) = ""won"";",2018-08-15 22:57:40.082532+10,8,1,43,correct
526,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p natural join role r
group by (p.first_name,p.last_name,r.title,r.production_year,r.description)
having count(r.id) = (select max(he.cc) from (select count(r2.id) as cc from role r2 group by r2.id) as he group by he.cc);",2018-08-15 23:06:24.222003+10,15,0,43,noninterpretable
527,"SELECT COUNT(*) AS total_number
FROM movie
WHERE NOT EXISTS(
	SELECT 
		m.title
	FROM
		movie m,
		crew_award ca,
		movie_award ma,
		director_award da,
		writer_award wa,
		actor_award aa
	WHERE
		m.title=ca.title
		AND m.title=ma.title
		AND m.title=da.title
		AND m.title=wa.title
		AND m.title=aa.title
		);",2018-08-15 23:06:56.837466+10,11,0,124,partially correct
528,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-15 23:10:38.660801+10,15,1,43,correct
529,";
",2018-08-15 23:12:06.435705+10,5,0,148,noninterpretable
530,"SELECT writer.title, writer.production_year
FROM writer, person
WHERE writer.id = person.id AND person.first_name = 'Kevin' AND person.last_name = 'Williamson';",2018-08-15 23:18:10.364904+10,5,1,148,correct
531,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM director d WHERE d.id = p.id AND d.production_year=null);",2018-08-15 23:25:24.327641+10,12,0,68,partially correct
532,"SELECT COUNT(*) AS total_number
FROM movie m
WHERE NOT EXISTS(
	SELECT title, production_year
	FROM movie_award ma
	WHERE lower(ma.result)='won' AND ma.title=m.title AND ma.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM crew_award ca
	WHERE lower(ca.result)='won' AND ca.title=m.title AND ca.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM director_award da
	WHERE lower(da.result)='won' AND da.title=m.title AND da.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM writer_award wa
	WHERE lower(wa.result)='won' AND wa.title=m.title AND wa.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM actor_award aa
	WHERE lower(aa.result)='won' AND aa.title=m.title AND aa.production_year=m.production_year);",2018-08-15 23:26:55.708793+10,11,1,124,correct
533,"SELECT country
FROM Restriction
WHERE Restriction.title = 'Shakespeare in Love'
AND description = ""M"";",2018-08-15 23:29:37.857833+10,6,1,148,correct
534,"SELECT id, first_name, last_name
FROM person
WHERE MIN(year_bor)
;",2018-08-15 23:35:46.878408+10,7,0,148,noninterpretable
535,"SELECT id, first_name, last_name
FROM person
WHERE person.year_born = (SELECT max(year_born)FROM person);",2018-08-15 23:40:17.648031+10,7,1,148,correct
536,"SELECT DISTINCT p.id,p.first_name,p.last_name
FROM person p, (SELECT COUNT(d.title) , d.id
FROM director d
GROUP BY d.id
HAVING count(d.title)>2) as h, writer w, director
WHERE h.id = p.id AND w.title = director.title;",2018-08-15 23:47:14.142548+10,4,0,68,partially correct
537,;,2018-08-16 00:39:58.596428+10,8,0,148,noninterpretable
538,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE award-name = 'BAFTA Film Award' AND ategory = 'Best Film' AND result = 'won') , director, person
WHERE movie_award.title = director.title AND movie_award.production_year = director.production_year AND director.id = person.id;
",2018-08-16 01:06:26.160681+10,8,0,148,noninterpretable
539,"SELECT ma.title, ma.production_year, person.first_name, person.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film' AND result = 'won') AS ma, director, person
WHERE ma.title = director.title AND ma.production_year = director.production_year AND director.id = person.id;
",2018-08-16 01:08:59.97472+10,8,0,148,partially correct
540,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-16 01:12:43.94638+10,8,1,148,correct
541,"SELECT COUNT(*)
FROM (SELECT year_of_award, result
      FROM Writer_Award
	WHERE
	 1991< year_of_award < 1996
	 AND result = 'won') AS aw,
	 (SELECT first_name, last_name
	 FROM person
	 WHERE first_name = 'Woody',last_name = 'Allen') AS per,
	 writer AS w
WHERE aw.id = w.id AND aw.production_year = w.production_year AND w.id = per.id;
",2018-08-16 01:32:57.793773+10,9,0,148,noninterpretable
542,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;


",2018-08-16 01:59:45.547193+10,9,1,148,correct
543,"SELECT person.id
FROM movie, role, appearance, person
WHERE movie.title = role.title = appearance.title AND movie.production_year = role.production_year = appearance.production_year
	AND role.id = person.id
	AND movie.title = 'Psycho'
	AND movie.production_year = 1960
	AND appearance.scene_no = 1;",2018-08-16 02:16:43.205071+10,10,0,148,partially correct
544,"select first_name, last_name from (select * from movie_award ma natural join director d natural join person p where ma.title = d.title and ma.production_year = d.production_year) where award_name = ""BAFTA Film Award"" and category = ""best film"" and result = ""won"";",2018-08-16 09:39:40.817093+10,8,0,58,partially correct
545,"select title, production_year, first_name, last_name from (select * from movie_award ma natural join director d natural join person p where ma.title = d.title and ma.production_year = d.production_year) where award_name = ""BAFTA Film Award"" and category = ""best film"" and result = ""won"";",2018-08-16 09:40:15.766822+10,8,1,58,correct
546,slect count(Writer.id) from Writer join Person where year_born = 1935;,2018-08-16 09:44:42.589016+10,1,0,151,noninterpretable
547,select count(*) from Writer w inner join Person p on w.id = p.id where year_born = 1935;,2018-08-16 09:46:58.568243+10,1,0,151,partially correct
548,"SELECT * FROM writer, person 
WHERE writer.id = person.id
and person.year_born = 1935;",2018-08-16 09:49:20.621726+10,1,0,152,partially correct
549,select count(*) from Writer w inner join Person p on w.id = p.id where year_born = '1935' group by w.id;,2018-08-16 09:49:32.487831+10,1,0,151,partially correct
550,select count(*) from (select * from Writer w inner join Person p on w.id = p.id where year_born = '1935' group by w.id);,2018-08-16 09:51:35.211351+10,1,1,151,correct
551,"select count(*) from (select * from writer_award where year_of_award >= 1991 and year_of_award <= 1995 and result = ""won"") as wa, writer as w, (select * from person where first_name = ""Woody"" and last_name = ""Allen"") as p where wa.title = w.title and wa.production_year = w.production_year and w.id = p.id;",2018-08-16 09:53:00.357704+10,9,1,58,correct
552,"select production_year, count(*) from movie where production_year = 1993 or production_year = 1991 or production_year = 1992 group by production_year ;",2018-08-16 10:10:22.309621+10,2,1,151,correct
553,"select r.id from appearance a natural join role r where a.title = ""Psycho"" and a.production_year = 1960 group by description having count(description) = 1;",2018-08-16 10:21:15.837972+10,10,1,58,correct
554,select count(*) from (select pp.* from person pp where not exists (select * from director d where pp.id = d.id ));,2018-08-16 10:25:36.081054+10,12,1,151,correct
555,"SELECT COUNT(*) FROM (SELECT year_born FROM person p
INNER JOIN writer w
ON p.id=w.id
WHERE p.year_born=1935) AS s;
",2018-08-16 11:54:18.974931+10,1,0,95,partially correct
556,"SELECT COUNT(*) FROM (SELECT DISTINCT p.id FROM writer w
INNER JOIN person p
ON w.id=p.id
WHERE p.year_born=1935) AS s;
",2018-08-16 12:07:08.918738+10,1,1,95,correct
557,"SELECT production_year, COUNT(title) AS noofmovies
FROM movie
WHERE production_year IN (1993,1992,1991)
GROUP BY production_year;",2018-08-16 12:16:36.834838+10,2,1,95,correct
558,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-16 12:20:59.2472+10,1,1,107,correct
559,"SELECT count(*)
FROM person p
WHERE NOT EXIST (SELECT * FROM director d WHERE d.id = p.id);",2018-08-16 12:27:19.697042+10,12,0,107,noninterpretable
560,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);",2018-08-16 12:28:50.1368+10,12,1,107,correct
561,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT * FROM movie m INNER JOIN director d ON m.id = d.id WHERE HAVING BY ); ",2018-08-16 12:34:49.956261+10,4,0,107,noninterpretable
562,"SELECT COUNT (*) FROM (SELECT p.id FROM person p
WHERE p.id NOT in
(SELECT DISTINCT d.id FROM director d)) AS re;",2018-08-16 12:35:17.231222+10,12,1,95,correct
563,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-16 12:37:50.897676+10,4,1,107,correct
564,"SELECT title, production_year
FROM movie m1
WHERE (SELECT * FROM person p INNER JOIN movie m2 ON p.id = m2.id WHERE first_name = ""Kevin"" AND last_name = ""Williamson"");",2018-08-16 12:47:44.541917+10,5,0,107,noninterpretable
565,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-16 12:49:00.593559+10,5,1,107,correct
566,"SELECT
    w.title, w.production_year
FROM
    (writer w INNER JOIN person p ON w.id = p.id)
WHERE
    lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-16 12:53:55.328397+10,5,1,107,correct
567,"SELECT p.id, p.first_name, p.last_name 
FROM person p 
WHERE p.id IN (SELECT id FROM (SELECT id,COUNT (id) AS count FROM (SELECT w.id FROM writer w
INNER JOIN director d
WHERE w.id=d.id) 
GROUP BY id
HAVING count>=2) AS re);",2018-08-16 13:07:56.869254+10,4,0,95,partially correct
568,"select count(*) from movie where not exists (select distinct title, production_year from movie_award union select distinct title, production_year from crew_award union select distinct title, production_year from director_award union select distinct title, production_year from writer_award union select distinct title, production_year from actor_award);",2018-08-16 13:20:55.969006+10,11,0,58,partially correct
569,"SELECT COUNT(*)
FROM WRITER INNER JOIN PERSON ON WRITER.Id=PERSON.Id
WHERE PERSON.Id=WRITER.Id;",2018-08-16 13:23:05.918455+10,1,0,64,partially correct
570,"SELECT writer.id, SUM(year_born) FROM writer, person Where writer.id=person.id GROUP BY writer.id HAVING SUM(year_born)=1935;
",2018-08-16 13:30:35.447427+10,1,0,155,partially correct
571,"SELECT p.id, p.first_name, p.last_name 
FROM person p 
WHERE p.id IN (SELECT re.id FROM (SELECT id,COUNT (id) AS count FROM (SELECT w.id FROM writer w
NATURAL JOIN director d
WHERE w.id=d.id) 
GROUP BY id
HAVING count>=2) AS re)
ORDER BY p.id;
",2018-08-16 13:31:00.403235+10,4,1,95,correct
572,"SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year = 1933 OR 1992 OR 1991
GROUP BY production_year;",2018-08-16 13:40:08.110419+10,2,0,64,partially correct
573,"SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year = 1993 OR  production_year =1992 OR  production_year =1991
GROUP BY production_year;",2018-08-16 13:41:54.742478+10,2,1,64,correct
574,"WITH secondYoungest AS (SELECT id, MAX(year_born) FROM person
WHERE year_born != (SELECT MAX(year_born) FROM person))

SELECT id FROM secondYoungest;",2018-08-16 13:57:06.814634+10,3,1,25,correct
575,"select count(year_born) from person, writer
where person.id = writer.id and person.year_born = 1935;",2018-08-16 13:57:56.515493+10,1,0,156,partially correct
576,"select count(year_born) from person, writer
where person.id = writer.id and person.year_born = 1935;",2018-08-16 13:58:18.149651+10,1,0,156,partially correct
577,"WITH never_won AS (SELECT * FROM director_award INNER JOIN director
USING(title,production_year)
WHERE result = 'nominated')

SELECT id, award_name, year_of_award, category FROM never_won;",2018-08-16 14:12:52.60712+10,13,1,25,correct
578,"SELECT production_year, count(title)
FROM movie
WHERE production_year = 1991 OR production_year = 1992 OR production_year = 1993
GROUP BY production_year;",2018-08-16 14:14:52.276765+10,2,1,144,correct
579,"SELECT count(*) FROM writer, person 
WHERE writer.id = person.id
and person.year_born = 1935;",2018-08-16 14:20:48.2613+10,1,0,152,partially correct
580,"SELECT COUNT(distinct dir.id)
FROM director dir
INNER JOIN movie mov ON dir.title = mov.title
WHERE dir.id != mov.title;",2018-08-16 14:21:42.253503+10,12,0,144,partially correct
581,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-16 14:26:03.389738+10,12,1,144,correct
582,"SELECT DISTINCT d.id, p.first_name, p.last_name
FROM person p
INNER JOIN director d ON p.id = d.id
INNER JOIN writer w ON d.id = w.id
WHERE d.title > 2 AND w.title > 2
ORDER BY p.last_name;",2018-08-16 14:31:59.322092+10,4,0,144,partially correct
583,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-16 14:32:49.661677+10,4,1,144,correct
584,"WITH worker AS (SELECT * FROM director NATURAL JOIN person
		NATURAL JOIN writer),

how_many AS (SELECT id, COUNT(ID) film_count FROM worker
GROUP BY id)

SELECT id FROM how_many
WHERE film_count = (SELECT MAX(film_count) FROM how_many);
",2018-08-16 14:34:35.087252+10,14,0,25,partially correct
585,"select id from person 
union 
select id from writer 
where year_born = '1935';",2018-08-16 14:42:08.553334+10,1,0,157,noninterpretable
586,"select count(*) from movie m where not exists (
select title, production_year from movie_award ma where lower(ma.result) = ""won"" and ma.title = m.title and ma.production_year = m.production_year 
union 
select title, production_year from crew_award ca where lower(ca.result) = ""won"" and ca.title = m.title and ca.production_year = m.production_year 
union 
select title, production_year from director_award da where lower(da.result) = ""won"" and da.title = m.title and da.production_year = m.production_year 
union 
select title, production_year from writer_award wa where lower(wa.result) = ""won"" and wa.title = m.title and wa.production_year = m.production_year 
union 
select title, production_year from actor_award aa where lower(aa.result) = ""won"" and aa.title = m.title and aa.production_year = m.production_year);",2018-08-16 15:07:36.962786+10,11,1,58,correct
587,"WITH worker AS (SELECT DISTINCT title, id FROM director
GROUP BY id,title
	
UNION 

SELECT DISTINCT title, id FROM writer
	GROUP BY id,title	),

id_count AS (SELECT id, COUNT(id) total FROM worker
GROUP BY id)

SELECT id FROM id_count
WHERE total = (SELECT MAX(total) FROM id_count)
;
",2018-08-16 15:10:37.87986+10,14,1,25,correct
588,"WITH role_info AS (SELECT * FROM role INNER JOIN person
USING(id)),

role_number AS (SELECT id, COUNT(ID) total FROM role_info
GROUP BY id)

SELECT first_name, last_name, title, production_year, description FROM role_info
WHERE id = (SELECT id FROM role_number 
		WHERE total = (SELECT MAX(total) FROM role_number));",2018-08-16 15:22:08.077606+10,15,1,25,correct
589,"SELECT DISTINCT m.title, m.production_year, p.first_name, p.last_name 
FROM movie m, writer w, person p
WHERE p.first_name = 'Kevin' 
AND p.last_name = 'Williamson'
AND P.id = w.id
ORDER BY m.production_year;",2018-08-16 15:22:08.405137+10,5,0,68,partially correct
590,"SELECT year_born, COUNT(id) as number
FROM PERSON inner join WRITER on id
GROUP BY id
WHERE year_born = 1935;
",2018-08-16 15:23:23.020017+10,1,0,150,noninterpretable
591,"select * from (select * from person where year_born < (select max(year_born) from person)) p 
where p.year_born = (select max(year_born) from (select * from person where year_born < (select max(year_born) from person)));",2018-08-16 15:27:57.361666+10,3,0,58,partially correct
592,"select p.id from (select * from person where year_born < (select max(year_born) from person)) p 
where p.year_born = (select max(year_born) from (select * from person where year_born < (select max(year_born) from person)));",2018-08-16 15:28:16.250029+10,3,1,58,correct
593,"SELECT DISTINCT m.country
FROM movie m, restriction_category r
WHERE 
 m.title = 'Shakespeare in Love'
AND r.description = 'M';",2018-08-16 15:31:30.233494+10,6,0,68,partially correct
594,"

SELECT p.first_name|| ' '|| p.last_name as youngest, p.id
FROM person p
ORDER BY p.year_born desc;",2018-08-16 15:39:10.500379+10,7,0,68,partially correct
595,"SELECT production_year, COUNT (*)
from MOVIE 
WHERE production_year = 1993 or production_year = 1992 or production_year = 1991
GROUP BY production_year;",2018-08-16 15:47:59.955723+10,2,1,150,correct
596,"SELECT d.title FROM director d
WHERE d.id = (SELECT CAST(p.id AS varchar(10)) FROM person p
WHERE p.first_name = ""Kevin"" AND p.last_name = ""Williamson"") ;


",2018-08-16 15:48:34.94947+10,5,0,95,partially correct
597,"SELECT w.title,w.production_year FROM writer w
WHERE w.id = (SELECT CAST(p.id AS varchar(10)) FROM person p
WHERE p.first_name = ""Kevin"" AND p.last_name = ""Williamson"") ;


",2018-08-16 15:51:12.25976+10,5,1,95,correct
598,"select id, award_name, year_of_award, category from director d natural join director_award da where result = ""nominated"";",2018-08-16 15:56:50.537057+10,13,1,58,correct
599,"select id, award_name, year_of_award, category from director d natural join director_award da where result = ""nominated"" and d.id not in
(select id from director d natural join director_award da where result = ""won"");",2018-08-16 15:58:28.585658+10,13,1,58,correct
600,select * from writer;,2018-08-16 16:02:36.837447+10,4,0,151,partially correct
601,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-16 16:03:34.369729+10,4,1,151,correct
602,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM director d, person p,movie m
WHERE m.title =
(SELECT m.title
FROM movie_award m, director d
WHERE d.title = m.title
AND m.award_name = 'BAFTA Film Award')
AND p.id = d.id;",2018-08-16 16:08:25.17945+10,8,0,68,partially correct
603,"SELECT DISTINCT c.id, m.title, m.award_name
	FROM movie AS m, crew AS c, movie_award AS a 
	WHERE lower(m.title) = 'gladiator' 
	AND lower(result) = 'won';",2018-08-16 16:08:53.003537+10,12,0,69,noninterpretable
604,"select m.title,m.production_year from writer w inner join movie m on w.title = m.title inner join person p on w.id = p.id where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-16 16:09:36.170192+10,5,1,151,correct
605,select COUNTRY  from Restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-16 16:12:31.699304+10,6,1,151,correct
606,"select p.id,p.first_name,p.last_name from person p where p.year_born = (select min(year_born) from person);",2018-08-16 16:14:29.632162+10,7,0,151,partially correct
607,"select p.id,p.first_name,p.last_name from person p where p.year_born = (select max(year_born) from person);",2018-08-16 16:15:02.39208+10,7,1,151,correct
608,select * from movie_award where award_name = 'BAFTA Film Award' and category = 'Best film' ;,2018-08-16 16:19:15.053446+10,8,0,151,partially correct
609,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-16 16:22:29.472167+10,8,1,151,correct
610,select count(*) from writer_award where id = (select id from person where first_name = 'Woody' and last_name = 'Allen') and year_of_award>=1991 and year_of_award<=1995;,2018-08-16 16:28:25.318176+10,9,0,151,partially correct
611,select count(*) from writer_award where id = (select id from person where first_name = 'Woody' and last_name = 'Allen') and year_of_award>=1991 and year_of_award<=1995 and result = 'won';,2018-08-16 16:30:00.389163+10,9,1,151,correct
612,"SELECT count(*)
FROM writer_award
WHERE EXISTS (SELECT *
FROM writer_award w 
WHERE w.title ='Woody Allen'
AND w.year_of_award>'1990'
AND w.year_of_award<'1996');",2018-08-16 16:35:20.700262+10,9,0,68,partially correct
613,select * from person where exists (select * from role r inner join scene s on s.title = r.title and s.production_year = r.production_year where s.title = 'Psycho' and s.production_year = 1960 and s.scene_no = 1);,2018-08-16 16:37:50.036041+10,10,0,151,partially correct
614,select * from role r inner join scene s on s.title = r.title and s.production_year = r.production_year where s.title = 'Psycho' and s.production_year = 1960 and r.production_year = 1960 and s.scene_no = 1;,2018-08-16 16:40:29.069488+10,10,0,151,partially correct
615,"SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS (SELECT *
FROM DIRECTOR d WHERE d.id = p.id GROUP BY id HAVING COUNT(title) = 0); ",2018-08-16 16:46:55.189429+10,12,0,150,partially correct
616,"SELECT r.id
FROM APPEARANCE a, role r
where a.title ='Psycho'
AND a.production_year = '1960'
AND a.scene_no=1
AND a.description = r.description;",2018-08-16 16:51:12.400831+10,10,0,68,partially correct
617,"SELECT
    *
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year and s.scene_no = a.scene_no

    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960 group by r.id having count(*)=1
;",2018-08-16 16:52:52.59662+10,10,0,151,partially correct
618,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year and s.scene_no = a.scene_no

    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960 group by r.id having count(*)=1
;",2018-08-16 16:53:26.059982+10,10,1,151,correct
619,"select id from (select id, count(id) as c1 from movie natural join director natural join writer group by id) where c1 = 
(select max(c2) from (select id, count(id) as c2 from movie natural join director natural join writer group by id));",2018-08-16 18:54:09.702288+10,14,0,58,partially correct
620,"select id from (select id, count(id) as c1 from (select d.id, title, production_year from director d union select w.id, title, production_year from writer w) group by id having c1 = 
(select max(c2) from (select id, count(id) as c2 from (select d.id, title, production_year from director d union select w.id, title, production_year from writer w) group by id)));",2018-08-16 19:10:08.634906+10,14,1,58,correct
621,"select first_name, last_name, title, production_year, description from (select id from (select id, count(id) as c1 from role group by id having c1 = (select max(c2) from (select id, count(id) as c2 from role group by id)))) natural join person natural join role;",2018-08-16 19:17:53.296645+10,15,1,58,correct
622,"select id, first_name, last_name, COUNT(id)>=2
from person p where exists (select * from writer w, director d, where d.id = p.id and p.id = w.id)
;",2018-08-16 21:06:53.277008+10,4,0,150,noninterpretable
623,"SELECT title,production_year
FROM (SELECT * FROM movie m inner join (writer inner join person p on p.id ) on m.title) where first_name = Kevin and last_name = Williamson GROUP BY first_name;",2018-08-16 21:37:47.601788+10,5,0,150,noninterpretable
624,"select count(*)
from movie m1
where not exists(select * from 
	     (select title, production_year  from movie_award m where lower(m.result) = ""won""
		union
		select title, production_year  from crew_award c where lower(c.result) = ""won""
		union
		select title, production_year  from director_award d where lower(d.result) = ""won""
		union
		select title, production_year  from writer_award w where lower(w.result) = ""won""
		union
		select title, production_year  from actor_award a where lower(a.result) = ""won"") as ha
		where m1.title = ha.title
		and m1.production_year = ha.production_year);",2018-08-16 22:15:40.68813+10,11,1,43,correct
625,"select p.id 
from person p
where p.year_born = (select max(ha.year_born) 
			from 
			(select p1.year_born 
			from person p1
			where p1.year_born != (select max(person.year_born) from person)) as ha);",2018-08-16 22:35:30.174665+10,3,1,43,correct
626,"select distinct d.id,da.award_name,da.year_of_award,da.category
from director d inner join director_award da
on d.title = da.title and d.production_year = da.production_year
where lower(da.result) = ""nominated"" and
not exists(select * 
		from director_award d2
		where d2.title = da.title 
		and
			d2.production_year = da.production_year 
			and
			lower(d2.result) = ""won"");",2018-08-16 22:45:47.177911+10,13,1,43,correct
627,"SELECT country
FROM RESTRICTION 
WHERE title = 'Shakespeare in Love';",2018-08-16 23:12:11.539869+10,6,0,150,partially correct
628,"SELECT country
FROM RESTRICTION 
WHERE title = 'Shakespeare in Love'
and description = 'M';",2018-08-16 23:13:23.085345+10,6,1,150,correct
629,"SELECT id, first_name, last_name
FROM (SELECT id, first_name, last_name, MAX(year_born)
FROM person
);",2018-08-16 23:23:12.240818+10,7,1,150,correct
630,"SELECT COUNT(*)
FROM (SELECT  DISTINCT W.id
FROM WRITER AS w,PERSON AS p
WHERE w.id = p.id AND p.year_born = 1935);",2018-08-17 02:24:38.251471+10,1,1,64,correct
631,"select count(*)
from person
where year_born = '1955';

",2018-08-17 02:34:42.537211+10,2,0,164,partially correct
632,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT DISTINCT d.id
FROM DIRECTOR d
WHERE d.id = p.id);",2018-08-17 02:38:22.46741+10,12,1,64,correct
633,"select count(*) from person p 
where exists (
	select * from writer w
	where p.id = w.id and p.year_born = 1935
);
",2018-08-17 08:22:34.974982+10,1,1,156,correct
634,"select sum(movie_num) from (
	select count(*) movie_num from movie
	where production_year = 1991 or production_year = 1992 or production_year = 1993
);",2018-08-17 08:31:54.452688+10,2,0,156,partially correct
635,"select sum(movie_num) from (
	select count(*) movie_num from movie
	where production_year = 1991 or production_year = 1992 or production_year = 1993
);",2018-08-17 08:34:15.341232+10,2,0,156,partially correct
636,"select production_year, count(*) movie_num from movie
where production_year = 1991 or production_year = 1992 or production_year = 1993
group by production_year;",2018-08-17 08:35:05.330693+10,2,1,156,correct
637,"select count(*) from (
	select id from person
	where id not in (
		select person.id from person,director
		where person.id = director.id
	)
);",2018-08-17 08:48:10.353664+10,12,1,156,correct
638,"select id, first_name, last_name from person,  (
	select id dwid,num from (
		select writer.id, count(*) num from writer, director
		where writer.id = director.id and writer.title = director.title
		group by writer.id
	)
	where num >= 2
) as dw
where person.id = dw.dwid;
",2018-08-17 12:30:09.958397+10,4,1,156,correct
639,"select title, production_year from writer w, person p
where w.id = p.id and p.first_name = ""Kevin"" and p.last_name = ""Williamson"";",2018-08-17 12:34:31.605886+10,5,1,156,correct
640,"select country from Restriction
where description = ""M"" and title = ""Shakespeare in Love"";",2018-08-17 12:43:26.880421+10,6,1,156,correct
641,"select count(*) from person 
where year_born = 1935;",2018-08-17 12:45:39.346589+10,1,0,130,partially correct
642,"select id, first_name, last_name from person
order by year_born desc
limit 1;",2018-08-17 12:46:01.367634+10,7,1,156,correct
643,"select id, first_name, last_name from person
where year_born = (
	select max(year_born) from person
);",2018-08-17 12:48:33.147414+10,7,1,156,correct
644,"select count(*) from 
person p

where exists(select * from writer w where w.id = p.id and p.year_born = 1935);",2018-08-17 12:57:56.709116+10,1,1,130,correct
645,"select ma.title, ma.production_year, first_name, last_name from movie_award ma, director d, person p
where award_name = ""BAFTA Film Award"" and category like ""%Best Film%"" and d.title = ma.title
	and d.production_year = ma.production_year and d.id = p.id;",2018-08-17 13:07:10.014551+10,8,0,156,partially correct
646,"select ma.title, ma.production_year, first_name, last_name from movie_award ma, director d, person p
where award_name = ""BAFTA Film Award"" and category like ""Best Film"" and d.title = ma.title
	and d.production_year = ma.production_year and d.id = p.id;",2018-08-17 13:07:37.835018+10,8,0,156,partially correct
647,"select ma.title, ma.production_year, first_name, last_name from movie_award ma, director d, person p
where award_name = ""BAFTA Film Award"" and category like ""Best Film"" and d.title = ma.title
	and d.production_year = ma.production_year and d.id = p.id and result = ""won"";",2018-08-17 13:10:35.551188+10,8,1,156,correct
648,"select count(*) from (
	select * from writer_award wa, person p
	where wa.id = p.id and p.first_name like ""Woody"" and p.last_name like ""Allen""
		and wa.year_of_award between 1991 and 1995 and result like ""won""
);

",2018-08-17 13:20:35.321783+10,9,1,156,correct
649,"select count(*) from writer_award wa, person p
where wa.id = p.id and p.first_name like ""Woody"" and p.last_name like ""Allen""
	and wa.year_of_award between 1991 and 1995 and result like ""won"";


",2018-08-17 13:21:31.019514+10,9,1,156,correct
650,"select da.title, da.production_year, p.first_name, p.last_name from movie_award as da, person as p, director as d where da.award_name = 'BAFTA Film Award' and da.category ='Best Film' and p.id =d.id and da.title = d.title;",2018-08-17 13:27:37.241958+10,8,0,99,partially correct
651,"SELECT COUNT(*) 
FROM writer INNER JOIN person ON writer.id =person.id 
WHERE person.year_born =1935; ",2018-08-17 14:14:43.401117+10,1,0,19,partially correct
652,"SELECT COUNT(distinct writer.id) 
FROM writer INNER JOIN person ON writer.id =person.id 
WHERE person.year_born =1935; ",2018-08-17 14:19:06.338232+10,1,1,19,correct
653,"select production_year,count(*)
from movie 
where production_year in (1991,1992,1993)
group by production_year;",2018-08-17 14:22:04.051335+10,2,1,19,correct
654,"select count(*)
from person,director 
where person.id is not null and person.id!=director.id;",2018-08-17 14:38:23.754403+10,12,0,19,partially correct
655,"select count(*)
from person
where not exists(select * from director where person.id=director.id);",2018-08-17 14:40:51.923903+10,12,1,19,correct
656,"select count(id)
from person
where not exists(select id from director where person.id=director.id);",2018-08-17 14:42:35.005594+10,12,1,19,correct
657,"select count(*)
from person, writer
where (year_born = '1935')
and (writer.id=person.id);
",2018-08-17 15:20:41.866484+10,1,0,164,partially correct
658,"select id from (
	select id,count(id) num from role
	where title like ""Psycho"" and production_year = 1960
	group by id
)
where num = 1;
",2018-08-17 15:23:29.595807+10,10,0,156,partially correct
659,"select count(*)
from person, writer
where (year_born = '1935')
and (writer.id=person.id);
",2018-08-17 15:25:51.806979+10,1,0,164,partially correct
660,;,2018-08-17 15:34:38.827263+10,4,0,64,noninterpretable
661,"select id from appearance a, role r
	where a.title like ""Psycho"" and a.production_year = 1960
		and a.title = r.title and a.production_year = r.production_year
		and a.description = r.description
	group by id
	having count(*) = 1
;",2018-08-17 15:38:25.782463+10,10,1,156,correct
662,"select count(*) from movie 
where title not in (select title from movie_award where result like ""won"")
and title not in (select title from crew_award where result like ""won"")
and title not in (select title from director_award where result like ""won"")
and title not in (select title from writer_award where result like ""won"")
and title not in (select title from actor_award where result like ""won"");",2018-08-17 15:49:55.663505+10,11,0,156,partially correct
663,"
select count(*) from movie m
where title not in (select title from movie_award ma where result like ""won""
	and ma.title = m.title and ma.production_year = m.production_year)
	and title not in (select title from crew_award ca where result like ""won""
	and ca.title = m.title and ca.production_year = m.production_year)
	and title not in (select title from director_award da where result like ""won""
	and da.title = m.title and da.production_year = m.production_year)
	and title not in (select title from writer_award wa where result like ""won""
	and wa.title = m.title and wa.production_year = m.production_year)
	and title not in (select title from actor_award aa where result like ""won""
	and aa.title = m.title and aa.production_year = m.production_year);",2018-08-17 15:58:52.66169+10,11,1,156,correct
664,"select id from person
where year_born = (
	select max(year_born) from person
	where year_born < (select max(year_born) from person)
	order by year_born
);

",2018-08-17 16:05:55.463259+10,3,1,156,correct
665,"select d.id, dw.award_name , dw.year_of_award, dw.category 
from director_award dw, director d
where dw.title = d.title and dw.production_year = d.production_year 
	and dw.result like ""nominated""
	and not exists (select * from director where result like ""won"");",2018-08-17 16:14:50.92408+10,13,1,156,correct
666,"select distinct id from (
	select id,title,production_year from writer union select * from director
) as wo, (
	select title, production_year from (
		select m.title, m.production_year, count(*) num from movie m, (
			select id,title,production_year from writer union select * from director
		) as wo 
		where wo.title = m.title and wo.production_year = m.production_year
		group by m.title, m.production_year
	)
	where num = (
		select max(num) from (
			select m.title, m.production_year, count(*) num from movie m, (
				select id,title,production_year from writer union select * from director
			) as wo 
			where wo.title = m.title and wo.production_year = m.production_year
			group by m.title, m.production_year
		)
	)
) as nm
where wo.title = nm.title and wo.production_year = nm.production_year
;",2018-08-17 17:06:26.687892+10,14,0,156,partially correct
667,"select id from (
	select id,count(*) num from(
		select * from director union select id,title,production_year from writer 
	) as wo
	group by id
) as t
where t.num = (
	select max(num) from (
		select id,count(*) num from(
			select * from director union select id,title,production_year from writer 
		) as wo
	group by id
	)
);",2018-08-17 17:19:03.614449+10,14,1,156,correct
668,"select p.first_name, p.last_name, r.title, r.production_year, r.description 
from role r, person p, (
	select id,count(id) num from role
	group by id
) as t
where r.id = t.id and t.num = (select max(num) from (
	select id,count(id) num from role
	group by id))
	and r.id = p.id
;",2018-08-17 17:33:08.320095+10,15,1,156,correct
669,"SELECT dw.title,dw.production_year, dw.first_name, dw.last_name
FROM (SELECT * FROM PERSON p INNER JOIN DIRECTOR d ON p.id ) INNER JOIN  (SELECT * from MOVIE_AWARD a WHERE award_name = ""BAFTA Film Award"" and 
category = 'Best Film') on d.title) AS dw;",2018-08-17 17:46:39.148219+10,8,0,150,noninterpretable
670,"select count(*)
from writer
group by production_year having production_year = '1935';",2018-08-17 17:54:20.227585+10,1,0,167,partially correct
671,"select count(*)
from person
group by year_born having year_born = '1935';",2018-08-17 18:00:01.701732+10,1,0,167,partially correct
672,"select count(*)
from person
group by year_born having year_born = '1935';",2018-08-17 18:01:06.41172+10,1,0,167,partially correct
673,"select production_year, count(*) as number
from movie
where production_year = '1991' or production_year = '1992' or production_year = '1993'
group by production_year;
",2018-08-17 18:22:14.199015+10,2,1,167,correct
674,"select count(*)
from writer,person
where person.id = writer.id
group by year_born 
having year_born = '1935';",2018-08-17 18:28:07.685343+10,1,0,167,partially correct
675,"select count(*)
from (select id,year_born
from person
where year_born = '1935' and person.id in (select id from writer))as l;



",2018-08-17 18:34:43.294025+10,1,1,167,correct
676,"select count(*)
from (select distinct person.id
from person,director
where person.id != director.id) as l;",2018-08-17 18:41:45.359664+10,12,0,167,partially correct
677,"select count(*) from(select id from person
where person.id not in (select distinct id from director)) as l;",2018-08-17 18:48:50.259159+10,12,1,167,correct
678,"select count(*)
from writer_award wa
where exists( select *
from person p
where wa.id=p.id 
and wa.result='won'
and p.first_name='Woody' 
and p.last_name='Allen' 
and wa.year_of_award>1990 
and wa.year_of_award<1996);
",2018-08-17 19:32:43.007623+10,9,1,94,correct
679,"SELECT production_year, COUNT(DISTINCT title) 
FROM movie
GROUP BY production_year
HAVING production_year = 1993 OR production_year = 1992 OR  production_year = 1991
ORDER BY production_year DESC;",2018-08-17 20:37:56.911078+10,2,1,93,correct
680,"SELECT COUNT(*) FROM person
WHERE person.id NOT IN(
SELECT DISTINCT director.id FROM director);",2018-08-17 20:47:17.402588+10,12,1,93,correct
681,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-17 20:53:09.509862+10,1,1,164,correct
682,"select distinct p.id, p.first_name, p.last_name from person p
where p.id in
(select w.id from writer w, director d
where w.title = d.title and w.id = d.id
group by w.id
having count(w.id)>=2);


",2018-08-17 21:10:28.067833+10,4,1,93,correct
683,"select m.title, m.production_year 
from movie m natural join writer w natural join person p
where p.first_name like 'Kevin' and p.last_name like 'Williamson';

",2018-08-17 21:24:04.865374+10,5,1,93,correct
684,"select country from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-17 21:28:15.421749+10,6,1,93,correct
685,"select id, first_name, last_name
from person 
order by year_born desc limit 1;",2018-08-17 21:37:06.186684+10,7,1,93,correct
686,"select title,production_year from writer
where writer.id in (select id from person
where first_name = 'Kevin' and last_name = 'Williamson');",2018-08-17 21:38:18.042365+10,5,1,167,correct
687,"select production_year,count(*)
from movie 
where production_year in(1991,1992,1993)
group by production_year;",2018-08-17 21:38:23.853749+10,2,1,130,correct
688,"select country from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-17 21:43:15.997672+10,6,1,167,correct
689,"select count(*) from person,director
where person.id != director.id;",2018-08-17 21:45:39.785793+10,12,0,130,partially correct
690,"select id, first_name, last_name from person
order by year_born desc
limit 1;",2018-08-17 21:45:42.140744+10,7,1,167,correct
691,"select count(*) from person;
",2018-08-17 21:56:33.231713+10,7,0,164,partially correct
692,"select count(*) from person p
where not exists (select * from director d where d.id=p.id);",2018-08-17 22:11:45.285644+10,12,1,130,correct
693,"select count(*) from writer_award
inner join (select id from person
where first_name = 'Woody' and last_name = 'Allen') as l
on l.id = writer_award.id
where year_of_award between '1991' and '1995';",2018-08-17 22:24:13.369591+10,9,0,167,partially correct
694,"select a.title, a.production_year, p.first_name, p.last_name
from movie_award a natural join director d natural join person p
where award_name like 'BAFTA Film Award' and category like 'Best Film';",2018-08-17 22:26:41.986378+10,8,0,93,partially correct
695,"select a.title, a.production_year, p.first_name, p.last_name
from movie_award a natural join director d natural join person p
where award_name like 'BAFTA Film Award' and category like 'Best Film' and result = 'won';",2018-08-17 22:28:36.670422+10,8,1,93,correct
696,"select count(*)as number from writer_award
inner join (select id from person
where first_name = 'Woody' and last_name = 'Allen') as l
on l.id = writer_award.id
where year_of_award between '1991' and '1995';",2018-08-17 22:33:39.090043+10,9,0,167,partially correct
697,"select id, first_name,last_name from person p
	where exists (select count(*) as count_num from director d inner join writer w
	on d.title = w.title );",2018-08-17 22:35:42.482684+10,4,0,130,partially correct
698,"select count(a.title)
from writer_award a, person p
where a.id = p.id and year_of_award >= 1991 and year_of_award <=1995 and result like 'Won'
and p.first_name like 'Woody'and p.last_name like 'Allen';",2018-08-17 22:47:35.726254+10,9,1,93,correct
699,"select id from role r
join scene s on r.title = s.title
where s.title like 'Psycho' and s.production_year = '1960'
group by id
having count(id)=1
;",2018-08-17 23:46:38.631222+10,10,0,93,partially correct
700,;,2018-08-17 23:54:11.862024+10,1,0,138,noninterpretable
701,"select p.id,p.first_name,p.last_name from person p
inner join director d on p.id = d.id
inner join writer w on d.id = w.id
group by p.id
having count(*)>2;
",2018-08-18 00:05:02.802499+10,4,1,130,correct
702,select * from movie;,2018-08-18 00:10:16.488995+10,13,0,164,partially correct
703,select * from movie;,2018-08-18 00:10:45.639179+10,15,0,164,partially correct
704,"select w.title, w.production_year from writer w 
inner join person p on p.id = w.id
where p.first_name like '%Kevin%' and p.last_name like '%Williamson%';",2018-08-18 00:13:16.541379+10,5,1,130,correct
705,"select first_name, last_name from person
where id in (select director.id from director,writer
where director.title = writer.title and director.production_year = writer.production_year and director.id = writer.id);",2018-08-18 09:20:46.513425+10,4,0,167,partially correct
706,"select first_name, last_name from person
where id in (select distinct director.id from director,writer
where director.title = writer.title and director.production_year = writer.production_year and director.id = writer.id);",2018-08-18 09:21:31.460241+10,4,0,167,partially correct
707,"select first_name, last_name from person
where id in (select director.id from director,writer
where director.title = writer.title and director.production_year = writer.production_year and director.id = writer.id
group by director.id having count(*) >1);",2018-08-18 09:26:28.481622+10,4,0,167,partially correct
708,"select id,first_name, last_name from person
where id in (select director.id from director,writer
where director.title = writer.title and director.production_year = writer.production_year and director.id = writer.id
group by director.id having count(*) >1);",2018-08-18 09:31:32.495562+10,4,1,167,correct
709,"select ma.title, ma.production_year, p.first_name, p.last_name from movie_award as ma, person as p, director as d
where lower (ma.award_name) = 'bafta film award' and lower (ma.category) = 'best film' and p.id =d.id and ma.title = d.title;",2018-08-18 09:48:58.444966+10,8,0,99,partially correct
710,"select ma.title, ma.production_year, p.first_name, p.last_name from movie_award as ma, person as p, director as d
where lower (ma.award_name) = 'bafta film award' and lower (ma.category) = 'best film' and p.id =d.id and ma.title = d.title and lower(ma.result) = 'won';",2018-08-18 09:50:20.366462+10,8,1,99,correct
711,"select person.first_name,person.last_name,movie_award.title, movie_award.production_year
from person, director, movie_award
where person.id = director.id and director.title = movie_award.title and director.production_year = movie_award.production_year and movie_award.award_name = 'BAFTA Film Award';",2018-08-18 10:02:36.858548+10,8,0,167,partially correct
712,"select person.first_name,person.last_name,movie_award.title, movie_award.production_year
from person, director, movie_award
where person.id = director.id and director.title = movie_award.title and director.production_year = movie_award.production_year and movie_award.award_name = ""BAFTA Film Award"";",2018-08-18 10:04:30.07739+10,8,0,167,partially correct
713,"select count(wa.id) from writer_award as wa, person as p where wa.id = p.id and year_of_award >=1991 and year_of_award <=1995 and p.id = (select q.id from person as q where q.first_name ='Woody' and q.last_name = 'Allen');",2018-08-18 10:04:45.945635+10,9,0,99,partially correct
714,"select count(*) from writer_award as wa, person as p, writer as w 
where wa.title= w.title 
and wa.id = p.id
and w.id =p.id
and year_of_award >=1991 
and year_of_award <=1995 
and p.id = (select q.id from person as q where q.first_name ='Woody' and q.last_name = 'Allen')
and lower(wa.result) = 'won';",2018-08-18 10:18:19.554177+10,9,1,99,correct
715,"SELECT COUNT(*) 
FROM WRITER, PERSON
WHERE WRITER.id = PERSON.ID
GROUP BY WRITER.id
HAVING PERSON.year_born = 1935;",2018-08-18 10:21:11.606675+10,1,0,169,partially correct
716,select ;,2018-08-18 10:23:47.400203+10,10,0,99,noninterpretable
717,"SELECT COUNT(*) 
FROM person AS p
WHERE EXISTS (SELECT * FROM writer AS w WHERE p.id = w.id AND p.year_born = 1935);",2018-08-18 10:30:03.286806+10,1,1,169,correct
718,"SELECT production_year, COUNT(*)
FROM movie AS m
WHERE m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991
GROUP BY production_year;",2018-08-18 10:33:59.10647+10,2,1,169,correct
719,"SELECT COUNT(*)
FROM person AS p
WHERE NOT EXISTS (SELECT * FROM director AS d WHERE p.id = d.id);",2018-08-18 10:38:38.693003+10,12,1,169,correct
720,"SELECT p.id, p.first_name, p.last_name
FROM person AS p
WHERE EXISTS (SELECT * FROM director AS d,writer AS w WHERE p.id = d.id AND d.id = w.id);",2018-08-18 10:43:18.432628+10,4,0,169,partially correct
721,"select role.id
from role
where role.description in (select a.description
from appearance as a
where a.title = 'Psycho' and a.production_year = '1960'
group by a.description
having count(*) = 1);",2018-08-18 10:46:45.739941+10,10,0,167,partially correct
722,"SELECT a.id, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) as a
GROUP BY a.id
HAVING COUNT(*) > 1;",2018-08-18 10:47:26.706854+10,4,1,169,correct
723,"select role.id
from role
where role.description in (select a.description
from appearance as a
where a.title = 'Psycho' and a.production_year = '1960'
group by a.description
having count(*) = 1) and role.title = 'Psycho' and role.production_year = '1960';
",2018-08-18 10:58:31.791209+10,10,1,167,correct
724,"select res.country from restriction res, restriction_category rc 
where res.title = 'Shakespeare in Love' and res.description ='M'
group by res.country;",2018-08-18 11:00:39.18388+10,6,1,130,correct
725,"select res.country from restriction res 
where res.title = 'Shakespeare in Love' and res.description ='M'
group by res.country;",2018-08-18 11:01:35.958207+10,6,1,130,correct
761,"select production_year, count(*)
from movie
group by production_year
having production_year>1990 and production_year<1994;",2018-08-18 15:13:37.917733+10,2,1,176,correct
726,"SELECT m.title, m.production_year 
FROM movie AS m
WHERE EXISTS (SELECT w.title 
              FROM writer AS w
              WHERE EXISTS (SELECT * FROM person AS p 
                            WHERE p.id = w.id AND w.title = m.title AND p.last_name = ""Williamson"" AND p.first_name = ""Kevin""));",2018-08-18 11:04:11.795869+10,5,1,169,correct
727,"select id, first_name,last_name,max(year_born) from person;
",2018-08-18 11:10:44.125054+10,7,0,130,partially correct
728,"select id, first_name,last_name from person p 
where year_born = (select max(year_born) from person) ;
",2018-08-18 11:17:59.763385+10,7,1,130,correct
729,"SELECT COUNT (*)
FROM (SELECT * FROM PERSON p WHERE year_born = 1935) INNER JOIN WRITER w on w.id ;",2018-08-18 12:40:26.556553+10,1,0,150,partially correct
730,"SELECT COUNT(*) FROM writer INNER JOIN person
USING(id)
WHERE year_born = 1935;",2018-08-18 12:40:37.151628+10,1,0,25,partially correct
731,"SELECT COUNT(*)
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935
GROUP BY PERSON.id;",2018-08-18 12:42:25.008115+10,1,0,173,partially correct
732,"SELECT COUNT(DISTINCT PERSON.id)
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935
;",2018-08-18 12:47:42.105666+10,1,1,173,correct
733,"SELECT COUNT(DISTINCT person.id)
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935;",2018-08-18 12:51:42.897896+10,1,1,173,correct
734,"WITH ids AS (SELECT id FROM writer INNER JOIN person
USING(id)
WHERE year_born = 1935),

no AS (SELECT id FROM ids 
GROUP BY id)

SELECT count(*) FROM no

;",2018-08-18 12:53:24.132579+10,1,1,25,correct
735,"select 
	id 
from 
	role r
join scene s on r.title = s.title 
	and r.production_year = s.production_year 
join appearance a on s.scene_no = a.scene_no 
	and s.production_year = a.production_year 
	and a.title = s.title 
	and a.description = r.description
where 
	s.title like 'Psycho' and s.production_year = '1960'
group by 
	id
having 
	count(id)=1
;",2018-08-18 13:09:11.374928+10,10,1,93,correct
736,"select production_year, COUNT(title, production_year)
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY title, production_year;",2018-08-18 13:12:24.25079+10,2,0,173,noninterpretable
737,"SELECT production_year, COUNT(title) FROM movie 
WHERE production_year = 1993

UNION

SELECT production_year, COUNT(title) FROM movie 
WHERE production_year = 1992

UNION

SELECT production_year, COUNT(title) FROM movie 
WHERE production_year = 1991;",2018-08-18 13:19:03.473177+10,2,1,25,correct
738,"SELECT COUNT(*) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-18 13:20:14.321637+10,12,1,25,correct
739,"WITH director_writer AS (SELECT p.id, first_name, last_name FROM person p
WHERE p.id IN (SELECT id  FROM writer w NATURAL JOIN director d))

SELECT COUNT(*) FROM director_writer
WHERE id IN (SELECT id FROM director);

",2018-08-18 13:32:51.741267+10,4,0,25,partially correct
740,"select production_year, COUNT(*)
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-18 13:37:24.706619+10,2,1,173,correct
741,"WITH morethantwo AS (SELECT id, COUNT(ID) tot  FROM writer w NATURAL JOIN director d
GROUP BY id
HAVING tot >= 2)

SELECT id, first_name, last_name FROM person
WHERE id IN (SELECT id FROM morethantwo);

",2018-08-18 13:38:06.474482+10,4,1,25,correct
742,"SELECT title,production_year FROM movie m INNER JOIN writer w
USING(title,production_year)
INNER JOIN person
USING(id)
WHERE first_name = 'Kevin' AND  last_name = 'Williamson';",2018-08-18 13:43:03.809277+10,5,1,25,correct
743,"select production_year, COUNT(*)
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-18 13:43:49.90966+10,2,1,173,correct
744,"SELECT country FROM restriction
WHERE lower(title) = 'shakespeare in love' AND description = 'M';",2018-08-18 13:44:53.615097+10,6,1,25,correct
745,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MIN(year_born) FROM person);",2018-08-18 13:48:55.1088+10,7,0,25,partially correct
746,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-18 13:49:17.432358+10,7,1,25,correct
747,"select person.first_name, person.last_name,movie_award.title, movie_award.production_year
from person, director, movie_award
where person.id = director.id and director.title = movie_award.title and director.production_year = movie_award.production_year and 
lower(movie_award.award_name) = ""bafta film award"" and lower(movie_award.category) = 'best film';",2018-08-18 13:52:15.819178+10,8,0,167,partially correct
748,"select person.first_name, person.last_name,movie_award.title, movie_award.production_year
from person, director, movie_award
where person.id = director.id and director.title = movie_award.title and director.production_year = movie_award.production_year and 
lower(movie_award.award_name) = ""bafta film award"" and lower(movie_award.category) = 'best film' and lower(movie_award.result) = 'won';",2018-08-18 13:53:54.752089+10,8,1,167,correct
749,"SELECT title,d.production_year, p.first_name, p.last_name FROM movie_award ma INNER JOIN director d
USING(title)
INNER JOIN person p
USING(id)
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' ;",2018-08-18 13:55:04.120095+10,8,0,25,partially correct
750,"
select count(title)
from movie
where title not in
(select distinct title 
from movie_award
union
select distinct title 
from crew_award
union
select distinct title 
from director_award
union
select distinct title 
from writer_award
union
select distinct title 
from actor_award) 
;",2018-08-18 13:57:45.594105+10,11,0,93,partially correct
751," select l.title, l.production_year,p.first_name, p.last_name
 from person as p, director as d, (select title, production_year
from movie_award as m
where lower(m.award_name) = ""bafta film award"" and lower(m.category) = 'best film' and lower(m.result) = 'won') as l
where d.id = p.id and d.title = l.title and d.production_year = l.production_year;",2018-08-18 14:04:00.102001+10,8,1,167,correct
752,"
select count(title)
from movie
where title not in
(
select title 
from movie_award
where lower(result) = 'won'
union
select title 
from crew_award
where lower(result) = 'won'
union
select title 
from director_award
where lower(result) = 'won'
union
select title 
from writer_award
where lower(result) = 'won'
union
select title 
from actor_award
where lower(result) = 'won'
)
;",2018-08-18 14:06:52.238372+10,11,0,93,partially correct
753,"select count(*)as number from writer_award
inner join (select id from person
where first_name = 'Woody' and last_name = 'Allen') as l
on l.id = writer_award.id
where year_of_award between '1991' and '1995' and lower(result) = 'won' ;",2018-08-18 14:08:26.906994+10,9,1,167,correct
754,"WITH movie_info AS (SELECT * FROM director INNER JOIN movie
USING(title,production_year)
INNER JOIN person
USING(id)),


winners AS (SELECT * FROM movie_award
			WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND lower(result) = 'won')

SELECT title, production_year, first_name,last_name FROM movie_info
WHERE title IN (SELECT title FROM winners);",2018-08-18 14:13:30.393001+10,8,1,25,correct
755,"SELECT DISTINCT
(SELECT COUNT( Distinct id)
FROM person)-
(SELECT COUNT( Distinct id)
FROM DIRECTOR)
FROM PERSON, DIRECTOR;
",2018-08-18 14:34:01.750441+10,12,1,173,correct
756,"select id from person
where person.year_born in(select year_born
from person
group by year_born
order by year_born desc
limit 1,1);
",2018-08-18 14:42:00.398443+10,3,1,167,correct
757,"SELECT count(*),person.year_born FROM writer, person where writer.id=person.id and year_born=1935 group by year_born;",2018-08-18 14:51:00.627273+10,1,0,33,partially correct
758,"with no as
(select count(*) as no_years, year_born
from person natural join writer
group by year_born)

select count(no_years)
from no
where year_born = 1935;",2018-08-18 14:57:53.076542+10,1,1,176,correct
759,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person as p, role as r
where p.id = r.id and p.id in (select id from role
group by id
order by count(*) desc
limit 1);",2018-08-18 15:06:28.961696+10,15,1,167,correct
760,"select production_year, count(*)
from movie
group by production_year
having production_year=1993 and production_year=1992 and production_year=1991;",2018-08-18 15:11:59.631604+10,2,0,176,partially correct
762,SELECT count(*)from person as p where p.id in (SELECT w.id from writer as w where w.id=p.id and p.year_born=1935); ,2018-08-18 15:23:20.483941+10,1,1,33,correct
763,"select d.id, a.award_name, a.year_of_award, a.category
from director as d, director_award as a
where d.id in (select distinct d.id
			from director as d, director_award as a
				where d.title = a.title and d.production_year = a.production_year
					and lower(result) = 'nominated') 
		and d.id not in(select distinct d.id
					from director as d, director_award as a
					where d.title = a.title and d.production_year = a.production_year
					and lower(result) = 'won') and d.title = a.title and d.production_year = a.production_year;",2018-08-18 15:36:08.363728+10,13,1,167,correct
764,"SELECT production_year, count(*)FROM movie WHERE production_year=1993 order by production_year;",2018-08-18 15:52:24.663792+10,2,0,33,partially correct
765,"SELECT production_year, count(*)FROM movie WHERE production_year>1990 and production_year<1994 group by production_year;",2018-08-18 15:53:33.906361+10,2,1,33,correct
766,SELECT count(*) from person as p where not exists (select d.id from director as d where p.id =d.id);,2018-08-18 15:57:37.440808+10,12,1,33,correct
767,"Select p.first_name, p.last_name, dw.id from person as p,(SELECT d.id from director as d inner join writer as w on d.title=w.title and d.production_year=w.production_year ) as dw where p.id=dw.id group by dw.id having count(dw.id)>=2;",2018-08-18 16:11:40.710362+10,4,0,33,partially correct
768,"select count(*) from movie as m
where m.title not in (select ma.title from movie_award as ma
where lower(result) = 'won') and m.title not in (select ca.title from crew_award as ca
where lower(result) = 'won') and m.title not in (select da.title from director_award as da
where lower(result) = 'won') and m.title not in (select wa.title from writer_award as wa
where lower(result) = 'won') and m.title not in (select aa.title from actor_award as aa
where lower(result) = 'won');",2018-08-18 16:13:01.339207+10,11,0,167,partially correct
769,"select count(*) as total from movie as m
where m.title not in (select ma.title from movie_award as ma
where lower(result) = 'won') and m.title not in (select ca.title from crew_award as ca
where lower(result) = 'won') and m.title not in (select da.title from director_award as da
where lower(result) = 'won') and m.title not in (select wa.title from writer_award as wa
where lower(result) = 'won') and m.title not in (select aa.title from actor_award as aa
where lower(result) = 'won');",2018-08-18 16:14:34.829765+10,11,0,167,partially correct
770,"SELECT dw.first_name, dw.last_name, dw.id from (director natural join writer natural join person)as dw group by dw.id having count(*)>=2;",2018-08-18 16:15:07.176087+10,4,1,33,correct
771,"SELECT dw.id,dw.first_name, dw.last_name from (director natural join writer natural join person)as dw group by dw.id having count(*)>=2;",2018-08-18 16:15:38.883659+10,4,1,33,correct
772,"SELECT kw.title,kw.production_year 
from(SELECT movie.title,movie.production_year from movie natural join writer join person on person.first_name='Kevin' and person.last_name='Williamson')as kw;",2018-08-18 16:23:36.658934+10,5,0,33,partially correct
773,"SELECT w.title,w.production_year FROM writer as w, person as p where w.id=p.id and lower(p.last_name)='williamson' and lower(p.first_name)='kevin';
",2018-08-18 16:27:08.297355+10,5,1,33,correct
774,"SELECT p.id,p.first_name,p.last_name from person as p group by p.year_born having min(p.year_born);",2018-08-18 16:32:55.989575+10,7,0,33,partially correct
775,"SELECT p.id,p.first_name,p.last_name from person as p where p.year_born = (Select max(year_born) from person);",2018-08-18 16:34:57.842494+10,7,1,33,correct
776,"select bf.title, bf.production_year from

(select title,production_year from Movie_award where award_name='BAFTA Film Award')as bf;",2018-08-18 16:47:58.371482+10,8,0,33,partially correct
777,"select count(*)
from person p
where exists (select * 
              from director d where d.id!= p.id);",2018-08-18 16:52:13.040642+10,12,0,176,partially correct
778,"select count(*)
from person p
where not exists (select * 
              from director d where d.id= p.id);",2018-08-18 16:53:42.476835+10,12,1,176,correct
779,"select id, first_name, last_name
from person
where id in( select d.id 
from director d natural join writer 
group by d.id 
having count(d.id)>1);",2018-08-18 17:01:01.017515+10,4,1,176,correct
780,"select bf.title, bf.production_year, p.first_name, p.last_name 
FROM
(Select title,production_year from movie_award where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won') as bf,
person as p, director as d
WHERE
d.title=bf.title and d.production_year=bf.production_year and
d.id=p.id;",2018-08-18 17:03:37.561657+10,8,1,33,correct
781,"select count(*) from movie as m
where not exists (select ma.title,ma.production_year from movie_award as ma 
where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won' 
union 
select ca.title, ca.production_year from crew_award as ca 
where ca.title = m.title and ca.production_year = m.production_year and lower(ca.result) = 'won' 
union
select da.title, da.production_year from director_award as da 
where da.title = m.title and da.production_year = m.production_year and lower(result) = 'won' 
union 
select wa.title,wa.production_year from writer_award as wa 
where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) = 'won' 
union 
select aa.title, aa.production_year from actor_award as aa 
where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) = 'won');",2018-08-18 17:04:48.992416+10,11,1,167,correct
782,"SELECT r.country 
from
restriction as r,
where
title ='Shakespeare in Love'
and
description ='M';",2018-08-18 17:08:58.293997+10,6,0,33,noninterpretable
783,"SELECT country 
from
restriction
where
title ='Shakespeare in Love'
and
description ='M';",2018-08-18 17:09:40.59077+10,6,1,33,correct
784,"select title, production_year
from movie m
where m.title in ( select w.title 
from person p natural join writer w
where p.first_name = Kevin and p.last_name = Williamson);",2018-08-18 17:15:17.315518+10,5,0,176,noninterpretable
785,"SELECT count(*) FROM Writer_Award as wa, person as p
Where wa.id=p.id and p.first_name='Woody' and p.last_name= 'Allen' and wa.year_of_award>=1991 and wa.year_of_award<=1995;",2018-08-18 17:17:39.353403+10,9,0,33,partially correct
786,"select title, production_year
from movie m
where m.title in ( select w.title 
from person p natural join writer w
where p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-18 17:18:17.827897+10,5,1,176,correct
787,"SELECT count(*) FROM Writer_Award as wa, person as p
Where wa.id=p.id AND lower(RESULT)= 'won'and p.first_name='Woody' and p.last_name= 'Allen' and wa.year_of_award>=1991 and wa.year_of_award<=1995;",2018-08-18 17:18:33.418398+10,9,1,33,correct
788,"select country
from restriction 
where title = 'Shakespeare in Love' and description = 'M';",2018-08-18 17:21:24.227585+10,6,1,176,correct
789,"select id, first_name, last_name
from person p1
where p1.year_born = (select min(year_born) from person p2);
              ",2018-08-18 17:23:20.45038+10,7,0,176,partially correct
790,"select id, first_name, last_name
from person p1
where p1.year_born = (select max(year_born) from person );
              ",2018-08-18 17:25:35.623518+10,7,1,176,correct
791,"SELECT count(*) FROM movie as m, Movie_Award as ma, Crew_Award as ca, Director_Award as da, Writer_Award as wa, Actor_Award as aa
WHERE
m.title !=ma.title and m.production_year != ma.production_year and
m.title !=ca.title and m.production_year != ca.production_year and
m.title !=da.title and m.production_year != da.production_year and
m.title !=wa.title and m.production_year != wa.production_year and
m.title !=aa.title and m.production_year != aa.production_year;
",2018-08-18 17:28:33.762109+10,11,0,33,partially correct
820,"select dw.id from 
(select id,title,production_year from director
union
select id, title production_year from writer)as dw;
",2018-08-18 21:11:59.423835+10,14,0,33,noninterpretable
821,"SELECT director.title
FROM director
GROUP BY director.id
ORDER BY director.title;",2018-08-18 21:19:58.472182+10,4,0,83,partially correct
1227,"select id, first_name,last_name
from person
where year_born in (
select max(year_born)
from person);",2018-08-21 15:27:06.306171+10,7,1,109,correct
792,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-18 17:33:16.705974+10,11,1,33,correct
793,"SELECT id from person as p;
",2018-08-18 17:37:27.439733+10,3,0,33,partially correct
794,"SELECT p.id from person as p
where p.year_born = (Select MAX(year_born) from person where year_born<(select max(year_born)from person) );
",2018-08-18 17:42:05.431498+10,3,1,33,correct
795,"select d.title, d.production_year, first_name, last_name
from director d natural join person
where d.title in ( select m.title from movie_award m 
where m.award_name = 'BAFTA Film Award' and m.category = 'Best Film');",2018-08-18 17:42:32.194175+10,8,0,176,partially correct
796,"select ma.title, ma.production_year, first_name, last_name
from ( select title, production_year from movie_award
where lower(award_name) = 'bafta film award'
and lower(category) = 'best film'
and lower( result) = 'won') as ma,
director, person
where ma.production_year = director.production_year
and ma.title = director.title
and person.id = director.id;",2018-08-18 17:58:33.263246+10,8,1,176,correct
797,"select title, production_year, first_name, last_name
from person natural join director
where director.title = (select title from movie_award
where lower(award_name) = 'bafta file award'
and lower(category) = 'best film'
and lower(result) = 'won')
and director.production_year = (select production_year from movie_award
where lower(award_name) = 'bafta file award'
and lower(category) = 'best film'
and lower(result) = 'won');",2018-08-18 18:01:56.308378+10,8,0,176,partially correct
798,"SELECT d.id, da.award_name, da.year_of_award, da.category 
from (select * from Director_Award where lower(result) = 'nominated') as da,
director as d
WHERE d.title = da.title and d.production_year=da.production_year;",2018-08-18 18:03:07.70478+10,13,1,33,correct
799,"select distinct r.id from role as r, appearance as a 
where r.description = a.description and a.title ='Psycho'and a.production_year = 1960;",2018-08-18 18:12:41.468359+10,10,0,33,partially correct
800,"select count(*)
from writer_award
where exists (select * from writer_award where writer_award.production_year >=1991
and writer_award.production_year<=1995
and writer_award.id = (select id from writer natural join person where 
lower(person.first_name)='woody'
and lower(person.last_name)='allen'));",2018-08-18 18:16:15.511304+10,9,0,176,partially correct
801,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-18 18:25:08.062088+10,10,1,148,correct
802,";
",2018-08-18 18:28:15.061384+10,11,0,148,noninterpretable
803,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-18 18:35:48.379233+10,11,1,148,correct
804,"select count(*) as no_of_awards
from writer_award wa, writer w, person p
where wa.id = w.id
and wa.title = w.title
and p.id = w.id
and lower(first_name) = 'woody'
and lower(last_name) = 'allen'
and year_of_award >=1991
and year_of_award <=1995
and lower(result) = 'won';

",2018-08-18 18:37:22.961445+10,9,1,176,correct
805,"select distinct id
from role r,scene s
where r.title = s.title
and r.production_year = s.production_year
and lower (r.title) = 'psycho'
and r.production_year = '1960'
and scene_no = '1';
",2018-08-18 18:43:33.391814+10,10,0,176,partially correct
806,"select distinct id
from role r,scene s
where r.title = s.title
and r.production_year = s.production_year
and lower (r.title) = 'psycho'
and r.production_year = 1960
and scene_no = 1;
",2018-08-18 18:44:06.905814+10,10,0,176,partially correct
807,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-18 19:16:10.521353+10,11,1,148,correct
808,";
",2018-08-18 19:18:13.385407+10,3,0,148,noninterpretable
809,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
                         FROM person));
",2018-08-18 19:23:39.620351+10,3,1,148,correct
810,"select id from director
union
select id from writer;",2018-08-18 19:44:15.411187+10,14,0,167,partially correct
811,"select count(*) from person
where person.year_born=1935;",2018-08-18 20:07:50.856635+10,1,0,83,partially correct
812,"SELECT COUNT(year_born)
FROM person
WHERE person.year_born = 1935;",2018-08-18 20:08:49.084071+10,1,0,83,partially correct
813,"SELECT COUNT(person.year_born)
FROM person, writer
WHERE person.year_born = 1935
  AND person.id = writer.id;",2018-08-18 20:11:14.129574+10,1,0,83,partially correct
814,"SELECT COUNT(person.year_born)
FROM person
WHERE person.id IN (SELECT person.id
                    FROM person, writer
                    WHERE person.id = writer.id)
  AND person.year_born = 1935; 
",2018-08-18 20:21:13.886644+10,1,1,83,correct
815,"SELECT production_year, COUNT(production_year)
FROM movie
WHERE movie.production_year IN (1993,1992,1991)
GROUP BY production_year
ORDER BY production_year DESC;
",2018-08-18 20:38:31.070628+10,2,1,83,correct
816,"SELECT COUNT(person.id)
FROM person
WHERE person.id NOT IN (SELECT COUNT(id)
                        FROM director);",2018-08-18 20:47:38.357635+10,12,0,83,partially correct
817,"SELECT COUNT(person.id)
FROM person
WHERE person.id NOT IN (SELECT person.id
                        FROM director, person
                        WHERE person.id = director.id);",2018-08-18 20:49:09.383802+10,12,1,83,correct
818,"select r.id from role as r, appearance as a, scene as s
where 
a.title=s.title 
and a.production_year=s.production_year 
and a.scene_no=s.scene_no
and
a.title=r.title and a.production_year=r.production_year and
a.title='Psycho'and a.production_year=1960 and a.description = r.description
group by r.id having count(*)=1;
",2018-08-18 20:53:02.78857+10,10,1,33,correct
819,select * from movie;,2018-08-18 21:02:48.019595+10,15,0,118,partially correct
1078,;,2018-08-20 21:32:02.091288+10,4,0,83,noninterpretable
822,"

SELECT writer.title, writer.production_year
FROM writer
WHERE writer.id = (SELECT person.id
                   FROM person
                   WHERE person.first_name = 'Kevin'
                     AND person.last_name = 'Williamson');


",2018-08-18 21:29:16.26451+10,5,1,83,correct
823,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love'
  AND description = 'M';
",2018-08-18 21:33:31.281072+10,6,1,83,correct
824,"SELECT id, first_name, last_name
FROM person
ORDER BY year_born DESC
LIMIT 1;",2018-08-18 21:37:07.433734+10,7,1,83,correct
825,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM movie_award, writer, person
WHERE award_name = 'BAFTA Film Award'
  AND category = 'best film'
  AND writer.id = person.id
  AND writer.title = movie_award.title;",2018-08-18 21:49:58.134653+10,8,0,83,partially correct
826,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM movie_award, director, person
WHERE award_name = 'BAFTA Film Award'
  AND category = 'best film'
  AND director.id = person.id
  AND director.title = movie_award.title;",2018-08-18 21:50:40.353039+10,8,0,83,partially correct
827,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM movie_award, director, person
WHERE movie_award.award_name = 'BAFTA Film Award'
  AND movie_award.category = 'best film'
  AND director.id = person.id
  AND director.title = movie_award.title;",2018-08-18 21:51:56.218082+10,8,0,83,partially correct
828,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM movie_award, director, person
WHERE movie_award.award_name = 'BAFTA Film Award'
  AND movie_award.category = 'best film'
  AND movie_award.result = 'won'
  AND director.id = person.id
  AND director.title = movie_award.title;",2018-08-18 21:54:47.229955+10,8,1,83,correct
829,"SELECT COUNT (*)
FROM PERSON p
WHERE EXISTS (SELECT * FROM WRITER w WHERE p.id = w.id and year_born = 1935);",2018-08-18 23:27:06.486024+10,1,1,150,correct
830,SELECT COUNT(*) From PERSON p where not exists (select * from DIRECTOR d WHERE d.id = p.id);,2018-08-19 08:57:05.727636+10,12,1,150,correct
831,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS 
(SELECT *
FROM movie_award ma, crew_award ca
WHERE m.title = ma.title
AND m.production_year = ma.production_year
AND m.title = ca.title
AND m.production_year = ca.production_year)
;",2018-08-19 12:07:51.063376+10,11,0,68,partially correct
832,"WITH h as (SELECT id, year_born
FROM person
EXCEPT
SELECT id, year_born
FROM person
WHERE year_born = (SELECT MAX(year_born)
FROM person))


select id
FROM h
WHERE year_born = (SELECT MAX(h.year_born)
FROM h)
;",2018-08-19 13:19:38.429439+10,3,1,68,correct
833,select count(w.id) from writer w inner join person p on w.id = p.id where p.year_born = '1935';,2018-08-19 13:56:36.865054+10,1,0,14,partially correct
834,"select production_year, count(production_year) as prod from movie group by production_year having production_year in ('1993', '1992', '1991');",2018-08-19 14:00:40.668043+10,2,1,14,correct
835,select count(id) from person where person.id not in (select id from director);,2018-08-19 14:05:17.674916+10,12,1,14,correct
836,select count(distinct w.id) from writer w inner join person p on w.id = p.id where p.year_born = '1935';,2018-08-19 14:07:41.53+10,1,1,14,correct
837,"SELECT d.id,da.award_name,da.year_of_award,da.category,da.result
FROM director d INNER JOIN director_award da
ON da.title = d.title 
AND da.production_year = d.production_year
AND da.result = 'nominated';",2018-08-19 14:26:52.005941+10,13,0,68,partially correct
838,"SELECT p.id, COUNT(p.id)
FROM (SELECT p.id
FROM person p, director d, writer w 
WHERE p.id = d.id
OR p.id = w.id
OR (p.id = w.id AND p.id = d.id)) as h, person p

;",2018-08-19 15:04:06.633469+10,14,0,68,partially correct
839,"WITH h as(SELECT r.id,r.title,r.production_year,r.description, COUNT(*) as total
FROM role r
GROUP BY r.id)

SELECT p.first_name,p.last_name,h.title,h.production_year,h.description
FROM person p,h
WHERE p.id = (
                 SELECT h.id
                 FROM h
                 WHERE h.total = (
                 SELECT MAX(total)
                 FROM h));",2018-08-19 15:49:36.517983+10,15,0,68,partially correct
840,"select count  from movie m, scene s, role r 
where m.title = s.title
AND m.production_year=s.production_year
AND m.title=r.title
AND m.production_year=r.production_year
AND m.title='Psycho';",2018-08-19 16:21:18.745552+10,10,0,66,noninterpretable
841,"select r.id  from appearance a, scene s, role r 
where a.title = s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description
AND a.title='Psycho'
AND a.production_year=1960
group by r.id having count (r.id) =1;",2018-08-19 16:28:33.769864+10,10,1,66,correct
842,"select r.id  from appearance a, scene s, role r 
where a.title = s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description
AND a.title='Psycho'
AND a.production_year=1960
group by r.id having count (r.id) =1;",2018-08-19 16:28:53.937653+10,10,1,66,correct
843,"select m.title from movie m, (select da.title from director_award da, director d
where da.title = d.title
AND da.production_year = d.production_year
AND da.result='won') as wda where m.title = wda.title; ",2018-08-19 16:53:59.672402+10,11,0,66,partially correct
844,"SELECT count(m.title)
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-19 17:13:34.822014+10,11,1,66,correct
845,"select p1.id from person p1 where p1.year_born = (select max(year_born) from person) - 
(select min((select max(year_born) from person)-p.year_born) as s from person p where p.year_born != (select max(year_born) from person)) ; ",2018-08-19 17:24:51.051269+10,3,1,66,correct
846,"select * from director d, director_award da
where d.title = da.title
AND d.production_year = da.production_year
AND da.result = 'nominated';",2018-08-19 17:33:55.655369+10,13,0,66,partially correct
847,"select d.id from director d, director_award da
where d.title = da.title
AND d.production_year = da.production_year
AND da.result = 'nominated';",2018-08-19 17:35:35.702857+10,13,0,66,partially correct
848,"select d.id from director d, director_award da
where d.title = da.title
AND d.production_year = da.production_year
AND da.result = 'nominated';",2018-08-19 17:35:49.847903+10,13,0,66,partially correct
849,"select d.id, da.award_name, da.year_of_award, da.category from director d, director_award da
where d.title = da.title
AND d.production_year = da.production_year
AND da.result = 'nominated';",2018-08-19 17:37:18.789585+10,13,1,66,correct
850,"select id, max(num_d) from (select d.id as id, count (m.title) as num_d from movie m, writer w, director d
where m.title = w.title
AND m.production_year = w.production_year
AND m.title = d.title
AND m.production_year = d.production_year
group by d.id);
",2018-08-19 17:50:46.666495+10,14,0,66,partially correct
851,"select x2.id from (select x1.id, count (x1.title) as num from (select w.id, w.title from writer w 
union
select d.id, d.title from director d) as x1
group by x1.id) as x2 where x2.num = (select max(x2.num) from (select x1.id, count (x1.title) as num from (select w.id, w.title from writer w 
union
select d.id, d.title from director d) as x1
group by x1.id) as x2);",2018-08-19 18:04:00.36428+10,14,1,66,correct
1079,";
",2018-08-20 21:33:12.362529+10,6,0,83,noninterpretable
1228,"SELECT id, first_name, last_name
FROM Person
WHERE Person.year_born = (SELECT MAX(year_born) FROM Person);",2018-08-21 15:27:24.62183+10,7,1,214,correct
852,"select x2.id from (select x1.id, count (x1.title) as num from (select w.id, w.title from writer w 
union
select d.id, d.title from director d) as x1
group by x1.id) as x2 where x2.num = (select max(x2.num) from (select x1.id, count (x1.title) as num from (select w.id, w.title from writer w 
union
select d.id, d.title from director d) as x1
group by x1.id) as x2);",2018-08-19 18:05:31.978932+10,14,1,66,correct
853,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r
where p.id=r.id
AND r.id = (select x1.id from (select id, count(distinct description) as num from role group by id) x1 
where x1.num=(select max(x2.num) from (select count(distinct description) as num from role group by id) x2));",2018-08-19 18:28:50.636826+10,15,1,66,correct
854,"select count(id)
from person
where year_born='1935';",2018-08-19 22:23:45.177795+10,1,0,118,partially correct
855,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-19 22:24:57.200678+10,1,1,118,correct
856,"select production_year as p, count(*)
from movie where p='1993' or p='1992' or p='1991'
group by p;",2018-08-19 22:29:02.973075+10,2,1,118,correct
857,"select count(*) from 
(select person.*
from person, director
where person.id != director.id);",2018-08-19 22:37:05.17016+10,12,0,118,partially correct
858,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-19 22:54:19.293853+10,12,1,118,correct
859,"SELECT COUNT(writer_award.id)
FROM writer_award, person
WHERE production_year IN (1991, 1992, 1993, 1994, 1995)
  AND person.id = writer_award.id
  AND person.first_name = 'Woody'
  AND person.last_name = 'Allen';",2018-08-19 23:00:46.267382+10,9,1,83,correct
860,"select dd.id, person.first_name, person.last_name
from 
(select d.id, count(d.id) as idcount 
from director as d inner join writer as w on w.title=d.title
where d.id = w.id
group by d.id) as dd, person
where dd.idcount >=2 and dd.id=person.id;
",2018-08-19 23:03:39.500349+10,4,1,118,correct
861,"select *
From (PERSON P natural join Director d natural join WRITER w) as a
GROUP BY a.id
HAVING COUNT (title) > 1;
",2018-08-19 23:05:52.32389+10,4,0,150,partially correct
862,"select a.id, a.first_name, a.last_name
From (PERSON P natural join Director d natural join WRITER w) as a
GROUP BY a.id
HAVING COUNT (title) > 1;
",2018-08-19 23:08:00.856389+10,4,1,150,correct
863,"select movie.title, movie.production_year
from person natural join writer natural join movie 
where first_name = 'Kevin' and last_name='Williamson';",2018-08-19 23:13:52.58121+10,5,1,118,correct
864,"select country
from restriction 
where title='Shakespeare in Love' and description = 'M';",2018-08-19 23:19:13.596977+10,6,1,118,correct
865,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person) as d;",2018-08-19 23:21:30.436063+10,7,0,118,noninterpretable
866,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-19 23:22:04.474989+10,7,1,118,correct
867,select movie;,2018-08-19 23:24:42.30854+10,8,0,118,noninterpretable
868,"select person.first_name, person.last_name
from person natural join director natural join movie_award
where movie_award.award_name = 'BAFTA Film Award' and movie_award.category = 'Best Film'
and movie_award.result = 'won';",2018-08-19 23:29:55.220513+10,8,0,118,partially correct
869,"select count(first_name) from Person , Writer where Writer.id=Person.id AND Person.year_born=1935;",2018-08-19 23:33:07.123755+10,1,0,101,partially correct
870,"SELECT 
w.title,w.production_year
FROM 
PERSON p ,WRITER w
where 
      p.id = w.id
      and lower(first_name) = 'kevin'
      and lower(last_name) = 'williamson';",2018-08-19 23:35:32.945501+10,5,1,150,correct
871,select count(production_year) from Movie where production_year=1993 or production_year=1992 or production_year=1991;,2018-08-19 23:47:52.354126+10,2,0,101,partially correct
872,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-20 09:17:07.051934+10,8,1,118,correct
873,"select year_born, count(*) from person where year_born= '1953';",2018-08-20 09:25:28.102374+10,1,0,137,partially correct
874,"select count(waa.award_name)
from (select wa.id, wa.award_name
	from writer_award as wa
	where year_of_award>=1991 and year_of_award<=1995) waa,
	person
where person.id=waa.id and person.first_name='Woody' and person.last_name = 'Allen';",2018-08-20 09:26:32.271034+10,9,0,118,partially correct
875,"SELECT country FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-20 09:36:59.838277+10,6,1,95,correct
876,"WITH h AS(SELECT title, production_year
FROM movie
WHERE production_year IN (1991,1992,1993))

SELECT production_year, COUNT(*) as numbers
FROM h
GROUP BY production_year;",2018-08-20 10:27:38.167614+10,2,1,68,correct
877,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (
SELECT *
FROM director d
WHERE d.id = p.id
);",2018-08-20 10:30:21.782425+10,12,1,68,correct
878,"select count(*) from person 
where id in (
	select id from writer
) and year_born like ""1935"";",2018-08-20 10:41:10.086828+10,1,1,156,correct
879,"select production_year, count(production_year) from movie
where production_year = 1993
or production_year = 1992
or production_year = 1991
group by production_year;",2018-08-20 10:44:28.679784+10,2,1,156,correct
880,"SELECT country FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-20 10:45:21.778365+10,6,1,95,correct
881,"select count(id) from person
where id not in (
	select id from director
);",2018-08-20 10:46:54.523828+10,12,1,156,correct
882,"WITH he as(
SELECT h.id
FROM (SELECT *
FROM director d, movie m
WHERE d.title = m.title
AND d.production_year = m.production_year) as h
GROUP BY h.id
HAVING COUNT(*)>1)

SELECT DISTINCT p.id, p.first_name, p.last_name
FROM person p, he, writer w
WHERE p.id = he.id
AND p.id = w.id
;",2018-08-20 10:51:56.351443+10,4,0,68,partially correct
883,"WITH he as(
SELECT h.id,h.title
FROM (SELECT *
FROM director d, movie m
WHERE d.title = m.title
AND d.production_year = m.production_year) as h
GROUP BY h.id
HAVING COUNT(*)>1)

SELECT DISTINCT p.id, p.first_name, p.last_name
FROM person p, he, writer w
WHERE p.id = he.id
AND p.id = w.id
AND w.title = he.title
;",2018-08-20 10:53:30.911882+10,4,0,68,partially correct
884,"with dc as (
	select id, count(*) number from director
	group by id
)

select p.id, p.first_name, p.last_name from dc, person p, writer w
where dc.number >= 2 and dc.id = w.id and dc.id = p.id
group by p.id;",2018-08-20 10:54:31.610149+10,4,0,156,partially correct
885,"SELECT p1.id, p1.first_name, p1.last_name 
FROM person p1
WHERE p1.year_born = 
(SELECT MAX(p2.year_born) 
FROM person p2);",2018-08-20 10:54:56.2258+10,7,1,95,correct
886,"with dw as (
	select d.id, count(*) number from director d, writer w
	where d.title = w.title and d.production_year = w.production_year
		and d.id = w.id
	group by d.id
)

select distinct p.id, p.first_name, p.last_name 
from dw, person p, writer w
where dw.number >= 2 and dw.id = w.id and dw.id = p.id;",2018-08-20 11:01:16.565671+10,4,1,156,correct
887,"SELECT title, production_year
FROM writer w INNER JOIN person p
ON w.id = p.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson'
;",2018-08-20 11:02:18.387702+10,5,1,68,correct
888,"select title, production_year from writer w, person p
where p.id = w.id 
	and p.first_name like ""kevin"" 
	and p.last_name like ""williamson"";",2018-08-20 11:05:08.304232+10,5,1,156,correct
889,"select country from restriction
where title like ""Shakespeare in Love"" and description like ""m"";",2018-08-20 11:07:12.164126+10,6,1,156,correct
890,"select id, first_name, last_name from person
where year_born = (
	select max(year_born) from person
);",2018-08-20 11:09:44.902999+10,7,1,156,correct
891,"select ma.title, ma.production_year, p.first_name, p.last_name
from person p, movie_award ma, director d
where p.id = d.id and ma.title = d.title 
	and ma.production_year = d.production_year
	and ma.award_name like ""BAFTA Film Award"" 
	and category like ""Best Film"";",2018-08-20 11:14:58.506992+10,8,0,156,partially correct
892,"select ma.title, ma.production_year, p.first_name, p.last_name
from person p, movie_award ma, director d
where p.id = d.id and ma.title = d.title 
	and ma.production_year = d.production_year
	and ma.award_name like ""BAFTA Film Award"" 
	and category like ""Best Film""
	and ma.result like ""won"";",2018-08-20 11:15:38.449676+10,8,1,156,correct
893,"SELECT p.first_name, p.last_name, ma.title, ma.production_year
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE ma.award_name = ""BAFTA Film Award"" AND lower(ma.category) = 'best film';",2018-08-20 11:22:30.324246+10,8,0,95,partially correct
894,"SELECT p.first_name, p.last_name, ma.title, ma.production_year
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE ma.award_name = ""BAFTA Film Award"" AND lower(ma.category) = 'best film';",2018-08-20 11:22:47.373332+10,8,0,95,partially correct
895,"SELECT p.first_name, p.last_name, ma.title, ma.production_year
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE ma.award_name = ""BAFTA Film Award"" AND lower(ma.category) = 'best film' AND lower(RESULT)= 'won';",2018-08-20 11:25:01.120387+10,8,1,95,correct
896,"SELECT  ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE ma.award_name = ""BAFTA Film Award"" AND lower(ma.category) = 'best film' AND lower(RESULT)= 'won';",2018-08-20 11:25:23.444783+10,8,1,95,correct
897,"select count(*) from writer_award wa, person p
where p.first_name like ""woody"" and p.last_name like ""allen""
	and 1991 <= year_of_award <=1995
	and result like ""won""
	and wa.id = p.id;",2018-08-20 11:26:31.1196+10,9,0,156,noninterpretable
898,"select id from appearance a, role r
where a.title like ""psycho"" and a.production_year = 1960
	and a.title = r.title and a.production_year = r.production_year
	and a.description = r.description
group by id
having count(id) = 1;",2018-08-20 11:33:13.207863+10,10,1,156,correct
899,"with na as (
	select title, production_year from movie_award 
	union select title, production_year from crew_award
	union select title, production_year from director_award
	union select title, production_year from writer_award
	union select title, production_year from actor_award
)

select count(*) from movie
where (title, production_year) not in na;",2018-08-20 11:41:57.55562+10,11,0,156,partially correct
900,"SELECT id, first_name, last_name
FROM person p
WHERE p.id in (
               SELECT d.id FROM writer w, director d WHERE w.id = d.id AND d.id IN (
               SELECT d1.id FROM director d1, movie m WHERE d1.title = m.title AND d1.production_year = m.production_year GROUP BY d1.title HAVING count(*) > 1));",2018-08-20 11:43:20.597575+10,4,0,24,partially correct
901,"with na as (
	select title, production_year from movie_award
	where result like ""won""
	union select title, production_year from crew_award
	where result like ""won""
	union select title, production_year from director_award
	where result like ""won""
	union select title, production_year from writer_award
	where result like ""won""
	union select title, production_year from actor_award
	where result like ""won""
)

select count(*) from movie
where (title, production_year) not in na;",2018-08-20 11:43:58.956233+10,11,1,156,correct
902,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-20 11:45:40.625374+10,4,1,24,correct
903,"with np as (
	select * from person
	where year_born < (select max(year_born) from person)
)

select id from np
where year_born = (select max(year_born) from np);",2018-08-20 11:47:51.985875+10,3,1,156,correct
904,"SELECT count(*)
From PERSON p
WHERE p.year born = 1935;",2018-08-20 11:53:07.375903+10,1,0,136,noninterpretable
905,"SELECT count(*)
From PERSON p
WHERE p.year_born = 1935;",2018-08-20 11:53:55.088313+10,1,0,136,partially correct
906,"with wda as (
	select title,production_year from director_award
	where result like ""won""
)

select id, award_name, year_of_award, category 
from director_award dw, director d
where result like ""nominated"" and d.title = dw.title
	and d.production_year = dw.production_year
	and (dw.title,dw.production_year) not in wda;",2018-08-20 12:00:32.678563+10,13,1,156,correct
907,select count(id) from writer natural join person where year_born = 1935;,2018-08-20 12:01:09.805831+10,1,0,188,partially correct
908,select count(a.id) from (select distinct id from writer natural join person where year_born = 1935) as a;,2018-08-20 12:03:32.723091+10,1,1,188,correct
909,j;,2018-08-20 12:05:45.777286+10,2,0,136,noninterpretable
910,"select production_year, count(title) from movie where production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year; ",2018-08-20 12:06:58.268622+10,2,1,188,correct
911,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-20 12:08:11.966089+10,2,1,136,correct
912,select;,2018-08-20 12:09:10.377818+10,12,0,136,noninterpretable
913,select count(person.id) from person left join director on person.id = director.id where title is null and production_year is null;,2018-08-20 12:10:53.500677+10,12,1,188,correct
914,"select id, first_name, last_name from (person natural join director) natural join writer group by id, first_name, last_name having count(title) > 1;",2018-08-20 12:14:55.025193+10,4,1,188,correct
915,"select title, production_year from writer natural join person where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-20 12:16:54.181946+10,5,1,188,correct
916,select count(distinct id)from writer;,2018-08-20 12:16:59.045436+10,1,0,181,partially correct
917,select count(distinct 1935)from writer;,2018-08-20 12:19:06.142625+10,1,0,181,cheating
918,"SELECT w.title, w.production_year
FROM (person NATURAL JOIN writer NATURAL JOIN movie) AS w
WHERE w.first_name = 'Kevin'
AND w.last_name = 'Williamson';",2018-08-20 12:22:06.622916+10,5,1,24,correct
919,select distinct country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-20 12:22:56.242033+10,7,0,188,partially correct
920,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-20 12:23:49.855486+10,7,1,188,correct
921,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-20 12:28:24.21494+10,6,1,24,correct
922,select count(id) from writer_award where result = 'won' and year_of_award >= 1991 and year_of_award <= 1995 and id = (select id from person where first_name = 'Woody' and last_name = 'Allen');,2018-08-20 12:33:18.812674+10,9,1,188,correct
923,"SELECT id, first_name, last_name,MIN(year_born)
FROM person;
",2018-08-20 12:33:25.856176+10,7,0,24,partially correct
924,"SELECT id, first_name, last_name,MAX(year_born)
FROM person;
",2018-08-20 12:34:18.528175+10,7,0,24,partially correct
925,"SELECT writers
FROM writer ;
",2018-08-20 12:35:19.55655+10,1,0,189,noninterpretable
926,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-20 12:36:37.76975+10,1,1,189,correct
927,"SELECT id, first_name, last_name
FROM person
WHERE year_born in (SELECT MAX(year_born) FROM person);
",2018-08-20 12:40:14.967341+10,7,1,24,correct
928,select id from appearance natural join role where title = 'Psycho' and production_year = 1960 group by id having count(scene_no) = 1;,2018-08-20 12:45:16.125712+10,10,1,188,correct
929,select distinct count(*) from (select * from person natural join writer) as a where year_born=1935;,2018-08-20 12:48:33.83221+10,1,0,190,partially correct
930,select id from person where year_born = (select max(year_born) from person where year_born not in (select max(year_born) from person));,2018-08-20 12:55:05.155921+10,3,1,188,correct
931,"select count(*),production_year from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year; ",2018-08-20 12:55:18.28922+10,2,1,190,correct
932,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT * 
	FROM writer WHERE writer.id = person.id 
	AND person.year_born = 1935);


",2018-08-20 13:01:04.459303+10,1,1,120,correct
933,"SELECT dm.title, dm.production_year,p.first_name, p.last_name
FROM (movie_award NATURAL JOIN director) AS dm, person AS p 
WHERE dm.award_name = 'BAFTA Film Award' AND LOWER(dm.category) = 'best film' AND p.id = dm.id; ",2018-08-20 13:03:32.375896+10,8,0,24,partially correct
934,select count(*) from (select * from person left join director on person.id= director.id) as a where title is null;,2018-08-20 13:03:50.355635+10,12,1,190,correct
1080,;,2018-08-20 21:33:30.637221+10,7,0,83,noninterpretable
935,"SELECT production_year, COUNT(production_year) 
FROM movie
where production_year = 1991 or production_year = 1992 or production_year = 1993;",2018-08-20 13:04:13.669617+10,2,0,120,partially correct
936,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-20 13:04:41.503612+10,2,1,120,correct
937,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS (SELECT * FROM director WHERE director.id = person.id);",2018-08-20 13:06:57.194551+10,12,1,120,correct
938,"SELECT dm.title, dm.production_year,p.first_name, p.last_name
FROM (movie_award NATURAL JOIN director) AS dm, person AS p 
WHERE dm.award_name = 'BAFTA Film Award' AND dm.category = 'best film' AND dm.result = 'won' AND p.id = dm.id; ",2018-08-20 13:07:30.540675+10,8,1,24,correct
939,"select b.id,first_name,last_name from person natural join (select a.id from (select * from writer as w inner join director as d on d.id=w.id and d.title=w.title) as a group by a.id having count(*)>1)as b;",2018-08-20 13:11:51.56665+10,4,1,190,correct
940,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE EXISTS (SELECT * FROM director d, writer w 
			WHERE  d.title = w. title);",2018-08-20 13:11:58.379097+10,4,0,120,partially correct
941,"SELECT count(*)
FROM (writer NATURAL JOIN writer_award) as wa, person as p
WHERE wa.year_of_award >= 1991 
AND wa.year_of_award <= 1995 
AND wa.id = p.id
AND p.first_name = 'Woody'
AND p.last_name = 'Allen';",2018-08-20 13:14:07.622545+10,9,0,24,partially correct
942,"SELECT count(*) as number_of_award
FROM (writer NATURAL JOIN writer_award) as wa, person as p
WHERE wa.year_of_award > 1991 
AND wa.year_of_award <= 1995 
AND wa.id = p.id
AND p.first_name = 'Woody'
AND p.last_name = 'Allen';",2018-08-20 13:15:28.200414+10,9,1,24,correct
943,"SELECT a.id, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS a
GROUP BY a.id
HAVING count(*)>1;


",2018-08-20 13:17:13.853711+10,4,1,120,correct
944,"select id from (select b.id, max(b.c) from (select a.id, count(*) as c from (select * from director union select id, title, production_year from writer) as a group by a.id) as b) d;",2018-08-20 13:19:23.494051+10,14,0,188,partially correct
945,"select title,production_year from (select * from person as p inner join (select id,title,movie.production_year from movie natural join writer) as a on p.id =a .id) as b where first_name='Kevin' and last_name='Williamson';    ",2018-08-20 13:20:40.98827+10,5,1,190,correct
946,"SELECT title, production_year
FROM writer
WHERE EXISTS (SELECT * FROM person p
		WHERE p.first_name = kevin AND p.last_name = williamson);",2018-08-20 13:21:05.166664+10,5,0,120,noninterpretable
947,select country from restriction where title='Shakespeare in Love' and description='M' ;,2018-08-20 13:23:30.475928+10,6,1,190,correct
948,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-20 13:25:20.23769+10,5,1,120,correct
949,"select id,first_name,last_name from person inner join (select max(year_born) as m from person) as a on m=year_born;",2018-08-20 13:27:09.133653+10,7,1,190,correct
950,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-20 13:30:00.54999+10,1,1,136,correct
951,"SELECT p.id
FROM (role natural join appearance) as ra, person as p
WHERE ra.scene_no = 1
AND ra.title = 'Psycho'
AND ra.id = p.id;",2018-08-20 13:30:25.036846+10,10,0,24,partially correct
952,"select b.id from (select a.id, count(*) as c from (select * from director union select id, title, production_year from writer) as a group by a.id) as b where b.c = (select max(b.c) from (select a.id, count(*) as c from (select * from director union select id, title, production_year from writer) as a group by a.id) as b);",2018-08-20 13:31:40.765705+10,14,1,188,correct
953,"SELECT r.country
FROM restriction r, movie
WHERE movie.title = r.title AND
	 movie.title like '%in love%';",2018-08-20 13:32:25.608372+10,6,0,120,partially correct
954,"SELECT r.country
FROM restriction r, movie
WHERE movie.title = r.title AND
	 movie.title like '%shakespeare in love%'
	 AND r.description = 'M';",2018-08-20 13:33:53.496076+10,6,1,120,correct
955,"select first_name,last_name,title,production_year from person natural join (select * from director as d inner join (select title from movie_award where lower(award_name)='bafta film award' and lower(category)='best film') as a on d.title = a.title) as b;",2018-08-20 13:38:00.283067+10,8,0,190,partially correct
956,"select title,production_year,first_name,last_name from person natural join (select * from director as d inner join (select title from movie_award where lower(award_name)='bafta film award' and lower(category)='best film') as a on d.title = a.title) as b;",2018-08-20 13:39:01.302873+10,8,0,190,partially correct
957,"SELECT *
FROM (select MIN (year_born) as y 
	FROM person GROUP BY id) AS a;",2018-08-20 13:40:41.071826+10,7,0,120,partially correct
958,"select count(*)
from writer w
where exists(select * from person p where w.id=p.id and p.year_born='1935');",2018-08-20 13:41:02.509454+10,1,0,94,partially correct
959,"select title,production_year,first_name,last_name from person natural join (select * from director as d inner join (select title from movie_award where lower(award_name)='bafta film award' and lower(category)='best film' and result='won') as a on d.title = a.title) as b;",2018-08-20 13:41:44.090208+10,8,1,190,correct
960,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born) as a
        FROM
            person 
		);",2018-08-20 13:43:59.475588+10,7,1,120,correct
961,"SELECT title, production_year, first_name, last_name
FROM director, movie_award;
",2018-08-20 13:49:28.519796+10,8,0,120,noninterpretable
962,select count(*) from writer_award natural join (select id from person where first_name='Woody' and last_name='Allen') where year_of_award>=1991 and  year_of_award<=1995 and result='won';,2018-08-20 13:49:34.120945+10,9,1,190,correct
963,"select r.id from scene as s, role as r, appearance as a 
where a.title = 'Psycho' 
and s.production_year = 1960
and a.scene_no = s.scene_no
and a.description = r.description
and a.production_year = s.production_year
and a.production_year = r.production_year
and s.title = a.title
and s.title = r.title
and s.production_year = r.production_year
group by r.id having count (*) = 1;",2018-08-20 13:51:42.899732+10,10,1,99,correct
964,"SELECT p.first_name, p.last_name, aw.production_year, aw.title
FROM( SELECT title, production_year 
	FROM movie_award
	WHERE lower(award_name) = 'bafta film award'
	AND lower (category) = 'best film'
	) AS aw,
	director d,
	person p
WHERE d.id = p.id
	AND aw.title = d.title
	AND aw.production_year = d.production_year
	;",2018-08-20 13:57:57.298325+10,8,0,120,partially correct
965,select id from role natural join (select description from appearance where title='Psycho' group by description having count(scene_no)=1) as a;,2018-08-20 13:59:13.752963+10,10,0,190,partially correct
966,"SELECT p.first_name, p.last_name, aw.production_year, aw.title
FROM( SELECT title, production_year 
	FROM movie_award
	WHERE lower(award_name) = 'bafta film award'
	AND lower (category) = 'best film' AND lower(result) = 'won'
	) AS aw,
	director d,
	person p
WHERE d.id = p.id
	AND aw.title = d.title
	AND aw.production_year = d.production_year
	;",2018-08-20 14:00:01.314186+10,8,1,120,correct
967,"SELECT aw.title, aw.production_year, p.first_name, p.last_name
FROM( SELECT title, production_year 
	FROM movie_award
	WHERE lower(award_name) = 'bafta film award'
	AND lower (category) = 'best film' AND lower(result) = 'won'
	) AS aw,
	director d,
	person p
WHERE d.id = p.id
	AND aw.title = d.title
	AND aw.production_year = d.production_year
	;",2018-08-20 14:00:53.922306+10,8,1,120,correct
968,select count(*) from person where year_born=1935;,2018-08-20 14:02:08.094481+10,1,0,186,partially correct
969,select count(*) from person where year_born=1935 and id in(select id from writer);,2018-08-20 14:03:11.427408+10,1,1,186,correct
970,select count(*) from movie;,2018-08-20 14:03:43.901768+10,11,0,99,partially correct
971,"select production_year,count(*) from movie where production_year in (1993,1992,1991) group by (production_year);",2018-08-20 14:05:35.39771+10,2,1,186,correct
972,select count(*) from person where id not in(select id from director);,2018-08-20 14:06:56.820299+10,12,1,186,correct
1081,;,2018-08-20 21:33:51.945074+10,8,0,83,noninterpretable
973,"select id, first_name,last_name from person where id in(select id from writer w where title in(select title from director d where d.id=w.id));",2018-08-20 14:09:32.802869+10,4,0,186,partially correct
974,"select count(*) from movie left join
(select title from movie_award union select title from crew_award union select title from writer_award union select title from actor_award) as a on a.title= movie.title where a.title is null;",2018-08-20 14:10:49.059874+10,11,0,190,partially correct
975,"select id, first_name,last_name from person where id in(select w.id from writer w,director d where w.id=d.id);",2018-08-20 14:11:54.337665+10,4,0,186,partially correct
976,"select count(*) from movie left join
(select title from movie_award where result='won' union select title from crew_award where result='won' union select title from writer_award where result='won' union select title from actor_award where result='won') as a on a.title= movie.title where a.title is null;",2018-08-20 14:13:19.465642+10,11,0,190,partially correct
977,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-20 14:14:20.912895+10,4,1,186,correct
978,"SELECT COUNT (*)

FROM 
(	SELECT id
	FROM writer_award
	WHERE year_of_award >1990 AND year_of_award < 1996) AS wa
	,person p
WHERE
	p.id = wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen';
",2018-08-20 14:14:50.304009+10,9,0,120,partially correct
979,"SELECT COUNT (*)

FROM 
(	SELECT id
	FROM writer_award
	WHERE year_of_award >1990 AND year_of_award < 1995) AS wa
	,person p
WHERE
	p.id = wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen';
",2018-08-20 14:15:39.912174+10,9,1,120,correct
980,"select title,production_year from movie where title in(select title from writer where id=(select id from person where first_name='Kevin' and last_name='Williamson'));",2018-08-20 14:16:04.257226+10,5,1,186,correct
981,"select country from restriction where title='Shakespeare in Love' and description='M';
",2018-08-20 14:21:32.326152+10,6,1,186,correct
982,"SELECT d.id, da.award_name, da.year_of_award, da.category,da.result
FROM director as d, director_award as da
WHERE da.result != 'won'
GROUP BY d.id
HAVING count(*) > 0;",2018-08-20 14:22:19.703672+10,13,0,24,partially correct
983,"select count(year_born)
from PERSON
where year_born = 1935;",2018-08-20 14:22:47.098169+10,1,0,47,partially correct
984,"select id,first_name,last_name from person where year_born=(select min(year_born) from person);",2018-08-20 14:22:56.599512+10,7,0,186,partially correct
985,"select count(*) from movie as m where not exists
(select title, production_year from movie_award as ma where ma.title = m.title and ma.production_year = m.production_year and lower (ma.result) = 'won'
union
select title, production_year from crew_award as ca where ca.title = m.title and ca.production_year = m.production_year and lower (ca.result) = 'won'
union
select title, production_year from director_award as da where da.title = m.title and da.production_year = m.production_year and lower(da.result) ='won'
union 
select title, production_year from writer_award as wa where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) ='won'
union
select title, production_year from actor_award as aa where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) = 'won');",2018-08-20 14:23:24.33284+10,11,1,99,correct
986,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-20 14:23:37.000132+10,1,1,47,correct
987,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-20 14:24:07.001386+10,7,1,186,correct
988,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director as d, director_award as da
WHERE da.result != 'won'
AND d.title = da.title
AND d.production_year = da.production_year;
",2018-08-20 14:26:20.788929+10,13,1,24,correct
989,"SELECT id
FROM scene s, person p, movie
WHERE 
	lower(movie.title) = 'psycho'
	AND movie.production_year = 1960
	AND s.title = movie. title
	AND s.production_year = movie.production_year
	AND s.scene_no = 1;",2018-08-20 14:27:36.651849+10,10,0,120,partially correct
990,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-20 14:29:42.057193+10,10,1,120,correct
991,"select count*
from person
where person.id = writer.id and person.year_born =1935;",2018-08-20 14:31:24.074288+10,1,0,134,noninterpretable
992,"select m.title,m.production_year,p.first_name,p.last_name from movie_award m inner join director d inner join person p  on m.title=d.title and d.id=p.id where m.award_name='BAFTA Film Award' and m.category='Best Film';",2018-08-20 14:33:01.671404+10,8,0,186,partially correct
993,select;,2018-08-20 14:35:16.774483+10,3,0,99,noninterpretable
994,"select count (*)
from movie m
where not exists(
select title, production_year
from movie_award ma
where lower(ma.result)='won' and m.title=ma.title and m.production_year=ma.production_year
union
select title, production_year
from crew_award ca
where lower(ca.result)='won' and m.title=ca.title and m.production_year=ca.production_year
union
select title, production_year
from director_award da
where lower(da.result)='won' and m.title=da.title and m.production_year=da.production_year
union
select title, production_year
from writer_award wa
where lower(wa.result)='won' and m.title=wa.title and m.production_year=wa.production_year
union
select title, production_year
from actor_award aa
where lower(aa.result)='won' and m.title=aa.title and m.production_year=aa.production_year);",2018-08-20 14:35:29.773774+10,11,1,94,correct
995,select count(*) from writer_award where year_of_award between 1991 and 1995 and id=(select id from person where first_name='Woody' and last_name='Allen');,2018-08-20 14:39:51.373718+10,9,0,186,partially correct
996,select p.id from person as p where p.year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));,2018-08-20 14:40:12.00199+10,3,1,99,correct
997,select count(*) from writer_award where year_of_award >1991 and year_of_award <=1995 and id=(select id from person where first_name='Woody' and last_name='Allen');,2018-08-20 14:40:28.114875+10,9,1,186,correct
998,"SELECT COUNT(*)
FROM person, writer
WHERE person.id = writer.id AND year_born = '1935';",2018-08-20 14:43:09.328089+10,1,0,87,partially correct
999,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-20 14:45:30.635723+10,1,1,87,correct
1000,"with won as (
	select id, count(*) num from (
		select * from director 
		union select id, title, production_year from writer
	)
	group by id
)

select id from won
where num = (select max(num) from won);",2018-08-20 14:47:49.889603+10,14,1,156,correct
1001,"SELECT COUNT(*)
FROM person
WHERE person.year_born = 1935
AND person.id in (SELECT person.id from person, writer where person.id = writer.id);",2018-08-20 14:47:50.304842+10,1,1,24,correct
1002,"select count(h) from
select year_born from person
where year_born=1935 AND person.id=writer.idAS h;
",2018-08-20 14:49:10.099064+10,1,0,184,noninterpretable
1003,"SELECT production_year, COUNT(*)
FROM movie
GROUP BY prodUction_year
HAVING production_year = 1993 OR production_year = 1992 OR production_year = 1991;",2018-08-20 14:50:34.796419+10,2,1,87,correct
1004,"select count(*)
from person
where exists (select* 
			from  writer 
			where person.id = writer.id and person.year_born =1935);",2018-08-20 14:51:20.667849+10,1,1,134,correct
1005,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY prodUction_year;",2018-08-20 14:52:32.082559+10,2,1,87,correct
1006,"select r.id
from scene s, appearance a, role r
where s.title = a.title
and a.production_year = s.production_year
and a.title = 'Psycho'
and a.production_year = 1960
and a.scene_no = s.scene_no
and r.description = a.description
and r.title = a.title
and r.production_year = a.production_year
group by r.id
having count(*) = 1;",2018-08-20 14:53:59.834665+10,10,1,24,correct
1082,;,2018-08-20 21:34:18.955368+10,9,0,83,noninterpretable
1007,"with rn as (
	select id,count(*) num from role group by id
)

select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, rn, role r
where p.id = rn.id and p.id = r.id
	and rn.num = (select max(num) from rn);",2018-08-20 14:54:11.802008+10,15,1,156,correct
1008,;,2018-08-20 15:10:54.615729+10,1,0,196,noninterpretable
1009,"SELECT id
FROM(SELECT MAX(year_born)
	FROM(SELECT MAX(year_born)
		FROM person);",2018-08-20 15:20:05.374722+10,3,0,124,noninterpretable
1010,"select count(*)
from movie
where movie.title not in (select title from movie_award where movie_award.result = 'won')
and movie.title not in (select title from crew_award where crew_award.result = 'won')
and movie.title not in (select title from director_award where director_award.result = 'won')
and movie.title not in (select title from writer_award where writer_award.result = 'won')
and movie.title not in (select title from actor_award where actor_award.result = 'won');",2018-08-20 15:24:09.750029+10,11,0,24,partially correct
1011,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born)
	FROM person
	WHERE year_born<(SELECT MAX(year_born)
		FROM person));",2018-08-20 15:26:30.221152+10,3,1,124,correct
1012,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-20 15:34:36.990014+10,11,1,24,correct
1013,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-20 15:38:29.268329+10,12,1,136,correct
1014,select;,2018-08-20 15:41:48.117032+10,4,0,136,noninterpretable
1015,"SELECT ma.title,ma.production_year, p.first_name, p.last_name
FROM (SELECT * FROM MOVIE_AWARD WHERE lower(award_name) = 'bafta film award' and lower(category) = 'best film')as ma,
PERSON p, 
Director d
where p.id = d.id;",2018-08-20 15:47:23.618521+10,8,0,150,partially correct
1016,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-20 15:48:02.097357+10,4,1,136,correct
1017,select;,2018-08-20 15:49:32.531255+10,5,0,136,noninterpretable
1018,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-20 15:52:09.280049+10,5,1,136,correct
1019,select;,2018-08-20 15:52:46.301047+10,6,0,136,noninterpretable
1020,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-20 15:54:05.345043+10,6,1,136,correct
1021,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE p.id = w.id AND year_born = 1935);",2018-08-20 16:02:06.951292+10,1,1,72,correct
1022,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-20 16:04:16.1462+10,2,1,72,correct
1023,"select id
from person
where year_born in (select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-20 16:04:40.946347+10,3,1,24,correct
1024,SELECT *;,2018-08-20 16:06:30.38631+10,1,0,145,noninterpretable
1025,"select count(*) from writer, person 
where writer.id=person.id and year_born=1935
group by year_born having count(*);",2018-08-20 16:49:15.741398+10,1,0,197,partially correct
1026,"select count(*) from writer, person 
where year_born=1935 and person.id in (select  writer.id from writer )
group by year_born having count(*);",2018-08-20 16:54:08.821793+10,1,0,197,partially correct
1027,"SELECT Writer name;
",2018-08-20 17:13:22.94105+10,1,0,198,noninterpretable
1028,"select production_year, count(production_year)
from movie
group by production_year;",2018-08-20 17:18:11.645713+10,2,0,181,partially correct
1029,"select count(production_year),production_year 
from movie
where production_year=1991 or 1992 or 1993
group by production_year;

",2018-08-20 17:21:23.830759+10,2,0,184,partially correct
1030,"SELECT p.id,p.first_name,p.last_name
FROM PERSON p,(SELECT COUNT(*),d.id
FROM DIRECTOR d,WRITER w
WHERE d.id = w.id AND d.title = w.title AND d.production_year = w.production_year
GROUP BY d.id
HAVING COUNT(*)>1) AS a
WHERE a.id = P.id;",2018-08-20 18:37:43.673617+10,4,1,64,correct
1031,SELECT COUNT(id) FROM person WHERE year_born=1935;,2018-08-20 18:50:48.714502+10,1,0,63,partially correct
1032,"SELECT m.title,m.production_year
FROM MOVIE m,(SELECT title,production_year,p.id
FROM PERSON p INNER JOIN WRITER w ON w.id =p.id 
WHERE first_name = 'Kevin' AND 'last_name = Willamson') AS k 
WHERE m.title = k.title AND k.production_year = m.production_year;",2018-08-20 18:58:20.257232+10,5,0,64,partially correct
1033,"SELECT production_year, COUNT(title) FROM (SELECT * FROM movie WHERE production_year =1993 or production_year = 1992 or production_year = 1991) As e GROUP BY production_year;",2018-08-20 19:01:24.481163+10,2,1,63,correct
1034,"select;
",2018-08-20 19:04:05.574087+10,7,0,136,noninterpretable
1035,"SELECT
	id, 
	first_name,
	last_name

FROM
	person p
WHERE
	p.year_born = (
		SELECT
			max(year_born)
		FROM
			person);
",2018-08-20 19:07:07.669916+10,7,1,136,correct
1036,"SELECT;
",2018-08-20 19:08:15.869305+10,8,0,136,noninterpretable
1037,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-20 19:18:25.418687+10,8,1,136,correct
1038,"select;
",2018-08-20 19:19:08.22641+10,9,0,136,noninterpretable
1039,"SELECT m.title, m.production_year
FROM MOVIE m,(SELECT w.title,w.production_year
FROM PERSON p INNER JOIN WRITER w ON p.id = w.id
WHERE  p.first_name='Kevin'AND p.last_name ='Williamson')AS a 
WHERE m.production_year=a.production_year AND m.title = a.title;

",2018-08-20 19:24:44.987621+10,5,1,64,correct
1040,"SELECT country
FROM RESTRICTION
WHERE title ='Shakespeare in Love' AND description = 'M';",2018-08-20 19:27:57.384929+10,6,1,64,correct
1041,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(result)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-20 19:31:15.936336+10,9,1,136,correct
1042,"select;
",2018-08-20 19:33:17.638855+10,10,0,136,noninterpretable
1043,"SELECT id,first_name,last_name
FROM PERSON
WHERE year_born = (SELECT MAX(year_born)
FROM PERSON );
",2018-08-20 19:33:36.571385+10,7,1,64,correct
1044,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-20 19:43:07.383362+10,10,1,136,correct
1045,"SELECT a.title,a.production_year,b.first_name,b.last_name
FROM (SELECT first_name,last_name,d.title,d.production_year
FROM DIRECTOR d,PERSON p
WHERE d.id = p.id) AS b,(SELECT *
FROM Movie_Award
WHERE award_name = 'BAFTA Film Award' AND category = 'best film' AND result ='won') AS a
WHERE b.title = a.title AND b.production_year = a.production_year;

",2018-08-20 19:46:05.715767+10,8,1,64,correct
1046,"select;
",2018-08-20 20:04:51.5291+10,11,0,136,noninterpretable
1047,"SELECT a.times
FROM PERSON p,(SELECT id,COUNT(*) AS times
FROM WRITER_AWARD
WHERE year_of_award>1990 AND year_of_award<1995 AND result ='won'
GROUP BY id) AS a
WHERE a.id =p.id AND p.first_name='Woody' AND p.last_name = 'ALLEN' ;",2018-08-20 20:09:22.515867+10,9,0,64,partially correct
1048,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-20 20:09:40.815143+10,11,1,136,correct
1049,select;,2018-08-20 20:11:45.501377+10,3,0,136,noninterpretable
1050,select;,2018-08-20 20:12:21.283317+10,3,0,136,noninterpretable
1051,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-20 20:15:27.648123+10,3,1,136,correct
1052,"SELECT a.times
FROM PERSON p,(SELECT *,COUNT(*) AS times
FROM writer_award w
WHERE year_of_award>1990 AND year_of_award < 1996 AND result='won'
GROUP BY w.id) AS a
WHERE p.id = a.id AND p.first_name = 'Woody' AND p.last_name = 'Allen';",2018-08-20 20:16:18.824347+10,9,1,64,correct
1053,select;,2018-08-20 20:17:05.414515+10,13,0,136,noninterpretable
1054,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-20 20:21:51.129551+10,13,1,136,correct
1055,select;,2018-08-20 20:23:34.688374+10,14,0,136,noninterpretable
1056,"SELECT r.id
FROM ROLE r,
APPEARANCE a
WHERE a.title ='Psycho' AND a.production_year = 1960 AND r.title = A.title AND r.production_year=a.production_year AND a.scene_no=1;",2018-08-20 20:39:47.530715+10,10,0,64,partially correct
1057,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-20 20:46:51.841752+10,14,1,136,correct
1058,"select;
",2018-08-20 20:50:05.62261+10,15,0,136,noninterpretable
1059,select;,2018-08-20 20:50:57.167462+10,15,0,136,noninterpretable
1060,"SELECT COUNT(w.id) FROM WRITER w, Person p WHERE w.id = p.id  ;",2018-08-20 20:51:03.327842+10,1,0,200,partially correct
1061,select;,2018-08-20 20:51:24.365581+10,15,0,136,noninterpretable
1062,"SELECT COUNT(w.id) FROM WRITER w, Person p WHERE w.id = p.id AND p. year_born =1935 ;",2018-08-20 20:52:39.569801+10,1,0,200,partially correct
1063,"SELECT COUNT(w.id) FROM WRITER w, Person p WHERE w.id = p.id AND p.year_born = 1935 ;",2018-08-20 20:53:21.164855+10,1,0,200,partially correct
1064,"SELECT COUNT(w.id) FROM WRITER w, Person p WHERE w.id = p.id GROUP BY w.id HAVING p.year_born = 1935 ;",2018-08-20 20:55:46.294926+10,1,0,200,partially correct
1065,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-20 21:02:13.114453+10,15,1,136,correct
1066,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-20 21:02:13.257431+10,15,1,136,correct
1067,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-20 21:08:47.960196+10,9,1,118,correct
1068,"select count(Distinct first_name) from Person,Director where Person.id!=Director.id;",2018-08-20 21:11:40.483506+10,12,0,101,partially correct
1069,"SELECT COUNT (*) FROM (SELECT wa.result 
FROM writer_award wa
INNER JOIN writer w
ON w.id = wa.id
INNER JOIN person p
ON p.id = w.id
WHERE p.first_name = 'Woody' AND p.last_name = 'Allen' AND lower(wa.result) = 'won'
AND wa.production_year >= '1991-01-01' AND wa.production_year < '1996-01-01') AS s;


",2018-08-20 21:13:05.439772+10,9,0,95,partially correct
1070,"select scene.description, scene.title, role.id
from scene, role
where scene.title='Psycho' and scene.production_year='1960' and scene.title=role.title
and scene.description = role.description;",2018-08-20 21:18:28.51555+10,10,0,118,partially correct
1071,"SELECT COUNT (*) FROM (SELECT wa.result 
FROM writer_award wa
INNER JOIN writer w
ON w.id = wa.id
INNER JOIN person p
ON p.id = w.id
WHERE lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen' 
AND lower(wa.result) = 'won'
AND wa.production_year = w.production_year
AND wa.year_of_award >= 1991 
AND wa.year_of_award <= 1995) AS s;


",2018-08-20 21:19:22.936897+10,9,1,95,correct
1072,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
        s.title = a.title
    AND s.title = r.title 
    AND s.scene_no = a.scene_no
    AND s.production_year = a.production_year
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-20 21:23:47.508719+10,10,1,118,correct
1073,"select movie.*
from movie;",2018-08-20 21:26:16.941376+10,11,0,118,partially correct
1074,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-20 21:28:20.277708+10,11,1,118,correct
1075,;,2018-08-20 21:28:53.275225+10,1,0,83,noninterpretable
1076,;,2018-08-20 21:29:40.304989+10,2,0,83,noninterpretable
1077,;,2018-08-20 21:30:00.797212+10,12,0,83,noninterpretable
1083,"SELECT DISTINCT r.id FROM role r
INNER JOIN scene s
ON r.title = s.title
AND r.production_year = s.production_year
WHERE lower(s.title) = 'psycho';
",2018-08-20 21:44:20.262624+10,10,0,95,partially correct
1084,"SELECT COUNT(DISTINCT w.id)
FROM writer w, (SELECT * FROM person WHERE year_born=1935) AS f
WHERE f.id =w.id;",2018-08-20 21:56:44.827746+10,1,1,63,correct
1085,"SELECT count(*) FROM writer w INNER JOIN person p
USING(id)
INNER JOIN writer_award
USING(id,title,production_year)
WHERE year_of_award >= 1991 AND year_of_award <= 1995
AND result = 'won'
AND lower(first_name) = 'woody' AND lower(last_name) = 'allen';",2018-08-20 21:58:01.654882+10,9,1,25,correct
1086,"SELECT COUNT(*) FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);",2018-08-20 21:58:49.587558+10,1,1,63,correct
1087,"SELECT COUNT(*) FROM person p WHERE NOT EXISTS(
SELECT * FROM director d WHERE p.id=d.id);",2018-08-20 22:00:35.759465+10,12,1,63,correct
1088,"select id 
from person 
where year_born != (select max(year_born) from person)
limit 1;",2018-08-20 22:07:27.385618+10,3,0,118,partially correct
1089,"select id from person
where year_born=
(select max(year_born)
from person 
where year_born != (select max(year_born) from person));
",2018-08-20 22:09:06.750247+10,3,1,118,correct
1090,"SELECT re.id FROM (SELECT r.id, s.scene_no FROM role r
INNER JOIN scene s
ON r.title = s.title
AND r.production_year = s.production_year
INNER JOIN appearance a
ON a.title = s.title
AND a.production_year = s.production_year
AND a.scene_no = s.scene_no
AND a.description = r.description 
WHERE lower(s.title) = 'psycho'
AND a.production_year = 1960) AS re
GROUP BY re.id
HAVING COUNT (re.id) =1;
",2018-08-20 22:16:04.075514+10,10,1,95,correct
1091,"SELECT title, production_year FROM movie m WHERE m.title in (SELECT title t FROM person p, writer w
WHERE p.id=w.id AND first_name=""Kevin"" AND last_name=""Williamson"");",2018-08-20 22:19:15.027487+10,5,1,63,correct
1092,"SELECT w.title, w.production_year FROM writer w, person p WHERE p.first_name=""Kevin"" and p.last_name=""Williamson"" and p.id=w.id;",2018-08-20 22:24:07.726456+10,5,1,63,correct
1093,"SELECT ma.title,ma.production_year, p.first_name, p.last_name
FROM (SELECT * FROM MOVIE_AWARD WHERE lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result)= 'won')as ma,
PERSON p, 
Director d
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year;",2018-08-20 22:26:47.589007+10,8,1,150,correct
1094,"select person.id, first_name, last_name
from person inner join
    (select id, count(result='won' or null) as won_count, count(result='nominated' or null) as nom_count
    from director_award 
        inner join director 
        on director_award.title = director.title
    group by id) as result_count
    on person.id=result_count.id
where won_count=0 and nom_count>=1
order by last_name;",2018-08-20 22:27:22.340591+10,13,0,118,partially correct
1095,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-20 22:29:25.790704+10,13,1,118,correct
1096,select * from movie;,2018-08-20 22:34:30.277808+10,14,0,118,partially correct
1097,"SELECT person.id
FROM person
WHERE year_born = 1935;",2018-08-20 22:35:35.378423+10,1,0,83,partially correct
1098,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-20 22:36:51.677643+10,14,1,118,correct
1099,"SELECT COUNT (m.title) FROM movie m
WHERE m.title NOT IN (SELECT DISTINCT ma.title FROM movie_award ma
INNER JOIN crew_award ca
ON ma.result = ca.result
INNER JOIN director_award da
ON ca.result = da.result
INNER JOIN writer_award wa
ON da.result = wa.result
INNER JOIN actor_award aa
ON wa.result = aa.result
WHERE lower(ma.result) = 'won'); ",2018-08-20 22:40:01.702209+10,11,0,95,partially correct
1100,"SELECT r.title,scene_no,SUM(scene_no)
FROM APPEARANCE a INNER JOIN ROLE r ON a.title = r.title AND a.production_year = r.production_year AND a.description = r.description
WHERE r.title ='Psycho' AND scene_no=1 AND r.production_year = 1960
GROUP BY r.id;

",2018-08-20 22:49:25.425288+10,10,0,64,partially correct
1101,"
Select COUNT(DISTINCT writer.id) 
from writer
where writer.id in (select person.id 
                    from Person
                    where Person.year_born= 1935
                      );





",2018-08-20 22:52:33.45552+10,1,1,83,correct
1102,"SELECT id
FROM ROLE r,APPEARANCE a
WHERE r.title=a.title AND r.description=a.description AND r.production_year = a.production_year AND a.production_year=1960 AND
a.title = 'Psycho'
GROUP BY id
HAVING COUNT(*)=1;
",2018-08-20 22:57:44.831209+10,10,1,64,correct
1103,"SELECT COUNT (m.title) FROM movie m
WHERE m.title NOT IN 
(SELECT ma.title FROM movie_award ma
WHERE lower(result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT ca.title FROM crew_award ca 
WHERE lower(result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT da.title FROM director_award da
WHERE lower(result) = 'won' and da.title = m.title and da.production_year = m.production_year 
UNION
SELECT wa.title FROM writer_award wa 
WHERE lower(result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
UNION
SELECT aa.title FROM actor_award aa
WHERE lower(result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);
",2018-08-20 23:07:04.857606+10,11,1,95,correct
1104,"select count(*)
from writer, person
where writer.id = person.id and person.year_born = '1935';",2018-08-20 23:16:41.934035+10,1,0,109,partially correct
1105,"Select count(*)
from person
where not exists(
select * from director
where person.id= director.id);",2018-08-20 23:17:30.520326+10,12,1,83,correct
1106,"Select production_year, count(*)
from movie e
where e.production_year=1993 or e.production_year=1992 or e.production_year=1991
group by e.production_year
order by e.production_year desc;",2018-08-20 23:22:05.213056+10,2,1,83,correct
1107,"select count(*)
from person
where exists (select * from writer where writer.id = person.id and person.year_born = '1935');",2018-08-20 23:23:36.400056+10,1,1,109,correct
1108,"Select person.id, person.first_name, person.last_name
From person
where person.id in(
select writer.id 
from writer
where writer.id in(
select director.id
from director
group by director.id
having count(director.id)>2
));

",2018-08-20 23:34:33.746926+10,4,0,83,partially correct
1109,"Select person.id, person.first_name, person.last_name
From person
where person.id in(
select writer.id 
from writer
where writer.id in(
select director.id
from director
group by director.id
having count(director.id)>2
and director.title=writer.title
));

",2018-08-20 23:36:50.209564+10,4,0,83,partially correct
1110,"SELECT COUNT(wa.title)
 from (SELECT * FROM PERSON p where lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen')as w,
 (SELECT * FROM WRITER_AWARD WHERE production_year > 1991 and production_year < 1995) as wa
 where w.id = wa.id;",2018-08-20 23:37:41.039466+10,9,1,150,correct
1111,"select * from writer w inner join person p
on w.id = p.id
where p.year_born>1935;",2018-08-20 23:41:04.637744+10,1,0,203,partially correct
1112,"select count(*) from writer w inner join person p
on w.id = p.id
where p.year_born>1935;",2018-08-20 23:41:49.135236+10,1,0,203,partially correct
1113,"Select person.id, person.first_name, person.last_name
From person
where person.id in(
select writer.id 
from writer
where writer.id in(
select director.id
from director
group by director.id
having count(director.id)>1
and director.title=writer.title
));

",2018-08-20 23:41:51.971322+10,4,0,83,partially correct
1114,"select count(*) from writer w inner join person p
on w.id = p.id
where p.year_born=1935;",2018-08-20 23:42:22.047457+10,1,0,203,partially correct
1115,"select count(*)
from person p
where exists (select * from writer w where w.id = p.id and p.year_born=1935);",2018-08-20 23:52:01.639638+10,1,1,203,correct
1116,"Select title, production_year
From movie
where movie.title in (
Select title
From writer
Where writer.id in(
Select person.id
From person
where person.first_name='Kevin' and person.last_name='Williamson'));
",2018-08-20 23:53:34.42761+10,5,1,83,correct
1117,"SELECT id, year_born
FROM WRITER, PERSON
WHERE WRITER.id=PERSON.id
GROUP BY id
HAVING SUM(year_born)=1935;",2018-08-20 23:59:35.660791+10,1,0,185,noninterpretable
1118,"SELECT year_born, COUNT(*)
FROM person
GROUP BY year_born HAVING COUNT(*)=1935;",2018-08-21 00:04:44.942604+10,1,0,204,partially correct
1119,"SELECT title
FROM MOVIE;",2018-08-21 00:06:00.887642+10,11,0,64,partially correct
1120,"select production_year,count(*)
from writer w
group by production_year
having production_year in (1991,1992,1993);",2018-08-21 00:06:31.502355+10,2,0,203,partially correct
1121,"select production_year,count(*)
from writer w
where production_year>1990 and production_year<1994
group by production_year;",2018-08-21 00:07:56.875457+10,2,0,203,partially correct
1122,"select production_year,count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-21 00:08:34.308753+10,2,1,203,correct
1123,"select count(*) from person p
where not exists (select * from director d where d.id = p.id);",2018-08-21 00:10:16.494477+10,12,1,203,correct
1124,"select production_year,count*
from movie
where production_year = 1992 or 1992 or 1993;",2018-08-21 00:12:24.386401+10,2,0,134,noninterpretable
1125,"SELECT COUNT(production_year)
FROM movie
GROUP BY production_year
HAVING production_year=1993,1992,1991;",2018-08-21 00:17:06.087427+10,2,0,204,noninterpretable
1126,"SELECT COUNT(id), year_born
FROM person,writer
WHERE EXISTS (SELECT id FROM writer);

",2018-08-21 00:19:54.041257+10,1,0,185,noninterpretable
1127,"select production_year,count(*)
from movie
where production_year = 1991 or production_year =1992 or production_year =1993
group by production_year;",2018-08-21 00:20:35.564285+10,2,1,134,correct
1128,"select count(*)
from person
where person.id not in(select director.id
		 		from director
		 		where director.id = person.id);",2018-08-21 00:25:45.242194+10,12,1,134,correct
1129,"select count(*)
from person
where person.id not in(select director.id
		 		from director
		 		where director.id = person.id);",2018-08-21 00:25:45.446062+10,12,1,134,correct
1130,"SELECT COUNT(*)
FROM MOVIE m
WHERE NOT EXISTS(SELECT title, production_year
FROM MOVIE_AWARD ma
 WHERE   ma.title=m.title AND ma.production_year=m.production_year AND lower(ma.result)='won')
 AND NOT EXISTS(SELECT title, production_year
FROM CREW_AWARD ca
 WHERE   ca.title=m.title AND ca.production_year=m.production_year AND lower(ca.result)='won')
 AND NOT EXISTS(SELECT title, production_year
FROM DIRECTOR_AWARD da
 WHERE   da.title=m.title AND da.production_year=m.production_year AND lower(da.result)='won')
 AND NOT EXISTS(SELECT title, production_year
FROM WRITER_AWARD wa
 WHERE   wa.title=m.title AND wa.production_year=m.production_year AND lower(wa.result)='won')
 AND NOT EXISTS(SELECT title, production_year
FROM ACTOR_AWARD aa
 WHERE   aa.title=m.title AND aa.production_year=m.production_year AND lower(aa.result)='won');


",2018-08-21 00:31:02.730879+10,11,1,64,correct
1131,"select person.id,fist_name,last_name
from person
where count(select * 
		from writer
		where writer.id = director.id and director.id=person.id)>=2;",2018-08-21 00:39:48.769163+10,4,0,134,noninterpretable
1132,"select w.title,w.production_year from writer w
where exists (select * from person p where p.id = w.id and p.first_name='Kevin' and p.last_name='Williamson');",2018-08-21 00:41:00.916845+10,5,1,203,correct
1133,"select country from restriction r
where title='Shakespeare in Love' and description='M';",2018-08-21 00:42:37.138127+10,6,1,203,correct
1134,"select id,first_name,last_name from person p
where year_born=(select max(year_born) from person); ",2018-08-21 00:44:16.627383+10,7,1,203,correct
1135,"SELECT id
FROM PERSON
WHERE year_born=
(SELECT MAX(year_born)
FROM PERSON
WHERE year_born NOT IN(SELECT MAX(year_born)
FROM PERSON)) ;",2018-08-21 00:46:41.447459+10,3,1,64,correct
1136,"select m.title, m.production_year,p.first_name,p.last_name from movie_award m inner join director d 
on d.title=m.title and d.production_year=m.production_year
inner join person p
on p.id=d.id
where award_name='BAFTA Film Award' and category='best film'  and result='won' ;",2018-08-21 00:52:04.020447+10,8,1,203,correct
1137,"select count(*) from writer_award wa inner join writer w
on w.id = wa.id and w.title=wa.title
inner join person p
on p.id=w.id
where result='won' and year_of_award>=1991 and year_of_award<=1995;",2018-08-21 00:57:08.372947+10,9,0,203,partially correct
1138,"select count(*) from writer_award wa inner join writer w
on w.id = wa.id and w.title=wa.title
inner join person p
on p.id=w.id
where result='won' and year_of_award>=1991 and year_of_award<=1995 and p.first_name='Woody' and p.last_name='Allen';",2018-08-21 00:58:28.50513+10,9,1,203,correct
1139,"select id from person 
where id=(
select id from role
where description=(

select description from appearance
where title='Psycho'
group by description
having count(*)=1));
",2018-08-21 01:05:23.142818+10,10,0,203,partially correct
1140,"


SELECT id 
FROM DIRECTOR_AWARD da,DIRECTOR d
WHERE lower(result)='nominated' AND da.title=d.title AND da.production_year=d.production_year ;",2018-08-21 01:13:26.373516+10,13,0,64,partially correct
1141,"select count(*)
from movie m
where not exists (select * from crew_award ca where ca.title=m.title and ca.production_year=m.production_year)
and not exists (select * from movie_award ma where ma.title=m.title and ma.production_year=m.production_year)
and not exists (select * from director_award da where da.title=m.title and da.production_year=m.production_year)
and not exists (select * from writer_award wa where wa.title=m.title and wa.production_year=m.production_year)
and not exists (select * from actor_award aa where aa.title=m.title and aa.production_year=m.production_year);",2018-08-21 01:14:30.222633+10,11,0,203,partially correct
1142,"select count(*)
from movie m
where not exists (select * from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won')
and not exists (select * from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won')
and not exists (select * from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won')
and not exists (select * from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won')
and not exists (select * from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won');",2018-08-21 01:18:15.323914+10,11,1,203,correct
1143,"


SELECT id, award_name,year_of_award,category
FROM DIRECTOR_AWARD da,DIRECTOR d
WHERE lower(result)='nominated' AND da.title=d.title AND da.production_year=d.production_year AND id NOT IN 
(SELECT id 
FROM DIRECTOR_AWARD da1,DIRECTOR d1
WHERE lower(result)='won' AND da1.title=d1.title AND da1.production_year=d1.production_year
);
",2018-08-21 01:19:39.185321+10,13,1,64,correct
1144,"SELECT p.id 
FROM PERSON p,
(SELECT id,COUNT(*) AS noOfMovie
FROM(SELECT d.id,d.title, d.production_year
FROM DIRECTOR d 
UNION
SELECT w.id,w.title, w.production_year
FROM WRITER w )
GROUP BY id) AS a
WHERE a.noOfMovie=(SELECT MAX(noOfMovie)
FROM (SELECT id,COUNT(*) AS noOfMovie
FROM(SELECT id,title, production_year
FROM DIRECTOR 
UNION
SELECT id,title, production_year
FROM WRITER)
GROUP BY id));",2018-08-21 01:58:46.765731+10,14,0,64,partially correct
1226,"select dw.id, dw.first_name, dw.last_name
from (PERSON p natural join DIRECTOR natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-21 15:27:06.030809+10,4,1,174,correct
1145,"SELECT id 
FROM (
SELECT id,COUNT(*) as nom
FROM(SELECT id,title, production_year
FROM DIRECTOR d 
UNION
SELECT id,title,production_year
FROM WRITER w) 
GROUP BY id) 
WHERE nom=(SELECT MAX(nom)
FROM (
SELECT id,COUNT(*) as nom
FROM(SELECT id,title, production_year
FROM DIRECTOR d 
UNION
SELECT id,title,production_year
FROM WRITER w) 
GROUP BY id) );
",2018-08-21 02:16:53.589532+10,14,1,64,correct
1146,"SELECT first_name,last_name,title,production_year,description
FROM PERSON p,ROLE r
WHERE p.id = r.id AND p.id = 

(SELECT a.id 
FROM (SELECT r1.id,COUNT(*) as nom
FROM ROLE r1
GROUP BY r1.id) AS a
WHERE a.nom =
(SELECT MAX(nom)
FROM(SELECT r2.id,COUNT(*) as nom
FROM ROLE r2
GROUP BY r2.id) a1));",2018-08-21 02:27:23.149595+10,15,1,64,correct
1147,"select d.id, da.award_name, da.year_of_award, da.category from director as d inner join director_award as da on d.title = da.title and d.production_year = da.production_year 
where lower(da.result) = 'naminated';",2018-08-21 09:30:09.510557+10,13,0,99,partially correct
1148,"select d.id, da.award_name, da.year_of_award, da.category from director as d inner join director_award as da on d.title = da.title and d.production_year = da.production_year
where lower(da.result) = 'nominated';",2018-08-21 09:34:35.271927+10,13,1,99,correct
1149,"SELECT p3.id FROM person p3 
WHERE p3.year_born = (SELECT MAX(re.year_born) 
FROM (SELECT p2.id, p2.year_born FROM person p2
WHERE p2.id NOT IN (SELECT p.id FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person))) AS re);",2018-08-21 10:15:29.320091+10,3,1,95,correct
1150,"SELECT id
from apperance;",2018-08-21 10:53:13.277385+10,10,0,150,noninterpretable
1151,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE d.title = da.title AND d.production_year = da.production_year
AND lower(da.result) = 'nominated'
GROUP BY da.result
HAVING COUNT(da.result) >= 1;",2018-08-21 11:18:50.034676+10,13,1,95,correct
1152,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, director d, person p
where
lower(ma.result)='won'
and lower(ma.award_name)='bafta film award'
and lower(ma.category)='best film'
and d.title=ma.title
and d.production_year=ma.production_year
and d.id=p.id ;",2018-08-21 11:22:35.491842+10,8,1,94,correct
1153,"SELECT re2.id FROM 
(SELECT re.id, COUNT(re.title) AS total FROM (SELECT w.id, w.title FROM writer w
UNION
SELECT d.id, d.title FROM director d) AS re
GROUP BY re.id) AS re2
WHERE re2.total IN (SELECT MAX (re2.total) FROM (SELECT re.id, COUNT(re.title) AS total 
FROM (SELECT w.id, w.title FROM writer w
UNION
SELECT d.id, d.title FROM director d) AS re
GROUP BY re.id) AS re2);",2018-08-21 11:37:48.935715+10,14,1,95,correct
1154,SELECT movies ;,2018-08-21 11:54:02.92144+10,2,0,189,noninterpretable
1155,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-21 11:54:20.789635+10,2,1,189,correct
1156,"SELECT p.first_name, p.last_name, r.* FROM
(SELECT re.id FROM (SELECT r.id, COUNT(r.description) total FROM role r
GROUP BY r.id) AS re
WHERE re.total IN (SELECT MAX(re.total) FROM 
(SELECT r.id, COUNT(r.description) total FROM role r
GROUP BY r.id) AS re)) AS re2, person p, role r
WHERE p.id = re2.id AND r.id = re2.id;",2018-08-21 11:55:39.430696+10,15,0,95,partially correct
1157,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-21 11:56:56.520296+10,10,1,150,correct
1158,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description FROM
(SELECT re.id FROM (SELECT r.id, COUNT(r.description) total FROM role r
GROUP BY r.id) AS re
WHERE re.total IN (SELECT MAX(re.total) FROM 
(SELECT r.id, COUNT(r.description) total FROM role r
GROUP BY r.id) AS re)) AS re2, person p, role r
WHERE p.id = re2.id AND r.id = re2.id;",2018-08-21 11:57:10.82211+10,15,1,95,correct
1159,"select count(*)
from WRITER
where id in (
select id 
from PERSON
where year_born = 1935);",2018-08-21 12:48:09.577222+10,1,0,211,partially correct
1160,"select count(distinct id)
from WRITER
where id in (
select id 
from PERSON
where year_born = 1935);",2018-08-21 12:51:28.816177+10,1,1,211,correct
1161,"select count(*), production_year
from MOVIE
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-21 12:59:43.192848+10,2,1,211,correct
1162,"select production_year, count(*)
from MOVIE
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-21 13:00:47.003506+10,2,1,211,correct
1163,"select count(distinct id)
from PERSON p
where p.id not in (select id from DIRECTOR);",2018-08-21 13:03:34.513806+10,12,1,211,correct
1164,;,2018-08-21 13:07:12.728394+10,14,0,24,noninterpretable
1165,"select count(*) 
from Writer w, person p
WHERE w.id = p.id;",2018-08-21 13:13:48.029883+10,1,0,215,partially correct
1166,"select count(*) 
from Writer w, person p
WHERE w.id = p.id and p.year_born=1935;",2018-08-21 13:14:41.261801+10,1,0,215,partially correct
1167,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON
        FROM (SELECT d.id, title, production_year
		FROM director d
	      UNION
	      SELECT w.id, title,production_year
		FROM writer w) x1
		GROUP BY x1.id) x
WHERE x.NoOfWorkedON = 
        (SELECT MAX(x2.NoOfWorkedON)
	   FROM (SELECT x1.id, count(*) AS NoOfWorkedON
	       FROM (SELECT d.id, title, production_year
		   FROM director d
		   UNION
		   SELECT w.id, title, production_year
		   FROM writer w) x1
		   GROUP BY x1.id) x2);",2018-08-21 13:17:12.541834+10,14,1,24,correct
1168,"SELECT COUNT(Writer.id)
FROM Writer, Person
WHERE Writer.id = Person.id AND Person.year_born = '1935';",2018-08-21 13:19:07.972339+10,1,0,214,partially correct
1169,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-21 13:20:01.866888+10,1,1,215,correct
1170,select max (count(;,2018-08-21 13:23:23.565137+10,14,0,99,noninterpretable
1171,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-21 13:24:44.646807+10,14,1,99,correct
1172,"SELECT production_year, count(*) numbers
FROM movie m
where m.production_year = 1993 or m.production_year = 1992 or m.production_year = 1991
GROUP BY production_year;",2018-08-21 13:25:14.402246+10,2,1,215,correct
1173,"select id, first_name, last_name
from PERSON
where id in (

	select d.id
	from DIRECTOR d, WRITER w
	where d.id = w.id
	group by d.id
	having count(d.id) > 1
);",2018-08-21 13:27:19.981448+10,4,0,211,partially correct
1174,"select id, first_name, last_name
from PERSON
where id in (

	select d.id
	from DIRECTOR d, WRITER w
	where d.id = w.id
	group by d.id
	having count(d.id) > 2
);",2018-08-21 13:28:26.73859+10,4,1,211,correct
1175,"SELECT title, production_year, description, MAX(x.nums)
FROM(
     select *, count(*) as nums from role
     GROUP By role.id) x;",2018-08-21 13:31:21.239275+10,15,0,24,partially correct
1176,"SELECT count(*) numbers
FROM person p 
WHERE NOT EXIST(
SELECT * FROM Director d
WHERE p.id = d.id
);",2018-08-21 13:34:18.800377+10,12,0,215,noninterpretable
1177,"SELECT count(*) numbers
FROM person p 
WHERE NOT EXISTS(
SELECT * FROM Director d
WHERE p.id = d.id
);",2018-08-21 13:34:41.874035+10,12,1,215,correct
1178,"select count(*)
from movie
where production_year between 1991 and 1993;",2018-08-21 13:35:17.915009+10,2,0,109,partially correct
1179,"select production_year, count(*)
from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-21 13:36:40.695886+10,2,1,109,correct
1180,"SELECT COUNT(*)
FROM Person
WHERE EXISTS (SELECT * FROM Writer WHERE Writer.id = Person.id AND Person.year_born = 1935);",2018-08-21 13:38:38.74785+10,1,1,214,correct
1181,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, (select id, count(*) as nums from role group by id) as b
where p.id = r.id
and p.id = b.id
and nums = (select max(nums) from (
    select id, count(*) as nums
    from role
    group by id));",2018-08-21 13:45:24.162522+10,15,1,24,correct
1182,"select count(*) from person
where year_born =1935;",2018-08-21 13:45:32.328387+10,1,0,174,partially correct
1183,"SELECT p.id, first_name, last_name
FROM person p
WHERE p.id in(
	SELECT count(*)
	FROM director d, writer w
	WHERE d.id = w.id and d.title = w.title
	GROUP BY p.id, first_name, last_name
	HAVING count(*)>2
);
",2018-08-21 13:52:53.55946+10,4,0,215,noninterpretable
1184,"SELECT production_year, COUNT(*)
FROM Movie
WHERE production_year<1994 AND production_year>1990
GROUP BY production_year;",2018-08-21 13:58:46.979432+10,2,1,214,correct
1185,"SELECT production_year, COUNT(*)
FROM Movie
WHERE production_year<1994 AND production_year>1990
GROUP BY production_year;",2018-08-21 13:59:15.956793+10,2,1,214,correct
1186,"select count(*)
from person
where person.id not in(
select director.id 
  from director, movie
  where director.title = movie.title and director.production_year = movie.production_year);",2018-08-21 14:08:53.618101+10,12,1,109,correct
1187,SELECT COUNT(*) FROM person WHERE EXISTS (SELECT * FROM writer WHERE person.id=writer.id AND person.year_born=1935); ,2018-08-21 14:11:46.280932+10,1,1,155,correct
1188,"SELECT COUNT(*)
FROM Person INNER JOIN Director
WHERE Person.id != Director.id;",2018-08-21 14:13:23.461385+10,12,0,214,partially correct
1189,"SELECT COUNT(*)
FROM Person
WHERE NOT EXISTS (SELECT * FROM Director WHERE Person.id = Director.id);",2018-08-21 14:16:26.220997+10,12,1,214,correct
1190,"select p.first_name, p.last_name, r.title, r.production_year, r.description from person as p inner join role as r on p.id = r.id where exists (select max(a) from (select count (r.id) as a from role r group by r.id) a group by a;",2018-08-21 14:16:40.181519+10,15,0,99,noninterpretable
1191,"SELECT production_year, COUNT(*) FROM movie GROUP BY production_year HAVING production_year=1993 OR production_year=1992 OR production_year=1991;",2018-08-21 14:18:24.214593+10,2,1,155,correct
1192,"SELECT production_year, COUNT(*) FROM movie WHERE production_year=1991 AND  production_year=1992 AND  production_year=1993 GROUP BY production_year;",2018-08-21 14:20:10.020225+10,2,0,155,partially correct
1193,"SELECT COUNT(year_born) FROM person, writer GROUP BY id Having year_born=1935;",2018-08-21 14:22:38.866062+10,1,0,216,noninterpretable
1194,"SELECT count(*) 
FROM preson p
WHERE  EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND year_born =1935);",2018-08-21 14:24:18.418131+10,1,0,174,noninterpretable
1195,SELECT COUNT(*) FROM person WHERE NOT EXISTS (SELECT id FROM director WHERE person.id=director.id);,2018-08-21 14:24:46.505068+10,12,1,155,correct
1196,"select count(*) 
from PERSON p
where exists (select * from WRITER w where w.id = p.id and p.year_born = 1935);",2018-08-21 14:29:13.399861+10,1,1,174,correct
1197,"SELECT id, first_name, last_name 
FROM person

WHERE 
(SELECT m.title, m.production_year FROM movie AS m 
WHERE director.id=writer.id 
AND director.title=movie.title 
AND director.production_year=movie.production_year 
GROUP BY m.title 
HAVING COUNT(*)>2);
",2018-08-21 14:36:41.275157+10,4,0,155,noninterpretable
1198,"SELECT id, first_name, last_name FROM person NATURAL JOIN director NATURAL JOIN writer GROUP BY id HAVING COUNT(*)>1;",2018-08-21 14:39:18.687358+10,4,1,155,correct
1199,"select w.id
from writer w
where w.id in (
	select d.id
	from director d, movie m
	where d.title = m.title and d.production_year = m.production_year
	group by d.id
	having count(*) > 1
);",2018-08-21 14:45:57.433217+10,4,0,109,partially correct
1200,"select distinct w.id
from writer w
where w.id in (
	select d.id
	from director d, movie m
	where d.title = m.title and d.production_year = m.production_year
	group by d.id
	having count(*) > 1
);",2018-08-21 14:46:19.047027+10,4,0,109,partially correct
1201,"SELECT Person.id, first_name, last_name
FROM (SELECT Writer.id, Director.id, COUNT(Writer.title), COUNT(Director.title)
      FROM Writer INNER JOIN Director
	ON Writer.id = Director.id
	INNER JOIN Person
	ON Person.id = Director.id
	WHERE COUNT(Writer.title)>1 AND COUNT(Director.title)>1)
GROUP BY Person.id;",2018-08-21 14:48:18.569777+10,4,0,214,noninterpretable
1202,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id=person.id AND person.year_born=1935);",2018-08-21 14:50:56.035553+10,1,1,216,correct
1203,"SELECT title, production_year FROM movie 
WHERE (SELECT id FROM person NATURAL JOIN writer WHERE person.first_name='Williamson' AND person.last_name= 'Kevin')
;",2018-08-21 14:52:06.074023+10,5,0,155,partially correct
1204,"select distinct p.id, p.first_name, p.last_name
from (person p natural join director natural join writer) as dw
group by dw.id
having count(*) > 1;",2018-08-21 14:52:10.953773+10,4,1,109,correct
1205,"SELECT title, production_year FROM writer, person
WHERE writer.id=person.id AND lower(first_name)='kevin' AND lower(last_name)= 'williamsion'
;",2018-08-21 14:55:22.422376+10,5,0,155,partially correct
1206,"SELECT title, production_year FROM writer, person
WHERE writer.id=person.id AND lower(first_name)='kevin' AND lower(last_name)= 'williamson'
;",2018-08-21 14:56:07.621049+10,5,1,155,correct
1207,"Select country
from Restriction_Category
where description='M';
",2018-08-21 14:57:33.238825+10,6,0,83,partially correct
1208,"SELECT DW.id, first_name, last_name
FROM (Person NATURAL JOIN Writer NATURAL JOIN Director) AS DW
GROUP BY DW.id
HAVING COUNT(*)>1;",2018-08-21 15:01:12.853679+10,4,1,214,correct
1209,SELECT country FROM movie NATURAL JOIN restriction_category GROUP BY country HAVING lower(title)='Shakespeare in Love' AND restriction_category.description='M';,2018-08-21 15:02:15.956574+10,6,0,155,partially correct
1210,"select count(*)
from MOVIE
where production_year = 1993; ",2018-08-21 15:03:25.349503+10,2,0,174,partially correct
1211,SELECT country FROM restriction WHERE lower(title)='shakespeare inlove' AND description='M';,2018-08-21 15:04:03.801503+10,6,0,155,partially correct
1212,SELECT country FROM restriction WHERE lower(title)='shakespeare in love' AND description='M';,2018-08-21 15:04:31.208314+10,6,1,155,correct
1213,"Select country
from restriction
where title='Shakespeare in love' and description='M';

",2018-08-21 15:04:52.12809+10,6,0,83,partially correct
1214,"SELECT title, production_year
FROM Writer INNER JOIN PERSON
ON Writer.id = Person.id
WHERE Person.first_name = 'Kevin' AND Person.last_name = 'Williamson';",2018-08-21 15:05:35.159284+10,5,1,214,correct
1215,"select production_year, count(*)
from MOVIE
where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-21 15:06:44.85895+10,2,1,174,correct
1216,"SELECT title, production_year
FROM Writer INNER JOIN PERSON
ON Writer.id = Person.id
WHERE Person.first_name = 'Kevin' AND Person.last_name = 'Williamson';",2018-08-21 15:07:04.813578+10,5,1,214,correct
1217,"select m.title, m.production_year
from movie m
where exists(
	select *
	from writer w, person p
	where m.title = w.title and m.production_year = w.production_year and p.id = w.id and p.first_name = 'Kevin' and p.last_name = 'Williamson'
	);",2018-08-21 15:07:22.85047+10,5,1,109,correct
1218,"select count(*)
from PERSON p
where exists (select * from DIRECTOR d where p.id != d.id );",2018-08-21 15:13:00.389297+10,12,0,174,partially correct
1219,"select count(*)
from PERSON p
where not exists (select * from DIRECTOR d where p.id = d.id );",2018-08-21 15:13:55.801793+10,12,1,174,correct
1220,"select count(person.id) from person
where excepts
(select person.id from 
person inner join director ON director.id=person.id) ;",2018-08-21 15:14:29.706436+10,12,0,184,noninterpretable
1221,"select country
from restriction
where title = ""Shakespeare in Love"" and description = 'M';",2018-08-21 15:15:08.75786+10,6,1,109,correct
1222,"SELECT Restriction.country
FROM Restriction INNER JOIN Restriction_Category
ON Restriction.country = Restriction_Category.country
WHERE title = 'Shakespeare in Love' AND Restriction_Category.description = 'M';",2018-08-21 15:15:52.178298+10,6,1,214,correct
1223,"select id, first_name, last_name 
from PERSON 
where exists(select * from WRITER w, DIRECTOR d where w.id=d.id and d.title > 0);",2018-08-21 15:21:33.611202+10,4,0,174,partially correct
1224,"SELECT DBS.id, DBS.first_name, DBS.last_name
FROM (SELECT * FROM Person ORDER BY year_born) AS DBS;",2018-08-21 15:22:50.683866+10,7,0,214,partially correct
1225,"select dw.id, dw.first_name, dw.last_name
from (PERSON p natural join DIRECTOR natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-21 15:24:07.784857+10,4,1,174,correct
1229,"SELECT COUNT(production_year)
FROM MOVIE
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-21 15:33:00.07259+10,2,0,216,partially correct
1230,"SELECT production_year,COUNT(production_year)
FROM MOVIE
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-21 15:33:43.253695+10,2,1,216,correct
1231,"SELECT L.title, L.production_year, L.first_name, L.last_name
FROM (MOvie NATURAL JOIN Person Natural JOIN Movie_Award) AS L
WHERE L.category = 'Best Film' AND L.award_name = 'BAFTA Film Award';",2018-08-21 15:36:14.616348+10,8,0,214,partially correct
1232,"SELECT COUNT(*)
FROM WRITER, PERSON
WHERE WRITER.id = PERSON.id AND year_born = 1935;",2018-08-21 15:36:47.693842+10,1,0,224,partially correct
1233,"SELECT COUNT(*),year_born
FROM person, writer
WHERE person.id=writer.id AND  year_born<1935
GROUP BY id;",2018-08-21 15:37:25.296211+10,1,0,228,noninterpretable
1234,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM WRITER W WHERE W.id = P.id AND P.year_born = 1935);",2018-08-21 15:39:06.269649+10,1,1,224,correct
1235,"SELECT COUNT(*)
FROM person
WHERE NOT (SELECT id FROM director WHERE director.id=person.id);",2018-08-21 15:39:55.879416+10,12,0,216,partially correct
1236,"select distinct writer.id from writer
where exists (select director.id,count(director.title)
from director
group by director.id
having count(director.title)>2);",2018-08-21 15:40:23.749734+10,4,0,184,partially correct
1237,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS (SELECT id FROM director WHERE director.id=person.id);",2018-08-21 15:40:41.455831+10,12,1,216,correct
1238,SELECT COUNT(*);,2018-08-21 15:46:55.46025+10,12,0,224,noninterpretable
1239,"select writer.id,title, production_year from writer
where writer.id=(select person.id from person
where first_name='kevin' AND last_name='Williamson');",2018-08-21 15:48:29.25418+10,5,0,184,partially correct
1240,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d
			   WHERE p.id = d.id);",2018-08-21 15:49:25.810421+10,12,1,224,correct
1241,"SELECT L.title, L.production_year, first_name, last_name
FROM (SELECT title, production_year 
      FROM Movie_Award
	WHERE lower(category) = 'best film' AND lower(award_name) = 'bafta film award' AND lower(result) = 'won') AS L,
	Person,
	Director
WHERE L.title = Director.title AND Director.id = Person.id AND L.production_year = Director.production_year;",2018-08-21 15:49:49.981595+10,8,1,214,correct
1242,"select writer.id,title, production_year from writer
where writer.id=(select person.id from person
where lower(first_name)='kevin' AND lower(last_name)='williamson');",2018-08-21 15:50:01.937409+10,5,0,184,partially correct
1243,"select title, production_year from writer
where writer.id=(select person.id from person
where lower(first_name)='kevin' AND lower(last_name)='williamson');",2018-08-21 15:50:47.020993+10,5,1,184,correct
1244,"SELECT COUNT(*),year_born
FROM person, writer
WHERE person.id=writer.id
HAVING COUNT(*)<1935;",2018-08-21 15:52:42.741977+10,1,0,228,noninterpretable
1245,"SELECT COUNT(*),year_born
FROM person, writer
WHERE person.id=writer.id
HAVING COUNT(*)<1935;",2018-08-21 15:52:53.923207+10,1,0,228,noninterpretable
1246,"select m.title, m.production_year, p.first_name, p.last_name
from movie m, person p 
where p.id in (
select d.id
from director d, movie_award ma
where d.title = ma.title and d.production_year = ma.production_year and ma.award_name = 'BAFTA Film Award' and category = 'best Film');",2018-08-21 15:55:05.08469+10,8,0,109,partially correct
1247,"WITH h as(SELECT r.id,r.title,r.production_year,r.description, COUNT(*) as total
FROM role r
GROUP BY r.id)

SELECT p.first_name,p.last_name,h.title,h.production_year,h.description
FROM person p,h
WHERE p.id = (
                 SELECT h.id
                 FROM h
                 WHERE h.total = (
                 SELECT MAX(total)
                 FROM h));",2018-08-21 16:05:01.481711+10,15,0,68,partially correct
1248,"select country from restriction
where lower(title)='shakespeare in love' AND description='M';
",2018-08-21 16:05:31.080789+10,6,1,184,correct
1249,"select id,first_name,last_name from person
where year_born=(select MIN(year_born) from person); ",2018-08-21 16:07:30.921792+10,7,0,184,partially correct
1250,"select id,first_name,last_name from person
where year_born=(select MAX(year_born) from person); ",2018-08-21 16:08:42.24376+10,7,1,184,correct
1251,"select production_year,person.first_name,person.last_name from (movie_award natural join movie natural join person)

where lower(award_name)='bafta film award' AND lower(category)='best film';",2018-08-21 16:18:07.472263+10,8,0,184,partially correct
1252,"SELECT production_year,count(*)
FROM movie
GROUP BY production_year
HAVING production_year=1993 AND 1992 AND 1991;",2018-08-21 16:23:32.997367+10,2,0,228,partially correct
1253,"Select year_born, count(*) from person
inner join writer on person.id = writer.id group by year_born = '1935';

",2018-08-21 16:27:19.823702+10,1,0,172,partially correct
1254,"Select count(*) from person
where exists (select * from writer where person.id = writer.id and person.year_born = 1935);

",2018-08-21 16:31:16.331656+10,1,1,172,correct
1255,"
SELECT count(*) from PERSON where year_born= 1935;",2018-08-21 16:33:08.7368+10,1,0,146,partially correct
1256,"select production_year, count(*) from movie where movie.production_year in(1993, 1992, 1991) group by production_year ; ",2018-08-21 16:44:38.222046+10,2,1,172,correct
1257,"SELECT d.id,da.award_name,da.year_of_award,da.category,da.result
FROM director d INNER JOIN director_award da
ON da.title = d.title 
AND da.production_year = d.production_year
AND da.result = 'nominated'
WHERE NOT EXISTS(
        SELECT
            id
        FROM
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-21 16:44:53.881916+10,13,0,68,partially correct
1258,"select count(*) from person, writer w where exists (select * from person where w.id != person.id);",2018-08-21 16:51:48.10263+10,12,0,172,partially correct
1259,SELECT * FROM role;,2018-08-21 16:56:02.156107+10,15,0,39,partially correct
1260,select count(*) from person where not exists(select * from director w where w.id = person.id);,2018-08-21 16:57:50.767853+10,12,1,172,correct
1261,"select count(id) from writer_award
where lower(award_name)='woody allen'and year_of_award>=1991 and year_of_award<=1995;",2018-08-21 17:03:00.535132+10,9,0,184,partially correct
1262,"select count(id) from writer_award
where id=(select person.id from person
where lower(first_name)='woody'AND lower(last_name)='allen')
AND year_of_award>=1991 and year_of_award<=1995;
",2018-08-21 17:07:38.677691+10,9,0,184,partially correct
1263,"select count (person.id) from person
where person.id=(select writer_award.id from writer_award
where year_of_award>=1991 and year_of_award<=1995) 
AND lower(first_name)='woody'AND lower(last_name)='allen';",2018-08-21 17:15:32.358926+10,9,0,184,partially correct
1264,"select count(*) 
from movie_award, writer 
where movie_award.year_of_award between 1991 and 1995 
and writer.title = movie_award.title 
and writer.production_year = movie_award.production_year
and writer.id in (
select person.id
from person
where person.first_name = ""Woody"" and person.last_name = ""Allen"");
",2018-08-21 17:24:27.438385+10,9,0,109,partially correct
1265,"SELECT id, first_name, last_name FROM person GROUP BY id HAVING MIN(year_born);",2018-08-21 17:25:56.957347+10,7,0,155,partially correct
1266,"select p.first_name,p.last_name,r.title,r.production_year,r.description 
from person as p, role as r 
where r.id =p.id
group by r.title, r.production_year,r.description;",2018-08-21 17:27:15.339329+10,15,0,33,partially correct
1267,"SELECT id, first_name, last_name FROM person GROUP BY id HAVING MAX(year_born);",2018-08-21 17:27:20.052705+10,7,0,155,partially correct
1268,"SELECT id, first_name, last_name FROM person WHERE person.year_born=(SELECT MAX(year_born) FROM person);
",2018-08-21 17:28:38.571803+10,7,1,155,correct
1269,"SELECT title, production_year, first_name, last_name 
FROM person, movie_award NATURAL JOIN director
WHERE lower(category)='best film' AND lower(award_name)='BAFTA Film Award'; ",2018-08-21 17:33:01.005752+10,8,0,155,partially correct
1270,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
FROM (SELECT title, production_year FROM movie_award
WHERE lower(category)='best film' 
AND lower(award_name)='BAFTA Film Award'
AND lower(result)='won') AS ma, director AS d, person AS p 
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND d.id=p.id; ",2018-08-21 17:35:51.483398+10,8,0,155,partially correct
1271,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
FROM (SELECT title, production_year FROM movie_award
WHERE lower(category)='best film' 
AND lower(award_name)='bafta film award'
AND lower(Result)='won') AS ma, director AS d, person AS p 
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND d.id=p.id; ",2018-08-21 17:37:53.413667+10,8,1,155,correct
1272,"select distinct first_name, last_name from person,director inner join writer on director.id = writer.id and director.title = writer.title and director.id = person.id  ;",2018-08-21 17:42:22.080422+10,4,0,172,partially correct
1273,"select 
	count(*) as number_of_award 
from 
	writer_award wa, 
	writer w, 
	person p
where 
	wa.title = w.title 
	and wa.production_year = w.production_year
	and wa.id = w.id
	and w.id = p.id
	and result = 'won'
	and first_name = 'Woody'
	and last_name = 'Allen'
	and year_of_award >= 1991 
	and year_of_award <= 1995;
",2018-08-21 17:45:02.468327+10,9,1,109,correct
1274,"SELECT COUNT(*) FROM (SELECT * FROM writer_award AS wa, writer AS w, person AS p WHERE wa.title=w.title AND wa.production_year=w.production_year AND p.id=w.id) AS nr

WHERE nr.year_of_award>1990 AND nr.year_of_award<1995;",2018-08-21 17:46:35.133417+10,9,0,155,partially correct
1275,"SELECT COUNT(*) AS number_of_award 
FROM writer_award AS wa, writer AS w, person AS p
WHERE wa.title=w.title
AND wa.production_year=w.production_year
AND wa.id=w.id
AND w.id=p.id
AND lower(result)='won'
AND lower(first_name)='woody'
AND lower(last_name)='allen'
AND year_of_award>=1991
AND year_of_award<=1995;",2018-08-21 17:50:37.885069+10,9,1,155,correct
1276,"SELECT COUNT(*) 
FROM (SELECT * FROM writer_award AS wa, writer AS w, person AS p WHERE wa.title=w.title AND wa.production_year=w.production_year AND p.id=w.id AND lower(result)='won' AND lower(first_name)='woody' AND lower(last_name)='allen') AS nr

WHERE nr.year_of_award>1990 AND nr.year_of_award<1995;",2018-08-21 17:52:12.794557+10,9,1,155,correct
1277,"SELECT ns.id 
FROM (SELECT * FROM crew AS c, appearance AS a
WHERE lower(a.title)='psycho'
AND a.production_year=1960
AND a.title=c.title
AND a.production_year=c.production_year
AND scene_no=1) AS ns;",2018-08-21 18:02:37.780917+10,10,0,155,partially correct
1278,"select dw.id, dw.first_name, dw.last_name from (person p inner join director d on d.id = p.id inner join writer w on d.id = w.id and d.title = w.title) as dw group by dw.id having count(*) > 1;",2018-08-21 18:12:40.046821+10,4,1,172,correct
1279,"select kw.title, kw.production_year from ( writer natural join person) as kw where first_name = 'Kevin' and last_name = 'Williamson' ; ",2018-08-21 18:36:01.586369+10,5,1,172,correct
1280,Select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-21 18:39:57.256719+10,6,1,172,correct
1281,"select first_name,last_name from person where year_born = (select  min(year_born) from person);",2018-08-21 18:47:29.342225+10,7,0,172,partially correct
1282,"select id,first_name,last_name from person where year_born = (select  max(year_born) from person);",2018-08-21 18:49:02.851881+10,7,1,172,correct
1283,SELECT id FROM role WHERE EXISTS( SELECT*FROM scene WHERE role.title=scene.title AND role.title='Psycho' AND production_year='1960'); ,2018-08-21 18:55:27.229711+10,10,0,100,partially correct
1284,"select title, production_year from movie_award where award_name = 'BAFTA Film Award' and category = 'best film' ;",2018-08-21 19:09:27.494493+10,8,0,172,partially correct
1285,"
Select country
from restriction
where title='Shakespeare in Love' and description='M';
",2018-08-21 19:18:43.158209+10,6,1,83,correct
1286,"select count(*) from Writer a,Person b where a.id=b.id and b.year_born=1953;",2018-08-21 19:18:46.525513+10,1,0,205,partially correct
1287,"Select id, first_name, last_name
from person
group by year_born
having min(year_born);",2018-08-21 19:23:17.630627+10,7,0,83,partially correct
1288,"SELECT count(person.id)
FROM person, writer
where person.id = writer.id and year_born = '1935';",2018-08-21 19:26:02.374876+10,1,0,235,partially correct
1289,"select p.first_name, p.last_name, r.title, r.production_year,r.description
from person p, role r,
(select id,count(*) as number_of_roles
from role
group by id) as b

where  
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-21 19:27:47.769808+10,15,1,94,correct
1290,"SELECT id, award_name, year_of_award, category 
FROM person, director, director_award
WHERE person.id = director.id, director_award.title = director.title, 
      director_award.year_of_award = director.year_of_award,
      director_award.result = fail;",2018-08-21 19:31:28.624276+10,13,0,148,noninterpretable
1291,"SELECT count(distinct(writer.id))
FROM person, writer
where person.id = writer.id and person.year_born = '1935';",2018-08-21 19:33:57.980766+10,1,1,235,correct
1292,"select p.first_name, p.last_name, r.title, r.production_year,r.description
from person p, role r,
(select id,count(*) as number_of_roles
from role
group by id) as b

where  
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-21 19:35:50.550929+10,15,1,94,correct
1293,"select count(*) from writer,person
where writer.id=person.id and person.year_born='1935'; 
",2018-08-21 19:44:34.032125+10,1,0,234,partially correct
1294,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-21 19:48:39.990551+10,1,1,234,correct
1295,"select movie.production_year, count(title)
from movie
where movie.production_year ='1993' or movie.production_year ='1992'or movie.production_year='1991'
GROUP BY movie.production_year;",2018-08-21 19:54:48.845086+10,2,1,235,correct
1296,"SELECT count(*)
FROM person p
WHERE EXIST(SELECT * FROM director r WHERE r.id != p.id);",2018-08-21 19:57:09.351695+10,12,0,228,noninterpretable
1297,select count(*) from Person b where EXISTS (select* from writer a where a.id=b.id and b.year_born=1935);,2018-08-21 20:00:49.862993+10,1,1,205,correct
1298,Select count(*) from movie a where a.production_year=1993 and 1992 and 1991;,2018-08-21 20:07:13.555278+10,2,0,205,partially correct
1299,"select wa.title, wa.production_year,p.first_name, p.last_name from  ( Select title, production_year from movie_award where award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won') as wa, director as d, person as p where wa.title = d.title and p.id = d.id and wa.production_year = d.production_year; ",2018-08-21 20:09:34.608863+10,8,1,172,correct
1300,"SELECT count(*) 
FROM (SELECT DISTINCT id FROM writer INNER JOIN person using(id) WHERE year_born = 1935);",2018-08-21 20:18:11.26753+10,1,1,27,correct
1301,"Select production_year, count(*) from movie a  where a.production_year in (1991,1992,1993)
group by production_year; ",2018-08-21 20:22:19.473568+10,2,1,205,correct
1302,"WITH born_in AS (SELECT id FROM person
WHERE id IN (SELECT id FROM person NATURAL JOIN writer
			WHERE year_born = 1935))
			
			SELECT COUNT(*) FROM born_in;",2018-08-21 20:24:16.665732+10,1,1,25,correct
1303,select count(*) from person a where exists(select* from director b where a.id != b.id); ,2018-08-21 20:28:34.804061+10,12,0,205,partially correct
1304,"SELECT production_year, COUNT(title) FROM movie
WHERE production_year = 1993
GROUP BY production_year

UNION

SELECT production_year, COUNT(title) FROM movie
WHERE production_year = 1992
GROUP BY production_year

UNION

SELECT production_year, COUNT(title) FROM movie
WHERE production_year = 1991
GROUP BY production_year;",2018-08-21 20:30:57.385187+10,2,1,25,correct
1305,"SELECT COUNT(*)
FROM writer AS w, person AS p
WHERE w.id = p.id AND p.year_born = 1935;",2018-08-21 20:33:17.94186+10,1,0,212,partially correct
1306,"SELECT title, production_year
FROM writer w,movie m
WHERE w.title=m.title
AND (SELECT id FROM person,writer WHERE p.id=w.id AND w.firs_tname=Kevin AND w.last_name=Williamson)=m.id;",2018-08-21 20:37:29.301415+10,5,0,228,noninterpretable
1307,"SELECT COUNT(id) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-21 20:39:27.876399+10,12,1,25,correct
1308,"select count(*)
from person p
where not exists(select * from director d where d.id = p.id);",2018-08-21 20:43:45.500447+10,12,1,72,correct
1309,"select p.id, first_name, last_name
from person p
where exists (select d.id, count(*) from director d inner join writer w on w.id=d.id group by d.id having count(*)>1);",2018-08-21 20:47:00.132119+10,4,0,72,partially correct
1310,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-21 20:56:11.027843+10,4,1,72,correct
1311,"SELECT COUNT(id) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-21 20:57:17.010393+10,12,1,25,correct
1312,"select title, production_year
from (writer natural join person) as dp
where dp.first_name='Kevin' and dp.last_name='Williamson';",2018-08-21 21:00:02.969199+10,5,1,72,correct
1313,"select country
from restriction r
where r.title = 'Shakespeare in Love' and description = 'M';",2018-08-21 21:02:08.626025+10,6,1,72,correct
1314,select count(*) from person a where not exists(select* from director b where a.id = b.id); ,2018-08-21 21:02:17.635475+10,12,1,205,correct
1315,"select production_year and count(*) from MOVIE where production_year in (1993, 1992, 1991);
",2018-08-21 21:04:01.476276+10,2,0,146,partially correct
1316,"select production_year, count(*) from MOVIE where production_year in (1993, 1992, 1991) group by production_year;
",2018-08-21 21:05:05.104268+10,2,1,146,correct
1317,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-21 21:05:21.181027+10,7,1,72,correct
1318,"select dmap.title, dmap.production_year, dmap.first_name, dmap.last_name
from (director natural join movie_award natural join person) as dmap
where lower(dmap.award_name) like 'bafta%' and lower(dmap.category) = 'best film';",2018-08-21 21:10:50.237687+10,8,0,72,partially correct
1319,"select title, production_year, first_name, last_name
from (director natural join movie_award natural join person) as dmap
where lower(award_name) like 'bafta%' and lower(category) = 'best film' and result = 'won';",2018-08-21 21:13:19.502445+10,8,1,72,correct
1320,"select count(*)
from (writer_award natural join person)
where year_of_award > 1990 and year_of_award < 1996 and first_name = 'Woody' and last_name = 'Allen';",2018-08-21 21:16:13.601849+10,9,0,72,partially correct
1321,"select count(*)
from (writer_award natural join person)
where year_of_award > 1990 and year_of_award < 1996 and first_name = 'Woody' and last_name = 'Allen' and result = 'won';",2018-08-21 21:17:01.524366+10,9,1,72,correct
1322,"select id, count(*) from PERSON inner join DIRECTOR on PERSON.id = DIRECTOR.id;
",2018-08-21 21:17:22.517054+10,12,0,146,noninterpretable
1323,"select count(*) from PERSON where not exists (select * from DIRECTOR where PERSON.id = DIRECTOR.id);
",2018-08-21 21:19:52.285998+10,12,1,146,correct
1324,"select first_name, last_name, title, production_year 
from PERSON p, MOVIE
where exists (select * from WRITER w where w.id = p.id and first_name ='Kevin' and last_name ='Williamson' );",2018-08-21 21:20:19.045692+10,5,0,174,partially correct
1325,select* from director a where exists(select* from writer b where a.id=b.id and a.title>1);,2018-08-21 21:23:25.265706+10,4,0,205,partially correct
1326,"select id, first_name, last_name from PERSON
where (select * from WRITER inner join DIRECTOR on WRITER.id = DIRECTOR.id);",2018-08-21 21:30:34.735162+10,4,0,146,noninterpretable
1327,"select id
from role r inner join scene s on r.title = s.title and r.production_year = s.production_year
where lower(s.title) = 'psycho' and s.production_year = 1960
group by id;",2018-08-21 21:31:55.52855+10,10,0,72,partially correct
1328,"SELECT COUNT *
FROM movie m
WHERE NOT EXISTS (select count * FROM award a );",2018-08-21 21:47:31.425303+10,11,0,120,noninterpretable
1329,"
SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-21 21:49:12.224191+10,11,1,120,correct
1330,"SELECT id 
FROM person 
WHERE (SELECT MAX(year_born) FROM person);",2018-08-21 21:54:06.646703+10,3,0,120,partially correct
1331,"
SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person
				WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-21 21:57:33.883219+10,3,1,120,correct
1332,"SELECT
    r.id
FROM
    scene s
    inner join appearance a on s.title = a.title AND s.production_year = a.production_year AND s.scene_no = a.scene_no
    inner join ROLE r on s.title = r.title AND s.production_year = r.production_year AND a.description = r.description
WHERE
    lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-21 22:02:00.343169+10,10,1,72,correct
1333,"SELECT p.id, da.award_name, da.year_of_award, da.category
FROM person p, director_award da
WHERE da.result != 'won';",2018-08-21 22:02:31.893418+10,13,0,120,partially correct
1334,"select count(*)
from movie
where not exists (select * from (movie natural join movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award));",2018-08-21 22:04:55.521387+10,11,0,72,partially correct
1335,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-21 22:05:53.916053+10,13,1,120,correct
1338,"SELECT id
FROM writer w, director d, movie m
WHERE w.title = m.title AND
	w.production_year = m.production_year AND
	d.title = m.title AND
	d.production_year = m.production_year;",2018-08-21 22:12:09.21391+10,14,0,120,noninterpretable
1339,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-21 22:15:32.225852+10,14,1,120,correct
1407,"select production_year, count (*)
from movie where production_year >= 1991 and production_year <= 1993
group by production_year;",2018-08-22 01:57:43.103831+10,2,1,152,correct
1411,"SELECT count(*)
FROM PERSON 
WHERE year_born = '1935'
AND person.id = writer.id;",2018-08-22 09:09:28.489898+10,1,0,241,noninterpretable
1413,"SELECT country
FROM restriction r
WHERE r.title = 'Shakespeare in Love' and r.description = 'M';",2018-08-22 09:19:59.291394+10,6,1,215,correct
1340,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-21 22:16:11.394309+10,11,1,72,correct
1341,"SELECT year_born, COUNT(*)
FROM PERSON
NATURAL JOIN WRITER
GROUP BY year_born
HAVING year_born = 1935;",2018-08-21 22:16:47.441763+10,1,0,11,partially correct
1342,"


SELECT count(DISTINCT p.id)
FROM person p, writer w
WHERE p.id= w.id AND p.year_born = 1935;",2018-08-21 22:28:17.505139+10,1,1,120,correct
1343,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-21 22:30:22.566731+10,4,1,146,correct
1344,"select w.title, w.production_year 
from PERSON p, WRITER w
where w.id = p.id and first_name ='Kevin' and last_name ='Williamson';",2018-08-21 22:34:27.16291+10,5,1,174,correct
1345,"select r.country
from RESTRICTION r, MOVIE m
where r.title = m.title and r.description = 'Shakespeare in Love as M';",2018-08-21 22:40:14.579885+10,6,0,174,partially correct
1346,"select country
from RESTRICTION 
where title= 'Shakespeare in Love'  and description = 'M';",2018-08-21 22:43:38.303129+10,6,1,174,correct
1347,select max(year_born) from person where year_born < (select max(year_born) from person);,2018-08-21 22:44:58.334876+10,3,0,72,partially correct
1348,"select id from person
where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-21 22:45:39.715584+10,3,1,72,correct
1349,"select w.id 
from 
	writer w,appearance a
where 
	a.title = w.title
	and a.production_year = w.production_year
	and a.title = 'Psycho'
	and a.production_year = 1960
	and scene_no = 1;",2018-08-21 22:52:29.488539+10,10,0,109,partially correct
1350,"select id, first_name, last_name
from PERSON
where min(year_born);",2018-08-21 22:55:48.965416+10,7,0,174,noninterpretable
1351,"select id, first_name, last_name
from PERSON p
where p.year_born = (select max(year_born) from PERSON);",2018-08-21 22:57:27.760616+10,7,1,174,correct
1352,"select id, award_name, year_of_award, category
from ((select * from director_award where lower(result) = 'nominated' having count(*)>1) 
	natural join (select award_name, year_of_award, category from director_award where lower(result) = 'won' group by title, production_year having count(*)=0)
	natural join director);",2018-08-21 22:57:29.672886+10,13,0,72,noninterpretable
1353,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da inner join director d on da.title = d.title AND da.production_year = d.production_year
WHERE
    lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da inner join director d on da.title = d.title AND da.production_year = d.production_year
        WHERE
            lower(da.result)= 'won' );",2018-08-21 23:02:21.757627+10,13,1,72,correct
1354,"count (select id from writer as w.id
select id from person as p.id
where w.id=p.id
group by (select year_born from person where year_born='1935'))as numberofwriter;


",2018-08-21 23:02:59.292772+10,1,0,20,noninterpretable
1355,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p WHERE w.id=p.id AND p.year_born = 1935);",2018-08-21 23:03:37.878907+10,1,1,11,correct
1356,"select 
	r.id 
from 
	scene s,appearance a, role r
where 
	a.title = s.title
	and a.production_year = s.production_year
	and a.description = s.description
	and s.scene_no = r.scene_no
	and s.production_year = r.production_year
	and a.description = r.description
	and a.title = 'Psycho'
	and a.production_year = 1960
group by 
	r.id
having
	count(*) = 1;",2018-08-21 23:04:49.975095+10,10,0,109,noninterpretable
1357,"select count(person.id) from person natural join writer 
where year_born=1935;

",2018-08-21 23:08:16.358916+10,1,0,184,partially correct
1358,"select id, first_name, last_name
from PERSON p
where p.year_born = (select max(year_born) from PERSON);",2018-08-21 23:09:24.483024+10,7,1,174,correct
1359,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-21 23:09:54.969389+10,1,1,20,correct
1360,"select d.id
from director d left join writer w on d.id = w.id and w.title = d.title and w.production_year = d.production_year
group by d.title, d.production_year
having count(d.id) = max(select count(*)
from director d left join writer w on d.id = w.id and w.title = d.title and w.production_year = d.production_year
group by d.title, d.production_year)as a;",2018-08-21 23:16:22.254618+10,14,0,72,noninterpretable
1361,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-21 23:21:06.440387+10,14,1,72,correct
1362,"SELECT  count(*)
FROM Writer,Person
WHERE Writer.id=Person.id
AND Person.year_born='1935';",2018-08-21 23:21:38.956303+10,1,0,238,partially correct
1363,"SELECT COUNT(DISTINCT(writer.id)) as Countid
FROM person,writer
where person.id = writer.id
AND person.year_born = '1935'
GROUP BY writer.id;
",2018-08-21 23:23:11.347414+10,1,1,68,correct
1364,SELECT COUNT(*) FROM PERSON WHERE year_born = 1935 AND person.id = id;,2018-08-21 23:24:11.179206+10,1,0,86,partially correct
1365,"select da.title, da.production_year, p.first_name, p.last_name
from DIRECTOR_AWARD da, PERSON p, DIRECTOR d
where da.title = d.title and d.id = p.id and
lower(award_name) = 'bafta film award' and lower(category) = 'best film';",2018-08-21 23:25:50.093091+10,8,0,174,partially correct
1366,"select first_name, last_name, r.*
from person p, role r
where r.id = max();",2018-08-21 23:26:22.058828+10,15,0,72,noninterpretable
1367,"select 
	r.id 
from 
	scene s,appearance a, role r
where 
	a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and s.title = r.title
	and s.production_year = r.production_year
	and a.description = r.description
	and a.title = 'Psycho'
	and a.production_year = 1960
group by 
	r.id
having
	count(*) = 1;",2018-08-21 23:26:34.044206+10,10,1,109,correct
1368,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love'
AND 	description = 'M';",2018-08-21 23:27:27.326353+10,6,1,68,correct
1369,"select ma.title, ma.production_year, p.first_name, p.last_name
from MOVIE_AWARD ma, PERSON p, DIRECTOR d
where ma.title = d.title and d.id = p.id and
lower(award_name) = 'bafta film award' and lower(category) = 'best film';",2018-08-21 23:27:39.861648+10,8,0,174,partially correct
1370,SELECT COUNT(*) FROM person p WHERE EXISTS (SELECT*FROM writer w WHERE w.id = p.id AND p.year_born = 1935);,2018-08-21 23:28:24.25811+10,1,1,86,correct
1371,"select ma.title, ma.production_year, p.first_name, p.last_name
from MOVIE_AWARD ma, PERSON p, DIRECTOR d
where ma.title = d.title and d.id = p.id and
lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result)='won';",2018-08-21 23:29:37.478088+10,8,1,174,correct
1372,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.year_born = (
SELECT MAX(p.year_born)
FROM person p 
);",2018-08-21 23:29:54.999782+10,7,1,68,correct
1408,"SELECT first_name, last_name
FROM person 
WHERE year_born == 1935;
",2018-08-22 09:02:13.428635+10,1,0,240,noninterpretable
1412,"SELECT e.title, production_year
FROM movie e
WHERE e.title in(
	SELECT title
	FROM person p, writer w
	WHERE w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson'
	GROUP BY title
);",2018-08-22 09:17:29.397479+10,5,1,215,correct
1373,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    role r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles in (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS b );",2018-08-21 23:32:50.301189+10,15,1,72,correct
1374,"select count(*)
from writer, person 
where person.year_born = '1935' And person.id = writer.id;",2018-08-21 23:35:09.420609+10,1,0,237,partially correct
1375,"WITH h as(SELECT title, production_year
FROM movie_award 
WHERE lower(award_name) = 'bafta film award'
AND result = 'won'
AND lower(category) = 'best film') 
SELECT h.title, h.production_year, p.first_name , p.last_name
FROM h, person p, director d
WHERE h.title = d.title
AND h.production_year = d.production_year
AND d.id = p.id



;",2018-08-21 23:42:12.830127+10,8,1,68,correct
1376,"select count(*) 
from WRITER_AWARD wa, PERSON as p, WRITER as w 
where w.id = wa.id and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen' 
and wa.production_year >1990 and wa.production_year < 1996;",2018-08-21 23:50:04.578325+10,9,0,174,partially correct
1377,"select count(*) as NUMBER_OF_AWARD
from WRITER_AWARD wa, PERSON as p, WRITER as w 
where w.id = wa.id 
and w.id = p.id
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen' 
and wa.year_of_award >1990
and wa.year_of_award < 1996 
and lower(result)='won'
and wa.production_year = w.production_year;",2018-08-21 23:54:37.720578+10,9,1,174,correct
1378,"select count(*)
from person p inner join
			writer w
where p.year_born = ""1935"";",2018-08-21 23:57:22.016637+10,1,0,43,partially correct
1379,"select count()
from person p inner join
			writer w
			on p.id = w.id
where p.year_born = ""1935"";",2018-08-21 23:57:43.206762+10,1,0,43,partially correct
1380,"select production_year,count (*) as numbersofmovies
from movie
where production_year = '1993' or production_year = '1992' or production_year = '1991'
group by production_year; ",2018-08-21 23:58:02.916966+10,2,1,237,correct
1381,"select count(*)
from person p inner join
			writer w
			on p.id = w.id
where p.year_born = ""1935"";",2018-08-21 23:58:15.669437+10,1,0,43,partially correct
1382,"select p.first_name, p.last_name
from PERSON as p,
	ROLE as r,
	SCENE as s
where lower(s.title) = 'psycho'
and r.title = s.title
and r.id = p.id
and r.production_year = 1960
group by first_name, last_name;",2018-08-22 00:01:58.189782+10,10,0,174,partially correct
1383,"select production_year, count(*)
from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-22 00:02:30.021705+10,2,1,43,correct
1384,"select count(*)
from person p
where not exists(select * from director d where p.id= d.id);",2018-08-22 00:04:28.795075+10,12,1,43,correct
1385,"select d.id
from director d
where exists(select * 
			from writer w 
			where w.id = d.id and
				w.title = d.title and
				w.production_year = d.production_year)
group by d.id
having count(*) > 1;",2018-08-22 00:08:15.502269+10,4,0,43,partially correct
1386,"select d.id
from director d
	natural join
	writer d
group by d.id
having count(d.id) >1;",2018-08-22 00:11:32.273843+10,4,0,43,partially correct
1387,"select w.title,w.production_year
from writer w natural join
	person p
where lower(p.first_name) = ""kevin"" and lower(p.last_name) = ""williamson"";",2018-08-22 00:17:01.497612+10,5,1,43,correct
1388,"select r.id
from APPEARANCE as a,
	ROLE as r,
	SCENE as s,
	MOVIE as m
where lower(m.title) = 'psycho'
and s.title = m.title
and s.production_year=m.production_year
and a.title = s.title
and a.scene_no = s.scene_no
and a.title =r.title
and a.production_year = r.production_year
and a.description = r.description
and m.production_year = 1960
and r.title = m.title
and r.production_year = m.production_year
group by r.id
having count (*) =1;",2018-08-22 00:17:43.090353+10,10,1,174,correct
1389,"select r.id
from APPEARANCE as a,
	ROLE as r,
	SCENE as s,
	MOVIE as m
where lower(m.title) = 'psycho'
and s.title = m.title
and s.production_year=m.production_year
and a.title = s.title
and a.scene_no = s.scene_no
and a.title =r.title
and a.production_year = r.production_year
and a.description = r.description
and m.production_year = 1960
and r.title = m.title
and r.production_year = m.production_year
group by r.id
having count (*) =1;",2018-08-22 00:17:52.94088+10,10,1,174,correct
1390,"select country
from restriction
where lower(title) = ""shakespeare in love"" 
				and lower(description) = ""m"";
",2018-08-22 00:19:01.336956+10,6,1,43,correct
1391,"select title,production_year
from movie 
where (writer natural join person).fist_name = Kevin and last_name=Williamson;
",2018-08-22 00:21:28.397995+10,5,0,134,noninterpretable
1392,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select min(ha.year_born) 
				from (select *
					from person p2) as ha);",2018-08-22 00:23:13.20999+10,7,0,43,partially correct
1393,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select max(ha.year_born) 
				from (select *
					from person p2) as ha);",2018-08-22 00:23:51.308934+10,7,1,43,correct
1394,"select title,production_year
from writer,person
where writer.id = person.id 
	and lower(first_name)= 'kevin'
	and lower(last_name)='williamson';",2018-08-22 00:29:08.429661+10,5,1,134,correct
1395,"select title,production_year
from writer,person
where writer.id = person.id 
	and lower(first_name)= 'kevin'
	and lower(last_name)='williamson';",2018-08-22 00:29:32.148637+10,5,1,134,correct
1396,"select count(*) 
from MOVIE m
where not exists(select * from 
MOVIE_AWARD  ma,
CREW_AWARD  ca,
DIRECTOR_AWARD  da,
WRITER_AWARD  wa,
ACTOR_AWARD  aa where
m.title = ma.title
and m.title = ca.title
and m.title = da.title
and m.title = wa.title
and m.title = aa.title
and lower(result) = 'won');",2018-08-22 00:34:36.197894+10,11,0,174,noninterpretable
1397,"select count(*) 
from MOVIE m
where not exists(
	select title, production_year 
	from MOVIE_AWARD  ma where lower(ma.result)='won' and ma.title =m.title and ma.production_year = m.production_year
	union
	select title, production_year
	from CREW_AWARD  ca where lower(ca.result)='won' and ca.title =m.title and ca.production_year = m.production_year
	union
	select title, production_year
	from WRITER_AWARD  wa where lower(wa.result)='won' and wa.title =m.title and wa.production_year = m.production_year
	union
	select title, production_year
	from DIRECTOR_AWARD  da where lower(da.result)='won' and da.title =m.title and da.production_year = m.production_year
	union
	select title, production_year
	from ACTOR_AWARD  aa where lower(aa.result)='won' and aa.title =m.title and aa.production_year = m.production_year);",2018-08-22 00:42:23.138696+10,11,1,174,correct
1398,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-22 00:45:34.271583+10,4,1,134,correct
1399,"select id 
from person p
where p.year_born = (select max(year_born) from person);",2018-08-22 00:48:19.345781+10,3,0,174,partially correct
1400,"select country
from restriction
where lower(title) = 'Shakespeare in Love' and lower (description) ='m';",2018-08-22 00:48:43.365346+10,6,0,134,partially correct
1401,"select country
from restriction
where lower(title) = 'Shakespeare in Love' and description ='M';",2018-08-22 00:50:37.379752+10,6,0,134,partially correct
1402,"select id 
from person p
where p.year_born = (select max(year_born) from person
where year_born < (select max(year_born) from PERSON));",2018-08-22 00:50:49.669614+10,3,1,174,correct
1403,"select country
from restriction
where lower(title) = 'shakespeare in love' and lower(description) ='m';",2018-08-22 00:51:43.772375+10,6,1,134,correct
1404,"
from   person
having min(year_born);",2018-08-22 00:55:49.118313+10,7,0,134,noninterpretable
1405,"SELECT  count(*) FROM person as p
WHERE exists (select * from writer as w
where w.id = p.id and p.year_born = 1935);",2018-08-22 01:53:27.088851+10,1,1,152,correct
1406,"select production_year, count (*)
from movie where production_year >= 1991 and production_year <= 1993;",2018-08-22 01:56:27.134401+10,2,0,152,partially correct
1410,"SELECT count(*)
FROM person p
WHERE year_born == 1935;
",2018-08-22 09:04:09.066953+10,1,0,240,noninterpretable
1414,"SELECT id, first_name, last_name
FROM person
WHERE year_born in(
	SELECT min(year_born)
	FROM person 
);",2018-08-22 09:22:42.004636+10,7,0,215,partially correct
1415,"SELECT id, first_name, last_name
FROM person
WHERE year_born in(
	SELECT max(year_born)
	FROM person 
);",2018-08-22 09:23:20.162554+10,7,1,215,correct
1416,"select country
from restriction
where lower(title) = 'shakespeare in love' and lower(description) ='m';",2018-08-22 09:23:47.607925+10,6,1,134,correct
1417,select count(*) from (writer natural join person) where year_born = 1935;,2018-08-22 09:32:00.423993+10,1,0,72,partially correct
1418,"select count(*)
from (writer_award natural join person) as wp
where lower(wp.fist_name) ='woody' and lower(last_name)='allen' and 1991<year_of_award<=1995;",2018-08-22 09:32:29.080921+10,9,0,134,noninterpretable
1419,"select count(*)
from (writer_award natural join person) as wp
where lower(wp.first_name) ='woody' and lower(last_name)='allen' and 1991<year_of_award<=1995;",2018-08-22 09:32:55.47461+10,9,0,134,partially correct
1420,"SELECT title, production_year, first_name, last_name
FROM movie_award m, person p
WHERE p.id in(
	SELECT id
	FROM director d
	WHERE p.id = d.id and d.title = m.title and m.award_name = 'BAFTA Film Award' and m.category = 'Best Film'
);",2018-08-22 09:34:22.881584+10,8,0,215,partially correct
1421,"SELECT production_year, count (*)
FROM movie 
WHERE production_year = '1993' OR production_year = '1992' OR production_year = '1991'
GROUP BY production_year ;",2018-08-22 09:35:40.247295+10,2,1,241,correct
1422,"select count(*) as number_of_award
from (writer_award natural join person) as wp
where lower(wp.first_name) ='woody' and lower(last_name)='allen' and 1991<=year_of_award<=1995 and lower(RESULT)= 'won';",2018-08-22 09:35:44.63478+10,9,0,134,noninterpretable
1423,"SELECT * 
FROM person p
WHERE NOT (SELECT id 
FROM director d
WHERE p.id = d.id); ",2018-08-22 09:39:33.992728+10,12,0,241,partially correct
1424,"SELECT count(*) 
FROM person p
WHERE NOT EXISTS (SELECT * 
FROM director d
WHERE p.id = d.id); ",2018-08-22 09:45:43.831061+10,12,1,241,correct
1425,;,2018-08-22 10:06:54.310987+10,1,0,232,noninterpretable
1426,SELECT COUNT(*) FROM WRITER w NATURAL JOIN PERSON p WHERE p.year_born='1935';,2018-08-22 10:14:38.013997+10,1,0,243,partially correct
1427,"

SELECT COUNT(*) FROM PERSON WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id=p.id AND p.year-born=1935;",2018-08-22 10:18:24.213193+10,1,0,243,noninterpretable
1428,"

SELECT COUNT(*) FROM PERSON WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id=p.id AND p.year-born=1935);",2018-08-22 10:18:44.853764+10,1,0,243,noninterpretable
1429,SELECT COUNT(*) FROM PERSON p WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id=p.id AND p.year_born=1935);,2018-08-22 10:19:31.28562+10,1,1,243,correct
1430,"SELECT production_year,COUNT(*) FROM MOVIE WHERE production_year BETWEEN 1991 AND 1993 GROUP BY production_year;",2018-08-22 10:23:56.876173+10,2,1,243,correct
1431,"select nr.id
from scene natural join role as nr
group by id
having count(select*
		from nr
		where lower(title)='psycho' and production_year =1960)=1;",2018-08-22 10:35:56.725203+10,10,0,134,noninterpretable
1432,SELECT p.id FROM PERSON p WHERE p.id NOT IN (SELECT p.id FROM PERSON p INNER JOIN DIRECTOR dir ON p.id=dir.id);,2018-08-22 10:36:23.785417+10,12,0,243,partially correct
1433,SELECT COUNT(*) FROM PERSON p WHERE NOT EXISTS (SELECT * FROM DIRECTOR dir WHERE p.id=dir.id);,2018-08-22 10:38:12.993206+10,12,1,243,correct
1434,"SELECT COUNT(*)
FROM person AS p
WHERE EXISTS (SELECT * FROM writer AS w
              WHERE p.id = w.id AND p.year_born = 1935);",2018-08-22 10:43:17.539553+10,1,1,212,correct
1435,"SELECT production_year, COUNT(*)
FROM movie
GROUP BY production_year
HAVING (production_year = 1993 OR production_year = 1992 OR production_year = 1991);",2018-08-22 10:47:32.826005+10,2,1,212,correct
1436,"SELECT COUNT(*)
FROM person AS P;",2018-08-22 10:52:27.157085+10,12,0,212,partially correct
1437,"SELECT COUNT(*)
FROM person AS P
WHERE NOT EXISTS (SELECT * FROM director d
                  WHERE p.id = d.id);",2018-08-22 10:53:22.031269+10,12,1,212,correct
1438,"SELECT person.id, person.first_name, person.last_name
FROM person INNER JOIN writer INNER JOIN director
ON person.id = writer.id = director.id
GROUP BY person.id
HAVING COUNT(*) >= 2;
",2018-08-22 11:00:09.70035+10,4,0,212,partially correct
1439,"SELECT person.id, person.first_name, person.last_name
FROM person INNER JOIN writer INNER JOIN director
GROUP BY person.id
HAVING COUNT(*) >= 2;
",2018-08-22 11:02:12.362423+10,4,0,212,partially correct
1440,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN writer NATURAL JOIN director) AS dw
GROUP BY dw.id
HAVING COUNT(*) >= 2;
",2018-08-22 11:05:56.928429+10,4,1,212,correct
1441,"
from   person
having min(year_born);",2018-08-22 11:08:19.043004+10,7,0,134,noninterpretable
1442,"
from person
where year_born=( select max(year_born)
                from person);",2018-08-22 11:22:25.089+10,7,0,134,noninterpretable
1443,"SELECT  distinct count(*)
FROM Writer,Person
WHERE Writer.id=Person.id
AND Person.year_born='1945';",2018-08-22 11:34:52.865828+10,1,0,238,partially correct
1444,"select count(w.id) from writer as w, person as p where w.id=p.id and p.year_born=1935;",2018-08-22 12:14:29.090362+10,1,0,99,partially correct
1445,"SELECT country FROM restriction AS r
WHERE r.title = ""Shakespeare in Love"" AND r.description = ""M"";",2018-08-22 12:14:37.940397+10,6,1,169,correct
1446,"SELECT id, first_name, last_name
FROM person
WHERE (SELECT MAX(year_born)
       FROM person);",2018-08-22 12:17:41.458064+10,7,0,169,partially correct
1447,"SELECT id, first_name, last_name
FROM person 
WHERE year_born = (SELECT MAX(year_born) FROM person);
",2018-08-22 12:26:19.062878+10,7,1,169,correct
1448,"select production_year, count(*) from movie where production_year=1993
union
select production_year, count(*) from movie where production_year=1992
union
select production_year, count(*) from movie where production_year=1991;",2018-08-22 12:28:40.573908+10,2,1,99,correct
1449,"SELECT dm.title, dm.production_year, dm.first_name, dm.last_name
FROM (director INNER JOIN movie_award INNER JOIN person
      ON director.title = movie_award.title
      AND director.id = person.id) AS dm
WHERE dm.award_name = ""BAFTA Film Award"" AND DM.category = ""Best Film"";",2018-08-22 12:34:32.706982+10,8,0,169,partially correct
1450,"select production_year, count(*) from movie where production_year<=1993 and production_year>=1991 group by production_year;",2018-08-22 12:36:19.465557+10,2,1,99,correct
1451,select count(*) from person as p where not exists (select d.id from director as d where d.id = p.id);,2018-08-22 12:40:57.747548+10,12,1,99,correct
1452,"SELECT dm.title, dm.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE award_name = 'BAFTA Film Award'
      AND category = 'Best Film'
      AND result = 'won') AS dm, person AS p, director AS d
WHERE dm.title = d.title
AND dm.production_year = d.production_year
AND d.id = p.id;",2018-08-22 12:45:22.195182+10,8,0,169,partially correct
1453,"SELECT dm.title, dm.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE award_name = ""BAFTA Film Award""
      AND category = ""Best Film""
      AND result = ""won"") AS dm, person AS p, director AS d
WHERE dm.title = d.title
AND dm.production_year = d.production_year
AND d.id = p.id;",2018-08-22 12:46:20.341583+10,8,0,169,partially correct
1454,"SELECT dm.title, dm.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE award_name = ""BAFTA Film Award""
      AND category = ""Best Film""
      AND result = ""won"") AS dm, person AS p, director AS d
WHERE dm.title = d.title
AND dm.production_year = d.production_year
AND d.id = p.id;",2018-08-22 12:46:26.466807+10,8,0,169,partially correct
1455,"SELECT dm.title, dm.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM movie_award
      WHERE lower(award_name) = ""bafta film award""
      AND lower(category) = ""best film""
      AND lower(result) = ""won"") AS dm, person AS p, director AS d
WHERE dm.title = d.title
AND dm.production_year = d.production_year
AND d.id = p.id;",2018-08-22 12:49:28.961467+10,8,1,169,correct
1456,"SELECT country
FROM Restriction
WHERE title='Shakespeare in Love' AND description='M';",2018-08-22 12:49:36.295462+10,6,1,228,correct
1457,"select p.id, p.first_name, p.last_name from person as p where exists (select d.id from director as d, writer as w where p.id = d.id and d.id = w.id and d.title = w.title and d.production_year = w.production_year group by d.id having count(d.id) >1);",2018-08-22 12:55:03.709582+10,4,1,99,correct
1459,"SELECT COUNT(*)
FROM writer_award AS w LEFT JOIN person AS p ON w.id = p.id
WHERE lower(p.first_name) = 'woody' 
      AND lower(p.last_name) = 'allen'
      AND w.year_of_award >= 1991
      AND w.year_of_award <= 1995;",2018-08-22 12:57:24.241425+10,9,0,169,partially correct
1460,"select count(*) from
person 
where exists(select * from writer where writer.id= person.id and person.year_born=1935);
",2018-08-22 12:57:37.245952+10,1,1,248,correct
1461,"SELECT id,first_name,last_name
FROM person
GROUP BY id
HAVING MIN(year_born);",2018-08-22 12:58:06.890405+10,7,0,228,partially correct
1462,"SELECT id,first_name,last_name
FROM person P
WHERE p.year_born=(SELECT MAX(year_born) FROM person);",2018-08-22 13:01:14.817429+10,7,1,228,correct
1463,"Select count(*) from Writer_Award,Writer,Person
where Writer_Award.year_of_award between 1991 and 1995
and Person.first_name='Woody'and Person.last_name='Allen'
and Writer.id=Person.id;",2018-08-22 13:02:02.415859+10,9,0,238,partially correct
1464,"select production_year, count(*)
from movie where production_year=1993 or production_year=1992 or production_year=1991
group by production_year
;",2018-08-22 13:02:03.546832+10,2,1,248,correct
1465,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-22 13:03:08.338241+10,9,1,238,correct
1466,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-22 13:04:53.223388+10,1,1,238,correct
1467,"select count(*)
from person
where exists(select * from director
where not director.id =person.id);",2018-08-22 13:05:36.787498+10,12,0,248,partially correct
1468,"select count(*)
from person
where not exists(select * from director
where  director.id =person.id);",2018-08-22 13:06:42.282418+10,12,1,248,correct
1469,"Select count(*) From writer w, person p WHERE w.id=p.id AND p.year_born = 1935;",2018-08-22 13:10:31.264204+10,1,0,208,partially correct
1470,SELECT DISTINCT count(*) from director;,2018-08-22 13:15:41.24409+10,12,0,208,partially correct
1471,j;,2018-08-22 13:18:36.517657+10,11,0,208,noninterpretable
1472,"select id,first_name,last_name from person p
where(select count(*) from director d 
where(select id from writer w
    where w.id=d.id and w.title=d.title));
",2018-08-22 13:20:16.765824+10,4,0,248,partially correct
1473,s;,2018-08-22 13:24:58.066085+10,13,0,208,noninterpretable
1474,"select w.title, w.production_year from writer as w, person as p where p.id = w.id and p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-22 13:26:11.35627+10,5,1,99,correct
1475,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-22 13:26:26.628996+10,4,1,248,correct
1476,"select title, production_year from movie
where(select title,first_name,last_name from director natural join person as dp
where dp.title=movie.title and dp.first_name=Kevin and last_name= Williamson);",2018-08-22 13:32:21.031011+10,5,0,248,noninterpretable
1477,"SELECT person.id,first_name,last_name
FROM person NATURAL JOIN writer
WHERE person.id=writer.id AND EXISTS (SELECT id FROM writer WHERE writer.production_year=director.production_year GROUP BY id HAVING COUNT(production_year)>2); ",2018-08-22 13:36:26.873187+10,4,0,216,noninterpretable
1478,"select count(*)
from person p
where exists (select *
                from writer w
                where p.id=w.id

     AND p.year_born=1935);

",2018-08-22 13:38:25.732946+10,1,1,79,correct
1479,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-22 13:40:21.701382+10,6,1,99,correct
1480,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id HAVING COUNT(*)>1;",2018-08-22 13:40:34.565656+10,4,1,216,correct
1481,"select m.production_year, count(*)
from movie m
where m.production_year>1990
AND m.production_year<1994

group by m.production_year;",2018-08-22 13:41:39.8877+10,2,1,79,correct
1482,"select country from restriction r
where r.title='Shakespeare in Love' and r.description='M';",2018-08-22 13:41:50.489098+10,6,1,248,correct
1483,"select min(year_born),id, first_name,last_name from person;",2018-08-22 13:43:30.136427+10,7,0,248,partially correct
1484,"select id, first_name,last_name from person
where person.year_born=(select min(year_born) from person);",2018-08-22 13:44:36.572015+10,7,0,248,partially correct
1485,"select count(*)
from person p
where not exists (select *
                    from  director d
                   where p.id=d.id);",2018-08-22 13:44:57.679609+10,12,1,79,correct
1486,"select id, first_name,last_name from person
where person.year_born=(select max(year_born) from person);",2018-08-22 13:45:12.199381+10,7,1,248,correct
1487,"SELECT title,production_year,first_name,last_name
FROM person p, director d
WHERE p.id=d.id AND d.title=(SELECT title FROM movie_award m,WHERE award_name='BAFTA Film Award' AND category='Best Film';",2018-08-22 13:49:35.492221+10,8,0,228,noninterpretable
1488,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id;
",2018-08-22 13:51:26.989627+10,4,0,79,partially correct
1489,select max(year_born) from person;,2018-08-22 13:51:32.975385+10,7,0,99,partially correct
1490,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id 
group by p.id
having count(*)>1;",2018-08-22 13:52:28.356948+10,4,1,79,correct
1491,"select title, production_year,first_name,last_name
from movie_award natural join person natural join director as ss
where movie_award.award_name='BAFTA Film Award' and movie_award.category='Best Film';
",2018-08-22 13:52:35.813943+10,8,0,248,partially correct
1492,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id 
group by p.first_name
having count(*)>1;",2018-08-22 13:53:18.898423+10,4,0,79,partially correct
1493,"select title, production_year,first_name,last_name
from movie_award natural join person natural join director as ss
where lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won';
",2018-08-22 13:53:32.694797+10,8,1,248,correct
1494,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-22 13:53:46.976882+10,7,1,99,correct
1495,"select count(*) from writer_award wa
where wa.id= (select id from person p 
where p.first_name='Woody' and p.last_name='Allen');",2018-08-22 13:56:33.109864+10,9,0,248,partially correct
1496,"select count(*) from writer_award wa
where wa.id= (select id from person p 
where p.first_name='Woody' and p.last_name='Allen')
and wa.year_of_award>= 1991
and wa.year_of_award<= 1995;",2018-08-22 13:57:47.64724+10,9,0,248,partially correct
1497,"select count(*) from writer_award wa
where wa.id= (select id from person p 
where p.first_name='Woody' and p.last_name='Allen')
and wa.year_of_award>= 1991
and wa.year_of_award<= 1995
and result='won';",2018-08-22 13:58:33.339481+10,9,1,248,correct
1498,"select m.title, m.production_year
from movie m, writer w,person p
where m.title=w.title
AND m.production_year=w.production_year 
AND w.id=p.id
AND lower(p.first_name)='kevin'
AND lower(p.last_name)='williamson';

",2018-08-22 14:00:10.412095+10,5,1,79,correct
1499,;,2018-08-22 14:00:16.374826+10,10,0,248,noninterpretable
1500,"select r.id from role r, scene s natural join appearance a as sa
where lower(s.title) = 'Psycho' and s.production_year= 1960;

",2018-08-22 14:13:22.57004+10,10,0,248,noninterpretable
1501,Select count(id) from Person where Person.id=Writer.id And Person.year_born=1935;,2018-08-22 14:16:20.949623+10,1,0,31,noninterpretable
1502,"select year_born,person.id,writer.id 
from person,writer
where person.id=writer.id and year_born='1935';",2018-08-22 14:19:35.003668+10,1,0,125,partially correct
1503,"SELECT COUNT(*)
FROM writer_award w
WHERE w.id=(SELECT id FROM person where first_name=Woody AND last_name=Allen)
AND year_of_award=1991
AND year_of_award=1992
AND year_of_award=1993
AND year_of_award=1994
AND year_of_award=1995;",2018-08-22 14:20:43.853116+10,9,0,228,noninterpretable
1554,"SELECT distinct id, first_name, last_name FROM (person natural join director natural join writer) group by director.id having count(*)>1;",2018-08-22 15:39:35.647708+10,4,1,227,correct
1504,"SELECT COUNT(*)
FROM writer_award w
WHERE w.id=(SELECT id FROM person where first_name='Woody' AND last_name=Allen')
AND w.year_of_award >= 1991
AND w.year_of_award <= 1995
AND w.result = 'won';",2018-08-22 14:28:11.154808+10,9,0,228,noninterpretable
1505,"SELECT COUNT(*)
FROM writer_award w
WHERE w.id=(SELECT id FROM person where first_name='Woody' AND last_name='Allen')
AND w.year_of_award>='1991'
AND w.year_of_award<='1995'
AND w.result='won';",2018-08-22 14:29:49.626583+10,9,1,228,correct
1506,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id and year_born=1935);",2018-08-22 14:30:02.645933+10,1,1,125,correct
1507,"select r.id from role r, scene s, appearance a 
where lower(s.title) = 'psycho' and s.production_year= 1960
and r.title=s.title and s.title=a.title
and a.production_year=s.production_year and s.production_year=r.production_year
and s.scene_no=a.scene_no
and a.description=r.description
group by r.id
having count(*)=1;
",2018-08-22 14:34:09.412326+10,10,1,248,correct
1508,select count(*) from movie;,2018-08-22 14:35:19.378376+10,11,0,248,partially correct
1509,"select max(count) from (
select title, count(*)
from movie_award 
where result = 'won'
group by title) t; ",2018-08-22 14:38:57.068645+10,14,0,78,noninterpretable
1510,"select ma.title, ma.production_year, p.first_name, p.last_name 
from movie_award as ma, person as p, director as d 
where lower(ma.award_name) = 'bafta film award'
and lower(ma.category) ='best film' 
and lower (ma.result) = 'won'
and ma.title = d.title
and ma.production_year = d.production_year
and d.id = p.id;",2018-08-22 14:39:54.538441+10,8,1,99,correct
1511,"select production_year, count(*)
from movie m 
where m.production_year=1993 or  m.production_year=1992 or  m.production_year=1991;",2018-08-22 14:41:09.406872+10,2,0,125,partially correct
1512,"select id from person p
where p.year_born=max(year_born);",2018-08-22 14:42:04.478396+10,3,0,248,noninterpretable
1513,"select production_year, count(*)
from movie m 
where m.production_year=1993 or  m.production_year=1992 or  m.production_year=1991
group by production_year;",2018-08-22 14:44:24.970458+10,2,1,125,correct
1514,"select m.country
from movie m
where lower(m.title)= 'shakespeare in love'
AND lower(m.major_genre)='m';

",2018-08-22 14:45:11.195097+10,6,0,79,partially correct
1515,"select id from person
where year_born=(select max(year_born) from person where year_born<(select max(year_born) from person));",2018-08-22 14:46:06.110285+10,3,1,248,correct
1516,"select d.id, da.award_name, da.year_of_award, da.category
from director d,director_award da
where d.title=da.title and d.production_year=da.production_year and da.result='lose';",2018-08-22 14:49:08.80489+10,13,0,248,partially correct
1517,"select d.id, da.award_name, da.year_of_award, da.category
from director d,director_award da
where d.title=da.title and d.production_year=da.production_year and da.result='nominated';",2018-08-22 14:50:24.377919+10,13,1,248,correct
1518,"select count(*)
from person p
where not exists (select * from movie m,director d where p.id=d.id and m.title=d.title);",2018-08-22 14:53:05.239612+10,12,1,125,correct
1519,;,2018-08-22 14:56:40.928991+10,14,0,248,noninterpretable
1520,Select count(production_year) From movie Group by production_year where production_year=1993 or production_year=1992 or production_year=1991;,2018-08-22 15:00:52.072179+10,2,0,31,noninterpretable
1521,"Select production_year,count(production_year) From movie  where production_year=1993 or production_year=1992 or production_year=1991 Group by production_year;",2018-08-22 15:02:08.29719+10,2,1,31,correct
1522,"SELECT count(*) from PERSON
	WHERE year_born = '1935';",2018-08-22 15:06:22.193895+10,1,0,26,partially correct
1523,"select count(*) from writer_award  as wa, person as p 
where lower(p.first_name) = 'woody' 
and lower(p.last_name) ='allen'
and p.id = wa.id
and lower(wa.result) = 'won'
and wa.year_of_award >=1991
and wa.year_of_award<=1995;",2018-08-22 15:08:43.080068+10,9,1,99,correct
1524,SELECT COUNT(*) FROM WRITER WHERE WRITER.id=PERSON.id HAVING year_born='1935';,2018-08-22 15:10:29.513233+10,1,0,227,noninterpretable
1525,"  select count(w.id)
  from Writer w
  inner join Person p ON w.id = p.id
  where p.year_born = '1935';",2018-08-22 15:12:18.730696+10,1,0,254,partially correct
1526,"SELECT m.title, m.production_year
FROM movie m
INNER JOIN writer w ON m.title = w.title
INNER JOIN person p ON p.ID = w.id
WHERE first_name LIKE '%Kevin%' AND last_name LIKE '%Williamson%';
",2018-08-22 15:12:57.953751+10,5,1,144,correct
1527,"
select count(p.id)
FROM person p, writer w
WHERE p.id=w.id AND p.year_born = 1935;",2018-08-22 15:13:22.306878+10,1,0,49,partially correct
1528,"
select count(distinct p.id)
FROM person p, writer w
WHERE p.id=w.id AND p.year_born = 1935;",2018-08-22 15:13:34.774755+10,1,1,49,correct
1529,"SELECT count(*) from PERSON
	WHERE year_born = '1935' AND id IN (SELECT id from WRITER);",2018-08-22 15:15:08.41878+10,1,1,26,correct
1530,"SELECT count(*)
FROM MOVIE MWHERE NOT EXISTS(SELECT* FROM movie_award ma WHERE ma.title=m.title);",2018-08-22 15:16:30.233343+10,11,0,228,noninterpretable
1531,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS(SELECT* FROM movie_award ma WHERE ma.title=m.title);",2018-08-22 15:17:05.105632+10,11,0,228,partially correct
1532,"select count(*), m.production_year
from Movie m
where m.production_year = 1993 or m.production_year = 1992 or m.production_year = 1991;",2018-08-22 15:17:11.081011+10,2,0,254,partially correct
1533,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS(SELECT* FROM movie_award ma WHERE ma.title=m.title);",2018-08-22 15:18:23.992312+10,11,0,228,partially correct
1534,Select count(*) from person where not (select * from writer where writer.id = person.id);,2018-08-22 15:18:29.948862+10,12,0,31,noninterpretable
1535,"SELECT production_year, COUNT(*) FROM MOVIE
	WHERE production_year>=1991 AND production_year<=1993 GROUP BY production_year;",2018-08-22 15:19:41.293127+10,2,1,26,correct
1536,Select count(*) from person where not Exists (select * from director where director.id = person.id);,2018-08-22 15:20:41.416684+10,12,1,31,correct
1537,"SELECT r.country
FROM restriction r,
     movie m
WHERE r.title = m.title AND m.title = ""Shakespeare in Love"" AND r.description = ""M"";",2018-08-22 15:21:00.94176+10,6,1,144,correct
1538,"SELECT count (*) From movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year;

",2018-08-22 15:22:10.719878+10,2,0,227,partially correct
1539,"SELECT production_year, count (*) From movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year;

",2018-08-22 15:23:39.418585+10,2,1,227,correct
1540,"select count(*)
from person p
where not exists (select * from director d where p.id = d.id);",2018-08-22 15:24:16.440617+10,12,1,254,correct
1541,"SELECT * 

FROM WRITER;
",2018-08-22 15:25:10.281634+10,1,0,115,partially correct
1542,SELECT COUNT(*) FROM PERSON LEFT JOIN DIRECTOR WHERE PERSON.id= DIRECTOR.id;,2018-08-22 15:26:03.134471+10,12,0,227,partially correct
1543,"SELECT id, first_name, last_name
FROM person
GROUP BY year_born
ORDER BY year_born DESC
LIMIT 1;",2018-08-22 15:29:04.209041+10,7,1,144,correct
1544,SELECT COUNT(*) FROM person  where not exists (select * from director  where person.id= director.id);,2018-08-22 15:30:04.097973+10,12,1,227,correct
1545,"select count(id),first_name, last_name from person; ",2018-08-22 15:31:33.15743+10,4,0,31,partially correct
1546,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT id FROM director d WHERE p.id=d.id);",2018-08-22 15:32:48.404121+10,12,1,49,correct
1547,"SELECT count(*)
FROM (
SELECT DISTINCT title, production_year
FROM movie
WHERE production_year IN (1993, 1992, 1991)
GROUP BY title, production_year);",2018-08-22 15:33:50.154797+10,2,0,27,partially correct
1548,"SELECT COUNT(*) FROM PERSON
	WHERE id NOT IN (SELECT id FROM DIRECTOR);",2018-08-22 15:34:42.173151+10,12,1,26,correct
1549,"
SELECT production_year, count(*)
FROM movie
WHERE production_year IN (1993, 1992, 1991)
GROUP BY production_year;",2018-08-22 15:34:49.041942+10,2,1,27,correct
1550,"SELECT mw.title, mw.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS mw
WHERE first_name=""Kevin"" AND last_name=""Willianson"";",2018-08-22 15:35:26.124566+10,5,0,216,partially correct
1551,"SELECT id, first_name, last_name FROM person where exists ( select count(*) from writer left join director on director.id= writer.id); ",2018-08-22 15:35:29.813175+10,4,0,227,partially correct
1552,"SELECT count(*)
FROM(
	SELECT DISTINCT id
	FROM director);",2018-08-22 15:36:06.110217+10,12,0,27,partially correct
1553,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma
INNER JOIN director d ON ma.title = d.title
INNER JOIN person p ON p.id = d.id
WHERE lower(award_name) = 'bafta' AND
      lower(category) = 'best film';",2018-08-22 15:39:03.487771+10,8,0,144,partially correct
1555,"WITH directors AS
(SELECT id
FROM director)

SELECT COUNT(*)
FROM person
WHERE id NOT IN directors;",2018-08-22 15:41:02.424009+10,12,1,27,correct
1556,"SELECT p.id,p.last_name,p.first_name 
FROM person p 
WHERE (SELECT id FROM director d, writer w 
WHERE (SELECT count(*) FROM director d WHERE count(*)>1) AND d.id=w.id);",2018-08-22 15:41:36.453814+10,4,0,49,noninterpretable
1557,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-22 15:43:17.142356+10,8,1,144,correct
1558,"select title,production_year from movie ;",2018-08-22 15:43:20.003175+10,5,0,31,partially correct
1559,"SELECT writer.title, writer.production_year
FROM writer, person
WHERE writer.id=person.id AND lower(first_name)='kevin' AND lower(last_name)='williamson';",2018-08-22 15:43:54.527642+10,5,1,216,correct
1560,"SELECT id, first_name, last_name
FROM movie NATURAL JOIN director NATURAL JOIN writer NATURAL JOIN PERSON
GROUP BY id
HAVING count(*) > 1;",2018-08-22 15:46:03.236286+10,4,1,27,correct
1561,"SELECT count(*)
From person, writer
WHERE writer.id = person.id AND person.year_born = 1935;",2018-08-22 15:46:04.063773+10,1,0,59,partially correct
1562, select * from person where first_name= Kevin and last_name= Williamson group by first_name;,2018-08-22 15:47:52.987619+10,5,0,227,noninterpretable
1563,"SELECT w.title, w.production_year
FROM writer w NATURAL JOIN person p
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-22 15:48:41.824355+10,5,1,27,correct
1564,"SELECT w.title, w.production_year
FROM writer w NATURAL JOIN person p
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-22 15:48:44.233617+10,5,1,27,correct
1565,"SELECT count(lower(result) = 'won') AS award_count
FROM writer_award wa
INNER JOIN person p ON wa.id = p.id
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND
      year_of_award BETWEEN '1991' AND '1995';",2018-08-22 15:49:23.489585+10,9,0,144,partially correct
1566,"SELECT country
FROM restriction
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-22 15:51:33.407026+10,6,1,27,correct
1567,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT max(year_born) FROM person);",2018-08-22 15:54:09.314239+10,7,1,27,correct
1568,"select production_year, count(*)
from movie
WHERE PRODUCTION_YEAR=1991 OR PRODUCTION_YEAR=1992 OR PRODUCTION_YEAR=1993
group by production_year;",2018-08-22 15:54:20.810403+10,2,1,181,correct
1569,select count(distinct 1935)from writer;,2018-08-22 15:54:50.129595+10,1,0,181,cheating
1570,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-22 15:55:25.343745+10,9,1,144,correct
1571,"SELECT country
FROM restriction
WHERE title='Shakespeare in Love' AND description='M';",2018-08-22 15:56:41.274926+10,6,1,216,correct
1572,"SELECT m.production_year,count(*)
FROM movie m
GROUP BY m.production_year
HAVING  m.production_year= 1993 or  m.production_year= 1992 or  m.production_year=1991;",2018-08-22 15:58:17.951253+10,2,1,59,correct
1573,"WITH bafta_winners AS 
(SELECT id, title, production_year
FROM movie_award NATURAL JOIN director
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND lower(result) = 'won')

SELECT title, production_year, first_name, last_name
FROM bafta_winners NATURAL JOIN person;",2018-08-22 15:59:49.393402+10,8,1,27,correct
1574,"select d1.id, p.first_name, p.last_name
from director d1, director d2, person p
where exists (select * from writer w where d1.id = w.id) and d1.title = d2.title and d1.id = p.id;",2018-08-22 16:00:27.177215+10,4,0,254,partially correct
1575," select title, production_year from writer, person where writer.id=person.id and first_name= 'Kevin' and last_name= 'Williamson';",2018-08-22 16:00:55.837216+10,5,1,227,correct
1576,"SELECT p.id,p.first_name,p.last_name
FROM person p
GROUP BY p.id HAVING MIN(year_born);",2018-08-22 16:01:04.069733+10,7,0,216,partially correct
1577,"SELECT p.id,p.first_name,p.last_name
FROM person p
GROUP BY p.id HAVING MAX(year_born);",2018-08-22 16:02:00.585658+10,7,0,216,partially correct
1578,"SELECT r.id
FROM scene s
INNER JOIN ROLE r ON s.title = r.title
WHERE lower(s.title) = 'psycho' AND scene_no = 1;",2018-08-22 16:02:41.755722+10,10,0,144,partially correct
1579,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) FROM person);",2018-08-22 16:03:29.860166+10,7,1,216,correct
1580,"WITH woody_awards AS 
(SELECT *
FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND year_of_award >=1991 AND year_of_award <= 1995 AND lower(result) = 'won')

SELECT * 
FROM woody_awards;",2018-08-22 16:04:51.939977+10,9,0,27,partially correct
1581,"WITH woody_awards AS 
(SELECT *
FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND year_of_award >=1991 AND year_of_award <= 1995 AND lower(result) = 'won')

SELECT COUNT(*) 
FROM woody_awards;",2018-08-22 16:05:17.349939+10,9,1,27,correct
1582,"select pdw.id, pdw.first_name, pdw.last_name
from (person p natural join director d natural join writer w) pdw
group by pdw.id
having count(*) > 1;",2018-08-22 16:05:24.149607+10,4,1,254,correct
1583,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-22 16:05:24.645604+10,10,1,144,correct
1584,"SELECT id
FROM scene NATURAL JOIN role NATURAL JOIN person
GROUP BY id
HAVING count(*) = 1;",2018-08-22 16:07:59.371604+10,10,0,27,partially correct
1585,"select mwp.title, mwp.production_year
from (movie m natural join writer w natural join person p) mwp
where mwp.first_name = 'Kevin' and mwp.last_name = 'Williamson';
",2018-08-22 16:10:38.424755+10,5,1,254,correct
1586,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-22 16:13:50.913738+10,6,1,254,correct
1587,"SELECT DISTINCT PERSON.id, first_name, last_name FROM PERSON inner join Writer w ON PERSON.id =w.id
	WHERE PERSON.id IN (SELECT id FROM DIRECTOR d WHERE w.id = d.id GROUP BY d.id HAVING COUNT(*)>1);",2018-08-22 16:16:00.279845+10,4,0,26,partially correct
1588,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-22 16:17:33.574478+10,7,1,254,correct
1589,"SELECT COUNT(*)
FROM Writer_Award INNER JOIN Person
ON Writer_Award.id = Person.id
WHERE Person.first_name = 'Woody' AND Person.last_name = 'Allen' 
      AND Writer_Award.year_of_award > 1990 AND Writer_Award.year_of_award < 1996;",2018-08-22 16:22:36.828648+10,9,0,214,partially correct
1590,"SELECT DISTINCT restriction.country 
From restriction, movie, (SELECT title AS movie_name
                   FROM movie
		       WHERE movie.title='Shakespeare in Love') AS movie_name
WHERE restriction.title=movie.title
AND restriction.description='M';",2018-08-22 16:24:36.17293+10,6,0,227,partially correct
1591,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-22 16:26:28.126255+10,6,1,227,correct
1592,"select madp.title, madp.production_year, madp.first_name, madp.last_name
from (movie_award ma natural join director d natural join person p) madp
where madp.award_name = 'BAFTA Film Award' and madp.category = 'best film' and madp.result = 'won'
;",2018-08-22 16:30:13.463988+10,8,1,254,correct
1593,"SELECT id, first_name, last_name
FROM person;
",2018-08-22 16:33:29.100126+10,7,0,227,partially correct
1594,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-22 16:34:43.391262+10,7,1,227,correct
1595,"select count(*)
from (writer_award wa natural join person p) wap
where wap.year_of_award > 1990 and wap.year_of_award < 1996 and wap.first_name = 'Woody' and wap.last_name = 'Allen';",2018-08-22 16:35:52.464447+10,9,0,254,partially correct
1596,"SELECT COUNT(*) AS number_of_awards
FROM Writer_Award INNER JOIN Person
ON Writer_Award.id = Person.id
INNER JOIN Writer
ON Writer_Award.id = Writer.id AND Writer_Award.title = Writer.title AND Writer_Award.production_year = Writer.production_year
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' 
      AND Writer_Award.year_of_award >= 1991 AND Writer_Award.year_of_award <= 1995
	AND result = 'won';",2018-08-22 16:36:11.369317+10,9,1,214,correct
1597,"select count(*) as number_of_awards
from (writer_award wa natural join person p) wap
where wap.year_of_award >= 1991 and wap.year_of_award <= 1995 and lower(wap.result) = 'won' and wap.first_name = 'Woody' and wap.last_name = 'Allen';",2018-08-22 16:38:37.206465+10,9,1,254,correct
1598,"select ar.id
from (appearance a natural join role r) ar
where ar.scene_no = 1 and lower(ar.title) = 'psycho' and ar.production_year = 1960;",2018-08-22 16:43:32.292981+10,10,0,254,partially correct
1599,select * from role;,2018-08-22 16:44:11.728819+10,10,0,99,partially correct
1600,SELECT;,2018-08-22 16:50:40.349132+10,13,0,228,noninterpretable
1601,"select ar.id
from (appearance a natural join role r) ar
where ar.title = 'Psycho' and ar.production_year = 1960
group by ar.id
having count(*) = 1
;",2018-08-22 16:53:44.537646+10,10,1,254,correct
1602,"select distinct role.id from role,scene
where lower(scene.title)='psycho' AND scene_no=1 AND scene.production_year=1960 AND role.title=scene.title;",2018-08-22 16:54:38.274473+10,10,0,184,partially correct
1603,"SELECT Person.id, first_name, last_name
FROM Person INNER JOIN Role
ON Person.id = Role.id
INNER JOIN Scene
ON Role.title = Scene.title AND Role.production_year = Scene.production_year
INNER JOIN Appearance
ON Scene.title = Appearance.title AND Scene.production_year = Appearance.production_year
WHERE lower(Appearance.title) = 'psycho' AND Appearance.production_year = 1960 AND Appearance.scene_no = 1;",2018-08-22 16:55:07.378461+10,10,0,214,partially correct
1604,"SELECT title, production_year, first_name, last_name 
FROM DIRECTOR, PERSON, MOVIE, (SELECT title AS Atitle
                        FROM movie, movie_award
				WHERE movie.title=movie_award.title 
				AND movie_award.award_name='BAFTA Film Award'
				AND movie_award.category='Best Film') AS award_movie
WHERE director.id=person.id
AND director.title=award_movie.Atitle
AND movie.title=award_movie.Atitle;",2018-08-22 16:55:09.388167+10,8,0,227,noninterpretable
1605,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-22 16:58:24.268123+10,8,1,227,correct
1606,"select count(*)
from movie m
where not exists (select * from movie_award ma where ma.title = m.title and ma.production_year = m.production_year)
and not exists (select * from crew_award ca where ca.title = m.title and ca.production_year = m.production_year)
and not exists (select * from director_award da where da.title = m.title and da.production_year = m.production_year)
and not exists (select * from writer_award wa where wa.title = m.title and wa.production_year = m.production_year)
and not exists (select * from actor_award aa where aa.title = m.title and aa.production_year = m.production_year)
;",2018-08-22 16:59:01.577812+10,11,0,254,partially correct
1607,"select count(*)
from movie m
where not exists (select * from movie_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won')
and not exists (select * from crew_award ca where ca.title = m.title and ca.production_year = m.production_year and lower(ca.result) = 'won')
and not exists (select * from director_award da where da.title = m.title and da.production_year = m.production_year and lower(da.result) = 'won')
and not exists (select * from writer_award wa where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) = 'won')
and not exists (select * from actor_award aa where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) = 'won')
;",2018-08-22 17:00:31.333627+10,11,1,254,correct
1608,"SELECT count(*)
From WRITER_AWARD, PERSON
GROUP BY ID
HAVING year_of_award>=1991 AND year_of_award<=1995
WHERE person.id=writer_award.id
AND fisrt_name='Woody'
AND last_name='Allen';",2018-08-22 17:07:13.568905+10,9,0,227,noninterpretable
1609,"

select id

from person

where year_born = (select max(year_born) from person)
;",2018-08-22 17:08:43.464254+10,3,0,254,partially correct
1610,"SELECT
    COUNT(*) 
FROM
    writer_award wa,
    person p
WHERE
        wa.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-22 17:11:25.514208+10,9,1,227,correct
1611,"select a.id,a.first_name,a.last_name
from person a,Director b,Writer c 
where a.id=b.id and  a.id=c.id and  b.title=c.title and b.production_year=c.production_year
group by a.id 
having count(*)>=2;",2018-08-22 17:13:19.822102+10,4,1,205,correct
1612,"select dad.id, dad.award_name, dad.year_of_award, dad.category
from (director_award natural join director d) dad
where lower(dad.result) = 'nominated'
group by dad.id
having count(*) > 0
;",2018-08-22 17:15:09.333394+10,13,1,254,correct
1613,"SELECT count(*)
FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE ma.title = ca.title AND
      da.title = ma.title AND
      wa.title = ma.title AND
      aa.title = ma.title AND
      lower(ma.result) != 'won' AND
      lower(ca.result) != 'won' AND
      lower(da.result) != 'won' AND
      lower(wa.result) != 'won' AND
      lower(aa.result) != 'won';  
",2018-08-22 17:30:52.093611+10,11,0,144,partially correct
1614,"select b.title,b.production_year from person a, writer b,movie c where a.first_name=""Williamson"" 
and a.last_name=""Kevin""
and b.title=c.title and b.production_year=c.production_year and a.id=b.id
group by b.production_year;",2018-08-22 17:32:33.813732+10,5,0,205,partially correct
1615,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-22 17:34:01.463679+10,11,1,144,correct
1616,"select distinct(dwm.title)
from

(select d.id as did, w.id as wid, m.title, m.production_year
from director d, writer w, movie m
where d.title = m.title and d.production_year = m.production_year
and w.title = m.title and w.production_year = m.production_year) dwm;",2018-08-22 17:36:28.190396+10,14,0,254,partially correct
1651,"SELECT m.title, m.production_year 
FROM movie m, kw(SELECT p.id FROM person p WHERE p.first_name=Kevin, p.last_name=Williamson AS kw) 
WHERE w.id=kw.id and w.title=m.title;",2018-08-22 18:29:05.623476+10,5,0,86,noninterpretable
1617,"SELECT Person.id 
FROM Role INNER JOIN Person
  ON Person.id = Role.id
  INNER JOIN Scene
  ON Scene.title = Role.title AND Scene.production_year = Role.production_year
  INNER JOIN Appearance 
  ON Role.title = Appearance.title 
  AND Role.production_year = Appearance.production_year 
  AND Appearance.description = Role.description
  AND Scene.scene_no = Appearance.scene_no
WHERE lower(Role.title) = 'psycho' AND Role.production_year = 1960
GROUP BY Person.id
HAVING COUNT(*) = 1;",2018-08-22 17:39:14.613678+10,10,1,214,correct
1618,"SELECT COUNT(*)
FROM PERSON NATURAL JOIN WRITER
WHERE PERSON.year_born = '1935';
",2018-08-22 17:39:59.501511+10,1,0,195,partially correct
1619,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director r WHERE r.id = p.id);",2018-08-22 17:40:34.594418+10,12,1,228,correct
1620,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d
INNER JOIN director_award da ON d.title = da.title
WHERE (da.result) != 'Won';
      ",2018-08-22 17:40:56.408283+10,13,0,144,partially correct
1621,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d
INNER JOIN director_award da ON d.title = da.title
WHERE lower(da.result) != 'won';
      ",2018-08-22 17:41:18.858377+10,13,1,144,correct
1622,"SELCT id,first_name,last_name
FROM person p, director d, writer w
WHERE;",2018-08-22 17:44:30.176146+10,4,0,228,noninterpretable
1623,"SELECT COUNT(*)
FROM PERSON NATURAL JOIN WRITER
WHERE PERSON.year_born = '1935';
",2018-08-22 17:45:00.911579+10,1,0,195,partially correct
1624,"SELECT id
From role, person, appearance
GROUP BY appearance.title
HAVING COUNT(*)=1
WHERE role.id=person.id 
AND role.title=appearance.title
AND appearance.production_year=1960
AND appearance.title='Psycho';
",2018-08-22 17:47:15.405104+10,10,0,227,noninterpretable
1625,"SELECT production_year,COUNT(*) AS numberOfMovie
FROM movie 
where production_year=1993 and 1992 and 1991 
GROUP BY numberOfMovie;",2018-08-22 17:48:11.99204+10,2,0,86,noninterpretable
1626,"select b.title,b.production_year from person a, writer b,movie c where a.first_name=""Kevin"" 
and a.last_name=""Williamson""
and b.title=c.title and b.production_year=c.production_year and a.id=b.id;",2018-08-22 17:48:53.914951+10,5,1,205,correct
1627,"SELECT production_year,COUNT(*)
FROM movie 
where production_year>1990 and production_year<1994
GROUP BY production_year;",2018-08-22 17:49:48.457362+10,2,1,86,correct
1628,"SELECT production_year,count(*)
FROM movie WHERE production_year='1993'
UNION
SELECT production_year,count(*)
FROM movie WHERE production_year='1992'
UNION
SELECT production_year,count(*)
FROM movie WHERE production_year='1991';
",2018-08-22 17:50:53.829687+10,2,1,195,correct
1629,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-22 17:52:08.141649+10,14,1,254,correct
1630,"SELECT COUNT(*)
FROM;",2018-08-22 17:52:14.156296+10,11,0,214,noninterpretable
1631,"SELECT id
From role, appearance
WHERE role.title=appearance.title
AND appearance.production_year=1960
AND appearance.title='Psycho'
GROUP BY appearance.title 
HAVING COUNT(*)=1;",2018-08-22 17:52:56.365488+10,10,0,227,partially correct
1632,"SELECT id
From role, appearance
WHERE role.title=appearance.title
AND appearance.production_year=1960
AND appearance.title='Psycho'
GROUP BY appearance.title 
HAVING COUNT(*)=1;",2018-08-22 17:53:07.576947+10,10,0,227,partially correct
1633,"SELECT id
From role, appearance
WHERE role.title=appearance.title
AND appearance.production_year=1960
AND appearance.title='Psycho'
GROUP BY appearance.title 
HAVING COUNT(*)=1;",2018-08-22 17:53:11.462145+10,10,0,227,partially correct
1634,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-22 17:53:37.254629+10,10,1,227,correct
1635,"SELECT p.first_name, p.last_name, r.(*)
FROM person p
INNER JOIN roles r ON p.id = r.id
WHERE MAX(count(title));",2018-08-22 17:54:00.221668+10,15,0,144,noninterpretable
1636,SELECT COUNT(*)FROM PERSON where NOT EXISTS (SELECT*FROM director WHERE person.id=director.id);,2018-08-22 17:56:17.919827+10,12,1,86,correct
1637,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-22 17:57:26.02442+10,15,1,144,correct
1638,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id=d.id);",2018-08-22 17:58:12.142903+10,12,1,195,correct
1639,"SELECT id,first_name,last_name
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w)
GROUP BY id
HAVING count(*)>1;",2018-08-22 17:59:57.530552+10,4,1,228,correct
1640,"SELECT COUNT(*) AS number_of_non_awarded_movies
FROM movie a, movie_award b, crew_award c, director_award d, writer_award e, actor_award f
WHERE a.title=b.title=c.title=d.title=e.title=f.title 
AND b.result!='yes'
AND c.result!='yes'
AND d.result!='yes'
AND e.result!='yes'
AND f.result!='yes';",2018-08-22 18:03:02.298034+10,11,0,227,partially correct
1641,"SELECT id,first_name, last_name
from (SELECT person.*,count();",2018-08-22 18:03:11.494619+10,4,0,195,noninterpretable
1642,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN Writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-22 18:05:17.584237+10,4,1,195,correct
1643,"select x.first_name, x.last_name, x.title, x.production_year, x.description
from 
(select *, count(*) as number_of_movies
from (role natural join person) rp
group by id) x

where x.number_of_movies = 
(select max(x.number_of_movies)
from
(select id, count(*) as number_of_movies
from role
group by id) x)
;",2018-08-22 18:07:48.491242+10,15,0,254,partially correct
1644,"SELECT id, first_name, last_name 
FROM person p, director d, writer w
WHERE EXISTS p.id=d.id=w.id and (SELECT COUNT(*)FROM movie m WHERE m.title=d.title and COUNT(*)>=2);  ",2018-08-22 18:08:04.957875+10,4,0,86,noninterpretable
1645,"SELECT title, production_year 
FROM movie m, writer w
WHERE m.title=w.title 
AND m.production_year=w.production_year;",2018-08-22 18:16:12.015629+10,5,0,195,noninterpretable
1646,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;  ",2018-08-22 18:16:58.73773+10,4,1,86,correct
1647,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND first_name= 'Kevin'
    AND last_name= 'Williamson';",2018-08-22 18:17:43.770378+10,5,1,195,correct
1648,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from
person p,
role r,
(select *, count(*) as number_of_movies
from role
group by id) x

where 
r.id = p.id and
p.id = x.id and
x.number_of_movies = 
(select max(x1.number_of_movies)
from
(select id, count(*) as number_of_movies
from role
group by id) x1);



",2018-08-22 18:21:46.439628+10,15,1,254,correct
1649,"SELECT COUNT(*) AS 'number of writer born in 1935' FROM (SELECT writer.id, year_born 
       FROM writer, person 
       WHERE writer.id=person.id 
	   AND year_born='1935');",2018-08-22 18:26:35.514064+10,1,0,82,partially correct
1650,"SELECT COUNT(*) AS 'number of writer born in 1935' FROM (SELECT distinct writer.id, year_born 
       FROM writer, person 
       WHERE writer.id=person.id 
	   AND year_born='1935');",2018-08-22 18:28:48.819257+10,1,1,82,correct
1652,"SELECT COUNT(*) AS 'number of writer born in 1935' FROM (SELECT distinct writer.id, year_born 
       FROM writer, person 
       WHERE writer.id=person.id 
	   AND year_born='1935');",2018-08-22 18:29:16.031408+10,1,1,82,correct
1653,"SELECT title,production_year
FROM movie m, (SELECT title FROM movie_award ma WHERE result='won' AND award_name='BAFTA Film Award' AND category='Best Film') ms
WHERE ms.title=m.title;",2018-08-22 18:31:27.888583+10,8,0,228,noninterpretable
1654,"select a.country from Restriction a, movie b where b.title=""Shakespeare in Love as M?"" and a.title=b.title 
and a.production_year=b.production_year;",2018-08-22 18:42:34.801773+10,6,0,205,partially correct
1655,Select idcount(*)  form PersonWriter where production_year=1935;,2018-08-22 18:47:48.91402+10,1,0,239,noninterpretable
1656,"SELECT count(*) 
FROM person p
where exists(select * from writer w where w.id=p.id and p.year_born=1935);",2018-08-22 18:50:27.101957+10,1,1,239,correct
1657,"select a.country from Restriction a where a.title=""Shakespeare in Love"" and a.description=""M"";",2018-08-22 18:50:35.191084+10,6,1,205,correct
1658,"SELECT COUNT(*)
FROM Movie m
WHERE NOT EXISTS (
     SELECT title, production_year
	FROM Movie_Award MA
	WHERE lower(MA.result='won') AND MA.title=m.title AND MA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Crew_Award CA
	WHERE lower(CA.result='won') AND CA.title=m.title AND CA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Director_Award DA
	WHERE lower(DA.result)='won' AND DA.title=m.title AND DA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Actor_Award AA
	WHERE lower(AA.result)='won' AND AA.title=m.title AND AA.production_year=m.producton_year
	UNION
	SELECT title, production_year
	FROM Writer_Award WA
	WHERE lower(WA.result='won') AND WA.title=m.title AND WA.production_year=m.production_year
);",2018-08-22 18:51:15.933564+10,11,0,214,noninterpretable
1659,"SELECT production_year, COUNT(*) From 
             (SELECT title, production_year FROM movie 
              GROUP BY production_year 
			   HAVING production_year='1993' ,
			    peoduction_year='1992' ,
			    production_year='1991') as f;  ",2018-08-22 18:52:01.501677+10,2,0,82,noninterpretable
1660,"SELECT COUNT(*)
FROM Movie m
WHERE NOT EXISTS (
     SELECT title, production_year
	FROM Movie_Award MA
	WHERE lower(MA.result='won') AND MA.title=m.title AND MA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Crew_Award CA
	WHERE lower(CA.result='won') AND CA.title=m.title AND CA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Director_Award DA
	WHERE lower(DA.result)='won' AND DA.title=m.title AND DA.production_year=m.production_year
	UNION
	SELECT title, production_year
	FROM Actor_Award AA
	WHERE lower(AA.result)='won' AND AA.title=m.title AND AA.production_year=m.producton_year
	UNION
	SELECT title, production_year
	FROM Writer_Award WA
	WHERE lower(WA.result='won') AND WA.title=m.title AND WA.production_year=m.production_year);",2018-08-22 18:54:15.007027+10,11,0,214,noninterpretable
1661,"select count(*) 
from Movie
where exists(select * from moive group by production_year where production_year=1993 or production_year=1992 or production_year=1991);",2018-08-22 18:57:23.403825+10,2,0,239,noninterpretable
1662,"SELECT*
FROM;",2018-08-22 18:58:58.951514+10,3,0,214,noninterpretable
1663,"SELECT production_year, COUNT(*) 
                  From movie
			 WHERE production_year>1990 and production_year<1994
			 GROUP BY production_year;",2018-08-22 19:00:28.930742+10,2,1,82,correct
1664,"select production_year,count(*) 
from Movie
where  production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-22 19:00:54.757023+10,2,1,239,correct
1665,"select count(*) from person p, writer w where p.id = w.id and p.year_born=1935;",2018-08-22 19:07:23.243265+10,1,0,66,partially correct
1666,"select count(*)
from person p
where not exists(select * from Director d where d.id=p.id);",2018-08-22 19:07:48.569874+10,12,1,239,correct
1667,"SELECT DISTINCT id
FROM (SELECT title FROM appearance WHERE scene_no=1 AND title='Psycho') xx,Role r
WHERE xx.title=r.title;",2018-08-22 19:09:10.245555+10,10,0,228,partially correct
1668,"SELECT Person.id
FROM Person
WHERE Person.year_born = (SELECT MAX(year_born) 
                          FROM Person
				    WHERE year_born < (SELECT MAX(year_born) FROM Person));",2018-08-22 19:09:41.373298+10,3,1,214,correct
1669,"select production_year, count(title) from movie group by production_year having production_year = 1993 or production_year = 1992 or production_year = 1991;",2018-08-22 19:13:54.533178+10,2,1,66,correct
1670,"select id,first_name,last_name
from person  
where (select count(*) from  Writer w,Director d where w.id=d.id)>1;",2018-08-22 19:14:52.332272+10,4,0,239,partially correct
1671,"SELECT COUNT(*) as 'the number of people have never directed any movies'
                FROM (SELECT  person.id from person WHERE person.id not in 
				(SELECT director.id from director));",2018-08-22 19:22:54.017405+10,12,1,82,correct
1672,"select Distinct p.id, p.first_name, p.last_name
from (select d.id from director d group by d.id having count(d.title) >= 2) as x1, director d, person p 
where x1.id = p.id and p.id = d.id;",2018-08-22 19:29:22.867359+10,4,0,66,partially correct
1673,"select a.id,a.first_name,a.last_name
from(person p NATURAL JOIN Director NATURAL JOIN Writer)as a
group by a.id
having count(*)>1;
",2018-08-22 19:32:34.184727+10,4,1,239,correct
1674,"SELECT COUNT(*)
FROM PERSON, WRITER
WHERE PERSON.id = WRITER.id;",2018-08-22 19:33:38.808387+10,1,0,259,partially correct
1675,"select title, production_year
from Movie
where moive.title=writer.title;",2018-08-22 19:39:59.123079+10,5,0,239,noninterpretable
1676,"select m.title, m.production_year from movie m, writer w, person p
where m.title=w.title
and m.production_year=w.production_year
and p.id=w.id
and p.last_name = 'Williamson'
and p.first_name = 'Kevin';",2018-08-22 19:41:14.721989+10,5,1,66,correct
1677,"select title,production_year
from writer,person
where writer.id=person.id
and person.first_name=""Kevin""
and person.last_name=""Williamson"";",2018-08-22 19:45:14.562423+10,5,1,239,correct
1678,"SELECT COUNT(*)
FROM PERSON
WHERE EXISTS (SELECT * FROM WRITER WHERE PERSON.id = WRITER.id AND PERSON.year_born = 1935);",2018-08-22 19:47:41.53056+10,1,1,259,correct
1679,"select country
from Restriction
where ;",2018-08-22 19:51:02.010222+10,6,0,239,noninterpretable
1680,"select country
from Restriction
where title=""Shakespeare in Love""
and description=""M"";",2018-08-22 19:51:56.737084+10,6,1,239,correct
1681,Select count(*) from (person natural join writer_award ) as da where (year_of_award between 1990 and 1996 and first_name = 'Woody' and last_name = 'Allen' and result = 'won')  group by da.id  ;,2018-08-22 19:56:33.47478+10,9,1,172,correct
1682,"select id,first_name,last_name
from person,
where exists (select * from person where max(year_born);
",2018-08-22 19:57:11.416901+10,7,0,239,noninterpretable
1683,"select id,first_name,last_name
from person p
where p.year_born=(select max(year_born) from person);
",2018-08-22 19:59:12.06402+10,7,1,239,correct
1684,"SELECT COUNT(*)
FROM MOVIE m
WHERE m.production_year = 1993, 1992, 1991;
",2018-08-22 20:02:01.705072+10,2,0,259,noninterpretable
1685,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;
",2018-08-22 20:05:43.513122+10,2,1,259,correct
1686,I DONT KNOW;,2018-08-22 20:06:23.591819+10,14,0,228,noninterpretable
1687,"select title,first_name,last_name
from Movie m,Director d,Writer_Award w,PERSON p
where Writer_Award.award_name=""BAFTA Film Award"" 
and Writer_Award.category=""Best Film""
and m.title=d.title and d.title=w.title and p.id=d.id;",2018-08-22 20:11:40.141258+10,8,0,239,noninterpretable
1688,Select id from ((appearance natural join role) natural join person) as r where r.title = 'Psycho' and production_year = 1960 and scene_no = 1  ;,2018-08-22 20:11:40.79831+10,10,0,172,partially correct
1689,"SELECT person.first_name, person.last_name, person.id from
  (SELECT h.id, COUNT(*) FROM
    (SELECT * FROM director e inner join writer f ON e.id=f.id and e.title=f.title) AS h
     GROUP BY h.id 
     Having COUNT(*)>1) AS m, person
     WHERE person.id=m.id;",2018-08-22 20:13:34.566972+10,4,1,82,correct
1723,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma 
	natural join
	person p
	natural join
	director
where lower(ma.award_name) = ""bafta film award"" and
	lower(ma.category) = ""best film"" and
	lower(ma.result) = ""won"";",2018-08-22 22:32:58.992941+10,8,1,43,correct
1690,"SELECT person.id, person.first_name, person.last_name from
  (SELECT h.id, COUNT(*) FROM
    (SELECT * FROM director e inner join writer f ON e.id=f.id and e.title=f.title) AS h
     GROUP BY h.id 
     Having COUNT(*)>1) AS m, person
     WHERE person.id=m.id;",2018-08-22 20:16:47.367422+10,4,1,82,correct
1691,"SELECT DIRECTOR.id, COUNT(*)
FROM DIRECTOR
WHERE NOT(SELECT PERSON.id
FROM PERSON
WHERE DIRECTOR.id = PERSON.id);

                       ",2018-08-22 20:18:35.4758+10,12,0,259,partially correct
1692,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS (SELECT *
                 FROM DIRECTOR
                 WHERE PERSON.id = DIRECTOR.id);
                       ",2018-08-22 20:22:42.140437+10,12,1,259,correct
1693,Select id from (appearance natural join role) as r where r.title = 'Psycho' and production_year = 1960 group by r.id having count(*) = 1 ;,2018-08-22 20:23:42.288445+10,10,1,172,correct
1694,"SELECT first_name,last_name,title,production_year,description
FROM(SELECT count(*) FROM role GROUP BY id)
WHERE r.id=p.id;
",2018-08-22 20:24:37.774297+10,15,0,228,noninterpretable
1695,"SELECT f.title, f.production_year FROM writer f, person
       WHERE person.id=f.id
	  and person.last_name='Williamson'
	  and person.first_name='Kevin';",2018-08-22 20:27:07.721859+10,5,1,82,correct
1696,"SELECT country FROM restriction 
    WHERE title='Shakespeare in Love'
	and description='M';",2018-08-22 20:34:31.644574+10,6,1,82,correct
1697,"SELECT id, first_name, last_name FROM person
    WHERE (year_born in (SELECT MAX(year_born) FROM person)); ",2018-08-22 20:42:49.115034+10,7,1,82,correct
1698,"SELECT
ma.TITLE,ma.production_year,p.first_name,p.last_name
from
(select 
title,production_year 
from 
Movie_Award
where 
ward_name=""BAFTA Film Award"" and category=""Best Film"" and result=""won"")
as ma,
Person as p, director as d
where ma.title=d.title 
and p.id=d.id 
and ma.production_year=d.production_year;",2018-08-22 20:49:40.071684+10,8,0,239,noninterpretable
1699,"SELECT id, award_name, year_of_award, category
FROM Director, Director_Award
WHERE NOT EXISTS (SELECT id, award_name, year_of_award, category
                  FROM Director, Director_Award
			 WHERE Director.title=Director_Award.title AND Director.production_year=Director_Award.production_year
			 AND lower(Director_Award.result)='won');",2018-08-22 20:52:00.99129+10,13,0,214,partially correct
1700,"SELECT
ma.TITLE,ma.production_year,p.first_name,p.last_name
from
(select 
title,production_year 
from 
Movie_Award
where 
lower(award_name)=""bafta film award"" and lower(category)=""best film"" and result=""won"")
as ma,
Person as p, director as d
where ma.title=d.title 
and p.id=d.id 
and ma.production_year=d.production_year;",2018-08-22 20:55:55.414501+10,8,1,239,correct
1701,"SELECT
count(*)
from
writer_awards
where ;",2018-08-22 20:59:02.506573+10,9,0,239,noninterpretable
1702,"SELECT id, award_name, year_of_award, category
FROM Director INNER JOIN Director_Award
ON Director.title=Director_Award.title AND Director.production_year=Director_Award.production_year
WHERE lower(Director_Award.result='nominated') AND Director.id NOT IN (SELECT id
                                                                       FROM Director, Director_Award
			                                                      WHERE Director.title=Director_Award.title 
												    AND Director.production_year=Director_Award.production_year
			                                                      AND lower(Director_Award.result)='won');",2018-08-22 21:01:27.670359+10,13,1,214,correct
1703,"SELECT
count(*)
from
writer_award as wa,
writer as w,
person as p

where 
wa.title=w.title
and
p.id=w.id
and
wa.id=w.id
AND lower(first_name)= 'woody'
AND lower(RESULT)= 'won'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;


",2018-08-22 21:03:04.306358+10,9,1,239,correct
1704,"SELECT PERSON.id, PERSON.last_name, PERSON.first_name, COUNT(*)
FROM PERSON p
WHERE p.id = DIRECTOR.id AND p.id = WRITER.id
GROUP BY p.id;",2018-08-22 21:06:00.399348+10,4,0,259,noninterpretable
1705,select * from movie m;,2018-08-22 21:20:03.310374+10,11,0,172,partially correct
1706,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-22 21:26:18.129711+10,4,1,259,correct
1707,"SELECT production_year, COUNT(title) FROM movie
GROUP BY production_year
HAVING production_year = 1935

UNION

SELECT production_year, COUNT(title) FROM movie
GROUP BY production_year
HAVING production_year = 1992

UNION

SELECT production_year, COUNT(title) FROM movie
GROUP BY production_year
HAVING production_year = 1991

;",2018-08-22 21:40:17.24486+10,2,0,25,partially correct
1708,"SELECT Director.id
FROM (SELECT DISTINCT Director.id, COUNT(Director.title)
      FROM Director, Writer
	WHERE Director.id = Writer.id
	AND Director.title = Writer.title AND Director.production_year = Writer.production_year
	GROUP BY Director.id)
WHERE Director.id = MAX(COUNT(Director.id));",2018-08-22 21:43:01.172082+10,14,0,214,noninterpretable
1709,"

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY title,production_year
HAVING production_year = 1992

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY title,production_year
HAVING production_year = 1991

;",2018-08-22 21:44:56.135808+10,2,0,25,noninterpretable
1710,"SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year
HAVING production_year = 1993

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY title,production_year
HAVING production_year = 1992

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY title,production_year
HAVING production_year = 1991

;",2018-08-22 21:45:27.031103+10,2,0,25,partially correct
1711,"select id, last_name, first_name 
from person p
where exists
(select m.title, d.id
from director d,movie m 
where p.id=d.id and m.title=d.title 
group by m.title 
having count(*)>=2);",2018-08-22 21:45:47.311265+10,4,0,125,partially correct
1712,"SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year
HAVING production_year = 1993

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year
HAVING production_year = 1992

UNION

SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year
HAVING production_year = 1991

;",2018-08-22 21:45:51.134487+10,2,1,25,correct
1713,"select id, last_name, first_name 
from person p
where exists
(select m.title, d.id
from director d,movie m 
where p.id=d.id and m.title=d.title 
group by d.id 
having count(*)>=2);",2018-08-22 21:47:04.371853+10,4,0,125,partially correct
1714,"select title, production_year from person p, writer w where p.id=w.id;",2018-08-22 21:50:35.714751+10,5,0,137,partially correct
1715,"select title, production_year from person p, writer w where p.id=w.id and first_name ='Kevin Williamson';",2018-08-22 21:51:36.512561+10,5,0,137,partially correct
1716,"select n.id, n.last_name, n.first_name 
from (person natural join writer natural join movie) as n
group by n.id
having count(*)>=2;",2018-08-22 21:58:43.293779+10,4,0,125,partially correct
1717,select country from restriction where description = 'M' AND title ='Shakespeare in Love' group by country;,2018-08-22 22:01:41.629454+10,6,1,137,correct
1718,"select n.id, n.last_name, n.first_name 
from (person natural join director natural join writer) as n
group by n.id
having count(*)>1;",2018-08-22 22:04:01.799161+10,4,1,125,correct
1719,"select n.id, n.first_name, n.last_name 
from (person natural join director natural join writer) as n
group by n.id
having count(*)>1;",2018-08-22 22:05:31.92562+10,4,1,125,correct
1720,"SELECT COUNT* FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-22 22:26:49.937676+10,12,0,25,noninterpretable
1721,"SELECT COUNT(*) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-22 22:27:03.353649+10,12,1,25,correct
1722,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select year_born
				from person
				order by year_born desc
				limit 1);",2018-08-22 22:28:34.23612+10,7,1,43,correct
1724,"select count(*)
from writer_award wa
	natural join
	person p
where lower(wa.result) = ""won"" and
	lower(p.first_name) = ""woody"" and
	lower(p.last_name) = ""allen"" and
	wa.year_of_award in (1991,1992,1993,1994,1995);",2018-08-22 22:35:31.615818+10,9,1,43,correct
1725,"SELECT S.id
FROM (SELECT S1.id, COUNT(*) AS NO
      FROM (SELECT Director.id, title, production_year
	       FROM Director
		  UNION
		  SELECT Writer.id, title, production_year
		  FROM Writer) S1
	GROUP BY S1.id) S
WHERE S.NO = (SELECT MAX(S.NO)
              FROM (SELECT S1.id, COUNT(*) AS NO
			   FROM (SELECT Director.id, title, production_year
			         FROM Director
			         UNION
			         SELECT Writer.id, title, production_year
				   FROM Writer) S1
			   GROUP BY S1.id) S);",2018-08-22 22:38:18.078131+10,14,1,214,correct
1726,"select p.id
from role r
	natural join
	appearance a
	natural join
	person p
where lower(a.title) = ""psycho"" and
	a.production_year = ""1960""
group by p.id
having count(p.id)= 1;",2018-08-22 22:40:22.765403+10,10,1,43,correct
1727,"WITH idcount AS (SELECT id, COUNT(id) total FROM director NATURAL JOIN writer
GROUP BY id),

ids AS (SELECT id FROM idcount 
WHERE total >= 2)

SELECT id, first_name,last_name FROM person
WHERE id IN (SELECT * FROM ids);",2018-08-22 22:40:56.605074+10,4,1,25,correct
1728,"SELECT title, pro FROM writer NATURAL JOIN person
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-22 22:43:08.560504+10,5,0,25,noninterpretable
1729,"SELECT title, production_year FROM writer NATURAL JOIN person
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-22 22:43:21.708276+10,5,1,25,correct
1730,"SELECT country FROM restriction
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-22 22:45:06.315245+10,6,1,25,correct
1731,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-22 22:46:09.424204+10,7,1,25,correct
1732,"select count(*)
from movie m
where not exists(select *
			from (select title, production_year, award_name,result from movie_award ma
				union
				select title, production_year, award_name,result from crew_award ca
				union
				select title, production_year, award_name,result from director_award da
				union
				select title, production_year, award_name,result from writer_award wa
				union
				select title, production_year, award_name,result from actor_award aa) as sub
			where sub.title = m.title and
				sub.production_year = m.production_year
				and lower(sub.result) = ""won"");",2018-08-22 22:49:55.691634+10,11,1,43,correct
1733,"SELECT DISTINCT title,production_year,first_name,last_name FROM person NATURAL JOIN movie NATURAL JOIN movie_award
WHERE lower(category) = 'best film'
AND lower(award_name) = 'bafta film award'
AND lower(result) = 'won'
;",2018-08-22 22:52:59.489279+10,8,0,25,partially correct
1734,"SELECT title,production_year,first_name,last_name FROM movie_award NATURAL JOIN director
INNER JOIN person
USING(id)
WHERE lower(result) = 'won'
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film';

",2018-08-22 22:58:20.262639+10,8,1,25,correct
1735,select id;,2018-08-22 23:01:48.838543+10,4,0,157,noninterpretable
1736,"


SELECT COUNT(*)
FROM writer_award wa, person p
WHERE p.id = wa.id
AND lower(p.first_name) = 'woody'
AND lower(p.last_name) = 'allen'
AND wa.year_of_award >= 1991
AND wa.year_of_award <= 1995
AND wa.result = 'won'



;",2018-08-22 23:02:51.768374+10,9,1,68,correct
1737,"select p.id
from person p
where p.year_born = (select max(p2.year_born) 
				from person p2
				where p2.year_born !=(select max(p3.year_born)
								from person p3));",2018-08-22 23:03:55.236323+10,3,1,43,correct
1738,"select count(*)
from person p natural join
			writer w
where p.year_born = ""1935"";",2018-08-22 23:07:15.728259+10,1,0,43,partially correct
1739,select id from PERSON;,2018-08-22 23:10:18.57281+10,1,0,250,partially correct
1740,"select count(movie.title) from movie,movie_award,crew_award,director_award,writer_award,actor_award
where not exists movie.title=movie_award.title
AND movie.production_year=movie_award.production_year
AND movie.title=crew_award.title
AND movie.title=director_award.title
AND movie.title=writer_award.title
AND movie.title=actor_award.title
AND movie.production_year=crew_award.production_year
AND movie.production_year=director_award.production_year
AND movie.production_year=writer_award.production_year
AND movie.production_year=actor_award.production_year
group by movie.title;",2018-08-22 23:17:28.690986+10,11,0,184,noninterpretable
1741,"SELECT first_name, last_name, title, production_year, description
FROM Person INNER JOIN Role
ON Person.id = Role.id
WHERE Person.id = (SELECT S.id
                   FROM (SELECT id, COUNT(*) AS NofR
				   FROM Role
				   GROUP BY id) S
			  WHERE S.id = (SELECT MAX(S.NofR)
			                FROM (SELECT id, COUNT(*) AS NofR
							FROM Role
							GROUP BY id) S));",2018-08-22 23:19:35.242458+10,15,0,214,partially correct
1742,"SELECT r.id
FROM appearance a INNER JOIN  scene s
	ON a.title = s.title AND a.production_year = s.production_year AND a.scene_no = s.scene_no
	INNER JOIN role r
	ON r.title = s.title AND s.production_year = r.production_year AND a.description = r.description

WHERE lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY r.id
HAVING count(*) = 1

;
",2018-08-22 23:24:43.907692+10,10,1,68,correct
1743,"SELECT Person.first_name, Person.last_name, Role.title, Role.production_year, Role.description
FROM Person, Role
WHERE Person.id = Role.id 
  AND Role.id = (SELECT S.id
                 FROM (SELECT id, COUNT(*) AS NR
				 FROM Role
				 GROUP BY id) S
			WHERE S.NR = (SELECT MAX(S.NR)
			              FROM (SELECT id, COUNT(*) AS NR
						    FROM Role
						    GROUP BY id) S));",2018-08-22 23:31:38.845419+10,15,1,214,correct
1744,"SELECT w. id FROM WRITER w INNER JOIN 
(SELECT id,title FROM DIRECTOR NATURAL JOIN (SELECT id FROM DIRECTOR GROUP BY id HAVING COUNT(id)>1) ORDER BY id ASC) AS idF
ON w.id=idF.id GROUP BY w.id HAVING COUNT(w.id)>1;",2018-08-22 23:33:30.336028+10,4,0,243,partially correct
1745,"select d.id, award_name, year_of_award, category
from director d,
person as p,
director_award as da
where da.title = d.title
and da.production_year = d.production_year
and d.id = p.id
group by result
having count(0);",2018-08-22 23:36:29.514649+10,13,0,174,partially correct
1746,"SELECT dw.id,dw..first_name,dw.last_name
FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-22 23:36:34.319211+10,4,0,243,noninterpretable
1747,"SELECT dw.id,dw.first_name,dw.last_name
FROM (PERSON  NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-22 23:37:20.813814+10,4,1,243,correct
1748,"SELECT title,production_year FROM WRITER WHERE id=(SELECT id FROM PERSON WHERE first_name='Kevin' AND last_name='Williamson');",2018-08-22 23:39:21.231044+10,5,1,243,correct
1749,"select d.id, da.award_name, da.year_of_award, da.category
from director d,
director_award as da
where da.title = d.title
and da.production_year = d.production_year
and lower(da.result)='nominated'
group by result
having count(0);",2018-08-22 23:42:37.261429+10,13,1,174,correct
1750,SELECT country FROM RESTRICTION WHERE title='Shakespeare in Love' AND description='M';,2018-08-22 23:45:00.746955+10,6,1,243,correct
1751,"SELECT id,first_name,last_name FROM PERSON WHERE year_born=(SELECT MAX(year_born) FROM PERSON);",2018-08-22 23:48:07.032224+10,7,1,243,correct
1752,"select id, first_name, last_name, year_born
from person p;",2018-08-22 23:48:38.863957+10,14,0,174,partially correct
1753,"select title, production_year
from movie m
where exists(select * 
from writer w, person p
where w.title=m.title and w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-22 23:50:55.497418+10,5,1,125,correct
1754,"select m.title, m.production_year
from movie m
where exists(select * 
from writer w, person p
where w.title=m.title and w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-22 23:52:24.902369+10,5,1,125,correct
1755,"SELECT p.first_name,p.last_name FROM
PERSON p NATURAL JOIN DIRECTOR NATURAL JOIN
(SELECT title, production_year FROM MOVIE_AWARD WHERE award_name='BAFTA Film Award' AND lower(category)='best film');",2018-08-22 23:54:28.514173+10,8,0,243,partially correct
1756,"select Distinct p.id, p.first_name, p.last_name
from (select d.id from director d group by d.id having count(d.title) >= 2) as x1, writer w, person p 
where x1.id = p.id and p.id = w.id;",2018-08-22 23:55:43.351997+10,4,0,66,partially correct
1966,"SELECT count(*) 
from writer,person
where writer.id = person.id
and person.year_born = 1935;",2018-08-23 16:59:34.415229+10,1,0,232,partially correct
1757,"SELECT dir.title, dir.production_year,p.first_name,p.last_name FROM
PERSON p NATURAL JOIN DIRECTOR dir NATURAL JOIN
(SELECT title, production_year FROM MOVIE_AWARD WHERE award_name='BAFTA Film Award' AND lower(category)='best film') ;",2018-08-22 23:55:45.119766+10,8,0,243,partially correct
1758,"SELECT dir.title, dir.production_year,p.first_name,p.last_name FROM
PERSON p NATURAL JOIN DIRECTOR dir NATURAL JOIN
(SELECT title, production_year FROM MOVIE_AWARD WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won') ;",2018-08-22 23:57:07.815508+10,8,1,243,correct
1759,"select first_name, last_name, r.title, r.production_year, r.description
from role r, 
person as p
where (select count(*) x
		from role r
		where max(r.id));",2018-08-22 23:57:28.565611+10,15,0,174,noninterpretable
1760,h;,2018-08-22 23:57:54.658431+10,15,0,208,noninterpretable
1761,"SELECT COUNT(*) FROM WRITER_AWARD WHERE id=
(SELECT id FROM PERSON WHERE first_name='Woody' AND last_name='Allen')
AND lower(result)='won'
AND year_of_award BETWEEN 1991 AND 1995;",2018-08-23 00:00:45.067404+10,9,1,243,correct
1762,SELECT id FROM ROLE WHERE lower(title)='psycho' AND production_year=1960;,2018-08-23 00:03:32.966214+10,10,0,243,partially correct
1763,select country from restriction where title = 'Shakespeare in Love'AND description = 'M';,2018-08-23 00:05:53.704605+10,6,1,66,correct
1764,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-23 00:11:13.316601+10,15,1,174,correct
1765,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-23 00:11:26.671084+10,15,1,174,correct
1766,"select p.id,p.first_name,p.last_name, da.award_name, da.year_of_award, da.category from director_award da, director d, person p
where result != 'won' and da.title=d.title and da.production_year=d.production_year and p.id = d.id;",2018-08-23 00:12:20.419122+10,13,0,203,partially correct
1767,"select p.id, da.award_name, da.year_of_award, da.category from director_award da, director d, person p
where result != 'won' and da.title=d.title and da.production_year=d.production_year and p.id = d.id;",2018-08-23 00:12:48.339517+10,13,1,203,correct
1768,"select director.id,h.award_name,h.year_of_award,h.category
from director,
(select * from director_award
where lower(result)='nominated' AND lower(result)!='won') as h
where director.title=h.title AND director.production_year=h.production_year;
",2018-08-23 00:16:31.005699+10,13,1,184,correct
1769,"select distinct d.id from director d, writer w
where exists (select * from writer) or d.id = w.id;",2018-08-23 00:17:12.713564+10,14,0,203,partially correct
1770,"SELECT r.id FROM ROLE r, SCENE s, APPEARANCE a
WHERE lower(s.title)='psycho' AND s.production_year=1960
AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-23 00:19:07.191319+10,10,1,243,correct
1771,"select MAX(year_born) from person
where not exists (select MAX(year_born) from person);
",2018-08-23 00:27:54.659968+10,3,0,184,partially correct
1772,"SELECT COUNT(*) FROM MOVIE_AWARD ma UNION CREW_AWARD ca UNION DIRECTOR_AWARD da UNION WRITER_AWARD wa UNION ACTOR_AWARD aa
WHERE lower(ma.result)='nominated'
AND ca.result='nominated'
AND da.result='nominated'
AND wa.result='nominated'
AND aa.result='nominated'
;",2018-08-23 00:28:25.111091+10,11,0,243,noninterpretable
1773,"select p.id, p.first_name, p.last_name, r.title,r.production_year, r.description from role r, person p
where p.id = r.id
group by r.id
order by count(*) desc
limit 1;",2018-08-23 00:28:56.087924+10,15,0,203,partially correct
1774,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-23 00:29:10.485771+10,11,1,243,correct
1775,"select p.first_name,p.last_name,r.title,r.production_year,r.description from person p inner join role r on r.id=p.id
where p.id=(
select p.id from role r, person p
where p.id = r.id
group by r.id
order by count(*) desc
limit 1);",2018-08-23 00:31:05.12537+10,15,1,203,correct
1776,"select id from person 
where year_born=(select max(year_born)
from person
where year_born<(select max(year_born)from person));",2018-08-23 00:31:53.78035+10,3,1,184,correct
1777,"SELECT id FROM PERSON WHERE year_born=
(SELECT MAX(year_born) FROM PERSON)>
(SELECT MAX(year_born) FROM PERSON);",2018-08-23 00:33:24.169568+10,3,0,243,partially correct
1778,"SELECT id FROM PERSON WHERE year_born=
(SELECT MAX(year_born) FROM PERSON WHERE year_born<
(SELECT MAX(year_born) FROM PERSON));",2018-08-23 00:34:08.235281+10,3,1,243,correct
1779,"select p.id,p.first_name,p.last_name from person p,writer w, director d
where p.id = d.id and d.id = w.id
group by d.id
having count(*)>2;",2018-08-23 00:34:45.224029+10,4,1,203,correct
1780,ii;,2018-08-23 00:36:02.842718+10,3,0,228,noninterpretable
1781,;,2018-08-23 00:36:58.795555+10,14,0,184,noninterpretable
1782,"SELECT dir.id,da.award_name,da.category FROM DIRECTOR dir INNER JOIN DIRECTOR_AWARD da ON dir.title=da.title WHERE result='nominated';",2018-08-23 00:39:32.845364+10,13,0,243,partially correct
1783,"SELECT d.id,da.award_name,da.category 
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-23 00:40:46.644169+10,13,0,243,partially correct
1784,"SELECT d.id,da.award_name,da.year_of_award,da.category 
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-23 00:41:56.690593+10,13,1,243,correct
1785,"select distinct first_name, last_name from PERSON inner join WRITER on PERSON.id= WRITER.id where year_born='1935';",2018-08-23 00:44:24.698373+10,1,0,264,partially correct
1786,select count(*) from PERSON where exists(select * from WRITER where PERSON.id=WRITER.id and PERSON.year_born=1935);,2018-08-23 00:48:03.798615+10,1,1,264,correct
1787,"select * from person
where year_born =1935;",2018-08-23 00:54:13.004126+10,1,0,265,partially correct
1788,select production_year from MOVIE where exists(select count(title) from MOVIE where production_year >= '1991' and production_year <= '1993');,2018-08-23 01:02:59.210395+10,2,0,264,partially correct
1789,"select production_year, count(*) from MOVIE where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-23 01:04:38.706763+10,2,1,264,correct
1790,select count(*) from PERSON where not(select id from DIRECTOR where PERSON.id = DIRECTOR.id);,2018-08-23 01:08:42.538636+10,12,0,264,partially correct
1791,select count(*) from PERSON where not exists(select id from DIRECTOR where PERSON.id = DIRECTOR.id);,2018-08-23 01:09:30.684438+10,12,1,264,correct
1792,"select id,first_name,last_name from PERSON where exists(select * from DIRECTOR where exists(select * from writer where PERSON.id = WRITER.id)); ",2018-08-23 01:16:20.2633+10,4,0,264,partially correct
1793,"select id, first_name, last_name from ( person natural join director natural join writer) group by id having count(*)>1;
",2018-08-23 01:19:20.155234+10,4,1,264,correct
1794,"select title, production_year from (writer inner join WRITER on PERSON.id = WRITER.id )where person.name = 'Kevin Williamson';",2018-08-23 01:28:44.30873+10,5,0,264,noninterpretable
1795,"SELECT PERSON.id, first_name, last_name FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) as w GROUP BY w.id HAVING COUNT(*) >1;",2018-08-23 01:48:04.295936+10,4,1,26,correct
1796,"SELECT count(title) FROM Movie
WHERE production_year = 1991 or 1992 or 1993;",2018-08-23 03:10:22.536267+10,2,0,45,partially correct
1797,"
GROUP BY production_year;",2018-08-23 03:11:50.857067+10,2,0,45,noninterpretable
1798,"select count(*)
from writer as w
inner join person as p on w.id = p.id
where p.year_born = 1935;",2018-08-23 08:29:59.56133+10,1,0,37,partially correct
1799,"select count(distinct w.id)
from writer as w
inner join person as p on w.id = p.id
where p.year_born = 1935;",2018-08-23 08:30:42.11565+10,1,1,37,correct
1800,"SELECT title,production_year FROM person NATURAL JOIN writer
WHERE lower(first_name) = 'kevin'
AND lower(last_name) = 'williamson';",2018-08-23 08:31:35.893128+10,5,1,25,correct
1801,"select production_year, count(distinct title)
from movie 
where production_year in (1993, 1992, 1991)
group by production_year
;",2018-08-23 08:33:27.148436+10,2,1,37,correct
1802,"SELECT country FROM restriction
WHERE lower(description) = 'm'
AND lower(title) = 'shakespeare in love';
",2018-08-23 08:36:16.829653+10,6,1,25,correct
1803,"select count(distinct w.id)
from writer as w
left join movie as m on m.title = w.title and m.production_year = w.production_year
where m.title is null;",2018-08-23 08:37:04.643271+10,12,0,37,partially correct
1804,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);
",2018-08-23 08:38:44.732252+10,7,1,25,correct
1805,"select count(distinct d.id)
from person as d
left join director as p on d.id = p.id
where p.id is null;",2018-08-23 08:39:13.065459+10,12,1,37,correct
1806,"with t1 as (
	select count(*) as num, p.id, p.first_name, p.last_name
	from movie as m
	inner join director as d on m.title = d.title and m.production_year = d.production_year
	inner join person as p on p.id = d.id
	inner join writer as w on p.id = w.id and m.title = w.title and m.production_year = w.production_year
	group by p.id, p.first_name, p.last_name
)
select id, first_name, last_name
from t1
where num >= 2;",2018-08-23 08:44:07.863628+10,4,1,37,correct
1807,"select m.title, m.production_year
from movie as m
inner join writer as w on m.title = w.title and m.production_year = w.production_year
inner join person as p on w.id = p.id
where p.first_name = 'Kevin' and p.last_name = 'Williamson'
;",2018-08-23 08:48:37.46322+10,5,1,37,correct
1808,"select distinct m.country
from movie as m
inner join restriction as r on m.title = r.title and m.production_year = r.production_year
where r.description = 'M';",2018-08-23 08:50:50.3754+10,6,0,37,partially correct
1809,"select distinct m.country
from movie as m
inner join restriction as r on m.title = r.title and m.production_year = r.production_year
where r.description = 'M' and lower(r.title) = 'Shakespeare in Love'
;",2018-08-23 08:51:53.857661+10,6,0,37,partially correct
1810,"select distinct m.country
from movie as m
inner join restriction as r on m.title = r.title and m.production_year = r.production_year
where r.description = 'M' and lower(r.title) = 'hakespeare in ove'
;",2018-08-23 08:52:01.013371+10,6,0,37,partially correct
1811,"select r.country
from restriction as r 
where r.description = 'M' and lower(r.title) = 'hakespeare in ove'
;",2018-08-23 08:52:24.065368+10,6,0,37,partially correct
1812,"select r.country
from restriction as r 
where r.description = 'M' and lower(r.title) = 'shakespeare in ove'
;",2018-08-23 08:53:25.994661+10,6,0,37,partially correct
1813,"select r.country
from restriction as r 
where r.description = 'M' and lower(r.title) = 'shakespeare in ove'
;",2018-08-23 08:53:32.231996+10,6,0,37,partially correct
1814,"select r.country
from restriction as r 
where r.description = 'M' and lower(r.title) = 'shakespeare in love'
;",2018-08-23 08:54:34.081268+10,6,1,37,correct
1815,"with t1 as (
	select min(year_born) as y
	from person
)
select p.id, p.first_name, p.last_name
from person as p 
inner join t1 on t1.y = p.year_born;",2018-08-23 08:56:37.534214+10,7,0,37,partially correct
1816,"with t1 as (
	select max(year_born) as y
	from person
)
select p.id, p.first_name, p.last_name
from person as p 
inner join t1 on t1.y = p.year_born;",2018-08-23 08:57:16.8999+10,7,1,37,correct
1817," WITH winners AS (SELECT * FROM movie_award
 			WHERE lower(result) = 'won'
			AND lower(award_name) = 'bafta film award'
			AND lower(category) = 'best film')

SELECT title,production_year,f FROM person NATURAL JOIN director
WHERE title IN (SELECT title FROM  winners);",2018-08-23 08:59:47.361701+10,8,0,25,noninterpretable
1818," WITH winners AS (SELECT * FROM movie_award
 			WHERE lower(result) = 'won'
			AND lower(award_name) = 'bafta film award'
			AND lower(category) = 'best film')

SELECT title,production_year,first_name,last_name FROM person NATURAL JOIN director
WHERE title IN (SELECT title FROM  winners);",2018-08-23 09:00:01.961739+10,8,1,25,correct
1819,"select id
from appearance natural join role 
where title = 'Psycho' and production_year = '1960'
group by id having count(*) =1;",2018-08-23 09:03:35.17625+10,10,1,28,correct
1820,"WITH woody AS (SELECT id FROM writer NATURAL JOIN person
			WHERE lower(first_name) = 'woody'
			AND lower(last_name) = 'allen')
			
SELECT COUNT(*) FROM writer award
WHERE lower('result') = 'won'
AND year_of_award >= 1991 AND year_of_award <= 1995
AND id IN (SELECT * FROM woody);",2018-08-23 09:14:29.186494+10,9,0,25,noninterpretable
1821,"select id, award_name, year_of_award, category
from director_award natural join director
where id not in(
select id
from director_award natural join director
where result = 'won');",2018-08-23 09:14:57.373561+10,13,1,28,correct
1822,"SELECT year_born, COUNT(*)
FROM PERSON
GROUP BY year_born HAVING COUNT(*)=1935;",2018-08-23 09:16:19.726895+10,1,0,182,partially correct
1823,"WITH woody AS (SELECT id FROM writer NATURAL JOIN person
			WHERE lower(first_name) = 'woody'
			AND lower(last_name) = 'allen')
			
SELECT COUNT(*) FROM writer_award
WHERE lower(result) = 'won'
AND year_of_award >= 1991 AND year_of_award <= 1995
AND id IN (SELECT * FROM woody);",2018-08-23 09:16:24.837288+10,9,1,25,correct
1824,"select count(*)
from movie
where title not in(
select title from movie natural join movie_award
union
select title from movie natural join crew_award
union
select title from movie natural join director_award
union
select title from movie natural join writer_award
union
select title from movie natural join actor_award);",2018-08-23 09:27:27.605966+10,11,0,28,partially correct
1825,"select p.first_name, p.last_name
from movie_award as ma
inner join movie as m on ma.title = m.title and ma.production_year = m.production_year
inner join director as d on d.title = m.title and d.production_year = m.production_year
inner join person as p on p.id = d.id
where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film';",2018-08-23 09:36:21.797572+10,8,0,37,partially correct
1967,"select distinct last_name from writer,person where year_born = 1935 and writer.id = person.id;",2018-08-23 17:05:03.690241+10,1,0,209,partially correct
2092,"SELECT count(*) 
FROM person 
WHERE EXISTS (SELECT * FROM writer WHERE writer.id = person.id AND person.year_born = 1935);",2018-08-24 05:18:37.054933+10,1,1,256,correct
1826,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma
inner join movie as m on ma.title = m.title and ma.production_year = m.production_year
inner join director as d on d.title = m.title and d.production_year = m.production_year
inner join person as p on p.id = d.id
where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film';",2018-08-23 09:36:53.278644+10,8,0,37,partially correct
1827,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma
inner join movie as m on ma.title = m.title and ma.production_year = m.production_year
inner join director as d on d.title = m.title and d.production_year = m.production_year
inner join person as p on p.id = d.id
where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film'
	and lower(result) = 'won';",2018-08-23 09:37:30.208098+10,8,1,37,correct
1828,"WITH scenecount AS (SELECT ID, COUNT(id) tot FROM appearance NATURAL JOIN role
WHERE lower(title) = 'psycho'
AND profuciton_year = 1960
GROUP BY id)

SELECT id FROM scenecount
WHERE tot = 1;",2018-08-23 09:39:23.298266+10,10,0,25,noninterpretable
1829,"WITH scenecount AS (SELECT ID, COUNT(id) tot FROM appearance NATURAL JOIN role
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY id)

SELECT id FROM scenecount
WHERE tot = 1;",2018-08-23 09:39:46.161817+10,10,1,25,correct
1830,select count(*) from person as p where exists(select * from writer as w where w.id =p.id and p.year_born=1935);,2018-08-23 09:45:43.342577+10,1,1,266,correct
1831,"SELECT title,COUNT(*)
FROM MOVIE 
GROUP BY title HAVING production_year>1990 AND production_year<1994;",2018-08-23 09:48:30.990555+10,2,0,182,partially correct
1832,"with t1 as(
	select *
	from writer_award as wa
	where wa.year_of_award between 1991 and 1995
		and lower(wa.result) = 'won'
),
t2 as (
	select * 
	from person
	where first_name = 'Woody' and last_name = 'Allen'
)
select count(*) as num
from t1
inner join writer as w on t1.id = w.id
	and t1.title = w.title
	and t1.production_year = w.production_year
inner join t2 on w.id = t2.id;",2018-08-23 09:49:00.514537+10,9,1,37,correct
1833,"
select count(*) from PERSON where first_name = Kevin and last_name = Williamson;",2018-08-23 09:54:24.835277+10,5,0,146,noninterpretable
1834,"SELECT production_year,COUNT(*)
FROM MOVIE 
GROUP BY production_year HAVING production_year>1990 AND production_year<1994;",2018-08-23 09:55:36.305026+10,2,1,182,correct
1835,"select w.title, w.production_year from writer w, person p where w.id = p.id and lower(first_name) = 'kevin' and lower(last_name) = 'Williamson';",2018-08-23 09:57:23.009848+10,5,0,146,partially correct
1836,"SELECT r.id
FROM scene s JOIN appearance a ON s.title=a.title JOIN role r ON s. title = r.title
WHERE s.production_year ='1960'
AND lower(a.title) = 'psycho'
GROUP BY r.id
HAVING count(*) = 1;",2018-08-23 10:01:05.374495+10,10,0,228,partially correct
1837,"select w.title, w.production_year 
from writer w, person p 
where w.id = p.id 
and lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-23 10:03:29.572856+10,5,1,146,correct
1838,select country from RESTRICTION where Shakespeare in Love as M;,2018-08-23 10:06:26.462176+10,6,0,146,noninterpretable
1839,"with t1 as(
	select m.title, m.production_year, c.id
	from movie as m
	inner join crew as c on m.title = c.title and m.production_year = c.production_year
	where m.title = 'Psycho' 
		and m.production_year = 1960
),
t2 as (
	select m.title, m.production_year, c.id
	from movie as m
	inner join role as c on m.title = c.title and m.production_year = c.production_year
	where m.title = 'Psycho' 
		and m.production_year = 1960
)
select id
from t1
union
select id
from t2;",2018-08-23 10:08:29.874287+10,10,0,37,partially correct
1840,"SELECT COUNT(*)
FROM person LEFT JOIN director ON person.id=director.id;",2018-08-23 10:11:12.44626+10,12,0,182,partially correct
1841,"select country from RESTRICTION 
where lower(title)='shakespeare in love' and description = 'M';",2018-08-23 10:12:18.385262+10,6,1,146,correct
1842,"select id, first_name, last_name from person where max(year_born);",2018-08-23 10:15:34.972835+10,7,0,146,noninterpretable
1843,"with t1 as (
	select r.id, count(*) as num
	from role as r
	inner join appearance as a on r.title = a.title
		and r.production_year = a.production_year
		and r.description = a.description
	inner join scene as s on s.title = a.title
		and s.scene_no = a.scene_no
		and s.production_year = a.production_year
	where a.title = 'Psycho'
		and a.production_year = 1960
	group by r.id
)
select id
from t1
where num = 1;",2018-08-23 10:16:39.809454+10,10,1,37,correct
1844,"select id, first_name, last_name from person p 
where p.year_born = (select max(year_born) from person);",2018-08-23 10:17:59.207841+10,7,1,146,correct
1845,best film;,2018-08-23 10:23:14.187747+10,8,0,146,noninterpretable
1846,"select count(*)
from PERSON p
where exists ( select * from WRITER w where w.id = p.id AND p.year_born = 1935);",2018-08-23 10:27:50.420071+10,1,1,250,correct
1847,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * 
                  FROM director d 
		 	 WHERE p.id = d.id);

",2018-08-23 10:30:52.025235+10,12,1,182,correct
1848,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS(SELECT*
	FROM director 
	WHERE person.id=director.id);",2018-08-23 10:34:22.050964+10,12,1,182,correct
1849,"with t1 as (
	select count(*) as tt
	from movie
),
t2 as (
	select count(distinct m.title) as tt
	from movie as m
		inner join director as d on d.title = m.title and d.production_year = m.production_year
		inner join crew as c on c.title = m.title and c.production_year = m.production_year
		inner join writer as w on m.title = w.title and m.production_year = w.production_year
		inner join role as r on r.title = m.title and r.production_year = w.production_year
		left join movie_award as ma on ma.title = m.title and ma.production_year = m.production_year
	left join director_award as da on da.title = d.title and da.production_year = d.production_year
	left join writer_award as wa on wa.id = w.id and wa.title = w.title and wa.production_year = w.production_year
	left join crew_award as ca on ca.id = c.id and ca.title = c.title and ca.production_year = c.production_year
	left join actor_award as aa on aa.title = r.title and aa.production_year = r.production_year and aa.description = r.description
	where lower(ma.result) = 'won'
		or lower(da.result) = 'won'
		or lower(wa.result) = 'won'
		or lower(ca.result) = 'won'
		or lower(aa.result) = 'won'
)
select t1.tt - t2.tt
from t1, t2;",2018-08-23 10:34:41.721314+10,11,0,37,partially correct
1850,"SELECT COUNT(*)
FROM PERSON
WHERE EXISTS(SELECT*
	FROM writer WHERE PERSON.ID=WRITER.ID AND person.year_born=1935);",2018-08-23 10:38:53.020848+10,1,1,182,correct
1851,"SELECT COUNT(*
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935;",2018-08-23 10:39:11.536399+10,1,0,173,noninterpretable
1852,"select count(*) from writer, person 
where person.id =writer.id and year_born=1935;",2018-08-23 10:40:31.113244+10,1,0,197,partially correct
1853,"select production_year, count (*) from movie where ;
",2018-08-23 10:41:14.535209+10,2,0,138,noninterpretable
1854,SELECT COUNT(*) FROM DIRECTOR;,2018-08-23 10:41:21.754671+10,14,0,243,partially correct
1855,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-23 10:42:56.381838+10,14,1,243,correct
1856,"select m.production_year
from m
where count(m.production_year) AS NumberofMovie
group by m.production_year;",2018-08-23 10:45:05.152893+10,2,0,250,noninterpretable
1857,"SELECT p.first_name,p.last_name, r.title,r.production_year,r.description
FROM PERSON p NATURAL JOIN ROLE r 
WHERE noOfRoles=(SELECT MAX(c) FROM (SELECT COUNT(*) AS c FROM ROLE GROUP BY id))
GROUP BY r.id;",2018-08-23 10:46:54.442677+10,15,0,243,noninterpretable
1858,"select count(*) from person 
where person.id in  ( select distinct person.id from person, writer where person.id =writer.id and year_born=1935);",2018-08-23 10:46:59.844633+10,1,1,197,correct
1859,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-23 10:47:32.111017+10,15,1,243,correct
1860,"select production_year, count(*)
from movie
where production_year > 1990 AND production_year < 1994
group by production_year;",2018-08-23 10:47:50.113159+10,2,1,250,correct
1861,"SELECT id, first_name, last_name
FROM person
WHERE EXISTS(SELECT *
	FROM writer, director
	WHERE writer.id=director.id AND writer.id=person.id AND director.id = person.id);",2018-08-23 10:48:26.337266+10,4,0,182,partially correct
1862,select count(person.id) from person where left join director;,2018-08-23 10:50:33.314322+10,12,0,138,noninterpretable
1863,"select production_year, count(*)
from movie
where production_year in (1993, 1992 ,1991)
group by production_year;",2018-08-23 10:50:57.158681+10,2,1,197,correct
1864,"SELECT id
FROM person p
WHERE year_born=(
SELECT MAX(year_born) FROM person WHERE year_born<(
SELECT MAX(year_born) FROM person));",2018-08-23 10:52:33.436278+10,3,1,228,correct
1865,"select count(*)
from person p
where exists ( select * from director d where d.id = p.id );",2018-08-23 10:54:26.848072+10,12,0,250,partially correct
1866,"select count(*)
from person p
where not exists ( select * from director d where d.id = p.id );",2018-08-23 10:55:57.836146+10,12,1,250,correct
1867,"with t1 as (
	select count(*) as tt
	from movie
),
t2 as (
	select count(distinct m.title || m.production_year) as tt
	from movie as m
		left join director as d on d.title = m.title and d.production_year = m.production_year
		left join crew as c on c.title = m.title and c.production_year = m.production_year
		left join writer as w on m.title = w.title and m.production_year = w.production_year
		left join role as r on r.title = m.title and r.production_year = w.production_year
		left join movie_award as ma on ma.title = m.title and ma.production_year = m.production_year
	left join director_award as da on da.title = d.title and da.production_year = d.production_year
	left join writer_award as wa on wa.id = w.id and wa.title = w.title and wa.production_year = w.production_year
	left join crew_award as ca on ca.id = c.id and ca.title = c.title and ca.production_year = c.production_year
	left join actor_award as aa on aa.title = r.title and aa.production_year = r.production_year and aa.description = r.description
	where lower(ma.result) = 'won'
		or lower(da.result) = 'won'
		or lower(wa.result) = 'won'
		or lower(ca.result) = 'won'
		or lower(aa.result) = 'won'
)
select t1.tt - t2.tt
from t1, t2;",2018-08-23 11:01:33.729687+10,11,1,37,correct
1868,"SELECT id,award_name,year_of_award,category
FROM director_award da,director d
WHERE da.title=d.title
AND da.production_year=d.production_year
AND result='nominated'
AND d.id NOT IN(
SELECT id
FROM director_award da,director d
WHERE
result='won'
AND da.title=d.title
AND da.production_year=d.production_year);",2018-08-23 11:02:48.385591+10,13,1,228,correct
1869,"select max(p.year_born)
from person as p
where p.year_born < (
	select max(year_born)
	from person
);",2018-08-23 11:07:57.162755+10,3,0,37,partially correct
1870,"SELECT count(*)
FROM writer w, person p
WHERE w.id=p.id
AND year_born=1935;",2018-08-23 11:07:59.958005+10,1,0,228,partially correct
1871,"select p.id
from person as p
inner join(
  select max(p.year_born)as yb
  from person as p
  where p.year_born < (
	  select max(year_born)
	  from person
  )
) as t on p.year_born = t.yb;",2018-08-23 11:09:08.423314+10,3,1,37,correct
1872,"SELECT COUNT(DISTINCT PERSON.id)
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935;",2018-08-23 11:17:12.971194+10,1,1,173,correct
1873,"SELECT title, production_year
FROM writer
WHERE EXISTS(SELECT*
	FROM person WHERE person.first_name=Kevin AND person.last_name=Willamson);",2018-08-23 11:20:25.336248+10,5,0,182,noninterpretable
1874,"with nominated as(
	select p.id, count(*) as num
	from director_award as da
	inner join director as d on da.title = d.title and da.production_year = d.production_year
	inner join person as p on d.id = p.id
	where lower(da.result) = 'nominated'
	group by p.id
	having count(*) >= 1
),
won as (
	select distinct p.id
	from director_award as da
	inner join director as d on da.title = d.title and da.production_year = d.production_year
	inner join person as p on d.id = p.id
	where lower(da.result) = 'won'
),
getID as (
	select distinct n.id
	from nominated as n
	left join won as w on n.id = w.id
	where w.id is null
)
select g.id, da.award_name, da.year_of_award, da.category
from getID as g
inner join director as d on g.id = d.id
inner join director_award as da on d.title = da.title and d.production_year = da.production_year
;",2018-08-23 11:25:27.776652+10,13,1,37,correct
1875,"SELECT production_year,count(*)
FROM movie
WHERE production_year=1993 
OR production_year=1992 
OR production_year=1991
GROUP BY production_year;
",2018-08-23 11:27:40.841834+10,2,1,228,correct
1876,"SELECT title, production_year
FROM writer
WHERE exists(SELECT * FROM person 
WHERE writer.id=person.id AND person.first_name=""Kevin"" AND person.last_name=""Williamson"");",2018-08-23 11:29:22.490489+10,5,1,182,correct
1877,"SELECT title, production_year
FROM writer w
WHERE EXISTS( SELECT* FROM person p WHERE 
w.id=p.id
AND first_name='Kevin'
AND last_name='Williamson');",2018-08-23 11:33:58.954032+10,5,1,228,correct
1878,"SELECT country
FROM restriction
WHERE restriction.title=""Shakespeare in Love"" AND restriction.description=""M"";",2018-08-23 11:40:05.52306+10,6,1,182,correct
1879,"with comb(
	select distinct m.title, m.production_year, d.id as did, w.id as wid
	from movie as m
	left join director as d on m.title = d.title and m.production_year = d.production_year
	left join writer as w on m.title = w.title and m.production_year = w.production_year
),
dirnum(
	select count(distinct title||production_year) as dnum, did
	from comb
	group by did
),
wrinum(
	select count(distinct title||production_year) as wnum, wid
	from comb
	group by wid
),
tog(
	select count(distinct title||production_year) as dwnum, tid
	from comb
	where did = wid
	group by did
);
",2018-08-23 11:41:31.02883+10,14,0,37,noninterpretable
1880,"SELECT m.title, m.production_year, b.first_name, b.last_name FROM   
   (SELECT * FROM (SELECT * FROM movie_award l 
	WHERE l.award_name='BAFTA'
	AND l.category='Best Film') as h LEFT join director ON h.title=director.title) as m, person b
   where m.id=b.id;
  ",2018-08-23 11:41:55.187157+10,8,0,82,partially correct
1881,"select *
from person natural join DIRECTOR
where exists ( select DIRECTOR d
group by d.title
having count (*) > 1);",2018-08-23 11:44:35.404343+10,4,0,250,noninterpretable
1882,"select dw.id, dw.first_name, dw.last_name
from ( person p natural join director d natural join writer w ) AS dw
group by dw.id
having count (*) > 1;",2018-08-23 11:56:29.345826+10,4,1,250,correct
1883,"select dm.title, dm.production_year
from ( movie m natural join writer w natural join person p ) dm
where p.first_name = Kevin and p.last_name = Williamson;",2018-08-23 12:01:51.680671+10,5,0,250,noninterpretable
1884,"SELECT m.id, first_name, last_name
FROM person, (SELECT id, MAX(year_born) AS MYB 
	FROM person
	GROUP BY id) as m
WHERE person.year_born=m.MYB AND person.id=m.id;",2018-08-23 12:04:52.748828+10,7,0,182,partially correct
1885,"SELECT id, first_name, last_name
FROM person
WHERE person.year_born=(SELECT MAX(year_born)  
	FROM person);",2018-08-23 12:08:07.271729+10,7,1,182,correct
1886,"select dm.title, dm.production_year
from ( movie m natural join writer w natural join person p ) dm
where p.first_name = 'Kevin' and p.last_name = 'Williamson' ;",2018-08-23 12:11:33.242437+10,5,1,250,correct
1970,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-23 17:11:33.659988+10,1,1,256,correct
1887,"select m.title, m.production_year, b.first_name, b.last_name from 
    (SELECT * FROM movie_award l 
	WHERE lower(l.award_name)='bafta film award' 
	and lower(l.category)='best film' 
	and lower(result)='won') as m, person b, director 
   where m.title=director.title and m.production_year=director.production_year 
   and b.id=director.id;
  ",2018-08-23 12:22:32.750852+10,8,1,82,correct
1888,SELECT COUNT(DISTINCT id) FROM writer NATURAL JOIN person WHERE year_born=1935;,2018-08-23 12:27:39.448388+10,1,1,155,correct
1889,SELECT COUNT(DISTINCT writer.id) FROM writer INNER JOIN person ON person.id=writer.id AND year_born=1935;,2018-08-23 12:29:39.86747+10,1,1,155,correct
1890,"SELECT COUNT(DISTINCT writer.id) FROM writer, person WHERE person.id=writer.id AND year_born=1935;",2018-08-23 12:30:10.426324+10,1,1,155,correct
1891,"SELECT COUNT(*) FROM 
     (SELECT s.award_name from writer_award s, person b
	 where s.id=b.id 
	 and lower(b.first_name)='woody' 
	 and lower(b.last_name)='allen'
	 and s.production_year>1990
	 and s.production_year<1996);",2018-08-23 12:33:32.742473+10,9,1,82,correct
1892,"select country
from restriction r
where title = 'Shakespeare in Love' and description = 'M' ;",2018-08-23 12:35:08.430889+10,6,1,250,correct
1893,"SELECT COUNT(DISTINCT WRITER.id)
FROM WRITER, PERSON
WHERE(PERSON.id = WRITER.id)
			AND PERSON. year_born=1935;",2018-08-23 12:35:14.726456+10,1,1,273,correct
1894,"SELECT COUNT (DISTINCT w.id) from writer w, person p
WHERE w.id=p.id AND p.year_born = 1935;",2018-08-23 12:36:55.009357+10,1,1,274,correct
1895,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-23 12:39:42.923498+10,8,1,146,correct
1896,"select id, first_name, last_name
from person p;",2018-08-23 12:40:52.660517+10,7,0,250,partially correct
1897,"WITH scene_count AS (SELECT id,COUNT(id) tot FROM appearance NATURAL JOIN role
WHERE production_year = 1960
AND LOWER(title) = 'psycho'
GROUP BY id)

SELECT id FROM scene_count 
WHERE tot = 1
;",2018-08-23 12:44:44.260172+10,10,1,25,correct
1898,"select id, first_name, last_name
from person p
where p.year_born = ( select max ( year_born ) from person );",2018-08-23 12:45:22.777208+10,7,1,250,correct
1899,"SELECT production_year, COUNT (*) as NoOfmovies FROM MOVIE 
group by production_year having production_year> 1990 and production_year < 1994;",2018-08-23 12:46:56.094633+10,2,1,274,correct
1900,"SELECT COUNT (*)
FROM writer w,(SELECT DISTINCT p.id,COUNT(*)
               FROM person p
               WHERE p.year_born=1935
               GROUP BY id)AS m
WHERE w.id=m.id;",2018-08-23 12:46:57.845124+10,1,0,272,partially correct
1901,"SELECT distinct b.id from role b, scene f 
       where lower(f.title)='psycho'
	   and f.production_year='1960'
	   and f.scene_no=1
	   and f.title=b.title
	   and f.production_year=b.production_year;",2018-08-23 12:49:02.907758+10,10,0,82,partially correct
1902,"select dw.title, dw.production_year, dw.first_name, dw.last_name
from ( movie_award m natural join director d natural join person p ) as dw
where m.category = 'Best Film' and m.award_name = 'BAFTA Film Award' ;",2018-08-23 12:54:17.955509+10,8,0,250,partially correct
1903,SELECT count(*) from person p where not exists(SELECT id from director d where d.id=p.id);,2018-08-23 12:54:19.345586+10,12,1,274,correct
1904,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w 
              WHERE p.id=w.id AND p.year_born=1935);",2018-08-23 12:57:21.534152+10,1,1,272,correct
1905,"SELECT m.production_year, COUNT(*)
FROM movie m
WHERE m.production_year>1990 AND m.production_year < 1994
GROUP BY m.production_year;",2018-08-23 13:05:34.72053+10,2,1,272,correct
1906,"SELECT m. production_year, count(*)
FROM movie as m
where m. production_year>1990 and m. production_year<1994
group by production_year;",2018-08-23 13:08:54.237806+10,2,1,273,correct
1907,"SELECT COUNT (*)
FROM person p
WHERE (SELECT d.id FROM director d WHERE p.id != d.id);",2018-08-23 13:27:48.311486+10,12,0,272,partially correct
1908,"SELECT COUNT(distinct person.id)
FROM person,director
WHERE NOT (SELECT id 
                    FROM person, director
					WHERE director.id = person.id);",2018-08-23 13:31:07.799285+10,12,0,273,noninterpretable
1909,"SELECT COUNT(*) FROM movie WHERE NOT EXISTS (SELECT n.result FROM movie_award, crew_award, director_award, writer_award, actor_award AS n WHERE n.result='won');",2018-08-23 13:31:55.071574+10,11,0,155,partially correct
1910,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-23 13:35:36.226259+10,11,1,155,correct
1911,"select p.id, first_name, last_name from person p, (select d.id, count(*) from director d, writer w where d.id=w.id group by d.id having count(*)>1) AS a
WHERE p.id= a.id;",2018-08-23 13:38:19.026857+10,4,0,274,partially correct
1912,"select p.id, first_name, last_name from person p, (select distinct d.id, count(*) from director d, writer w where d.id=w.id group by d.id having count(*)>1) AS a
WHERE p.id= a.id;",2018-08-23 13:38:59.65893+10,4,0,274,partially correct
1913,"SELECT COUNT(*)
FROM person
WHERE NOT exists (SELECT *
                    FROM director
					WHERE director.id = person.id);",2018-08-23 13:41:20.143369+10,12,1,273,correct
1914,"select distinct p.id, first_name, last_name from person p, (select distinct d.id, count(*) as number from director d, writer w where d.id=w.id and d.title= w.title group by d.id having count(d.id)>1) AS a
WHERE p.id= a.id;",2018-08-23 13:50:14.406272+10,4,1,274,correct
1915,"SELECT DISTINCT COUNT (*)
FROM person p
WHERE p.id != (SELECT DISTINCT d.id FROM director d);",2018-08-23 13:55:37.54781+10,12,0,272,partially correct
1916,select*;,2018-08-23 14:00:06.73327+10,13,0,157,noninterpretable
1917,"select m.title, m.production_year from movie m, writer w
where m.title=w.title and w.id = (select id from person where first_name=""Kevin"" and last_name=""Williamson"");",2018-08-23 14:03:24.900064+10,5,1,274,correct
1918,"SELECT COUNT( Distinct PERSON.id)
FROM PERSON, WRITER
WHERE PERSON.id=WRITER.id AND PERSON.year_born=1935;",2018-08-23 14:04:05.749211+10,1,1,173,correct
1919,"SELECT DISTINCT COUNT (*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);",2018-08-23 14:08:12.348992+10,12,1,272,correct
1920,"
select count(*) from WRITER_AWARD where year_of_award in (1991,1992,1993,1994,1995)
and lower(first_name) = 'woody' and lower(last_name) = 'allen';",2018-08-23 14:09:33.907376+10,9,0,146,noninterpretable
1921,"select production_year, COUNT(*)
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-23 14:12:19.236234+10,2,1,173,correct
1922,"select production_year, COUNT(*)
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-23 14:12:34.906936+10,2,1,173,correct
1923,"SELECT p.* 
FROM (SELECT MAX(year_born) AS maxofyear FROM person AS p1) AS p 
WHERE maxofyear < (SELECT p2.maxyear FROM (SELECT MAX(year_born) AS maxofyear FROM person AS p1) AS p2);",2018-08-23 14:13:28.444018+10,3,0,155,noninterpretable
2012,"select count(*)
from (select director.id from director d natural join person p
	where d.id != p.id);",2018-08-23 20:10:09.947152+10,12,0,232,noninterpretable
2182,"select count * from person 
where not exists (select id from director d where d.id=p.id);",2018-08-24 17:04:48.261086+10,12,0,20,noninterpretable
2848,"SELECT id, first_name, last_name
FROM person
WHERE year_born ='1993';",2018-08-26 18:57:31.260203+10,7,0,319,partially correct
1924,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-23 14:17:54.26273+10,9,1,146,correct
1925,SELECT * FROM person WHERE year_born=(SELECT MAX(year_born) FROM person WHERE year_born< (SELECT MAX(year_born) FROM person));,2018-08-23 14:18:42.547895+10,3,0,155,partially correct
1926,SELECT id FROM person WHERE year_born=(SELECT MAX(year_born) FROM person WHERE year_born< (SELECT MAX(year_born) FROM person));,2018-08-23 14:19:01.84786+10,3,1,155,correct
1927,"SELECT p.id, p.first_name, p.last_name 
FROM person p, director d 
WHERE EXISTS (SELECT COUNT(*)>2 FROM writer w
              WHERE d.id=w.id) 
			  AND p.id=d.id
			  GROUP BY p.id, p.first_name, p.last_name;",2018-08-23 14:20:00.066761+10,4,0,272,partially correct
1928,"SELECT count (director.id >=2)
FROM director
GROUP BY id, first_name, last_name;",2018-08-23 14:26:15.341824+10,4,0,273,noninterpretable
1929,"SELECT d.id, da.award_name, da.year_of_award, da.category FROM director AS d, director_award AS da WHERE d.title=da.title AND d.production_year=da.production_year AND da.result!='won';",2018-08-23 14:30:27.255554+10,13,1,155,correct
1930,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > =2;",2018-08-23 14:33:37.996922+10,4,0,273,noninterpretable
1931,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN  director d NATURAL JOIN writer w) AS dw
GROUP BY dw.id 
HAVING COUNT(*)>1;",2018-08-23 14:36:40.571977+10,4,1,272,correct
1932,"SELECT d.id, da.award_name, da.year_of_award, da.category 
FROM director AS d, director_award AS da 
WHERE d.title=da.title 
AND d.production_year=da.production_year
AND lower(da.result)='nominated'
AND lower(da.result)!='won';",2018-08-23 14:41:06.840125+10,13,1,155,correct
1933,"WITH losers AS (SELECT title, production_year FROM movie_award
WHERE lower(result) != 'won'

UNION

SELECT title, production_year FROM crew_award
WHERE lower(result) != 'won'

UNION

SELECT title, production_year FROM director_award
WHERE lower(result) != 'won'

UNION

SELECT title, production_year FROM writer_award
WHERE lower(result) != 'won'

UNION

SELECT title, production_year FROM actor_award
WHERE lower(result) != 'won')

SELECT COUNT(*) FROM losers;",2018-08-23 14:42:10.513585+10,11,0,25,partially correct
1934,"SELECT w.title, w.production_year
FROM writer w 
WHERE EXISTS (SELECT *
              FROM person p 
			  WHERE p.first_name = 'Kevin' 
			  AND p.last_name='Williamson'
			  AND w.id=p.id) 
GROUP BY  w.title;",2018-08-23 14:45:50.332277+10,5,1,272,correct
1935,"SELECT COUNT(*)
FROM person, director
WHERE person.id != director.id;",2018-08-23 14:57:57.984733+10,12,0,152,partially correct
1936,;,2018-08-23 15:13:38.831162+10,4,0,173,noninterpretable
1937,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-23 15:48:27.994398+10,4,1,173,correct
1938,"SELECT COUNT(*)
FROM person, writer
WHERE person.id=writer.id
AND person.year_born=1935
GROUP BY person.id;",2018-08-23 15:50:57.195195+10,1,0,278,partially correct
1939,"SELECT COUNT(*)
FROM person, writer
WHERE person.id=writer.id
AND person.year_born=1935
GROUP BY person.id;",2018-08-23 15:51:47.536652+10,1,0,278,partially correct
1940,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-23 15:52:12.225113+10,1,1,278,correct
1941,"select count(distinct(person.id))
from person, director
where not exists(select director.id from director where director.id = person.id);",2018-08-23 15:52:52.324063+10,12,1,235,correct
1942,"SELECT production_year, COUNT(*)
FROM moviE
WHERE movie.production_year>=1991
AND movie.production_year<=1993
GROUP BY production_year;",2018-08-23 15:54:49.624914+10,2,1,278,correct
1943,"SELECT COUNT(*)
FROM person,director
WHERE person.id!=director.id;",2018-08-23 15:57:34.546918+10,12,0,278,partially correct
1944,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-23 15:58:45.813211+10,12,1,278,correct
1945,"SELECT id,first_name,last_name;",2018-08-23 16:00:13.73002+10,4,0,278,noninterpretable
1946,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-23 16:00:58.919319+10,4,1,278,correct
1947,;,2018-08-23 16:03:04.653394+10,8,0,195,noninterpretable
1948,"SELECT title, production_year
FROM movie, writer, person
WHERE movie.title=writer.title
AND writer.id=person.id
AND person.first_name='Kevin';",2018-08-23 16:03:38.750276+10,5,0,278,noninterpretable
1949,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-23 16:05:12.183316+10,5,1,278,correct
1950,"SELECT country
FROM Restriction
WHERE title='Shakespeare in Love'
AND description='M';",2018-08-23 16:07:18.779778+10,6,1,278,correct
1951,"SELECT id, first_name, last_name
FROM person;
",2018-08-23 16:09:06.526327+10,7,0,278,partially correct
1952,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(
                 SELECT max(year_born)
				 FROM person);
",2018-08-23 16:10:52.864722+10,7,1,278,correct
1953,"SELECT count(*)
FROM movie m
WHERE m.title NOT IN
(SELECT title
FROM movie m
WHERE EXISTS(SELECT* FROM movie_award ma WHERE ma.title=m.title AND ma.result='won')
UNION ALL
SELECT title
FROM movie m
WHERE EXISTS(SELECT* FROM crew_award ca WHERE ca.title=m.title AND ca.result='won')
UNION ALL
SELECT title
FROM movie m
WHERE EXISTS(SELECT* FROM director_award da WHERE da.title=m.title AND da.result='won')
UNION ALL
SELECT title
FROM movie m
WHERE EXISTS(SELECT* FROM writer_award wa WHERE wa.title=m.title AND wa.result='won')
UNION ALL
SELECT title
FROM movie m
WHERE EXISTS(SELECT* FROM actor_award aa WHERE aa.title=m.title AND aa.result='won'));
",2018-08-23 16:11:56.496706+10,11,0,228,partially correct
1954,select (*);,2018-08-23 16:15:19.792837+10,3,0,157,noninterpretable
1955,"SELECT director.title, director.production_year, person.first_name, person.last_name
FROM director, movie_award, person
WHERE director.title=movie_award.title
AND movie_award.award_name='BAFTA Film Award'
AND movie_award.category='Best Film'
AND person.id=director.id;",2018-08-23 16:15:34.851637+10,8,0,278,partially correct
1956,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND d.id = p.id;",2018-08-23 16:16:33.11971+10,8,1,278,correct
1957,"SELECT COUNT(*)
FROM writer as w, person as p
WHERE w.id = p.id AND p.year_born = 1935;",2018-08-23 16:23:05.633722+10,1,0,222,partially correct
1958,"SELECT country from restriction where title=""Shakespeare in Love"" and description=""M"";",2018-08-23 16:28:29.170424+10,6,1,274,correct
1959,"SELECT id, first_name, last_name from person where year_born = (select min(year_born) from person);
",2018-08-23 16:31:15.786038+10,7,0,274,partially correct
1960,"SELECT id, first_name, last_name from person where year_born = (select MAX(year_born) from person);
",2018-08-23 16:31:49.948975+10,7,1,274,correct
1961,"SELECT COUNT(*) AS number
FROM ( SELECT writer.id as writer_id
       FROM writer, person 
	 WHERE writer.id=person.id
	 AND person.year_born=1935
	 GROUP BY writer_id) AS h;",2018-08-23 16:39:01.528108+10,1,1,227,correct
1962,"select count(id)
from Person;",2018-08-23 16:41:40.000412+10,1,0,258,partially correct
1963,"select count(distinct(person.id))
from Person, writer
where writer.id= person.id and person.year_born = ""1935"";",2018-08-23 16:51:09.554652+10,1,1,258,correct
1964,"select count(*)
from  writer as w left join person as p  on w.id=p.id
where year_born=1935;",2018-08-23 16:53:19.250622+10,1,0,158,partially correct
1965,"SELECT title, production_year
FROM movie NATURAL JOIN writer NATURAL JOIN person 
WHERE first_name = 'Kevin' AND last_name = 'Williamson';",2018-08-23 16:53:58.795736+10,5,1,173,correct
1968,;,2018-08-23 17:05:21.813249+10,10,0,158,noninterpretable
1969,"SELECT year_born
FROM PERSON
GROUP BY year_born=1935;",2018-08-23 17:08:56.924705+10,1,0,256,partially correct
1971,"SELECT id FROM role,appearance,scene 
WHERE role.title=appearance.title 
AND appearance.title=scene.title 
AND lower(appearance.title)='psycho' 
AND appearance.production_year= 1960 
AND scene.production_year=appearance.production_year
AND role.production_year=appearance.production_year
AND scene.scene_no=appearance.scene_no
AND appearance.description=role.description
GROUP BY id 
HAVING COUNT(*)=1; ",2018-08-23 17:16:47.770534+10,10,1,100,correct
1972,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991
GROUP BY production_year ;
",2018-08-23 17:16:50.346871+10,2,1,222,correct
1973,;,2018-08-23 17:17:49.112594+10,2,0,158,noninterpretable
1974,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-23 17:19:20.885668+10,1,1,222,correct
1975,;,2018-08-23 17:20:27.678326+10,2,0,256,noninterpretable
1976,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-23 17:21:07.231214+10,2,1,256,correct
1977,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id); ",2018-08-23 17:23:40.718766+10,12,1,222,correct
1978,"SELECT COUNT(WRITER.id)
FROM WRITER,PERSON
WHERE WRITER.id = PERSON.id AND year_born = 1935;",2018-08-23 17:25:56.118904+10,1,0,281,partially correct
1979,"SELECT COUNT(DISTINCT title) FROM movie 
WHERE EXISTS( SELECT*FROM movie_award,crew_award,director_award,writer_award,actor_award
WHERE movie.title!=movie_award.title
AND movie.title!=crew_award.title
AND movie.title!=director_award.title
AND movie.title!=writer_award.title
AND movie.title!=actor_award.title);",2018-08-23 17:33:11.283803+10,11,0,100,partially correct
1980,"select person.id ,person.first_name, person.last_name, COUNT(*)
from person JOIN director  ON director.id = person.id  JOIN Writer on person.id = writer.id
Group by person.id, person.first_name, person.last_name
HAVING COUNT(*) > 1;",2018-08-23 17:39:18.166398+10,4,0,235,partially correct
1981,"select person.id ,person.first_name, person.last_name
from person JOIN director  ON director.id = person.id  JOIN Writer on person.id = writer.id
Group by person.id, person.first_name, person.last_name
HAVING COUNT(*) > 1;",2018-08-23 17:39:45.289687+10,4,0,235,partially correct
1982,"select person.id ,person.first_name, person.last_name
from person JOIN director  ON director.id = person.id  JOIN Writer on person.id = writer.id 
	and director.title = writer.title and director.Production_year = writer.production_year
Group by person.id, person.first_name, person.last_name
HAVING COUNT(*) > 1;",2018-08-23 17:49:20.552132+10,4,1,235,correct
1983,"SELECT production_year, count(*)
from movie
where production_year=1993,production_year=1992,production_year=1991
group by production_year;",2018-08-23 17:56:26.913404+10,2,0,158,noninterpretable
1984,"SELECT production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-23 17:57:55.171165+10,2,1,158,correct
1985,"


WITH young AS (SELECT id, MAX(year_born) tot FROM person
WHERE year_born != (SELECT MAX(year_born) FROM person))

SELECT id FROM young;",2018-08-23 18:27:37.997689+10,3,1,25,correct
1986,"SELECT id,award_name,year_of_award,category FROM director_award NATURAL JOIN director
WHERE lower(result) != 'won';",2018-08-23 18:35:58.993538+10,13,1,25,correct
1987,"select count(*)
from person, director
where person.id != director.id;",2018-08-23 18:44:35.237426+10,12,0,197,partially correct
1988,"select count(*)
from person
where person.id not in (select distinct director.id from director);",2018-08-23 18:48:20.187765+10,12,1,197,correct
1989,"select p.id, p.first_name, p.last_name
from person p
where person.id in ( select distinct director.id from director, writer  where writer.id=director.id group by director.id);",2018-08-23 18:54:19.785495+10,4,0,197,noninterpretable
1990,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director, writer  where writer.id=director.id group by director.id);",2018-08-23 18:55:04.997365+10,4,0,197,partially correct
1991,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director, writer  where writer.id=director.id group by director.id);",2018-08-23 18:55:19.798478+10,4,0,197,partially correct
1992,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director where director.id in (select distinct writer.id from director);",2018-08-23 18:56:45.098055+10,4,0,197,noninterpretable
1993,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director where director.id in (select distinct writer.id from director));",2018-08-23 18:57:26.20223+10,4,0,197,noninterpretable
1994,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director where director.id in (select distinct writer.id from writer));",2018-08-23 18:58:13.543465+10,4,0,197,partially correct
1995,"select p.id, p.first_name, p.last_name
from person p
where p.id in ( select distinct director.id from director, (select id, count(*) from writer group by id having count(*)>1)As a where director.id =a.id );",2018-08-23 19:07:54.569339+10,4,1,197,correct
1996,"SELECT COUNT(*)
FROM writer_award AS w LEFT JOIN person AS p ON w.id = p.id
WHERE lower(p.first_name) = 'woody' 
      AND lower(p.last_name) = 'allen'
      AND w.year_of_award >= 1991
      AND w.year_of_award <= 1995;",2018-08-23 19:13:33.18614+10,9,0,169,partially correct
1997,"select title, production_year
from writer, person
where writer.id=person.id and person.first_name='Kevin' and person.last_name='Williamson';",2018-08-23 19:15:23.31314+10,5,1,197,correct
1998,"SELECT COUNT(*)
FROM writer_award AS wa,
     writer AS w,
     person AS p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND p.id = w.id      
    AND lower(p.first_name) = ""woody""
    AND lower(p.last_name) = ""allen""
    AND wa.year_of_award >= 1991
    AND wa.year_of_award <=1995
    AND lower(wa.result) = ""won"";",2018-08-23 19:20:46.093452+10,9,1,169,correct
1999,"SELECT r.id
FROM role AS r, movie AS m, scene AS s
WHERE r.title = m.title
AND r.production_year = m.production_year
AND s.title = r.title
AND s.production_year = r.production_year
AND lower(m.title) = ""psycho""
AND m.production_year = 1960
AND s.scene_no = 1;",2018-08-23 19:27:21.559118+10,10,0,169,partially correct
2000,"SELECT r.id
FROM role AS r, appearance AS a, scene AS s
WHERE r.title = a.title
AND r.production_year = a.production_year
AND s.scene_no = a.scene_no
AND s.title = r.title
AND s.production_year = r.production_year
AND a.description = r.description
AND lower(a.title) = ""psycho""
AND a.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-23 19:33:03.077893+10,10,1,169,correct
2001,"SELECT COUNT(*)
FROM writer w, person p
WHERE w.id = p.id
AND p.year_born = 1935;",2018-08-23 19:34:31.461948+10,1,0,169,partially correct
2002,"SELECT COUNT(*) FROM WRITER, PERSON WHERE PERSON.year_born=1935 AND WRITER.id=PERSON.id;",2018-08-23 19:39:05.290576+10,1,0,284,partially correct
2003,SELECT COUNT(*) FROM PERSON WHERE EXISTS (SELECT * FROM WRITER WHERE WRITER.id=PERSON.id AND PERSON.year_born=1935);,2018-08-23 19:41:30.686176+10,1,1,284,correct
2004,"SELECT r.country
FROM restriction r
WHERE r.title='Shakespeare in Love' 
AND r.description='M';",2018-08-23 19:42:22.669281+10,6,1,272,correct
2005,"SELECT count(*)
FROM Person p INNER JOIN Writer w ON p.id=w.id
WHERE p.year_born='1935';",2018-08-23 19:48:23.87306+10,1,0,170,partially correct
2006,"SELECT count(distinct id) 
from writer w natural join person p
where p.year_born = 1935;",2018-08-23 19:54:13.679397+10,1,1,232,correct
2007,"SELECT id, first_name, last_name
FROM person
WHERE (year_born IN (SELECT MIN(year_born) FROM person));",2018-08-23 19:57:54.280189+10,7,0,272,partially correct
2008,"SELECT id, first_name, last_name
FROM person
WHERE (year_born IN (SELECT MAX(year_born) FROM person));",2018-08-23 19:59:38.580839+10,7,1,272,correct
2009,"select count(title), production_year
from movie
where production_year=1991 or
	production_year=1993 or
	production_year = 1992
group by production_year;",2018-08-23 20:00:45.947247+10,2,1,232,correct
2010,"psql;

",2018-08-23 20:02:18.835668+10,10,0,61,noninterpretable
2011,"select  production_year,count(*)
from movie
where production_year=1991 or
	production_year=1993 or
	production_year = 1992
group by production_year;",2018-08-23 20:02:48.911376+10,2,1,232,correct
2013,"SELECT ma.title, ma.production_year, pd.first_name, pd.last_name
FROM movie_award ma
WHERE ma.award_name='BAFTA Film Award'AND ma.category='Best Film'
AND (SELECT *
     FROM (person p NATURAL JOIN director d) as pd
	 WHERE ma.title=d.title);",2018-08-23 20:17:15.076286+10,8,0,272,noninterpretable
2014,"select a.id, p.first_name, p.last_name 
	from (select d.id 
		from director d inner join writer w on d.id = w.id 
		group by d.id 
		having count(d.id) > 1) a inner join person p on a.id = p.id;",2018-08-23 20:21:49.916257+10,4,0,14,partially correct
2015,"select a.id, p.first_name, p.last_name from (select d.id from director d left join writer w on d.id = w.id group by d.id having count(d.id)>1) a inner join person p on a.id = p.id;",2018-08-23 20:24:58.33473+10,4,0,14,partially correct
2016,"SELECT p.id,first_name,last_name
FROM person p, (select d.id as smid,count(*) as smtitle 
	FROM director d inner join writer w
	ON d.id = w.id and d.title = w.title group by smid 
	having count(*) >= 2) as sm
WHERE sm.smid = p.id
;",2018-08-23 20:34:34.370908+10,4,1,232,correct
2017,"select a.id, p.first_name, p.last_name from (select d.id from director d, writer w where d.id = w.id and d.title = w.title group by d.id having count(d.id) > 1) a inner join person p on a.id = p.id;",2018-08-23 20:39:26.783439+10,4,1,14,correct
2018,"select title, production_year 
	from movie where title in 
	(select w.title 
		from writer w, person p 
		where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-23 20:47:37.280757+10,5,1,14,correct
2019,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-23 20:50:06.733288+10,6,1,14,correct
2020,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-23 20:51:39.008734+10,7,1,14,correct
2021,"SELECT title, production_year, first_name, last_name FROM
person natural join movie_award natural join director
where award_name= ""BAFTA Film Award"" and category = ""Best Film"";
",2018-08-23 20:51:45.680874+10,8,0,274,partially correct
2022,"SELECT title, production_year, first_name, last_name FROM
person natural join movie_award natural join director
where  lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film';
",2018-08-23 20:55:06.382183+10,8,0,274,partially correct
2023,"SELECT title, production_year, first_name, last_name FROM
person natural join movie_award natural join director
where  lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'AND lower(result)='won';
",2018-08-23 20:55:52.30704+10,8,1,274,correct
2024,"select count(*)
from  writer as w left join person as p  on w.id=p.id
where year_born=1935;",2018-08-23 21:10:29.589796+10,1,0,158,partially correct
2025,"select count(*) from Writer_award w where year_of_award > 1990 and year_of_award<1995
and lower(result)='won' and
w.id=(select id from person where first_name='Woody' and last_name='Allen');
",2018-08-23 21:23:20.959935+10,9,1,274,correct
2026,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM 
(SELECT title, production_year
  FROM movie_award
  WHERE lower(award_name)='bafta film award'
  AND lower(category)='best film'
  AND lower(result)='won') AS ma,
  person p,
  director d
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND d.id=p.id;",2018-08-23 21:27:04.933109+10,8,1,272,correct
2027,"select count(*)
from writer_award
where award_name = 'Woody Allen' and year_of_award >1990 and year_of_award <1996;",2018-08-23 21:50:01.769839+10,9,0,250,partially correct
2028,"select count(*) from person p
where exists(select * from writer w where p.id = w.id and year_born = 1935);",2018-08-23 22:14:42.717549+10,1,1,72,correct
2029,"SELECT COUNT(*)
FROM (SELECT id, title, production_year 
      FROM writer_award
	  WHERE year_of_award <1996 AND year_of_award >1990 AND lower(result)='won') AS wa,
	  (SELECT *
	  FROM person
	  WHERE lower(first_name)='woody' AND lower(last_name)='allen') AS p
	  WHERE wa.id=p.id;",2018-08-23 22:29:39.268143+10,9,1,272,correct
2030,"select count (*)
from writer w inner join person p on w.id=p.id
where p.year_born = '1935';",2018-08-23 22:46:08.217526+10,1,0,237,partially correct
2031,"SELECT h.title, h.production_year
FROM (person NATURAL JOIN writer) AS h
WHERE h.first_name= lower kevin AND h.last_name= lower williamson;",2018-08-23 22:53:46.679705+10,5,0,273,noninterpretable
2032,"SELECT id
FROM role r
WHERE exists (SELECT s.title, s.production_year
FROM scene s
WHERE s.production_year=1960 AND r.title=s.title)=1;",2018-08-23 22:53:52.122201+10,10,0,272,partially correct
2033,"WITH d AS (SELECT h.id ,COUNT(h.id) as total
FROM (SELECT  p.id, w.title, w.production_year
FROM person p, writer w
WHERE p.id = w.id 
UNION
SELECT  p.id, d.title, d.production_year
FROM person p, director d
WHERE p.id = d.id) as h
GROUP BY h.id)

SELECT d.id 
FROM d
WHERE d.total = (SELECT MAX(total)
FROM d);
",2018-08-23 22:59:12.609464+10,14,1,68,correct
2034,"WITH h AS (SELECT *
FROM director_award da INNER JOIN director d ON d.title = da.title 
AND d.production_year = da.production_year
AND da.result = 'nominated')
SELECT h.id, h.award_name, h.year_of_award, h.category
FROM h
WHERE NOT EXISTS(SELECT
*
FROM director_award da
WHERE h.production_year = da.production_year
AND h.title = da.title
AND da.result = 'won'
 )


;",2018-08-23 23:07:15.577339+10,13,1,68,correct
2035,"SELECT h.title, h.production_year
FROM (person NATURAL JOIN writer) AS h
WHERE lower(h.first_name)= 'kevin' AND lower(h.last_name)= 'williamson';",2018-08-23 23:13:40.309519+10,5,1,273,correct
2036,"select production_year, count(*) from movie where production_year in (1993,1992,1991) group by production_year;",2018-08-23 23:15:26.554979+10,2,1,72,correct
2037,"select count(*) from person p 
where not exists(select * from director d where p.id = d.id);",2018-08-23 23:16:59.176176+10,12,1,72,correct
2038,"select id, first_name, last_name
from person p where exists(select * from (writer natural join director) dw where p.id = dw.id);",2018-08-23 23:20:50.628328+10,4,0,72,partially correct
2039,"WITH h AS(Select id, MAX(total)
FROM
(SELECT id, COUNT(id) as total
FROM role
GROUP BY id) )
SELECT p.first_name,p.last_name, r.title,r.production_year,r.description
FROM h, person p, role r
WHERE p.id = h.id
AND p.id = r.id;",2018-08-23 23:24:18.638713+10,15,1,68,correct
2040,"select id, first_name, last_name
from (person natural join writer natural join director) as pdw 
group by pdw.id 
having count(*) > 1;",2018-08-23 23:26:24.696282+10,4,1,72,correct
2041,"SELECT r.title, r.production_year
FROM restriction r
WHERE lower (r.title)='Shakespeare in love'
GROUP BY r.title, r.production_year;",2018-08-23 23:29:52.388699+10,6,0,273,partially correct
2042,"SELECT country
FROM restriction
WHERE lower (title)='Shakespeare in love' AND description='M';",2018-08-23 23:31:42.186209+10,6,0,273,partially correct
2043,"SELECT country
FROM restriction
WHERE lower (title) = 'Shakespeare in love' 
            AND description = 'M';",2018-08-23 23:32:33.334005+10,6,0,273,partially correct
2044,"SELECT country
FROM restriction
WHERE lower (title) = 'shakespeare in love' 
            AND description = 'M';",2018-08-23 23:33:14.27808+10,6,1,273,correct
2045,"SELECT country
FROM restriction
WHERE lower (title) = 'shakespeare in love' 
            AND description = 'M';",2018-08-23 23:33:25.231551+10,6,1,273,correct
2046,"select title, production_year from (writer natural join person) as wp
where lower(wp.first_name) = 'kevin' and lower(wp.last_name) = 'williamson';
",2018-08-23 23:34:47.753522+10,5,1,72,correct
2047,"select r.country
from restriction r inner join movie m on r.title = m.title and r.production_year = m.production_year
where lower(r.title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-23 23:44:15.977902+10,6,1,72,correct
2048,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-23 23:45:55.726515+10,7,1,72,correct
2049,"select ma.title, ma.production_year, first_name, last_name
from movie_award ma, (person natural join director) pd
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and ma.title = pd.title and ma.production_year = pd.production_year;",2018-08-23 23:51:44.377761+10,8,0,72,partially correct
2091,"SELECT
    id,
    first_name,
    last_name
FROM
    person 
WHERE
    year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-24 05:11:54.525051+10,7,1,256,correct
2050,"select ma.title, ma.production_year, first_name, last_name, award_name, category
from movie_award ma, (person natural join director) pd
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and ma.title = pd.title and ma.production_year = pd.production_year and lower(result) = 'won';",2018-08-23 23:53:36.964408+10,8,0,72,partially correct
2051,"select ma.title, ma.production_year, first_name, last_name
from movie_award ma, (person natural join director) pd
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and ma.title = pd.title and ma.production_year = pd.production_year and lower(result) = 'won';",2018-08-23 23:53:49.489971+10,8,1,72,correct
2052,"select count(*)
from (writer_award natural join person)
where lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= 1991 and year_of_award <= 1995 and lower(result) = 'won';
",2018-08-23 23:57:49.367963+10,9,1,72,correct
2053,"SELECT count(*)
FROM PERSON p
WHERE EXISTS (SELECT * 
FROM writer w 
WHERE w.id = p.id
AND year_born = '1935');",2018-08-23 23:59:16.999285+10,1,1,241,correct
2054,"SELECT MAX(year_of_award)
FROM writer_award
GROUP BY year_of_award;

",2018-08-24 00:02:00.214264+10,4,0,241,partially correct
2055,"SELECT Max(year_born)
FROM person
GROUP BY id, first_name, last_name;",2018-08-24 00:04:27.243863+10,7,0,273,partially correct
2056,"select id
from appearance a inner join role r on a.title = r.title and a.production_year = r.production_year and a.description = r.description
where lower(a.title) = 'psycho' and a.production_year = 1960
group by id
having count(*) = 1;",2018-08-24 00:05:13.098539+10,10,1,72,correct
2057,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-24 00:05:36.852816+10,7,1,273,correct
2058,"select id, award_name, year_of_award, category
from (director_award natural join director)
group by id
having result = 'nominated' and result != 'won';",2018-08-24 00:26:34.389294+10,13,1,72,correct
2059,"select count(person.id) from person
where exists (select writer.id from writer where person.year_born=1935 AND writer.id=person.id);

",2018-08-24 00:26:54.032307+10,1,1,184,correct
2060,"select production_year,count(*)
from movie
group by production_year
having production_year>=1991 AND production_year<=1993;
",2018-08-24 00:31:24.324019+10,2,1,184,correct
2061,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where p.id = w.id
AND wa.id = w.id
and wa.title = w.title
and wa.production_year = w.production_year
and wa.result = 'won'
AND p.first_name = 'Woody'
AND p.last_name = 'Allen'
AND wa.year_of_award >=1991
AND wa.year_of_award <=1995;",2018-08-24 00:36:07.306663+10,9,1,250,correct
2062,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p natural join role r natural join
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS b );",2018-08-24 00:36:28.483908+10,15,1,72,correct
2063,"with b as (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id )
SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p natural join role r natural join b
WHERE
    b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM b);",2018-08-24 00:37:25.748519+10,15,1,72,correct
2064,"select count(person.id) from person
where not exists (select * from director where person.id =director.id);",2018-08-24 00:43:04.584607+10,12,1,184,correct
2065,"select count(*)
from person p
where exists(select w from director.id where p.id><w.id);",2018-08-24 00:43:11.466858+10,12,0,256,noninterpretable
2066,"select count(*)
from person p
where not exists(select * from director w  where p.id=w.id);",2018-08-24 00:49:48.873264+10,12,1,256,correct
2067,"select id
from role r
where exists (
select title
from scene s
where s.title = r.title
AND title = 'Psycho'
and production_year = '1960'
group by scene_no
having count(*) = 1 );",2018-08-24 00:50:20.433814+10,10,0,250,partially correct
2068,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-24 01:00:22.524259+10,10,1,250,correct
2069,;,2018-08-24 01:03:37.375597+10,11,0,250,noninterpretable
2070,"Select production_year, count(*)
from movie
where production_year in (1991,1992, 1993)
group by production_year;
",2018-08-24 01:06:13.534353+10,2,1,45,correct
2071,"Select count(id)
from Director;",2018-08-24 01:08:26.753134+10,12,0,45,partially correct
2072,"Select count(id)
from person p
Where not exists (select * from director d where p.id = d.id);",2018-08-24 01:14:37.637572+10,12,1,45,correct
2073,"Select id, first_Name, last_name
from Director
where sum(movie;",2018-08-24 01:17:41.690566+10,4,0,45,noninterpretable
2074,"Select dw.id, dw.first_name, dw.last_name
from (person p Natural join director natural join writer) AS dw
Group by dw.id
Having count(*) > 1;",2018-08-24 01:21:00.172429+10,4,1,45,correct
2075,"SELECT title, production_year FROM MOVIE NATURAL JOIN WRITER NATURAL JOIN PERSON WHERE PERSON.first_name = 'Kevin' AND PERSON.last_name = 'Williamson';",2018-08-24 01:30:55.652885+10,5,1,26,correct
2076,"Select id
from Person
where Person in (last_name = Williamson AND first_name = Kevin);
",2018-08-24 01:40:38.855523+10,5,0,45,noninterpretable
2077,;,2018-08-24 03:28:32.445731+10,4,0,256,noninterpretable
2078,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-24 03:29:33.813539+10,4,1,256,correct
2079,"select title,production_year
from movie,
where last_name=Williamson AND first_name=Kevin;",2018-08-24 04:08:50.957713+10,5,0,256,noninterpretable
2080,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';
    ",2018-08-24 04:12:37.178767+10,5,1,256,correct
2081,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND first_name= 'Kevin'
    AND last_name= 'Williamson';
    ",2018-08-24 04:21:33.724249+10,5,1,256,correct
2082,;,2018-08-24 04:33:10.415158+10,6,0,256,noninterpretable
2083,"SELECT
    country
FROM
    restriction
WHERE
    title = 'Shakespeare in Love'
    AND description = 'M';",2018-08-24 04:34:06.768248+10,6,1,256,correct
2084,"
HAVING MAX YEAR_BORN;",2018-08-24 04:39:25.610243+10,7,0,256,noninterpretable
2085,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-24 04:46:32.313702+10,7,1,256,correct
2086,;,2018-08-24 04:48:47.195112+10,8,0,256,noninterpretable
2087,"SELECT ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 05:02:59.259528+10,8,1,256,correct
2088,;,2018-08-24 05:03:43.82276+10,9,0,256,noninterpretable
2089,"SELECT id, first_name, last_name 
FROM (person NATURAL JOIN director NATURAL JOIN writer)
GROUP BY id 
HAVING count(*) > 1;",2018-08-24 05:10:21.590119+10,4,1,256,correct
2090,"SELECT
    title, production_year
FROM
    writer ,
    person 
WHERE
    writer.id = person.id
    AND first_name= 'Kevin'
    AND last_name= 'Williamson';
    ",2018-08-24 05:11:17.34936+10,5,1,256,correct
2093,;,2018-08-24 05:20:32.619032+10,9,0,256,noninterpretable
2094,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-24 05:27:47.906723+10,9,1,256,correct
2095,;,2018-08-24 05:28:03.81134+10,10,0,256,noninterpretable
2096,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-24 05:29:03.287033+10,10,1,256,correct
2097,;,2018-08-24 05:29:30.373286+10,11,0,256,noninterpretable
2098,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-24 05:33:21.225721+10,11,1,256,correct
2099,;,2018-08-24 05:33:35.240335+10,3,0,256,noninterpretable
2100,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-24 05:33:58.78805+10,3,1,256,correct
2101,;,2018-08-24 05:34:12.109828+10,13,0,256,noninterpretable
2102,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-24 05:34:34.336439+10,13,1,256,correct
2103,;,2018-08-24 05:34:46.495077+10,14,0,256,noninterpretable
2104,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-24 05:35:18.723323+10,14,1,256,correct
2105,;,2018-08-24 05:35:31.119564+10,15,0,256,noninterpretable
2106,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-24 05:35:51.098729+10,15,1,256,correct
2107,"SELECT country FROM Restriction WHERE title =""Shakespeare in Love"" AND description = 'M';",2018-08-24 08:52:58.841227+10,6,1,26,correct
2108,"SELECT id,first_name, last_name FROM PERSON WHERE year_born = (SELECT MAX(year_born) FROM PERSON);",2018-08-24 08:55:35.393654+10,7,1,26,correct
2109,"SELECT m.title, m.production_year, first_name, last_name FROM MOVIE m NATURAL JOIN DIRECTOR d NATURAL JOIN PERSON
	WHERE m.title IN (SELECT a.title FROM Movie_Award a WHERE award_name = ""BAFTA Film Award"" AND category = ""best film"" AND  result = ""won"");",2018-08-24 09:22:44.834362+10,8,1,26,correct
2110,"SELECT COUNT(*) FROM Writer_Award WHERE year_of_award>=1991 AND year_of_award<=1995 AND result = ""won"" AND id IN (SELECT id FROM PERSON WHERE first_name=""Woody"" AND last_name=""Allen"");",2018-08-24 09:26:29.472773+10,9,1,26,correct
2111,"SELECT description FROM APPEARANCE WHERE title = ""Psycho"" AND production_year=1960 GROUP BY description HAVING count(*)=1;",2018-08-24 09:31:16.523656+10,10,0,26,partially correct
2112,"SELECT id FROM ROLE WHERE production_year=1960 AND  description IN (SELECT description FROM APPEARANCE WHERE title = ""Psycho"" AND production_year=1960 GROUP BY description HAVING count(*)=1);",2018-08-24 09:35:37.534975+10,10,1,26,correct
2113,SELECT count(id) FROM PERSON WHERE year_born = 1935;,2018-08-24 09:53:01.295027+10,1,0,161,partially correct
2114,"SELECT title, production_year
FROM writer w
WHERE EXISTS(SELECT * FROM person p
WHERE p.id=w.id
AND p.first_name='Kevin'
AND p.last_name='Williamson');",2018-08-24 11:04:23.753845+10,5,1,228,correct
2115,"
GROUP BY DIRECTION.id;",2018-08-24 11:22:24.431289+10,12,0,290,noninterpretable
2116,"select distinct director.id from director,
(select id,count(id) from writer
group by id
having count(id)>1) AS h
where director.id=h.id;
",2018-08-24 11:25:12.684189+10,4,0,184,partially correct
2117,"SELECT COUNT(p.id) FROM person p, writer w
WHERE p.id=w.id
AND p.year_born = 1935
GROUP BY p.id;",2018-08-24 11:27:08.590205+10,1,0,95,partially correct
2118,"SELECT count(*) 
FROM CREW c 
WHERE EXISTS (SELECT * 
	FROM CREW_AWARD d 
	WHERE c.id = d.id
HAVING COUNT (*) > 0);",2018-08-24 11:35:01.765686+10,7,0,290,noninterpretable
2119,"select director.id from director
where exists
(select id from writer
where director.id=writer.id AND director.production_year=writer.production_year
group by id
having count(id)>1 );

",2018-08-24 11:38:10.707937+10,4,0,184,partially correct
2120,"SELECT COUNT (re.id) FROM (SELECT DISTINCT w.id FROM writer w
INNER JOIN person p
ON w.id=p.id
WHERE p.year_born = 1935) AS re;",2018-08-24 11:39:02.925623+10,1,1,95,correct
2121,"SELECT production_year,COUNT(title) FROM movie
WHERE production_year IN (1991,1992,1993)
GROUP BY production_year;",2018-08-24 11:42:03.06682+10,2,1,95,correct
2122,"SELECT COUNT(p.id) FROM person p 
WHERE p.id NOT IN (SELECT DISTINCT d.id FROM director d);
",2018-08-24 11:55:08.631279+10,12,1,95,correct
2123,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON
WHERE year_born = '1935'
GROUP BY year_born;
",2018-08-24 11:58:28.38014+10,1,0,81,partially correct
2124,"with temp as (
	select distinct d.id, d.title, d.production_year
	from director as d
	union
	select w.id, w.title, w.production_year
	from writer w
),
coun(
	select id, count(*) as num
	from temp
	group by id
)
select id
from coun
where coun.num = (
	select max(t.num)
	from coun as t
)
;",2018-08-24 12:03:11.892858+10,14,0,37,noninterpretable
2125,"SELECT p.id,p.first_name,p.last_name FROM person p
WHERE p.id IN (SELECT d.id FROM director d 
WHERE d.id IN (SELECT DISTINCT w.id FROM writer w
INNER JOIN director d
ON d.id = w.id) 
GROUP BY d.id
HAVING COUNT(d.title)>= 2);",2018-08-24 12:09:03.791743+10,4,0,95,partially correct
2126,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-24 12:13:33.237706+10,4,1,95,correct
2253,select country from RESTRICTION where restriction.description = 'M' and lower(restriction.title) = 'shakespeare in love';,2018-08-24 22:51:35.988924+10,6,1,264,correct
2310,"select count (*)
from person p
where p.id not in (select d.id from director d inner join movie m on d.title = m.title );",2018-08-25 11:23:37.861121+10,12,1,237,correct
2548,"SELECT COUNT(*) AS Numberofmovies, m.production_year
FROM MOVIE m
WHERE m.production_year <= 1993
and m.production_year >= 1991;

",2018-08-25 21:47:39.50874+10,2,0,199,partially correct
2127,"SELECT COUNT(DISTINCT title) FROM movie 
WHERE NOT EXISTS( SELECT title,production_year FROM movie_award
WHERE movie.title=movie_award.title AND movie.production_year=movie_award.production_year AND result='won'
UNION
SELECT title,production_year FROM crew_award
WHERE movie.title=crew_award.title AND movie.production_year=crew_award.production_year AND result='won'
UNION 
SELECT title,production_year FROM director_award
WHERE movie.title=director_award.title AND movie.production_year=director_award.production_year AND result='won'
UNION
SELECT title,production_year FROM writer_award
WHERE movie.title=writer_award.title AND movie.production_year=writer_award.production_year AND result='won'
UNION
SELECT title,production_year FROM actor_award
WHERE movie.title=actor_award.title AND movie.production_year=actor_award.production_year AND result='won');",2018-08-24 12:47:07.119406+10,11,0,100,partially correct
2128,"SELECT b.id from role b, scene f, appearance h 
    WHERE f.title=h.title 
	and f.production_year=h.production_year 
	and f.scene_no=h.scene_no 
	and f.title=b.title 
	and f.production_year=b.production_year 
	and f.description=b.description 
	and lower(f.title)='psycho' 
	and f.production_year=1960 
	group by b.id 
	having count(*)=1;",2018-08-24 13:40:20.168216+10,10,0,82,partially correct
2129,"SELECT b.id from role b, scene f, appearance h 
    WHERE f.title=h.title 
	and f.production_year=h.production_year 
	and f.scene_no=h.scene_no 
	and f.title=b.title 
	and f.production_year=b.production_year 
	and h.description=b.description 
	and lower(f.title)='psycho' 
	and f.production_year=1960 
	group by b.id 
	having count(*)=1;",2018-08-24 13:41:36.577571+10,10,1,82,correct
2130,"with winners as (select distinct title,production_year from movie_award
			where lower(result) = 'won'
			union
			select distinct title,production_year from crew_award
			where lower(result) = 'won'
			union
			select distinct title,production_year from director_award
			where lower(result) = 'won'
			union
			select distinct title,production_year from writer_award
			where lower(result) = 'won'
			union
			select distinct title,production_year from actor_award
			where lower(result) = 'won')
			
select count(*) from movie
where (title,production_year) not in (select * from winners);",2018-08-24 14:03:59.630414+10,11,1,25,correct
2131,"select max(year_born) from person 
where year_born != (select max(year_born) from person);",2018-08-24 14:06:58.6042+10,3,0,25,partially correct
2132,"with without_oldest as (select year_born from person 
where year_born != (select max(year_born) from person))

select max(year_born) from without_oldest;",2018-08-24 14:10:15.671928+10,3,0,25,partially correct
2133,"SELECT title,production_year,first_name,last_name
FROM(SELECT title, production_year FROM MOVIE_AWARD MA WHERE LOWER(AWARD_NAME)='bafta film award' AND lower(category)='best film'
AND lower(result)='won') as A NATURAL JOIN DIRECTOR D NATURAL JOIN PERSON P;
",2018-08-24 14:18:54.859823+10,8,1,228,correct
2134,"with without_oldest as (select id,year_born from person 
where year_born != (select max(year_born) from person))

select id from without_oldest
where year_born = (select MAX(year_born) from without_oldest);",2018-08-24 14:19:32.77488+10,3,1,25,correct
2135,"select id,award_name,year_of_award,category from director_award natural join director
where lower(result) != 'won';
",2018-08-24 14:22:07.379099+10,13,1,25,correct
2136,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND r.production_year=s.production_year
  AND r.production_year=a.production_year
  AND lower(s.title)='psycho'
  AND s.production_year=1960;",2018-08-24 14:56:58.108269+10,10,0,272,partially correct
2137,"select writer.id,person.first_name,person.last_name from writer,director,person
where director.id=writer.id AND director.production_year=writer.production_year AND director.title=writer.title AND person.id=writer.id
group by writer.id
having count(writer.id)>1;

",2018-08-24 14:59:29.728027+10,4,1,184,correct
2138,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND r.production_year=s.production_year
  AND r.production_year=a.production_year
  AND s.description=r.description
  AND a.description=r.description
  AND s.scene_no=a.scene_no
  AND lower(s.title)='psycho'
  AND s.production_year=1960;",2018-08-24 15:02:11.172422+10,10,0,272,partially correct
2139,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND s.production_year=r.production_year
  AND s.production_year=a.production_year
  AND a.description=r.description
  AND r.description=s.description
  AND s.scene_no=a.scene_no
  AND lower(s.title)='psycho'
  AND s.production_year=1960;",2018-08-24 15:05:11.406779+10,10,0,272,partially correct
2140,"select count(distinct id)
from person p natural join writer w
where p.year_born = 1935;",2018-08-24 15:05:53.413476+10,1,1,250,correct
2141,"actor;
",2018-08-24 15:06:05.309171+10,10,0,146,noninterpretable
2142,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-24 15:07:40.468779+10,10,1,146,correct
2143,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND s.production_year=r.production_year
  AND s.production_year=a.production_year
  AND a.description=r.description
  AND r.description=s.description
  AND s.scene_no=a.scene_no
  AND lower(s.title)='psycho'
  AND a.production_year=1960
GROUP BY r.id HAVING COUNT(*)=1;",2018-08-24 15:09:03.675827+10,10,0,272,partially correct
2144,"with wd as (select id,title,production_year from director
		union
		select id,title,production_year from writer),

		movie_count as (select id, count(id) tot from wd
		group by id)

select id from movie_count
where tot = (select max(tot) from movie_count);",2018-08-24 15:10:58.063104+10,14,1,25,correct
2145,"select writer.title,writer.production_year from writer,person
where writer.id=person.id AND lower(first_name)='kevin' AND lower(last_name)='williamson';",2018-08-24 15:21:01.446498+10,5,1,184,correct
2146,select * from person ;,2018-08-24 15:24:08.764401+10,10,0,274,partially correct
2147,"SELECT id,MAX(year_born) FROM person WHERE year_born<1992;",2018-08-24 15:28:12.948428+10,3,0,100,partially correct
2148,"SELECT DISTINCT p.id 
FROM person AS p, writer AS w, director AS d, 
(SELECT COUNT(m.title) AS noOfmovie
FROM movie AS m, writer AS w, director AS d 
WHERE m.title=w.title=d.title 
AND m.production_year=w.production_year=d.production_year 
GROUP BY m.title 
HAVING noOfmovie=MAX(m.title))
WHERE p.id=d.id
OR p.id=w.id
OR p.id=w.id=d.id;",2018-08-24 15:28:16.171828+10,14,0,155,partially correct
2149,"select count (title) from movie where not exists 
(select * from movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award);",2018-08-24 15:29:03.855006+10,11,0,274,partially correct
2150,"select count (distinct title) from movie where not exists 
(select * from movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award);",2018-08-24 15:29:22.417966+10,11,0,274,partially correct
2151,"SELECT m.title, m.production_year, b.first_name, b.last_name
FROM ((person as p
left join director as d ON p.id=d.id) as c
left join movie_award as m ON c.title=m.title)as b
WHERE b.award_name=""BAFTA Film Award"" AND b.category=""Best Film"";",2018-08-24 15:30:43.92297+10,8,0,182,partially correct
2152,"SELECT title, production_year
FROM writer w NATURAL JOIN person p
WHERE  first_name='Kevin'
AND last_name='Williamson';",2018-08-24 15:37:15.987589+10,5,1,228,correct
2153,"SELECT COUNT(*)
FROM WRITER_AWARD W
INNER JOIN PERSON P ON W.ID=P.ID
WHERE P.FIRST_NAME=""Woody"" AND P.LAST_NAME=""Allen"" AND year_of_award between 1991 and 1995;
",2018-08-24 15:40:40.806004+10,9,0,182,partially correct
2309,"
SELECT title,production_year,first_name,last_name FROM director NATURAL JOIN movie_award
INNER JOIN person USING(id)
WHERE lower(result) = 'won'
AND lower(category) = 'best film'
AND lower(award_name) = 'bafta film award';",2018-08-25 11:22:26.111193+10,8,1,25,correct
2154,"select count (*) from movie where not exists 
(select title, production_year from movie_award ma
where lower(ma.result) = 'won'
union select title, production_year from crew_award ca
where lower(ca.result) = 'won'
union select title, production_year from director_award da
where lower(da.result) = 'won'
union select title, production_year from writer_award wa
where lower(wa.result) = 'won'
union select title, production_year from actor_award aa
where lower(aa.result) = 'won');",2018-08-24 15:41:42.627231+10,11,0,274,partially correct
2155,"WITH roles AS (SELECT id,production_year,description FROM role NATURAL JOIN person
ORDER BY id ASC),

role_count AS (SELECT id, COUNT(id) tot FROM roles
GROUP BY id),

most_roles AS (SELECT id FROM role_count 
WHERE tot = (SELECT MAX(tot) FROM role_count))

SELECT first_name,last_name,title,production_year,description FROM role NATURAL JOIN person
WHERE id = (SELECT id FROM most_roles);",2018-08-24 15:42:45.717579+10,15,1,25,correct
2156,"SELECT COUNT(*) as number_of_award
FROM WRITER_AWARD W
INNER JOIN PERSON P ON W.ID=P.ID
WHERE P.FIRST_NAME=""Woody"" AND P.LAST_NAME=""Allen"" AND w.year_of_award between 1991 and 1995 AND W.RESULT=""won"";
",2018-08-24 15:44:13.267733+10,9,1,182,correct
2157,"select count (*) from movie m where not exists 
(select title, production_year from movie_award ma
where lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
union select title, production_year from crew_award ca
where lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
union select title, production_year from director_award da
where lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
union select title, production_year from writer_award wa
where lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
union select title, production_year from actor_award aa
where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);",2018-08-24 15:47:06.734731+10,11,1,274,correct
2158,"SELECT a.title from movie a, (select title from movie_award where result='won' group by title as h where a.title<>h.title;",2018-08-24 15:51:39.531036+10,11,0,82,noninterpretable
2159,SELECT id FROM person WHERE year_born= (SELECT MAX(year_born) FROM person WHERE year_born<(SELECT MAX(year_born) FROM person));,2018-08-24 15:53:08.662235+10,3,1,100,correct
2160,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-24 15:54:41.373981+10,11,1,82,correct
2161,"SELECT id
FROM MOVIE M
INNER JOIN  PERSON P ON M.ID=P.ID
left JOIN  SCENE S ON M.TITLE=S.TITLE
WHERE S.SCENE_ON=1 AND S.TITLE=""Psycho"" AND S.PRODUCTION_YEAR=1960;",2018-08-24 15:56:06.321611+10,10,0,182,noninterpretable
2162,select* from person where person id=writer=id and year_born=1935;,2018-08-24 16:04:22.497921+10,1,0,138,noninterpretable
2163,"SELECT id,award_name,year_of_award,category FROM director,director_award 
WHERE director.title=director_award.title
AND director.production_year=director_award.production_year
AND result!='won';",2018-08-24 16:06:00.898959+10,13,1,100,correct
2164,select* from person where exists(select*writer where writer.id =person.id and person year_born=1935);,2018-08-24 16:08:35.221692+10,1,0,138,noninterpretable
2165,"
select production_year, count(*)from movie where(production_year>1990 and production_year<1994);",2018-08-24 16:13:49.853035+10,2,0,138,partially correct
2166,"select wiriter.id,writer.firsname, writer.lastname from writer where exists(select* from writer where writer.id= director.id where count(*)movie >=2);
",2018-08-24 16:29:37.582086+10,4,0,138,noninterpretable
2167,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-24 16:30:09.277594+10,6,1,173,correct
2168,"select movie.title,movie.production_year from movie where exists( writer.name=kevin williamson);
",2018-08-24 16:34:49.329344+10,5,0,138,noninterpretable
2169,"SELECT id, first_name, last_name, MAX(year_born)
FROM person;",2018-08-24 16:36:48.878172+10,7,0,173,partially correct
2170,select country from movie where ( movie.titile= Shakespeare in Love as M);,2018-08-24 16:38:58.527456+10,6,0,138,noninterpretable
2171,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(
	SELECT max(year_born)
	FROM person
);",2018-08-24 16:39:47.240332+10,7,1,173,correct
2172,"select count (distinct p.id) as count
from writer w inner join person p on w.id=p.id
where p.year_born = '1935';
",2018-08-24 16:40:39.32479+10,1,1,237,correct
2173,"SELECT person.id FROM(SELECT MAX(COUNT(person.id))FROM ( (SELECT COUNT(person.id)) FROM person,writer,director
WHERE (SELECT writer.id 
FROM writer,movie 
WHERE person.id= writer.id 
AND movie.title=writer.title 
AND movie.production_year=writer.production_year)
OR
(SELECT director.id 
FROM director,movie 
WHERE director.title=movie.title 
AND director.production_year=movie.production_year 
AND person.id=director.id GROUP BY person.id));
",2018-08-24 16:41:58.759089+10,14,0,100,noninterpretable
2174,"select h.title,h.production_year,first_name,last_name from person,director,
(select * from movie_award  
where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won')as h
where person.id = director.id 
and director.title=h.title 
and director.production_year=h.production_year; ",2018-08-24 16:42:01.995557+10,8,1,184,correct
2175,"select count (*) from movie as numberofmovie
where (production_year=1993 or production_year=1992 or production_year=1991)
group by production_year
where (production_year=1993 or production_year=1992 or production_year=1991);
",2018-08-24 16:48:24.335743+10,2,0,20,noninterpretable
2176,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-24 16:48:33.350972+10,14,1,155,correct
2177,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-24 16:49:25.070358+10,2,1,20,correct
2178,"select person.id,person. last name from person where( person.year_born min);",2018-08-24 16:50:12.080152+10,7,0,138,noninterpretable
2179,"movie;
",2018-08-24 16:58:08.299635+10,11,0,146,noninterpretable
2180,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-24 16:58:48.371853+10,11,1,146,correct
2181,"
SELECT max((select count(id) FROM role group by role.id) x) FROM x;  ",2018-08-24 16:59:17.527679+10,15,0,100,noninterpretable
2183,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-24 17:05:58.962594+10,14,1,174,correct
2184,;,2018-08-24 17:07:04.678235+10,8,0,138,noninterpretable
2185,"
SELECT title, production_year 
FROM movie_AWARD
Where award_name ='BAFTA Film Award'
AND category = LOWER('best film')
AND result = LOWER('won') ) ;",2018-08-24 17:08:26.841347+10,8,0,173,noninterpretable
2186,"
SELECT title, production_year 
FROM movie_AWARD
Where award_name ='BAFTA Film Award'
AND category = LOWER('best film')
AND result = LOWER('won') ;",2018-08-24 17:08:37.663386+10,8,0,173,partially correct
2187,"select count(*) from person p
where not exists (select * from director d where p.id=d.id);",2018-08-24 17:10:08.616962+10,12,1,20,correct
2188,"SELECT ma.title, 
	 ma.production_year,
	 p.first_name,
	 p.last_name
FROM(
SELECT title, production_year 
FROM movie_AWARD
Where award_name ='BAFTA Film Award'
AND category = LOWER('best film')
AND result = LOWER('won') 
) AS ma,
director AS d,
person AS p

WHERE ma.title = d.title
  AND ma.production_year = d.production_year
  AND d.id = p.id;",2018-08-24 17:13:51.511277+10,8,1,173,correct
2189,;,2018-08-24 17:23:23.078873+10,11,0,21,noninterpretable
2190,"select id from person as p.id
where p.id= i.id and inner join (id from director and id from writer)as i,id
and (select title from director where min(title)>2)
group by first_name, last_name;


",2018-08-24 18:11:54.949628+10,4,0,20,noninterpretable
2191,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;

",2018-08-24 18:15:19.65369+10,4,1,20,correct
2192,"select count(writer_award.id) from writer_award,person
where lower(first_name)='woody' and lower(last_name)='allen' and lower(result)='won' and writer_award.year_of_award>=1991 and writer_award.year_of_award<=1995
and writer_award.id=person.id
group by writer_award.id;",2018-08-24 18:40:51.186716+10,9,1,184,correct
2193,"Select * FROM production_year WHERE MOVIE(title, production_year);",2018-08-24 19:10:33.601751+10,1,0,36,noninterpretable
2194,"SELECT COUNT(*)
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id AND p.year_born='1935');
",2018-08-24 19:10:56.132642+10,1,1,195,correct
2195,"SELECT DIRECTOR.id
FROM (SELECT m.country AS A
FROM MOVIE m
WHERE m.country = 'USA'
GROUP BY m.country
HAVING COUNT(m.country) >1) m
WHERE DIRECTOR.title=MOVIE.title AND DIRECTOR.production_year = MOVIE.production_year;
",2018-08-24 19:11:38.951552+10,2,0,290,noninterpretable
2196,"SELECT DIRECTOR.id
FROM (SELECT m.country AS A
FROM MOVIE m
WHERE m.country = 'USA'
GROUP BY m.country
HAVING COUNT(m.country) >1) m
WHERE DIRECTOR.title=MOVIE.title AND DIRECTOR.production_year = MOVIE.production_year
;",2018-08-24 19:12:09.967592+10,4,0,290,noninterpretable
2197,"SELECT country 
FROM Restriction_category
WHERE description = 'M';",2018-08-24 19:14:58.722951+10,6,0,195,partially correct
2198,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-24 19:16:34.237613+10,5,0,290,partially correct
2199,"SELECT country 
FROM Restriction
WHERE description = 'M'AND title='Shakespeare in Love';",2018-08-24 19:16:39.760546+10,6,1,195,correct
2200,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-24 19:17:17.480284+10,8,0,290,partially correct
2201,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.year_born=(SELECT max(p2.year_born) FROM person p2
GROUP BY p2.id);",2018-08-24 19:23:08.875017+10,7,0,195,partially correct
2202,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.year_born=(SELECT max(p2.year_born) FROM person p2
);",2018-08-24 19:24:09.037322+10,7,1,195,correct
2203,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 19:24:41.825045+10,9,0,290,partially correct
2204,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 19:25:07.441223+10,10,0,290,partially correct
2205,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 19:25:58.336241+10,13,0,290,partially correct
2206,"select id, award_name, year_of_award, category from director_award natural join director d
where not exists (select id, award_name, year_of_award, category from director_award natural join director d
where lower(result)='won');",2018-08-24 20:05:34.021408+10,13,0,274,partially correct
2207,"select id, award_name, year_of_award, category from director_award natural join director d
where id not in (select id from director_award natural join director d
where lower(result)='won');",2018-08-24 20:06:36.442367+10,13,1,274,correct
2208,"select kw.title, kw.production_year from (movie.m natural join writer) as kw
where ((select w.id, first_name, last_name from writer where first_name= 'kevin',last_name='williamson')
       and (select p.id from person where p.id=w.id));

",2018-08-24 20:08:24.698885+10,5,0,20,noninterpretable
2209,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';
",2018-08-24 20:12:20.46282+10,5,1,20,correct
2210,"select count(*)
from person p,writer w
where p.id=w.id
and p.year_born='1935';",2018-08-24 20:14:00.835434+10,1,0,256,partially correct
2211,"select country from restriction 
where description= 'M',title='Shakespeare in Love';",2018-08-24 20:16:29.768119+10,6,0,20,noninterpretable
2212,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-24 20:18:34.498727+10,6,1,20,correct
2213,"select count(*)
from person p
where not exists (SELECT * FROM person NATURAL JOIN director
where p.id = director.id);",2018-08-24 20:35:31.922217+10,12,1,232,correct
2214,g;,2018-08-24 20:37:16.239014+10,14,0,208,noninterpretable
2215,"select distinct count(*)
from person p
where exists 
(select * 
from writer w 
where p.year_born=1935 and  
w.id=p.id);",2018-08-24 20:38:37.465748+10,1,1,256,correct
2216,"select id,first_name,last_name from person
where exist min(year_born);",2018-08-24 20:40:54.073585+10,7,0,20,noninterpretable
2217,"select id,first_name,last_name from person p
where p.year_born =(select max(year_born) from person);
",2018-08-24 20:42:32.249203+10,7,1,20,correct
2218,"SELECT DISTINCT PERSON.last_name, PERSON.first_name
FROM PERSON, WRITER_AWARD
WHERE WRITER_AWARD.year_of_award IN (SELECT MAX (WRITER_AWARD.year_of_award)
FROM WRITER_AWARD) AND PERSON.id=WRITER_AWARD.id


;",2018-08-24 21:02:17.258043+10,14,0,290,partially correct
2219,"select title, production_year
from movie_award,director
where award_name='BAFTA Film Award'
      AND category='Best Film'
	AND result = 'won'
group by first_name,last_name;
",2018-08-24 21:06:54.331647+10,8,0,20,noninterpretable
3951,"select r.country from restriction r
where r.title='Shakespeare in Love'
and r.description='M';",2018-08-28 15:04:20.501088+10,6,1,363,correct
2220,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 21:09:14.816659+10,8,1,20,correct
2221,"SELECT n.title,n.production_year
FROM (SELECT * FROM movie NATURAL JOIN writer NATURAL JOIN person) AS n
WHERE n.first_name = 'Kevin' AND n.last_name = 'Williamson';",2018-08-24 21:10:24.777537+10,5,1,232,correct
2222,"SELECT DISTINCT id, first_name,last_name
FROM WRITER NATURAL JOIN PERSON
WHERE year_born = 1935;",2018-08-24 21:12:11.739689+10,1,0,171,partially correct
2223,"SELECT count(id)
FROM WRITER NATURAL JOIN PERSON
WHERE year_born = 1935;",2018-08-24 21:12:50.222978+10,1,0,171,partially correct
2224,"SELECT *
FROM WRITER;
",2018-08-24 21:14:37.045352+10,15,0,171,partially correct
2225,"SELECT COUNT(*) FROM WRITER NATURAL JOIN PERSON
WHERE year_born = '1935';",2018-08-24 21:20:20.692349+10,1,0,42,partially correct
2226,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-24 21:26:50.229105+10,8,1,20,correct
2227,"select distinct id from role,
(select * from appearance
where lower(title)='psycho' and scene_no=1 and production_year=1960) as h
where role.title=h.title and role.production_year=h.production_year;",2018-08-24 21:46:20.675803+10,10,0,184,partially correct
2228,"select distinct id from role,
(select * from appearance
where lower(title)='psycho' and scene_no=1 and production_year=1960) as h
where role.title=h.title and role.production_year=h.production_year and role.description= h.description;",2018-08-24 21:48:45.860158+10,10,0,184,partially correct
2229,"with movie_no as
(select id, count(*) as NoOfMovie from 
(select distinct id, title, production_year from writer natural join director)
order by id)

select Max(NoOfMovie) from movie_no;",2018-08-24 21:50:42.482757+10,14,0,274,partially correct
2230,"select m.title,m.production_year,p.first_name,p.last_name from movie_award m inner join director d 
on d.title = m.title and d.production_year = m.production_year 
inner join person p on d.id = p.id
where m.award_name=""BAFTA Film Award"" and m.category = 'best film';",2018-08-24 21:54:44.131929+10,8,0,130,partially correct
2231,"SELECT t.country
FROM (SELECT * FROM restriction r WHERE
r.title = 'Shakespeare in Love' AND r.description = 'M') AS t;",2018-08-24 21:56:55.543136+10,6,1,232,correct
2232,"select m.title,m.production_year,p.first_name,p.last_name from movie_award m inner join director d 
on d.title = m.title and d.production_year = m.production_year 
inner join person p on d.id = p.id 
where m.award_name=""BAFTA Film Award"" and m.category = 'best film' and result = 'won';",2018-08-24 21:57:44.19985+10,8,1,130,correct
2233,"select count (year_of_awards)
from writer_award
where 1991<year_of_award<1995
and ((select id.p,first_name.p,last_name.p
        from person.p
	  where lower(first_name) = 'woody',lower(last_name)= 'allen')
	  writer as w
	  writer_awards as wa
	  where id.w=id.wa=id.p);",2018-08-24 22:00:01.113649+10,9,0,20,noninterpretable
2234,"SELECT title, production_year
FROM WRITER
WHERE first;",2018-08-24 22:01:11.716392+10,5,0,259,noninterpretable
2235,"SELECT title, production_year
FROM WRITER
WHERE first;",2018-08-24 22:01:12.965545+10,5,0,259,noninterpretable
2236,"SELECT w.title, w.production_year
FROM WRITER w, PERSON p
WHERE w.id = p.id AND lower(first_name) = 'Kevin' AND lower(last_name)='Williamson';",2018-08-24 22:03:43.398816+10,5,0,259,partially correct
2237,"select distinct id from role,
(select * from appearance
where lower(title)='psycho' and scene_no=1 and production_year=1960) as h
where role.title=h.title and role.production_year=h.production_year and role.description= h.description;",2018-08-24 22:06:26.552388+10,10,0,184,partially correct
2238,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-24 22:07:23.392055+10,5,1,259,correct
2239,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-24 22:07:26.884591+10,5,1,259,correct
2240,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-24 22:10:13.441445+10,9,1,20,correct
2241,"SELECT y.id,y.first_name,y.last_name
FROM (SELECT id,first_name,last_name,MAX(year_born)
FROM person p) AS y;",2018-08-24 22:12:26.113263+10,7,1,232,correct
2242,"SELECT ma.title,ma.production_year,pd.first_name,pd.last_name
FROM movie_award ma, (person NATURAL JOIN director) AS pd
WHERE ma.award_name = ""BAFTA Film Award"" AND
	ma.category = ""Best Film"" AND 
	pd.title = ma.title AND pd.production_year = ma.production_year;",2018-08-24 22:20:55.223889+10,8,0,232,partially correct
2243,"SELECT ma.title,ma.production_year,pd.first_name,pd.last_name
FROM movie_award ma, (person NATURAL JOIN director) AS pd
WHERE lower(ma.award_name) = ""bafta film award"" AND
	lower(ma.category) = ""best film"" AND 
	pd.title = ma.title AND pd.production_year = ma.production_year;",2018-08-24 22:24:46.147152+10,8,0,232,partially correct
2244,"SELECT ma.title,ma.production_year,pd.first_name,pd.last_name
FROM movie_award ma, (person NATURAL JOIN director) AS pd
WHERE lower(ma.award_name) = ""bafta film award"" AND
	lower(ma.category) = ""best film"" AND lower(ma.result)='won'AND
	pd.title = ma.title AND pd.production_year = ma.production_year;",2018-08-24 22:28:18.630911+10,8,1,232,correct
2245,"select distinct p.id, first_name, last_name from person p, (select distinct d.id, count(*) as number from director d, writer w where d.id=w.id and d.title= w.title and d.production_year=w.production_year group by d.id having count(d.id)>1) AS a
WHERE p.id= a.id;",2018-08-24 22:30:00.560299+10,4,1,274,correct
2246,"select m.title, m.production_year from movie m, writer w
where m.title=w.title and m.production_year=w.production_year and w.id = (select id from person where first_name=""Kevin"" and last_name=""Williamson"");",2018-08-24 22:31:15.327613+10,5,1,274,correct
2247,"select id 
from role 
where ((select s.title,s.production_year,s.scene_no
         from scene
         where lower(title)='phycho'
	     and production_year = 1960
	     and scene_no = 1 as s)
	     role as r
	    where s.title=r.title
	     and s.production_year=r.production_year);",2018-08-24 22:34:54.795329+10,10,0,20,noninterpretable
2248,"select count(*)
FROM (select * FROM person natural join writer_award) AS pw
WHERE pw.year_of_award >= 1991 AND pw.year_of_award <= 1995 AND
	pw.first_name = ""Woody"" AND pw.last_name = ""Allen"";",2018-08-24 22:36:10.313757+10,9,0,232,partially correct
2249,"select count(*) AS number_of_award
FROM (select * FROM person natural join writer_award) AS pw
WHERE pw.year_of_award >= 1991 AND pw.year_of_award <= 1995 AND
	pw.first_name = ""Woody"" AND pw.last_name = ""Allen"" AND 
	lower(pw.result) = ""won"";",2018-08-24 22:39:00.216103+10,9,1,232,correct
2250,"select title, production_year from WRITER, PERSON where PERSON.id = WRITER.id AND  first_name = 'kevin' AND last_name = 'williamson';",2018-08-24 22:47:08.59134+10,5,0,264,partially correct
2251,"select title, production_year from WRITER, PERSON where PERSON.id = WRITER.id AND  lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-24 22:48:06.58007+10,5,1,264,correct
2252,select country from RESTRICTION where restriction.description = 'M' and restriction.title = 'shakespeare in love';,2018-08-24 22:50:52.292676+10,6,0,264,partially correct
2254,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-24 22:52:35.832659+10,10,1,20,correct
2255,"select id,first_name,last_name from person where year_born;",2018-08-24 22:53:02.878307+10,7,0,264,partially correct
2256,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-24 22:54:12.243016+10,7,1,264,correct
2257,"select count(*) from movie
where not exists
(select title,production_year from movie_award where lower(result)='won'
and movie.title= movie_award.title and movie.production_year=movie_award.production_year
union
select title,production_year from writer_award where lower(result)='won'
and movie.title= writer_award.title and movie.production_year=writer_award.production_year
union
select title,production_year from actor_award where lower(result)='won'
and movie.title= actor_award.title and movie.production_year=actor_award.production_year
union
select title,production_year from crew_award where lower(result)='won'
and movie.title= crew_award.title and movie.production_year=crew_award.production_year
union
select title,production_year from director_award where lower(result)='won'
and movie.title= director_award.title and movie.production_year=director_award.production_year);",2018-08-24 22:54:35.957814+10,11,1,184,correct
2258,"SELECT COUNT(*) 
FROM writer_award wa
WHERE wa.id in (

SELECT id 
FROM person
WHERE first_name = 'Woody'
AND last_name = 'Allen');",2018-08-24 22:55:37.298649+10,9,0,173,partially correct
2259,;,2018-08-24 22:56:28.456146+10,8,0,264,noninterpretable
2260,"SELECT COUNT(*) 
FROM writer_award wa
WHERE wa.id in (
	SELECT id 
	FROM person
	WHERE first_name = 'Woody'
	AND last_name = 'Allen')
AND wa.year_of_award >= 1991
AND wa.year_of_award <= 1995
AND wa.result = 'won';",2018-08-24 22:58:26.523877+10,9,1,173,correct
2261,"count*
from movie 
where not exist ( movie natural join movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award);",2018-08-24 23:00:33.639848+10,11,0,20,noninterpretable
2262,"with noofmovie as 
(SELECT x1.id, count(*) AS NoOfWorkedON 
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) x1 
GROUP BY x1.id)

select id from noofmovie 
where NoOfWorkedON = (select max(NoOfWorkedON) from noofmovie);",2018-08-24 23:02:53.753689+10,14,1,274,correct
2263,"SELECT id
FROM role r
WHERE  
 	lower(r.title)=""psycho"" 
	AND r.production_year = 1960
	;",2018-08-24 23:27:40.206418+10,10,0,232,partially correct
2264,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-24 23:30:10.197608+10,11,1,20,correct
2265,select count(*) from writer_award where exists (select * from person where lower(first_name) = 'woody' and lower(last_name) = 'allen')and writer_award.id = person.id;,2018-08-25 00:10:09.590744+10,9,0,264,noninterpretable
2266,"select count(*) from writer_award, writer, person where writer_award.title = writer.title and writer_award.production_year = writer.production_year and writer.id = person.id and lower(result) = 'won' and lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= '1991' and year_of_award <= '1995';",2018-08-25 00:17:44.248423+10,9,1,264,correct
2267,"select count(*) as number_of_the_awards from writer_award, writer, person where writer_award.title = writer.title and writer_award.production_year = writer.production_year and writer.id = person.id and lower(result) = 'won' and lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= '1991' and year_of_award <= '1995';",2018-08-25 00:19:27.882545+10,9,1,264,correct
2268,"select count(*) as number_of_the_awards from writer_award, writer, person where writer_award.title = writer.title and writer_award.production_year = writer.production_year and writer.id = person.id and lower(result) = 'won' and lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= '1991' and year_of_award <= '1995';",2018-08-25 00:21:42.556356+10,9,1,264,correct
2269,"select r.country
from restriction r
where r.title = ""Shakespeare in Love"" and r.description = 'M';",2018-08-25 09:01:28.208079+10,6,1,125,correct
2270,"select r.country
from restriction r
where r.title = 'Shakespeare in Love' and r.description = 'M';",2018-08-25 09:01:56.936131+10,6,1,125,correct
2271,"select id, first_name, last_name
from person p
where p.year_born = (select min(p.year_born) from person p);",2018-08-25 09:54:03.980426+10,7,0,125,partially correct
2272,"select id, first_name, last_name, year_born
from person p
where p.year_born = (select max(p.year_born) from person p);",2018-08-25 09:55:23.647507+10,7,0,125,partially correct
2273,"select id, first_name, last_name
from person p
where p.year_born = (select max(p.year_born) from person p);",2018-08-25 09:55:33.161764+10,7,1,125,correct
2274,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join person p natural join director d
where lower(ma.award_name) = 'bafta film award' and ma.category = 'best film' and d.id = p.id;",2018-08-25 10:05:27.077174+10,8,0,125,partially correct
2275,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join person p natural join director d
where lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film' and d.id = p.id;",2018-08-25 10:07:34.953797+10,8,0,125,partially correct
2276,"select id 
from person
where (select dinstinst year_born 
       from person des)
	 limit 2;",2018-08-25 10:12:33.893772+10,3,0,20,noninterpretable
2277,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-25 10:19:53.916615+10,3,1,20,correct
2278,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join person p natural join director d
where ma.award_name = 'BAFTA Film Awardd' and ma.category = 'Best Film' and d.id = p.id ;",2018-08-25 10:23:44.767878+10,8,0,125,partially correct
2279,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join person p natural join director d
where ma.award_name = 'BAFTA Film Awardd' and ma.category = 'Best Film' and d.id = p.id ;",2018-08-25 10:24:31.818306+10,8,0,125,partially correct
2280,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join person p natural join director d
where d.title = 
              (select d.title 
			  from director d, movie_award ma
			  where ma.award_name = 'BAFTA Film Awardd' and ma.category = 'Best Film' and d.title = ma.title)
                  and d.id = p.id ;",2018-08-25 10:30:08.339442+10,8,0,125,partially correct
2281,"SELECT x.first_name, x.last_name, x.title, x.production_year, x.description 
FROM (SELECT * FROM person AS p
UNION SELECT *, COUNT(*) AS nor FROM role AS r WHERE p.id=r.id) AS x 
WHERE x.nor = (SELECT * FROM person AS p UNION SELECT *, COUNT(*) AS nor FROM role AS r WHERE p.id=r.id) AS x) AS x2 
;",2018-08-25 10:41:54.106711+10,15,0,155,noninterpretable
2282,"select id,award_name.year_of_award,catagory
from director_award da
where not exist lower(result)='won'
and (select id 
      from director d
	 where d.id=da.id); ",2018-08-25 10:42:24.775178+10,13,0,20,noninterpretable
2283,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-25 10:43:53.254907+10,15,1,155,correct
2284,"select count(*)
from writer_award wa natural join writer w natural join person p
where wa.production_year >1990 and wa.production_year<1996 and wa.id=w.id and w.id = p.id and p.first_name= 'Woody' and p.last_name ='Allen';
",2018-08-25 10:44:34.790574+10,9,1,125,correct
2285,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-25 10:44:36.702164+10,10,1,155,correct
2286,"select count(*)
from writer_award wa natural join writer w natural join person p
where wa.result = 'won'
and wa.production_year >1990 
and wa.production_year<1996 
and wa.id=w.id 
and w.id = p.id 
and p.first_name= 'Woody' 
and p.last_name ='Allen';
",2018-08-25 10:46:13.85173+10,9,0,125,partially correct
2287,"select count(*)
from writer_award wa natural join writer w natural join person p
where wa.result = 'won'
and wa.production_year >1990 
and wa.production_year<1996 
and wa.id=w.id 
and w.id = p.id 
and lower(p.first_name)= 'woody' 
and lower(p.last_name) ='allen';
",2018-08-25 10:47:11.761232+10,9,0,125,partially correct
2288,"select count(*)
from writer_award wa natural join writer w natural join person p
where wa.result = 'won'
and wa.production_year >=1991 
and wa.production_year<=1995 
and wa.id=w.id 
and w.id = p.id 
and lower(p.first_name)= 'woody' 
and lower(p.last_name) ='allen';
",2018-08-25 10:47:56.499073+10,9,0,125,partially correct
2289,"select count(*)
from writer_award wa, writer w, person p
where wa.result = 'won'
and wa.production_year >=1991 
and wa.production_year<=1995 
and wa.id=w.id 
and w.id = p.id 
and lower(p.first_name)= 'woody' 
and lower(p.last_name) ='allen';
",2018-08-25 10:48:30.867516+10,9,0,125,partially correct
2290,"select count(*)
from writer_award wa 
natural join writer w 
natural join person p
where wa.result = 'won'
and wa.year_of_award>=1991 
and wa.year_of_award<=1995 
and wa.id=w.id 
and w.id = p.id 
and lower(p.first_name)= 'woody' 
and lower(p.last_name) ='allen';
",2018-08-25 10:50:34.864659+10,9,1,125,correct
2291,"select count(*)
from writer_award wa 
natural join writer w 
natural join person p

where wa.result = 'won'
and wa.year_of_award>=1991 
and wa.year_of_award<=1995 
and wa.id=w.id 
and w.id = p.id 
and lower(p.first_name)= 'woody' 
and lower(p.last_name) ='allen';
",2018-08-25 10:50:57.513851+10,9,1,125,correct
2292,"with roleplayed as 
(select distinct r.id, first_name, last_name, title, production_year, description from role r, person p
where r.id=p.id)

select first_name, last_name, title, production_year, description from roleplayed r
where r.id = (select rn1.id from 
(select r.id, count(*) as noofroles from roleplayed r group by r.id) rn1
where rn1.noofroles = (select max (rn2.noofroles) from 
(select r.id, count(*) as noofroles from roleplayed r group by r.id) rn2));
",2018-08-25 10:52:02.986765+10,15,1,274,correct
2293,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-25 10:56:53.878728+10,13,1,20,correct
2294,"select id 
from director d,writer w
where d.id outer join w.id
and d.id natural join w.id;",2018-08-25 10:58:49.96421+10,14,0,20,noninterpretable
2295,"select id 
from director d,writer w
where d.id outer join w.id
and d.id natural join w.id;",2018-08-25 10:58:59.766266+10,14,0,20,noninterpretable
2296,"with year_born as (select * from person natural join writer where year_born = 1935), ids as (select distinct id from year_born) select count(*) from ids",2018-08-25 10:59:34.054531+10,1,1,25,correct
2297,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-25 10:59:51.422013+10,14,1,20,correct
2298,"SELECT production_year, COUNT(production_year) FROM movie
WHERE production_year >= 1991 AND production_year <= 1993
GROUP BY production_year;",2018-08-25 11:03:15.430279+10,2,1,25,correct
2299,"WITH ids AS (SELECT id FROM person
WHERE id NOT IN (SELECT id FROM director))

SELECT COUNT(*) FROM ids;",2018-08-25 11:05:13.60928+10,12,1,25,correct
2300,"WITH dw AS (SELECT * FROM director NATURAL JOIN writer
		INNER JOIN person USING(id)),

ID_COUNT as (SELECT id, COUNT(id) tot FROM dw
GROUP BY id),

atleast_two AS (SELECT id FROM id_count
WHERE tot >= 2)

SELECT DISTINCT id,first_name,last_name FROM dw
WHERE id IN (SELECT * FROM atleast_two);
",2018-08-25 11:10:51.633729+10,4,1,25,correct
2301,"SELECT title,production_year FROM person NATURAL JOIN writer
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';
",2018-08-25 11:12:46.792993+10,5,1,25,correct
2302,"SELECT country FROM restriction
WHERE lower(description) = 'm'
AND lower(title) = 'shakespeare in love';",2018-08-25 11:14:51.845452+10,6,1,25,correct
2303,"select p.first_name, p.last_name,r.title, r.production_year, r.description 
from role r
     person p
where (select count* from max(r.id)
        and r.id=p.id);
  ",2018-08-25 11:15:09.184285+10,15,0,20,noninterpretable
2304,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-25 11:15:39.729793+10,15,1,20,correct
2305,"SELECT id, first_name, last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-25 11:16:38.90165+10,7,1,25,correct
2306,"select production_year, count (*) as corresponding_numbers_of_movies
from movie
where production_year in (1993,1992,1991) 
group by production_year;",2018-08-25 11:17:47.476011+10,2,1,237,correct
2307,"select p.first_name, p.last_name
from person p natural join 
role r natural join
movie m natural join
scene s
where m.title = 'Psycho'
and m.production_year = 1960
and s.title = m.title
and m.title= r.title
and r.id =p.id;",2018-08-25 11:18:47.159325+10,10,0,125,partially correct
2308,"select distinct p.first_name, p.last_name
from person p, 
role r,
movie m,
scene s
where m.title = 'Psycho'
and m.production_year = 1960
and s.title = m.title
and m.title= r.title
and r.id =p.id;",2018-08-25 11:22:14.993141+10,10,0,125,partially correct
3952,select country from restriction where description='M'and title='Shakespeare in Love';,2018-08-28 15:06:27.186744+10,6,1,258,correct
2311,"with woody_won AS (SELECT * FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
AND lower(result) = 'won'
AND year_of_award >= 1991 AND year_of_award <= 1995)


SELECT COUNT(*) FROM woody_won;",2018-08-25 11:26:27.737414+10,9,1,25,correct
2312,"select count (*)
from person p
where not exists (select * from director d where d.id = p.id );",2018-08-25 11:33:31.650284+10,12,1,237,correct
2313,"select distinct p.id
from person p, 
role r,
movie m,
scene s
where m.title = 'Psycho'
and m.production_year = 1960
and s.title = m.title
and m.title= r.title
and r.id =p.id;",2018-08-25 11:38:52.604969+10,10,0,125,partially correct
2314,"with exceptyoungest as 
(select distinct p.year_born from person p where p.year_born < 
(select max (p1.year_born) from (select distinct p.year_born from person p) p1))

select  id from person where year_born = (select max (year_born) from exceptyoungest);",2018-08-25 11:38:53.608435+10,3,1,274,correct
2315,"WITH psycho_app AS (SELECT DISTINCT * FROM appearance NATURAL JOIN role
WHERE production_year = 1960
AND lower(title) = 'psycho'),

app_count AS (SELECT id, COUNT(id) tot FROM psycho_app
GROUP BY id)

SELECT id FROM app_count 
WHERE tot = 1;
",2018-08-25 11:51:52.867239+10,10,1,25,correct
2316,;,2018-08-25 11:52:15.769322+10,4,0,237,noninterpretable
2317,"WITH movie_year AS (SELECT DISTINCT title,production_year FROM movie
WHERE (title,production_year)  NOT IN (


SELECT title,production_year FROM movie_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM crew_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM director_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM writer_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM actor_award
WHERE lower(result) = 'won'
))

SELECT COUNT(*) FROM movie_year

;",2018-08-25 11:58:43.114111+10,11,1,25,correct
2318,"SELECT DISTINCT a.id
FROM PERSON a
     INNER JOIN WRITER b
	ON a.id = b.id
WHERE a.year_born = 1935;",2018-08-25 12:05:36.158574+10,1,0,299,partially correct
2319,"select m.title, m.production_year
from movie m natural join writer w natural join person p
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-25 12:10:15.683899+10,5,1,237,correct
2320,"select country
from restriction 
where lower(title) = 'shakespeare in love'
and description = 'M';",2018-08-25 12:16:48.260229+10,6,1,237,correct
2321,"select id,first_name,last_name,min(year_born)
from person
group by year_born
limit 1;",2018-08-25 12:20:16.41766+10,7,0,237,partially correct
2322,"select id,first_name,last_name
from person
order by year_born desc
limit 1;
",2018-08-25 12:25:51.879638+10,7,1,237,correct
2323,"select ma.title,ma.production_year, p.first_name,p.last_name
from movie_award ma inner join director d on ma.title = d.title inner join person p on p.id = d.id
where ma.award_name='BAFTA Film Award'
and ma.category = 'Best Film';",2018-08-25 12:37:02.94981+10,8,0,237,partially correct
2324,"Select distinct Person.first_name,Person.last_name
from Person,Writer
Where Writer.id=Person.id and 
      Person.year_born=1935;",2018-08-25 12:46:10.483414+10,1,0,300,partially correct
2325,"select count(p.last_name)
from Person p
where exists(select * from writer where p.id=writer.id and p.year_born=1935 );",2018-08-25 12:59:12.524389+10,1,1,300,correct
2326,"select * 
from MOVIE
Where production_year=1993 or
      production_year=1992 or
      production_year=1991;
",2018-08-25 13:08:38.809573+10,2,0,300,partially correct
2327,"select production_year, count(title) 
from MOVIE
Where production_year=1993 or
      production_year=1992 or
      production_year=1991
Group by production_year;
",2018-08-25 13:10:29.189122+10,2,1,300,correct
2328,"select count(*)
from Person
where not exists(select * from director where Person.id=director.id);",2018-08-25 13:15:28.094636+10,12,1,300,correct
2329,"select count(*)
from  person as p
where exists (select * from writer as w where w.id=p.id and p.year_born=1935);",2018-08-25 13:25:53.34311+10,1,1,158,correct
2330,"Select p.first_name,p.last_name
from Person p, Director d, Movie m,Writer w
where d.title=m.title and
      d.production_year=m.production_year and
      d.id=w.id and
      d.id=p.id
group by p.first_name,p.last_name
having count(m.title)>=2;",2018-08-25 13:27:35.405337+10,4,0,300,partially correct
2331,"select count(*)
from person as p
where not exists (select * from director as d where d.id= p.id);",2018-08-25 13:29:32.319956+10,12,1,158,correct
2332,"Select p.id,p.first_name,p.last_name
from Person p, Director d, Movie m,Writer w
where d.title=m.title and
      d.production_year=m.production_year and
      d.id=w.id and
      d.id=p.id
group by p.id,p.first_name,p.last_name
having count(m.title)>2;",2018-08-25 13:31:12.561624+10,4,1,300,correct
2333,"select id 
from director natural join writer;",2018-08-25 13:35:04.3509+10,4,0,158,partially correct
2334,;,2018-08-25 13:39:02.315251+10,14,0,301,noninterpretable
2335,;,2018-08-25 13:41:00.193586+10,4,0,301,noninterpretable
2336,"select dw.id
from (director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-25 13:41:23.827541+10,4,0,158,partially correct
2337,"SELECT COUNT(*)
FROM WRITER LEFT JOIN PERSON ON WRITER.id=Person.id
WHERE year_born=1935;",2018-08-25 13:42:22.954787+10,1,0,199,partially correct
2338,"SELECT COUNT(year_born)
FROM PERSON,WRITER
WHERE year_born=1935 AND WRITER.id=PERSON.id;",2018-08-25 13:49:26.766556+10,1,0,303,partially correct
2339,"select title and production_year
from (writer natural join movie natural join person) as a 
where a.first_name=Kevin and a.last_name=Williamson;",2018-08-25 13:49:51.015799+10,5,0,158,noninterpretable
2340,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-25 13:50:45.090131+10,1,1,303,correct
2341,"SELECT Distinct q.id, p.first_name, p.last_name from Person p,
(Writer w
Inner Join 
Director d
on d.id = w.id and w.title = d.title) as q;

",2018-08-25 13:51:51.965733+10,4,0,71,partially correct
2342,"Select count(distinct p.id) from
Person p
Left Outer Join
Director d; ",2018-08-25 13:52:15.710383+10,12,0,71,partially correct
2343,"select title,production_year 
from writer, person
where writer.id = person.id
and first_name = 'Kevin'
and last_name='Williamson';",2018-08-25 13:55:05.056966+10,5,1,158,correct
2344,"SELECT count(*) 
FROM movie
WHERE EXISTS (SELECT * FROM movie WHERE production_year = 1992 AND production_year = 1992 AND production_year = 1992);",2018-08-25 13:55:52.082693+10,2,0,303,partially correct
2345,"Select * from
(Writer w
Natural Join
Person p 
Natural Join
Director d) as q
group by q.id
having Count(id) >1;",2018-08-25 13:56:36.188384+10,4,0,71,partially correct
2346,"Select q.id,p.first_name,p.last_name from
(Writer w
Natural Join
Person p 
Natural Join
Director d) as q
group by q.id
having Count(q.id) >1;",2018-08-25 13:57:43.194438+10,4,1,71,correct
2347,"Select w.title,w.production_year from 
(Writer w
Natural Join
Person p) as q
where q.first_name Like 'Kevin' and q.last_name Like 'Williamson';",2018-08-25 14:00:17.533692+10,5,1,71,correct
2348,"SELECT COUNT(*) AS Numberofmovies, production_year
FROM MOVIE
WHERE MOVIE.production_year = '1991' AND '1992' AND '1993'
GROUP BY production_year;",2018-08-25 14:00:25.766492+10,2,0,199,partially correct
2349,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-25 14:00:39.055611+10,2,1,303,correct
2350,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PEOPLE.year_born = '1935' AND WRITER.id = PERSON.id)
GROUP BY year_born;
",2018-08-25 14:01:05.450815+10,1,0,81,noninterpretable
2351,;,2018-08-25 14:01:12.130357+10,12,0,303,noninterpretable
2352,"Select country from Restriction
where description like 'M' and title like 'Shakespeare in Love';",2018-08-25 14:01:51.541015+10,6,1,71,correct
2353,;,2018-08-25 14:05:57.611685+10,7,0,71,noninterpretable
2354,"Select id, first_name, last_name from Person p
where p.year_born = (Select max(year_born) from Person q);",2018-08-25 14:06:59.100587+10,7,1,71,correct
2355,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-25 14:08:51.300173+10,12,1,303,correct
2356,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS (SELECT * FROM DIRECTOR WHERE DIRECTOR.id=PERSON.id);",2018-08-25 14:10:21.742659+10,12,1,199,correct
2357,"select country
from restriction
where title= 'Shakespeare in Love'
and description= 'M';",2018-08-25 14:13:41.322385+10,6,1,158,correct
2549,"SELECT COUNT(*) AS Numberofmovies, production_year
FROM MOVIE
WHERE production_year <= 1993
AND production_year >= 1991
GROUP BY production_year;

",2018-08-25 21:49:12.294972+10,2,1,199,correct
2358,"select count (*)
from writer_award wa natural join writer w natural join person p
where (wa.production_year >= '1991' and wa.production_year <='1995')
and (p.first_name ='Woody' and p.last_name = 'Allen');",2018-08-25 14:15:07.227865+10,9,1,237,correct
2359,"Select ma.title, ma.production_year, d.first_name, d.last_name from Movie_Award ma,
(Director d
Natural Join 
Person p) as d
where award_name like 'BAFTA Film Award' and category Like 'best film' and d.title = ma.title;",2018-08-25 14:16:25.837648+10,8,0,71,partially correct
2360,"SELECT count(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-25 14:17:00.380247+10,1,1,299,correct
2361,"Select ma.title, ma.production_year, d.first_name, d.last_name from Movie_Award ma,
(Director d
Natural Join 
Person p) as d
where award_name like 'BAFTA Film Award' and category Like 'best film' and d.title = ma.title and ma.result like 'won';",2018-08-25 14:18:25.679722+10,8,1,71,correct
2362,"select id, first_name, last_name, max(year_born)
from person;

",2018-08-25 14:20:46.482938+10,7,0,158,partially correct
2363,"select a.id, a.first_name, a.last_name
from (select id, first_name, last_name,max(year_born) as y
from person) as a;

",2018-08-25 14:23:22.365972+10,7,1,158,correct
2364,"select r.id
from scene s natural join movie m natural join role r
where s.scene_no = '1'
and lower (m.title)='psycho'
and m.production_year= '1960';",2018-08-25 14:23:25.92852+10,10,0,237,partially correct
2365,"select r.id
from scene s natural join movie m natural join role r
where s.scene_no = '1'
and m.title='Psycho'
and m.production_year= '1960';",2018-08-25 14:23:53.740412+10,10,0,237,partially correct
2366,;,2018-08-25 14:31:51.807908+10,11,0,237,noninterpretable
2367,;,2018-08-25 14:33:54.16939+10,3,0,237,noninterpretable
2368,"SELECT id, first_name, last_name
FROM PERSON RIGHT JOIN DIRECTOR ON PERSON.id=DIRECTOR.id 
WHERE EXSITS (SELECT id FROM DIRECTOR INNER JOIN WRITER ON DIRECTOR.id=WRITER.id GROUP BY DIRECTOR.id HAVING COUNT(*)>1);",2018-08-25 14:34:52.53555+10,4,0,199,noninterpretable
2369,"Select Count(c.title) from
(Person p
Natural Join
Writer w
Natural Join
Writer_Award) as c
where c.first_name like 'Woody' and c.last_name = 'Allen' and year_of_award <'1996' and year_of_award >'1990';",2018-08-25 14:35:51.401538+10,9,0,71,partially correct
2370,"select title, production_year,first_name,last_name
from movie_award as m, (director natural join person natural join movie_award) as h
where m.title=h.title
and m.production_year=h.production_year
and m.adward_name='BAFTA Film Award'
and m.category='Best Film';",2018-08-25 14:38:04.1578+10,8,0,158,noninterpretable
2371,"select id
from person
where year_born = (select max(year_born)
                   from person
				 where year_born < (select max(year_born)
                   from person ));",2018-08-25 14:38:04.176173+10,3,1,237,correct
2372,"select d.id,da.award_name,da.year_of_award
from director d, director_award da
where d.title=da.title
and lower(da.result)='nominated';",2018-08-25 14:52:36.814965+10,13,0,237,partially correct
2373,"SELECT title, production_year
FROM WRITER
WHERE EXISTS (SELECT first_name, last_name FROM PERSON NATURAL JOIN WRITER WHERE first_name = 'KEVIN' AND last_name = 'Williamson');",2018-08-25 14:57:54.450279+10,5,0,199,partially correct
2374,"select m.title, m.production_year,p.first_name p.last_name
from (select title, production_year 
from movie_award 
where lower(award_name)='bafta film award'
and lower(result)='won'
and lower(category)= 'best film')as m,
director as d,
person as p
where 
m.title =d.title and
m.production_year=d.production_year and
d.id=p.id;",2018-08-25 14:57:54.903956+10,8,0,158,noninterpretable
2375,"select m.title, m.production_year,p.first_name, p.last_name
from (select title, production_year 
from movie_award 
where lower(award_name)='bafta film award'
and lower(result)='won'
and lower(category)= 'best film')as m,
director as d,
person as p
where 
m.title =d.title and
m.production_year=d.production_year and
d.id=p.id;",2018-08-25 15:00:29.508119+10,8,1,158,correct
2376,"select a.count(*) 
from ( select id 
from writer_award
where year_of_award>1990 and year_of award<1996) as a,
person as p
where p.id=a.id and
p.lower(first_name)='woody' and
p.lower(last_name)='allen';",2018-08-25 15:10:22.977489+10,9,0,158,noninterpretable
2377,"select d.id,da.award_name,da.year_of_award,da.category
from director d, director_award da
where d.title=da.title
and lower(da.result)='nominated';",2018-08-25 15:18:05.613145+10,13,1,237,correct
2378,"SELECT r.country
FROM RESTRICTION r
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-25 15:19:19.564745+10,6,1,199,correct
2379,;,2018-08-25 15:32:28.024256+10,14,0,237,noninterpretable
2380,"select count(*) from writer_award w inner join person p on w.id = p.id 
where w.result = 'won' and w.year_of_award>1990 
and w.year_of_award<1996 and 
p.first_name ='Woody' and p.last_name ='Allen';",2018-08-25 15:48:25.144656+10,9,1,130,correct
2381,"SELECT production_year, COUNT(*) FROM movie p
WHERE p.production_year = 1993 OR p.production_year = 1992 OR p.production_year = 1991
GROUP BY production_year;",2018-08-25 15:52:46.955902+10,2,1,299,correct
2382,"select distinct r.id from role r inner join scene s on r.title = s.title 
inner join person p on r.id = p.id
where s.title = 'Psycho' and s.production_year=1960;",2018-08-25 16:04:54.051477+10,10,0,130,partially correct
2383,"select distinct r.id from role r inner join scene s on r.title = s.title and r.production_year = s.production_year
inner join person p on r.id = p.id
where s.title = 'Psycho' and s.production_year=1960;",2018-08-25 16:06:16.697849+10,10,0,130,partially correct
2384,"SELECT COUNT(*) FROM person p
WHERE p.id NOT IN (SELECT id FROM director); ",2018-08-25 16:06:46.229655+10,12,1,299,correct
2385,;,2018-08-25 16:24:08.084179+10,15,0,237,noninterpretable
2386,"select distinct r.id from role r , scene s, appearance a 
where
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
group by 
r.id
having count(*) = 1;",2018-08-25 16:32:05.523415+10,10,1,130,correct
2387,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
Select ma.title,ma.production_year
FROM movie_award ma
WHERE m.title = ma.title
AND m.production_year = ma.production_year
AND lower(ma.result) = 'won'
UNION
Select ca.title,ca.production_year
FROM crew_award ca
WHERE m.title = ca.title
AND m.production_year = ca.production_year
AND lower(ca.result) = 'won'
UNION
Select da.title,da.production_year
FROM director_award da
WHERE m.title = da.title
AND m.production_year = da.production_year
AND lower(da.result) = 'won'
UNION
Select wa.title,wa.production_year
FROM writer_award wa
WHERE m.title = wa.title
AND m.production_year = wa.production_year
AND lower(wa.result) = 'won'
UNION
Select aa.title,aa.production_year
FROM actor_award aa
WHERE m.title = aa.title
AND m.production_year = aa.production_year
AND lower(aa.result) = 'won'

) ;",2018-08-25 16:58:25.029834+10,11,1,68,correct
2388,"
SELECT Distinct id
FROM role
WHERE title = 'Psycho' 
AND production_year = 1960;",2018-08-25 17:00:12.086311+10,10,0,173,partially correct
2389,"select *
from person
where year_born=1935;",2018-08-25 17:00:43.183394+10,1,0,298,partially correct
2390,"select count(*)
from person
where year_born=1935;",2018-08-25 17:01:23.870708+10,1,0,298,partially correct
2391,"SELECT COUNT(*) FROM MOVIE m
	WHERE m.title NOT IN (SELECT title FROM MOVIE_AWARD)
	AND m.title NOT IN (SELECT title FROM  CREW_AWARD)
	AND m.title NOT IN (SELECT title FROM DIRECTOR_AWARD)
	AND m.title NOT IN (SELECT title FROM WRITER_AWARD)
	AND m.title NOT IN (SELECT title FROM ACTOR_AWARD);",2018-08-25 17:03:37.048011+10,11,0,26,partially correct
2392,"select count(*)
from person p
where exists (select * from writer w where p.year_born=1935 and p.id=w.id);",2018-08-25 17:08:13.874583+10,1,1,298,correct
2393,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE MIN p.year_born;",2018-08-25 17:11:28.972593+10,7,0,290,noninterpretable
2394,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE EXISTS (
SELECT MAX (p1.year_born)
FROM PERSON p1);",2018-08-25 17:13:44.680724+10,7,0,290,partially correct
2427,"SELECT title, production_year
FROM movie m INNER JOIN (SELECT * FROM person p WHERE p.id=director.id) AS pd ON m.title=pd.title
GROUP BY title, production_year
HAVING first_name=Kevin AND last_name=Williamson;",2018-08-25 18:01:58.753758+10,5,0,204,noninterpretable
2395,"SELECT count(*) FROM MOVIE m
	WHERE NOT EXISTS (SELECT title, production_year FROM MOVIE_AWARD ma WHERE lower(ma.result) ='won' AND m.title = ma.title AND m.production_year = ma.production_year
	UNION SELECT title, production_year FROM  CREW_AWARD ca WHERE lower(result) ='won' AND m.title = ca.title AND m.production_year = ca.production_year
	UNION SELECT title, production_year FROM DIRECTOR_AWARD da WHERE lower(result) ='won' AND m.title = da.title AND m.production_year = da.production_year
	UNION SELECT title, production_year FROM WRITER_AWARD wa WHERE lower(result) ='won' AND m.title = wa.title AND m.production_year = wa.production_year
	UNION SELECT title, production_year FROM ACTOR_AWARD aa WHERE lower(result) ='won' AND m.title = aa.title AND m.production_year = aa.production_year);",2018-08-25 17:15:49.82041+10,11,1,26,correct
2396,SELECT count(*) FROM person p WHERE EXISTS(SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);,2018-08-25 17:15:57.754535+10,1,1,36,correct
2397,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE EXISTS (
SELECT MAX (p1.year_born)
FROM PERSON p1);",2018-08-25 17:17:53.528374+10,7,0,290,partially correct
2398,"SELECT COUNT(*)
FROM person p
WHERE NO EXISTS (SELECT * FROM directore d WHERE w.id=p.id);",2018-08-25 17:21:22.013172+10,12,0,204,noninterpretable
2399,SELECT count(*) FROM director d WHERE EXISTS(SELECT * FROM director d WHERE d.id = d.id);,2018-08-25 17:21:44.160394+10,2,0,36,partially correct
2400,select count(*) from movie;,2018-08-25 17:23:17.549592+10,11,0,130,partially correct
2401,"select count(*)
from person p
where p.id in (select w.id from writer w where p.year_born=1935 and p.id=w.id);",2018-08-25 17:24:23.841641+10,1,1,298,correct
2402,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-25 17:24:33.559339+10,2,1,36,correct
2403,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id=p.id);",2018-08-25 17:24:49.74602+10,12,1,204,correct
2404,SELECT count(*) FROM person p WHERE EXISTS(SELECT * FROM director d WHERE d.id = p.id);,2018-08-25 17:29:13.650719+10,12,0,36,partially correct
2405,"SELECT id, first_name, last_name count(director)
FROM director d, writer w
WHERE d.id=w.id
GROUP BY id, first_name, last_name
HAVING count(director)>=2;",2018-08-25 17:30:40.296326+10,4,0,204,noninterpretable
2406,SELECT count(*) FROM person p WHERE NOT EXISTS(SELECT * FROM director d WHERE d.id = p.id);,2018-08-25 17:31:10.8452+10,12,1,36,correct
2407,"select count(*) from person
where id in (select id from writer)
  and year_born = 1935;",2018-08-25 17:31:13.23311+10,1,1,116,correct
2408,"SELECT p.first_name, p.last_name, r.id, r.title, r.production_year, r.description
FROM (SELECT MAX(a)FROM(Select count(role.id) AS a
From role
GROUP BY role.id)) AS b, person p, role r
WHERE b.id = p.id and r.id=p.id;


",2018-08-25 17:31:25.156413+10,15,0,120,noninterpretable
2409,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-25 17:33:06.197693+10,4,1,204,correct
2410,"select production_year, count(production_year)
from movie
where production_year in (1993,1992,1991);",2018-08-25 17:35:16.829329+10,2,0,298,partially correct
2411,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-25 17:35:57.163063+10,2,1,298,correct
2412,"select production_year, count(*)
from movie
group by production_year
having production_year in (1993, 1992, 1991);",2018-08-25 17:37:44.247834+10,2,1,116,correct
2413,"SELECT id, count(*) FROM person p WHERE EXISTS(SELECT * FROM director d WHERE p.id = d.id);",2018-08-25 17:37:59.26031+10,4,0,36,partially correct
2414,"select count(*)
from person p
where not exists (select * from director d where p.id=d.id);",2018-08-25 17:38:42.755965+10,12,1,298,correct
2415,"select count(*)
from person
where id not in (select id from director);",2018-08-25 17:40:30.209897+10,12,1,116,correct
2416,"SELECT p.id
FROM 
person p, 
role r

WHERE p.id = r.id
AND lower(r.title)= 'psycho'
AND r.production_year = 1960
AND r.description in
(
SELECT description
FROM appearance
WHERE lower(title) = 'psycho' 
AND production_year = 1960
GROUP BY description
HAVING count(description)=1 ) ;",2018-08-25 17:40:45.780277+10,10,1,173,correct
2417,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-25 17:41:23.031246+10,4,1,36,correct
2418,"select p.id, p.first_name,p.last_name
from person p
where exists (select count(*) from director d where exists ( select count(*) from writer w where w.id=d.id));",2018-08-25 17:52:31.057573+10,4,0,298,partially correct
2419,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM  person p, role r,
	(SELECT
            max(number_of_roles)
        FROM (SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a

	WHERE r.id = p.id AND a.id = p.id ;",2018-08-25 17:54:16.661182+10,15,0,120,noninterpretable
2420,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM  person p, role r,
	(SELECT
            max(number_of_roles)
        FROM (SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a

	WHERE r.id = p.id AND a.id = p.id ;",2018-08-25 17:54:32.336679+10,15,0,120,noninterpretable
2421,"SELECT COUNT( *)
FROM movie
WHERE (title,production_year) NOT IN
(SELECT title, production_year 
FROM MOVIE_AWARD
WHERE lower(result) = 'won')

AND (title,production_year) NOT IN
(SELECT title, production_year 
FROM CREW_AWARD
WHERE lower(result) = 'won')

AND (title,production_year) NOT IN
(SELECT title, production_year 
FROM DIRECTOR_AWARD
WHERE lower(result) = 'won')

AND(title,production_year) NOT IN
(SELECT title, production_year 
FROM WRITER_AWARD
WHERE lower(result) = 'won')

AND (title,production_year) NOT IN
(SELECT title, production_year 
FROM ACTOR_AWARD
WHERE lower(result) = 'won');",2018-08-25 17:56:15.469219+10,11,1,173,correct
2422,"select dw.id, dw.first_name,dw.last_name
from (person natural join director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-25 17:57:23.502245+10,4,1,298,correct
2423,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-25 17:58:29.311106+10,11,1,130,correct
2424,"select id, first_name, last_name
from person
where id in (select id
             from (select id, count(*)
                   from director natural join writer
                   group by id having count(*) > 1 ) as a);",2018-08-25 17:59:10.350243+10,4,1,116,correct
2425,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM  person p, role r,
	(SELECT
            id, max(number_of_roles)
        FROM (SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS b) AS c

	WHERE r.id = p.id AND c.id = p.id ;",2018-08-25 17:59:15.283502+10,15,1,120,correct
2426,"SELECT fname, lname FROM employee, dept_location WHERE dno = dnumber AND dlocation = 'Canberra';
",2018-08-25 18:00:11.981474+10,1,0,306,noninterpretable
2545,"select dw.id, dw.first_name, dw.last_name from (person natural join director natural join writer) dw group by dw.id having count(*) > 1;",2018-08-25 21:38:53.380379+10,4,1,46,correct
2428,"Select Count(c.title) from
(Person p
Natural Join
Writer w
Natural Join
Writer_Award) as c
where c.first_name like 'Woody' and c.last_name = 'Allen' and year_of_award <'1996' and year_of_award >'1990';",2018-08-25 18:04:31.404097+10,9,0,71,partially correct
2429,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person 
		);",2018-08-25 18:04:40.708308+10,7,1,120,correct
2430,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born IN (
        SELECT
            max(year_born)
        FROM
            person 
		);",2018-08-25 18:05:01.346876+10,7,1,120,correct
2431,"Select Count(c.title) from
(Person p
Natural Join
Writer w
Natural Join
Writer_Award) as c
where c.first_name like 'Woody' and c.last_name = 'Allen' and year_of_award <'1996' and year_of_award >'1990' and lower(result) like 'won';",2018-08-25 18:05:25.630821+10,9,1,71,correct
2432,"select m.title, m.production_year
from movie m
where  exists (select * 
              from writer natural join person p 
              where p.first_name='Kevin' and p.last_name='Williamson');",2018-08-25 18:07:39.605987+10,5,0,298,partially correct
2433,"select m.title, m.production_year
from movie m
where  m.title in (select w.title
              from writer w natural join person p 
              where p.first_name='Kevin' and p.last_name='Williamson');",2018-08-25 18:09:18.214318+10,5,1,298,correct
2434,"SELECT q.* from 
(Select description, Count(description) from APPEARANCE
where title = 'Psycho' and production_year = '1960'
group by description
having Count(description) = 1) as q;
",2018-08-25 18:11:54.080307+10,10,0,71,partially correct
2435,"select country
from Restriction
where title='Shakespeare in Love' and  description='M';",2018-08-25 18:12:54.323557+10,6,1,298,correct
2436,"select title, production
from writer natural join person
where first_name = Kevin
  and last_name = Williamson;",2018-08-25 18:13:38.540954+10,5,0,116,noninterpretable
2437,"select title, production_year
from writer natural join person
where first_name = 'Kevin'
  and last_name = 'Williamson';",2018-08-25 18:14:48.308389+10,5,1,116,correct
2438,"select id,first_name,last_name,min(year_born)
from person;

",2018-08-25 18:19:00.610282+10,7,0,298,partially correct
2439,"select id,first_name,last_name,max(year_born)
from person;

",2018-08-25 18:20:17.841435+10,7,0,298,partially correct
2440,"SELECT title, production_year ,count(*) FROM movie WHERE d.id = kevin Williamson;",2018-08-25 18:20:29.158336+10,5,0,36,noninterpretable
2441,"SELECT j.id, j.description from
((Select title, description, Count(description), scene_no from APPEARANCE a
where title = 'Psycho' and production_year = '1960'
group by description
having Count(description) = 1) as q
Inner Join
Role r
on q.description = r.description and r.title = 'Psycho' and r.production_year = '1960') as j
where q.scene_no = j.scene_no;",2018-08-25 18:22:25.30027+10,10,0,71,partially correct
2442,"SELECT j.id from
((Select title, description, Count(description), scene_no from APPEARANCE a
where title = 'Psycho' and production_year = '1960'
group by description
having Count(description) = 1) as q
Inner Join
Role r
on q.description = r.description and r.title = 'Psycho' and r.production_year = '1960') as j
where q.scene_no = j.scene_no;",2018-08-25 18:22:41.38563+10,10,1,71,correct
2443,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-25 18:23:49.252096+10,5,1,36,correct
2444,"select country
from restriction
where lower(title) = 'shakespeare in love'
  and lower(description) = 'm';",2018-08-25 18:24:42.036333+10,6,1,116,correct
2445,"select id,first_name,last_name
from person p
where p.year_born=(select max(year_born)
                   from person);",2018-08-25 18:26:07.483741+10,7,1,298,correct
2446,"select p.id from person p where p.year_born > (select Min(year_born) from person)
ORDER BY p.year_born
;",2018-08-25 18:26:51.286985+10,3,0,130,partially correct
2447,"SELECT id
FROM person
WHERE year_born = 
(
SELECT MAX(year_born)
FROM person
WHERE year_born<
	(
	SELECT MAX(year_born)
	FROM person
	)
);",2018-08-25 18:28:12.077292+10,3,1,173,correct
2448,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-25 18:31:10.949036+10,7,1,116,correct
2449,"select p.id from person p where p.year_born = (select Max(year_born) 
from person where year_born < (select Max(year_born) from person));",2018-08-25 18:32:06.847483+10,3,1,130,correct
2450,"select p.id, da.award_name,da.year_of_award,da.category from person p, director_award da 
where da.result = 'nominated';",2018-08-25 18:42:07.706563+10,13,0,130,partially correct
2451,"SELECT  MAX(year_born)
FROM PERSON
GROUP BY id, first_name, last_name;",2018-08-25 18:44:24.853218+10,7,0,199,partially correct
2452,"SELECT id, first_name, last_name
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born) FROM PERSON);",2018-08-25 18:46:22.016152+10,7,1,199,correct
2453,"SELECT country, count(*) FROM;",2018-08-25 18:48:34.839685+10,6,0,36,noninterpretable
2454,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join director natural join person p
where lower(ma.award_name) = 'bafta film award'
  and lower(ma.category) = 'best film';",2018-08-25 18:50:22.125388+10,8,0,116,partially correct
2455,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-25 18:50:28.505922+10,6,1,36,correct
2456,SELECT * FROM;,2018-08-25 18:51:42.162454+10,7,0,36,noninterpretable
2457,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join director natural join person p
where lower(ma.award_name) = 'bafta film award'
  and lower(ma.category) = 'best film'
  and lower(ma.result) = 'won';",2018-08-25 18:52:24.330701+10,8,1,116,correct
2458,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-25 19:01:49.530116+10,7,1,36,correct
2459,young;,2018-08-25 19:07:08.529333+10,3,0,146,noninterpretable
2460,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-25 19:09:53.475437+10,3,1,146,correct
2461,award;,2018-08-25 19:12:35.706557+10,13,0,146,noninterpretable
2462,"select d.id, da.award_name,da.year_of_award,da.category from director d, director_award da 
where  da.title = d.title
AND da.production_year = d.production_year
AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-25 19:13:29.994326+10,13,1,130,correct
2463,select p.id from person p;,2018-08-25 19:18:56.344331+10,14,0,130,partially correct
2464,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-25 19:21:49.346785+10,13,1,146,correct
2465,id;,2018-08-25 19:22:36.705371+10,14,0,146,noninterpretable
2466,"select m.title, m.production_year,pw.last_name
from movie_award m, (person natural join writer) as pw
where  m.award_name='BAFTA Film Award';",2018-08-25 19:24:25.207086+10,8,0,298,partially correct
2467,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-25 19:25:23.593844+10,14,1,146,correct
2468,lar;,2018-08-25 19:26:23.407252+10,15,0,146,noninterpretable
2546,"select count(*)
from person p natural join 
(select distinct writer.id from writer) w 
where p.year_born=1935;",2018-08-25 21:43:33.316392+10,1,1,270,correct
2469,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
",2018-08-25 19:28:14.207965+10,14,1,130,correct
2470,"select count(*) ,production_year
from movie m
where  production_year >= 1991
and  production_year<=1993
group by production_year ;",2018-08-25 19:37:02.838248+10,2,1,265,correct
2471,"SELECT production_year,COUNT(*)
FROM MOVIE 
GROUP BY production_year HAVING production_year BETWEEN 1991 AND 1993;",2018-08-25 19:37:11.426371+10,2,1,182,correct
2472,"select p.first_name,p.last_name,r.description from person p, role r
where p.id = r.id and r.count(*) = (select max(count(*)) from role group by role.id);",2018-08-25 19:40:47.839703+10,15,0,130,noninterpretable
2473,"

select count(*)
from writer_award wa, person p
where p.id = wa.id and lower(p.first_name)='woody' AND lower(p.last_name)='allen' 
and year_of_award >1990 AND year_of_award < 1995;",2018-08-25 19:52:01.764237+10,9,1,120,correct
2474,"select count(*)
from person p
where exists (select * from director d 
where d.id != p.id);",2018-08-25 19:57:17.425681+10,12,0,265,partially correct
2475,"select a.id as id_1, b.id as id_2, a.title, a.production_year, count (*) from writer a inner 
join writer b on a.title = b.title and a.production_year = b.production_year and a.id != b.id group by a.production_year, a.title;




",2018-08-25 19:57:19.222009+10,11,0,151,partially correct
2476,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-25 20:00:07.32662+10,15,1,130,correct
2477,freight bill;,2018-08-25 20:05:57.792383+10,15,0,290,noninterpretable
2478,"SELECT d.title, a.production_year, first_name, last_name
FROM DIRECTOR d NATURAL JOIN MOVIE NATURAL JOIN MOVIE_AWARD a NATURAL JOIN PERSON
WHERE a.award_name = 'BAFTA' AND a.category = 'Best Film';",2018-08-25 20:08:23.063423+10,8,0,199,partially correct
2479,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) ;",2018-08-25 20:08:49.758564+10,15,0,290,noninterpretable
2480,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) );",2018-08-25 20:09:38.391224+10,15,1,290,correct
2481,Select count(*) from person where not Exists (select * from director where director.id = person.id);,2018-08-25 20:11:06.513652+10,12,1,31,correct
2482,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-25 20:21:43.359788+10,4,1,182,correct
2483,"SELECT COUNT(*) AS Numberofawards
FROM CREW_AWARD
WHERE CREW_AWARD.id = (SELECT id FROM PERSON WHERE firsi_name = 'Woody AND last_name = 'Allen');
",2018-08-25 20:22:09.533339+10,9,0,199,noninterpretable
2484,"select first_name ,last_name
from person p
where exists (select * from director d
                        where p.id = d.id
                        )
group by first_name,last_name
having count(*) >1;
",2018-08-25 20:27:43.816141+10,4,0,265,partially correct
2485,"SELECT M.TITLE,M.PRODUCTION_YEAR
FROM MOVIE M
INNER JOIN WRITER W ON M.TITLE=W.TITLE
INNER JOIN PERSON P ON W.ID=P.ID
WHERE P.FIRST_NAME=""Kevin"" AND P.LAST_NAME=""Williamson"";",2018-08-25 20:29:01.442893+10,5,1,182,correct
2486,"SELECT COUNT(*) AS Numberofawards
FROM WRITER_AWARD wa, WRITER w, PERSON p
WHERE w.id = p.id
AND wa.title = w.title
AND wa.production_year = w.production_year
AND wa.result = 'won'
AND year_of_award >= 1991
AND year_of_award <= 1995
AND p.first_name = 'Woody'
AND p.last_name = 'Allen';",2018-08-25 20:30:34.174352+10,9,1,199,correct
2487,"select title, production_year
from writer w
inner join person p
on p.id = w.id
where p. first_name = 'Kevin'
and   p.last_name = 'Williamson';",2018-08-25 20:34:54.365367+10,5,1,265,correct
2488,"SELECT COUNT(year_born) AS b_num
FROM (
SELECT year_born
FROM person AS p, writer AS w
WHERE p.id=w.id
AND year_born=1935) AS wb;

",2018-08-25 20:36:39.036815+10,1,0,312,partially correct
2489,"SELECT COUNT(year_born) AS b_num
FROM (
SELECT year_born
FROM person AS p, writer AS w
WHERE p.id=w.id
AND year_born=1935) AS wb;

",2018-08-25 20:36:49.779631+10,1,0,312,partially correct
2490,"SELECT id
FROM ROLE r, APPEARANCE a
WHERE a.title = r.title
AND a.production_year = r.production_year
AND a.description = r.description
AND a.title = 'Psycho'
AND a.production_year = 1960
AND a.scene_no = 1;",2018-08-25 20:38:01.519586+10,10,0,199,partially correct
2491,"SELECT COUNT(*) AS b_num
FROM (
SELECT year_born
FROM person AS p, writer AS w
WHERE p.id=w.id
AND p.year_born=1935) AS wb;

",2018-08-25 20:38:01.816128+10,1,0,312,partially correct
2492,"SELECT COUNT(*) AS b_num
FROM (
SELECT *
FROM person AS p, writer AS w
WHERE p.id=w.id
AND p.year_born=1935) AS wb;

",2018-08-25 20:39:50.211664+10,1,0,312,partially correct
2493,"select country 
from Restriction
where description = 'M'
and title = 'Shakespeare in Love';",2018-08-25 20:41:15.857574+10,6,1,265,correct
2494,"SELECT COUNT(id) FROM WRITER 
WHERE id in 
(SELECT id FROM PERSON WHERE year_born=1935);",2018-08-25 20:41:18.955329+10,1,0,48,partially correct
2495,"
WHERE year_born=1935;",2018-08-25 20:43:32.571715+10,1,0,312,noninterpretable
2496,"
WHERE year_born=1935;",2018-08-25 20:43:41.36766+10,1,0,312,noninterpretable
2497,"Select title from Movie
where NOT EXISTS (Select title from
Movie_award
UNION Select title From
Crew_award
UNION Select title From
Director_award
UNION Select title From
Writer_award
UNION Select title From
Actor_award 
where title is not null);",2018-08-25 20:44:39.998096+10,11,0,71,partially correct
2498,"SELECT count(*) FROM PERSON WHERE EXISTS (SELECT * FROM WRITER WHERE 
 WRITER.id=PERSON.id and PERSON.year_born=1935);",2018-08-25 20:45:39.307644+10,1,1,48,correct
2499,"SELECT r.id
FROM ROLE r, APPEARANCE a, scene s
WHERE a.title = s.title
AND s.title = r.title
AND a.production_year = s.production_year
AND a.scene_no = s.scene_no
AND a.description = s.description
AND s.production_year = r.production_year
AND a.description = r.description
AND a.title = 'Psycho'
AND a.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-25 20:47:43.180136+10,10,0,199,partially correct
2547,"SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-25 21:43:41.552873+10,1,1,199,correct
2500,"SELECT r.id
FROM ROLE r, APPEARANCE a, scene s
WHERE s.title = a.title
AND s.title = r.title
AND s.production_year = a.production_year
AND s.scene_no = a.scene_no
AND a.description = s.description
AND s.production_year = r.production_year
AND a.description = r.description
AND a.title = 'Psycho'
AND a.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-25 20:49:21.142183+10,10,0,199,partially correct
2501,"select production_year, count(production_year) 
from movie where production_year=1993 or 
production_year=1992 or production_year=1991 
group by production_year;",2018-08-25 20:53:20.868394+10,2,1,48,correct
2502,"SELECT production_year,count(*) FROM MOVIE GROUP BY production_year WHERE production_year = 1991;",2018-08-25 20:54:00.557573+10,2,0,46,noninterpretable
2503,"SELECT COUNT(year_born) 
FROM (
SELECT DISTINCT year_born, p.id
FROM person AS p, writer AS w
WHERE p.id=w.id
AND year_born=1935
) AS wb;


",2018-08-25 20:54:38.094196+10,1,1,312,correct
2504,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM person p
INNER join director d ON p.id=d.id
INNER join movie_award m ON d.title=m.title
WHERE m.award_name='BAFTA Film Award' AND m.category='best film' AND m.result='won';",2018-08-25 20:54:43.144655+10,8,1,182,correct
2505,"SELECT production_year,count(*) FROM MOVIE WHERE production_year >= 1991 AND production_year <= 1993 GROUP BY production_year;",2018-08-25 20:56:27.648806+10,2,1,46,correct
2506,"SELECT COUNT(*)
FROM MOVIE_AWARD ma, CREW_AWARD ca, DIRECTOR_AWARD da, WRITER_AWARD wa, ACTOR_AWARD aa
WHERE ma.result = 'lost'
AND ca.result = 'lost'
AND da.result = 'lost'
AND wa.result = 'lost'
AND aa.result = 'lost';",2018-08-25 20:57:19.689953+10,11,0,199,partially correct
2507,"select count(*) from person where
not exists (select * from director where person.id=director.id);",2018-08-25 20:58:07.654145+10,12,1,48,correct
2508,SELECT COUNT(*) FROM PERSON P WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id=d.id);,2018-08-25 21:00:03.017271+10,12,1,46,correct
2509,SELECT COUNT(*) FROM PERSON p WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id=d.id);,2018-08-25 21:00:24.452172+10,12,1,46,correct
2510,"
;",2018-08-25 21:01:42.761266+10,3,0,71,noninterpretable
2511,"SELECT COUNT(*) as number_of_award
FROM WRITER_AWARD W
INNER JOIN PERSON P ON W.ID=P.ID
WHERE P.FIRST_NAME=""Woody"" AND P.LAST_NAME=""Allen"" AND w.year_of_award between 1991 and 1995 AND W.RESULT=""won"";
",2018-08-25 21:02:42.966757+10,9,1,182,correct
2512,"SELECT id
FROM PERSON p;",2018-08-25 21:03:39.553949+10,3,0,199,partially correct
2513,"SELECT p.id, p.year_born FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
FROM person 
WHERE year_born < (SELECT MAX(year_born) 
FROM person));",2018-08-25 21:04:03.702817+10,3,0,71,partially correct
2514,"SELECT p.id FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
FROM person 
WHERE year_born < (SELECT MAX(year_born) 
FROM person));",2018-08-25 21:04:14.191909+10,3,1,71,correct
2515,"select count(*)
from person p
where exists (select * from writer w where w.id = p.id and year_born = 1935);",2018-08-25 21:06:01.942236+10,1,1,72,correct
2516,"select count(*) from movie m
where m.production_year in (1991,1992,1993);",2018-08-25 21:07:06.227903+10,2,0,72,partially correct
2517,"select production_year, count(*) from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-25 21:07:58.768728+10,2,1,72,correct
2518,"SELECT id
FROM PERSON p
WHERE year_born = (SELECT MAX(year_born) FROM PERSON WHERE year_born < (SELECT MAX(year_born) FROM PERSON));",2018-08-25 21:08:43.793687+10,3,1,199,correct
2519,"select count(*) from person p
where not exists(select * from director d where p.id = d.id);",2018-08-25 21:09:14.158117+10,12,1,72,correct
2520,;,2018-08-25 21:09:55.10222+10,4,0,46,noninterpretable
2521,"SELECT d.id from Director d, DIRECTOR_AWARD da
where da.result like 'nominated' and d.title = da.title;
",2018-08-25 21:10:12.076349+10,13,0,71,partially correct
2522,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-25 21:10:58.677368+10,8,1,298,correct
2523,"SELECT d.id, da.award_name, da.year_of_award,da.category from Director d, DIRECTOR_AWARD da, Person p
where da.result like 'nominated' and d.title = da.title and d.id = p.id;
",2018-08-25 21:11:02.620608+10,13,1,71,correct
2524,"select id, first_name, last_name
from writer natural join person natural join director
group by id
having count(*) > 1;",2018-08-25 21:11:11.22384+10,4,1,72,correct
2525,"select title, production_year
from movie natural join writer natural join person
where lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-25 21:13:28.863853+10,5,1,72,correct
2526,"SELECT id, award_name, year_of_award, category
FROM  DIRECTOR_AWARD da, DIRECTOR d
WHERE da.title = d.title
AND da.production_year = d.production_year
AND da.result = 'nominated'
GROUP BY id
HAVING COUNT(*) >= 1;",2018-08-25 21:15:46.130919+10,13,1,199,correct
2527,"select id, first_name, last_name as year
from person p;",2018-08-25 21:16:12.651926+10,7,0,265,partially correct
2528,"select id, first_name,last_name from person  natural join director natural join writer 
group by id having count(*)>1;",2018-08-25 21:16:31.164278+10,4,1,48,correct
2529,"Select id,MAX(COUNT(title) from 
(Director d
Natural Join
Writer w) as c
group by id;

",2018-08-25 21:19:24.791091+10,14,0,71,noninterpretable
2530,"select w.id, count(*) as count from writer w inner join director d on w.id=d.id group by d.id having count > 1;",2018-08-25 21:26:21.813995+10,4,0,46,partially correct
2531,select country from restriction where lower(title) = 'shakespeare in love' and lower(description) = 'm';,2018-08-25 21:26:21.850164+10,6,1,72,correct
2532,"select id, first_name, last_name
from person where year_born = (select max(year_born) from person);",2018-08-25 21:27:49.133919+10,7,1,72,correct
2533,"SELECT id 
FROM PERSON p, WRITER w, DIRECTOR d, MOVIR m
WHERE w.id = p.id
AND d.id = p.id
AND w.title = m.title
AND w.production_year = m.production_year
AND d.title = m.title
AND d.production_year = m.production_year;",2018-08-25 21:28:13.196009+10,14,0,199,noninterpretable
2534,"select w.id, p.first_name, p.last_name,count(*) as count from writer w inner join director d on w.id=d.id inner join person p on p.id = w.id group by d.id having count > 1;",2018-08-25 21:28:54.327271+10,4,0,46,partially correct
2535,"select w.id, p.first_name, p.last_name,count(*) as count from writer w inner join director d on w.id=d.id inner join person p on p.id = w.id group by d.id having count > 2;",2018-08-25 21:30:32.926331+10,4,0,46,partially correct
2536,"select title, production_year, first_name, last_name from movie_award natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result = 'won'
group by title;",2018-08-25 21:30:43.24134+10,8,0,72,partially correct
2537,"select title, production_year, first_name, last_name from movie_award natural join director natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result = 'won';",2018-08-25 21:31:46.149375+10,8,1,72,correct
2538,"SELECT first_name, last_name, title, production_year, description;",2018-08-25 21:33:03.240069+10,15,0,199,noninterpretable
2539,"select count(*) 
from writer_award natural join writer natural join person
where lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= 1991 and year_of_award <= 1995 and lower(result) = 'won';",2018-08-25 21:34:31.403874+10,9,1,72,correct
2540,"select count(*)
from writer natural join person
where person.year_born=1935;",2018-08-25 21:34:49.945744+10,1,0,270,partially correct
2541,"select id
from role natural join appearance
where lower(title) = 'psycho' and production_year = 1960
group by id
having count(*) = 1;",2018-08-25 21:36:04.637288+10,10,1,72,correct
2542,"SELECT COUNT(*)
FROM PERSON p, WRITER w
WHERE p.id = w.id
AND p.year_born = 1935;",2018-08-25 21:37:26.46794+10,1,0,199,partially correct
2543,"select dw.id, dw.first_name, dw.last_name, count(*) as count from (person natural join director natural join writer) dw group by dw.id having count > 1;",2018-08-25 21:37:51.900548+10,4,0,46,partially correct
2544,"select dw.id, dw.first_name, dw.last_name, count(*) as count from (person natural join director natural join writer) dw group by dw.id having count > 1;",2018-08-25 21:38:09.983019+10,4,0,46,partially correct
2550,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-25 21:49:55.418964+10,2,1,107,correct
2551,"SELECT COUNT(*)
FROM MOVIE M
WHERE NOT EXISTS( SELECT * FROM MOVIE_AWARD MA, CREW_AWARD CA, DIRECTOR_AWARD DA, WRITER_AWARD WA,ACTOR_AWARD AA
	WHERE LOWER(MA.RESULT)='WON' OR LOWER(CA.RESULT)='WON' OR LOWER(DA.RESULT)='WON' OR LOWER(AA.RESULT)='WON'OR LOWER(WA.RESULT)='WON');
",2018-08-25 21:51:43.927734+10,11,0,182,partially correct
2552,"select id
from person
where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-25 21:52:46.112896+10,3,1,72,correct
2553,"with dm as 
(select  m.title, m.production_year ,d.first_name,d.last_name
from movie_award  m inner join director d on m.title = d.title)
select m.title, m.production_year ,d.first_name,d.last_name
from dm
where award_name ='BAFTA Film Award'
and category = 'Best Film';",2018-08-25 21:55:30.775635+10,8,0,265,noninterpretable
2554,"select id, award_name, year_of_award, category
from director natural join director_award
where lower(result) = 'nominated' and lower(result) != 'won';",2018-08-25 21:56:23.570255+10,13,1,72,correct
2555,"  select distinct id, count(*)
  from 
  Writer w natural join Person p
  where p.year_born = 1935;",2018-08-25 21:56:40.717938+10,1,0,254,partially correct
2556,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-25 21:57:35.986276+10,1,1,254,correct
2557,"select production_year, count(*) as noofmovies from movie where production_year>1990 and production_year<1994 group by production_year;",2018-08-25 22:00:41.037612+10,2,1,270,correct
2558,"SELECT d.id, first_name, last_name
FROM PERSON p, DIRECTOR d, WRITER r
WHERE p.id = d.id
AND p.id = r.id
AND d.id = r.id
GROUP BY p.id
HAVING COUNT(*)>1;",2018-08-25 22:00:42.670243+10,4,0,199,partially correct
2559,;,2018-08-25 22:03:24.058091+10,4,0,303,noninterpretable
2560,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p
	natural join
	role r
where p.id = 


(select p1.id
from person p1 
	natural join
	role r2
group by p1.id
having count(*) = 
			(select max(ha.count) from (select count(*) as count
			from role r3
			group by r3.id) as ha));",2018-08-25 22:03:27.126441+10,15,1,43,correct
2561,"SELECT id, first_name, last_name
FROM PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER 
GROUP BY id
HAVING COUNT(*)>1;",2018-08-25 22:03:31.459639+10,4,1,199,correct
2562,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-25 22:03:53.217182+10,4,1,303,correct
2563,select count(*) from person p where not exists (select * from director d where p.id=d.id);,2018-08-25 22:06:52.167635+10,12,1,270,correct
2564,"SELECT m.title, m.production_year
FROM MOVIE m, WRITER w, PERSON p
WHERE w.title = m.title
AND w.production_year = m.production_year
AND w.id = p.id
AND p.first_name = 'Kevin'
AND p.last_name = 'Williamson';",2018-08-25 22:07:25.865838+10,5,1,199,correct
2565,"SELECT ID
FROM PERSON
WHERE YEAR_BORN=( SELECT MAX(YEAR_BORN) FROM PERSON WHERE NOT EXISTS( YEAR_BORN=  (SELECT MAX(YEAR_BORN) FROM PERSON)));",2018-08-25 22:10:42.686336+10,3,0,182,noninterpretable
2566,"select production_year, count(*)
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;
",2018-08-25 22:10:46.945867+10,2,1,254,correct
2567,"SELECT ID
FROM PERSON
WHERE YEAR_BORN=
( SELECT MAX(YEAR_BORN) FROM PERSON 
WHERE YEAR_BORN< (SELECT MAX(YEAR_BORN) FROM PERSON));",2018-08-25 22:12:29.077884+10,3,1,182,correct
2568,SELECT id FROM WRITER WHERE production_year = 1935;,2018-08-25 22:14:22.137542+10,1,0,229,partially correct
2569,8;,2018-08-25 22:15:31.251417+10,15,0,229,noninterpretable
2570,select count(person.id) from writer inner join person on writer.id=person.id where year_born = 1935;,2018-08-25 22:17:50.415034+10,1,0,315,partially correct
2571,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM MOVIE_AWARD WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film' AND result = 'won') AS ma, Director AS d, PERSON AS p
WHERE d.id = p.id
AND d.title = ma.title
AND d.production_year = ma.production_year;

",2018-08-25 22:18:21.764285+10,8,0,199,partially correct
2572,select count(distinct person.id) from writer inner join person on writer.id=person.id where year_born = 1935;,2018-08-25 22:19:20.211845+10,1,1,315,correct
2573,"Select count(*) from Writer inner join Person on Writer.id=Person.id where Person.year_born=1935;
",2018-08-25 22:20:49.031359+10,1,0,16,partially correct
2574,"SELECT production_year, COUNT(*) as mnum
FROM movie
WHERE production_year=1992 OR production_year=1991 OR production_year=1993
GROUP BY production_year;",2018-08-25 22:26:26.767083+10,2,1,312,correct
2575,"SELECT D.ID, DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D, DIRECTOR_AWARD DA
WHERE D.TITLE=DA.TITLE AND D.PRODUCTION_YEAR=DA.PRODUCTION_YEAR AND LOWER(DA.RESULT)!='WON';",2018-08-25 22:27:01.967735+10,13,0,182,partially correct
2576,"SELECT r.id
FROM APPEARANCE a, SCENE c, ROLE r
WHERE a.title = c.title
AND a.production_year = c.production_year
AND a.scene_no = c.scene_no
AND c.title = r.title
AND a.description = r.description
AND a.title = 'Psycho'
AND a.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;
",2018-08-25 22:27:39.707407+10,10,0,199,partially correct
2577,"SELECT D.ID, DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D, DIRECTOR_AWARD DA
WHERE D.TITLE=DA.TITLE AND D.PRODUCTION_YEAR=DA.PRODUCTION_YEAR AND LOWER(DA.RESULT)='NOMINATED';",2018-08-25 22:28:16.827669+10,13,0,182,partially correct
2578,"select count(*)
from writer_award wa inner join person p
on wa.id =p.id
where year_of_award >1990
and year_of_award <1996
and p.first_name ='Woody'
and p.last_name='Allen';",2018-08-25 22:29:54.653831+10,9,0,265,partially correct
2579,"select x.id
from (select x1.id, count(*) as numberofwork from (select d.id, title, production_year from director d union select w.id, title, production_year from writer w) x1 group by x1.id) x
where numberofwork = (select max(numberofwork) from (select x1.id, count(*) as numberofwork from (select d.id, title, production_year from director d union select w.id, title, production_year from writer w) x1 group by x1.id) x2);",2018-08-25 22:30:45.974979+10,14,1,72,correct
2580,"select id,count (*) from role r, scene s, appearance a
where s.title=a.title
and s.scene_no = a.scene_no 
and s.production_year = a.production_year
and a.description=r.description
and lower(s.title) = ""psycho""
and s.production_year=1960
group by id
having count(*)=1;",2018-08-25 22:36:26.770619+10,10,0,274,partially correct
2581,"select r.id from role r, scene s, appearance a
where s.title=a.title
and s.scene_no = a.scene_no 
and s.production_year = a.production_year
and a.description=r.description
and lower(s.title) = ""psycho""
and s.production_year=1960
group by id
having count(*)=1;",2018-08-25 22:37:22.031959+10,10,0,274,partially correct
2582,"select first_name, last_name, title, production_year, description
from person p, role r, (select id, count(*) as numberofroles from role r group by id) x
where p.id = r.id and r.id = x.id and x.numberofroles = (select max(x1.numberofroles) from (select id, count(*) as numberofroles from role r group by id) x1);

",2018-08-25 22:38:26.880552+10,15,1,72,correct
2583,"select w.title,w.production_year from writer w where exists (select * from person p where w.id = p.id and p.first_name='Kevin' and p.last_name='Williamson');",2018-08-25 22:41:17.390911+10,5,1,46,correct
2584,"select w.title,w.production_year from writer w where exists (select * from person p where w.id = p.id and p.first_name='Kevin' and p.last_name='Williamson');",2018-08-25 22:41:55.689176+10,5,1,46,correct
2585,select count(*) from movie where production_year = 1993 or production_year = 1992 or production_year = 1991;,2018-08-25 22:42:35.124555+10,2,0,229,partially correct
2586,"SELECT COUNT(*)
FROM(
SELECT *
FROM person AS p, director AS d
WHERE p.id!=d.id) AS num;
",2018-08-25 22:48:33.900871+10,12,0,312,partially correct
2587,"select r.id from role r, scene s, appearance a
where s.title=a.title
and s.production_year = a.production_year
and s.title=r.title
and s.scene_no = a.scene_no 
and s.production_year = r.production_year
and a.description=r.description
and lower(s.title) = ""psycho""
and s.production_year=1960
group by r.id
having count(*)=1;",2018-08-25 22:49:06.112892+10,10,1,274,correct
2588,"SELECT COUNT(*)
FROM(
SELECT DISTINCT *
FROM person AS p, director AS d
WHERE p.id!=d.id) AS num;
",2018-08-25 22:49:09.89721+10,12,0,312,partially correct
2589,"
Select id from Writer where id in (Select id from Person where  year_born=1935);
",2018-08-25 22:49:13.221904+10,1,0,16,partially correct
2590,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-25 22:49:42.47638+10,6,1,46,correct
2591,select count(*) from movie where exists(movie.production_year=1993 and movie.production_year=1992 and movie.production_year=1991);,2018-08-25 22:54:10.074121+10,2,0,306,noninterpretable
2592,"select id from role r
inner join scene s on
s.title = r.title
where s.title = 'Psycho'
and s.production_year = '1960'
and scene_no = '1';",2018-08-25 22:54:42.030864+10,10,0,265,partially correct
2593,"SELECT D.ID, DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D, DIRECTOR_AWARD DA
WHERE D.TITLE=DA.TITLE AND D.PRODUCTION_YEAR=DA.PRODUCTION_YEAR AND LOWER(DA.RESULT)='WON'AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-25 22:54:50.712848+10,13,0,182,partially correct
2594,"select production_year,count(*) from movie where production_year > 1990 and production_year < 1994 group by production_year;
",2018-08-25 22:55:41.282196+10,2,1,229,correct
2595,"Select production_year,count(title) from Movie Group by production_year having production_year=1993 Or production_year=1992 or production_year=1991;",2018-08-25 22:58:17.154007+10,2,1,16,correct
2596,"SELECT D.ID, DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D, DIRECTOR_AWARD DA
WHERE D.TITLE=DA.TITLE AND D.PRODUCTION_YEAR=DA.PRODUCTION_YEAR AND LOWER(DA.RESULT)='nominated' ;",2018-08-25 23:00:22.555085+10,13,1,182,correct
2597,"select em.id, em.first_name, em.last_name, max(em.year_born) from (select * from person group by year_born) em;",2018-08-25 23:03:43.177766+10,7,0,46,partially correct
2598,"select em.id, em.first_name, em.last_name from (select * from person group by year_born) em;",2018-08-25 23:04:12.647796+10,7,0,46,partially correct
2599,"select count(*)
from writer_award wa, writer w, person p
where year_of_award >= 1991
  and year_of_award <= 1995
  and lower(result) = 'won'
  and wa.id = w.id
  and w.id = p.id
  and lower(p.first_name) = 'woody'
  and lower(p.last_name) = 'allen';",2018-08-25 23:07:32.003406+10,9,0,116,partially correct
2600,select count(*) from person p where p.id not in (select id from director) ;,2018-08-25 23:07:45.79003+10,12,1,229,correct
2601,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(
SELECT *
FROM director d
WHERE p.id=d.id);
",2018-08-25 23:09:17.64175+10,12,1,312,correct
2602,"select count(writer.id) from writer, person where writer.id = person.id and person.year_born = 1935;",2018-08-25 23:11:36.534435+10,1,0,70,partially correct
2603,select count(*)id from director where ;,2018-08-25 23:11:48.440689+10,12,0,306,noninterpretable
2604,"SELECT pd.first_name, pd.last_name
FROM person NATURAL JOIN director AS pd
WHERE pd.title =(SELECT dm.title 
                         FROM director Natural JOIN movie_award AS dm 
                         WHERE award_name=""bafta film award'
						 AND category=""best film';",2018-08-25 23:11:56.435433+10,8,0,273,noninterpretable
2605,"select count(*)  from Person,Writer where Person.id!=Writer.id;",2018-08-25 23:13:12.373481+10,12,0,16,partially correct
2606,"select p1.id, p1.first_name, p1.last_name from person p1 where p1.year_born = (select max(p.year_born) from person p);",2018-08-25 23:13:12.873429+10,7,1,46,correct
2607,"q;
",2018-08-25 23:13:26.594623+10,14,0,208,noninterpretable
2608,;,2018-08-25 23:13:59.852927+10,11,0,265,noninterpretable
2609,"select count(distinct(person.id)) from writer, person where writer.id = person.id and person.year_born = 1935;",2018-08-25 23:14:05.465367+10,1,1,70,correct
2610,"select count(*)  from Person,Director where Person.id!=Director.id;",2018-08-25 23:14:14.264732+10,12,0,16,partially correct
2611,"select id,first_name,last_name from person;",2018-08-25 23:17:01.535901+10,4,0,229,partially correct
2612,"select production_year, count(*) from Movie where production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year;",2018-08-25 23:17:06.752877+10,2,1,70,correct
2613,"select count(*) from person, director where person.id <> director.id;",2018-08-25 23:18:50.5894+10,12,0,70,partially correct
2614,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-25 23:19:15.103857+10,1,1,265,correct
2615,select count(*) from person where id not in (select distinct(id) from director);,2018-08-25 23:19:39.575097+10,12,1,70,correct
2616,"
Select count(*) from Person where id not in (Select id from Director);
",2018-08-25 23:21:09.763124+10,12,1,16,correct
2617,"select *
from writer_award wa, writer w, person p
where wa.title = w.title 
  and wa.production_year = w.production_year
  and wa.id = w.id
  and w.id = p.id
  and year_of_award >= 1991
  and year_of_award <= 1995
  and lower(result) = 'won'
  and lower(p.first_name) = 'woody'
  and lower(p.last_name) = 'allen';",2018-08-25 23:21:37.578522+10,9,0,116,partially correct
2618,"select (*)
from writer_award wa, writer w, person p
where wa.title = w.title 
  and wa.production_year = w.production_year
  and wa.id = w.id
  and w.id = p.id
  and year_of_award >= 1991
  and year_of_award <= 1995
  and lower(result) = 'won'
  and lower(p.first_name) = 'woody'
  and lower(p.last_name) = 'allen';",2018-08-25 23:21:57.555858+10,9,0,116,noninterpretable
2619,select * from MOVIE_AWARD WHERE award_name='BAFTA Film Award' AND category='Best Film';,2018-08-25 23:24:02.409505+10,8,0,46,partially correct
2620,"select count(*)
from writer_award wa, writer w, person p
where wa.title = w.title 
  and wa.production_year = w.production_year
  and wa.id = w.id
  and w.id = p.id
  and year_of_award >= 1991
  and year_of_award <= 1995
  and lower(result) = 'won'
  and lower(p.first_name) = 'woody'
  and lower(p.last_name) = 'allen';",2018-08-25 23:25:18.553625+10,9,1,116,correct
2621,"select a.title,a.production_year from (movie natural join person natural join writer) AS a
where a. first_name = Kevin and a. last_name = Williamson;",2018-08-25 23:26:05.223081+10,5,0,229,noninterpretable
2622,"select id, first_name, last_name from person where id in (select d.id from director as d, writer as w where d.id = w.id and d.title = w.title and d.production_year = w.production_year);",2018-08-25 23:27:32.233247+10,4,0,70,partially correct
2623,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-25 23:29:53.650374+10,6,1,229,correct
2624,"select id, first_name, last_name from person where id in (select d.id from director as d, writer as w where d.id = w.id and d.title = w.title and d.production_year = w.production_year group by d.id having count(*)>1);",2018-08-25 23:30:29.444419+10,4,1,70,correct
2625,"SELECT WD.ID
FROM (WRITER W
NATURAL JOIN DIRECTOR D) AS WD
GROUP BY WD.ID HAVING COUNT(*)=(SELECT MAX(COUNT(*)) FROM (WRITER W
NATURAL JOIN DIRECTOR D) AS WD);
 ",2018-08-25 23:31:55.238448+10,14,0,182,noninterpretable
2626,"select id , rst_name, last_name from person where ;",2018-08-25 23:35:10.973934+10,4,0,306,noninterpretable
2627,"select id, first_name , last_name from person where year_born in (select max(year_born) from person);",2018-08-25 23:35:25.053622+10,7,1,229,correct
2628,"select title, production_year from movie as m, (select title as t_title, production_year as t_year from writer as w, person as p where p.first_name = 'Kevin' and p.last_name = 'Williamson' and p.id = w.id) as t where m.title = t.t_title and m.production_year = t.t_year;",2018-08-25 23:36:09.519858+10,5,1,70,correct
2629,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-25 23:43:23.532842+10,8,1,273,correct
2630,"Select id,first_name,last_name from Person where id in (select id from Director group by id having count(id)>=2 And id in (select id from Writer) );",2018-08-25 23:44:06.202406+10,4,0,16,partially correct
2631,"select title, production_year from movie where exists writer=Kevin Williamson;",2018-08-25 23:46:15.000265+10,5,0,306,noninterpretable
2632,"select p.first_name, p.last_name, ma.award_name, ma.category from (MOVIE_AWARD ma natural join DIRECTOR d natural join PERSON p) where lower(ma.award_name)='bafta film award' AND lower(ma.category)='best film';",2018-08-25 23:48:57.219905+10,8,0,46,partially correct
2633,"SELECT P.FIRST_NAME,P.LAST_NAME,R.TITLE,R.PRODUCTION_YEAR,R.DESCRIPTION
FROM ROLE R,
MOVIE M, PERSON P
WHERE R.TITLE=M.TITLE AND R.PRODUCTION_YEAR=M.PRODUCTION_YEAR AND P.ID=R.ID
GROUP BY P.ID HAVING COUNT(*)=4;",2018-08-25 23:49:44.431734+10,15,0,182,partially correct
2634,"select m.title, m.production_year, d.first_name , d.last_name from movie m ,person d 
where title in (select title from movie_award where award_name = ""BAFTA Film Award"") 
and id in (select id from director where title in (select title from movie_award where award_name = ""BAFTA Film Award""));",2018-08-25 23:50:21.630609+10,8,0,229,partially correct
2635,"select p.first_name, p.last_name, ma.title,ma.production_year,ma.award_name, ma.category from (MOVIE_AWARD ma natural join DIRECTOR d natural join PERSON p) where lower(ma.award_name)='bafta film award' AND lower(ma.category)='best film';",2018-08-25 23:50:51.404532+10,8,0,46,partially correct
2636,"select p.first_name, p.last_name, ma.title,ma.production_year from (MOVIE_AWARD ma natural join DIRECTOR d natural join PERSON p) where lower(ma.award_name)='bafta film award' AND lower(ma.category)='best film';",2018-08-25 23:51:12.665564+10,8,0,46,partially correct
2637,"Select award_name, year of award;",2018-08-26 00:01:21.751857+10,9,0,273,noninterpretable
2638,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-26 00:02:22.091792+10,9,1,273,correct
2639,"SELECT m.title, m.production_year 
FROM movie m, kw(SELECT p.id FROM person p WHERE p.first_name=Kevin, p.last_name=Williamson AS kw) 
WHERE w.id=kw.id and w.title=m.title;",2018-08-26 00:04:10.531909+10,5,0,86,noninterpretable
2640,;,2018-08-26 00:33:19.998098+10,3,0,265,noninterpretable
2641,"select award_name,year_of_award,category
from director_award
;",2018-08-26 00:42:11.228048+10,13,0,265,partially correct
2642,"

select * from writer natural join writer;",2018-08-26 00:55:17.764245+10,13,0,72,partially correct
2643," select Distinct title,production_year from (writer natural join Person ) where Person.first_name=""Kevin"" and Person.last_name=""Williamson"";",2018-08-26 00:56:19.405252+10,5,1,16,correct
2644,"Select country from Restriction where title=""Shakespeare in Love"";",2018-08-26 01:01:13.09118+10,6,0,16,partially correct
2645,"Select country from Restriction where title=""Shakespeare in Love"" and description='M';",2018-08-26 01:03:18.771614+10,6,1,16,correct
2646,"select id,first_name,last_name from (select max(year_born),first_name,last_name,id from Person) as t;",2018-08-26 01:16:19.65821+10,7,1,16,correct
2647,select countyear_bornfrom PERSON where year_born in 1935;,2018-08-26 01:29:12.837773+10,1,0,317,noninterpretable
2648,"Select title,production_year,first_name,last_name from ((Select title,production_year  from Movie_Award where award_name=""BAFTA Film Award"") as award natural join Director natural join Movie natural join Person) ;",2018-08-26 01:37:11.848182+10,8,0,16,partially correct
2649,"Select title,production_year,first_name,last_name from ((Select title,production_year  from Movie_Award where award_name=""BAFTA Film Award"" and category=""Best Film"") as award natural join Director natural join Movie natural join Person) ;",2018-08-26 01:40:09.599613+10,8,0,16,partially correct
2650,select count(*) from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year;,2018-08-26 01:47:13.099317+10,2,0,317,partially correct
2651,"SELECT COUNT(*)
FROM writer w, person p
WHERE w.id = p.id AND p.year_born = 1935;",2018-08-26 01:50:23.168986+10,1,0,279,partially correct
2652,"Select title,production_year,first_name,last_name  from ((Select title,production_year,category  from Movie_Award where award_name=""BAFTA Film Award"" and result='won'and  lower(Category)='best film' ) as award natural join Director natural join Movie natural join Person) ;",2018-08-26 01:51:36.215131+10,8,1,16,correct
2653,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w
WHERE p.id =w.id AND p.year_born = 1935);",2018-08-26 02:03:41.265181+10,1,1,279,correct
2654,"SELECT production_year, count(*)
FROM movie
GROUP BY production_year
HAVING production_year > 1990 AND production_year < 1994;",2018-08-26 02:06:47.479341+10,2,1,279,correct
2655,"SELECT id FROM PERSON 
	WHERE year_born IN (SELECT max(year_born) FROM PERSON WHERE year_born NOT IN(SELECT max(year_born) FROM PERSON));",2018-08-26 02:08:30.305227+10,3,1,26,correct
2656,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id=p.id);",2018-08-26 02:10:04.800034+10,12,1,279,correct
2657,"


SELECT id, year_born
FROM WRITER, PERSON
WHERE year_born = '1935';",2018-08-26 02:16:13.861994+10,1,0,319,noninterpretable
2658,"


SELECT id, year_born
FROM WRITER, PERSON
WHERE year_born = '1935';",2018-08-26 02:17:50.882706+10,1,0,319,noninterpretable
2659,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w
WHERE p.id=d.id AND d.id=w.id AND d.title=w.title AND d.production_year=w.production_year
GROUP BY p.id, p.first_name, p.last_name
HAVING count(*)>1;
",2018-08-26 02:18:29.234381+10,4,1,279,correct
2660,"SELECT id, award_name, year_of_award, category FROM DIRECTOR_AWARD da NATURAL JOIN DIRECTOR
	WHERE lower(da.result) = 'nominated';",2018-08-26 02:18:33.610621+10,13,1,26,correct
2661,"Select count(*) from(Select  * from ((Select id,year_of_award fROm WRITER_AWARD where year_of_award>=1991 and year_of_award<=1995) as t natural join Person )) as t1 where lower(first_name)=""woody"" ;",2018-08-26 02:23:33.349009+10,9,0,16,partially correct
2662,"Select count(*) from(Select  * from ((Select id,year_of_award fROm WRITER_AWARD where year_of_award>1991 and year_of_award<=1995) as t natural join Person )) as t1 where lower(first_name)=""woody"" and lower(last_name)=""allen"" ;",2018-08-26 02:25:48.496625+10,9,1,16,correct
2663,"SELECT title, production_year
FROM movie NATURAL JOIN writer NATURAL JOIN person
WHERE first_name='Kevin' AND last_name='Williamson';",2018-08-26 02:26:27.206092+10,5,1,279,correct
2664,"SELECT DISTINCT country
FROM restriction
WHERE title='Shakespeare in Love' AND description='M';",2018-08-26 02:54:52.303897+10,6,1,279,correct
2665,"WITH youngest AS (SELECT MAX(year_born) AS y_year FROM person)
SELECT id, first_name, last_name
FROM person, youngest
WHERE person.year_born=youngest.y_year;",2018-08-26 02:58:51.131633+10,7,1,279,correct
2666,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won';",2018-08-26 03:05:12.432109+10,8,1,279,correct
2667,"SELECT COUNT(*)
FROM writer_award NATURAL JOIN person
WHERE lower(first_name)='woody' AND lower(last_name)='allen'
AND year_of_award > 1990 AND year_of_award < 1996
AND lower(result)='won';",2018-08-26 03:12:43.015475+10,9,1,279,correct
2668,"WITH a AS (SELECT * FROM appearance
WHERE lower(title)='psycho' AND production_year=1960
GROUP BY description
HAVING COUNT(scene_no)=1)

SELECT id
FROM role NATURAL JOIN a;",2018-08-26 03:22:18.29951+10,10,1,279,correct
2710,"select distinct a.title, a.production_year, p.first_name, p.last_name
from movie_award a
natural join
writer w
natural join
person p
where a.category = 'best film' 
and 
a.award_name = 'BAFTA Film Award'
and a.result = 'won';",2018-08-26 11:56:37.108999+10,8,0,271,partially correct
2711,"select a.title, a.production_year, p.first_name, p.last_name
from movie_award a
natural join
director d
natural join
person p
where a.category = 'best film' 
and 
a.award_name = 'BAFTA Film Award'
and a.result = 'won';",2018-08-26 11:58:53.052593+10,8,1,271,correct
2887,"select count(*)
from(
SELECT *
FROM person NATURAL JOIN writer
where year_born = 1935
group by id);",2018-08-26 19:42:33.434223+10,1,1,330,correct
2669,"SELECT COUNT(*)
FROM (SELECT c.title, c.production_year
FROM (SELECT b.title, b.production_year
FROM (SELECT a.title, a.production_year 
FROM (SELECT m.title, m.production_year
FROM movie m
WHERE NOT EXISTS (SELECT * FROM movie_award ma WHERE m.title=ma.title AND m.production_year=ma.production_year AND lower(ma.result)='won')) AS a
WHERE NOT EXISTS (SELECT * FROM crew_award ca WHERE a.title=ca.title AND a.production_year=ca.production_year AND lower(ca.result)='won')) AS b
WHERE NOT EXISTS (SELECT * FROM director_award da WHERE b.title=da.title AND b.production_year=da.production_year AND lower(da.result)='won')) AS c
WHERE NOT EXISTS (SELECT * FROM writer_award wa WHERE c.title=wa.title AND c.production_year=wa.production_year AND lower(wa.result)='won')) AS d
WHERE NOT EXISTS (SELECT * FROM actor_award aa WHERE d.title=aa.title AND d.production_year=aa.production_year AND lower(aa.result)='won');",2018-08-26 04:17:38.776058+10,11,1,279,correct
2670,"SELECT a.id
FROM (WITH my AS (SELECT MAX(year_born) AS max_year
FROM person)
SELECT MAX(year_born) AS second_year, id
FROM person p, my
WHERE p.year_born != my.max_year) AS a;",2018-08-26 04:32:00.105836+10,3,1,279,correct
2671,"SELECT id, award_name, year_of_award, category
FROM director_award da NATURAL JOIN director d NATURAL JOIN person p
GROUP BY first_name, last_name
HAVING lower(result)='nominated';",2018-08-26 04:37:05.383831+10,13,1,279,correct
2672,"WITH won AS (SELECT id, count(*) AS work_on_num FROM (SELECT id, title, production_year
FROM writer
UNION
SELECT id, title, production_year
FROM director) AS u
GROUP BY id)
SELECT id 
FROM won
WHERE work_on_num =(SELECT MAX(work_on_num)
FROM won);",2018-08-26 04:55:26.47778+10,14,1,279,correct
2673,"WITH b AS (SELECT id, MAX(rnum) FROM (SELECT id, COUNT(*) as rnum
FROM role
GROUP BY id) as a)

SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r, b
WHERE p.id=b.id AND b.id=r.id;",2018-08-26 05:08:10.290593+10,15,1,279,correct
2674,"SELECT id, first_name, last_name 
FROM (person NATURAL JOIN director NATURAL JOIN writer)
GROUP BY id,first_name,last_name
HAVING count(*) > 1;",2018-08-26 05:45:30.633966+10,4,1,256,correct
2675,"SELECT production_year, COUNT(title) FROM movie WHERE production_year = '1993' OR production_year = '1992' OR production_year = '1991' GROUP BY production_year;


",2018-08-26 09:26:19.345806+10,2,1,311,correct
2676,"SELECT person. id, COUNT(*) FROM person, director WHERE person.id NOT LIKE director.id;",2018-08-26 09:30:19.917813+10,12,0,311,partially correct
2677,SELECT COUNT(*) FROM person AS p WHERE NOT EXISTS (SELECT * FROM director AS d WHERE p.id = d.id) ;,2018-08-26 09:33:30.677425+10,12,1,311,correct
2678,"SELECT person.id, COUNT (*) FROM person, writer WHERE person.id = writer.id; ",2018-08-26 09:35:20.947954+10,1,0,311,partially correct
2679,"SELECT COUNT (*) FROM person, writer WHERE person.id = writer.id; ",2018-08-26 09:35:53.577273+10,1,0,311,partially correct
2680,"SELECT COUNT (writer.id) FROM person, writer WHERE person.id = writer.id AND year_born = '1935'; ",2018-08-26 09:37:47.383024+10,1,0,311,partially correct
2681,"SELECT id, first_name, last_name FROM person p WHERE EXISTS (SELECT * FROM writer, director WHERE writer.id = director.id);",2018-08-26 09:42:26.368085+10,4,0,311,partially correct
2682,"
SELECT id, year_born
FROM WRITER, PERSON
WHERE year_born = '1935';


",2018-08-26 10:14:27.562739+10,1,0,319,noninterpretable
2683,"SELECT id FROM ROLE
	WHERE title=""Psycho"";",2018-08-26 10:14:34.659861+10,14,0,26,partially correct
2684,"
SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);

",2018-08-26 10:17:43.477734+10,1,1,319,correct
2685,"SELECT count(*)
FROM movie T
WHERE EXISTS (SELECT * FROM movie T WHERE production_year = '1991, 1992, 1993');",2018-08-26 10:25:17.00443+10,2,0,319,partially correct
2686,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-26 10:36:09.05873+10,14,1,26,correct
2687,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-26 10:37:53.355149+10,2,1,319,correct
2688,"SELECT COUNT(*)
FROM writer
WHERE EXISTS (
SELECT *FROM person
WHERE person.id=writer.id AND person.year_born=1935);",2018-08-26 10:42:57.496888+10,1,0,185,partially correct
2689,"select count(w.id)
from writer w inner join
person p
on w.id=p.id
where p.year_born = '1935';",2018-08-26 10:47:22.161314+10,1,0,271,partially correct
2690,"select count(n.id) from (select distinct w.id from writer w inner join
        
person p
on w.id=p.id
where p.year_born = '1935') as n;",2018-08-26 10:51:00.505543+10,1,1,271,correct
2691,"SELECT production_year, COUNT(production_year)
FROM movie
GROUP BY production_year
HAVING production_year=1993 OR production_year=1992 OR production_year=1991;",2018-08-26 10:59:38.66219+10,2,1,185,correct
2692,"select production_year, count(production_year)
from movie
group by production_year
having movie.production_year = '1993' or movie.production_year = '1992' or movie.production_year = '1991'
;",2018-08-26 11:02:49.704693+10,2,1,271,correct
2693,"select production_year, count(production_year)
from movie
group by production_year
where movie.production_year = '1993' or movie.production_year = '1992' or movie.production_year = '1991'
;",2018-08-26 11:03:30.650532+10,2,0,271,noninterpretable
2694,"select production_year, count(production_year)
from movie
group by production_year
having movie.production_year = '1993' or movie.production_year = '1992' or movie.production_year = '1991'
;",2018-08-26 11:03:38.607628+10,2,1,271,correct
2695,"SELECT id;
",2018-08-26 11:05:23.253229+10,7,0,311,noninterpretable
2696,"
select count(p.id)
from person p
where p.id not in 
(select p.id
from person p
inner join
director d
on p.id = d.id);",2018-08-26 11:10:08.585785+10,12,1,271,correct
2697,"SELECT;
",2018-08-26 11:10:49.618156+10,13,0,311,noninterpretable
2698,"SELECT SUM(*)
FROM person
WHERE EXISTS (SELECT id= NULL
FROM director
WHERE dircetor.id= person.id);",2018-08-26 11:10:50.074415+10,12,0,185,noninterpretable
2699,"SELECT count(*)
FROM DIRECTOR
WHERE EXISTS (SELECT * FROM Movie = 0;",2018-08-26 11:13:36.12287+10,12,0,319,noninterpretable
2700,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS (SELECT id
FROM DIRECTOR
WHERE DIRECTOR.id= person.id);",2018-08-26 11:14:19.337807+10,12,1,185,correct
2701,"select d.id, p.first_name, p.last_name
from
person p
inner join
director d
on p.id = d.id
inner join
writer w
on p.id = w.id
group by d.id, p.first_name, p.last_name
having count(d.id)>1;",2018-08-26 11:16:12.81944+10,4,0,271,partially correct
2702,"select kk.id, kk.first_name, kk.last_name
from
((person p
inner join
director d
on p.id = d.id) as mm
inner join
writer w
on mm.id = w.id) as kk
group by kk.id
having count(kk.id)>1;",2018-08-26 11:21:41.230975+10,4,0,271,partially correct
2703,"select w.id, p.first_name, p.last_name
from
(person p
inner join
director d
on p.id = d.id
inner join
writer w
on d.id = w.id)
group by w.id
having count(w.id)>2;",2018-08-26 11:25:54.112215+10,4,1,271,correct
2704,"select dw.id, dw.first_name, dw.last_name
from
(person p
natural join
director d
natural join
writer w) as dw
group by dw.id
having count(dw.id) > 1;",2018-08-26 11:34:19.113746+10,4,1,271,correct
2705,"select w.title, w.production_year
from writer w
inner join
person p
on w.id = p.id
where p.first_name = 'Kevin'
and p.last_name = 'Williamson';",2018-08-26 11:37:08.472432+10,5,1,271,correct
2706,"select distinct r.country
from Restriction r
where r.description = 'M'
and r.title = 'Shakespeare in Love';
",2018-08-26 11:39:37.200061+10,6,1,271,correct
2707,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = 
(select min(p2.year_born)
from person p2);",2018-08-26 11:42:04.337889+10,7,0,271,partially correct
2708,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = 
(select max(p2.year_born)
from person p2);",2018-08-26 11:42:31.679987+10,7,1,271,correct
2709,"select a.title, a.production_year, p.first_name, p.last_name
from movie_award a
inner join
writer w
on a.title=w.title
inner join
person p
on w.id = p.id
where a.category = 'best film'
and a.award_name = 'BAFTA Film Award';",2018-08-26 11:51:13.268111+10,8,0,271,partially correct
2712,"select md.first_name, md.last_name, md.title,md.production_year from (select * from MOVIE_AWARD ma natural join DIRECTOR d natural join PERSON p where lower(ma.award_name)='bafta film award' AND lower(ma.category)='best film' and ma.result='won') md;",2018-08-26 11:59:50.290605+10,8,1,46,correct
2713,"select count(*)
from writer_award wa
natural join
writer w
natural join
person p
where wa.result = 'won'
and p.first_name = 'Woody'
and p.last_name = 'Allen'
and wa.year_of_award >= '1991'
and wa.year_of_award <= '1995';",2018-08-26 12:04:47.81337+10,9,1,271,correct
2714,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id );",2018-08-26 12:05:04.162502+10,12,1,319,correct
2715,"select ma.title, ma.production_year from (select title, production_year from MOVIE_AWARD where lower(award_name)='bafta film award' and lower(category)='best film'and lower(result)='won') as ma, director as d, person as p where ma.title=d.title,ma.production_year = d.production_year,d.id=p.id;",2018-08-26 12:06:40.044315+10,8,0,46,noninterpretable
2716,"select ma.title, ma.production_year, p.first_name, p.last_name from (select title, production_year from MOVIE_AWARD where lower(award_name)='bafta film award' and lower(category)='best film'and lower(result)='won') as ma, director as d, person as p where ma.title=d.title and ma.production_year = d.production_year and d.id=p.id;",2018-08-26 12:08:34.544654+10,8,1,46,correct
2717,"select count(r.id)
from
scene s
inner join
role r
on s.title = r.title and s.production_year = r.production_year
group by r.id
having s.production_year = '1960'
and s.title='Psycho';",2018-08-26 12:15:37.99939+10,10,0,271,partially correct
2718,"select r.id
from
scene s,
role r,
Appearance ap
where
r.title = s.title
and r.production_year = s.production_year
and r.title = ap.title
and r.production_year = ap.production_year
and s.scene_no = ap.scene_no
and ap.description = r.description
and lower(r.title) = 'psycho'
and r.production_year = '1960'
group by r.id
having
count(r.id) = 1;",2018-08-26 12:24:15.387279+10,10,1,271,correct
2719,"select count()
from
movie m
where
m.title not in (select title from Movie_Award mv where mv.result != 'won')
and m.title not in (select title from crew_Award ca where ca.result != 'won')
and m.title not in (select title from director_Award da where da.result != 'won')
and m.title not in (select title from writer_Award wa where wa.result != 'won')
and m.title not in (select title from actor_Award aa where aa.result != 'won');",2018-08-26 12:29:28.46182+10,11,0,271,partially correct
2720,"select count()
from
movie m
where
m.title not in (select title from Movie_Award mv where lower(mv.result) = 'won')
and m.title not in (select title from crew_Award ca where lower(ca.result) = 'won')
and m.title not in (select title from director_Award da where lower(da.result) = 'won')
and m.title not in (select title from writer_Award wa where lower(wa.result) = 'won')
and m.title not in (select title from actor_Award aa where lower(aa.result) = 'won');",2018-08-26 12:48:42.783111+10,11,0,271,partially correct
2721,"select count(*)
from writer_award wa
where wa.id=(select id
             from person
             where first_name='Woody' and last_name='Allen')
             and wa.year_of_award>1990 and wa.year_of_award<1996;",2018-08-26 13:00:24.359079+10,9,0,298,partially correct
2722,select count(*) from writer join person on person.id=writer.id where year_born=1935;,2018-08-26 13:00:51.890044+10,1,0,149,partially correct
2723,"select count(*)
from writer_award wa
where wa.id=(select id
             from person
             where first_name='Woody' and last_name='Allen')
             and wa.year_of_award>1990 and wa.year_of_award<1996
             and lower(RESULT)= 'won';",2018-08-26 13:05:22.045297+10,9,1,298,correct
2724,"select r.id
from role r, scene s, person p
where s.title=r.title
      and r.title='Psycho'
      and s.production_year=r.production_year
      and r.production_year=1960
      and p.id=r.id;",2018-08-26 13:14:21.685466+10,10,0,298,partially correct
2725,"select distinct production_year, count(*) from
movie where (production_year=1991 or production_year=1992 or production_year=1993)
group by production_year;",2018-08-26 13:15:48.881956+10,2,1,149,correct
2726,"SELECT ID, first_name, last_name
FROM Person p 
WHERE EXISTS ( SELECT * FROM director d, writer w WHERE p.id = d.id AND w.id =d.id) ;",2018-08-26 13:16:03.011572+10,4,0,319,partially correct
2727,"select count(*) from
(select person.id from director join person on person.id !=director.id)as m;",2018-08-26 13:21:54.04884+10,12,0,149,partially correct
2728,"select count(*) from
(select person.id from director inner join person on person.id !=director.id)as m;",2018-08-26 13:22:26.626645+10,12,0,149,partially correct
2729,"SELECT count(*)
FROM person p 
WHERE not exists (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-26 13:24:57.649504+10,12,1,149,correct
2730,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-26 13:25:34.870619+10,11,1,271,correct
2731,"select p.id, p.year_born
from person p
where p.year_born > (select min(p2.year_born) from person p2)
and p.year_born <= (select p3.year_born from person p3);",2018-08-26 13:33:36.154898+10,3,0,271,partially correct
2732,"select p.id
from person p
where p.year_born = (select max(p3.year_born) from person p3 where p3.year_born < (select max(p2.year_born) from person p2));",2018-08-26 13:36:16.946694+10,3,1,271,correct
2733,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where
da.title not in
(select da2.title 
from director_award da2
where 
lower(da2.result) = 'won')
and 
da.title in
(select da3.title 
from director_award da3
where 
lower(da3.result) = 'nominated')
and d.title = da.title;",2018-08-26 13:42:51.57945+10,13,1,271,correct
2734,"select d.id, d from person;",2018-08-26 13:44:45.245902+10,14,0,271,noninterpretable
2735,"SELECT id, first_name, last_name
FROM person
WHERE ;",2018-08-26 14:08:57.512445+10,4,0,185,noninterpretable
2736,"select nr.id
from scene natural join role as nr
group by id
having count(select*
		from nr
		where lower(title)='psycho' and production_year =1960)=1;",2018-08-26 14:11:57.360633+10,10,0,134,noninterpretable
2737,"SELECT title, production_year
FROM WRITER
WHERE EXISTS (SELECT * FROM person
WHERE person.id=writer.id AND person.first_name= Kevin AND person.last_name= Williamson);",2018-08-26 14:16:32.801242+10,5,0,185,noninterpretable
2738,"SELECT title, production_year
FROM WRITER
WHERE EXISTS (SELECT * FROM person
WHERE person.id=writer.id AND lower(first_name)= 'kevin' AND lower(last_name)= 'williamson');",2018-08-26 14:19:39.027464+10,5,1,185,correct
2739,"SELECT country
FROM RESTRICTION
WHERE lower(title)= 'Shakespeare in Love' AND lower(description)= 'm';",2018-08-26 14:25:17.265091+10,6,0,185,partially correct
2740,"select p.id,p.first_name,p.last_name
from role r
	natural join 
	person p
	natural join
	actor_award aa
where lower(aa.result) = ""nominated"" and
	not exists(select *
			from (role r2
				natural join 
				person p2
				natural join
				actor_award aa2) as sub
			where lower(aa.result) = ""won"" and 
			sub.id = p.id)
group by p.id
having count(*) >=2;",2018-08-26 14:25:28.399735+10,1,0,43,partially correct
2741,"SELECT p.id, fname, lname
FROM person p,director d, writer w
WHERE d.id=w.id
AND d.id=p.id
AND d.title=w.title
GROUP BY 
WHERE (
SELECT count(*) AS wnum
FROM director d, writer w
WHERE d.id=w.id
AND d.id=p.id
AND d.title=w.title
GROUP BY d.id) ;
",2018-08-26 14:25:46.227444+10,4,0,312,noninterpretable
2846,"SELECT country
FROM restriction r
WHERE EXISTS (SELECT * FROM restriction_category rc WHERE rc.country = r.country AND r.title = 'Shakespeare in Love');",2018-08-26 18:42:04.093328+10,6,0,319,partially correct
2742,"select r.id
from  role r,
	scene s,
	appearance a
where r.title = s.title
	and r.title =a.title
	and lower(r.title='psycho')
	
	and s.production_year = r.production_year
	and r.production_year = a.production_year
	and a.production_year =1960
	
	and s.scene_no=a.scene_no
	and s.description=a.description
group by r.id
having count(*)=1;

",2018-08-26 14:26:32.485919+10,10,0,134,partially correct
2743,"SELECT country
FROM RESTRICTION
WHERE lower(title)= 'shakespeare in love' AND description= 'M';",2018-08-26 14:27:09.648001+10,6,1,185,correct
2744,"SELECT production_year, COUNT(*) AS NumberOfMV
FROM MOVIE 
WHERE production_year BETWEEN 1991 AND 1993
GROUP BY production_year;",2018-08-26 14:32:03.295081+10,2,1,81,correct
2745,"SELECT id, first_name, last_name
FROM person
WHERE year_born=MAX(year_born);",2018-08-26 14:32:10.248239+10,7,0,185,noninterpretable
2746,"SELECT production_year, COUNT(*) AS NumberOfMV
FROM MOVIE 
WHERE production_year BETWEEN 1991 AND 1993
GROUP BY production_year;",2018-08-26 14:32:16.073541+10,2,1,81,correct
2747,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-26 14:33:40.519446+10,4,1,312,correct
2748,"SELECT title, production_year
FROM writer w, person p
WHERE first_name=""Kevin""
AND last_name=""Williamson""
AND p.id=w.id;",2018-08-26 14:40:11.820207+10,5,1,312,correct
2749,"SELECT id, first_name, last_name
FROM person
WHERE (person.year_born =
SELECT MAX(person.year_born) 
FROM person);",2018-08-26 14:40:46.14247+10,7,0,185,noninterpretable
2750,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (
SELECT MAX(year_born) 
FROM person);",2018-08-26 14:42:11.913712+10,7,1,185,correct
2751,"SELECT country
FROM restriction
WHERE title=""Shakespeare in Love""
AND description=""M"";
",2018-08-26 14:47:27.665186+10,6,1,312,correct
2752,"SELECT title, production_year, first_name, last_name
FROM person, MOVIE_AWARD
WHERE lower(award_name)='bafta film award' AND category='Best Film' AND (SELECT id 
FROM DIRECTOR
WHERE DIRECTOR.title= MOVIE_AWARD.title);",2018-08-26 14:55:02.855734+10,8,0,185,partially correct
2753,"SELECT id,first_name,last_name
FROM person
WHERE year_born=(SELECT MAX(year_born)
FROM PERSON);",2018-08-26 14:58:56.418826+10,7,1,312,correct
2754,"select x.id
from
(select x1.id, count(x1.id) as c1
from
(select d.id, d.title, d.production_year
from director d
union
select w.id, w.title, w.production_year
from writer w) x1
group by x1.id) x
where x.c1 = (select max(x2.c)
from
(select x1.id, count(x1.id) as c
from
(select d.id, d.title, d.production_year
from director d
union
select w.id, w.title, w.production_year
from writer w) x1
group by x1.id) x2);",2018-08-26 14:58:59.955339+10,14,1,271,correct
2755,"select count(*) from (select * from WRITER_AWARD WHERE year_of_award >= 1991 and year_of_award<=1995 and result='won') as wa, person as p where p.id=wa.id;",2018-08-26 15:02:46.936728+10,9,0,46,partially correct
2756,"select count(*) from (select * from WRITER_AWARD WHERE year_of_award >= 1991 and year_of_award<=1995 and result='won') as wa, person as p where p.id=wa.id and lower(p.first_name)='woody'and lower(p.last_name)='allen';",2018-08-26 15:04:17.885224+10,9,1,46,correct
2757,"SELECT title, production_year, first_name, last_name
FROM person, MOVIE_AWARD
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won' AND (SELECT id 
FROM DIRECTOR
WHERE DIRECTOR.title= MOVIE_AWARD.title AND DIRECTOR.production_year=MOVIE_AWARD.production_year AND DIRECTOR.id=person.id);",2018-08-26 15:04:31.322432+10,8,1,185,correct
2758,"SELECT  title, production_year
FROM movie_award
WHERE award_name=""BAFTA Film Award""
AND category=""Best Film"";",2018-08-26 15:10:05.307454+10,8,0,312,partially correct
2759,"SELECT COUNT(*)
FROM WRITER_AWARD
WHERE EXISTS (SELECT * FROM person
WHERE lower(last_name)='allen' AND lower(first_name)='woody')
AND year_of_award<=1995 AND year_of_award>=1991;",2018-08-26 15:10:51.122972+10,9,0,185,partially correct
2760,"select t1.first_name, t1.last_name, t1.title, t1.production_year, t1.description
from (
select p.first_name, p.last_name, r.title, r.production_year, r.description, count(r.id)
from
person p
inner join
role r
on
p.id = r.id) t1
;
",2018-08-26 15:13:43.257062+10,15,0,271,partially correct
2761,"SELECT COUNT(*)
FROM WRITER_AWARD
WHERE EXISTS (SELECT * FROM person
WHERE lower(last_name)='allen' AND lower(first_name)='woody' AND person.id=WRITER_AWARD.id)
AND year_of_award<=1995 AND year_of_award>=1991 AND lower(result)='won';",2018-08-26 15:14:36.127614+10,9,1,185,correct
2762,"SELECT  ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma, person p
WHERE lower(award_name)='bafta film award'
AND lower(category)='best film'
AND lower(result)='won'
AND p.id=(SELECT d.id
FROM director d
WHERE d.title=ma.title);",2018-08-26 15:19:32.672249+10,8,1,312,correct
2763,"SELECT COUNT(*)
FROM writer_award wa
WHERE LOWER(result)='won'
AND wa.id=(
SELECT p.id
FROM person p
WHERE LOWER(first_name)='woody'
AND LOWER(last_name)='allen');
",2018-08-26 15:35:04.35919+10,9,1,312,correct
2764,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from
person p, role r
where
p.id = r.id
and
p.id = (
select r.id
from
person p
inner join
role r
on
p.id = r.id
group by r.id
having count(r.id) = 
(select max(tt)
from (
select r.id, count(r.id) as tt
from
person p
inner join
role r
on
p.id = r.id
group by r.id) t1))
;
",2018-08-26 15:36:30.048812+10,15,1,271,correct
2765,"select p.id, p.first_name, p.year_born from person p where esists (select b.id, count(*) as no from (writer natural join directore) b where b.no>1 and p.id=b.id);",2018-08-26 15:36:32.074144+10,4,0,270,noninterpretable
2766,"select p.id, p.first_name, p.year_born from person p where esists (select b.id, count(*) as no from (writer natural join director) b where b.no>1 and p.id=b.id);",2018-08-26 15:37:08.200208+10,4,0,270,noninterpretable
2767,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-26 15:37:29.946198+10,13,1,148,correct
2768,"select p.id, p.first_name, p.last_name from person p where esists (select b.id, count(*) as no from (writer natural join director) b where b.no>1 and p.id=b.id);",2018-08-26 15:38:18.215111+10,4,0,270,noninterpretable
2769,"SELECT id
FROM person
GROUP BY id
HAVING MAX(year_born);
",2018-08-26 15:40:04.806784+10,3,0,227,partially correct
2770,"SELECT id
FROM ;",2018-08-26 15:42:05.930984+10,10,0,312,noninterpretable
2771,"select count(id)-(select count(id) from (select distinct id from director)) from person;
",2018-08-26 15:50:08.50641+10,12,1,85,correct
2772,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-26 15:51:02.918732+10,3,1,227,correct
2773,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-26 15:51:05.670942+10,3,1,227,correct
2774,"SELECT id
FROM scene s, role r, appearance a
WHERE r.title=a.title
AND a.title=s.title
AND s.scene_no=a.scene_no
AND s.production_year=a.production_year
AND r.production_year=a.production_year
AND s.production_year=1960
AND LOWER(a.title)='psycho'
GROUP BY id
HAVING COUNT(*)=1;",2018-08-26 15:54:00.99551+10,10,0,312,partially correct
2775,"select p.id, p.first_name, p.last_name from person p where p.id exists (select b.id, count(*) from (writer w natural join director d) b where b.id=p.id group by b.id having count(*)>1);",2018-08-26 15:55:22.87168+10,4,0,270,noninterpretable
2776,"select p.id, p.first_name, p.last_name from person p where exists (select b.id, count(*) from (writer w natural join director d) b where b.id=p.id group by b.id having count(*)>1);",2018-08-26 15:55:50.856893+10,4,1,270,correct
2777,"SELECT count(*) from writer

where person.id=writer.id And year_born='1935';
",2018-08-26 15:55:57.801634+10,1,0,198,noninterpretable
2778,"SELECT count(*) from person

where person.id=writer.id And year_born='1935';
",2018-08-26 15:57:00.671542+10,1,0,198,noninterpretable
2779,"SELECT id, award_name, year_of_award, category 
FROM director, director_award
WHERE director.title= director_award.title
AND director.result!='won'
( SELECT title, COUNT(*))
  FROM director
  GROUP BY title 
  HAVING COUNT(*)>=1);",2018-08-26 16:00:06.114025+10,13,0,227,noninterpretable
2780,"SELECT count(person.id) from personwriter

where person.id=writer.id And year_born='1935';
",2018-08-26 16:00:24.623662+10,1,0,198,noninterpretable
2781,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );
",2018-08-26 16:02:36.959372+10,13,1,227,correct
2782,"select person.id,person.first_name, person.last_name from
person,
(select director.id,count(director.id)as c from director left join writer on director.id=writer.id and director.title=writer.title group by director.id)temp
where person.id=temp.id and temp.c>=2;",2018-08-26 16:11:06.453671+10,4,0,85,partially correct
2783,"SELECT id
FROM (SELECT id p
      FROM person p;",2018-08-26 16:11:34.019894+10,14,0,227,noninterpretable
2784,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-26 16:13:09.777735+10,14,1,227,correct
2785,"select person.id,person.first_name, person.last_name from
person,
(select director.id,count(director.id)as c from director natural join writer group by director.id)temp
where person.id=temp.id and temp.c>=2;",2018-08-26 16:14:12.442002+10,4,1,85,correct
2786,"select * from SCENE;
",2018-08-26 16:14:58.248037+10,10,0,46,partially correct
2787,"select r.id
from role r,scene s,Appearance a
where r.title=s.title
      and s.title=a.title
      and s.scene_no=a.scene_no
      and r.title='Psycho'
      and r.production_year=s.production_year
      and a.production_year=s.production_year
      and r.production_year=1960
      AND a.description = r.description
group by r.id
having count(*)=1;",2018-08-26 16:20:22.505137+10,10,1,298,correct
2788,"SELECT COUNT(*)
FROM PERSON P
WHERE EXISTS (SELECT * FROM writer w where w.id=p.id and p.year_born = 1935);",2018-08-26 16:25:33.121827+10,1,1,198,correct
2789,"SELECT COUNT(*)
FROM PERSON P
WHERE EXISTS (SELECT * FROM writer w where w.id=p.id and p.year_born = 1935);",2018-08-26 16:25:51.437621+10,1,1,198,correct
2790,"select w.title,w.production_year
from person,writer as w
where person.id=w.id and person.first_name=""Kevin"" and person.last_name=""Williamson"";",2018-08-26 16:26:05.321545+10,5,1,85,correct
2791,"SELECT first_name, last_name, r.title, r.production_year, r.description 
FROM person, (SELECT id, COUNT(*) AS count_id
              FROM role) AS r
WHERE r.id= person.id;",2018-08-26 16:27:22.389971+10,15,0,227,noninterpretable
2792,"select country from restriction
where title=""Shakespeare in Love"" and description=""M"";",2018-08-26 16:29:11.852093+10,6,1,85,correct
2793,"SELECT COUNT(*) FROM movie
group by production_year
having production_year in (1993,1992,1991);",2018-08-26 16:29:55.272731+10,2,0,198,partially correct
2794,"SELECT production_year, COUNT(*) FROM movie
group by production_year
having production_year in (1993,1992,1991);",2018-08-26 16:30:29.521707+10,2,1,198,correct
2795,"SELECT COUNT(*) FROM person p
where Not exists (SELECT * from Director d where p.id=d.id);",2018-08-26 16:33:36.54466+10,12,1,198,correct
2796,"select p.id,p.first_name,p.last_name
from (select id,first_name,last_name,max(year_born) from person)as p;",2018-08-26 16:36:40.608899+10,7,1,85,correct
2797,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-26 16:37:13.63482+10,7,1,85,correct
2798,"SELECT COUNT(*)
FROM ( SELECT person.id 
       FROM person, director 
	   WHERE person.id=director.id
	   AND person.year_born='1935');",2018-08-26 16:39:04.325054+10,1,0,227,partially correct
2799,"SELECT COUNT(*)
FROM ( SELECT DISTINCT person.id 
       FROM person, director 
	   WHERE person.id=director.id
	   AND person.year_born='1935');",2018-08-26 16:42:37.783249+10,1,1,227,correct
2800,SELECT A FROM PERSON;,2018-08-26 16:45:49.413759+10,4,0,198,noninterpretable
2801,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year>1990
AND production_year<1994
GROUP BY production_year;",2018-08-26 16:51:27.803239+10,2,1,227,correct
2802,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year>1990
AND production_year<1994
GROUP BY production_year;",2018-08-26 16:51:34.907637+10,2,1,227,correct
2803,"SELECT COUNT(*)
FROM person 
WHERE NOT EXISTS ( SELECT director.* 
                   FROM director 
			WHERE director.id=person.id);",2018-08-26 16:54:10.641552+10,12,1,227,correct
2804,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-26 16:54:19.567324+10,6,1,70,correct
2805,"select id, first_name, last_name from person where year_born in (select min(year_born) from person);",2018-08-26 16:55:51.505221+10,7,0,70,partially correct
2806,"select id, first_name, last_name from person order by year_born desc limit 1;",2018-08-26 16:58:19.740789+10,7,1,70,correct
2807,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-26 17:02:28.817738+10,4,1,198,correct
2808,"select count(*)
from movie m
where  not exists (select s.title
                   from (Movie_Award ma,Crew_Award ca,Director_Award da,Writer_Award wa,
                            Actor_Award aa) as s
                       where s.title=ma.title
					and ca.title=s.title
					and da.title=s.title
					and wa.title=s.title
					and aa.title=m.title);
",2018-08-26 17:03:57.074811+10,11,0,298,partially correct
2809,"select ma.title, ma.production_year, t.first_name, t.last_name from movie_award as ma, (select * from person inner join director where person.id = director.id) as t where ma.award_name = 'BAFTA Film Award' and ma.category = 'Best Film' and t.title = ma.title and t.production_year = ma.production_year;",2018-08-26 17:07:07.198962+10,8,0,70,partially correct
2810,"select t.title,t.production_year,t.first_name,t.last_name
from (person natural join director natural join movie_award)as t
where t.award_name=""BAFTA Film Award"";",2018-08-26 17:07:12.239387+10,8,0,85,partially correct
2811,"select ma.title, ma.production_year, t.first_name, t.last_name from movie_award as ma, (select * from person inner join director where person.id = director.id) as t where lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film' and lower(ma.result) = 'won' and t.title = ma.title and t.production_year = ma.production_year;",2018-08-26 17:09:10.299514+10,8,1,70,correct
2812,"select t.title,t.production_year,t.first_name,t.last_name
from (person natural join director natural join movie_award)as t
where t.award_name=""BAFTA Film Award"" and lower(t.category)=""best film"";",2018-08-26 17:10:29.872601+10,8,0,85,partially correct
2813,"select t.title,t.production_year,t.first_name,t.last_name
from (person natural join director natural join movie_award)as t
where t.award_name=""BAFTA Film Award"" and lower(t.category)=""best film"" and result=""won"";",2018-08-26 17:11:45.626635+10,8,1,85,correct
2814,select count(*) from writer_award as w inner join person as p where p.first_name = 'Woody' and p.last_name = 'Allen' and p.id = w.id and w.year_of_award between 1991 and 1996;,2018-08-26 17:14:05.870001+10,9,0,70,partially correct
2815,select count(distinct(award_name)) from writer_award as w inner join person as p where p.first_name = 'Woody' and p.last_name = 'Allen' and p.id = w.id and w.year_of_award between 1991 and 1995;,2018-08-26 17:15:43.102629+10,9,1,70,correct
2847,"SELECT country
FROM restriction r
WHERE EXISTS (SELECT * FROM restriction_category rc WHERE rc.country = r.country AND r.title = 'Shakespeare in Love' 
AND description='M');",2018-08-26 18:50:18.177447+10,6,1,319,correct
2816,"select id from role as r, 
(select * from appearance as a inner join scene as s where s.title = 'Psycho' and s.production_year = 1960 and s.scene_no = a.scene_no) as t 
where t.title = r.title and t.production_year = r.production_year and t.description = r.description group by id having count(*) = 1;",2018-08-26 17:33:39.16782+10,10,0,70,partially correct
2817,"select r.id 
from scene s, appearance a, role r 
where s.title=a.title 
and s.production_year=a.production_year
and s.scene_no = a.scene_no
and s.title = r.title
and s.production_year = r.production_year
and a.description = r.description
and lower(a.title) = 'psycho'
and a.production_year = 1960
group by 
    r.id
having count(*)=1;
",2018-08-26 17:38:15.623085+10,10,1,46,correct
2818,"select r.id from role as r, 
(select * from appearance as a inner join scene as s where lower(s.title) = 'psycho' and s.production_year = 1960 and s.scene_no = a.scene_no and s.production_year = a.production_year) as t 
where t.title = r.title and t.production_year = r.production_year and t.description = r.description group by r.id having count(*) = 1;",2018-08-26 17:38:19.989384+10,10,1,70,correct
2819,"select count(*) from movie where title, production_year not in (select distinct(title), distinct(production_year) from movie_award, crew_award, director_award, writer_award and actor_award);",2018-08-26 17:42:02.555598+10,11,0,70,noninterpretable
2820,"SELECT dw.ID, dw.first_name, dw.last_name
FROM ( Person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.ID HAVING COUNT(*) >1;",2018-08-26 17:42:15.167551+10,4,1,319,correct
2821,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-26 17:42:48.253845+10,11,1,70,correct
2822,"SELECT a.id, a.first_name, a.last_name
FROM person a, (SELECT id, COUNT(*)
      FROM director, writer 
	 WHERE director.id=writer.id
	 AND director.title=writer.title
	 GROUP BY id) AS h,
WHERE person.id=h.id
HAVING COUNT(*)>1
GROUP BY id;",2018-08-26 17:44:34.403722+10,4,0,227,noninterpretable
2823,"SELECT a.id, a.first_name, a.last_name
FROM person a, (SELECT id, COUNT(*)
      FROM director, writer 
	 WHERE director.id=writer.id
	 AND director.title=writer.title) AS h,
WHERE person.id=h.id
HAVING COUNT(*)>1
GROUP BY id;",2018-08-26 17:45:55.287138+10,4,0,227,noninterpretable
2824,"SELECT title, production_year from
person p natural join writer was abs
where abs.firstname='Kevin' and abs.lastname='Williamson';",2018-08-26 17:50:43.466639+10,5,0,198,noninterpretable
2825,;,2018-08-26 17:51:53.256545+10,9,0,138,noninterpretable
2826,select id from person where year_born in (select max(year_born) from person where year_born not in (select max(year_born) from person));,2018-08-26 17:55:29.571196+10,3,1,70,correct
2827,"SELECT pw.title, pw.production_title
FROM (person p NATURAL JOIN writer w) AS pd ORDER BY pw.production_title 
WHERE EXISTS pw.first_name = 'Kevin' AND pw.last_name = 'Williamson';",2018-08-26 17:56:57.256353+10,5,0,319,noninterpretable
2828," SELECT title, production_year
 FROM writer, person 
 WHERE writer.id=person.id
 AND lower(first_name)='kevin'
 AND lower(last_name)='williamson';",2018-08-26 17:59:02.679266+10,5,1,227,correct
2829,"SELECT country
FROM restriction 
WHERE lower(title)='shakespeare in love'
AND description='M';",2018-08-26 18:00:43.510134+10,6,1,227,correct
2830,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-26 18:03:58.488603+10,5,1,198,correct
2831,"SELECT person.id, person.first_name, person.last_name 
FROM person, (SELECT person.*,MAX(year_born)
      FROM person) AS h
WHERE person.id=h.id;",2018-08-26 18:04:32.973959+10,7,1,227,correct
2832,"select id, award_name,year_of_award, category from director_award as da inner join director as d where 
da.production_year = d.production_year and da.title = d.title and lower(da.result) = 'nominated' and id not in 
(select id from director_award as da inner join director as d where 
da.production_year = d.production_year and da.title = d.title and lower(da.result) = 'won');",2018-08-26 18:05:07.933954+10,13,1,70,correct
2833,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id 
AND lower(first_name) = 'kevin' AND lower(last_name)='williamson';",2018-08-26 18:11:00.076779+10,5,1,319,correct
2834,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
FROM movie_award ma, director d, person p
WHERE ma.title=d.title
AND d.id=p.id
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award';",2018-08-26 18:11:27.229368+10,8,0,227,partially correct
2835,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name 
FROM movie_award ma, director d, person p
WHERE ma.title=d.title
AND d.id=p.id
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award';",2018-08-26 18:11:48.720405+10,8,0,227,partially correct
2836,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name 
FROM movie_award ma, director d, person p
WHERE ma.title=d.title
AND d.id=p.id
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award'
AND lowe(ma.result)='won';",2018-08-26 18:12:13.336649+10,8,0,227,noninterpretable
2837,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name 
FROM movie_award ma, director d, person p
WHERE ma.title=d.title
AND d.id=p.id
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award'
AND lower(ma.result)='won';",2018-08-26 18:12:32.724002+10,8,1,227,correct
2838,"SELECT DISTINCT country from restriction
WHERE lower(title) = 'shakespeare in love' and description = 'M';",2018-08-26 18:14:03.857449+10,6,1,198,correct
2839,"SELECT ID, FIRST_NAME, LAST_NAME FROM PERSON
order by year_born desc
limit 1;",2018-08-26 18:18:21.352834+10,7,1,198,correct
2840,"select t.id from (select id, max(count(*)) from director join writer where director.id = writer.id group by id) as t;",2018-08-26 18:19:23.374744+10,14,0,70,noninterpretable
2841,"SELECT count(*)
FROM (SELECT * 
      FROM writer_award wa NATURAL JOIN person p) AS s
WHERE lower(s.first_name)='woody'
AND lower(s.last_name)='allen'
AND s.year_of_award>=1991
AND s.year_of_award<=1995
AND lower(s.result)='won';",2018-08-26 18:25:21.349766+10,9,1,227,correct
2842,"SELECT pi.*, title, production from (SELECT id, first_name, last_name from person p
left join director d
on p.id=d.id) as pi, movie_award ma
WHERE ma.award_name ='BAFTA Film Award' 
	And ma.category='Best Film'
	And pi.title=ma.title;",2018-08-26 18:30:58.605606+10,8,0,198,noninterpretable
2843,"SELECT pi.*, ma.title, ma.production_year from 
(SELECT * from director d
left join person p
on p.id=d.id) as pi, movie_award ma
WHERE lower(ma.award_name) ='bafta film award' 
	And Lower(ma.category)='best film'
	And pi.production_year=ma.production_year
	And pi.title=ma.title;",2018-08-26 18:37:36.213707+10,8,0,198,partially correct
2844,"SELECT pi.first_name, pi.last_name, ma.title, ma.production_year from 
(SELECT * from director d
left join person p
on p.id=d.id) as pi, movie_award ma
WHERE lower(ma.award_name) ='bafta film award' 
	And Lower(ma.category)='best film'
	And lower(result)='won'
	And pi.production_year=ma.production_year
	And pi.title=ma.title;",2018-08-26 18:39:20.214679+10,8,1,198,correct
2845,"SELECT ma.title, ma.production_year, pi.first_name, pi.last_name from 
(SELECT * from director d
left join person p
on p.id=d.id) as pi, movie_award ma
WHERE lower(ma.award_name) ='bafta film award' 
	And Lower(ma.category)='best film'
	And lower(result)='won'
	And pi.production_year=ma.production_year
	And pi.title=ma.title;",2018-08-26 18:40:36.808239+10,8,1,198,correct
2849,"SELECT id 
FROM role, ( SELECT scene_no, COUNT(*) AS sc
       FROM scene) AS h, scene a
WHERE lower(a.title)='psycho'
AND a.production_year='1960'
AND h.sc=scene.scene_no
GROUP BY id
HAVING COUNT(*)=1;
",2018-08-26 18:57:48.202912+10,10,0,227,noninterpretable
2850,"SELECT count(*) from 
	(SELECT award_name from writer_award wa, writer w, person p
	WHERE wa.id=w.id=p.id
	AND wa.production_year in (1991,1992,1993,1994,1995)
	And lower(p.first_name)='woody'
	And lower(p.last_name)='allen') as a;",2018-08-26 19:02:17.755189+10,9,0,198,partially correct
2851,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:30.110812+10,9,0,138,noninterpretable
2852,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:30.249624+10,9,0,138,noninterpretable
2853,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:30.402832+10,9,0,138,noninterpretable
2854,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:30.582785+10,9,0,138,noninterpretable
2855,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:30.921188+10,9,0,138,noninterpretable
2856,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:31.172946+10,9,0,138,noninterpretable
2857,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:31.38043+10,9,0,138,noninterpretable
2858,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:31.555824+10,9,0,138,noninterpretable
2859,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:31.783602+10,9,0,138,noninterpretable
2860,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:31.961663+10,9,0,138,noninterpretable
2861,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:32.181213+10,9,0,138,noninterpretable
2862,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:32.367035+10,9,0,138,noninterpretable
2863,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:32.558767+10,9,0,138,noninterpretable
2864,"select count(*)
from crew, crew_award
where crew.id = crew_award.id and lower(crew_awrad.result) = 'won';
",2018-08-26 19:02:32.767431+10,9,0,138,noninterpretable
2865,select count(*) from Person where year_born = 1935;,2018-08-26 19:05:19.314981+10,1,0,331,partially correct
2866,"select count(id)
from Person
where year_born = 1935;",2018-08-26 19:07:18.891654+10,1,0,330,partially correct
2867,"SELECT r.id
FROM appearance a, scene s, role r
WHERE a.title=s.title
AND lower(a.title)='psycho'
AND a.production_year=1960
AND s.production_year=r.production_year
AND s.production_year=a.production_year
AND r.title=s.title
AND s.scene_no=a.scene_no
GROUP BY r.id
HAVING COUNT (*)=1;",2018-08-26 19:09:21.902976+10,10,0,227,partially correct
2868,;,2018-08-26 19:09:25.72944+10,5,0,303,noninterpretable
2869,select count(*) from Person p where exists (select * from Writer w where w.id = p.id and p.year_born=1935);,2018-08-26 19:09:29.541664+10,1,1,331,correct
2870,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-26 19:09:47.20189+10,5,1,303,correct
2871,;,2018-08-26 19:10:09.165176+10,6,0,303,noninterpretable
2872,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-26 19:10:31.18508+10,6,1,303,correct
2873,"SELECT id,first_name,last_name
FROM PERSON
WHERE year_born=(
SELECT MAX(year_born)
FROM PERSON);",2018-08-26 19:19:05.280085+10,7,1,303,correct
2874,;,2018-08-26 19:20:43.229699+10,11,0,303,noninterpretable
2875,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-26 19:21:14.025747+10,11,1,303,correct
2876,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-26 19:21:56.151308+10,8,1,85,correct
2877,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-26 19:25:30.049868+10,9,1,198,correct
2878,"select count(*)
from (person natural join writer_award) as pw
where pw.first_name=""Woody"" and pw.last_name=""Allen"" and pw.year_of_award>1991 and pw.year_of_award<1995 and pw.result=""won"";",2018-08-26 19:26:45.222357+10,9,0,85,partially correct
2879,"select count(id)
from PERSON
where year_born = 1935;",2018-08-26 19:27:02.344275+10,1,0,332,partially correct
2880,"select count(*)
from (person natural join writer_award) as pw
where pw.first_name=""Woody"" and pw.last_name=""Allen"" and pw.year_of_award>=1991 and pw.year_of_award<=1995 and pw.result=""won"";",2018-08-26 19:27:20.138875+10,9,1,85,correct
2881,"select count(*)
from PERSON p
where (select * from writer w where w.id=p.id and p.year_born = 1935);",2018-08-26 19:29:48.35681+10,1,0,332,noninterpretable
2882,"SELECT id
FROM scene s, role r, appearance a
WHERE r.title=a.title
AND a.title=s.title
AND s.scene_no=a.scene_no
AND s.production_year=a.production_year
AND r.production_year=a.production_year
AND a.description=r.description
AND s.production_year=1960
AND LOWER(a.title)='psycho'
GROUP BY id
HAVING COUNT(*)=1;",2018-08-26 19:29:50.486261+10,10,1,312,correct
2883,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-26 19:31:10.115137+10,11,1,227,correct
2884,"SELECT Writer.id FROM Writer, Person
Where Person.year_born ='1935' 
AND Person.id = Writer.id;
",2018-08-26 19:31:22.026629+10,1,0,218,partially correct
2885,"select pr.id
from (person natural join role) as pr
where title=""Psycho"" and production_year=1960;
",2018-08-26 19:32:09.512641+10,10,0,85,partially correct
2886,"select pr.id
from (person natural join role natural join appearance) as pr
where lower(title)=""psycho"" and production_year=1960
group by pr.id
having count(*)=1;
",2018-08-26 19:36:25.526896+10,10,1,85,correct
2888,"select count(*), production_year
from movie
where production_year = 1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-26 19:42:53.373914+10,2,1,332,correct
2889,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born)
                   FROM person 
			  WHERE year_born<(SELECT MAX(year_born)
			                    FROM person));
",2018-08-26 19:43:55.678898+10,3,1,227,correct
2890,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person ); ",2018-08-26 19:44:19.493059+10,7,1,319,correct
2891,"select production_year, count(*)
from movie
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-26 19:44:58.456756+10,2,1,332,correct
2892,"select count(*)
from person p
left join director d on p.id = d.id;",2018-08-26 19:47:40.874336+10,12,0,332,partially correct
2893,"select count(*), production_year
from(
select *
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991)
group by production_year;",2018-08-26 19:50:43.598031+10,2,1,330,correct
2894,"select production_year, count(*)
from(
select *
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991)
group by production_year;",2018-08-26 19:52:10.409255+10,2,1,330,correct
2895,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(
SELECT ma.title, ca.title, da.title, wa.title, aa.title
FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa);",2018-08-26 19:53:20.963582+10,11,0,312,partially correct
2896,"SELECT title, production_year, first_name, last_name
FROM award a, director d
WHERE EXISTS (SELECT * p.id = d.id )
lower(award_name = 'BAFTA Film Award')
AND lower( category = 'Best Film');",2018-08-26 19:54:27.784269+10,8,0,319,noninterpretable
2897,"select title, production_year from writer w, person p where p.id=w.id and first_name='Kevin' and last_name='Williamson';",2018-08-26 19:57:00.615497+10,5,1,270,correct
2898,"select id, first_name, last_names
from person p
where exists (select * from write);",2018-08-26 19:57:15.725362+10,4,0,332,noninterpretable
2899,"select title, production_year
from writer
where id=""Kevin Williamson""
group by title;",2018-08-26 19:57:55.532261+10,5,0,235,partially correct
2900,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-26 19:58:49.722465+10,11,1,312,correct
2901,"select writer.title, writer.production_year
from writer join person, writer.id = person.id 
where person.first_name = ""kevin*"" and person.last_name= ""*Williamson"" 
group by title;",2018-08-26 20:02:58.38374+10,5,0,235,noninterpretable
2902,"select writer.title, writer.production_year
from writer join person, writer.id = person.id 
where person.first_name = ""kevin*"" and person.last_name= ""*Williamson"" 
group by title;",2018-08-26 20:03:11.790175+10,5,0,235,noninterpretable
2903,"SELECT DISTINCT COUNT(*)
FROM  Person
Where EXISTS(SELECT * FROM WRITER 
WHERE Person.year_born ='1935' 
AND Person.id = Writer.id);
",2018-08-26 20:03:36.814335+10,1,1,218,correct
2904,"select count(*) from Person,Writer where Person.id = Writer.id
and year_born = '1935';",2018-08-26 20:03:54.238652+10,1,0,333,partially correct
2905,"select writer.title, writer.production_year
from writer join person
where writer.id = person.id  and person.first_name = ""kevin*"" and person.last_name= ""*Williamson"" 
group by writer.title;",2018-08-26 20:04:14.665641+10,5,0,235,partially correct
2906,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-26 20:05:55.621522+10,6,1,270,correct
2907,"select count(distinct p.id) from person p inner join writer w on p.id = w.id where p.year_born = 1935 ;



",2018-08-26 20:08:29.842983+10,1,1,172,correct
2908,"select p.id, p.first_name, p.last_name from person p where p.year_born=(select max(year_born) from person);",2018-08-26 20:09:51.16876+10,7,1,270,correct
2909,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-26 20:11:28.430794+10,11,1,312,correct
2910,SELECT id FROM director WHERE director.id IN (SELECT d.id FROM director d JOIN writer w ON d.id=w.id) GROUP BY id HAVING count(director.id)>=2;,2018-08-26 20:16:24.759693+10,4,0,63,partially correct
2911,"select count(id) from (select distinct id from writer) as foo;
",2018-08-26 20:18:13.31881+10,1,0,91,partially correct
2912,"select p.first_name, p.last_name, m.title, m.production_year from person p natural join director d natural join movie_award m where award_name='BAFTA Film Award' and category='Best Film';",2018-08-26 20:20:02.505588+10,8,0,270,partially correct
2913,"Select distinct count(p.year_born)
from writer w inner join person p on p.id = w.id
group by p.id
having p.year_born = 1935;",2018-08-26 20:22:27.791606+10,1,0,321,partially correct
2914,select count(*) from Person p where exists (select * from Writer w where p.id = w.id and p.year_born = 1935);,2018-08-26 20:23:02.610102+10,1,1,333,correct
2915,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1993' 
AND production_year='1992' 
AND production_year='1991';",2018-08-26 20:25:30.564442+10,2,0,218,partially correct
2916,"select production_year, count(*) as number_of_movies from movie where production_year in (1993,1992,1991) group by production_year;",2018-08-26 20:26:07.633688+10,2,1,333,correct
2917,SELECT country FROM restriction WHERE title='Shakespeare in Love' AND description='M';,2018-08-26 20:27:04.198659+10,6,1,63,correct
2918,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1993'
OR production_year='1992' 
OR production_year='1991'
Group By production_year;
",2018-08-26 20:27:42.073466+10,2,1,218,correct
2919,"SELECT id, first_name, last_name FROM person p WHERE year_born IN (SELECT MAX(year_born) FROM person);",2018-08-26 20:30:24.730936+10,7,1,63,correct
2920,"SELECT count(*) FROM PERSON p
WHERE NOT EXISTS(SELECT id FROM DIRECTOR d
WHERE d.id = p.id);",2018-08-26 20:32:30.928026+10,12,1,218,correct
2921,"select production_year, count(title) from movie where production_year in(1993, 1992, 1991) group by production_year;",2018-08-26 20:35:23.299015+10,2,1,172,correct
2922,"select count(distinct w.id)
from writer w left join person p on p.id = w.id
where p.year_born = 1935;",2018-08-26 20:38:58.851102+10,1,1,321,correct
2923,"Select m.production_year, count(m.production_year)
from (Select production_year
from movie
where production_year = 1993 or  production_year = 1992 or production_year = 1991) as m
group by m.production_year;",2018-08-26 20:39:28.033362+10,2,1,321,correct
2924,"SELECT id
FROM ROLE
WHERE (SELECT * FROM APPEARANCE
WHERE lower(title)='psycho' AND production_year=1960 AND scene_no=1);",2018-08-26 20:40:53.142609+10,10,0,185,noninterpretable
2925,"WITH nf AS(SELECT *
FROM person
WHERE NOT EXISTS (
SELECT MAX(year_born)
FROM person))
SELECT nf.id
FROM nf
WHERE nf.year_born=(
SELECT MAX(year_born)
FROM nf);

",2018-08-26 20:40:54.117762+10,3,0,312,partially correct
2926,"Select count(*)
from person p left join director d on p.id = d.id
where d.id = '' or d.id is null;",2018-08-26 20:41:06.983204+10,12,1,321,correct
2927,"select count(distinct person.id) from person inner join writer on person.id=writer.id and person.year_born='1935';
",2018-08-26 20:41:11.635822+10,1,1,91,correct
2928,"Select p.id, p.first_name, p.last_name
from person p 
where (Select distinct d.id 
from director d inner join writer w on d.id = w.id and d.title = w.title where d.id = p.id) = p.id
order by p.id asc;",2018-08-26 20:41:54.171026+10,4,0,321,partially correct
2929,"SELECT DISTINCT id,first_name,last_name 
FROM person p
WHERE EXISTS (SELECT d.title,d.id FROM DIRECTOR d, WRITER w WHERE
w.id = d.id AND d.title = w.title);",2018-08-26 20:43:34.880145+10,4,0,218,partially correct
2930,"SELECT count(*)
FROM person
WHERE NOT EXISTS (
SELECT *
FROM director
WHERE person.id=director.id);",2018-08-26 20:46:31.161177+10,12,1,330,correct
2931,"SELECT id
FROM ROLE
WHERE (SELECT * FROM APPEARANCE
WHERE lower(title)='psycho' AND production_year=1960 AND ROLE.title=APPEARANCE.title
AND ROLE.production_year=APPEARANCE.production_year);",2018-08-26 20:47:12.244434+10,10,0,185,noninterpretable
2932,"
select count(distinct writer.id) from writer,person where writer.id=person.id and person.year_born='1935';",2018-08-26 20:47:13.390769+10,1,1,91,correct
2933,"select count(*) from Person p where NOT EXISTS (Select * from Director d where p.id = d.id);
",2018-08-26 20:47:49.094095+10,12,1,333,correct
2934,"SELECT * FROM movie_award a LEFT JOIN director d ON d.title = a.title AND d.production_year = a.production_year  WHERE lower(category)='b
        est film' AND award_name='BAFTA Film Award';",2018-08-26 20:48:13.069687+10,8,0,63,partially correct
2935,select count(*) from person p where not exists (select * from director d where d.id = p.id);,2018-08-26 20:48:47.059097+10,12,1,172,correct
2936,"SELECT id
FROM ROLE
WHERE (SELECT * FROM APPEARANCE
WHERE lower(title)='psycho' AND production_year=1960 AND ROLE.title=APPEARANCE.title
AND ROLE.production_year=APPEARANCE.production_year)
GROUP BY id
HAVING COUNT(*)=1;
",2018-08-26 20:48:50.907451+10,10,0,185,noninterpretable
2937,"Select p.id, p.first_name, p.last_name
from person p 
where (Select distinct d.id
from director d inner join writer w on d.id = w.id and d.title = w.title
where d.id = p.id
group by d.id
having count(*) > 1) = p.id
order by p.id asc;",2018-08-26 20:49:02.324016+10,4,1,321,correct
2938,"Select w.title, w.production_year
from writer w
where w.id = (Select p.id from person p where p.first_name ='Kevin' and p.last_name = 'Williamson');",2018-08-26 20:49:32.843741+10,5,1,321,correct
2939,Select distinct r.country from restriction r where r.title = 'Shakespeare in Love' and r.description = 'M';,2018-08-26 20:49:49.934741+10,6,1,321,correct
2940,"select count(distinct person.id) from person inner join writer on person.id=writer.id and person.year_born='1935';

",2018-08-26 20:50:01.248707+10,1,1,91,correct
2941,"select p.id, p.first_name, p.last_name
from person p
where p.year_born = (select max(p1.year_born) from person p1);",2018-08-26 20:50:22.745442+10,7,1,321,correct
2942,"select m.title, m.production_year, p.first_name, p.last_name 
from person p, director d, movie_award m
where m.award_name = 'BAFTA Film Award' and lower(m.result) = 'won' and lower(m.category) = 'best film' and m.title = d.title and d.id = p.id;",2018-08-26 20:50:47.30945+10,8,1,321,correct
2943,"select count(*)
from writer_award wa
where lower(wa.result) = 'won' and wa.year_of_award >= 1991 and wa.year_of_award <=1995 and wa.id = (select p.id
from person p
where p.first_name = 'Woody' and p.last_name = 'Allen');",2018-08-26 20:51:34.651296+10,9,1,321,correct
2944,"select r.id
from role r
where r.production_year = 1960 and (select distinct a.description
from appearance a
where lower(a.title) = 'psycho' and a.production_year = 1960 and a.scene_no = 1 and a.description = r.description) = r.description;",2018-08-26 20:51:55.251171+10,10,0,321,partially correct
2945,;,2018-08-26 20:53:26.390434+10,2,0,91,noninterpretable
2946,"SELECT title, COUNT(*)
FROM MOVIE
WHERE NOT EXISTS (SELECT title 
FROM MOVIE_AWARD, CREW_AWARD, DIRECTOR_AWARD, WRITER_AWARD, ACTOR_AWARD
WHERE MOVIE.title=MOVIE_AWARD.title AND MOVIE.title=CREW_AWARD.title
AND MOVIE.title=DIRECTOR_AWARD.title AND MOVIE.title=WRITER_AWARD.title
AND MOVIE.title=ACTOR_AWARD.title);",2018-08-26 20:57:13.237644+10,11,0,185,noninterpretable
2947,"SELECT dw.id,dw.first_name,dw.last_name 
FROM  (Person p INNER JOIN Director d INNER JOIN
WRITER w ON d.id=w.id AND d.title = w.title AND p.id=w.id) AS dw
GROUP BY dw.id HAVING COUNT(*) >1;",2018-08-26 20:59:51.221234+10,4,1,218,correct
2948,"select production_year, count(*) from movie where production_year = 1991 or production_year = 1992 or production_year = 1993 group by production_year ;",2018-08-26 21:00:11.353674+10,2,1,331,correct
2949,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));
",2018-08-26 21:01:04.074388+10,3,1,312,correct
2950,"select production_year, count(production_year) from movie group by production_year having production_year>1990 and production_year<1994;",2018-08-26 21:01:50.607582+10,2,1,91,correct
2951,"SELECT country
FROM restriction r
WHERE r.description='M' AND r.title='Shakespeare in Love'
GROUP BY country;",2018-08-26 21:03:09.799038+10,6,1,204,correct
2952,"select r.id
from role r
where r.production_year = 1960 and (select a.description
from appearance a
where lower(a.title) = 'psycho' and a.production_year = 1960 and a.description = r.description
group by a.description
having count(a.description) = 1) = r.description;",2018-08-26 21:03:32.533098+10,10,1,321,correct
2953,"select person.id, first_name, last_name from person natural join (director natural join writer) group by person.id having count(*) >= 2;",2018-08-26 21:04:24.739743+10,4,1,172,correct
2954,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM (SELECT
title, production_year
FROM movie_award
WHERE lower(award_name)= 'bafta film award' AND lower(category)= 'best film' AND lower(RESULT)= 'won') AS ma, person p, director d
WHERE d.id=p.id AND ma.title=d.title AND ma.production_year=d.production_year;
",2018-08-26 21:06:44.770056+10,8,1,63,correct
2955,select * from Person p except  select * from Director d where p.id = d.id;,2018-08-26 21:08:30.188656+10,12,0,331,noninterpretable
2956,select count(*) from Person p where not exists( select * from Director d where p.id = d.id) ;,2018-08-26 21:09:28.738423+10,12,1,331,correct
2957,SELECT COUNT(*) FROM writer_award wa NATURAL JOIN person p WHERE wa.year_of_award<=1995 AND wa.year_of_award>=1991 AND lower(p.first_name)='woody' AND lower(p.last_name)='allen';,2018-08-26 21:12:11.14764+10,9,0,63,partially correct
2958,"SELECT id,first_name,last_name,
FROM person
HAVING MIN(year_born);",2018-08-26 21:12:40.017322+10,7,0,204,noninterpretable
2959,"select title, production_year from writer natural join person where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-26 21:13:12.466155+10,5,1,172,correct
2960,;,2018-08-26 21:13:12.579941+10,12,0,91,noninterpretable
2961,SELECT COUNT(*) FROM writer_award wa NATURAL JOIN person p WHERE wa.year_of_award<=1995 AND  lower(wa.result)='won' AND wa.year_of_award>=1991 AND lower(p.first_name)='woody' AND lower(p.last_name)='allen';,2018-08-26 21:14:00.988885+10,9,1,63,correct
2962,"SELECT COUNT(*)
FROM MOVIE
WHERE NOT EXISTS (SELECT title FROM MOVIE_AWARD
WHERE MOVIE.title=MOVIE_AWARD.title AND MOVIE.production_year=MOVIE_AWARD.production_year AND lower(result)='won'
UNION SELECT title FROM CREW_AWARD
WHERE MOVIE.title=CREW_AWARD.title AND MOVIE.production_year=CREW_AWARD.production_year AND lower(result)='won'
UNION SELECT title FROM DIRECTOR_AWARD
WHERE MOVIE.title=DIRECTOR_AWARD.title AND MOVIE.production_year=DIRECTOR_AWARD.production_year AND lower(result)='won'
UNION SELECT title FROM WRITER_AWARD
WHERE MOVIE.title=WRITER_AWARD.title AND MOVIE.production_year=WRITER_AWARD.production_year AND lower(result)='won'
UNION SELECT title FROM ACTOR_AWARD
WHERE MOVIE.title=ACTOR_AWARD.title AND MOVIE.production_year=ACTOR_AWARD.production_year AND lower(result)='won');",2018-08-26 21:14:48.043108+10,11,1,185,correct
2963,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born = (SELECT max(year_born) FROM person);",2018-08-26 21:15:33.699345+10,7,1,204,correct
2964,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-26 21:16:23.421795+10,6,1,172,correct
2965,"select id, first_name, last_name
from person
WHERE EXISTS (
select id
from(
SELECT count(*) as c, *
FROM director
group by id)
where c > 1 and person.id = id);",2018-08-26 21:16:38.06642+10,4,0,330,partially correct
2966,"SELECT kw.title,kw.production_year 
FROM (Person p INNER JOIN WRITER w INNER JOIN MOVIE m 
on w.title = m.title AND p.first_name ='Kevin' AND p.last_name = 'Williamson') AS kw
GROUP BY kw.title;",2018-08-26 21:17:16.649973+10,5,0,218,partially correct
2967,SELECT description FROM appearance  GROUP BY description HAVING COUNT(*)=1;,2018-08-26 21:17:21.450171+10,10,0,63,partially correct
2968,"select id, first_name, last_name from Person p where exists 
(select * from Writer w, Director d where p.id = w.id and d.id = w.id and p.id = d.id and d.title = w.title group by d.id having count(*) >= 2);
",2018-08-26 21:17:44.953652+10,4,1,333,correct
2969,"select writer.count(id) form writer where writer.id IN

(select id.* from person where person.year_born = '1935');

 ",2018-08-26 21:20:55.80099+10,1,0,65,noninterpretable
2970,"select id
from appearance a natural join role r
where (title, production_year) = ('Psycho', 1960)
group by id, description
having count(*) = 1;",2018-08-26 21:25:20.545736+10,10,1,116,correct
2971,"select id, first_name, last_name from Person p where exists (select * from Writer w where w.id= p.id group by w.id having count(*)>1 );",2018-08-26 21:25:36.297104+10,4,0,331,partially correct
2972,l;,2018-08-26 21:26:42.331673+10,11,0,63,noninterpretable
2973,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-26 21:27:48.921749+10,12,1,91,correct
2974,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT id FROM WRITER
WHERE WRITER.id=person.id);",2018-08-26 21:28:46.818043+10,1,0,185,partially correct
2975,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT WRITER.id FROM WRITER
WHERE WRITER.id=person.id) AND year_born=1935;",2018-08-26 21:30:23.807936+10,1,1,185,correct
2976,"select id,first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-26 21:31:14.720947+10,7,1,172,correct
2977,"select id from person p 
where exists (select count(*) from director d
natural join writer w );",2018-08-26 21:31:58.445747+10,14,0,265,partially correct
2978,select *from Person  ;,2018-08-26 21:34:02.085602+10,4,0,331,partially correct
2979,"SELECT title,production_year,first_name, last_name
FROM movie_award m,(SELECT first_name,last_name,title FROM person p, director d WHERE p.id=d.id) AS pd
WHERE m.title=pd.title 
AND lower(m.award_name)='bafta film award'
AND lower(m.category)='best film';
",2018-08-26 21:35:18.879689+10,8,0,204,noninterpretable
2980,"SELECT COUNT(*) FROM writer, person WHERE writer.id=person.id AND person.year_born=1935;",2018-08-26 21:38:43.074465+10,1,0,63,partially correct
2981,"SELECT COUNT(DISTINCT person.id) FROM writer, person WHERE writer.id=person.id AND person.year_born=1935;",2018-08-26 21:40:51.578559+10,1,1,63,correct
2982,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-26 21:42:18.971107+10,8,1,204,correct
2983,"SELECT id, first_name, last_name
FROM person
WHERE (SELECT * FROM DIRECTOR
WHERE DIRECTOR.id=person.id AND COUNTtitle)>1
UNION SELECT * FROM WRITER
WHERE WRITER.id=DIRECTOR.id);",2018-08-26 21:43:05.824322+10,4,0,185,noninterpretable
2984,"select p.title,p.production_year,p.first_name, p.last_name from ((movie_award natural join director) natural join person) as p where p.category = 'best film' and p.award_name = 'BAFTA Film Award' and p.result = 'won' ;",2018-08-26 21:43:27.308203+10,8,1,172,correct
2985,"SELECT production_year, count(title) FROM movie GROUP BY production_year HAVING production_year=1991 OR production_year=1992 OR production_year=1993;

",2018-08-26 21:43:39.472657+10,2,1,63,correct
2986,SELECT COUNT(p.id) FROM person p WHERE p.id NOT IN (SELECT id FROM director);,2018-08-26 21:44:53.658899+10,12,1,63,correct
2987,"select production_year,count(*)
from movie m
where  production_year > 1990
and  production_year<1994
group by production_year ;",2018-08-26 21:46:24.841014+10,2,1,265,correct
2988,"SELECT id, first_name, last_name
FROM person
WHERE EXISTS (SELECT *
FROM (
select id
from(
SELECT count(*) as c, *
FROM writer
WHERE EXISTS (SELECT *
FROM director
WHERE director.id=writer.id)
group by id)
where c > 1
)
WHERE person.id=id)
ORDER BY id ASC;",2018-08-26 21:48:39.590459+10,4,1,330,correct
2989,"select count(*)
from person p
where not exists (select * from director d 
where d.id = p.id);",2018-08-26 21:49:51.233131+10,12,1,265,correct
2990,"SELECT id
FROM person
WHERE ;",2018-08-26 21:53:39.130686+10,3,0,185,noninterpretable
2991,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-26 21:53:46.961685+10,4,1,331,correct
2992,select count(*) as awards from (person natural join writer_award)  as pw where pw.first_name = 'Woody' and pw.last_name = 'Allen' and pw.year_of_award >= 1991 and pw.year_of_award <= 1995 and pw.result = 'won';,2018-08-26 21:54:35.040427+10,9,1,172,correct
2993,SELECT COUNT(*) FROM WRITER ;,2018-08-26 21:56:48.215628+10,1,0,329,partially correct
2994,;,2018-08-26 21:57:20.570797+10,4,0,91,noninterpretable
2995,"SELECT id
FROM person
WHERE person.year_born= (SELECT MAX(year_born) FROM person
WHERE year_born< (SELECT MAX(year_born) FROM person));
",2018-08-26 21:59:51.093275+10,3,1,185,correct
2996,"SELECT kw.title,kw.production_year 
FROM (Person p INNER JOIN WRITER w INNER JOIN MOVIE m 
on w.title = m.title AND p.first_name ='Kevin' AND p.last_name = 'Williamson' AND w.id = p.id) AS kw
GROUP BY kw.title;",2018-08-26 22:00:31.44395+10,5,1,218,correct
2997,"SELECT count(*)
FROM (SELECT first_name,last_name,id 
FROM person 
WHERE lower(first_name)='woody'
AND lower(last_name)='allen') AS p
writer_award AS wa
WHERE p.id=wa.id
AND writer_award.year_of_award>1990
AND writer_award.year_of_award<1996
AND writer_award.result='won';",2018-08-26 22:01:31.860177+10,9,0,204,noninterpretable
2998,"select title, production_year from Writer w where exists (select * from Person p where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');
",2018-08-26 22:03:41.642517+10,5,1,333,correct
2999,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-26 22:05:03.706086+10,9,1,204,correct
3000,select country from Restriction where title like '%Shakespeare in Love%' and Description like '%M';,2018-08-26 22:06:16.442337+10,6,1,333,correct
3001,"SELECT id, award_name, year_of_award, category
FROM DIRECTOR, DIRECTOR_AWARD
WHERE DIRECTOR.title=DIRECTOR_AWARD.title AND DIRECTOR.production_year=DIRECTOR_AWARD.production_year
AND lower(DIRECTOR_AWARD.result)='failed';",2018-08-26 22:08:21.312592+10,13,0,185,partially correct
3002,"SELECT id, award_name, year_of_award, category
FROM DIRECTOR, DIRECTOR_AWARD
WHERE DIRECTOR.title=DIRECTOR_AWARD.title AND DIRECTOR.production_year=DIRECTOR_AWARD.production_year
AND lower(DIRECTOR_AWARD.result)='nominated' AND NOT lower(DIRECTOR_AWARD.result)='won';",2018-08-26 22:12:16.079812+10,13,1,185,correct
3003,"select count(*)
from movie
where (title, production_year) not in
  (select (title, production_year)
   from (select (title, production_year, result) from movie_award) m
     union (select (title, production_year, result) from crew_award) c
     union (select (title, production_year, result) from director_award) d
     union (select (title, production_year, result) from writer_award) w
     union (select (title, production_year, result) from actor_award) a
   where lower(result) = 'won');",2018-08-26 22:20:59.937974+10,11,0,116,noninterpretable
3004,"select title, production_year
from writer
WHERE EXISTS (
select *
from person
where first_name = ""Kevin"" and last_name = ""Williamson"" and writer.id = person.id);",2018-08-26 22:24:41.321712+10,5,1,330,correct
4447,"SELECT id,first_name,last_name from person
where year_born=(select  max(year_born) from person);",2018-08-28 21:57:30.908644+10,7,1,18,correct
3005,"select title,production_year from writer where writer.id= (select id from person where first_name='Kevin' and last_name='Williamson');",2018-08-26 22:24:59.191823+10,5,1,91,correct
3006,"SELECT kw.title,kw.production_year 
FROM (Person p INNER JOIN WRITER w INNER JOIN MOVIE m 
on w.title = m.title AND p.first_name ='Kevin' AND p.last_name = 'Williamson' AND w.id = p.id) AS kw
GROUP BY kw.title;",2018-08-26 22:25:41.634291+10,5,1,218,correct
3007,"select title, production_year
from writer,person
where writer.id=person.id and person.first_name='Kevin' and person.last_name='Williamson';",2018-08-26 22:27:15.253896+10,5,1,300,correct
3008,"SELECT id
FROM WRITER JOIN DIRECTOR
WHERE (SELECT ;",2018-08-26 22:28:00.714216+10,14,0,185,noninterpretable
3009,"select wr.title, wr.production_year from (person natural join movie natural join writer) as wr where wr.first_name like 'Kevin' and last_name like 'Williamson' ;",2018-08-26 22:28:32.488175+10,5,1,331,correct
3010,"select *
from restriction
where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-26 22:28:46.302402+10,6,0,330,partially correct
3011,"select country
from restriction
where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-26 22:29:18.395945+10,6,1,330,correct
3012,"select country 
from restriction
where title='Shakespeare in Love'
      and description='M';",2018-08-26 22:32:18.044145+10,6,1,300,correct
3013,"select country from Restriction where title like 'Shakespeare in Love' and description like 'M' ;
",2018-08-26 22:32:48.424814+10,6,1,331,correct
3014,"SELECT first_name,last_name
FROM (SELECT a.title,a.production_year,a.scene_no,r.id
FROM appearance a, role r
WHERE a.title=r.title
AND a.production_year=r.production_year
AND lower(title)='psycho'
AND production_year=1960) AS ra,
person AS p
WHERE ra.id=p.id;",2018-08-26 22:35:03.841284+10,10,0,204,noninterpretable
3015,"select id, first_name, last_name
from(
select max(year_born), *
from person);",2018-08-26 22:35:18.377347+10,7,1,330,correct
3016,"select id from person
where year_born in
  (select year_born from person
   order by year_born desc
   limit 2)
  and year_born not in
    (select max(year_born) from person);",2018-08-26 22:39:05.793568+10,3,1,116,correct
3017,"select count(*)
from writer_award wa inner join person p
on wa.id =p.id
where year_of_award >1990
and year_of_award <1996
and p.first_name ='Woody'
and p.last_name='Allen'
and wa.result='won';",2018-08-26 22:40:08.343062+10,9,1,265,correct
3018,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-26 22:42:04.840885+10,10,1,204,correct
3019,"SELECT count(*)
FROM MOVIE m
WHERE EXISTS ( m.production_year = 1993 or m.production_year = 1992 or m.production_year = 1991);",2018-08-26 22:43:17.141788+10,2,0,329,noninterpretable
3020,SELECT;,2018-08-26 22:44:47.044856+10,15,0,185,noninterpretable
3021,select * from person;,2018-08-26 22:46:17.426489+10,3,0,172,partially correct
3022,"select p.id,p.first_name,p.last_name
from person as p
where p.year_born >=ALL(select p.year_born );",2018-08-26 22:46:28.911397+10,7,0,300,noninterpretable
3023,"select count(*)
from person as p
where exists (select * from writer as w
where p.id=w.id and p.born_year=1935);",2018-08-26 22:49:04.22621+10,1,0,158,noninterpretable
3024,"SELECT title, first_name, last_name
FROM person natural join director NATURAL JOIN movie_award
where award_name = ""BAFTA Film Award"" and category = ""best film"";",2018-08-26 22:49:29.785762+10,8,0,330,partially correct
3025,"select count(*)
from person as p
where exists (select * from writer as w
where p.id=w.id and p.year_born=1935);",2018-08-26 22:50:07.280739+10,1,1,158,correct
3026,"select id,first_name,last_name
from  person
where year_born =(select max(year_born) from person);",2018-08-26 22:50:12.449132+10,7,1,300,correct
3027,"SELECT title, production_year, first_name, last_name
FROM person natural join director NATURAL JOIN movie_award
where award_name = ""BAFTA Film Award"" and category = ""best film"" and result = ""won"";",2018-08-26 22:51:00.482692+10,8,1,330,correct
3028,"select id, first_name,Last_name from Person where year_born in (select max(year_born) from Person);",2018-08-26 22:51:11.594699+10,7,1,333,correct
3029,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-26 22:56:51.153352+10,4,1,63,correct
3030,"select id,first_name,last_name,max(year_born) from person ;",2018-08-26 22:58:11.415012+10,7,0,331,partially correct
3031,"select id,first_name,last_name from person p where p.year_born = (select max(year_born) from person );",2018-08-26 22:59:34.557274+10,7,1,331,correct
3032,"select id, award_name, year_of_award, category
from director natural join director_award
where (title, production_year) in (
	select title, production_year
	from director_award
	where lower(result) = 'nominated'
	group by title, production_year
	having count(*) >= 1);",2018-08-26 23:03:42.121738+10,13,1,116,correct
3033,"select  production_year , count (*) AS numbers_of_movies from movie where production_year IN (1991,1992,1993)
group by production_year; ",2018-08-26 23:05:38.930951+10,2,1,65,correct
3034,"select ma.title,ma.production_year,p.first_name,p.last_name
from Movie_award ma,Person p ,Director d,Movie m
Where ma.award_name='BAFTA Film Award' and
      ma.category='Best Film'and
      ma.title=m.title and
      ma.production_year=m.production_year and
      m.title=d.title and
      m.production_year=d.production_year and
      d.id=p.id;",2018-08-26 23:05:57.125365+10,8,0,300,partially correct
3035,"select dw.title, dw.production_year, dw.first_name, dw.last_name from(Director natural join person natural join Movie_Award) as dw 

where category like 'best film' and award_name like 'BAFTA Film Award'; ",2018-08-26 23:10:34.921623+10,8,0,331,partially correct
3036,"select ma.title, ma.production_year, p.first_name, p.last_name from Movie_Award ma, Director d, Person p where ma.title = d.title and 
ma.production_year = d.production_year and d.id = p.id and ma.award_name like 'BAFTA Film Award'
and ma.category like 'Best Film' and ma.result = 'won';

",2018-08-26 23:10:35.384141+10,8,1,333,correct
3037,"select ma.title,ma.production_year,p.first_name,p.last_name
from Movie_award ma,Person p ,Director d,Movie m
Where lower(ma.award_name)='bafta film award' and
      lower(ma.category)='best film'and
      lower(ma.result)='won' and
      ma.title=m.title and
      ma.production_year=m.production_year and
      m.title=d.title and
      m.production_year=d.production_year and
      d.id=p.id;",2018-08-26 23:11:52.757356+10,8,1,300,correct
3038,"select dw.title,dw.production_year,dw.first_name,dw.last_name from(Director natural join person natural join Movie_Award) as dw 

where category like 'best film' and award_name like 'BAFTA Film Award' and result like 'won'; ",2018-08-26 23:13:26.03207+10,8,1,331,correct
3039,"select count(*)
from Writer Award natural join person
where production_year > 1991 and production_year < 1996 and first_name = ""Woody"" and last_name = ""Allen"";",2018-08-26 23:15:19.368594+10,9,0,330,partially correct
3040,"select count(*) from writer_award wa, Writer w, Person p 
where wa.title = w.title 
  and wa.production_year = w.production_year
  and w.id = p.id
  and p.first_name like 'Woody'
  and p.last_name like 'Allen'
  and wa.year_of_award >= 1991
  and wa.year_of_award <= 1995
  ;
  
",2018-08-26 23:16:19.596055+10,9,0,333,partially correct
3041,"select count(*) from writer_award wa, Writer w, Person p 
where wa.title = w.title 
  and wa.production_year = w.production_year
  and w.id = p.id
  and p.first_name like 'Woody'
  and p.last_name like 'Allen'
  and wa.year_of_award >= 1991
  and wa.year_of_award <= 1995
  and wa.result = 'won'
  ;
  
",2018-08-26 23:17:15.29628+10,9,1,333,correct
3042,"select wa.award_name,count(award_name)
from   writer_award wa,Person as p
where  wa.year_of_award>=1991 and
       wa.year_of_award<=1995 and
       lower(wa.result)='won' and
       wa.id=p.id and
       p.first_name='Woody' and
       p.last_name='Allen'
group by wa.award_name;",2018-08-26 23:19:37.523853+10,9,0,300,partially correct
3170,"select production_year, count(*) 
from movie 
where production_year>1990 and production_year < 1993  
group by production_year;",2018-08-27 12:11:08.62083+10,2,0,209,partially correct
3043,"select count(*)
from Writer_Award natural join person
where year_of_award  >= 1991 and year_of_award <= 1995 and first_name = ""Woody"" and last_name = ""Allen"" and result = ""won"";",2018-08-26 23:20:46.137564+10,9,1,330,correct
3044,"select count(award_name)
from   writer_award wa,Person as p
where  wa.year_of_award>=1991 and
       wa.year_of_award<=1995 and
       lower(wa.result)='won' and
       wa.id=p.id and
       p.first_name='Woody' and
       p.last_name='Allen';
",2018-08-26 23:20:51.623547+10,9,1,300,correct
3045,"select count(*) from (person natural join actor_award)
where result like 'won' and first_name like 'Woody' and year_of_award>=1991 and year_of_award <=1995;",2018-08-26 23:25:41.021566+10,9,0,331,partially correct
3046,"select count(*) from (person natural join writer_award)
where result like 'won' and first_name like 'Woody' and year_of_award>=1991 and year_of_award <=1995;",2018-08-26 23:26:29.451001+10,9,1,331,correct
3047,"select id
from (
	select id, title, production_year from director
	union
	select id, title, production_year from writer
) as a
group by id
having count(*) = 5;",2018-08-26 23:28:23.110189+10,14,0,116,partially correct
3048,"select r.id
from Role r,Scene s
where s.scene_no=1 and
      s.title=r.title and
      s.production_year=r.production_year and
      s.title='Psycho';",2018-08-26 23:28:40.172155+10,10,0,300,partially correct
3049,"select id
from(
select *, count(*) c
from role natural join person
WHERE EXISTS (SELECT *
FROM scene
WHERE scene.title=role.title and title = ""Psycho"" and production_year = 1960)
group by id
having c = 1);",2018-08-26 23:32:37.578133+10,10,0,330,partially correct
3050,"select count(m.title)
from movie as m,movie_award,crew_award as c,director_award as d,writer_award as w,actor_award as a
where m.title=movie_award.title and movie_award.result!=""won""
and m.title=c.title and c.result!=""won""
and m.title=d.title and d.result!=""won""
and m.title=w.title and w.result!=""won""
and m.title=a.title and a.result!=""won"";",2018-08-26 23:39:15.696209+10,11,0,85,partially correct
3051,select description  from appearance where title like 'Psycho' and production_year = 1960 and scene_no =1 ;,2018-08-26 23:41:16.686811+10,10,0,331,partially correct
3052,select count (*) form NOT (select * from person p INNER JOIN director d ON (p.id = d.id));,2018-08-26 23:46:26.102459+10,12,0,65,noninterpretable
3053,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id;",2018-08-26 23:46:52.238139+10,10,0,331,partially correct
3054,"select count(Writer.id) from Writer,Person
where Person.year_born ==1935;",2018-08-26 23:49:01.636212+10,1,0,336,noninterpretable
3055,"select p.first_name,p.last_name,r.*
from person p , role r
where r.id=p.id  
group by p.first_name,p.last_name;",2018-08-26 23:51:32.890585+10,15,0,265,partially correct
3056,"select  r.id
from Role r,Scene s ,appearance a
where s.title=r.title and
      s.production_year=r.production_year and
      s.production_year=1960 and
      lower(s.title)='psycho' and
      r.title=a.title  and
      r.production_year=a.production_year and
      s.scene_no=a.scene_no and
      a.description = r.description
group by r.id
having count(r.id)=1;
       ",2018-08-26 23:52:24.969665+10,10,1,300,correct
3057,"select first_name, last_name, title, production_year, description
from person p, role r
where p.id = r.id
  and r.id in
    (select id 
     from (select id, max(x.a)
           from (select id, count(*)as a from role group by id) as x) as x1);",2018-08-26 23:55:13.848804+10,15,1,116,correct
3058,"SELECT COUNT(*) FROM person, writer WHERE writer.id=person.id AND person.year_born=1935;",2018-08-26 23:56:43.980373+10,1,0,288,partially correct
3059,"select count(id) from Person
where exists(select Writer.id from Writer
       where Writer.id=Person.id and Person.year_born=1935);
     ",2018-08-26 23:57:49.320124+10,1,1,336,correct
3060,"SELECT id
FROM role
WHERE EXISTS (
SELECT *
FROM appearance
where appearance.title = ""Psycho"" and appearance.production_year = 1960 and role.production_year = 1960 and role.description = appearance.description 
group by description
having count(scene_no) = 1
)
;",2018-08-26 23:58:35.867509+10,10,1,330,correct
3061,"select title
from
(select m.title, m.production_year from movie_award,movie as m where m.title=movie_award.title and movie_award.result!=""won"" and m.production_year=movie_award.production_year
union select m.title, m.production_year from crew_award as c,movie as m where m.title=c.title and c.result!=""won"" and m.production_year=c.production_year
union select m.title, m.production_year from director_award as d,movie as m where m.title=d.title and d.result!=""won"" and m.production_year=d.production_year
union select m.title, m.production_year from writer_award as w,movie as m where m.title=w.title and w.result!=""won"" and m.production_year=w.production_year
union select m.title, m.production_year from actor_award as aa,movie as m where m.title=aa.title and aa.result!=""won"" and m.production_year=aa.production_year);",2018-08-27 00:02:06.989867+10,11,0,85,partially correct
3062,"select production_year, count(*) from MOVIE
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-27 00:02:12.324429+10,2,1,336,correct
3063,"select count(*)
from movie as m
where not exists(
select title,production_year from movie_award as ma
where lower(ma.result)=""won"" and ma.title=m.title and ma.production_year=m.production_year
union
SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-27 00:06:31.995059+10,11,1,85,correct
3064,"select count(*)
from movie as m
where not exists(
select title,production_year from movie_award as ma
where lower(ma.result)=""won"" and ma.title=m.title and ma.production_year=m.production_year
union
SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year)
	;",2018-08-27 00:08:59.663318+10,11,1,85,correct
3065,"select count(*)
from person p
where exists(select *
             from writer w
                where w.id=p.id
                AND p.year_born=1935);",2018-08-27 00:11:38.902127+10,1,1,79,correct
3066,"select count(m.title)
from movie m, movie_award ma
where not m.title=ma.title and
not m.production_year=ma.production_year;
",2018-08-27 00:12:03.483527+10,11,0,300,partially correct
3067,"SELECT ma.title, ma.production_year  FROM movie_award ma, person p, director d WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won' AND ma.title=d.title AND ma.production_year=d.production_year AND d.id=p.id;
",2018-08-27 00:15:55.618275+10,8,0,63,partially correct
3068,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM movie_award ma, person p, director d WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won' AND ma.title=d.title AND ma.production_year=d.production_year AND d.id=p.id;",2018-08-27 00:16:55.219479+10,8,1,63,correct
3069,"SELECT COUNT(*) FROM writer_award WHERE id IN(SELECT id FROM person WHERE first_name='Woody' AND last_name='Allen') AND year_of_award
         IN (1991,1992,1993,1994,1995);",2018-08-27 00:20:31.608177+10,9,0,63,partially correct
3070,"select distinct id from role r, Appearance a 
where r.title = a.title
and r.production_year = a.production_year
and r.production_year = 1960
and r.description in (
    select description from Appearance
    where title like 'Psycho'
     and production_year = '1960'
     group by description
     having count(scene_no) <= 1);
 
",2018-08-27 00:20:54.986698+10,10,1,333,correct
3071,"SELECT first_name, last_name, title, production_year, description FROM PERSON NATURAL JOIN ROLE
	WHERE id IN (SELECT id FROM (SELECT id,count(*) as NUM FROM PERSON NATURAL JOIN ROLE GROUP BY id) GROUP BY id HAVING MAX(NUM));",2018-08-27 00:21:20.242861+10,15,0,26,partially correct
3072,"SELECT COUNT(*) FROM writer_award WHERE id IN(SELECT id FROM person WHERE first_name='Woody' AND last_name='Allen') AND year_of_award
         IN (1991,1992,1993,1994,1995) AND lower(result)='won';",2018-08-27 00:21:26.54358+10,9,1,63,correct
3073,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-27 00:21:49.33614+10,15,1,26,correct
3074,"select id from
(select id,max(year_born) from person p
where p.year_born<(select max(year_born) from person));",2018-08-27 00:25:04.695535+10,3,1,85,correct
3075,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-27 00:25:47.858506+10,3,1,85,correct
3076,"SELECT production_year, COUNT(*) FROM movie GROUP BY production_year HAVING production_year=1993 OR production_year=1992 OR production_year=1991;
",2018-08-27 00:30:37.449807+10,2,1,288,correct
3077,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where lower(da.result)='nominated'
AND d.title=da.title
AND d.production_year=da.production_year

AND d.title not in (select da.title
                   from director_award da
                    where d.title=da.title
                     AND d.production_year=da.production_year
                     AND lower(da.result)='won');
",2018-08-27 00:36:17.330753+10,13,1,79,correct
3078,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-27 00:41:13.69695+10,4,1,332,correct
3079,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-27 00:41:25.680111+10,4,1,332,correct
3080,"SELECT pp.id FROM person pp WHERE pp.year_born IN(
SELECT max(y.year_born) FROM (SELECT year_born FROM person
EXCEPT
SELECT MAX(year_born)  FROM person) AS y, person p);
",2018-08-27 00:56:37.871335+10,3,1,63,correct
3081, select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-27 01:24:33.288159+10,6,1,91,correct
3082,"select distinct year_born, count(*)
from WRITER inner join PERSON on WRITER.id = PERSON.id
where year_born=1935;",2018-08-27 01:37:36.425872+10,1,0,22,partially correct
3083,SELECT COUNT(*) FROM (SELECT person.id FROM person WHERE NOT EXISTS (SELECT director.id FROM director WHERE person.id=director.id)) AS q;,2018-08-27 01:42:35.945117+10,12,1,288,correct
3084,SELECT COUNT(*) FROM (SELECT person.id FROM person WHERE NOT EXISTS (SELECT director.id FROM director WHERE person.id=director.id)) AS q;,2018-08-27 01:48:55.318634+10,12,1,288,correct
3085,;,2018-08-27 01:51:11.969076+10,7,0,91,noninterpretable
3086,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-27 01:53:16.465099+10,11,1,265,correct
3087,"select id,first_name,last_name from person where person.year_born=(select max(year_born) from person);",2018-08-27 01:56:58.409663+10,7,1,91,correct
3088,;,2018-08-27 02:14:23.690234+10,8,0,91,noninterpretable
3089,"SELECT a.id, first_name, last_name FROM person, (SELECT director.id, COUNT(*) FROM director, writer WHERE director.id=writer.id GROUP BY director.id, writer.id HAVING COUNT(*)>1) AS a WHERE a.id=person.id;",2018-08-27 02:15:58.628543+10,4,0,288,partially correct
3090,"select foo.title,foo.production_year, p.first_name,p.last_name from
(select title,production_year 
from movie_award 
where lower(award_name)='bafta film award' 
and lower(category)='best film' and lower(result)='won') as foo,
 director as d,
 person as p
where p.id=d.id 
and d.title=foo.title 
and d.production_year=foo.production_year; ",2018-08-27 02:36:54.475134+10,8,1,91,correct
3091,"SELECT movie.title, movie.production_year FROM movie, writer, person WHERE writer.title=movie.title AND writer.id=person.id AND person.first_name='Kevin' AND person.last_name='Williamson';",2018-08-27 02:44:32.471137+10,5,1,288,correct
3092,SELECT country FROM restriction WHERE title='Shakespeare in Love' AND description='M';,2018-08-27 02:56:20.469424+10,6,1,288,correct
3093,;,2018-08-27 03:15:10.727398+10,9,0,91,noninterpretable
3094,"select count(*)
from person,writer_award as w
where lower(first_name)='woody'
and lower(last_name)='allen'
and person.id=w.id
and year_of_award>1990 
and year_of_award<1996 
and lower(result)='won';",2018-08-27 03:20:36.200018+10,9,1,91,correct
3095,;,2018-08-27 03:22:54.589655+10,10,0,91,noninterpretable
3096,select distinct id from writer;,2018-08-27 05:47:11.415215+10,4,0,149,partially correct
3097,"SELECT country
FROM ;",2018-08-27 06:19:32.375135+10,6,0,107,noninterpretable
3098,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-27 06:20:13.207642+10,6,1,107,correct
3099,"SELECT id, first_name, last_name
FROM SELECT (SELECT MIN(year_born) FROM person);
",2018-08-27 06:22:15.455693+10,7,0,107,noninterpretable
3100,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-27 06:27:59.421087+10,7,1,107,correct
3101,"SELECT title, production_year, first_name, last_name
FROM movie_award, director
WHERE ;",2018-08-27 06:33:04.65047+10,8,0,107,noninterpretable
3102,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 06:33:37.652073+10,8,1,107,correct
3103,"SELECT count(DISTINCT award_name)
FROM writer_award, person
WHERE first_name = 'Woody' and last_name = 'Allen' and award_year BETWEEN 1991 and 1995;",2018-08-27 06:43:20.633686+10,9,0,107,noninterpretable
3135,"SELECT id, award_name, year_of_award, category FROM director d, director_award da WHERE lower(result)='nominated' AND d.production_year
        =da.production_year  AND d.title=da.title;",2018-08-27 10:35:29.951895+10,13,1,63,correct
3104,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa NATURAL JOIN
    writer w NATURAL JOIN
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-27 06:49:28.771707+10,9,1,107,correct
3105,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa NATURAL JOIN
    writer w NATURAL JOIN
    person p
WHERE
    
    lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-27 06:50:20.272642+10,9,1,107,correct
3106,"SELECT id
FROM;
",2018-08-27 06:56:40.715325+10,10,0,107,partially correct
3107,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-27 06:57:23.3196+10,10,1,107,correct
3108,"SELECT *
FROM;",2018-08-27 07:00:30.999535+10,11,0,107,noninterpretable
3109,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-27 07:01:21.447567+10,11,1,107,correct
3110,"SELECT
FROM;
",2018-08-27 07:05:31.541811+10,3,0,107,noninterpretable
3111,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-27 07:06:13.895258+10,3,1,107,correct
3112,"select count(p.id)
from Person as p
where not exists (
  select d.id
  from Director as d
  where d.id=p.id);",2018-08-27 07:33:44.698453+10,12,1,336,correct
3113,"select id,first_name, last_name
FROM Person
where exists(select d.id
  from Director as d
  where exists(select w.id
        from Writer as w
	  where d.id=w.id and w.title=d.title)
);",2018-08-27 07:41:14.970308+10,4,0,336,partially correct
3114,"select id,first_name, last_name
FROM (Person natural join Director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-27 07:45:02.991646+10,4,1,336,correct
3115,"select * 

from 
	movie_award ma,
	crew_award ca,
	director_award da,
	writer_award wa,
	actor_award aa,
	movie m
where 
	ma.title = m.title
	and ma.production_year = m.production_year
	and ca.title=m.title
	and ca.production_year = m.production_year
	and da.title = m.title
	and da.production_year = m.production_year
	and wa.title=m.title
	and wa.production_year = m.production_year
	and aa.title=m.title
	and aa.production_year = m.production_year
	and ma.result='won'
	and ca.result='won'
	and da.result='won'
	and wa.result='won'
	and aa.result='won';",2018-08-27 08:42:11.003676+10,11,0,46,partially correct
3116,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PEOPLE.year_born = '1935' AND WRITER.id = PERSON.id)
GROUP BY year_born;
",2018-08-27 08:53:40.049787+10,1,0,81,noninterpretable
3117,"select count(*)
from movie m 
where not exists(
		select title, production_year 
		from movie_award ma
		where lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
		UNION
		select title, production_year
		from crew_award ca
		where lower(ca.result)='won' and ca.title=m.title and ca.production_year = m.production_year
		union
		select title, production_year 
		from director_award da
		where lower(da.result)='won' and da.title=m.title and da.production_year=m.production_year
		UNION
		select title, production_year
		from writer_award wa
		where lower(wa.result)='won' and wa.title=m.title and wa.production_year = m.production_year
		union
		select title, production_year 
		from actor_award aa
		where lower(aa.result)='won' and aa.title=m.title and aa.production_year=m.production_year);",2018-08-27 08:53:53.466541+10,11,1,46,correct
3118,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PERSON.year_born = '1935' AND WRITER.id = PERSON.id)
GROUP BY year_born;
",2018-08-27 08:54:03.901693+10,1,0,81,partially correct
3119,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PERSON.year_born = '1935' AND WRITER.id = PERSON.id;
",2018-08-27 08:54:36.70238+10,1,0,81,noninterpretable
3120,"SELECT year_born, COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PERSON.year_born = '1935' AND WRITER.id = PERSON.id);
",2018-08-27 08:54:44.830895+10,1,0,81,partially correct
3121,"SELECT COUNT(*) AS NoBornIn1935
FROM PERSON 
WHERE EXISTS (SELECT * FROM WRITER
WHERE PERSON.year_born = '1935' AND WRITER.id = PERSON.id);
",2018-08-27 08:55:20.132927+10,1,1,81,correct
3122,;,2018-08-27 09:15:41.838277+10,13,0,21,noninterpretable
3123,"SELECT Person.id,Person.first_name,Person.last_name
FROM Person, ( (SELECT DISTINCT(Director.id) AS id
               FROM Director,Director_award
               WHERE lower(Director_award.result) = 'nominated'
                     AND Director.title = Director_award.title
                     AND Director.production_year = Director_award.production_year)
               EXCEPT
               (SELECT DISTINCT(Director.id) AS id
               FROM Director,Director_award
               WHERE lower(Director_award.result) = 'won'
                     AND Director.title = Director_award.title
                     AND Director.production_year = Director_award.production_year)) AS Sad
WHERE Person.id = Sad.id;
",2018-08-27 09:18:14.554702+10,13,0,21,noninterpretable
3124,"SELECT COUNT(*)
FROM DIRECTOR d
WHERE NOT EXISTS (SELECT *
FROM MOVIE m
WHERE d.production_year = m.production_year);",2018-08-27 09:22:26.573428+10,12,0,81,partially correct
3125,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT *
FROM DIRECTOR d
WHERE d.id = p.id);",2018-08-27 09:23:54.371474+10,12,1,81,correct
3126,"select p.id, max(p.year_born) from person p where p.year_born < (select max(year_born) from person);",2018-08-27 09:31:16.974269+10,3,0,46,partially correct
3127,"select p.id, max(p.year_born) from person p where p.year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-27 09:34:15.065598+10,3,0,46,partially correct
3128,select p.id from person p where p.year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));,2018-08-27 09:35:03.816422+10,3,1,46,correct
3129,"SELECT id, first_name, last_name
FROM PERSON
WHERE n.NoOfMovies > 1 (SELECT COUNT(*) AS NoOfMovies
FROM DIRECTOR d, WRITER w
WHERE d.title = w.title) n; ",2018-08-27 09:47:31.766516+10,4,0,81,noninterpretable
3130,"select title,production_year
from Writer natural join person
where first_name=""Kevin"" and last_name=""Williamson"";

 
",2018-08-27 09:55:47.71363+10,5,1,336,correct
3131,select count(*) from person where year_born = 1935;,2018-08-27 10:22:34.148957+10,1,0,102,partially correct
3132,"select count(*) from person p 
where exists
(select * from writer w where w.id = p.id and p.year_born = 1935);",2018-08-27 10:27:09.133637+10,1,1,102,correct
3133,"select count(*) from movie m where m.production_year in (1993, 1992, 1991);",2018-08-27 10:30:05.869843+10,2,0,102,partially correct
3134,"select production_year, count(*) from movie m 
where m.production_year in (1993, 1992, 1991)
group by production_year;",2018-08-27 10:34:58.259563+10,2,1,102,correct
3169,"SELECT w.title, w.production_year
FROM person p, writer w
WHERE p.id = w.id AND p.first_name = 'Kevin' AND p.last_name = 'Wiiliamson';",2018-08-27 12:10:07.259824+10,5,0,81,partially correct
3136,"select director.id,da.award_name,da.year_of_award,da.category from director_award da, director where lower(result)='nominated' and director.title=da.title and director.production_year=da.production_year; ",2018-08-27 10:39:05.729981+10,13,1,46,correct
3137,"
//where p not exists
//(select * from director d where d.id = p.id);",2018-08-27 10:42:18.607627+10,12,0,102,noninterpretable
3138,"select count(*) from person p
where not exists(select * from director d where d.id = p.id);",2018-08-27 10:46:15.603345+10,12,1,102,correct
3139,"select id, first_name, last_name from person p;
",2018-08-27 10:54:51.474813+10,4,0,102,partially correct
3140,"with temp as (
	select distinct d.id, d.title, d.production_year
	from director as d
	union
	select w.id, w.title, w.production_year
	from writer w
),
coun as(
	select id, count(*) as num
	from temp
	group by id
)
select id
from coun
where coun.num = (
	select max(t.num)
	from coun as t
)
;",2018-08-27 10:57:04.897808+10,14,1,37,correct
3141,"select m.title,m.production_year
from movie m
where exists
		(select * 
		from director d,writer w
		where d.title = m.title
			and d.production_year = m.production_year
			and w.title=m.title
			and w.production_year = m.production_year);",2018-08-27 11:00:34.856985+10,14,0,46,partially correct
3142,"with numRole as (
	select id, count(*) as num
	from role
	group by id
),
maxRole as(
	select max(num) as mnum
	from numRole
),
getID as (
	select id
	from numRole
	where num = (select mnum from maxRole)
)
select p.first_name, p.last_name, r.title, r.production_year, r.description
from getID as g
inner join role as r on g.id = r.id
inner join person as p on p.id = r.id
;",2018-08-27 11:01:49.081616+10,15,1,37,correct
3143,"select id, first_name, last_name 
from (person natural join director natural join writer) dw
group by dw.id
having count(*) > 1;
",2018-08-27 11:09:38.559514+10,4,1,102,correct
3144,"select title, production_year from writer w
inner join person p on w.id = p.id and p.last_name = 'Kevin' and p.first_name = 'Williamson';",2018-08-27 11:14:15.563236+10,5,0,102,partially correct
3145,"select count(*)
from movie
where not exists(
	select *
	from movie,movie_award,movie_award,movie_award,movie_award,actor_award
	where movie.title = movie_award.title
	and movie.production_year =  movie_award.production_year
	and movie.title = crew_award.title
	and movie.production_year =  crew_award.production_year
	and movie.title = director_award.title
	and movie.production_year =  director_award.production_year 
	and movie.title = writer_award.title
	and movie.production_year =  writer_award.production_year
	and movie.title = actor_award.title
	and movie.production_year =  actor_award.production_year
);",2018-08-27 11:17:33.624108+10,11,0,109,noninterpretable
3146,"select title, production_year from writer w
inner join person p on w.id = p.id and p.last_name = 'Williamson' and p.first_name = 'Kevin';",2018-08-27 11:20:05.681503+10,5,1,102,correct
3147,"SELECT r.id, r.first_name, r.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS r
GROUP BY r.id
HAVING COUNT(*) > 1;",2018-08-27 11:26:18.455171+10,4,1,81,correct
3148,select country from restriction where description = 'M' and title = 'Shakespeare';,2018-08-27 11:29:00.356945+10,6,0,102,partially correct
3149,select country from restriction where description = 'M' and title = 'Shakespeare in Love';,2018-08-27 11:29:31.003291+10,6,1,102,correct
3150,"SELECT count(person.id)
FROM person, writer
WHERE person.id = writer.id and
	person.year_born = 1935;
",2018-08-27 11:30:21.370202+10,1,0,339,partially correct
3151,"
			
where x.NoOFWorkedOn =
	(select max(x2.NoOfWorkedOn)
	from (select x1.id,count(*) as NoOfWorkedOn 
		from
			(select d.id,d.title,d.production_year 
			from director d
			union
			select w.id, w.title,w.production_year
			from writer w) x1
			group by x1.id) x2);",2018-08-27 11:33:37.887777+10,14,0,46,noninterpretable
3152,"
select x.id
from (select x1.id,count(*) as NoOfWorkedOn 
		from
			(select d.id,d.title,d.production_year 
			from director d
			union
			select w.id, w.title,w.production_year
			from writer w) x1
			group by x1.id) x
			
where x.NoOfWorkedOn =
	(select max(x2.NoOfWorkedOn)
	from (select x1.id,count(*) as NoOfWorkedOn 
		from
			(select d.id,d.title,d.production_year 
			from director d
			union
			select w.id, w.title,w.production_year
			from writer w) x1
			group by x1.id) x2);",2018-08-27 11:34:27.59606+10,14,1,46,correct
3153,"select count(*)
from movie m
where not exists(
	select title, production_year 
	from movie_award ma
	where lower(ma.result) = 'won' and m.title = ma.title and m.production_year =  ma.production_year
	union
	select title, production_year 
	from actor_award aa
	where lower(aa.result) = 'won' and m.title = aa.title and m.production_year =  aa.production_year
	union
	select title, production_year 
	from director_award da
	where lower(da.result) = 'won' and m.title = da.title and m.production_year =  da.production_year
	union
	select title, production_year 
	from crew_award ca
	where lower(ca.result) = 'won' and m.title = ca.title and m.production_year =  ca.production_year
	union
	select title, production_year 
	from writer_award wa
	where lower(wa.result) = 'won' and m.title = wa.title and m.production_year =  wa.production_year
);",2018-08-27 11:36:48.810351+10,11,1,109,correct
3154,"select id, first_name, last_name 
from person
where year_born =  max(year_born);",2018-08-27 11:39:08.677204+10,7,0,102,noninterpretable
3155,"select id, first_name, last_name 
from person
where year_born = (select max(year_born) from person);",2018-08-27 11:42:40.544428+10,7,1,102,correct
3156,"select count(*) where exists (select * from writer,person where year_born = 1935 and writer.id = person.id);",2018-08-27 11:43:12.612141+10,1,1,209,correct
3157,"select p.id, p.first_name, p.last_name 
from person p 
where p.id = 
	(select id 
	from 
		(select id, max(count) 
		from
			(select id, count(*) as count,description 
			from role 
			group by id)));",2018-08-27 11:44:59.01761+10,15,0,46,partially correct
3158,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);

",2018-08-27 11:45:36.019969+10,1,1,339,correct
3159,"SELECT count(*)
FROM movie m
WHERE m.production_year in (1993, 1992, 1991);",2018-08-27 11:49:13.812882+10,2,0,339,partially correct
3160,"SELECT m.production_year, count(*)
FROM movie m
WHERE m.production_year in (1993, 1992, 1991)
GROUP BY m.production_year;",2018-08-27 11:50:17.724373+10,2,1,339,correct
3161,select count(*) from movie where  production_year = 1993 or production_year = 1992 or production_year = 1991;,2018-08-27 11:51:52.287509+10,2,0,209,partially correct
3162,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d inner join director_award da on d.title=da.title AND d.production_year=da.production_year
WHERE lower(da.result) = 'nominated'
AND d.id NOT IN (
	SELECT d.id
FROM director d inner join director_award da on d.title=da.title AND d.production_year=da.production_year
WHERE lower(da.result) = 'won'
);",2018-08-27 11:56:02.224994+10,13,1,173,correct
3163,"SELECT count(d.id)
FROM director d
WHERE NOT EXISTS (SELECT d.id 
				FROM movie m
				WHERE m.title = d.title AND
					m.production_year = d.production_year);
",2018-08-27 11:58:01.819368+10,12,0,339,partially correct
3164,"SELECT r.title, r.production_year
FROM (movie NATURAL JOIN writer) r
WHERE EXISTS (SELECT * 
FROM person p
WHERE p.id = r.id AND P.first_name = 'Kevin' AND P.last_name = 'Wiiliamson');",2018-08-27 11:59:34.609079+10,5,0,81,partially correct
3165,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * 
				FROM director d
				WHERE d.id = p.id);",2018-08-27 12:01:21.933843+10,12,1,339,correct
3166,select count(year_born) from person where year_born=1935;,2018-08-27 12:05:44.489257+10,1,0,341,partially correct
3167,select count(year_born) from person where exists (select * from writer where writer.id=person.id and person.year_born=1935);,2018-08-27 12:08:53.590778+10,1,1,341,correct
3168,"select id from Movie m, Scene S WHERE m.title='Psycho' AND S.Scene >2;",2018-08-27 12:09:36.374472+10,10,0,137,noninterpretable
3278,"select id, award_name, year_of_award, category
from director natural join Director_Award
where result = ""nominated""
;",2018-08-27 14:20:18.465393+10,13,1,330,correct
3171,"select production_year, count(*) 
from movie 
where production_year>1990 and production_year < 1994  
group by production_year;",2018-08-27 12:11:41.439095+10,2,1,209,correct
3172,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id 
	AND p.first_name = 'Kevin' 
	AND p.last_name = 'Williamson';",2018-08-27 12:11:43.542024+10,5,1,81,correct
3173,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE (SELECT COUNT(*)
		FROM director d, writer w
		WHERE d.id = w.id AND
			p.id = d.id
		GROUP BY d.id) > 1;
",2018-08-27 12:12:00.505428+10,4,0,339,partially correct
3174,"select m.id from Movie m, Scene S WHERE m.title='Psycho' AND S.Scene >2;",2018-08-27 12:15:44.534185+10,10,0,137,noninterpretable
3175,"select m.id from Movie m, Scene S WHERE m.title='Psycho' AND S.Scene_no >2;",2018-08-27 12:16:31.350363+10,10,0,137,noninterpretable
3176,"SELECT count(distinct id)
FROM director 
;
",2018-08-27 12:16:48.716373+10,14,0,173,partially correct
3177,"SELECT count(*)
FROM person
WHERE year_born = 1935;",2018-08-27 12:19:20.742794+10,1,0,144,partially correct
3178,"select production_year,count(*) as numbers from movie where production_year=1991 or production_year=1992 or production_year=1993 group by production_year;",2018-08-27 12:21:04.157509+10,2,1,341,correct
3179,"SELECT COUNT(DISTINCT p.id)
FROM person p
INNER JOIN writer w ON p.id = w.id
WHERE p.year_born = 1935;",2018-08-27 12:23:33.155855+10,1,1,144,correct
3180,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year = 1991 OR production_year = 1992 OR production_year = 1993
GROUP BY production_year;",2018-08-27 12:26:06.307777+10,2,1,144,correct
3181,select count(*) from person where exists(select * from director where director.id!=person.id);,2018-08-27 12:26:16.312813+10,12,0,341,partially correct
3182,select from ;,2018-08-27 12:27:11.301807+10,15,0,76,noninterpretable
3183,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(dw.id) > 1;",2018-08-27 12:27:19.84735+10,4,1,339,correct
3184,select count(id) from person where not exists(select id from director where director.id=person.id);,2018-08-27 12:27:20.735513+10,12,1,341,correct
3185,"select distinct count(*) from person,Director where person.id != director.id; ",2018-08-27 12:28:10.042462+10,12,0,209,partially correct
3186,"SELECT count(p.id)
FROM person p
WHERE NOT EXISTS (SELECT *
                  FROM director d
                  WHERE p.id = d.id);",2018-08-27 12:30:23.704551+10,12,1,144,correct
3187,"SELECT dw.title, dw.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS dw
WHERE dw.first_name = ""Kevin"" and
	dw.last_name = ""Williamson"";",2018-08-27 12:30:51.401726+10,5,1,339,correct
3188,"SELECT dw.title, dw.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS dw
WHERE lower(dw.first_name) = ""kevin"" and
	lower(dw.last_name) = ""williamson"";",2018-08-27 12:31:55.926302+10,5,1,339,correct
3189,"select count(*) 
from person 
where not exists (select * from Director where person.id = director.id); ",2018-08-27 12:32:16.022658+10,12,1,209,correct
3190,"select count(DISTINCT writer.id)
from writer,person
where writer.id = person.id and year_born=1935;",2018-08-27 12:33:40.905007+10,1,1,344,correct
3191,"select id,first_name,last_name from person where exists(
select id from director d where exists(
select id,title from writer w where d.id=person.id and d.title = w.title and d.id=w.id) );",2018-08-27 12:34:19.425973+10,4,0,341,partially correct
3192,"SELECT DISTINCT r.country
FROM restriction r
WHERE lower(r.title) = ""shakespeare in love"" AND
	lower(r.description) = ""m"";",2018-08-27 12:36:19.469035+10,6,1,339,correct
3193,"SELECT distinct p.id, p.first_name, p.last_name
FROM person p
INNER JOIN director d ON p.id = d.id
WHERE EXISTS (SELECT w.id
              FROM writer w
              WHERE d.id = w.id AND w.title > 1);",2018-08-27 12:37:30.218263+10,4,0,144,partially correct
3194,"select production_year,count(*)
from movie
where production_year in (1993,1992,1991)
group by production_year;
",2018-08-27 12:38:32.529791+10,2,1,344,correct
3195,"select id,first_name,last_name from(person natural join director natural join writer) group by id having count(*)>1;",2018-08-27 12:38:32.792042+10,4,1,341,correct
3196,"SELECT dw.id, dw.first_name, dw.last_name
FROM(person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*) > 1; 
",2018-08-27 12:39:00.61421+10,4,1,144,correct
3197,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born >= (SELECT MAX(sp.year_born) 
				FROM person sp);",2018-08-27 12:45:22.336974+10,7,1,339,correct
3198,"select count(*)
from person
where person.id not in (select id from director);",2018-08-27 12:47:08.859796+10,12,1,344,correct
3199,"SELECT x.id

FROM(
	SELECT x1.id,count(*) AS times
		FROM(
			SELECT d.id, title, production_year
			FROM director d
			UNION
			SELECT w.id, title, production_year
			FROM writer w) AS x1
	GROUP BY x1.id) AS x
WHERE x.times =

(
SELECT MAX(times)

FROM(
	SELECT x2.id,count(*) AS times
		FROM(
			SELECT d.id, title, production_year
			FROM director d
			UNION
			SELECT w.id, title, production_year
			FROM writer w) AS x2
	GROUP BY x2.id) AS x
)	

;",2018-08-27 12:49:41.139298+10,14,1,173,correct
3200,"SELECT m.title, m.production_year
FROM movie m
INNER JOIN writer w ON m.title = w.title 
INNER JOIN person p ON p.id = w.id
WHERE lower(p.first_name) = 'kevin' AND lower(p.last_name) = 'williamson';",2018-08-27 12:51:14.998081+10,5,1,144,correct
3201,"SELECT country
FROM restriction
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-27 12:53:52.764753+10,6,1,144,correct
3202,;,2018-08-27 12:55:13.591105+10,11,0,91,noninterpretable
3203,"SELECT id, first_name, last_name
FROM person p1
WHERE p1.year_born = (SELECT MAX(p2.year_born)
                      FROM person p2);",2018-08-27 12:56:52.493677+10,7,1,144,correct
3204,"SELECT title, production_year, first_name, last_name
FROM person p NATURAL JOIN director d NATURAL JOIN (SELECT m.title AS title, m.production_year AS production_year
		FROM movie m NATURAL JOIN movie_award ma
		WHERE lower(ma.category) = ""best film"" AND
			lower(ma.award_name) = ""bafta film award"") AS mw;",2018-08-27 12:57:29.535794+10,8,0,339,partially correct
3205,"SELECT title, production_year, first_name, last_name
FROM person p NATURAL JOIN director d NATURAL JOIN (SELECT m.title AS title, m.production_year AS production_year
		FROM movie m NATURAL JOIN movie_award ma
		WHERE lower(ma.category) = ""best film"" AND
			lower(ma.award_name) = ""bafta film award"" AND
			lower(ma.result) = ""won"") AS mw;",2018-08-27 12:59:00.721082+10,8,1,339,correct
3206,"SELECT country FROM Restriction
where title='Shakespeare in Love' and 
	description='M';",2018-08-27 12:59:03.547387+10,6,1,336,correct
3207,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m
INNER JOIN director d ON m.title = d.title
INNER JOIN person p ON d.id = p.id
WHERE m.award_name LIKE 'bafta%' AND lower(m.category) = 'best film';",2018-08-27 13:00:37.359359+10,8,0,144,partially correct
3208,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m
INNER JOIN director d ON m.title = d.title
INNER JOIN person p ON d.id = p.id
WHERE m.award_name LIKE '%bafta film award%' 
      AND lower(m.category) = 'best film'
      AND lower(result) = 'won';",2018-08-27 13:02:49.350137+10,8,1,144,correct
3209,"select r.id
from  role r,
	scene s,
	appearance a
where r.title = s.title
	and r.title =a.title
	and lower(r.title)='psycho'
	
	and s.production_year = r.production_year
	and r.production_year = a.production_year
	and a.production_year =1960
	
	and s.scene_no=a.scene_no
	and s.description=a.description
group by r.id
having count(*)=1;

",2018-08-27 13:03:24.76991+10,10,0,134,partially correct
3210,"select id,first_name,last_name
from person
where year_born in (
select max(year_born)
from person);
",2018-08-27 13:04:04.875384+10,7,1,336,correct
3211,"SELECT p.id, p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p INNER JOIN role r
on p.id = r.id
WHERE p.id=
(

SELECT id
FROM
(
SELECT id,COUNT(*) AS times
FROM ROLE
GROUP BY id
)AS t
WHERE t.times = 
	(
		SELECT MAX(t.times)
	FROM
		(
			SELECT id,COUNT(*) AS times
			FROM ROLE
			GROUP BY id
			)AS t
	)

)
;
",2018-08-27 13:05:03.852762+10,15,0,173,partially correct
3276,"
select id, award_name,year_of_award, category from 
(select * from director natural join director_award) as foo, where foo.result=nominated
and foo.result!=won;",2018-08-27 14:19:36.135116+10,13,0,91,noninterpretable
3212,"SELECT  p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p INNER JOIN role r
on p.id = r.id
WHERE p.id=
(

SELECT id
FROM
(
SELECT id,COUNT(*) AS times
FROM ROLE
GROUP BY id
)AS t
WHERE t.times = 
	(
		SELECT MAX(t.times)
	FROM
		(
			SELECT id,COUNT(*) AS times
			FROM ROLE
			GROUP BY id
			)AS t
	)

)
;
",2018-08-27 13:05:47.964782+10,15,1,173,correct
3213,"SELECT p.first_name,p.last_name, r.title, r.production_year, r.description 
FROM person p, (SELECT id, COUNT(*) AS big 
                FROM role) AS h, role r
WHERE p.id=r.id
AND r.id=h.id
GROUP BY p.first_name
HAVING MAX(big);

",2018-08-27 13:06:26.668806+10,15,0,227,partially correct
3214,"select m.title, m.production_year, p.first_name, p.last_name
from movie m, restriction_category r, award a, director d, person p
where r.description = lower('Best Film')
  and a.award_name = lower('BAFTA Film Award')
  and d.id = p.id;",2018-08-27 13:06:26.793691+10,8,0,102,partially correct
3215,"select d.id, first_name, last_name from director d, person p, writer w
where w.id=d.id
group by d.id
having count(*) >=2;",2018-08-27 13:08:18.202907+10,4,0,137,partially correct
3216,"SELECT count(*)
FROM writer_award wa
INNER JOIN person p ON wa.id = p.id
WHERE year_of_award > 1990 AND year_of_award < 1996 AND
      lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND
      lower(result) = 'won';",2018-08-27 13:08:36.914057+10,9,1,144,correct
3217,"

select  title from actor_award
where result = 'won'
union 
select  title from crew_award
where result = 'won'
order by title;",2018-08-27 13:09:01.287963+10,11,0,333,partially correct
3218,"select id, first_name, last_name
from person
where person.id in (select director.id
from movie,writer,director
where movie.title = writer.title and writer.id = director.id and movie.title = director.title
group by director.id 
having count(*)>2);",2018-08-27 13:15:01.655223+10,4,0,344,partially correct
3219,"SELECT distinct p.id
FROM person p
INNER JOIN role r ON p.id = r.id
INNER JOIN scene s ON r.title = s.title
WHERE lower(s.title) = 'psycho' AND s.production_year = 1960 AND
      s.scene_no = 1;",2018-08-27 13:15:51.92164+10,10,0,144,partially correct
3220,"select id, first_name, last_name
from person
where person.id in (select director.id
from movie,writer,director
where movie.title = writer.title and writer.id = director.id and movie.title = director.title
group by director.id   
having count(*)>1);",2018-08-27 13:17:35.162621+10,4,1,344,correct
3221,"select count(*)
from(
select *
from movie_award, crew_award, director_award, writer_award, actor_award
where movie_award.result = ""nominated"" and crew_award.result = ""nominated"" 
and director_award.result = ""nominated"" and writer_award.result = ""nominated"" and actor_award.result = ""nominated""
group by movie_award.title);",2018-08-27 13:18:32.161912+10,11,0,330,partially correct
3222,"SELECT COUNT*
FROM person p
WHERE EXISTS (SELECT FROM Director d WHERE w.id = p.id);",2018-08-27 13:21:47.835487+10,12,0,329,noninterpretable
3223,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT * 
			FROM director d, writer w 
			WHERE p.id = d.id
			AND d.id = w.id 
			AND d.title = w.title 
			AND d.production_year = w.production_year);",2018-08-27 13:22:23.438657+10,4,0,222,partially correct
3224,"select movie.title, movie.production_year
from movie,writer,person
where movie.title = writer.title and writer.id = person.id and person.first_name='Kevin' and person.last_name='Williamson';
",2018-08-27 13:23:19.754494+10,5,1,344,correct
3225,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM Director d WHERE d.id = p.id);",2018-08-27 13:23:43.624162+10,12,1,329,correct
3226,";
",2018-08-27 13:25:11.801682+10,1,0,201,noninterpretable
3227,"SELECT p.first_name,p.last_name, r.title, r.production_year, r.description 
FROM person p, (SELECT id, COUNT(*) AS big 
                FROM role GROUP BY id) AS h, role r
WHERE p.id=r.id
AND r.id=h.id
AND big IN 
(SELECT MAX(big)
FROM (SELECT id, COUNT(*) AS big
FROM role GROUP BY id) AS a);



",2018-08-27 13:25:27.878334+10,15,1,227,correct
3228,"select count(*) from movie m where not exists
(
select title, production_year from movie_award ma
where ma.title = m.title
  and ma.production_year = m.production_year
  and lower(ma.result) = 'won'
union
select title, production_year from actor_award aa
where aa.title = m.title
  and aa.production_year = m.production_year
  and lower(aa.result) = 'won'
union
select title, production_year from director_award da
where da.title = m.title
  and da.production_year = m.production_year
  and lower(da.result) = 'won'
union
select title, production_year from writer_award wa
where wa.title = m.title
  and wa.production_year = m.production_year
  and lower(wa.result) = 'won'
union
select title, production_year from crew_award ca
where ca.title = m.title
  and ca.production_year = m.production_year
  and lower(ca.result) = 'won'
);",2018-08-27 13:26:20.272259+10,11,1,333,correct
3229,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-27 13:26:37.679382+10,1,1,201,correct
3230,"select country
from restriction
where title='Shakespeare in Love' and description='M';",2018-08-27 13:27:13.852878+10,6,1,344,correct
3231,"select country
from restriction
where lower(title)='shakespeare in love' and description='M';",2018-08-27 13:27:47.244597+10,6,1,344,correct
3232,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT * 
		   FROM director d, writer w 
		   WHERE p.id = d.id
		   AND d.id = w.id 
	 	   AND d.title = w.title 
		   AND d.production_year = w.production_year
		   GROUP BY d.id
		   HAVING COUNT(*) > 1);",2018-08-27 13:28:26.951043+10,4,1,222,correct
3233,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-27 13:32:58.484639+10,10,1,144,correct
3234,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(
select max(p.year_born)
from person p);",2018-08-27 13:33:53.147374+10,7,1,94,correct
3235,"select id, first_name, last_name
from person
where person.year_born in (select MIN(year_born) from person);",2018-08-27 13:34:32.038114+10,7,0,344,partially correct
3236,"select id, first_name, last_name
from person
where person.year_born in (select MAX(year_born) from person);",2018-08-27 13:35:27.989776+10,7,1,344,correct
3237,"select p.id from person p where p.year_born in 
(select max(year_born) from person where year_born < (select max(p1.year_born) from person p1));",2018-08-27 13:36:50.393091+10,3,1,333,correct
3238,"select r.id
from role r,
	 scene s,
	 appearance a
where r.title = s.title
	and r.production_year = s.production_year
	and s.title =a.title
	and s.scene_no=a.scene_no
	and s.description =a.description
	and lower(a.title)='psycho'
	and s.production_year=a.production_year
	and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-27 13:37:51.580611+10,10,0,134,partially correct
3239,;,2018-08-27 13:37:54.677536+10,15,0,278,noninterpretable
3240,"SELECT p.id
FROM person p
WHERE min(p.year_born);
",2018-08-27 13:42:40.160122+10,3,0,144,noninterpretable
3241,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-27 13:43:58.741917+10,3,1,144,correct
3242,"select count(id)
from person
where id not in (select id from director where person.id=director.id);",2018-08-27 13:44:41.303001+10,12,1,19,correct
3243,;,2018-08-27 13:45:29.338171+10,3,0,91,noninterpretable
3244,"select movie.title, movie.production_year, first_name, last_name
from movie_award,director,movie,person
where person.id = director.id and movie_award.title = director.title and movie_award.title = movie.title and award_name = 'BAFTA Film Award';
",2018-08-27 13:45:51.569808+10,8,0,344,partially correct
3277,"select id, award_name,year_of_award, category from 
(select * from director natural join director_award) as foo where foo.result='nominated'
and foo.result!='won';
",2018-08-27 14:20:03.79565+10,13,1,91,correct
3279,"with sub as (select id,first_name,last_name, max(year_born) from Person  )
select id,first_name,last_name from sub  ;",2018-08-27 14:21:58.957526+10,7,1,19,correct
3245,"SELECT count(*)
FROM movie m
WHERE not exists (
SELECT title, production_year FROM movie_award 
WHERE lower(movie_award.result) = ""won"" and movie_award.title = m.title and movie_award.production_year = m.production_year
UNION
SELECT title, production_year FROM crew_award
WHERE lower(crew_award.result) = ""won"" and crew_award.title = m.title and crew_award.production_year = m.production_year
UNION
SELECT title, production_year FROM director_award 
WHERE lower(director_award.result) = ""won"" and director_award.title = m.title and director_award.production_year = m.production_year
UNION
SELECT title, production_year FROM writer_award 
WHERE lower(writer_award.result) = ""won"" and writer_award.title = m.title and writer_award.production_year = m.production_year
UNION
SELECT title, production_year FROM actor_award 
WHERE lower(actor_award.result) = ""won"" and actor_award.title = m.title and actor_award.production_year = m.production_year
);",2018-08-27 13:46:44.311394+10,11,1,330,correct
3246,"select movie.title, movie.production_year, first_name, last_name
from movie_award,director,movie,person
where person.id = director.id 
	and movie_award.title = director.title 
	and movie_award.title = movie.title 
	and award_name = 'BAFTA Film Award' 
	and category='best film';",2018-08-27 13:47:18.034691+10,8,0,344,partially correct
3247,"select title,production_year,first_name,last_name
from (director natural join person) natural join movie_award
where title in (
select title from movie_award
where award_name=""BAFTA Film Award"" and category=""best film"" and result=""won"");",2018-08-27 13:48:09.523227+10,8,0,336,partially correct
3248,"select count(*)
from (movie_award natural join crew_awards natural join director_awards natural join writer_awards natural join ctor_awards)as m
where movie.title not in m;",2018-08-27 13:48:15.663163+10,11,0,134,noninterpretable
3249,"SELECT p.id
FROM person p
INNER JOIN director d ON p.id = d.id
INNER JOIN writer w ON d.id = w.id
INNER JOIN crew c ON d.id = c.id;",2018-08-27 13:48:32.324906+10,14,0,144,partially correct
3250,"SELECT id from person WHERE year_born=
                 (select max(year_born) from person where year_born <(select max(year_born) from person));",2018-08-27 13:48:34.469472+10,3,1,82,correct
3251,"select  distinct title,production_year,first_name,last_name
from (director natural join person) natural join movie_award
where title in (
select title from movie_award
where award_name=""BAFTA Film Award"" and category=""best film"" and result=""won"");",2018-08-27 13:49:58.738173+10,8,1,336,correct
3252,"select movie.title, movie.production_year, first_name, last_name
from movie_award,director,movie,person
where person.id = director.id 
	and movie_award.title = director.title 
	and movie_award.title = movie.title 
	and award_name = 'BAFTA Film Award' 
	and lower(category)='best film'
	and lower(result)='won';",2018-08-27 13:50:48.015868+10,8,1,344,correct
3253,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-27 13:51:01.067785+10,6,1,81,correct
3254,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 13:51:20.993476+10,14,1,144,correct
3255,"select count(*) from Writer_Award
where id=(select id from person
      where first_name=""Woody"" and last_name=""Allen"")
	  and year_of_award>1990 and year_of_award<1996;",2018-08-27 13:55:34.20074+10,9,0,336,partially correct
3256,"select count(*) from Writer_Award
where id=(select id from person
      where first_name=""Woody"" and last_name=""Allen"")
	  and year_of_award>1990 and year_of_award<1996
	  and result=""won"";",2018-08-27 13:56:49.659414+10,9,1,336,correct
3257,"SELECT p.id, p.first_name, p.last_name
FROM person p
INNER JOIN role r ON p.id = r.id
INNER JOIN actor_award aw ON r.title = aw.title
GROUP BY p.id
HAVING count(lower(result) = nominated) > 1 AND lower(result) != won;
",2018-08-27 13:58:11.275004+10,1,0,144,noninterpretable
3258,"with sub as (select p.id,p.first_name,p.last_name,count(*) as total from Person p inner join Director d on p.id=d.id inner join Writer w on w.id =d.id,movie m 
where m.title =d.title and m.production_year = d.production_year and 
	w.title =m.title and w.production_year = m.production_year group by p.id,p.first_name,p.last_name)
select id,first_name,last_name from sub where sub.total>=2;",2018-08-27 13:58:49.922627+10,4,1,19,correct
3259,"select id from person where year_born=
(select year_born from person
order by year_born desc
limit 1 offset 1)
;
",2018-08-27 13:59:02.860312+10,3,1,93,correct
3260,"SELECT id, first_name, last_name
FROM person
WHERE year_born = 
(SELECT MIN(year_born)
FROM person)
GROUP BY id;",2018-08-27 14:01:19.223922+10,7,0,81,partially correct
3261,"SELECT id, first_name, last_name
FROM person
WHERE year_born = 
(SELECT Max(year_born)
FROM person)
GROUP BY id;",2018-08-27 14:01:34.245771+10,7,1,81,correct
3262,"select m.title,m.production_year from Movie m inner join Writer w on m.title=w.title and m.production_year =w.production_year
inner join Person p on p.id=w.id where p.first_name='Kevin'and p.last_name='Williamson';",2018-08-27 14:03:41.398031+10,5,1,19,correct
3263,"select id, first_name, last_name, year_born
from(
select *, max(year_born)
from(
select *
from person
except
select id, first_name, last_name, year_born
from(
select *, max(year_born)
from person)
));",2018-08-27 14:04:16.961751+10,3,0,330,partially correct
3264,"select id
from(
select *, max(year_born)
from(
select *
from person
except
select id, first_name, last_name, year_born
from(
select *, max(year_born)
from person)
));",2018-08-27 14:04:51.983245+10,3,1,330,correct
3265,"SELECT e.id, n.award_name, n.year_of_award, n.category from director e,
                director_award n where e.title=n.title
				and e.production_year=n.production_year
				and lower(n.result)='nominated';",2018-08-27 14:08:35.980734+10,13,1,82,correct
3266,"SELECT title, production_year
FROM (person NATURAL JOIN writer) AS pd
WHERE first_name = 'Kevin'
AND last_name = 'Williamson';",2018-08-27 14:08:55.682146+10,5,1,222,correct
3267,"
select d.id, award_name, year_of_award, category from director_award da, director d
where lower(result) = 'nominated' 
  and da.title = d.title
  and da.production_year = d.production_year
  and da.title not in (select title from director_award da2 
                       where lower(result) = 'won' 
                         and da.title = da2.title 
                         and da.production_year = da2.production_year);",2018-08-27 14:10:03.674342+10,13,1,333,correct
3268,"SELECT count(*) FROM person p,writer w WHERE p.id = w.id and p.year_born = '1935' ;",2018-08-27 14:11:20.425968+10,1,0,229,partially correct
3269,"select count(*)
from writer_award wa, person p
where wa.result='won'
and wa.year_of_award>=1991
and wa.year_of_award<=1995
and wa.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen';",2018-08-27 14:12:21.001039+10,9,1,94,correct
3270,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-27 14:14:51.764265+10,4,1,149,correct
3271,select country from Restriction where title='Shakespeare in Love' and description ='M';,2018-08-27 14:15:06.071478+10,6,1,19,correct
3272,;,2018-08-27 14:15:15.099519+10,10,0,336,noninterpretable
3273,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-27 14:16:12.319375+10,6,1,222,correct
3274,"select id, award_name, year_of_award, category 
from director_award, director
where director_award.title = director.title
and director_award.production_year = director.production_year
group by director.title
having director_award.result != 'won'
;",2018-08-27 14:16:32.611413+10,13,1,93,correct
3275,"SELECT m.title, m.production_year, pd.first_name, pd.last_name
FROM movie m, (person NATURAL JOIN director) pd
WHERE m.title = (SELECT title
FROM movie_award
WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film');",2018-08-27 14:18:17.487212+10,8,0,81,partially correct
3280,"select count(*)
from writer_award,writer,person
where writer.id = person.id
	and writer_award.title = writer.title
	and lower(writer_award.result)='won'
	and person.first_name='Woody'
	and person.last_name='Allen'
	and writer_award.year_of_award between 1991 and 1995;",2018-08-27 14:23:52.583072+10,9,1,344,correct
3281,"select distinct p.id,Count(w.title) from person p inner join writer w on p.id = w.id inner join director on p.id = w.id
group by p.id;
",2018-08-27 14:24:24.338266+10,14,0,333,partially correct
3282,"SELECT id, first_name, last_name
FROM person p
WHERE year_born = (SELECT MAX(year_born) 
			  FROM person);",2018-08-27 14:25:03.510573+10,7,1,222,correct
3283,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
group by id
having count(*)=1;",2018-08-27 14:25:08.369288+10,10,1,336,correct
3284,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 14:26:02.598851+10,14,1,333,correct
3285,;,2018-08-27 14:26:38.534289+10,15,0,333,noninterpretable
3286,"select * from movie where production_year IN (1993,1992,1991) group by production_year;",2018-08-27 14:26:55.917337+10,2,0,137,partially correct
3287,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-27 14:27:43.221054+10,15,1,333,correct
3288,"select id,first_name,last_name from person where id in (select * from Director d,writer w where w.id = d.id); ",2018-08-27 14:31:05.656401+10,4,0,209,noninterpretable
3289,"select count(*), production_year from movie where production_year IN (1993,1992,1991) group by production_year;",2018-08-27 14:31:31.918209+10,2,1,137,correct
3290,"with sub as (select first_name, last_name,title, production_year from Person p inner join Director d on d.id=p.id )
select sub.title,sub.production_year,first_name,last_name from sub inner join Movie_award ma on ma.title=sub.title and ma.production_year=sub.production_year
where award_name like 'BAFTA Film Award'and category like 'Best Film';",2018-08-27 14:32:32.794379+10,8,0,19,partially correct
3291,"SELECT production_year
FROM CREW_AWARD
WHERE production_year='1935';",2018-08-27 14:36:17.898651+10,1,0,249,partially correct
3292,"with sub as (select first_name, last_name,title, production_year from Person p inner join Director d on d.id=p.id )
select ma.title,ma.production_year,first_name,last_name from sub inner join Movie_award ma on ma.title=sub.title and ma.production_year=sub.production_year
where award_name like 'BAFTA Film Award'and category like 'Best Film'and result like 'won';",2018-08-27 14:36:33.612404+10,8,1,19,correct
3293,"select title
from movie 
where title not in(
     select distinct title 
     from movie_award )
     and title not in(
     select distinct title 
     from crew_award)
     and title not in(
     select distinct title 
     from director_award)
     and title not in(
     select distinct title 
     from writer_award)
	and title not in(
     select distinct title 
     from actor_award);",2018-08-27 14:39:22.339639+10,11,0,336,partially correct
3294,select count(title) from movie where production_year = 1993 OR production_year = 1992 OR production_year = 1991;,2018-08-27 14:40:32.430095+10,2,0,66,partially correct
3295,select count(*) from;,2018-08-27 14:40:44.532253+10,9,0,229,noninterpretable
3296,"SELECT ma.title, ma.production_year, pd.first_name, pd.last_name
FROM movie_award ma, (person NATURAL JOIN director) pd
WHERE pd.title = ma.title 
	AND ma.award_name = 'BAFTA Film Award' 
	AND ma.category = 'best film' 
	AND ma.result = 'won';",2018-08-27 14:41:12.088733+10,8,1,81,correct
3297,"select production_year, count(title) from movie group by production_year having production_year = 1993 OR production_year = 1992 OR production_year = 1991;",2018-08-27 14:41:38.567799+10,2,1,66,correct
3298,"select *, count(*)
from writer
group by id
;
",2018-08-27 14:45:24.198858+10,14,0,330,partially correct
3299,"Select person id,
From PERSON,
Where year_born=1935;",2018-08-27 14:47:40.51446+10,1,0,252,noninterpretable
3300,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-27 14:49:42.152226+10,1,1,252,correct
3301,"with sub as (select p.id from Person p inner join Writer w on w.id=p.id where p.first_name like 'Woody' and p.last_name like 'Allen')
select count(*) from Writer_Award wa inner join sub on wa.id=sub.id where year_of_award between 1991 and 1995; ",2018-08-27 14:50:43.052682+10,9,0,19,partially correct
3302,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-27 14:51:17.866124+10,11,1,336,correct
3303,"

select id from
(select id, title from director
union all
select id, title from writer) t1
group by t1.id
order by count(title)desc
limit 1

;",2018-08-27 14:53:05.342724+10,14,0,93,partially correct
3304,SELECT count(*) FROM person p WHERE exists (select * from writer w where p.id = w.id and p.year_born = '1935' );,2018-08-27 14:53:31.613808+10,1,1,229,correct
3305,"with sub as (select p.id,w.title from Person p inner join Writer w on w.id=p.id where p.first_name like 'Woody' and p.last_name like 'Allen')
select count(*) from Writer_Award wa inner join sub on wa.id=sub.id and wa.title=sub.title where year_of_award between 1991 and 1995 and result like 'won'; ",2018-08-27 14:53:42.470489+10,9,1,19,correct
3306,select count(*) from person p left join director d on p.id = d.id where d.id is null; ,2018-08-27 14:54:21.481742+10,12,1,66,correct
3307,;,2018-08-27 14:54:35.738435+10,13,0,124,noninterpretable
3308,"with sub as (select p.id,w.title,production_year from Person p inner join Writer w on w.id=p.id where p.first_name like 'Woody' and p.last_name like 'Allen')
select count(*) from Writer_Award wa inner join sub on wa.id=sub.id and wa.title=sub.title and wa.production_year = sub.production_year where year_of_award between 1991 and 1995 and result like 'won'; ",2018-08-27 14:55:14.686085+10,9,1,19,correct
3309,"select dw.id ,dw.first_name,dw.last_name from (person natural join director natural join writer ) as dw
group by dw.id having count(*) > 1;",2018-08-27 14:59:01.254121+10,4,1,209,correct
3310,"select id
from person 
where year_born=(
     select max(year_born)
	 from person 
	 where year_born<(
	   select max(year_born)
	   from person 
	 ));",2018-08-27 14:59:33.76636+10,3,1,336,correct
3311,;,2018-08-27 15:03:09.946447+10,14,0,124,noninterpretable
3385,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-27 16:33:24.831121+10,4,1,148,correct
3312,"
select id from 
(select id,count(title) as counts from
(select id, title from director
union 
select id, title from writer) t1
group by t1.id
order by counts desc) t2
where counts=3



;",2018-08-27 15:03:31.407691+10,14,1,93,correct
3313,"select p.id, p.first_name, p.last_name 
from person p, 
(select id from director natural join writer natural join person group by id 
having count(title)>1) as x1
where x1.id = p.id;",2018-08-27 15:03:32.715758+10,4,1,66,correct
3314,;,2018-08-27 15:04:28.531803+10,15,0,124,noninterpretable
3315,"SELECT ma.id from 
(SELECT id, count(*) as number from director group by id
union 
SELECT id, count(*) as number from writer group by id) as ma
where ma.number=(select max(quantity) from ( select count(*)as quantity from director group by id union 
select count(*)as quantity from writer group by id) as ha);
",2018-08-27 15:06:34.620813+10,14,1,82,correct
3316,"select title, production_year from writer natural join person where first_name = 'Kevin' AND last_name = 'Williamson'; ",2018-08-27 15:06:45.865558+10,5,1,66,correct
3317,"SELECT ma.id from 
(SELECT id, count(*) as number from director group by id
union 
SELECT id, count(*) as number from writer group by id) as ma
where ma.number=(select max(quantity) from ( select count(*)as quantity from director group by id union 
select count(*)as quantity from writer group by id) as ha);
",2018-08-27 15:06:53.154976+10,14,1,82,correct
3318,"select title,production_year from (person natural join writer natural join movie) as wm
where wm.first_name = 'Kevin';",2018-08-27 15:07:47.012559+10,5,0,209,partially correct
3319,"select title,production_year from (person natural join writer natural join movie) as wm
where wm.first_name = 'Kevin' and wm.last_name = 'Williamson';",2018-08-27 15:09:22.097114+10,5,1,209,correct
3320,select country from restriction where title = 'Shakespeare in Love'AND description = 'M';,2018-08-27 15:09:40.203686+10,6,1,66,correct
3321,"select count(*) from Writer W,Person P
where P.id=W.id and year_born='1935';
",2018-08-27 15:10:05.265548+10,1,0,202,partially correct
3322,"select id, first_name, last_name from person where year_born = (select MAX(year_born) from person);",2018-08-27 15:11:38.886765+10,7,1,66,correct
3323,"Select title
from Movie;",2018-08-27 15:12:46.946569+10,2,0,252,partially correct
3324,select country from restriction r where r.title = 'Shakespeare in Love' and r.description = 'M';,2018-08-27 15:13:44.628846+10,6,1,209,correct
3325,"SELECT production_year, count(*)
FROM prodution_year
WHERE EXISTS(
SELECT production_year
FROM MOVIE
WHERE production_year IN ('1993','1992','1991'))
GROUP BY production_year;
",2018-08-27 15:14:24.927836+10,2,0,249,noninterpretable
3326,"select role.id
from appearance,scene,role
where appearance.title = 'Psycho'
and appearance.production_year='1960'
and role.title = 'Psycho'
and role.production_year='1960'
and scene.title = 'Psycho'
and scene.production_year='1960'
and appearance.description = role.description
and appearance.scene_no = scene.scene_no
group by role.id having count(*)=1;
",2018-08-27 15:14:55.390707+10,10,1,344,correct
3327,"select id from role r where exists(select * from scene s 
where r.title = s.title and r.production_year = s.production_year
group by scene_no
having count(scene_no)=1);",2018-08-27 15:16:39.489946+10,10,0,229,partially correct
3328,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-27 15:16:48.500559+10,2,1,252,correct
3329,"SELECT p.id p.first_name, p.last_name
FROM PERSON p INNER JOIN (DIRECTOR d INNER JOIN WRITTER w ON (d.id = w.id AND d.title = w.title AND d.production_year = w.production_year)) o
			ON p.id = o.id
		WHERE p.id IN (SELECT d.id
                 FROM DIRECTOR d
				 GROUP BY d.id
			  		HAVING COUNT(*)>1);",2018-08-27 15:16:51.504212+10,4,0,338,noninterpretable
3330,"SELECT p.id p.first_name, p.last_name
FROM PERSON p INNER JOIN (DIRECTOR d INNER JOIN WRITTER w ON (d.id = w.id AND d.title = w.title AND d.production_year = w.production_year)) o
			ON p.id = o.id
		WHERE p.id IN (SELECT d.id
                 FROM DIRECTOR d
				 GROUP BY d.id
			  		HAVING COUNT(*)>1);",2018-08-27 15:17:00.879894+10,4,0,338,noninterpretable
3331,"
select first_name,last_name, title, production_year, description
from person, role 
where person.id = role.id
and person.id in 
(select id from
(
select id, max(counts) from
(
select id, count(id) as counts from role
group by id
order by count(id) desc
limit 1
) t1
group by id
) t2)
;",2018-08-27 15:17:55.38844+10,15,1,93,correct
3332,"select count(*)
from movie
where movie.title NOT IN (select title from movie_award)
and movie.title NOT IN (select title from crew_award)
and movie.title NOT IN (select title from director_award)
and movie.title NOT IN (select title from writer_award)
and movie.title NOT IN (select title from actor_award);",2018-08-27 15:20:37.816658+10,11,0,344,partially correct
3333,"
select first_name,last_name, title, production_year, description
from person, role 
where person.id = role.id
and person.id in 
(select id from
	(select id, max(counts) from
		(select id, count(id) as counts from role
		group by id
		order by count(id) desc
		limit 1
		) t1
	) t2
)
;",2018-08-27 15:22:13.747382+10,15,1,93,correct
3334,"select 
	title, production_year, first_name, last_name
from 
	movie_award natural join movie natural join director natural join person
where
	award_name = 'BAFTA Film Award'
	AND lower(result) = 'won'
	AND lower(category) = 'best film';",2018-08-27 15:22:27.007081+10,8,1,66,correct
3335,"Select count(*)
From person p
Where exists (select * from director d where p.id != d.id);",2018-08-27 15:22:56.23682+10,12,0,252,partially correct
3336,;,2018-08-27 15:26:29.073998+10,14,0,91,noninterpretable
3337,"select b.first_name, b.last_name, i.title, i.production_year, i.description 
from person b, role i, (
            select id, count(*) from role group by id
            having count(*)=(select max(number) from (select count(*) as number from role group by id))) as h
WHERE b.id=h.id
  and i.id=h.id;",2018-08-27 15:26:34.349291+10,15,1,82,correct
3338,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-27 15:27:36.60237+10,12,1,252,correct
3339,"select h.id 

from(
select foo.id,count(*) as c 
from (select * from director union select id,title,production_year from writer) as foo 
group by foo.id

) as h
where h.c=(select max(c) from 
(
select foo.id,count(*) as c 
from (select * from director union select id,title,production_year from writer) as foo 
group by foo.id

) as h

);",2018-08-27 15:27:49.806266+10,14,1,91,correct
3340,"select 
	count(*) 
from 
	writer_award natural join writer natural join person
where
	first_name = 'Woody' AND last_name = 'Allen'
	AND result = 'won' AND year_of_award >= 1991 AND year_of_award <= 1995;",2018-08-27 15:29:09.195376+10,9,1,66,correct
3341,"SELECT p.id p.first_name, p.last_name
FROM PERSON p
		WHERE p.id IN (SELECT d.id
                 FROM DIRECTOR d
				 WHERE d.id EXISTS ((DIRECTOR d INNER JOIN WRITTER w ON (d.id = w.id AND d.title = w.title AND d.production_year = w.production_year))
				 GROUP BY d.id
			  		HAVING COUNT(*)>1);",2018-08-27 15:33:36.157986+10,4,0,338,noninterpretable
3342,"with sub as (select id,count(scene_no)as number from Role rl inner join Appearance app on rl.title=app.title and rl.production_year=app.production_year and rl.description =app.description
where app.title like'Psycho' and app.production_year =1960 group by id having number=1)
select id from sub;",2018-08-27 15:34:35.218129+10,10,1,19,correct
3343,"select * from person;
",2018-08-27 15:35:04.175709+10,13,0,172,partially correct
3344,"SELECT count(*)
FROM (writer_award wa NATURAL JOIN person) as pr
WHERE lower(pr.first_name) = ""woody"" and
	lower(pr.last_name) = ""allen"" and
	pr.year_of_award <= 1995 and
	pr.year_of_award >= 1991;",2018-08-27 15:35:07.227459+10,9,0,339,partially correct
3345,"SELECT production_year, count(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-27 15:35:51.65146+10,2,1,124,correct
3346,"select id,first_name,last_name from person where person.year_born = (select max(year_born) from person);",2018-08-27 15:37:57.828352+10,7,1,209,correct
3386,select id from role r where r.description = (select description from Appearance where scene_no = 1 and title = 'Psycho' and production_year = 1960);,2018-08-27 16:34:32.785535+10,10,0,209,partially correct
3347,"SELECT count(*)
FROM (writer_award wa NATURAL JOIN person) AS pr, writer AS wr
WHERE pr.title = wr.title AND
	pr.production_year = wr.production_year AND
	lower(pr.first_name) = ""woody"" and
	lower(pr.last_name) = ""allen"" and
	pr.year_of_award <= 1995 and
	pr.year_of_award >= 1991 and 
	lower(pr.result) = ""won"";",2018-08-27 15:38:20.927285+10,9,1,339,correct
3348,"select
	id
from
	appearance natural join role
group by
	id
having
	title = 'Psycho' AND production_year = 1960 AND count(scene_no) = 1;",2018-08-27 15:40:32.22613+10,10,0,66,partially correct
3349,"SELECT id
FROM (director INNER JOIN writer on writer.id = person.id) AS new
GROUP BY new,id
HAVING;",2018-08-27 15:43:00.397547+10,14,0,148,noninterpretable
3350,"select * from (director_award natural join director) da where da.result = 'nominated' and da.id not in ( select id from (director_award natural join director) da where da.result = 'won') ;

",2018-08-27 15:44:56.898347+10,13,0,172,partially correct
3351,"select da.id,da.award_name,da.year_of_award, da.category from (director_award natural join director) da where da.result = 'nominated' and da.id not in ( select id from (director_award natural join director) da where da.result = 'won') ;

",2018-08-27 15:46:18.538244+10,13,1,172,correct
3352,"select count(*) from Movie m
where (m.title,m.production_year) not in (select title,production_year from Movie_Award) and
	(m.title,m.production_year) not in (select title,production_year from Crew_Award) and
	(m.title,m.production_year) not in (select title,production_year from Director_Award) and
	(m.title,m.production_year) not in (select title,production_year from Writer_Award) and 
	(m.title,m.production_year) not in (select title,production_year from Actor_Award);",2018-08-27 15:46:20.615971+10,11,0,19,partially correct
3353,"SELECT dw.id,dw.first_name,dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*)>1;",2018-08-27 15:48:41.110112+10,4,1,49,correct
3354,"select count(*) from Movie m
where (m.title,m.production_year) not in (select title,production_year from Movie_Award where lower(result) ='won') and
	(m.title,m.production_year) not in (select title,production_year from Crew_Award where lower(result) ='won') and
	(m.title,m.production_year) not in (select title,production_year from Director_Award where lower(result) ='won') and
	(m.title,m.production_year) not in (select title,production_year from Writer_Award where lower(result) ='won') and 
	(m.title,m.production_year) not in (select title,production_year from Actor_Award where lower(result) ='won');",2018-08-27 15:52:53.934846+10,11,1,19,correct
3355,"select
	id
from
	appearance natural join role
where 
	lower(title) = 'psycho' AND production_year = 1960
group by
	id
having
	count(scene_no) = 1;",2018-08-27 15:52:54.771149+10,10,1,66,correct
3356,"select count(*) 
from 
writer w
inner join
person p
on w.id = p.id
where p.year_born = '1935';
",2018-08-27 15:54:41.313282+10,1,0,271,partially correct
3357,"select first_name,last_name, title, production_year,description 
from person,role
where person.id=role.id
and person.id= (
select foo.id from
(
select id,count(*) as c from role group by id
) as foo
where foo.c= (
select max(c) from(
select id,count(*) as c from role group by id
)as foo
)
);",2018-08-27 15:55:39.57775+10,15,1,91,correct
3358,"SELECT dw.title,dw.production_year
FROM (person NATURAL JOIN writer NATURAL JOIN movie )AS dw
GROUP BY dw.title,dw.production_year
HAVING dw.first_name = 'Kevin' AND dw.last_name = 'Williamson';",2018-08-27 15:56:26.055365+10,5,1,49,correct
3359,select * from movie_award ma where ma.award_name = 'BAFTA Film Award' and ma.category= 'Best Film';,2018-08-27 15:57:05.21148+10,8,0,209,partially correct
3360,"select title, production_year from movie,writer,person where person.last_name=williamson;",2018-08-27 15:57:09.420982+10,5,0,341,noninterpretable
3361,"select m.production_year, count(*)
from
movie m
group by m.production_year
having 
m.production_year >= '1991'
and
m.production_year <= '1993';",2018-08-27 15:57:41.676433+10,2,1,271,correct
3362,"SELECT COUNT(*)
FROM (
SELECT ID
FROM PERSON
EXCEPT
SELECT ID 
FROM DIRECTOR AS I);
",2018-08-27 15:59:19.942968+10,12,1,249,correct
3363,"SELECT country 
FROM restriction_category r 
WHERE description = 'M';",2018-08-27 15:59:44.514418+10,6,0,49,partially correct
3364,"SELECT country 
FROM restriction_category r 
WHERE description = 'M';",2018-08-27 16:01:14.379854+10,6,0,49,partially correct
3365,"select title, production_year from writer w,person p where w.id=p.id and lower(last_name)='williamson' and lower(first_name)='kevin';",2018-08-27 16:01:33.30797+10,5,1,341,correct
3366,"SELECT id
FROM role NATURAL JOIN appearance
WHERE lower(title) = ""psycho"" AND
	production_year = 1960
GROUP BY id
HAVING count(*) = 1;



",2018-08-27 16:02:22.96298+10,10,1,339,correct
3367,"select count(*)
from
person p
where
p.id not in (select id from director);",2018-08-27 16:03:56.441586+10,12,1,271,correct
3368,"SELECT r.id
FROM scene s,appearance a , role r 
WHERE s.production_year ='1960'
AND lower(a.title) = 'psycho'
AND s.production_year=r.production_year
AND s.title=r.title
AND a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.description=r.description
GROUP BY r.id
HAVING count(*) = 1;",2018-08-27 16:04:28.314797+10,10,1,228,correct
3369,"SELECT country 
FROM restriction  
WHERE 
     lower(title) = 'shakespeare in love'
	 AND description = 'M';",2018-08-27 16:05:16.040778+10,6,1,49,correct
3370,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma,director d,person p
where ma.title = d.title
            AND lower(ma.award_name)= 'bafta film award'
            AND lower(ma.category)= 'best film'
            AND lower(ma.RESULT)= 'won'
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 16:05:30.649884+10,8,1,209,correct
3371,"SELECT id,first_name,last_name 
FROM person
WHERE (year_born);",2018-08-27 16:07:54.838241+10,7,0,49,partially correct
3372,"select p.id, p.first_name, p.last_name
from
person p
inner join
writer w
on
p.id = w.id
group by p.id
having count(p.id) >= 2;",2018-08-27 16:08:15.053631+10,4,0,271,partially correct
3373," 
select count(*) from writer_award wa where wa.id = (select id from person where last_name ='Allen' and first_name ='Woody'); ",2018-08-27 16:11:31.414766+10,9,0,209,partially correct
3374,"with sub as (select id, rank()over(order by year_born desc) as young from Person group by id)
select id from sub where young=2;
",2018-08-27 16:12:43.895325+10,3,0,19,noninterpretable
3375,"SELECT id,first_name,last_name 
FROM person p
WHERE 
    p.year_born =(
	SELECT 
		max(year_born)
	FROM
		person);",2018-08-27 16:12:51.833776+10,7,1,49,correct
3376,"select writer.title, writer.production_year
from writer join person on writer.id = person.id  
where person.first_name = ""Kevin"" and person.last_name= ""Williamson"" 
group by writer.title;",2018-08-27 16:13:27.473047+10,5,1,235,correct
3377," 
select count(*) from writer_award wa where wa.id = (select id from person where last_name ='Allen' and first_name ='Woody') 
and wa.year_of_award > 1990 and wa.year_of_award < 1996 and wa.result = 'won'; ",2018-08-27 16:16:53.681979+10,9,1,209,correct
3378,"
SELECT ID
FROM 
;",2018-08-27 16:17:42.249863+10,4,0,249,noninterpretable
3379,"SELECT id, first_name, last_name FROM person, (SELECT MAX(year_born) AS h_year_born FROM person) AS a WHERE a.h_year_born=person.year_born;",2018-08-27 16:17:57.078387+10,7,1,288,correct
3380,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE p.id=w.id
	AND lower(first_name)='kevin'
	AND lower(last_name)='willianmson';",2018-08-27 16:20:27.304014+10,5,0,124,partially correct
3381,"select p.id, p.first_name, p.last_name
from
person p
inner join
director d
on
p.id = d.id
inner join
writer w
on
d.id = w.id
and
d.title = w.title
and
d.production_year = w.production_year
group by p.id
having count(p.id) > 1;
",2018-08-27 16:20:38.60317+10,4,1,271,correct
3382,"SELECT title, production_year
FROM writer w, person p
WHERE p.id=w.id
	AND lower(p.first_name)='kevin'
	AND lower(p.last_name)='williamson';",2018-08-27 16:21:33.301538+10,5,1,124,correct
3383,"SELECT id,p.first_name,p.last_name,d.title,d.production_year
FROM person p ,derictor d

WHERE p.id = d.id (SELECT title FROM movie_award WHERE d.title = m_a.title AND award_name ='BAFTA Film Award' 
		AND catogory = 'Best Film') ;",2018-08-27 16:28:38.40547+10,8,0,49,noninterpretable
3384,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love'
AND lower(description)='m';",2018-08-27 16:30:44.094785+10,6,1,124,correct
3387,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-27 16:36:43.638687+10,4,1,249,correct
3388,"SELECT
    id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY id
Having count(*) = 1;
",2018-08-27 16:44:12.256383+10,10,1,209,correct
3389,"SELECT id, titles, production years
FROM WRITER
WHERE(
SELECT id
FROM PERSON
WHERE first_name='Kevin' AND second_name='Williamson');
",2018-08-27 16:48:07.441681+10,5,0,249,noninterpretable
3390,"select r.country from restriction r, movie m where r.title='Shakespeare in Love' and r.description='M';",2018-08-27 16:53:24.282668+10,6,0,341,partially correct
3391,select country from restriction r where r.title='Shakespeare in Love' and r.description='M';,2018-08-27 16:54:18.876835+10,6,1,341,correct
3392,"SELECT ma.title,ma.production_year,p.frist_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma
	preson AS P
	director AS d
WHRER 
	p.id = d.id
	d.title = ma.title ;",2018-08-27 16:57:07.873469+10,8,0,49,noninterpretable
3393,"select id,award_name,year_of_award,category from Director d inner join Director_Award da on d.title=da.title and d.production_year=da.production_year
where id not in (select id from Director d inner join Director_Award da on d.title=da.title and d.production_year=da.production_year
where lower(result)='won') ;",2018-08-27 16:57:27.368686+10,13,1,19,correct
3394,"SELECT ma.title,ma.production_year,p.frist_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma
	person AS p
	director AS d
WHRER 
	p.id = d.id
	d.title = ma.title ;",2018-08-27 16:57:42.846285+10,8,0,49,noninterpretable
3395,"SELECT m.id
FROM movie AS m, (SELECT ma.title, ma.production_year 
FROM movie_award AS ma
WHERE lower(ma.result) = ""won""
UNION
SELECT ca.title, ca.production_year 
FROM crew_award AS ca
WHERE lower(ca.result) = ""won""
UNION
SELECT da.title, da.production_year 
FROM director_award AS da
WHERE lower(da.result) = ""won""
UNION
SELECT wa.title, wa.production_year 
FROM writer_award AS wa
WHERE lower(wa.result) = ""won""
UNION
SELECT aa.title, aa.production_year 
FROM actor_award AS aa
WHERE lower(aa.result) = ""won"") as rw;",2018-08-27 16:59:13.38684+10,11,0,339,noninterpretable
3396,"SELECT ma.title,ma.production_year,p.frist_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma,
	person AS p,
	director AS d
WHRER 
	p.id = d.id 
	AND ma.production_year = d.production_year
	AND d.title = ma.title ;",2018-08-27 17:00:05.372248+10,8,0,49,noninterpretable
3397,"SELECT ma.title,ma.production_year,p.frist_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma,
	person AS p,
	director AS d
WHERE 
	p.id = d.id 
	AND ma.production_year = d.production_year
	AND d.title = ma.title ;",2018-08-27 17:00:24.393289+10,8,0,49,noninterpretable
3398,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-27 17:00:54.111591+10,5,1,249,correct
3399,"SELECT COUNT(*)
FROM  writer_award wa
WHERE wa.id = (SELECT id
FROM person p
WHERE lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen');",2018-08-27 17:01:01.914923+10,9,0,81,partially correct
3400,"SELECT COUNT(*)
FROM  writer_award wa
WHERE wa.id = (SELECT id
FROM person p
WHERE lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen');",2018-08-27 17:01:08.323985+10,9,0,81,partially correct
3401,"SELECT ma.title,ma.production_year,p.frist_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma,
	person AS p,
	director AS d
WHERE 
	p.id = d.id 
	AND ma.production_year = d.production_year
	AND d.title = ma.title ;",2018-08-27 17:01:34.342637+10,8,0,49,noninterpretable
3402,"SELECT ma.title,ma.production_year,p.first_name,p.last_name 
FROM 
	(SELECT title, production_year 
	 FROM movie_award 
	 WHERE lower(award_name) = 'batfa film award' AND 
	 	 lower (category) = 'best film ' AND
		 lower (result) = 'won') AS ma,
	person AS p,
	director AS d
WHERE 
	p.id = d.id 
	AND ma.production_year = d.production_year
	AND d.title = ma.title ;",2018-08-27 17:02:24.775748+10,8,0,49,partially correct
3403,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 17:04:43.049514+10,8,1,49,correct
3404,"SELECT count(*)
FROM movie m
WHERE not exists (SELECT ma.title, ma.production_year 
FROM movie_award AS ma
WHERE lower(ma.result) = ""won"" and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT ca.title, ca.production_year 
FROM crew_award AS ca
WHERE lower(ca.result) = ""won"" and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT da.title, da.production_year 
FROM director_award AS da
WHERE lower(da.result) = ""won"" and da.title = m.title and da.production_year = m.production_year
UNION
SELECT wa.title, wa.production_year 
FROM writer_award AS wa
WHERE lower(wa.result) = ""won"" and wa.title = m.title and wa.production_year = m.production_year
UNION
SELECT aa.title, aa.production_year 
FROM actor_award AS aa
WHERE lower(aa.result) = ""won"" and aa.title = m.title and aa.production_year = m.production_year);",2018-08-27 17:05:20.39967+10,11,1,339,correct
3405,"SELECT COUNT(*)
FROM  writer_award wa
WHERE result = 'won' AND wa.year_of_award BETWEEN 1991 AND 1995 
AND wa.id = (SELECT id
FROM person p
WHERE lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen');",2018-08-27 17:08:28.702586+10,9,1,81,correct
3406,"select id 
from(
select id, count(*) as c
from(
select id, title, production_year
from director
union
select id, title, production_year
from director)
group by id)
where c = (
select max(c2)
from(
select id, count(*) as c2
from(
select id, title, production_year
from director
union
select id, title, production_year
from director)
group by id)
)
;",2018-08-27 17:17:26.10494+10,14,1,330,correct
3407,"SELECT p.year_born 
FROM person p
WHERE p.year_born = ALL(SELECT p1.year_born FROM person p1);",2018-08-27 17:25:02.836772+10,3,0,339,noninterpretable
3408,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM person
				WHERE person.year_born < 
					( SELECT MAX(year_born)
					 FROM person));",2018-08-27 17:27:58.141188+10,3,1,339,correct
3409,"select first_name, last_name, title, production_year, description
from person
natural join (
select *
from role
where
role.id = (
select id
from(
select *, max(c)
from(
select *, count(*) as c
from role
group by id)
)
)
)
;",2018-08-27 17:28:12.643403+10,15,1,330,correct
3410,";
",2018-08-27 17:33:15.099115+10,2,0,201,noninterpretable
3411,"select count(*) from person
where id in(select id from WRITER
group by id) 
      and year_born='1935';",2018-08-27 17:34:45.637951+10,1,1,167,correct
3412,"SELECT production_year, count (*)
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-27 17:35:44.391717+10,2,1,201,correct
3413,;,2018-08-27 17:35:53.147737+10,12,0,201,noninterpretable
3414,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-27 17:36:34.129635+10,12,1,201,correct
3415,";
",2018-08-27 17:36:42.646773+10,4,0,201,noninterpretable
3416,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-27 17:37:23.596755+10,4,1,201,correct
3417,";
",2018-08-27 17:37:37.327086+10,5,0,201,noninterpretable
3418,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-27 17:38:05.714943+10,5,1,201,correct
3419,";
",2018-08-27 17:39:08.25993+10,6,0,201,noninterpretable
3420,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';
",2018-08-27 17:39:52.095934+10,6,1,201,correct
3421,";
",2018-08-27 17:40:01.391339+10,7,0,201,noninterpretable
3422,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );
",2018-08-27 17:40:41.608756+10,7,1,201,correct
3423,";
",2018-08-27 17:40:49.017862+10,8,0,201,noninterpretable
3424,"SELECT w.title,w.production_year 
FROM (Person p Inner Join Writer w INNER JOIN Movie m ON m.title = w.title AND p.id = w.id AND p.first_name = 'Kevin' 
AND p.Last_name ='Williamson') AS w
Group by w.title;",2018-08-27 17:41:14.565374+10,5,1,218,correct
3425,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 17:41:29.904276+10,8,1,201,correct
3426,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 17:42:03.646519+10,9,0,201,partially correct
3427,"select production_year,count(*) from MOVIE
where production_year='1993' or production_year='1992' or production_year ='1991'
group by production_year;",2018-08-27 17:42:07.335155+10,2,1,167,correct
3428,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-27 17:42:20.624446+10,9,1,201,correct
3429,";
",2018-08-27 17:42:48.041819+10,10,0,201,noninterpretable
3430,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director_award da, director d
WHERE da.title = d.title AND
	da.production_year = d.production_year AND
	da.result = 'nominated'
EXCEPT
SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director_award da, director d
WHERE da.title = d.title AND
	da.production_year = d.production_year AND
	da.result = 'won';",2018-08-27 17:43:16.670838+10,13,1,339,correct
3431,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-27 17:43:16.713423+10,10,1,201,correct
3432,";
",2018-08-27 17:43:25.335043+10,11,0,201,noninterpretable
3433,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-27 17:43:56.425833+10,11,1,201,correct
3434,";
",2018-08-27 17:44:07.337846+10,3,0,201,noninterpretable
3435,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-27 17:44:28.458464+10,3,1,201,correct
3436,"SELECT country FROM RESTRICTION 
WHERE title = 'Shakespeare in Love' AND description = 'M'
Group by country;",2018-08-27 17:44:35.980132+10,6,1,218,correct
3437,;,2018-08-27 17:44:37.042136+10,13,0,201,noninterpretable
3438,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-27 17:45:07.684094+10,13,1,201,correct
3439,;,2018-08-27 17:45:23.707745+10,14,0,201,noninterpretable
3440,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 17:45:41.214016+10,14,1,201,correct
3441,;,2018-08-27 17:45:55.425278+10,15,0,201,noninterpretable
3442,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-27 17:46:12.725445+10,15,1,201,correct
3443,;,2018-08-27 17:47:18.613839+10,11,0,229,noninterpretable
3444,;,2018-08-27 17:50:32.132045+10,3,0,229,noninterpretable
3445,"SELECT
    r.id
FROM
    appearance a,
    scene s,
    role r
where 
    lower(s.title)= 'psycho' and 
    s.production_year = 1960 and
    s.title = r.title and 
    s.title = a.title and
    s.production_year = r.production_year and
    s.production_year = a.production_year and 
    a.description  = r.description and 
    s.scene_no = a.scene_no
group by r.id
having count(*)=1
    ;",2018-08-27 17:53:52.258983+10,10,1,331,correct
3446,"SELECT id, first_name,last_name 
FROM Person 
WHERE year_born = MIN (year_born)
Group by id;",2018-08-27 17:55:54.258791+10,7,0,218,noninterpretable
3447,"


select count(*) from (select p.id from PERSON as p
where p.id not in (select d.id from DIRECTOR as d group by d.id)
group by p.id);",2018-08-27 17:58:19.699512+10,12,1,167,correct
3448,"SELECT p.id, p.first_name,p.last_name 
FROM Person p
WHERE p.year_born = (SELECT MAX(year_born)
FROM PERSON)
GROUP by p.id;",2018-08-27 17:58:42.326463+10,7,1,218,correct
3449,"SELECT uni.id
FROM (SELECT *
FROM director 
UNION
SELECT id, title, production_year
FROM writer) AS uni
GROUP BY uni.id
HAVING COUNT(*) = (SELECT MAX(uni2.nmovie)
				FROM (SELECT uni1.id, COUNT(*) AS nmovie
					FROM (SELECT *
						FROM director 
						UNION
						SELECT id, title, production_year
						FROM writer) AS uni1
					GROUP BY uni1.id) AS uni2);",2018-08-27 18:05:03.092158+10,14,1,339,correct
3450,"select title, production_year
from WRITER, PERSON
where first_name='Kevin' and last_name='Williamson';",2018-08-27 18:08:40.309727+10,5,0,167,partially correct
3451,"select title, production_year
from WRITER, PERSON
where first_name='Kevin' and last_name='Williamson' and WRITER.id = PERSON.id;",2018-08-27 18:09:39.842545+10,5,1,167,correct
3452,"select id,award_name,year_of_award,category
from director natural join director_award
where result!=""won"";",2018-08-27 18:09:49.121382+10,13,1,85,correct
3453,"select country from RESTRICTION
where lower(title)='shakespeare in love' and lower(description)='m';",2018-08-27 18:13:51.995393+10,6,1,167,correct
3454,"select id,first_name,last_name from PERSON
order by year_born DESC
limit 1;",2018-08-27 18:16:02.306256+10,7,1,167,correct
3455,"select id from
(select p.id,max(p.c)
from (select id,count(id) as c
from (person natural join director natural join writer)
group by id)as p)
;",2018-08-27 18:18:51.269775+10,14,0,85,partially correct
3456,"select * from
writer natural join director;",2018-08-27 18:21:10.978908+10,14,0,85,partially correct
3457,"select title from from  movie natural join 
              movie_award natural join
              crew_award natural join
              director_award natural join
              writer_award natural join
              actor_award  ; 

",2018-08-27 18:22:00.05515+10,11,0,331,noninterpretable
3458,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM role r, movie m, person p
WHERE   p.id = r.id AND
	  r.title = m.title AND
	  r.production_year = m.production_year AND
	  r.id = (SELECT r2.id
		  FROM role r2, movie m2
		  WHERE r2.title = m2.title AND
			  r2.production_year = m2.production_year
		  GROUP BY r2.id
		  HAVING COUNT(r2.id) = (SELECT MAX(uni1.work_total)
						  FROM
							(SELECT r1.id, COUNT(*) AS work_total
							FROM role r1, movie m1
							WHERE r1.title = m1.title AND
								r1.production_year = m1.production_year
							GROUP BY r1.id) AS uni1));",2018-08-27 18:22:15.422933+10,15,1,339,correct
3459,"select count(*)from (select * from WRITER_AWARD as w, PERSON as p
where w.id = p.id and p.first_name = 'Woody' and p.last_name = 'Allen'and lower(w.result) = 'won' 
and production_year >= '1991' and production_year<='1995')l;
",2018-08-27 18:26:20.70509+10,9,0,167,partially correct
3460,"SELECT title, production_year FROM MOVIE_AWARD WHERE award_name = 'BAFTA' AND category = 'Best Film';",2018-08-27 18:29:20.802497+10,8,0,36,partially correct
3461,"select id
from (select id,count(*) as c
from (select id,title,production_year from writer union select id,title,production_year from director)
group by id) as x
where x.c=(select max(x2.c) from (select id,count(*) as c
from (select id,title,production_year from writer union select id,title,production_year from director)
group by id) as x2 )
;",2018-08-27 18:32:45.794321+10,14,1,85,correct
3462,"select count(*) from movie m where not exists (

select title, production_year from movie_award ma
where lower(ma.result) ='won' and ma.title =m.title and ma.production_year=m.production_year


union 

select title, production_year from crew_award ca
where lower(ca.result) ='won' and ca.title =m.title and ca.production_year=m.production_year

union

select title, production_year from director_award da
where lower(da.result) ='won' and da.title =m.title and da.production_year=m.production_year

union

select title, production_year from actor_award aa
where lower(aa.result) ='won' and aa.title =m.title and aa.production_year=m.production_year

union

select title, production_year from writer_award wa
where lower(wa.result) ='won' and wa.title =m.title and wa.production_year=m.production_year


);

",2018-08-27 18:33:36.198571+10,11,1,331,correct
3463,"SELECT COUNT(*)
FROM person,writer
WHERE writer.id = person.id AND person.year_born = 1935;",2018-08-27 18:41:45.046261+10,1,0,348,partially correct
3464,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-27 18:48:01.149285+10,8,1,36,correct
3465,"select id,award_name,year_of_award,category
from(
select *
  from Director_Award 
  where result != ""won"") as a,director as d
  where a.title = d.title;",2018-08-27 18:57:48.337757+10,13,1,336,correct
3466,"select first_name,last_name,title,production_year,description
from (person natural join role) 
where(
id=(
select id from
(select id,count(*) as c
from (person natural join role)
group by id) as p1
where p1.c=(select max(c) from
(select id,count(*) as c
from (person natural join role) as p2
group by id))));
",2018-08-27 19:00:45.115113+10,15,1,85,correct
3467,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );
",2018-08-27 19:01:21.057695+10,15,1,85,correct
3468,"SELECT y, production_count
FROM (SELECT production_year y, COUNT(*) AS production_count
        FROM movie
	GROUP BY y) p
WHERE y = 1993 OR y = 1992 OR y = 1991;
",2018-08-27 19:05:54.109652+10,2,1,348,correct
3469,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT DISTINCT d.id
		FROM director d
		WHERE d.id = p.id);",2018-08-27 19:13:50.184297+10,12,1,348,correct
3470,;,2018-08-27 19:26:44.009489+10,11,0,321,noninterpretable
3471,"
SELECT m.title, m.production_year
FROM movie m, writer w, person p
WHERE m.title = w.title AND m.production_year = w.production_year AND w.id = p.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson';
",2018-08-27 19:27:52.139233+10,5,1,348,correct
3472,"SELECT movie_award.title,movie_award.production_year,d.first_name,d.last_name
FROM movie_award,(SELECT * FROM director, person WHERE director.id=person.id) AS d
WHERE movie_award.title=d.title AND movie_award.production_year=d.production_year
AND lower(movie_award.category)=""best film"" AND lower(award_name)=""bafta film award"";",2018-08-27 19:28:17.553554+10,8,0,216,partially correct
3473,SELECT;,2018-08-27 19:28:19.183971+10,9,0,36,noninterpretable
3474,"SELECT movie_award.title,movie_award.production_year,d.first_name,d.last_name
FROM movie_award,(SELECT * FROM director, person WHERE director.id=person.id) AS d
WHERE movie_award.title=d.title AND movie_award.production_year=d.production_year
AND lower(movie_award.category)=""best film"" AND lower(award_name)=""bafta film award"" AND lower(result)=""won"";",2018-08-27 19:30:32.053674+10,8,1,216,correct
3475,"select restriction.country 
from Restriction 
where Restriction.description = ""M"" and restriction.title = ""Shakespeare in Love""
group by restriction.title;
",2018-08-27 19:31:00.857996+10,6,0,235,partially correct
3476,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-27 19:31:06.198574+10,6,1,348,correct
3477,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-27 19:33:39.61376+10,9,1,36,correct
3478,"SELECT id, first_name, last_name
FROM person p1
WHERE p1.year_born = (SELECT MAX(year_born)
			FROM person p2);",2018-08-27 19:34:31.490888+10,7,1,348,correct
3479,SELECT;,2018-08-27 19:35:14.595932+10,10,0,36,noninterpretable
3480,"SELECT count(*)
FROM writer_award AS wa, (SELECT * FROM writer,person WHERE writer.id=person.id) as p
WHERE wa.id=p.id
AND wa.title=p.title
AND wa.production_year=p.production_year
AND 1991<=wa.year_of_award<=1995
AND lower(result)=""won""
AND lower(p.first_name)=""woody""
AND lower(p.last_name)=""allen""
GROUP BY wa.award_name;",2018-08-27 19:44:25.121252+10,9,0,216,noninterpretable
3481,;,2018-08-27 19:54:00.296096+10,15,0,63,noninterpretable
3482,select * from person p where p.year_born=(select max(year_born) from person);,2018-08-27 19:57:14.281103+10,3,0,331,partially correct
3483,"SELECT *
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person))
;",2018-08-27 20:00:48.787489+10,3,0,331,partially correct
3484,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-27 20:01:05.587668+10,3,1,331,correct
3485,"select count(*) 
from movie m
where not exists (select distinct ma.title
from movie_award ma
where lower(ma.result) = 'won' and m.title = ma.title and m.production_year = ma.production_year
union
select distinct ca.title
from crew_award ca
where lower(ca.result) = 'won' and m.title = ca.title and m.production_year = ca.production_year
union
select distinct da.title
from director_award da
where lower(da.result) = 'won' and m.title = da.title and m.production_year = da.production_year
union
select distinct wa.title
from writer_award wa
where lower(wa.result) = 'won' and m.title = wa.title and m.production_year = wa.production_year
union
select distinct aa.title
from actor_award aa
where lower(aa.result) = 'won' and m.title = aa.title and m.production_year = aa.production_year); ",2018-08-27 20:10:06.529243+10,11,1,321,correct
3486,"select dw.id, dw.award_name,dw.category from (director_award natural join director natural join person)as dw where result not like 'won';",2018-08-27 20:13:11.670296+10,13,0,331,partially correct
3487,"select dw.id, dw.award_name,dw.year_of_award,dw.category from (director_award natural join director natural join person)as dw where result not like 'won';",2018-08-27 20:13:56.856548+10,13,1,331,correct
3488,"select p2.id
from person p2
where p2.year_born = (SELECT MAX(p.year_born)
  FROM person p
 WHERE p.year_born < (SELECT MAX(p1.year_born)
                 FROM person p1));",2018-08-27 20:16:59.835853+10,3,1,321,correct
3489,"select r.id from ROLE as r
where r.description in(select a.description from APPEARANCE as a
where a.title = 'Psycho' and a.production_year = '1960'
group by a.description
having count(*)=1);",2018-08-27 20:21:50.588989+10,10,0,167,partially correct
3490,"select r.id from ROLE as r
where r.description in(select a.description from APPEARANCE as a
where a.title = 'Psycho' and a.production_year = '1960'
group by a.description
having count(*)=1)
and r.title = 'Psycho' and r.production_year = '1960';",2018-08-27 20:23:09.490562+10,10,1,167,correct
3491,"select count(*),* from (person natural join writer natural join director)as  dw group by dw.id having count(*)=3;",2018-08-27 20:26:12.635444+10,14,0,331,partially correct
3492,"SELECT * 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 20:30:26.22231+10,14,0,331,partially correct
3493,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 20:30:44.495557+10,14,1,331,correct
3494,"select p.id from PERSON as p
where p.year_born in (select year_born from PERSON
group by year_born
order by year_born DESC
limit 1,1);
",2018-08-27 20:32:18.519922+10,3,1,167,correct
3495,"SELECT title, production_year, first_name FROM movie_award, (SELECT first_name, last_name FROM person, director, movie_award WHERE person.id=director.id AND director.title=movie_award.title) AS a WHERE movie_award.award_name='BAFTA Film Award' AND movie_award.category='Best Film';",2018-08-27 20:34:28.402993+10,8,0,288,partially correct
3496,"select title,production_year from writer,person where person.id=writer.id and person.first_name=""Kevin"" and person.last_name=""Williamson"";
",2018-08-27 20:35:59.218476+10,5,1,31,correct
3497,"select d.id, dir.award_name, dir.year_of_award, dir.category
from director d
inner join (select da.title, da.award_name, da.year_of_award, da.category
from director_award da1
full outer join director_award da
on da1.title = da.title
where lower(da.result) = 'nominated' and lower(da1.result) = 'nominated') as dir on dir.title = d.title;",2018-08-27 20:38:19.680287+10,13,0,321,noninterpretable
3498,select * from (role natural join person) dw group by dw.id having count(*)>5 ;,2018-08-27 20:38:44.38541+10,15,0,331,partially correct
3499,"select country from restriction where restriction.title=""Shakespeare in Love"" and restriction.description=""M"";",2018-08-27 20:40:10.46482+10,6,1,31,correct
3500,"select id, first_name, last_name, year_born from person  order by person.year_born DESC limit 1;",2018-08-27 20:48:35.846605+10,7,0,31,partially correct
3501,"select id, first_name, last_name from person  order by person.year_born DESC limit 1;",2018-08-27 20:48:47.821297+10,7,1,31,correct
3502,"select d.id, dir.award_name, dir.year_of_award, dir.category
from director d
inner join (select da.title, da.award_name, da.year_of_award, da.category
from director_award da1
inner join director_award da
on da1.title = da.title
where lower(da.result) = 'nominated' and lower(da1.result) = 'nominated') as dir on dir.title = d.title;",2018-08-27 20:49:37.505519+10,13,1,321,correct
3503,"SELECT p.id, p.first_name, p.last_name
FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITTER) AS p
GROUP BY p.id
HAVING COUNT(*)>1;",2018-08-27 20:49:57.049572+10,4,0,338,noninterpretable
3504,"select count(*) as num from MOVIE
where title in
(select m.title from MOVIE_AWARD as m
where lower(result) ='won'
UNION
select c.title from CREW_AWARD as c
where lower(result) ='won'
UNION
select d.title from DIRECTOR_AWARD as d
where lower(result) ='won'
UNION
select w.title from WRITER_AWARD as w
where lower(result) ='won'
UNION
select a.title from ACTOR_AWARD as a
where lower(result) ='won');",2018-08-27 20:50:01.358023+10,11,0,167,partially correct
3505,"select count(*) as num from MOVIE
where title not in
(select m.title from MOVIE_AWARD as m
where lower(result) ='won'
UNION
select c.title from CREW_AWARD as c
where lower(result) ='won'
UNION
select d.title from DIRECTOR_AWARD as d
where lower(result) ='won'
UNION
select w.title from WRITER_AWARD as w
where lower(result) ='won'
UNION
select a.title from ACTOR_AWARD as a
where lower(result) ='won');",2018-08-27 20:50:26.473694+10,11,0,167,partially correct
3506,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p NATURAL JOIN ((DIRECTOR d INNER JOIN WRITER w on d.id=w.id AND d.tile=w.tile AND d.production_year = w.production_year) AS o)
GROUP BY p.id
WHERE p.id IN (SELECT r.id FROM DIRECTOR r GROUP BY r.id HAVING COUNT(*)>1);
",2018-08-27 20:55:28.186853+10,4,0,338,noninterpretable
3529,"select wrk2.id
from (select wrk.id, count(*) as counts
from (select  d.id, title, production_year
from director d
union 
select w.id, title, production_year
from writer w) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(mx1.counts)
from (select mx.id, count(*) as counts
from (select  d.id, title, production_year
from director d
union 
select w.id, title, production_year
from writer w) as mx
group by mx.id) as mx1);",2018-08-27 21:22:57.06492+10,14,1,321,correct
3507,"select count(*) as num from MOVIE as mv
where not exists
(select m.title,m.production_year from MOVIE_AWARD as m
where lower(result) ='won' and mv.title = m.title and mv.production_year = m.production_year
UNION
select c.title,c.production_year from CREW_AWARD as c
where lower(result) ='won' and mv.title = c.title and mv.production_year = c.production_year
UNION
select d.title,d.production_year from DIRECTOR_AWARD as d
where lower(result) ='won' and mv.title = d.title and mv.production_year = d.production_year
UNION
select w.title,w.production_year from WRITER_AWARD as w
where lower(result) ='won' and mv.title = w.title and mv.production_year = w.production_year
UNION
select a.title,a.production_year from ACTOR_AWARD as a
where lower(result) ='won' and mv.title = a.title and mv.production_year = a.production_year);",2018-08-27 21:00:47.966353+10,11,1,167,correct
3508,"SELECT p.id
FROM (DIRECTOR d INNER JOIN WRITER w on d.id=w.id) AS p
WHERE p.id IN (SELET * FROM DIRECTOR r GROUP BY r.id HAVING COUNT(*)>1);

",2018-08-27 21:01:46.395209+10,4,0,338,noninterpretable
3509,select; ,2018-08-27 21:03:45.913929+10,1,0,293,noninterpretable
3510,"select movie_award.title, movie_award.production_year, person.first_name, person.last_name from person, movie_award, director where person.id
=(select director.id where movie_award.award_name=""BAFTA Film Award"" and movie_award.category=""Best Film"" and movie_award.result=""won"" 
and director.title=movie_award.title and director.production_year=movie_award.production_year);",2018-08-27 21:03:54.363819+10,8,0,31,partially correct
3511,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-27 21:04:46.735194+10,10,1,36,correct
3512,SELECT;,2018-08-27 21:05:04.565378+10,11,0,36,noninterpretable
3513,"SELECT COUNT(*) AS NUM
FROM WRITER NATURAL JOIN PERSON;",2018-08-27 21:05:26.325355+10,1,0,338,partially correct
3514,"select id from ROLE as r
where r.description in(select a.description from APPEARANCE as a
where a.title = 'Psycho' and a.production_year = '1960'
group by a.description
having count(*)=1)
and r.title = 'Psycho' and r.production_year = '1960';",2018-08-27 21:07:08.08165+10,10,1,167,correct
3515,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select distinct d.id, d.title
from director d
union 
(select distinct w.id, w.title
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = (select max(counts)
from (select d.id, count(d.id) as counts
from director d 
group by d.id) as mx);",2018-08-27 21:08:04.625894+10,14,0,321,noninterpretable
3516,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select distinct d.id, d.title
from director d
union 
(select distinct w.id, w.title
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = (select max(counts)
from (select d.id, count(d.id) as counts
from director d 
group by d.id) as mx)
order by wrk2.id asc;",2018-08-27 21:08:53.3324+10,14,0,321,noninterpretable
3517,select count(*) as amount from person p where exists (select * from writer w where w.id=p.id and p.year_born=1935);,2018-08-27 21:10:56.262588+10,1,1,293,correct
3518,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select distinct d.id, d.title
from director d
union 
(select distinct w.id, w.title
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = (select max(counts)
from (select mx.id, count(mx.id) as counts
from (select distinct d.id, d.title
from director d
union 
(select distinct w.id, w.title
from writer w)) as mx
group by mx.id) as mx1)
order by wrk2.id asc;",2018-08-27 21:11:38.55219+10,14,0,321,noninterpretable
3519,"SELECT COUNT(DISTINCT P.id)
FROM PERSON p INNER JOIN WRITER w ON w.id=p.id
WHERE p.year_born = 1935;",2018-08-27 21:13:26.214555+10,1,1,338,correct
3520,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select distinct d.id, d.title, production_year
from director d
union 
(select distinct w.id, w.title, production_year
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = (select max(counts)
from (select mx.id, count(mx.id) as counts
from (select distinct d.id, d.title, production_year
from director d
union 
(select distinct w.id, w.title, production_year
from writer w)) as mx
group by mx.id) as mx1);",2018-08-27 21:16:15.564127+10,14,0,321,noninterpretable
3521,"select d.title,d.production_year,p.first_name,p.last_name
from PERSON as p,DIRECTOR as d,MOVIE_AWARD as m
where p.id = d.id and d.title = m.title and d.production_year = m.production_year
and lower(m.award_name) = 'bafta film award' and lower(m.category)='best film'
and lower(m.result)='won';",2018-08-27 21:16:21.006264+10,8,1,167,correct
3522,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 21:16:45.280174+10,14,1,321,correct
3523,"Select m.production_year, count(*) as amount
from movie m
where m.production_year=""1993""or m.production year =""1992"" or m.production_year=""1991"";",2018-08-27 21:18:01.193231+10,2,0,293,noninterpretable
3524,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, d.title, production_year
from director d
union 
(select w.id, w.title, production_year
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = (select max(counts)
from (select mx.id, count(mx.id) as counts
from (select  d.id, d.title, production_year
from director d
union 
(select w.id, w.title, production_year
from writer w)) as mx
group by mx.id) as mx1);",2018-08-27 21:18:26.118137+10,14,0,321,noninterpretable
3525,"SELECT m.production_year, count(*) AS NUM
FROM MOVIE m
WHERE m.production_year=1993 OR m.production_year=1992 OR m.production_year=1991
GROUP BY m.production_year;
",2018-08-27 21:18:34.187327+10,2,1,338,correct
3526,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, d.title, production_year
from director d
union 
(select w.id, w.title, production_year
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(mx1.counts)
from (select mx.id, count(mx.id) as counts
from (select  d.id, d.title, production_year
from director d
union 
(select w.id, w.title, production_year
from writer w)) as mx
group by mx.id) as mx1);",2018-08-27 21:20:46.971635+10,14,0,321,noninterpretable
3527,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, title, production_year
from director d
union 
(select w.id, title, production_year
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(mx1.counts)
from (select mx.id, count(mx.id) as counts
from (select  d.id, title, production_year
from director d
union 
(select w.id, title, production_year
from writer w)) as mx
group by mx.id) as mx1);",2018-08-27 21:21:35.682902+10,14,0,321,noninterpretable
3528,"select wrk2.id
from (select wrk.id, count(*) as counts
from (select  d.id, title, production_year
from director d
union 
(select w.id, title, production_year
from writer w)) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(mx1.counts)
from (select mx.id, count(*) as counts
from (select  d.id, title, production_year
from director d
union 
(select w.id, title, production_year
from writer w)) as mx
group by mx.id) as mx1);",2018-08-27 21:22:15.32968+10,14,0,321,noninterpretable
3530,"Select m.production_year, count(*) as amount
from movie m
where m.production_year>1990 and m.production_year<1994
group by m.production_year;",2018-08-27 21:23:14.102234+10,2,1,293,correct
3605,"select distinct wr.title, wr.production_year 
from writer as wr, person as pr 
where wr.id=pr.id and pr.first_name='Kevin' and pr.last_name='Williamson';
",2018-08-27 23:17:19.117726+10,5,1,92,correct
3531,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(counts)
from (select mx.id, count(max.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as mx
group by mx.id) as mx1);",2018-08-27 21:23:52.415487+10,14,0,321,noninterpretable
3532,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(counts)
from (select mx.id, count(max.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as mx
group by mx.id) as mx1);",2018-08-27 21:23:57.424353+10,14,0,321,noninterpretable
3533,"select wrk2.id
from (select wrk.id, count(wrk.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as wrk
group by wrk.id) as wrk2
where wrk2.counts = 
(select max(counts)
from (select mx.id, count(mx.id) as counts
from (select  d.id, d.title, d.production_year
from director d
union 
select w.id, w.title, w.production_year
from writer w) as mx
group by mx.id) as mx1);",2018-08-27 21:24:38.861615+10,14,1,321,correct
3534,"SELECT *
FROM PERSON p
WHERE NOT EXISTS (SELECT *
FROM DIRECTOR);",2018-08-27 21:25:17.253015+10,12,0,338,partially correct
3535,"select count(*)
from person p
where not exists (select d.id from director d where p.id=d.id);",2018-08-27 21:28:16.992254+10,12,1,293,correct
3536,"select id, first_name, last_name
from;",2018-08-27 21:31:26.316266+10,4,0,293,noninterpretable
3537,"select restriction.country 
from Restriction 
where Restriction.description = ""M"" and lower(title)= "" Shakespeare in Love"";

",2018-08-27 21:31:58.270039+10,6,0,235,partially correct
3538,"select country 
from Restriction 
where description = ""M"" and lower(title)= "" Shakespeare in Love"";

",2018-08-27 21:32:36.004975+10,6,0,235,partially correct
3539,"select country 
from Restriction 
where lower(title)= "" Shakespeare in Love""and description = ""M"" ;

",2018-08-27 21:32:55.885309+10,6,0,235,partially correct
3540,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-27 21:34:20.946476+10,4,1,293,correct
3541,;,2018-08-27 21:35:05.197864+10,15,0,321,noninterpretable
3542,"select p.first_name, p.last_name, r4.title, r4.production_year, r4.description
from person p, role r4
where p.id = (select id
from (select r3.id, count(r3.id) as counts
from role r3
group by r3.id) as r2
where r2.counts = (select max(r1.counts)
from (select r.id, count(r.id) as counts
from role r
group by r.id) as r1))
and r4.id = (select id
from (select r3.id, count(r3.id) as counts
from role r3
group by r3.id) as r2
where r2.counts = (select max(r1.counts)
from (select r.id, count(r.id) as counts
from role r
group by r.id) as r1))
;",2018-08-27 21:35:27.528385+10,15,1,321,correct
3543,"SELECT COUNT(DISTINCT YEAR_BORN)
FROM person p LEFT JOIN writer w ON p.id=w.id
WHERE year_born='1935';",2018-08-27 21:36:36.282473+10,1,1,351,correct
3544,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';
",2018-08-27 21:37:35.692725+10,6,1,235,correct
3545,"Select id 
From person
Where id ;",2018-08-27 21:38:15.464984+10,12,0,105,partially correct
3546,"Select id 
From person
Where Not Exists
( Select *
From director
Where person.id = director.id);",2018-08-27 21:39:43.431993+10,12,0,105,partially correct
3547,"Select count (*)
From person
Where Not Exists
( Select *
From director
Where person.id = director.id);",2018-08-27 21:40:12.490768+10,12,1,105,correct
3548,"SELECT id,;",2018-08-27 21:41:19.848412+10,4,0,105,noninterpretable
3549,"select count(*) from WRITER_AWARD as w
where w.id in (
select p.id from PERSON as p  where p.first_name = 'Woody' 
and p.last_name = 'Allen') 
and w.year_of_award <='1995' and w.year_of_award >='1991'
and lower(result)='won';
",2018-08-27 21:42:57.947047+10,9,1,167,correct
3550,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-27 21:44:03.397217+10,4,1,105,correct
3551,"SELECT count(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT *
FROM DIRECTOR d
where d.id=p.id);",2018-08-27 21:44:19.237287+10,12,1,338,correct
3552,"WITH roles AS (SELECT id, COUNT(id) tot FROM role NATURAL JOIN person
			GROUP BY id),

most AS (SELECT id FROM roles 
WHERE tot = (SELECT MAX(tot) FROM roles))

SELECT first_name,last_name,title,production_year,description FROM role NATURAL JOIN person
WHERE id IN (SELECT * FROM most);",2018-08-27 21:44:38.801582+10,15,1,25,correct
3553,"SELECT w.title,w.production_year
FROM Writer w natural join Person p
where p.first_name ='Kevin' AND p.last_name='Williamson'
Group by w.title,w.production_year;",2018-08-27 21:49:06.152864+10,5,1,338,correct
3554,"select id from
(Select title,production_year  from Scene where scene_no=1 and title='Psycho' and production_year=1960) as t natural join Role;
",2018-08-27 21:49:11.76307+10,10,0,16,partially correct
3555,"WITH workcount AS (SELECT id,COUNT(id) tot FROM writer NATURAL JOIN director
GROUP BY id)

SELECT id FROM workcount
WHERE tot = (SELECT MAX(tot) FROM workcount);",2018-08-27 21:49:15.601534+10,14,0,25,partially correct
3556,"WITH workcount AS (SELECT id,COUNT(id) tot FROM writer NATURAL JOIN director
GROUP BY id,production_year)

SELECT id FROM workcount
WHERE tot = (SELECT MAX(tot) FROM workcount);",2018-08-27 21:49:45.624149+10,14,0,25,partially correct
3557,"WITH workcount AS (SELECT id,COUNT(id) tot FROM writer NATURAL JOIN director
GROUP BY id,title)

SELECT DISTINCT id FROM workcount
WHERE tot = (SELECT MAX(tot) FROM workcount);",2018-08-27 21:50:41.570017+10,14,0,25,partially correct
3558,"select pw.title and pw.production_year
from person p natural join writter w as pw
where pw.first_name=""Kevin"" and pw.last_name=""Williamson"";",2018-08-27 21:52:51.046634+10,5,0,293,noninterpretable
3559,"select ID, first_name, last_name
from person
where year_born= ""1908"";",2018-08-27 21:52:57.257529+10,7,0,235,partially correct
3560,"SELECT r.country
FROM restriction r
where r.description ='M' AND r.title='Shakespeare in Love';",2018-08-27 21:53:30.022685+10,6,1,338,correct
3561,"select ID, first_name, last_name, min(year_born)
from person
order by min(year_born);",2018-08-27 21:57:23.436011+10,7,0,235,partially correct
3562,"select pw.title and pw.production_year
from (person natural join writer) as pw
where pw.first_name=""Kevin"" and pw.last_name=""Williamson"";",2018-08-27 21:58:35.884218+10,5,0,293,partially correct
3563,"select pw.title and pw.production_year
from (person natural join writer) as pw
where lower(pw.first_name)='kevin' and lower(pw.last_name)='williamson';",2018-08-27 21:59:58.506835+10,5,0,293,partially correct
3564,"select pw.title, pw.production_year
from (person natural join writer) as pw
where lower(pw.first_name)='kevin' and lower(pw.last_name)='williamson'
group by pw.title;",2018-08-27 22:03:00.646544+10,5,1,293,correct
3565,"select pw.title, pw.production_year
from (person natural join writer) as pw
where lower(pw.first_name)='kevin' and lower(pw.last_name)='williamson';
",2018-08-27 22:03:36.526801+10,5,1,293,correct
3566,"SELECT
FROM;
",2018-08-27 22:04:31.204198+10,13,0,107,noninterpretable
3567,"select count(pr.year_born) from Writer as wr, person as pr 
	where wr.id = pr.id
	and pr.year_born = '1935';",2018-08-27 22:04:53.378034+10,1,0,92,partially correct
3568,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-27 22:04:53.409488+10,13,1,107,correct
3569,"SELECT p.first_name, p.last_name
from person p
where p.year_born =(select min(year_born) from person);",2018-08-27 22:05:38.273258+10,7,0,338,partially correct
3570,"SELECT
FROM;",2018-08-27 22:06:27.419116+10,14,0,107,noninterpretable
3571,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-27 22:06:47.804706+10,14,1,107,correct
3572,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-27 22:06:57.68017+10,7,1,235,correct
3573,"SELECT
FROM;
",2018-08-27 22:07:15.131784+10,15,0,107,noninterpretable
3574,"SELECT p.id ,p.first_name, p.last_name
from person p
where p.year_born =(select max(year_born) from person);",2018-08-27 22:07:15.374516+10,7,1,338,correct
3575,"select country
from restriction
where lower(title)='shakespeare in love' and lower(description)='m';",2018-08-27 22:07:41.329687+10,6,1,293,correct
3576,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-27 22:07:41.485609+10,15,1,107,correct
3577,"WITH w_d AS (SELECT DISTINCT  id,title,production_year FROM director 

UNION

SELECT DISTINCT id,title,production_year FROM writer),

id_count AS (SELECT id,COUNT(id) tot FROM w_d
GROUP BY id)


SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count);
",2018-08-27 22:07:48.293664+10,14,1,25,correct
3578,"SELECT id, first_name, last_name
FROM
    person 
WHERE
    person.year_born = (select max(year_born) from person);",2018-08-27 22:09:20.217334+10,7,1,235,correct
3579,"select id, first_name, last_name
from person 
where minimum();",2018-08-27 22:09:49.893373+10,7,0,293,noninterpretable
3580,"SELECT id,award_name,year_of_award,category FROM director NATURAL JOIN director_award
WHERE lower(result) = 'nominated'
AND id NOT IN (SELECT id FROM director NATURAL JOIN director_award
			WHERE lower(result) = 'won');",2018-08-27 22:10:52.428429+10,13,1,25,correct
3581,"select id, first_name, last_name
from person 
where year_born=(select max(year_born) from person);",2018-08-27 22:11:28.553913+10,7,1,293,correct
3582,"select count(*) from person as pr
where exists (select * from Writer as wr where wr.id = pr.id and pr.year_born = '1935');",2018-08-27 22:14:15.473989+10,1,1,92,correct
3583,"WITH oldest AS (SELECT MAX(year_born) tot FROM person),

without_oldest AS (SELECT year_born FROM person
WHERE year_born != (SELECT * FROM oldest)),

second_eldest AS (SELECT MAX(year_born) FROM without_oldest)

select id FROM person
WHERE year_born = (SELECT * FROM second_eldest)

;",2018-08-27 22:16:31.570612+10,3,1,25,correct
3584,"select p.first_name, p.last_name,r.title,r.production_year,r.description
from person p, role r
where p.id = r.id and r.id = (select id from (select id, Max(NoOfRole) from (select id, count(*) as NoOfRole from role group by id)));",2018-08-27 22:21:27.401008+10,15,1,46,correct
3585,"select * from  
(select count(*) as MovieCount, mv.production_year as PYear from Movie as mv group by mv.production_year) as mp
where mp.PYear = '1993' or mp.PYear = '1992' or mp.PYear = '1991'
; ",2018-08-27 22:27:47.886119+10,2,1,92,correct
3586,"select count(*)
from person p
where not exists(select *
			from director d
			where p.id = d.id);",2018-08-27 22:33:35.105874+10,12,1,43,correct
3587,"SELECT id,first_name,last_name
FROM PERSON
WHERE (SELECT * FROM director d);",2018-08-27 22:37:05.332173+10,4,0,329,noninterpretable
3588,"select p.id,p.first_name,p.last_name
from writer w
	inner join
	director d
	on w.id = d.id and
	w.production_year = d.production_year and
	w.title = d.title
	natural join 
	person p
group by w.id
having count(*) > 1;
",2018-08-27 22:39:39.832725+10,4,1,43,correct
3589,"SELECT ma.title, ma.production_year 
FROM (SELECT title,production_year From MOVIE_AWARD 
WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film') AS  ma
UNION
SELECT first_name, last_name FROM 
PERSON p 
WHERE (SELECT title FROM DIRECTOR d WHERE d.title = ma.title AND d.id = p.id)
GROUP BY ma.title;",2018-08-27 22:42:41.039442+10,8,0,218,noninterpretable
3590,"select country
from restriction
where lower(title) = ""shakespeare in love"" and
	lower(description) = ""m"";",2018-08-27 22:43:43.428159+10,6,1,43,correct
3591,"select p.id,p.first_name,p.last_name
from person p 
where p.year_born = (select max(year_born)
				from person p2);",2018-08-27 22:45:24.778515+10,7,1,43,correct
3592,"select production_year, count(*) from movie 
where production_year > 1990 and production_year < 1994 
group by production_year;
",2018-08-27 22:46:12.69922+10,2,1,92,correct
3593,"Select Distinct first_name, last_name, year_born From Person, Writer Where Person.id = Writer.id And Person.year_born = 1935;
",2018-08-27 22:48:45.196606+10,1,0,247,partially correct
3594,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
 Person p, 
 Role r,
 (select id, count(*) as number_of_roles from role group by id) as b where
 
 p.id=r.id and 
 r.id= b.id and 
 b.number_of_roles in (select  max(number_of_roles) from (select id, count(*) as number_of_roles from role group by id));",2018-08-27 22:48:49.090093+10,15,1,331,correct
3595,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma
	natural join
	director d
	natural join person p
where lower(ma.award_name) = ""bafta film award"" and
	lower(ma.category) = ""best film"" and
	lower(ma.result) = ""won"";",2018-08-27 22:49:18.048142+10,8,1,43,correct
3596,"select count(*) from person as pr
where not exists (select id from Director as d where d.id=pr.id);  ",2018-08-27 22:49:22.04633+10,12,1,92,correct
3597,"SELECT COUNT(*) FROM writer_award WHERE EXISTS (SELECT * FROM person WHERE person.first_name='Woody'
AND person.last_name='Allen' AND writer_award.id=person.id AND writer_award.year_of_award>1990
AND writer_award.year_of_award<1996);",2018-08-27 22:50:45.40364+10,9,0,288,partially correct
3598,"select distinct person.id,person.first_name,person.last_name from person inner join 
(select * from writer inner join director where writer.id=director.id) as wd
where person.id = wd.id;",2018-08-27 23:01:06.522033+10,4,0,92,partially correct
3599,"select distinct person.id,person.first_name,person.last_name from person inner join 
(select distinct writer.id from writer inner join director where writer.id=director.id) as wd
where person.id = wd.id;",2018-08-27 23:02:40.394406+10,4,0,92,partially correct
3600,"Select production_year, Count(title) From Movie m Where m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 Group By production_year;",2018-08-27 23:08:03.901004+10,2,1,247,correct
3601,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director_Award on Movie_Award.title = Director_Award.title 
      join Director on Director.title= Director_Award.title join person on person.id = director.id

where  lower(Movie_Award.Category) = "" Best Film "" and lower(Movie_Award.result) = ""BAFTA Film Award"" 


group by Movie_Award.title;



",2018-08-27 23:08:18.859096+10,8,0,235,partially correct
3602,"select count(distinct person.id)
from person, writer
where person.id=writer.id;",2018-08-27 23:08:42.41015+10,1,0,347,partially correct
3603,"select distinct person.id,person.first_name,person.last_name from person inner join 
(select distinct count (writer.id) as wcount, writer.id from writer inner join director where writer.id=director.id group by writer.id) as wd
where person.id = wd.id
and wd.wcount>2;",2018-08-27 23:08:49.069558+10,4,1,92,correct
3604,"Select Count(person.id) From Person, Director Where Person.id != Director.id;
",2018-08-27 23:14:00.137727+10,12,0,247,partially correct
3700,"select count(distinct p.id)
from person p inner join writer w
where p.year_born = 1935;",2018-08-28 08:47:03.244901+10,1,0,250,partially correct
3606,"SELECT COUNT(*) FROM writer_award WHERE EXISTS (SELECT * FROM person WHERE person.first_name='Woody'
AND person.last_name='Allen' AND writer_award.id=person.id AND writer_award.year_of_award>1990
AND writer_award.year_of_award<1996 AND writer_award.result='won');",2018-08-27 23:19:05.017421+10,9,1,288,correct
3607,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM (SELECT title, production_year
FROM movie_award Where lower(award_name) = 'bafta film award'
AND lower(category) = 'best film' AND lower(result)='won' ) AS ma,
Person p,
Director d
WHERE ma.title = d.title AND d.id = p.id AND ma.production_year = d.production_year
GROUP By ma.title;",2018-08-27 23:26:16.821732+10,8,1,218,correct
3608,"select count (distinct person.id)
from person, writer
where person.id = writer.id and year_born = 1935;",2018-08-27 23:28:45.723128+10,1,1,347,correct
3609,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director_Award on Movie_Award.title = Director_Award.title 
      join Director on Director.title= Director_Award.title join person on person.id = director.id

where  lower(Movie_Award.Category) = "" Best Film "" and lower(Movie_Award.result) = ""BAFTA Film Award"" 


group by Movie_Award.title;



",2018-08-27 23:29:08.250418+10,8,0,235,partially correct
3610,"select production_year, count(*)
from movie
group by production_year
having production_year = 1993 or production_year = 1992 or production_year =1991;",2018-08-27 23:33:32.422467+10,2,1,347,correct
3611,"SELECT count(*) FROM 
Writer_award wa 
WHERE (SELECT id FROM Person p 
WHERE wa.id = p.id AND p.first_name = 'Woody' AND p.last_name='Allen' AND wa.production_year>1990 AND wa.production_year<1996 );


",2018-08-27 23:38:38.462005+10,9,1,218,correct
3612,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where lower(movie_Award.category )= 'Best Film' and lower(movie_Award.award_name) = 'BAFTA Film Award' 
and movie_Award.award_name = ' won '

group by Movie_Award.title;



",2018-08-27 23:42:29.103505+10,8,0,235,partially correct
3613,"select count (id)
from person as p
where id not in (
select distinct id 
from director);",2018-08-27 23:43:45.878109+10,12,1,347,correct
3614,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where lower(movie_Award.category )= 'Best Film' and lower(movie_Award.award_name) = 'BAFTA Film Award' 
and movie_Award.award_name = 'won'

group by Movie_Award.title;



",2018-08-27 23:44:14.719198+10,8,0,235,partially correct
3615,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where lower(movie_Award.category )= 'Best Film' and lower(movie_Award.award_name) = 'BAFTA Film Award' 
and movie_Award.award_name = 'won'

group by Movie_Award.title;

",2018-08-27 23:44:55.572236+10,8,0,235,partially correct
3616,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where movie_Award.category = 'Best Film' and movie_Award.award_name = 'BAFTA Film Award' 
and movie_Award.award_name = 'won'


group by Movie_Award.title;

",2018-08-27 23:46:41.806913+10,8,0,235,partially correct
3617,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where movie_Award.category = 'Best Film' and movie_Award.award_name = 'BAFTA Film Award' 
and movie_Award.result = 'won'


group by Movie_Award.title;

",2018-08-27 23:47:21.806079+10,8,0,235,partially correct
3618,"SELECT role.id FROM scene, role
WHERE scene.title='Psycho' AND scene.production_year=1960 AND scene.title=role.title
AND scene.production_year=role.production_year
GROUP BY id HAVING COUNT(scene_no)=1;",2018-08-27 23:47:46.943739+10,10,0,288,partially correct
3619,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where movie_Award.category = 'Best Film' and movie_Award.award_name = 'BAFTA Film Award' 
     


group by Movie_Award.title;

",2018-08-27 23:50:45.520438+10,8,0,235,partially correct
3620,"select first_name, last_name
from person
where id in (
select director.id
from director, writer
where writer.title = director.title and
writer.production_year = director.production_year and
writer.id = director.id
group by director.id having count(*)>2);",2018-08-27 23:53:20.656787+10,4,0,347,partially correct
3621,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where movie_Award.category = 'Best Film' and movie_Award.award_name = 'BAFTA Film Award'

Group by Movie_Award.title, Movie_Award.production_year;
     




",2018-08-27 23:53:41.487104+10,8,0,235,partially correct
3622,"select id, first_name, last_name
from person
where id in (
select director.id
from director, writer
where writer.title = director.title and
writer.production_year = director.production_year and
writer.id = director.id
group by director.id having count(*)>2);",2018-08-27 23:54:41.65857+10,4,0,347,partially correct
3623,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id

where movie_Award.category = 'Best Film' and movie_Award.award_name = 'BAFTA Film Award';


     




",2018-08-27 23:55:16.308097+10,8,0,235,partially correct
3624,"select id, first_name, last_name
from person
where id in (
select director.id
from director, writer
where writer.title = director.title and
writer.production_year = director.production_year and
writer.id = director.id
group by director.id having count(*)>1);",2018-08-28 00:01:18.305136+10,4,1,347,correct
3625,"SELECT role.id FROM appearance, role
WHERE appearance.title='Psycho' AND appearance.production_year=1960 AND appearance.title=role.title
AND appearance.production_year=role.production_year AND appearance.description=role.description
GROUP BY id HAVING COUNT(scene_no)=1;",2018-08-28 00:03:06.226854+10,10,1,288,correct
3626,"Select Distinct id, first_name, last_name From Person Writer Where (Select Count(*) From Director As d Where d.id = Writer.id) > 2;
",2018-08-28 00:03:25.19239+10,4,0,247,partially correct
3627,"SELECT r.id FROM Role r
WHERE (SELECT title From SCENE s
WHERE r.title=s.title AND lower(s.title) = 'psycho' )
Group by r.id HAVING count(id)=1;",2018-08-28 00:03:51.053663+10,10,0,218,partially correct
3628,"select x.title, x.production_year, x.first_name, x.last_name
from  (Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
) as x
where lower(category) = 'Best Film' and x.award_name = 'BAFTA Film Award' and x.result = 'won';

     




",2018-08-28 00:05:56.766444+10,8,0,235,partially correct
3629,"select dw.id, dw.first_name, dw.last_name
from (person natural join writer natural join director) as dw
group by dw.id having count(*)>1;",2018-08-28 00:06:08.117666+10,4,1,347,correct
3630,"select a.title, a.production_year, a.first_name, a.last_name
from  (Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id)as a
where lower(a.category) = 'best film' and a.award_name = 'BAFTA Film Award' and a.result = 'won';



",2018-08-28 00:09:42.325659+10,8,1,235,correct
3631,"select title, production_year
from writer
where id = (
select id 
from person
where first_name = 'Kevin' and last_name = 'Williamson');",2018-08-28 00:09:48.148074+10,5,1,347,correct
3632,"SELECT title,, production_year,
FROM (MOVIE NATURAL JOIN director) AS et
GROUP BY et.title ;",2018-08-28 00:11:40.807333+10,5,0,329,noninterpretable
3633,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name, movie_Award.category

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
 
where movie_Award.category = 'best film' and movie_Award.award_name = 'BAFTA Film Award' and movie_Award.result='won';


",2018-08-28 00:12:57.183396+10,8,0,235,partially correct
3634,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name, movie_Award.category

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
 
where lower(movie_Award.category) = 'best film' and movie_Award.award_name = 'BAFTA Film Award' and movie_Award.result='won';


",2018-08-28 00:13:17.342974+10,8,0,235,partially correct
3635,"SELECT COUNT(*)
FROM WRITER NATURAL JOIN PERSON p
WHERE p.year_born = '1935';


",2018-08-28 00:14:28.906143+10,1,0,191,partially correct
3636,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
 
where lower(movie_Award.category) = 'best film' and movie_Award.award_name = 'BAFTA Film Award' and movie_Award.result='won';


",2018-08-28 00:14:34.159914+10,8,1,235,correct
3637,"SELECT country
FROM Restriction r
WHERE r.name = Shakespeare_in_Love AND r.description = M;",2018-08-28 00:15:28.642617+10,6,0,329,noninterpretable
3638,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
 
where lower(movie_Award.category) = 'best film' and lower(movie_Award.award_name) = 'BAFTA Film Award' 

      and lower(movie_Award.result)='won';


",2018-08-28 00:16:31.778265+10,8,0,235,partially correct
3639,"select count(*),p.id,p.first_name from (person p left join director d on d.id = p.id left join writer w on p.id = w.id) group by p.id;",2018-08-28 00:16:36.472222+10,14,0,172,partially correct
3640,"select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name

from  Movie_Award join Director on Director.title= Movie_Award.title join person on person.id = director.id
 
where lower(movie_Award.category) = 'best film' and lower(movie_Award.award_name) = 'bafta film award' 

      and lower(movie_Award.result)='won';


",2018-08-28 00:16:59.865558+10,8,1,235,correct
3641,"SELECT country
FROM Restriction r
WHERE r.title = 'Shakespeare in Love' AND r.description = 'M';",2018-08-28 00:16:59.992435+10,6,1,329,correct
3642,"SELECT COUNT(*)
FROM person, director
WHERE person.id != director.id;",2018-08-28 00:18:03.901546+10,12,0,152,partially correct
3643,"SELECT COUNT(*)
FROM person
WHERE not exists(select * from director
where person.id = director.id);",2018-08-28 00:20:33.753519+10,12,1,152,correct
3644,"SELECT id,first_name,last_name
FROM PERSON
Where year_born = (SELECT MIN(year_born) FROM PERSON);",2018-08-28 00:23:03.180089+10,7,0,329,partially correct
3645,"SELECT id,first_name,last_name
FROM PERSON
Where year_born = (SELECT MAX(year_born) FROM PERSON);",2018-08-28 00:24:14.580029+10,7,1,329,correct
3646,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-28 00:25:21.621433+10,10,1,218,correct
3647,;,2018-08-28 00:30:08.009483+10,8,0,329,noninterpretable
3648,"SELECT COUNT ( year_of_award)
FROM person p, Writer_Award wa
WHERE(wa.id = p.id AND p.first_name = Woody AND p.last_name = Allen AND year_of_award> 1990 AND year_of_award< 1996);",2018-08-28 00:39:14.11639+10,9,0,329,noninterpretable
3649,"SELECT * FROM person
WHERE year_born=1935
WHEN (id FROM person = id FROM writer);",2018-08-28 00:45:32.884995+10,1,0,121,noninterpretable
3650,select count(distinct id) from (select * from person inner join writer on person.id=writer.id) as a where year_born=1935;,2018-08-28 00:48:42.780115+10,1,1,190,correct
3651,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w 
WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 00:50:39.063221+10,1,1,121,correct
3652,"SELECT COUNT(production_year)
FROM movie
WHEN EXISTS (SELECT * FROM movie
WHEN production_year = 1993
AND production_year = 1992
AND production_year = 1991);",2018-08-28 00:54:20.459831+10,2,0,121,noninterpretable
3653,"SELECT production_year, COUNT (*)
FROM movie
WHERE production_year > 1990
AND production_year < 1994
GROUP BY production_year;",2018-08-28 00:58:02.925321+10,2,1,121,correct
3654,select id from person where year_born=(select max(year_born) from person where year_born <(select max(year_born) from person));,2018-08-28 01:01:50.179883+10,3,1,190,correct
3655,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM director d
WHERE d.id != p.id);",2018-08-28 01:02:54.750867+10,12,0,121,partially correct
3656,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d
WHERE d.id = p.id);",2018-08-28 01:05:14.936773+10,12,1,121,correct
3657,"select id, first_name, last_name
from person p
where (select * from director d 
where (select * from writer w 
where p.id=d.id=w.id and count(*) >1));",2018-08-28 01:13:06.825521+10,4,0,152,noninterpretable
3658,"select count(distinct title),production_year from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year; ",2018-08-28 01:13:19.564292+10,2,1,190,correct
3659,"select production_year,count(distinct title) from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year; ",2018-08-28 01:14:05.930005+10,2,1,190,correct
3660,"select d.id, first_name, last_name
from (person natural join director natural join writer) as d
group by d.id
having count(*)>1;",2018-08-28 01:18:56.298079+10,4,1,152,correct
3661,"SELECT id, year_born,
FROM Person,
WHERE year_born = 1935;",2018-08-28 01:29:04.892354+10,1,0,142,noninterpretable
3662,"Select max(t.id) as ids,first_name,last_name,t.title,t.production_year,t.description from
(select id,count(id),title,production_year,description  from Role group by id)  as t natural join Person ;",2018-08-28 01:41:20.217867+10,15,0,16,partially correct
3663,"SELECT COUNT(*) FROM (SELECT DISTINCT * FROM movie_award, crew_award, director_award, 
writer_award, actor_award WHERE movie_award.result!='won' AND crew_award.result!='won' 
AND director_award.result!='won' AND writer_award.result!='won' 
AND actor_award.result!='won') AS h;",2018-08-28 01:50:16.164109+10,11,0,288,partially correct
3664,"select count(writer_award.title)

from Writer_Award join Writer on writer.title = writer_Award.title
     Join person on person.id = writer.id 


where person.first_name = 'Woody' and person.last_name ='Allen' and writer_Award.year_of_award between '1991' and '1995';",2018-08-28 02:07:20.065995+10,9,0,235,partially correct
3665,"SELECT id, year_born,
FROM Person,
WHERE year_born = 1935;",2018-08-28 02:07:43.514446+10,1,0,142,noninterpretable
3666,"SELECT COUNT(*) FROM movie
WHERE NOT EXISTS (SELECT title, production_year FROM movie_award WHERE movie_award.result='won'
AND movie_award.title=movie.title AND movie_award.production_year=movie.production_year
UNION
SELECT title, production_year FROM crew_award WHERE crew_award.result='won'
AND crew_award.title=movie.title AND crew_award.production_year=movie.production_year
UNION
SELECT title, production_year FROM director_award WHERE director_award.result='won'
AND director_award.title=movie.title AND director_award.production_year=movie.production_year
UNION
SELECT title, production_year FROM writer_award WHERE writer_award.result='won'
AND writer_award.title=movie.title AND writer_award.production_year=movie.production_year
UNION
SELECT title, production_year FROM actor_award WHERE actor_award.result='won'
AND actor_award.title=movie.title AND actor_award.production_year=movie.production_year);
",2018-08-28 02:11:11.421133+10,11,0,288,partially correct
3701,"select p.id,p.first_name,p.last_name
from PERSON as p
where p.id in (select d.id from WRITER as w,DIRECTOR as d
where d.id = w.id 
	and d.title = w.title
	and d.production_year = w.production_year
group by d.id
having count(*)>1);",2018-08-28 08:56:22.513743+10,4,1,167,correct
4531,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d
 WHERE p.id = d.id);",2018-08-28 22:43:15.837724+10,12,1,378,correct
3667,"select writer_award.title, writer_award.production_year

from Writer_Award join Writer on writer.title = writer_Award.title and writer.production_year = writer_Award.production_year
     Join person on person.id = writer.id 


where person.first_name = 'Woody' and person.last_name ='Allen' and writer_Award.year_of_award between '1991' and '1995'
      and writer_Award.result ='won';",2018-08-28 02:12:20.541624+10,9,0,235,partially correct
3668,"select count(writer_award.title)

from Writer_Award join Writer on writer.title = writer_Award.title and writer.production_year = writer_Award.production_year
     Join person on person.id = writer.id 


where person.first_name = 'Woody' and person.last_name ='Allen' and writer_Award.year_of_award between '1991' and '1995'
      and writer_Award.result ='won';",2018-08-28 02:12:38.939837+10,9,1,235,correct
3669,"select person.id, person.first_name, person.last_name

from scene join movie on scene.title = movie.title and scene.production_year = movie.production_year
     Join role on role.title = movie.title join person on role.id = person.id

where lower(scene.title) = 'psycho' and scene.production_year = '1960';",2018-08-28 02:23:46.339319+10,10,0,235,partially correct
3670,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 02:31:37.120107+10,1,1,142,correct
3671,"select role.id

from scene join Appearance on scene.title = Appearance.title and scene.production_year = Appearance.production_year
     
     and scene.scene_no = Appearance.scene_no

     Join role on role.title = Appearance.title and role.production_year = Appearance.production_year 
   
     and role.description = Appearance.description
 

where lower(scene.title) = 'psycho' and scene.production_year = '1960' and scene.scene_no = Appearance.scene_no;


",2018-08-28 02:45:15.959647+10,10,0,235,partially correct
3672,"select role.id

from scene join Appearance on scene.title = Appearance.title and scene.production_year = Appearance.production_year
     
     and scene.scene_no = Appearance.scene_no

     Join role on role.title = Appearance.title and role.production_year = Appearance.production_year 
   
     and role.description = Appearance.description
 

where lower(scene.title) = 'psycho' and scene.production_year = '1960' and scene.scene_no = Appearance.scene_no


Group by role.id

Having count(scene.scene_no)=1;

",2018-08-28 02:47:19.447544+10,10,1,235,correct
3673,"SELECT Count(*)
FROM Movie 
WHERE EXISTS (SELECT * FROM Movie where p.production_year = t.title AND year = 1993,1992,1991);
",2018-08-28 02:47:39.326496+10,2,0,142,noninterpretable
3674,"select role.id

from scene join Appearance on scene.title = Appearance.title and scene.production_year = Appearance.production_year
     
     and scene.scene_no = Appearance.scene_no

     Join role on role.title = Appearance.title and role.production_year = Appearance.production_year 
   
     and role.description = Appearance.description
 

where lower(scene.title) = 'psycho' and scene.production_year = '1960' and scene.scene_no = Appearance.scene_no


Group by role.id

Having count(scene.scene_no)=1;

",2018-08-28 02:48:19.680717+10,10,1,235,correct
3675,"SELECT production_year, Count(*)
FROM Movie 
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-28 02:52:28.123863+10,2,1,142,correct
3676,"SELECT person, Count(*)
FROM Director
WHERE person <> Director
GROUP BY person;
",2018-08-28 03:03:45.333209+10,12,0,142,noninterpretable
3677,"select count(*)
from writer w
Where EXISTS(Select * from person p where w.id=p.id AND p.year_born=1935);
",2018-08-28 03:11:02.860356+10,1,0,309,partially correct
3678,"SELECT count(*) 
FROM person p
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);
",2018-08-28 03:17:37.434529+10,12,1,142,correct
3679,"select count(*)
from person p
Where EXISTS(Select * from writer w where w.id=p.id AND p.year_born=1935);
",2018-08-28 03:20:17.058556+10,1,1,309,correct
3680,"SELECT fname, lname Count(*)
FROM Movies m
WHERE EXISTS (SELECT * FROM Movies m where d.id <= 2 AND p.id = d.id),
GROUP BY fname, lname;",2018-08-28 03:23:28.062256+10,4,0,142,noninterpretable
3681,"select m.production_year, count (*) as No_OF_MOVIES
from MOVIE m
Where m.production_year<=1993 AND m.production_year>=1991;",2018-08-28 03:25:38.285066+10,2,0,309,partially correct
3682,"select m.production_year, count (*) as No_OF_MOVIES
from MOVIE m
Where m.production_year<=1993 AND m.production_year>=1991
GROUP BY m.production_year;",2018-08-28 03:28:45.128181+10,2,1,309,correct
3683,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-28 03:30:31.69286+10,4,1,142,correct
3684,"SELECT md.Title, md.Production_year
FROM Movies md
WHERE p.id = ""Kevin Williamson""
GROUP BY md.Title, md.Production_year;",2018-08-28 03:35:03.990277+10,5,0,142,noninterpretable
3685,"select count(*)
from person p
Where NOT EXISTS (Select * from DIRECTOR d where p.id=d.id);",2018-08-28 03:35:05.283091+10,12,1,309,correct
3686,"select count(*) as TOTAL
from person p
Where NOT EXISTS (Select * from DIRECTOR d where p.id=d.id);",2018-08-28 03:35:49.666869+10,12,1,309,correct
3687,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-28 03:36:38.222059+10,5,1,142,correct
3688,"Select count( DISTINCT writer.id)
from writer natural join person
where person.year_born=1935;",2018-08-28 05:26:21.611091+10,1,1,83,correct
3689,"Select production_year, count(*)
from movie e
where e.production_year=1993 or e.production_year=1992 or e.production_year=1991
group by e.production_year
order by e.production_year desc;


",2018-08-28 05:31:12.127704+10,2,1,83,correct
3690,"select * from person, writer where year_born = 1935;",2018-08-28 08:19:15.830387+10,1,0,334,partially correct
3691,select * from writer where production_year = 2000;,2018-08-28 08:20:04.439756+10,1,0,357,partially correct
3692,select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935);,2018-08-28 08:20:31.334187+10,1,1,334,correct
3693,select count(*) from person where exists (select * from writer where writer.id = person.id and person.year_born = 1935);,2018-08-28 08:24:00.127211+10,1,1,334,correct
3694,select count(*) from person where exists (select * from writer where writer.id = person.id and person.year_born = 1935);,2018-08-28 08:24:06.007895+10,1,1,334,correct
3695,select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935);,2018-08-28 08:24:28.946004+10,1,1,334,correct
3696,"select l.id,DIRECTOR_AWARD.award_name,DIRECTOR_AWARD.year_of_award,DIRECTOR_AWARD.category 
from (select d.id,da.title,da.production_year from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = d.title and d.production_year = da.production_year
and lower(result) !='won') as l,DIRECTOR_AWARD
where l.id not in (select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year
and lower(result) ='won')
and l.title = DIRECTOR_AWARD.title
and l.production_year = DIRECTOR_AWARD.production_year;
",2018-08-28 08:25:06.569006+10,13,0,167,partially correct
3697,"select id,award_name,year_of_award,category 
from DIRECTOR,DIRECTOR_AWARD
where DIRECTOR.id in
(select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year
and lower(result) ='nominated')
and DIRECTOR.id not in
(select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year
and lower(result) ='won')
and DIRECTOR.title = DIRECTOR_AWARD.title
and DIRECTOR.production_year = DIRECTOR_AWARD.production_year;",2018-08-28 08:37:00.708251+10,13,1,167,correct
3698,select count(*) from movie;,2018-08-28 08:39:43.854694+10,2,0,334,partially correct
3699,"select p.first_name,p.last_name, r.title, r.production_year,r.description 
from PERSON as p, ROLE as r
where p.id in
(select a.id from ROLE as a
group by a.id 
order by count(*) DESC
limit 1)
and p.id = r.id;",2018-08-28 08:46:32.544191+10,15,1,167,correct
3702,"select count(*) 
from writer 
where exists(select * from person where person.id = writer.id and person.year_born = 1935);",2018-08-28 09:35:05.649414+10,1,0,357,partially correct
3703,"select count(*) 
from person 
where exists(select * from person where person.id = writer.id and person.year_born = 1935);",2018-08-28 09:35:33.548786+10,1,0,357,noninterpretable
3704,"select count(*) 
from * person 
where exists(select * from person where person.id = writer.id and person.year_born = 1935);",2018-08-28 09:35:42.438648+10,1,0,357,noninterpretable
3705,"select count(*) 
from person 
where exists(select * from writer where person.id = writer.id and person.year_born = 1935);",2018-08-28 09:36:11.482927+10,1,1,357,correct
3706,"Select title, production_year From Writer As w Where Exists(Select * From person As p Where p.id = w.id And p.first_name = 'Kevin' And p.last_name = 'Williamson');
",2018-08-28 09:40:23.157147+10,5,1,247,correct
3707,"select distinct id, first_name, last_name
from person p natural join director d natural join writer w
where exists ( select * from director
group by director.id
having count(*) >1);",2018-08-28 09:41:45.662389+10,4,0,250,partially correct
3708,"select count(*)
from
writer
natural join
person p
group by p.id
having
p.year_born = '1935';",2018-08-28 09:42:38.900879+10,1,0,271,partially correct
3709,"select count(*) 
from 
writer w
inner join
person p
on w.id = p.id
where p.year_born = '1935';
",2018-08-28 09:44:38.449848+10,1,0,271,partially correct
3710,"SELECT w.title, w.production_year
FROM writer w
WHERE (SELECT * FROM person p
		WHERE p.id =w.id
		AND lower(first_name) = 'kevin' 
		AND lower(last_name) = 'williamson');",2018-08-28 09:44:54.10217+10,5,0,120,noninterpretable
3711,"select count(m.id)
from
(select distinct p.id
from
person p
natural join
writer w
where p.year_born = '1935') m
group by m.id;",2018-08-28 09:54:33.394492+10,1,1,271,correct
3712,"select m.production_year, count(*)
from
movie m
group by m.production_year
having
m.production_year >= '1991'
and
m.production_year <= '1993';",2018-08-28 09:56:04.105935+10,2,1,271,correct
3713,"SELECT p.id, p.first_name, p.last_name
FROM person p, (select id, max (year_born) as y 
	FROM person ) AS a
	where a.id=p.id;",2018-08-28 09:57:11.301147+10,7,1,120,correct
3714,"select count(*)
from
person p
where 
p.id not in
(select distinct p.id
from
person p
natural join
director d);",2018-08-28 09:57:42.983168+10,12,1,271,correct
3715,"select p.id, p.first_name, p.last_name
from
person p
natural join
director d
natural join
writer w
group by p.id
having
count(p.id) >= 2;",2018-08-28 10:00:27.237743+10,4,1,271,correct
3716,"SELECT production_year, COUNT(*) AS NoOfMovies
FROM MOVIE m
WHERE m.production_year = '1993' 
OR m.production_year = '1992'
OR m.production_year = '1991' 
GROUP BY m.production_year;",2018-08-28 10:00:36.393218+10,2,1,191,correct
3717,"select m.title, m.production_year
from
movie m
natural join
writer w
natural join
person p
where
lower(p.first_name) = 'kevin'
and
lower(p.last_name) = 'williamson';",2018-08-28 10:02:23.795871+10,5,1,271,correct
3718,"SELECT count (distinct(p.id))

FROM 
(	SELECT id
	FROM writer_award
	WHERE year_of_award >1990 AND year_of_award < 1996) AS wa
	,person p
WHERE
	p.id = wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen';
",2018-08-28 10:02:53.254841+10,9,1,120,correct
3719,"select r.country
from
Restriction r
where
r.title = 'Shakespeare in Love'
and
r.description = 'M';",2018-08-28 10:04:11.178542+10,6,1,271,correct
3720,"select p.id, max(p.year_born)
from
person p
;",2018-08-28 10:07:21.670296+10,7,0,271,partially correct
3721,"select p1.id,p1.first_name,p1.last_name
from
(select p.id,p.first_name,p.last_name,max(p.year_born)
from
person p) as p1
;",2018-08-28 10:08:09.181014+10,7,1,271,correct
3722,"WITH losers AS (SELECT DISTINCT title,production_year FROM movie
WHERE (title,production_year) NOT IN (

SELECT title,production_year FROM movie_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM crew_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM director_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM writer_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM actor_award
WHERE lower(result) = 'won'

))

SELECT COUNT(*) FROM losers

;

",2018-08-28 10:09:51.742042+10,11,1,25,correct
3723,Select country From Restriction_Category As r Where Exists(Select title From Movie As m Where m.title = 'Shakespeare in Love' And r.description = 'M');,2018-08-28 10:10:54.078547+10,6,0,247,partially correct
3724,"select p.first_name, p.last_name
from
person p
natural join
director d
natural join
movie_award m
where
m.award_name = 'BAFTA Film Award'
and
lower(m.category) = 'best film';",2018-08-28 10:11:43.299291+10,8,0,271,partially correct
3725,"select m.title, m.production_year, p.first_name, p.last_name
from
person p
natural join
director d
natural join
movie_award m
where
m.award_name = 'BAFTA Film Award'
and
lower(m.category) = 'best film';",2018-08-28 10:12:34.196294+10,8,0,271,partially correct
3726,"select m.title, m.production_year, p.first_name, p.last_name
from
person p
natural join
director d
natural join
movie_award m
where
m.award_name = 'BAFTA Film Award'
and
lower(m.category) = 'best film'
and
lower(result) = 'won';",2018-08-28 10:13:57.962824+10,8,1,271,correct
3727,"WITH id_scene AS (SELECT id,scene_no FROM appearance INNER JOIN role
USING(title,production_year,description)),


counting AS (SELECT id, COUNT(id) tot FROM id_scene
GROUP BY id)

SELECT id FROM counting 
WHERE tot =1 ;",2018-08-28 10:16:16.821467+10,10,0,25,partially correct
3728,"select count(*)
from
(select w.title
from
writer_award w
natural join
person p
where
p.first_name = 'Woody'
and
p.last_name = 'Allen'
and
w.year_of_award >= '1991'
and
w.year_of_award <= '1995'
and
lower(result) = 'won') ;",2018-08-28 10:17:00.87015+10,9,1,271,correct
3729,"WITH id_scene AS (SELECT DISTINCT id,scene_no,production_year FROM appearance INNER JOIN role
USING(title,production_year,description)
WHERE lower(title) = 'psycho'),


counting AS (SELECT id, COUNT(id) tot FROM id_scene
GROUP BY id)

SELECT id FROM counting 
WHERE tot =1 ;",2018-08-28 10:17:48.993765+10,10,0,25,partially correct
3730,"WITH id_scene AS (SELECT DISTINCT id,scene_no FROM appearance INNER JOIN role
USING(title,production_year,description)
WHERE lower(title) = 'psycho'
AND production_year = 1960),


counting AS (SELECT id, COUNT(id) tot FROM id_scene
GROUP BY id)

SELECT id FROM counting 
WHERE tot =1 ;",2018-08-28 10:18:48.439766+10,10,1,25,correct
3731,SELECT count(*) FROM person p inner join (select distinct id from writer) as w on w.id = p.id where p.year_born = 1935;,2018-08-28 10:20:30.281604+10,1,1,229,correct
3732,"SELECT COUNT(*) FROM writer_award
WHERE LOWER(result) = 'won'
AND year_of_award >= 1991 AND  year_of_award <= 1995;",2018-08-28 10:20:55.088746+10,9,0,25,partially correct
3733,"SELECT COUNT(*) FROM writer_award NATURAL JOIN writer NATURAL JOIN person
WHERE LOWER(result) = 'won'
AND year_of_award >= 1991 AND  year_of_award <= 1995
AND lower(first_name) = 'woody' AND lower(last_name) = 'allen' ;",2018-08-28 10:23:06.415024+10,9,1,25,correct
3734,"Select * From Person Where year_born = (Select MAX(year_born) From Person);
",2018-08-28 10:23:15.690163+10,7,0,247,partially correct
3735,"select r1.id
from
(
select r.id
from
Appearance ap
natural join
movie m
natural join
role r
where
m.production_year = '1960'
and
m.title = 'Psycho') as r1
group by r1.id
having
count(r1.id) = 1
;",2018-08-28 10:23:30.964058+10,10,1,271,correct
3736,"Select id, first_name, last_name From Person Where year_born = (Select MAX(year_born) From Person);
",2018-08-28 10:24:35.02644+10,7,1,247,correct
3737,"SELECT title,production_year,first_name,last_name FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(result) = 'won'
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film'
;",2018-08-28 10:27:21.501498+10,8,1,25,correct
3738,"WITH oldest_remove AS (SELEcT year_born FROM person 
WHERE year_born != (SELECT MAX(year_born) FROM person))

SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM oldest_remove);",2018-08-28 10:30:03.982816+10,7,0,25,partially correct
3772,"SELECT count(*)
FROM
(SELECT p.id
FROM person p

EXCEPT

SELECT DISTINCT d.id
FROM director d);",2018-08-28 11:24:20.380064+10,12,1,27,correct
4532,"SELECT COUNT*
FROM WRITER
WHERE production_year = 1935;",2018-08-28 22:44:03.270284+10,1,0,370,noninterpretable
3739,"select count(m.title)
from
movie m
where
m.title not in (select ma.title from movie_award ma where ma.production_year = m.production_year)
and
m.title not in (select ca.title from crew_award ca where ca.production_year = m.production_year)
and
m.title not in (select da.title from director_award da where da.production_year = m.production_year)
and
m.title not in (select wa.title from writer_award wa where wa.production_year = m.production_year)
and
m.title not in (select aa.title from actor_award aa where aa.production_year = m.production_year)

;",2018-08-28 10:31:00.119862+10,11,0,271,partially correct
3740,"SELEcT id,first_name,last_name FROM person 
WHERE year_born = (SELECT MAX(year_born) FROM person);

",2018-08-28 10:31:40.373182+10,7,1,25,correct
3741,"select count(m.title)
from
movie m
where
m.title not in (select ma.title from movie_award ma where ma.production_year = m.production_year and lower(ma.result) = 'won') 
and
m.title not in (select ca.title from crew_award ca where ca.production_year = m.production_year and lower(ca.result) = 'won')
and
m.title not in (select da.title from director_award da where da.production_year = m.production_year and lower(da.result) = 'won')
and
m.title not in (select wa.title from writer_award wa where wa.production_year = m.production_year and lower(wa.result) = 'won')
and
m.title not in (select aa.title from actor_award aa where aa.production_year = m.production_year and lower(aa.result) = 'won')

;",2018-08-28 10:33:29.310552+10,11,1,271,correct
3742,"select production_year, count(*) from movie m where production_year >1990 and production_year < 1994 group by production_year;",2018-08-28 10:34:03.38581+10,2,1,229,correct
3743,"SELECT country FROM restriction
WHERE lower(description) = 'm'
AND lower(title) = 'shakespeare in love';",2018-08-28 10:35:11.6514+10,6,1,25,correct
3744,"SELECT title,production_year FROM writer NATURAL JOIN person
WHERE LOWER(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-28 10:36:32.054834+10,5,1,25,correct
3745,select count(*) from person where id not in (select id from director);,2018-08-28 10:37:40.593117+10,12,1,229,correct
3746,"select p1.id
from
(select p.id, max(p.year_born)
from
person p
where
p.year_born <=
(select max(p.year_born)
from
person p)
) as p1
;",2018-08-28 10:39:47.313503+10,3,0,271,partially correct
3747,"select p1.id
from
(select p.id, max(p.year_born)
from
person p
where
p.year_born <
(select max(p.year_born)
from
person p)
) as p1
;",2018-08-28 10:39:59.500143+10,3,1,271,correct
3748,"select id,first_name,last_name, max(year_born) from person;",2018-08-28 10:41:14.481749+10,7,0,341,partially correct
3749,"WITH d_w AS (SELECT id,first_name,last_name FROM person NATURAL JOIN writer NATURAL JOIN directoR
ORDER BY id ASC),

 id_count AS (SELECT id,COUNT(id) tot FROM d_w
GROUP BY id)

SELECT DISTINCT id,first_name,last_name FROM d_w
WHERE id IN (SELECT id FROM id_count
			WHERE tot >= 2);",2018-08-28 10:42:17.549204+10,4,1,25,correct
3750,"SELECT id FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-28 10:42:57.783233+10,12,0,25,partially correct
3751,"SELECT DISTINCT id FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-28 10:43:13.626024+10,12,0,25,partially correct
3752,"select id,first_name,last_name from person where year_born = (select max(year_born) from person);",2018-08-28 10:43:22.076415+10,7,1,341,correct
3753,"SELECT COUNT(id) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-28 10:43:26.201429+10,12,1,25,correct
3754,"SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year;",2018-08-28 10:44:40.336129+10,2,0,25,partially correct
3755,"SELECT production_year, COUNT(production_year) FROM movie
GROUP BY production_year;",2018-08-28 10:44:48.816275+10,2,0,25,partially correct
3756,"SELECT production_year, COUNT(production_year) FROM movie
WHERE production_year >= 1991 AND production_year <= 1993
GROUP BY production_year;",2018-08-28 10:45:42.922241+10,2,1,25,correct
3757,"WITH writer_born AS (SELECT DISTINCT id, year_born FROM writer NATURAL JOIN person
WHERE year_born = 1935
ORDER BY id ASC),

id_count AS (SELECT id, COUNT(id) tot FROM writer_born
GROUP BY id)

SELECT tot FROM id_count;",2018-08-28 10:49:50.569725+10,1,1,25,correct
3758,"select id, award_name, year_of_award, category
from
director
natural join
director_award
where
lower(result) = 'nominated'
and
id not in 
(select id
from
director
natural join
director_award
where
lower(result) = 'won');",2018-08-28 10:50:21.266572+10,13,1,271,correct
3759,"select  count(Distinct Person.first_name) from Person,Director where Director.id!=Person.id;",2018-08-28 10:52:38.576702+10,12,0,101,partially correct
3760,"select kk1.id
from
(
select kk.id, max(kk.mc)
from
(select w.id, count(w.id) mc
from
writer w
natural join
director d
group by w.id) as kk
) as kk1;
",2018-08-28 10:57:04.979702+10,14,0,271,partially correct
3761,"
select a.id, a.first_name , a.last_name from (person natural join director natural join writer ) as a  group by a.id having count(*) >1;",2018-08-28 11:06:12.296879+10,4,1,229,correct
3762,"select kk1.id
from
(select id, count(id) mm
from 
(
select d.id, d.title, d.production_year from director d
union
select w.id, w.title, w.production_year from writer w
)group by id) kk1
where kk1.mm in
(select max(kk1.mm)
from
(select id, count(id) mm
from 
(
select d.id, d.title, d.production_year from director d
union
select w.id, w.title, w.production_year from writer w
)group by id) kk1
)
;",2018-08-28 11:07:09.445618+10,14,1,271,correct
3763,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma
where exists(select d.id from director d 
where exists(select p.first_name,p.last_name from person p where
lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award'
and ma.title=d.title
and ma.production_year=d.production_year
and d.id=p.id
));
",2018-08-28 11:08:48.905757+10,8,0,341,noninterpretable
3764,"WITH writer1935 AS 
(SELECT DISTINCT w.id
FROM writer w NATURAL JOIN person p
WHERE p.year_born = 1935)

SELECT count(*)
FROM writer1935;",2018-08-28 11:11:23.494188+10,1,1,27,correct
3765,"select kk.first_name, kk.last_name, kk.title, kk.production_year, kk.description
from 
(select count(id) as mm, first_name, last_name, title, production_year, description
from
person
natural join
role
group by id) as kk
where
kk.mm = 
(select max(kk.mm)
from
(select count(id) as mm, first_name, last_name, title, production_year, description
from
person
natural join
role
group by id) as kk);",2018-08-28 11:12:02.271124+10,15,0,271,partially correct
3766,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma, person p
where exists(select d.id from director d 
where
lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award'
and ma.title=d.title
and ma.production_year=d.production_year
and d.id=p.id
);
",2018-08-28 11:14:27.024127+10,8,0,341,partially correct
3767,"select first_name, last_name, title, production_year, description
from
person
natural join
role
where 
id in (
select id
from 
(select id, count(id) as mm, first_name, last_name, title, production_year, description
from
person
natural join
role
group by id) as kk
where
kk.mm = 
(select max(kk.mm)
from
(select count(id) as mm, first_name, last_name, title, production_year, description
from
person
natural join
role
group by id) as kk)
);",2018-08-28 11:16:15.405864+10,15,1,271,correct
3768,"select first_name, last_name, title, production_year, description
from
person
natural join
role
where
id in 
(
select id from
(select id, max(kk.mm)
from
(select count(id) as mm,id
from
person
natural join
role
group by id) as kk))
;",2018-08-28 11:18:50.784767+10,15,1,271,correct
3769,"SELECT production_year, count(*)
FROM movie m
WHERE production_year IN (1993, 1992, 1991)
GROUP BY production_year;",2018-08-28 11:19:09.211224+10,2,1,27,correct
3770,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma, person p
where exists(select d.id from director d 
where
lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award'
and lower(ma.result)='won'
and ma.title=d.title
and ma.production_year=d.production_year
and d.id=p.id
);
",2018-08-28 11:21:22.665678+10,8,1,341,correct
3771,"select title,production_year from person p inner join writer w on p.id = w.id where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-28 11:23:34.474976+10,5,1,229,correct
3773,"select count(*) from writer_award wa where exists( 
select p.first_name,p.last_name,p.id from person p where
wa.id=p.id
and lower(wa.result)='won'
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award = 1991
or wa.year_of_award = 1992
or wa.year_of_award = 1993
or wa.year_of_award = 1994
or wa.year_of_award = 1995);",2018-08-28 11:29:26.49613+10,9,0,341,partially correct
3774,"WITH wd AS 
(SELECT w.id
FROM writer w, director d
WHERE w.id = d.id AND w.title = d.title AND w.production_year = d.production_year)

SELECT DISTINCT p.id, p.first_name, p.last_name
FROM wd NATURAL JOIN person p;",2018-08-28 11:33:32.991807+10,4,0,27,partially correct
3775,"select count(*) as number_of_award from writer_award wa,person p,writer w where 
wa.id=p.id
and wa.id=w.id
and wa.title=w.title
and wa.production_year=w.production_year
and lower(wa.result)='won'
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and year_of_award>=1991
and year_of_award<=1995
;",2018-08-28 11:34:16.964838+10,9,1,341,correct
3776,"select ma.title, ma.production_year, p.first_name, p.last_name 
from (select title,production_year from movie_award where lower(award_name) = ""bafta film award"" and category = 'best film' and lower(result) = 'won') as ma, director d, person p
where d.id = p.id and ma.title = d.title;",2018-08-28 11:36:21.333597+10,8,1,229,correct
3777,"WITH wd AS 
(SELECT w.id, count(*) as count
FROM writer w, director d
WHERE w.id = d.id AND w.title = d.title AND w.production_year = d.production_year
GROUP BY w.id)

SELECT p.id, p.first_name, p.last_name
FROM wd NATURAL JOIN person p
WHERE count > 1;",2018-08-28 11:37:21.718758+10,4,1,27,correct
3778,"SELECT w.id from writer w
where exists (select p.id from person p where w.id=p.id and year_born = 1935);",2018-08-28 11:38:44.111574+10,1,0,274,partially correct
3779,"select Person.id, Person.first_name ,Person.last_name ,count(*) from Person ,Director,Writer where Person.id=Director.id and Director.id=Writer.id Group by Person.first_name having count(*)>2;",2018-08-28 11:38:51.447122+10,4,0,101,partially correct
3780,"select m.title, m.production_year
from movie m, person p, writer w
where m.title = w.title
and m.production_year = w.production_year
and p.id = w.id
and p.first_name = 'Kevin'
and p.last_name = 'Williamson';",2018-08-28 11:40:29.278989+10,5,1,250,correct
3781,"SELECT count(*) from person p
where exists (select w.id from writer w where w.id=p.id and year_born = 1935);",2018-08-28 11:41:20.503963+10,1,1,274,correct
3782,"SELECT m.title, m.production_year
FROM writer w INNER JOIN person p
	ON w.id = p.id INNER JOIN movie m
	ON m.title = w.title AND m.production_year = w.production_year
WHERE lower(p.first_name) = 'kevin' AND lower(p.last_name) = 'williamson';",2018-08-28 11:42:33.250507+10,5,1,27,correct
3783,"select count(*) 
from (select id from person where lower(first_name) = 'woody' and lower(last_name) = 'allen')as p , 
(select * from writer_award where  production_year >1990 and production_year<1996) as wa
where wa.id = p.id;",2018-08-28 11:43:28.001491+10,9,1,229,correct
3784,"select movie.production_year, count(*) from movie where movie.production_year=1993 or movie.production_year=1992 or movie.production_year=1991 group by movie.production_year;",2018-08-28 11:43:44.430896+10,2,1,258,correct
3785,"select r.id from role r,scene s, movie m where
r.title=m.title
and r.production_year=m.production_year
and s.title=m.title
and s.production_year=m.production_year
group by s.scene_no having count(*)=1;",2018-08-28 11:44:57.023343+10,10,0,341,partially correct
3786,"select * 
from (select id from person where lower(first_name) = 'woody' and lower(last_name) = 'allen')as p , 
(select * from writer_award where lower(result) = 'won' and year_of_award >1990 and year_of_award<1996) as wa
where wa.id = p.id;
",2018-08-28 11:47:34.240751+10,9,0,229,partially correct
3787,"select count(*)
from (select id from person where lower(first_name) = 'woody' and lower(last_name) = 'allen')as p , 
(select * from writer_award where lower(result) = 'won' and year_of_award >1990 and year_of_award<1996) as wa
where wa.id = p.id;
",2018-08-28 11:47:50.823096+10,9,1,229,correct
3788,"SELECT r.country
FROM restriction r, movie m
WHERE r.title = m.title
	AND r.production_year = m.production_year
	AND lower(m.title) = 'shakespeare in love'
	AND lower(r.description) = 'm'
GROUP BY r.country;",2018-08-28 11:48:32.787702+10,6,1,27,correct
3789,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person);",2018-08-28 11:50:36.068839+10,7,1,27,correct
3790,"select count(person.id) 
from person, writer
where person.id = writer.id
group by person.id
having person.year_born = '1935';",2018-08-28 11:51:09.947315+10,1,0,111,partially correct
3791,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXIST (SELECT * 
                   FROM DIRECTOR d 
				   WHERE p.ID = d.ID);",2018-08-28 11:53:45.010298+10,12,0,191,noninterpretable
3792,select * from writer where id=00000841;,2018-08-28 11:54:54.267721+10,1,0,101,partially correct
3793,"SELECT production_year, COUNT(*) FROM movie
WHERE production_year in (1991, 1992, 1993)
group by production_year;",2018-08-28 11:57:37.422626+10,2,1,274,correct
3794,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE lower(ma.award_name) = 'bafta film award' 
	AND lower(ma.category) = 'best film';",2018-08-28 11:57:44.515888+10,8,0,27,partially correct
3795,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma NATURAL JOIN director d NATURAL JOIN person p
WHERE lower(ma.award_name) = 'bafta film award' 
	AND lower(ma.category) = 'best film'
	AND lower(ma.result) = 'won';",2018-08-28 12:02:06.055316+10,8,1,27,correct
3796,"SELECT;
",2018-08-28 12:02:35.622204+10,11,0,311,noninterpretable
3797,"
SELECT COUNT(*)
FROM writer_award wa NATURAL JOIN person p
WHERE lower(p.first_name) = 'woody' 
	AND lower(p.last_name) = 'allen'
	AND lower(wa.result) = 'won'
	AND wa.year_of_award >= 1991
	AND wa.year_of_award <= 1995;
",2018-08-28 12:08:46.288369+10,9,1,27,correct
3798,"SELECT COUNT(*) FROM person p
WHERE NOT EXISTS (SELECT d.id from director d where p.id = d.id);",2018-08-28 12:11:12.956735+10,12,1,274,correct
3799,;,2018-08-28 12:19:54.971374+10,15,0,21,noninterpretable
3800,"SELECT r.id
FROM role r INNER JOIN appearance a
	ON r.title = a.title AND r.production_year = a.production_year AND r.description = a.description
WHERE lower(r.title) = 'psycho'
	AND r.production_year = 1960
GROUP BY r.id
HAVING count(*) = 1;",2018-08-28 12:24:29.953582+10,10,1,27,correct
3801,"select count(*)
from person 
where exists( select * from writer 
where writer.id=person.id) and person.year_born=1935;",2018-08-28 12:24:56.082211+10,1,1,158,correct
3802,"select d.title, d.production_year, first_name, last_name
from movie_award ma, person p, director d
where ma.title = d.title
and ma.prodution_year = d.production_year
and d.id = p.id
and lower(award_name) = 'bafta film award'
and lower (category) = 'best film';
",2018-08-28 12:25:14.819065+10,8,0,250,noninterpretable
3803,Select COUNT(PERSON.id) from PERSON join WRITER on PERSON.id = WRITER.id where year_born = 1935 ;,2018-08-28 12:29:28.190068+10,1,0,305,partially correct
3804,"select count(*)
from movie
where production_year>1990 & production_year<1994;",2018-08-28 12:31:18.344023+10,2,0,158,partially correct
3805,"select production_year,count(*)
from movie
where production_year>1990 & production_year<1994
group by production_tear;",2018-08-28 12:33:18.28555+10,2,0,158,noninterpretable
3806,Select count(DISTINCT PERSON.id) from PERSON join WRITER on PERSON.id = WRITER.id where person.year_born = 1935;,2018-08-28 12:33:29.20572+10,1,1,305,correct
3807,"select production_year,count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-28 12:34:37.776722+10,2,1,158,correct
3808,"SELECT production_year,COUNT(production_year)
From movie
Group by production_year
Having production_year between 1991 and 1993;",2018-08-28 12:34:55.471475+10,2,1,351,correct
3809,"select p.id, first_name, last_name from person p
where exists (select w.id, count(*) from 
              writer w natural join director d 
              where w.id=p.id  group by w.id having count(*) >= 2);",2018-08-28 12:37:39.221931+10,4,1,274,correct
3810,"select count(*)
from person
where not exists(select * from director 
where director.id=person.id);",2018-08-28 12:37:54.740647+10,12,1,158,correct
3953,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);




",2018-08-28 15:06:45.291715+10,1,1,154,correct
3811,"select count(*)
from  movie mv,movie_award m,crew_award c,director_award d,writer_award w,actor_award a
where lower(m.result) != 'won' and
      lower(c.result) != 'won' and 
      lower(d.result) != 'won' and 
      lower(w.result) != 'won' and 
      lower(a.result) != 'won'

group by mv.title;


",2018-08-28 12:40:54.864015+10,11,0,209,partially correct
3812,"select distinct r.id from (select title, production_year, scene_no from appearance where  lower(title) = 'psycho' and production_year = 1960 
group by scene_no having count(scene_no) = 1)as a, (select id,title from role) as r where r.title = a.title;",2018-08-28 12:42:59.208415+10,10,0,229,partially correct
3813,"select distinct r.id from (select title, production_year, scene_no from appearance where  lower(title) = 'psycho' and production_year = 1960 )as a, 
(select id,title from role) as r where r.title = a.title;",2018-08-28 12:43:43.49509+10,10,0,229,partially correct
3814,"WITH writ AS (
    SELECT DISTINCT p.id AS id, p.last_name AS lname
    FROM person AS p, writer AS wout 
    WHERE p.year_born = 1935 AND p.id = wout.id
    GROUP BY p.id
)
SELECT COUNT(writ.id)
FROM writ
;
",2018-08-28 12:50:31.755023+10,1,1,353,correct
3815,"SELECT wa.award_name,count(*)
FROM (person NATURAL JOIN writer_award ) AS wa
WHERE wa.first_name = 'Woody' AND wa.last_name = 'Allen'
GROUP BY wa.award_name 
HAVING 1991<wa.year_of_award <1995;",2018-08-28 12:53:31.217186+10,9,0,49,partially correct
3816,"select r.id from (select title, production_year, scene_no,description from appearance where  lower(title) = 'psycho' and production_year = 1960 )as a, 
role r where r.title = a.title and r.production_year = a.production_year and r.description = a.description group by r.id having count(*) = 1;",2018-08-28 12:57:28.40379+10,10,1,229,correct
3817,"SELECT 
	COUNT(*) AS number_of_award 
FROM 
	writer_award wa,
	writer w,
	person p 
WHERE
	wa.title = w.title
	AND wa.id = w.id
	AND w.id = p.id
	AND lower(result) = 'won'
	AND lower (first_name) = 'woody'
	AND lower (last_name) = 'allen'
	AND 1991<=year_of_award<=1995;",2018-08-28 12:59:18.520165+10,9,0,49,noninterpretable
3818,"SELECT m.production_year, COUNT(m.title)
FROM movie m
WHERE m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993
GROUP BY m.production_year
;
",2018-08-28 13:00:06.36199+10,2,1,353,correct
3819,"Select m.title, m.production_year, p.last_name, p.first_name From Movie_Award m, Director d, Person p Where m.award_name ='BAFTA Film Award' And m.category = 'best_film' AND m.result = 'won' AND d.title = m.title And d.id = p.id;

",2018-08-28 13:00:28.644038+10,8,0,247,partially correct
3820,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-28 13:03:00.668708+10,8,1,247,correct
3821,"SELECT title, production_year FROM
person NATURAL JOIN writer NATURAL JOIN movie
WHERE lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-28 13:04:56.926909+10,5,1,274,correct
3822,"select count(per.id)
from person per
join writer wri on per.id=wri.id
where per.year_born='1935';",2018-08-28 13:05:02.774365+10,1,0,230,partially correct
3823,"SELECT title, production_year FROM
person NATURAL JOIN writer
WHERE lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-28 13:05:48.511709+10,5,1,274,correct
3824,"select count(*)
from movie m
where exists (

select title,production_year
             from movie_award ma
             where lower(ma.result) != ""won"" and ma.title = m.title and ma.production_year = m.production_year
union
select title,production_year
             from crew_award ca
             where lower(ca.result) != ""won"" and ca.title = m.title and ca.production_year = m.production_year
union
select title,production_year
             from director_award da
where lower(da.result) != ""won"" and da.title = m.title and da.production_year = m.production_year
 union
select title,production_year
             from writer_award wa
             where lower(wa.result) != ""won"" and wa.title = m.title and wa.production_year = m.production_year
 union
select title,production_year
             from actor_award aa
             where lower(aa.result) != ""won"" and aa.title = m.title and aa.production_year = m.production_year);

",2018-08-28 13:08:48.289291+10,11,0,209,partially correct
3825,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 13:09:13.725316+10,11,1,209,correct
3826,"
Select count(*) from (
select title,production_year from movie
EXCEPT

select title,production_year from ( select title,production_year from movie_award
union
select title,production_year from director_award
union
select title,production_year from actor_award
union
select title,production_year from crew_award
union
select title,production_year from writer_award )

as t) 
as t1



;",2018-08-28 13:09:20.452277+10,11,0,16,partially correct
3827,"SELECT 
	p.first_name, 
	p.last_name 
FROM 
	person p, 
	role r
WHERE 
	r.id = p.id
	AND lower (r.title) = 'pcycho'
	AND r.production_year = 1960 
	AND lower(r.description) = 'actors/actresses';
",2018-08-28 13:09:35.336209+10,10,0,49,partially correct
3828,"select count(*)
from person per
where exists(select * from writer w where w.id=per.id and per.year_born='1935');",2018-08-28 13:10:38.616888+10,1,1,230,correct
3829,"select country from restriction 
where lower(title) = 'shakespeare in love' 
AND lower(description) = 'm';",2018-08-28 13:12:48.921687+10,6,1,274,correct
3830,"SELECT scene_no
FROM scene NATURAL JOIN role AS sr
WHERE lower 'sr.production_year'='1960'
            AND lower 'sr.title'='psycho'
			AND 'sr.scene_no'=1
GROUP BY sr.id;",2018-08-28 13:12:58.925765+10,10,0,273,noninterpretable
3831,"Select Count(*) From Writer_Award w, Person p Where w.id = p.id And p.first_name = 'Woody' And p.last_name = 'Allen' And w.year_of_award > 1990 AND w.year_of_award < 1996;
",2018-08-28 13:14:24.116926+10,9,0,247,partially correct
3832,"Select Count(*) From Writer_Award w, Person p Where w.id = p.id And p.first_name = 'Woody' And p.last_name = 'Allen' And w.year_of_award > 1990 AND w.year_of_award < 1995;
",2018-08-28 13:14:59.999055+10,9,1,247,correct
3833,"
Select count(*) from (
select title,production_year from movie
EXCEPT

select title,production_year from ( select title,production_year from movie_award where lower(result)='won'
union
select title,production_year from director_award where lower(result)='won'
union
select title,production_year from actor_award where lower(result)='won'
union
select title,production_year from crew_award where lower(result)='won'
union
select title,production_year from writer_award where lower(result)='won' )

as t) 
as t1



;",2018-08-28 13:15:00.383715+10,11,1,16,correct
3834,"select year_born
from person
where year_born < (select max(year_born) from person);",2018-08-28 13:15:02.158887+10,3,0,209,partially correct
3877,"select p.id,p.first_name,p.last_name 
from person p
where exists ( select count(*) as num
from director d
where p.id=d.id
group by d.id
having num>=2)
group by p.id;",2018-08-28 13:54:14.253501+10,4,0,230,partially correct
3954,"select p.id,p.first_name,p.last_name from person p
where p.year_born=(select max(year_born) from person group by year_born);",2018-08-28 15:07:05.24926+10,7,0,363,partially correct
3835,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-28 13:15:22.265977+10,11,1,229,correct
3836,"select m.production_year,count(*) from movie m
where m.production_year =1993 or  m.production_year =1992 or  m.production_year =1991
group by m.production_year;
",2018-08-28 13:15:44.713405+10,2,1,230,correct
3837,"select id, first_name, last_name
from person, (select id, count(*) from director,writer where writer.id=director.id and writer.title=director.title group by id having dount(*)>1) as h
where h.id=person.id;",2018-08-28 13:15:55.539805+10,4,0,158,noninterpretable
3838,"SELECT p.id, p.first_name, p.last_name from person p
where p.year_born = (select max(year_born) from person);",2018-08-28 13:15:57.010117+10,7,1,274,correct
3839,"select id, first_name, last_name
from person natural join director natural join writer 
group by id
having count(*)>1;",2018-08-28 13:18:32.045106+10,4,1,158,correct
3840,"select id from person
    where year_born = ( select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-28 13:20:48.32078+10,3,1,209,correct
3841,"select id, max(year_born) from person where year_born < (select max(year_born) from person); ",2018-08-28 13:21:31.555157+10,3,0,66,partially correct
3842,select id from person where year_born < (select max(year_born) from person); ,2018-08-28 13:22:03.486005+10,3,0,66,partially correct
3843,SELECT COUNT(*) FROM person WHERE EXISTS (SELECT * FROM writer WHERE writer.id=person.id AND person.year_born=1935);,2018-08-28 13:23:38.514515+10,1,1,288,correct
3844,"select id from (select id, max(year_born) from person where year_born < (select max(year_born) from person)); ",2018-08-28 13:23:50.87996+10,3,1,66,correct
3845,select id from person  where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));,2018-08-28 13:24:05.534807+10,3,1,229,correct
3846,"select p.year_born as bornIn, count(*) as number
from writer w, person p
where w.id=p.id and p.year_born=1935
group by p.year_born;",2018-08-28 13:24:18.912288+10,1,0,128,partially correct
3847,select count(*) from person where not exists (select * from director d where person.id=d.id);,2018-08-28 13:25:11.226083+10,12,1,258,correct
3848,"select count(*) from person p
where not exists(select * from director d where d.id = p.id );",2018-08-28 13:28:14.941264+10,12,1,230,correct
3849,"select count(*)
from movie
where not exists(movie natural join movie_award natural join crew_award natural join director_award natural join writer_award
natural join actor_award);",2018-08-28 13:28:22.001131+10,11,0,250,noninterpretable
3850,"SELECT COUNT(p.id)
FROM person AS p
WHERE p.id NOT IN(
        SELECT d.id
        FROM director AS d
    )
;
",2018-08-28 13:29:47.840934+10,12,1,353,correct
3851,";
",2018-08-28 13:30:41.456656+10,10,0,247,noninterpretable
3852,"select id,award_name,year_of_award,category from director d,director_award da
where exists (select title,production_year from Director_Award where lower(result) ='nominated');",2018-08-28 13:33:01.669429+10,13,0,209,partially correct
3853,"SELECT count(id)
FROM writer, person
WHERE year born = 1935;",2018-08-28 13:33:41.134914+10,1,0,246,noninterpretable
3854,"SELECT 
	r.id
FROM 
	appearance a,
	scene s,
	role r
WHERE
	s.title = a.title
	AND s.production_year = a.production_year
	AND s.scene_no = a.scene_no
	AND s.title = r.title
	AND s.production_year = r.production_year
	AND a.description = r.description
	AND lower(a.title) = 'psycho'
	AND a.production_year = 1960
GROUP BY id
HAVING count(*) = 1;",2018-08-28 13:33:41.723254+10,10,1,49,correct
3855,"SELECT COUNT(*)
FROM PERSON
WHERE PERSON.id=WRITER.id
GROUP BY id HAVING PERSON.year_born=1935;",2018-08-28 13:33:59.200995+10,1,0,361,noninterpretable
3856,"select
	d.id, da.award_name, da.year_of_award, da.category
from 
	director d, director_award da
	where
		da.title = d.title and
		da.production_year = d.production_year and
		da.result = 'nominated'
;",2018-08-28 13:35:32.769741+10,13,1,66,correct
3857,"select award_name, year_of_award, category, d.id from director_award da, director d  where  lower(result) = 'nominated' and d.title =da.title ;",2018-08-28 13:36:28.426238+10,13,1,229,correct
3858,;,2018-08-28 13:36:30.56808+10,1,0,362,noninterpretable
3859,"select d.id, award_name, year_of_award, category  from director_award da, director d  where  lower(result) = 'nominated' and d.title =da.title ;",2018-08-28 13:36:57.192042+10,13,1,229,correct
3860,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-28 13:37:07.179847+10,10,1,247,correct
3861,SELECT COUNT(*) FROM person p WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);,2018-08-28 13:39:18.907079+10,1,1,362,correct
3862,"SELECT title
FROM 
	movie m,
	movie_award ma,
	crew_award ca,
	director_award da,
	writer_award wa,
	actor_award aa
WHERE 
	m.title NOT IN ma.title
	AND m.title NOT IN ca.title
	AND m.title NOT IN da.title
	AND m.title NOT IN wa.title
	AND m.title NOT IN aa.title
GROUP BY title
HAVING COUNT(*);",2018-08-28 13:43:57.745162+10,11,0,49,noninterpretable
3863,"COUNT(*) as numerOfMovies (SELECT * FROM movie.m WHERE production_year = 1993, 1992, 1991)
GROUP BY production_years;",2018-08-28 13:44:36.343924+10,2,0,362,noninterpretable
3864,"SELECT production_year, count(*) FROM movie.m WHERE production_year = 1993, 1992, 1991
GROUP BY production_years;",2018-08-28 13:47:19.540774+10,2,0,362,noninterpretable
3865,"SELECT m.production_year as year, COUNT(*) 
FROM movie m
WHERE m.production_year=1993 OR m.production_year=1992 OR m.production_year=1991
GROUP BY m.production_year;",2018-08-28 13:48:29.70908+10,2,1,128,correct
3866,"select country
from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-28 13:49:01.935885+10,6,1,158,correct
3867,"select w.title,w.production_year from writer w
where exists(select * from person p where p.id = w.id and p.first_name='Kevin' and p.last_name='Williamson');",2018-08-28 13:49:07.113382+10,5,1,230,correct
3868,"SELECT count(*) 
FROM person  
WHERE person.year_born = 1935 and EXISTS (SELECT * FROM writer w WHERE person.id = w.id );",2018-08-28 13:50:21.786969+10,1,1,234,correct
3869,"SELECT production_year, count(*) FROM movie WHERE production_year > 1990 AND production_year <1994
GROUP BY production_year;",2018-08-28 13:51:12.632378+10,2,1,362,correct
3870,;,2018-08-28 13:52:09.344226+10,12,0,362,noninterpretable
3871,"select p.id,p.first_name,p.last_name 
from person p
where exists ( select count(*) as num
from director d
where p.id=d.id
group by d.id
having num>=2);",2018-08-28 13:52:30.811415+10,4,0,230,partially correct
3872,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id=d.id);",2018-08-28 13:52:39.309787+10,12,1,128,correct
3873,"select h.id,h.first_name,h.last_name
from person,(select id,first_name,last_name,max(year_born) as youngest from person) as h
where h.id=person.id;",2018-08-28 13:52:57.455995+10,7,1,158,correct
3874,"select m.production_year,count(*) from movie m
where m.production_year in (1991,1992,1993)
group by m.production_year;",2018-08-28 13:53:28.775593+10,2,1,203,correct
3875,"SELECT count(*)
FROM person p
WHERE exists (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 13:53:32.525598+10,1,1,246,correct
3876,SELECT COUNT (*) FRON person p WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);,2018-08-28 13:53:59.759227+10,12,0,362,noninterpretable
3878,"SELECT COUNT (*) 
FROM person p
WHERE NOT EXISTS
(SELECT * FROM director d WHERE d.id = p.id);",2018-08-28 13:54:48.117813+10,12,1,362,correct
3879,"select p.id,p.first_name,p.last_name 
from person p
where exists ( select count(*) as num
from writer d
where p.id=d.id
group by d.id
having num>=2)
group by p.id;",2018-08-28 13:55:08.014006+10,4,0,230,partially correct
3880,"select id
from person p
where year_born = (select max(year_born) from person);",2018-08-28 13:56:57.568803+10,3,0,250,partially correct
3881,"SELECT m.title, m.production_year, p.first_name, p.last_name from person p natural join director m natural join movie_award md
where lower(md.award_name) = 'bafta film award' and lower(md.category)='best film';

",2018-08-28 13:57:14.082052+10,8,0,274,partially correct
3882,"SELECT m.title, m.production_year, p.first_name, p.last_name from person p natural join director m natural join movie_award md
where lower(md.award_name) = 'bafta film award' and lower(md.category)='best film'and lower(md.result)='won';

",2018-08-28 13:58:05.491876+10,8,1,274,correct
3883,"select id,award_name,year_of_award,category 

from director d,director_award da

where d.title = da.title and d.production_year = da.production_year
and d.id not exists (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );

",2018-08-28 13:58:46.16486+10,13,0,209,noninterpretable
3884,"SELECT p.id, last_name, first_name FROM person p 
WHERE EXISTS (SELECT COUNT(*) FROM writer w, movie m WHERE w.title = m.title >1);",2018-08-28 14:00:22.111379+10,4,0,362,partially correct
3885,"select count(*) from writer,person
where writer.id=person.id
and person.year_born=1935;",2018-08-28 14:01:34.741715+10,1,0,363,partially correct
3886,"
GROUP BY m.production_year;",2018-08-28 14:02:15.490346+10,2,0,246,noninterpretable
3887, select id from writer as w where(select max(year_of_award) from writer_award as wa where w.id=wa.id)>1;,2018-08-28 14:02:21.917596+10,1,0,104,partially correct
3888,"select first_name, last_name, d.title, d.production_year
from person as p, director as d, movie_award as m
where p.id=d.id
and d.title=m.title
and m.production_year=d.production_year
and lower(category)='best film'
and lower(result)='won'
and lower(award_name)='bafta film award';",2018-08-28 14:02:53.173808+10,8,1,158,correct
3889,"select production_year,count(*) from movie where production_year=1993 or production_year=1992  or production_year=1991
group by production_year;",2018-08-28 14:04:13.570756+10,2,1,234,correct
3890,"select count(*) from person p
where id not in (select id from director d);",2018-08-28 14:04:17.514225+10,12,1,203,correct
3891,"select d.title, d.production_year,first_name, last_name
from person as p, director as d, movie_award as m
where p.id=d.id
and d.title=m.title
and m.production_year=d.production_year
and lower(category)='best film'
and lower(result)='won'
and lower(award_name)='bafta film award';",2018-08-28 14:04:38.788502+10,8,1,158,correct
3892,"select title,production_year,country from movie where country='Australia';",2018-08-28 14:05:15.533682+10,1,0,104,partially correct
3893,"select title,production_year,country from movie where country='Australia';",2018-08-28 14:05:30.779691+10,1,0,104,partially correct
3894,"select title,production_year from movie where country='Australia';",2018-08-28 14:06:12.525908+10,1,0,104,partially correct
3895,"SELECT dw.id, dw.last_name, dw.first_name FROM (person p NATURAL JOIN writer w NATURAL JOIN director d)AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;
",2018-08-28 14:07:00.273785+10,4,1,362,correct
3896,"SELECT dw.id, dw.first_name, dw.last_name FROM (person p NATURAL JOIN writer w NATURAL JOIN director d)AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;
",2018-08-28 14:07:50.394826+10,4,1,362,correct
3897,"select count(*)
from movie m
where m.production_year='1992','1993','1994';",2018-08-28 14:07:53.19755+10,2,0,361,noninterpretable
3898,"select count(*)
from ( select w.id from writer_award as w, person as p 
where w.id=p.id 
and lower (p.first_name)='woody'
and lower (p.last_name)='allen'
and year_of_award>1991
and year_of_award<1996);",2018-08-28 14:15:19.135231+10,9,1,158,correct
3899,;,2018-08-28 14:15:25.443249+10,14,0,229,noninterpretable
3900,"SELECT m.title, m.production_year FROM movie m WHERE m.title = w.title
WHERE EXISTS
(SELECT p.id FROM person p WHERE first_name = Kevin AND last_name = Williamson
WHERE EXISTS  w.id = p.id IN writer w);
",2018-08-28 14:17:03.679277+10,5,0,362,noninterpretable
3901,"select p.id from person p,director d,writer w where p.id = d.id and p.id = w.id
union
select p.id from person p,director d where p.id = d.id
union
select p.id from person p,writer w where p.id = w.id;",2018-08-28 14:18:21.983584+10,14,0,209,partially correct
3902,"select count(*) from person left join director on person.id=director.id 
where director.id is null;",2018-08-28 14:21:16.254695+10,12,1,234,correct
3903,;,2018-08-28 14:21:27.333404+10,10,0,158,noninterpretable
3904,"select movie.title

from movie join Movie_award on movie.title = movie_award.title join crew_award on crew_award.title = movie.title 
           join director_award on director_award.title = movie.title join writer_award on writer_award.title= movie.title
		   join actor_award on actor_award.title= movie.title


where not lower(movie_award.result) ='won' and not lower(crew_award.result)='won' and not lower(director_award.result)='won'
       and not lower(writer_award.result)='won'and not lower(actor_award.result)='won';",2018-08-28 14:21:51.793651+10,11,0,235,partially correct
3905,"SELECT m.title, m.production_year, p.first_name, p.last_name from person p, director d, movie_award m
WHERE p.id= d.id
and d.title = m.title
and d.production_year = m.production_year
and lower(m.award_name) = 'bafta film award'
and lower(m.category) = 'best film'
and lower(m.result) = 'won';

",2018-08-28 14:22:22.529713+10,8,1,274,correct
3906,"select p.id,p.first_name,p.last_name from director d inner join writer w on w.id = d.id inner join person p on p.id = d.id
group by d.id
having count(*)>2;",2018-08-28 14:22:57.483672+10,4,1,203,correct
3907,"SELECT w.title, w.production_year 
FROM writer w, person p 
WHERE 
    w.id = p.id
    AND p.first_name = 'Kevin' 
    AND p.last_name = 'Williamson'; 
    ",2018-08-28 14:25:00.087327+10,5,1,362,correct
3908,"SELECT production_year,COUNT(*)
FROM Movie 
WHERE production_year >1990 AND production_year <1994
GROUP BY production_year;",2018-08-28 14:26:27.728839+10,2,1,246,correct
3909,"select count(distinct person.id) from person
join writer on writer.id=person.id
where person.year_born=1935;",2018-08-28 14:26:33.997646+10,1,1,363,correct
3910,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-28 14:27:15.255587+10,14,1,209,correct
3911,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w, (SELECT count(*)
                                     FROM director, writer
						   WHERE director.id=writer.id) AS h
WHERE p.id=d.id
AND p.id=w.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-28 14:28:24.80096+10,4,0,227,partially correct
3912,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w, (SELECT count(*)
                                     FROM director, writer
						   WHERE director.id=writer.id) AS h
WHERE p.id=d.id
AND p.id=w.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-28 14:28:42.770143+10,4,0,227,partially correct
3913,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w, (SELECT count(*)
                                     FROM director, writer
						   WHERE director.id=writer.id) AS h
WHERE p.id=d.id
AND p.id=w.id
GROUP BY p.id
HAVING count(*)>1;",2018-08-28 14:29:10.513988+10,4,0,227,partially correct
3914,"SELECT * country FROM restriction r 
WHERE 
description = 'M'
AND title = Shakespeare in Love;",2018-08-28 14:30:23.514968+10,6,0,362,noninterpretable
3915,"SELECT count (*)
FROM person p
Where p.id!= Director.id;",2018-08-28 14:30:36.770358+10,12,0,246,noninterpretable
3950,"SELECT p.id 
FROM (SELECT id FROM person WHERE NOT EXISTS year_born = year_born) as p
WHERE MAXp.year_bron;",2018-08-28 15:03:42.601735+10,3,0,49,noninterpretable
3916,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w, (SELECT count(*)
                                     FROM director, writer
						   WHERE director.id=writer.id
						   AND director.production_year=writer.production_year
						   AND director.title=writer.title) AS h
WHERE p.id=d.id
AND p.id=w.id
GROUP BY p.id
HAVING count(*)>1;",2018-08-28 14:30:50.960119+10,4,0,227,partially correct
3917,"select count(distinct title) from movie
where production_year between 1991 and 1993;",2018-08-28 14:31:00.167719+10,2,0,363,partially correct
3918,"select count(*)
from person,writer
where person.id = writer.id and person.year_born =1935;",2018-08-28 14:32:55.122224+10,1,0,364,partially correct
3919,"select production_year,count(*) from movie
where production_year=1991
union
select production_year,count(distinct title) from movie
where production_year=1992
union
select production_year,count(distinct title) from movie
where production_year=1993;",2018-08-28 14:33:44.423143+10,2,1,363,correct
3920,"select production_year,count(*) from movie
where production_year=1991
union
select production_year,count(distinct title) from movie
where production_year=1992
union
select production_year,count(distinct title) from movie
where production_year=1993;",2018-08-28 14:33:54.29122+10,2,1,363,correct
3921,"select count(*)

from movie join Movie_award on movie.title = movie_award.title join crew_award on crew_award.title = movie.title 
           join director_award on director_award.title = movie.title join writer_award on writer_award.title= movie.title
           join actor_award on actor_award.title= movie.title


where not lower(movie_award.result) ='won' or not lower(crew_award.result)='won' or not lower(director_award.result)='won'
       or not lower(writer_award.result)='won'or not lower(actor_award.result)='won';",2018-08-28 14:35:18.848264+10,11,0,235,partially correct
3922,"SELECT COUNT(*) FROM person p NATURAL JOIN writer w NATURAL JOIN writer_award wa
where lower(p.first_name) = 'woody' and lower(p.last_name)='allen'
and wa.year_of_award between 1991 and 1995
and wa.result=('won');
",2018-08-28 14:35:29.971588+10,9,1,274,correct
3923,"select a.id,first_name, last_name from person,(select writer.id from director,writer where writer.id=director.id) a 
where person.id = a.id
group by person.id
having count(*)>2;",2018-08-28 14:36:46.430591+10,4,1,234,correct
3924,"SELECT title, production_year
FROM writer w, person p
WHERE w.id=p.id
AND lower(first_name)='kebvin'
AND lower(last_name)='williamson';",2018-08-28 14:36:55.422226+10,5,0,227,partially correct
3925,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id=p.id
AND lower(first_name)='kebvin'
AND lower(last_name)='williamson';",2018-08-28 14:37:37.938147+10,5,0,227,partially correct
3926,"SELECT title, production_year
FROM writer w, person p
WHERE w.id=p.id
AND lower(first_name)='kevin'
AND lower(last_name)='williamson';",2018-08-28 14:38:03.527187+10,5,1,227,correct
3927,"SELECT count (*)
FROM person p
where not exists (SELECT * FROM director d WHERE p.id=d.id);",2018-08-28 14:39:10.022303+10,12,1,246,correct
3928,"select count(*)
from movie as b
where not exists (select * from movie_award as m, crew_award as c, director_award as d, writer_award as w, actor_award as a
where b.title=a.title
and b.title=m.title
and b.title=c.title
and b.title= d.title
and b.title=w.title);",2018-08-28 14:39:45.112268+10,11,0,158,partially correct
3929,"select writer.title, writer.production_year from writer natural join person where person.first_name='Kevin';",2018-08-28 14:41:09.203468+10,5,0,258,partially correct
3930,"select count(distinct person.id) from person
where person.id not in (select director.id from director);",2018-08-28 14:41:43.58799+10,12,1,363,correct
3931,"select w.title,w.production_year 
from person p 
inner join writer w on p.id = w.id
where p.first_name = ""Kevin"" and last_name =""Williamson"" ;",2018-08-28 14:42:26.435566+10,5,1,203,correct
3932,"select writer.title, writer.production_year from writer natural join person where person.first_name='Kevin' and person.last_name='Williamson';",2018-08-28 14:43:05.827571+10,5,1,258,correct
3933,"select Person.id, Person.first_name ,Person.last_name from (Person natural join Director natural join Writer) as d group by d.id;",2018-08-28 14:43:28.54285+10,4,0,101,partially correct
3934,;,2018-08-28 14:43:53.269284+10,3,0,158,noninterpretable
3935,"select count(*)
from person p
where exists(select * from writer w 
where p.id=w.id and p.year_born = 1935);",2018-08-28 14:45:55.18115+10,1,1,364,correct
3936,"select title, production_year from writer where writer.id in (select id from person where person.first_name like ""Kevin"" and person.last_name like ""Williamson"");",2018-08-28 14:46:29.183407+10,5,1,234,correct
3937,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
	FROM movie_award ma 
	WHERE 
	ma.result = 'won' AND m.title = ma.title AND m.production_year = ma.production_year
UNION 
	SELECT title,production_year 
	FROM crew_award ca
	WHERE 
	ca.result = 'won' AND m.title = ca.title AND m.production_year = ca.production_year
UNION
	SELECT title,production_year
	FROM director_award da
	WHERE da.result = 'won' AND m.title = da.title AND m.production_year = da.production_year
UNION
	SELECT title,production_year
	FROM writer_award wa
	WHERE wa.result = 'won' AND m.title = ma.title AND m.production_year = ma.production_year
UNION
	SELECT title, production_year 
	FROM actor_award aa
	WHERE aa.result = 'won' AND m.title = aa.title AND m.production_year = aa.production_year);",2018-08-28 14:54:28.073775+10,11,0,49,noninterpretable
3938,"select r.id,count(*) as number from role r group by r.id;",2018-08-28 14:54:46.395135+10,15,0,209,partially correct
3939,"select id 
from person as p
where p.year_born=(select max(year_born) 
from person
where year_born<(select max(year_born)
from person));",2018-08-28 14:54:59.185065+10,3,1,158,correct
3940,"SELECT id,first_name,last_name
FROM person p,writer w,director d
WHERE p.id=w.id=d.id AND d.title=w.title;",2018-08-28 14:55:55.623073+10,4,0,246,noninterpretable
3941,"select person.id,person.first_name,person.last_name
from person
where person.id in
(select d.id from director d,writer w
where d.title=w.title
and d.id=w.id
group by d.id having count(d.title)>1);
",2018-08-28 14:55:58.95995+10,4,1,363,correct
3942,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 14:57:42.918034+10,11,1,49,correct
3943,"SELECT country
FROM restriction 
WHERE lower(title)='shakespeare in love'
AND description='M';",2018-08-28 14:58:28.915855+10,6,1,227,correct
3944,"select w.title, w.production_year from writer w, person p where w.id=p.id and first_name='Kevin' and last_name='Williamson';",2018-08-28 14:59:44.298098+10,5,1,258,correct
3945,"select movie.title from movie,writer,person
where movie.title=writer.title
and writer.id=person.id
and person.first_name='Kevin'
and person.last_name='Williamson';",2018-08-28 15:00:47.168632+10,5,0,363,partially correct
3946,"select movie.title,movie.production_year from movie,writer,person
where movie.title=writer.title
and writer.id=person.id
and person.first_name='Kevin'
and person.last_name='Williamson';",2018-08-28 15:01:39.744996+10,5,1,363,correct
3947,"SELECT p.id, p.first_name, p.last_name
FROM (SELECT *, MAX(year_born)
      FROM person) AS h, person p
WHERE h.id=p.id;",2018-08-28 15:01:59.595006+10,7,1,227,correct
3948,select country from restriction_category where description='M';,2018-08-28 15:03:08.101874+10,6,0,258,partially correct
3949,"Select count(*)
from (SELECT WRITER.*,PERSON.year_born
FROM WRITER NATURAL JOIN PERSON
WHERE PERSON.year_born = '1935');





",2018-08-28 15:03:41.906128+10,1,0,154,partially correct
3955,"SELECT p.id
FROM person p 
WHERE p.year_born = (SELECT MAX (year_born)
				FROM person
				WHERE year_born <(SELECT MAX(year_born)
							FROM person));",2018-08-28 15:07:18.040565+10,3,1,49,correct
3956,"select p.id,p.first_name,p.last_name from person p
where p.year_born=(select year_born from person order by year_born desc limit 1);",2018-08-28 15:08:16.93465+10,7,1,363,correct
3957,"select id, award_name, year_of_award, category
from director as d1, director_award as d2
where lower(result)=nominate 
and d1.title=d2.title
and d1.production_year=d2.priduction_year;",2018-08-28 15:09:32.073654+10,13,0,158,noninterpretable
3958,"select id, award_name, year_of_award, category
from director as d1, director_award as d2
where lower(result)='nominated'
and d1.title=d2.title
and d1.production_year=d2.production_year;",2018-08-28 15:11:08.120303+10,13,1,158,correct
3959,"select id, award_name, year_of_award, category
from director as d1, director_award as d2
where lower(result)='nominated'
and d1.title=d2.title
and d1.production_year=d2.production_year;",2018-08-28 15:12:21.750233+10,13,1,158,correct
3960,"select production_year,count(*)
from movie
where production_year =1993 or production_year = 1992 or production_year =1991
group by production_year;",2018-08-28 15:12:50.308919+10,2,1,364,correct
3961,"select  *

from person

order by year_born desc

Limit 2;
 

",2018-08-28 15:13:13.129762+10,3,0,235,partially correct
3962,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d ,director_award da
WHERE d.title = da.title
	AND d.production_year = da.production_year
	AND lower(da.result) = 'nominated'
GROUP BY d.id;",2018-08-28 15:14:25.840255+10,13,1,49,correct
3963,select * from Person;,2018-08-28 15:16:45.377361+10,5,0,101,partially correct
3964,"select a.title,a.production_year,p.first_name,p.last_name
from movie_award a
join director d on a.title=d.title
join person p on d.id=p.id
where a.award_name='BAFTA Film Award'
and a.category='Best Film';
",2018-08-28 15:19:48.366983+10,8,0,363,partially correct
3965,"select a.title,a.production_year,p.first_name,p.last_name
from movie_award a
join director d on a.title=d.title
join person p on d.id=p.id
where lower(a.award_name)='bafta film award'
and lower(a.category)='best film'
and lower(a.result)='won';
",2018-08-28 15:22:07.44412+10,8,1,363,correct
3966,"select count(*) from movie m
where not exists
(select title, production_year from movie_award ma where m.production_year=ma.production_year and lower(ma.result='won')
union 
select title, production_year from crew_award ca where m.production_year=ca.production_year and lower(ca.result='won')
union 
select title, production_year from director_award da where m.production_year=da.production_year and lower(da.result='won')
union 
select title, production_year from writer_award wa where m.production_year=wa.production_year and lower(wa.result='won')
union 
select title, production_year from actor_award aa where m.production_year=aa.production_year and lower(aa.result='won'));
",2018-08-28 15:23:58.452681+10,11,0,274,partially correct
3967,"select person.id 
from person, (select id from person where exists(select * from director where director.id=person.id))as a,(select id from person where exists(select* from writer where writer.id=person.id)) as b
where person.id=a.id
and person.id=b.id;",2018-08-28 15:24:42.582361+10,14,0,158,partially correct
3968,"SELECT 
	p.id,
	count(*)
FROM 
	person p,
	writer w,
	director d
WHERE 
	p.id = w.id
	OR 
	p.id = d.id
	OR
	p.id = d.id = w.id ;",2018-08-28 15:27:15.335309+10,14,0,49,partially correct
3969,"select  id

from person

where person.year_born = (select max (year_born) from person where year_born < (select max(year_born)from person));
",2018-08-28 15:28:40.377227+10,3,1,235,correct
3970,"select count(*) 
from writer_award wa,writer w,person p
where wa.title=w.title
and w.id=p.id
and p.first_name='Woody'
and p.last_name='Allen';",2018-08-28 15:29:17.059644+10,9,0,363,partially correct
3971,"select count(*) from movie m
where not exists
(select title, production_year 
from movie_award ma 
where m.title=ma.title and m.production_year=ma.production_year and lower(ma.result)='won'
union 
select title, production_year 
from crew_award ca 
where m.title=ca.title and m.production_year=ca.production_year and lower(ca.result)='won'
union 
select title, production_year 
from director_award da 
where m.title=da.title and m.production_year=da.production_year and lower(da.result)='won'
union
select title, production_year 
from writer_award wa 
where m.title=wa.title and m.production_year=wa.production_year and lower(wa.result)='won'
union 
select title, production_year 
from actor_award aa 
where m.title=aa.title and m.production_year=aa.production_year and lower(aa.result)='won');",2018-08-28 15:33:18.161663+10,11,1,274,correct
3972,;,2018-08-28 15:33:36.943538+10,15,0,158,noninterpretable
3973,"select count(*) as number_of_award
from writer_award wa,writer w,person p
where wa.title=w.title
and w.id=p.id
and p.first_name='Woody'
and p.last_name='Allen'
and wa.year_of_award between 1991 and 1995
and lower(wa.result)='won';",2018-08-28 15:34:10.012157+10,9,1,363,correct
3974,"select p.year_born as bornIn, count(*) as number
from person p
where EXISTS(SELECT * FROM writer w WHERE w.id=p.id and p.year_born=1935)
group by p.year_born;",2018-08-28 15:34:35.768054+10,1,0,128,partially correct
3975,"select person.id, director_award.award_name,director_award.year_of_award,director_award.category

from director_award join director on director_award.title = director.title join person on director.id = person.id

where lower(director_award.result) = 'nominated'

Group by person.id

having count(director_award.result) =  1;",2018-08-28 15:36:13.393793+10,13,1,235,correct
3976,"select person.id, director_award.award_name,director_award.year_of_award,director_award.category

from director_award join director on director_award.title = director.title join person on director.id = person.id

where lower(director_award.result) = 'nominated'

Group by person.id

having count(director_award.result) = 1;",2018-08-28 15:38:42.95717+10,13,1,235,correct
3977,select r.country from Restriction as r where r.title='Shakespeare in Love'and r.description='M';,2018-08-28 15:39:20.955222+10,6,1,101,correct
3978,"select count(*)
from person p where not exists(select * from director d
where p.id = d.id);",2018-08-28 15:41:29.672934+10,12,1,364,correct
3979,"select person.id, director_award.award_name,director_award.year_of_award,director_award.category

from director_award join director on director_award.title = director.title join person on director.id = person.id

where lower(director_award.result) = 'nominated'

Group by person.id

having count(director_award.result) > 0;",2018-08-28 15:42:31.680642+10,13,1,235,correct
3980,"select id, person.first_name, person.last_name from person where year_born=(select max(year_born) from person);",2018-08-28 15:43:20.63906+10,7,1,258,correct
3981,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-28 15:43:36.621832+10,14,1,49,correct
3982,"select count(*)
FROM person p 
WHERE not EXISTS (SELECT * FROM DIRECTOR d WHERE d.id = p.id);",2018-08-28 15:44:42.477186+10,12,1,154,correct
3983,"select distinct r.id from role r,scene s
where r.title=s.title
and lower(r.title)='psycho'
and r.production_year=1960
and s.production_year=1960
and s.scene_no=1;",2018-08-28 15:45:38.369889+10,10,0,363,partially correct
3984,"SELECT id FROM (SELECT id FROM person 
WHERE person.year_born<(SELECT MAX(year_born) FROM person))
WHERE person.year_born >= ALL 
(SELECT year_born from person 
WHERE person.year_born<(SELECT MAX(year_born) FROM person));",2018-08-28 15:47:34.685636+10,3,0,288,noninterpretable
3985,;,2018-08-28 15:47:35.022379+10,15,0,49,noninterpretable
3986,"with exceptyoungest as
(select year_born from person
where year_born < (select max(year_born) from person))

select id from person
where year_born=(select max(e.year_born) from exceptyoungest e);",2018-08-28 15:51:42.875318+10,3,1,274,correct
3987,"select r.id from role r,scene s,appearance a
where r.title=s.title
and lower(r.title)='psycho'
and a.title=r.title
and s.scene_no=a.scene_no
and s.production_year=a.production_year
and a.description=r.description
and a.production_year=1960
and s.production_year=a.production_year
and r.production_year=a.production_year
group by r.id having count(*)=1;",2018-08-28 15:54:37.613008+10,10,1,363,correct
3988,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-28 15:57:10.870388+10,10,1,273,correct
3989,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-28 15:58:02.956581+10,15,1,49,correct
3990,"SELECT id FROM person 
WHERE person.year_born=(SELECT MAX(year_born) FROM person
WHERE person.year_born<(SELECT MAX(year_born) FROM person));",2018-08-28 16:00:08.311944+10,3,1,288,correct
3991,"select p.id,p.first_name,p.last_name , Max(year_born)from Person as p  ;",2018-08-28 16:05:26.218054+10,7,0,101,partially correct
3992,"with pda as 
(select id, award_name,year_of_award, category
from person p natural join director d natural join director_award da)

select * from pda
where not exists (select id from director d natural join director_award da 
where pda.id=d.id and lower(da.result)='won');",2018-08-28 16:08:03.191552+10,13,1,274,correct
3993,"SELECT COUNT( DISTINCT m.title)
From movie as m
        movie_award Natural Join crew_award natural join director-award natural join writer_award natural join actor_award AS k
Where m.title!=k.title;",2018-08-28 16:09:23.408131+10,11,0,273,noninterpretable
3994,"select count(*) from movie m
where m.title not in
(select ma.title from movie_award ma
where lower(ma.result)='won')
and m.title not in (select ca.title from crew_award ca
where lower(ca.result)='won')
and m.title not in (select da.title from director_award da
where lower(da.result)='won')
and m.title not in (select wa.title from writer_award wa
where lower(wa.result)='won')
and m.title not in (select aa.title from actor_award aa
where lower(aa.result)='won');",2018-08-28 16:10:22.225702+10,11,0,363,partially correct
3995,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name 
FROM movie_award ma, director d, person p
WHERE ma.title=d.title
AND d.id=p.id
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award'
AND lower(ma.result)='won';",2018-08-28 16:12:01.468339+10,8,1,227,correct
3996,"SELECT id, award_name, year_of_award, category FROM director_award, director
WHERE NOT EXISTS(SELECT director_award.* FROM director_award 
WHERE director_award.result='won' AND director_award.title=director.title
AND director_award.production_year=director.production_year);",2018-08-28 16:12:57.684931+10,13,0,288,partially correct
3997,"with pda as 
(select id, award_name,year_of_award, category
from person p natural join director d natural join director_award da)

select * from pda
where pda.id not in (select id from director d natural join director_award da
where lower(da.result)='won');",2018-08-28 16:13:01.952112+10,13,1,274,correct
3998,"select count(*) from movie m
WHERE not exists (
SELECT title, production_year 
FROM movie_award ma 
WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT title, production_year 
FROM crew_award ca 
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year 
FROM director_award da 
WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION
SELECT title, production_year 
FROM actor_award aa 
WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
UNION
SELECT title, production_year 
FROM writer_award wa 
WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 16:13:26.937677+10,11,1,363,correct
3999,"select id,first_name,last_name
from person p
where p.id in(
select w.id
from writer w,director d
where w.id = d.id);",2018-08-28 16:13:57.788851+10,4,0,364,partially correct
4000,select * from Movie_Award;,2018-08-28 16:16:11.443929+10,8,0,101,partially correct
4001,"SELECT COUNT(*)
FROM writer_award wa, person p
WHERE lower(first_name)='woody'
AND lower(last_name)='allen'
AND wa.id=p.id
AND wa.year_of_award>=1991
AND wa.year_of_award<=1995;",2018-08-28 16:17:27.14148+10,9,0,227,partially correct
4002,"select movie_award.title, movie_award.production_year, person.first_name, person.last_name from person, movie_award, director where person.id
=(select director.id where lower(movie_award.award_name)=""bafta film award"" and lower(movie_award.category)=""best film"" and lower(movie_award.result)=""won"" 
and director.title=movie_award.title and director.production_year=movie_award.production_year);",2018-08-28 16:17:55.015405+10,8,1,31,correct
4003,"SELECT id, award_name, year_of_award, category FROM director_award, director
WHERE director_award.result='nominated' AND director_award.title=director.title
AND director_award.production_year=director.production_year;",2018-08-28 16:18:00.773655+10,13,1,288,correct
4004,"SELECT COUNT(*)
FROM writer_award wa, person p
WHERE lower(first_name)='woody'
AND lower(last_name)='allen'
AND wa.id=p.id
AND wa.year_of_award>=1991
AND wa.year_of_award<=1995
AND lower(wa.result)='won';",2018-08-28 16:18:02.759496+10,9,1,227,correct
4005,"select p.id from person p
where p.year_born=(
select p1.year_born from person p1
order by p1.year_born desc
limit 1 offset 1
);",2018-08-28 16:18:03.682874+10,3,1,363,correct
4006,"SELECT COUNT(*) as number
FROM WRITER INNER JOIN PERSON
WHERE PERSON.id=WRITER.id
GROUP BY PERSON.year_born
HAVING PERSON.year_born=1935;

",2018-08-28 16:20:50.643609+10,1,0,143,partially correct
4007,"SELECT r.id
FROM appearance a, role r
WHERE lower(a.title)='psycho'
AND a.production_year=1960
AND a.production_year=r.production_year
AND a.title=r.title;
",2018-08-28 16:23:44.626363+10,10,0,227,partially correct
4008,"select count(*) from (select distinct last_name from writer w,person p where w.id=p.id and p.year_born=1935)a;",2018-08-28 16:24:39.795823+10,1,1,317,correct
4009,"SELECT r.id
FROM appearance a, role r,
( SELECT *,count(*)
  FROM appearance) AS h
WHERE lower(a.title)='psycho'
AND a.production_year=1960
AND a.production_year=r.production_year
AND a.title=r.title
AND h.title=a.title
AND h.production_year=a.production_year
GROUP BY r.id
HAVING COUNT(*)=1;


",2018-08-28 16:26:09.872011+10,10,0,227,partially correct
4010,"select sum(writer.id)
from person, writer
where person.id=writer.id and year_born='1935';",2018-08-28 16:29:39.489274+10,1,0,244,partially correct
4011,"Select id, first_name, last_name
From person
Where person.year_born in(Select max(year_born)
                          From person);
",2018-08-28 16:30:27.082814+10,7,1,83,correct
4012,"SELECT COUNT(*)
FROM person p,writer w
WHERE p.id = w.id AND p.year_born = 1953;",2018-08-28 16:31:36.069867+10,1,0,219,partially correct
4013,"select count(distinct last_name) from (select * from person,director where person.id<>director.id)a;",2018-08-28 16:31:41.20372+10,12,0,317,partially correct
4014,"SELECT r.id
FROM appearance a, role r,(SELECT *, scene_no,count(*)
FROM appearance
GROUP BY scene_no) AS h
WHERE lower(a.title)='psycho'
AND a.production_year=1960
AND a.production_year=r.production_year
AND a.title=r.title
AND h.title=a.title
AND h.production_year=a.production_year
GROUP BY r.id;


",2018-08-28 16:31:47.910869+10,10,0,227,partially correct
4015,"SELECT r.id
FROM appearance a, role r,(SELECT *, scene_no,count(*)
FROM appearance
GROUP BY scene_no) AS h
WHERE lower(a.title)='psycho'
AND a.production_year=1960
AND a.production_year=r.production_year
AND a.title=r.title
AND h.title=a.title
AND h.production_year=a.production_year
GROUP BY r.id
HAVING COUNT(*)=1;


",2018-08-28 16:32:03.860422+10,10,0,227,partially correct
4016,"SELECT COUNT(*)
FROM person p,writer w
WHERE p.id = w.id AND p.year_born = 1935;",2018-08-28 16:32:12.235313+10,1,0,219,partially correct
4017,"select country from restriction r
where title='Shakespeare in Love' and lower(description)='m';",2018-08-28 16:33:03.742107+10,6,1,203,correct
4018,"select country from restriction where title like ""Shakespeare in Love"" and description like ""M"";",2018-08-28 16:33:44.509302+10,6,1,234,correct
4019,"SELECT a.id FROM (SELECT person.id, COUNT(*) FROM person, director, writer
WHERE person.id=director.id
OR person.id=writer.id GROUP BY person.id, director.id, writer.id
) AS a WHERE COUNT(*)=(SELECT MAX(COUNT(*) FROM a);",2018-08-28 16:33:57.100347+10,14,0,288,noninterpretable
4020,"SELECT COUNT(id)
FROM WRITER;",2018-08-28 16:33:57.854218+10,1,0,366,partially correct
4021,"select d.id,da.award_name,da.year_of_award,da.category
from director d,director_award da
where d.title=da.title
and d.production_year=da.production_year
and lower(da.result) != 'won';",2018-08-28 16:34:06.887218+10,13,1,363,correct
4022,"SELECT COUNT(*)
FROM person p
WHERE p.year_born = 1935 AND p.id IN (SELECT w.id FROM writer w);",2018-08-28 16:35:16.973616+10,1,1,219,correct
4023,"SELECT COUNT(*)
FROM PERSON p,WRITER w
WHERE year_born = 1935 AND p.id=w.id;",2018-08-28 16:35:37.547637+10,1,0,368,partially correct
4024,"select id,first_name,last_name from person
where year_born  = (select min(year_born) from person);",2018-08-28 16:35:56.449689+10,7,0,203,partially correct
4025,"select id,first_name,last_name from person
where year_born  = (select max(year_born) from person);",2018-08-28 16:36:16.562918+10,7,1,203,correct
4026,"select e.title, e.production_year, e.first_name, e.last_name from (select * from movie_award natural join (select * from person natural join director) s ) e where e.award_name='BAFTA Film Award' and e.category='best film';",2018-08-28 16:38:32.182482+10,8,0,258,partially correct
4027,"select count(distinct person.id) from person natural join writer on person.id=writer.id and person.year_born='1935';

",2018-08-28 16:38:49.811787+10,1,0,91,noninterpretable
4028,select count(*) from person where not exists(select * from director where director.id=person.id);,2018-08-28 16:38:59.587889+10,12,1,317,correct
4029,"select first_name,last_name,id from person where person.year_born=(select max(year_born) from person);",2018-08-28 16:41:10.079822+10,7,1,234,correct
4030,"select id,first_name,last_name from person where person.year_born=(select max(year_born) from person);",2018-08-28 16:41:52.053258+10,7,1,234,correct
4031,"select e.title, e.production_year, e.first_name, e.last_name from (select * from movie_award natural join (select * from person natural join director) s ) e where e.award_name='BAFTA Film Award' and e.category='best film' and e.result='won';",2018-08-28 16:42:18.065764+10,8,1,258,correct
4032,"select ma.title,ma.production_year, p.first_name, p.last_name 
from movie_award ma
inner join director d on d.title = ma.title and d.production_year = ma.production_year
inner join person p on p.id = d.id
where lower(award_name)='bafta film award' and lower(category) = 'best film';",2018-08-28 16:42:45.329716+10,8,0,203,partially correct
4033,"SELECT COUNT(year_born)
FROM person
WHERE(SELECT id
FROM writer 
WHERE person.id=writer.id AND person.year_born='1935');
",2018-08-28 16:42:52.799284+10,1,1,372,correct
4034,"
select year_born from person where person.id = writer.id;",2018-08-28 16:44:48.589853+10,1,0,183,noninterpretable
4035,"select ma.title,ma.production_year, p.first_name, p.last_name 
from movie_award ma
inner join director d on d.title = ma.title and d.production_year = ma.production_year
inner join person p on p.id = d.id
where lower(award_name)='bafta film award' and lower(category) = 'best film' and result = 'won';",2018-08-28 16:45:05.45341+10,8,1,203,correct
4036,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND d.id = p.id;",2018-08-28 16:45:47.801443+10,8,1,258,correct
4037,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;
",2018-08-28 16:46:21.325071+10,2,1,347,correct
4038,"select count(*) from writer_award wa
inner join person p
on p.id = wa.id
where result = 'won' and p.first_name = 'Woody' and p.last_name = 'Allen' and year_of_award between 1991 and 1995;",2018-08-28 16:48:19.933755+10,9,1,203,correct
4039,select id from director inner join writer on director.id=writer.id;,2018-08-28 16:49:32.520568+10,4,0,317,noninterpretable
4040,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991
GROUP BY production_year;",2018-08-28 16:49:35.910256+10,2,1,219,correct
4041,"SELECT production_year,COUNT(*)
FROM movie 
WHERE production_year='1991' OR production_year='1992' OR production_year='1993'
GROUP BY production_year;
",2018-08-28 16:50:00.530102+10,2,1,372,correct
4042,"select p.id,p.first_name,p.last_name 
from person p
where exists ( select count(*) as num
from director d
join writer w on w.id=d.id
where p.id=d.id 
group by d.id
having num>2)
group by p.id;",2018-08-28 16:50:27.599118+10,4,1,230,correct
4043,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-28 16:51:28.122612+10,4,1,149,correct
4044,"select dw.id,dw.first_name,dw.last_name
from (person  natural join director natural join writer) as dw
group by dw.id
having count(*)>1;
",2018-08-28 16:51:30.410373+10,4,1,364,correct
4045,"select person.id, first_name, last_name
from person, director, writer
where person.id = director.id and director.id = writer.id
group by person.id having count(*)>1;",2018-08-28 16:51:52.630915+10,4,0,347,partially correct
4046,"select production_year, count(*)
from movie 
where production_year >=1991 and production_year<=1993
group by production_year;",2018-08-28 16:53:03.093854+10,2,1,22,correct
4047,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 16:54:10.636146+10,1,1,366,correct
4048,"select country 
from restriction re
where re.title = 'Shakespeare in Love';",2018-08-28 16:54:10.731583+10,6,0,230,partially correct
4049,"

select count(distinct title)
from movie
where production_year=1991;",2018-08-28 16:54:18.008342+10,2,0,244,partially correct
4050,"SELECT COUNT(*)
FROM person
WHERE NOT person.id NOT IN (SELECT p.id FROM person p, director d WHERE p.id = d.id); ",2018-08-28 16:54:45.304589+10,12,0,219,partially correct
4051,"select country 
from restriction re
where re.title = 'Shakespeare in Love' and re.description='M';",2018-08-28 16:54:56.247011+10,6,1,230,correct
4052,"select count(distinct person.id) from person inner join writer on person.id=writer.id and person.year_born='1935';

",2018-08-28 16:54:57.565933+10,1,1,91,correct
4053,"SELECT production_year AND COUNT(*)
FROM moive
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991;",2018-08-28 16:57:44.274384+10,2,0,366,noninterpretable
4054,"SELECT COUNT(*)
FROM person 
WHERE EXISTS(SELECT id FROM 
director WHERE person.id!= director.id
);
",2018-08-28 16:57:54.689994+10,12,0,372,partially correct
4055,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994

group by production_year;",2018-08-28 16:58:24.601369+10,2,1,244,correct
4056,"SELECT COUNT(*)
FROM person
WHERE person.id NOT IN (SELECT p.id FROM person p, director d WHERE p.id = d.id); ",2018-08-28 16:58:45.454161+10,12,1,219,correct
4057,"SELECT COUNT(*)
FROM person 
WHERE NOT EXISTS(SELECT * FROM 
director WHERE person.id = director.id
);
",2018-08-28 16:59:11.629815+10,12,1,372,correct
4096,"select id, first_name, last_name
from person
where year_born = (
select max(year_born)
from person);",2018-08-28 17:21:37.127955+10,7,1,347,correct
4058,"select temp.id from
(select p.id,d.title from person p,director d
where p.id=d.id
union
select p.id,w.title from person p,writer w
where p.id=w.id) temp
group by temp.id 
order by count(distinct temp.title) desc limit 1;",2018-08-28 16:59:34.365636+10,14,0,363,partially correct
4059,"select dw.title,dw.production_year 
from (person natural join director) as dw
where dw.first_name = 'Kevin' and dw.last_name ='Williamson';
",2018-08-28 17:00:44.954195+10,5,0,149,partially correct
4060,"select id, first_name,last_name
from person pe,(select min(year_born) as year from person) as p
where pe.year_born=p.year;",2018-08-28 17:01:32.79981+10,7,0,230,partially correct
4061,"SELECT production_year, count(*)
FROM movie
WHERE production_year >1990 AND production_year <1994
GROUP BY production_year;",2018-08-28 17:01:54.80895+10,2,1,366,correct
4062,"select id, first_name ,last_name
from person
where id in (
select dw.id
from (director natural join writer) dw
group by dw.id having count(*)>1);",2018-08-28 17:01:55.225022+10,4,1,347,correct
4063,"select count(id)
from person
where not exists (select id from director); ",2018-08-28 17:01:58.859918+10,12,0,244,partially correct
4064,"select id, first_name,last_name
from person pe,(select max(year_born) as year from person) as p
where pe.year_born=p.year;",2018-08-28 17:02:02.616186+10,7,1,230,correct
4065,select count(*) as amount from person p where exists (select w.id from writer w where w.id=p.id and p.year_born=1935);,2018-08-28 17:02:06.301858+10,1,1,293,correct
4066,"with dw as
(SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w)

select id from
(select dw.id, count(*) as noofmovies 
from dw
group by dw.id) dw1
where dw1.noofmovies = (select max(dw2.noofmovies) from 
                        (select dw.id, count(*) as noofmovies 
                         from dw
                         group by dw.id)dw2);
",2018-08-28 17:02:23.467714+10,14,1,274,correct
4067,"select count(id)
from person
where not exists (select id from director where person.id=director.id); ",2018-08-28 17:02:59.245198+10,12,1,244,correct
4068,"select count(*) from person 
where (select * from writer where production_year = 1993 || production_year = 1992 || production_year = 1991);",2018-08-28 17:03:36.485164+10,2,0,357,noninterpretable
4069,"SELECT count(*)
FROM person, director
WHERE ;",2018-08-28 17:04:10.819159+10,12,0,366,noninterpretable
4070,"select  dw.title, dw.production_year
from (person natural join writer) as dw
where dw.first_name='Kevin' and dw.last_name ='Williamson';

",2018-08-28 17:04:18.495352+10,5,1,149,correct
4071,"select  ma.award_name from Movie_Award as ma, Writer as w, Person as p,Director as d
where d.title=ma.title and d.id=p.id and lower(p.first_name)='Woody';",2018-08-28 17:05:00.738755+10,9,0,101,partially correct
4072,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d WHERE d.id = p.id );",2018-08-28 17:05:53.10013+10,12,1,366,correct
4073,"SELECT first_name, last_name, title, production_year, description 
FROM role, person WHERE role.id=person.id GROUP BY role.id, person.id
HAVING role.id=(SELECT MAX(COUNT(*)) FROM role);",2018-08-28 17:06:22.8508+10,15,0,288,noninterpretable
4074,"select title,production_year,p.first_name,p.last_name
from movie_award aw,person p
where aw.award_name='BAFTA Film Award'
group by title;",2018-08-28 17:06:23.817795+10,8,0,230,partially correct
4075,"select country
from Restriction 
where title ='Shakespeare in Love' and description='M';",2018-08-28 17:06:33.378545+10,6,1,149,correct
4076,"select temp.id 
from 
(select p.id,d.title from person p,director d
where p.id=d.id
union
select p.id,w.title from person p,writer w
where p.id=w.id) temp
group by temp.id
having count(distinct temp.title)=
(select count(distinct temp.title) from 
(select p.id,d.title from person p,director d
where p.id=d.id
union
select p.id,w.title from person p,writer w
where p.id=w.id) temp
group by temp.id 
order by count(distinct temp.title) desc limit 1);",2018-08-28 17:08:14.002587+10,14,1,363,correct
4077,"select temp.id 
from 
(select p.id,d.title from person p,director d
where p.id=d.id
union
select p.id,w.title from person p,writer w
where p.id=w.id) temp
group by temp.id
having count(distinct temp.title)=
(select count(distinct temp.title) from 
(select p.id,d.title from person p,director d
where p.id=d.id
union
select p.id,w.title from person p,writer w
where p.id=w.id) temp
group by temp.id 
order by count(distinct temp.title) desc limit 1);",2018-08-28 17:08:45.723204+10,14,1,363,correct
4078,"select id,first_name,last_name
from person 
where year_born in (select max(year_born) from person);",2018-08-28 17:09:09.435406+10,7,1,149,correct
4079,"SELECT*
FROM WRITER;",2018-08-28 17:09:40.717099+10,1,0,280,partially correct
4080,"SELECT id, first_name, last_name
FROM person p
WHERE EXSITS(SELECT * FROM writer w WHERE w.);",2018-08-28 17:09:42.389706+10,4,0,366,noninterpretable
4081,"select aw.title,aw.production_year,p.first_name,p.last_name
from movie_award aw
inner join director d on d.title=aw.title
inner join person p on p.id =d.id
where aw.award_name='BAFTA Film Award' 
group by aw.title;",2018-08-28 17:10:01.581836+10,8,0,230,partially correct
4082,"SELECT COUNT(*)
FROM WRITER, PERSON
WHERE WRITER.id = PERSON.id
AND PERSON.year_born = 1935;",2018-08-28 17:11:42.125507+10,1,0,199,partially correct
4083,"select title, production_year
from (movie natural join writer) as md
where id = (
select id 
from person
where first_name = 'Kevin' and last_name = 'Williamson');
",2018-08-28 17:12:02.574752+10,5,1,347,correct
4084,"select aw.title,aw.production_year,p.first_name,p.last_name
from director d
inner join movie_award aw on d.title=aw.title
inner join person p on p.id =d.id
where aw.award_name='BAFTA Film Award' 
;",2018-08-28 17:12:06.080043+10,8,0,230,partially correct
4085,"select aw.title,aw.production_year,p.first_name,p.last_name
from director d
inner join movie_award aw on d.title=aw.title
inner join person p on p.id =d.id
where aw.award_name='BAFTA Film Award' and aw.category='Best Film';",2018-08-28 17:13:12.116809+10,8,0,230,partially correct
4086,"select count(*) from (select wa.year_of_award, p.first_name, p.last_name, wa.title from writer_award wa, person p, movie m where wa.year_of_award between 1991 and 1995 and p.first_name='Woody' and p.last_name='Allen' and wa.title=m.title and p.id=wa.id) a;",2018-08-28 17:13:33.643512+10,9,0,258,partially correct
4087,"select id,first_name,last_name from(person p natural join director natural join writer) a group by a.id having count(*)>1;",2018-08-28 17:14:11.685776+10,4,1,317,correct
4088,"select id from role
where description in (
select description from appearance
where title = 'Psycho' and production_year = 1960
group by description
having count(*)=1) and production_year = 1960;",2018-08-28 17:14:43.275033+10,10,1,203,correct
4089,"select count(*) from (select wa.year_of_award, p.first_name, p.last_name, wa.title from writer_award wa, person p, movie m where wa.year_of_award between 1991 and 1995 and p.first_name='Woody' and p.last_name='Allen' and wa.result='won' and wa.title=m.title and p.id=wa.id ) a;",2018-08-28 17:16:19.304784+10,9,1,258,correct
4090,"SELECT id, first_name, last_name
FROM person
WHERE id IN (
SELECT d.id
FROM director d,writer w
WHERE d.title = w.title AND d.id = w.id
GROUP BY d.id
HAVING COUNT(*)>=2);",2018-08-28 17:16:44.71115+10,4,1,219,correct
4091,"select a.title,a.production_year,first_name,last_name from person,(select title,production_year from movie_award where
award_name like ""BAFTA Film Award"" and category like ""Best Film"" and result like ""won"") a,director
where a.title=director.title
and director.id=person.id;
 
",2018-08-28 17:16:46.876423+10,8,1,234,correct
4092,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';
",2018-08-28 17:18:32.261317+10,6,1,347,correct
4093,"SELECT ar.id
FROM (SELECT id, COUNT(*) AS NoOfAppearance
	FROM (appearance NATURAL JOIN role) ) ar
WHERE ar.NoOfAppearance = 1;",2018-08-28 17:19:31.317848+10,10,0,81,partially correct
4094,"with rolesplay as 
(select p.first_name, p.last_name, r.title,r.production_year, r.description, count(*) as roleno 
from person p natural join role r group by p.id)

select first_name,last_name, title,production_year, description from rolesplay r
where r.roleno = (select max(roleno) from rolesplay);",2018-08-28 17:20:43.641941+10,15,0,274,partially correct
4095,"select count(*)
from person p
where not exists (select id from director d where d.id=p.id);
",2018-08-28 17:21:34.638499+10,12,1,22,correct
4097,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p,role r where p.id=r.id
group by p.id
order by count(distinct r.title) desc limit 1;",2018-08-28 17:22:09.930995+10,15,0,363,partially correct
4098,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year > 1990
AND production_year < 1994
GROUP BY production_year;

",2018-08-28 17:22:23.579174+10,2,1,199,correct
4099,"SELECT title, production_year
FROM writer w
WHERE EXISTS (SELECT * FROM person p WHERE w.id = p.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson'); ",2018-08-28 17:23:49.192813+10,5,1,219,correct
4100,"SELECT R.id
FROM (SELECT id, COUNT(*) c
	FROM (appearance NATURAL JOIN role) ar
	WHERE lower(ar.title) = 'psycho' AND ar.production_year = 1960
	GROUP BY id) R
WHERE c = 1;",2018-08-28 17:26:35.634941+10,10,1,81,correct
4101,"Select count(*) from writer_award,(select id from person where first_name like ""woody"" and last_name like ""allen"") a where year_of_award between 1991 and 1995;
 ",2018-08-28 17:27:10.37903+10,9,0,234,partially correct
4102,"select t.first_name,t.last_name,r.title,r.production_year,r.description from
(select p.first_name as first_name,p.last_name as last_name,p.id as id
from person p,role r where p.id=r.id
group by p.id
order by count(distinct r.title) desc limit 1) as t,role r
where t.id=r.id;",2018-08-28 17:27:11.747938+10,15,1,363,correct
4103,"SELECT COUNT(*)
FROM DIRECTOR, PERSON
WHERE NOT EXISTS (SELECT * FROM DIRECTOR WHERE DIRECTOR.id = PERSON.id);",2018-08-28 17:27:58.385983+10,12,0,199,partially correct
4104,"select d.title,d.production_year
from (movie natural join writer natural join person) as d
where d.first_name = 'Kevin' and d.last_name='Williamson';
",2018-08-28 17:28:07.526644+10,5,1,364,correct
4105,"select id, first_name, last_name
from person
where 
(select count(movier.title) from movier, writer, director where writer.id=person.id 
and director.id=person.id)>2  ;",2018-08-28 17:28:58.503781+10,4,0,244,noninterpretable
4106,"select w.title
from (movie natural join movie_award) as w
where (w.award_name ='BAFTA Film Award' and w.category ='Best Film');",2018-08-28 17:29:19.087881+10,8,0,149,partially correct
4107,"select w.title
from (movie natural join movie_award) as w
where (w.award_name ='BAFTA Film Award' and w.category ='Best Film');",2018-08-28 17:29:19.695685+10,8,0,149,partially correct
4108,"select d.title,d.production_year
from ( writer natural join person) as d
where d.first_name = 'Kevin' and d.last_name='Williamson';
",2018-08-28 17:29:19.727137+10,5,1,364,correct
4109,"select count(*) from movie m
where title not in 
(select title from crew_award ca where ca.title = m.title and m.production_year = ca.production_year)
and title not in (select title from director_award da where da.title = m.title and m.production_year = da.production_year)
and title not in (select title from writer_award wa where wa.title = m.title and m.production_year = wa.production_year)
and title not in (select title from actor_award aa where aa.title = m.title and m.production_year = aa.production_year);",2018-08-28 17:30:08.525812+10,11,0,203,partially correct
4110,"WITH rolesplay AS 
(SELECT p.id, COUNT(*) AS roleno 
FROM person p NATURAL JOIN role r GROUP BY p.id)

SELECT first_name,last_name, title, production_year, description FROM person p NATURAL JOIN role r
WHERE r.id = (SELECT id FROM rolesplay r 
              WHERE r.roleno = (SELECT MAX(roleno) FROM rolesplay));",2018-08-28 17:31:33.790869+10,15,1,274,correct
4111,"Select count(*) as number_of_award from writer_award,(select id from person where first_name like ""woody"" and last_name like ""allen"") a where a.id=writer_award.id and year_of_award between 1991 and 1995 and result=""won"" ;
 ",2018-08-28 17:32:18.379645+10,9,1,234,correct
4112,"select ab.title,ab.production_year,ab.first_name,ab.last_name
from (person natural join movie_award) as ab
where lower(ab.award_name)='bafta film award'and low(ab.category)='best film';",2018-08-28 17:33:01.969836+10,8,0,293,noninterpretable
4113,"SELECT O.first_name, o.last.name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS O
where o.category=Best Film;",2018-08-28 17:33:48.617599+10,8,0,338,noninterpretable
4114,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-28 17:34:48.346443+10,6,1,219,correct
4115,"SELECT p.id

FROM 
(	SELECT id, RESULT,production_year
	FROM writer_award
	WHERE year_of_award >1990 AND year_of_award < 1996) AS wa
	,person p, writer w
WHERE
	w.production_year = wa.production_year and
	p.id = w.id and p.id = wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen' and 
	lower(RESULT)='won';
",2018-08-28 17:35:24.28762+10,9,0,120,partially correct
4116,"select title,production_year from(movie m natural join writer w natural join person p)where first_name='Kevin';",2018-08-28 17:36:25.202474+10,5,0,317,partially correct
4117,"select d.country
from (Restriction_Category natural join Restriction) as d
where d.title ='Shakespeare in Love' and d. description='M';",2018-08-28 17:36:28.467644+10,6,1,364,correct
4118,"select p.id, p.first_name, p.last_name
from (person NATURAL join director NATURAL join writer) AS p
group by p.id  
having count(p.id)>=2;",2018-08-28 17:37:53.197824+10,4,1,244,correct
4119,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p NATURAL JOIN WRITER w NATURAL JOIN DIRECTOR d
WHERE p.id = w.id
AND p.id = d.id
GROUP BY p.id
HAVING COUNT(*) >= 2;",2018-08-28 17:37:58.594695+10,4,1,199,correct
4120,"SELECT id, first_name, last_name
FROM person
WHERE year_born =(SELECT MAX(year_born) FROM person);",2018-08-28 17:39:16.674485+10,7,1,219,correct
4121,"select title, production_year, first_name, last_name
from (director natural join person) as dp
where exists (
select *                                         
from movie_award
where dp.title = movie_award.title 
and dp.production_year = movie_award.production_year
and Movie_Award.award_name = 'BAFTA Film Award'
and Movie_Award.category = 'Best Film');
",2018-08-28 17:40:05.137376+10,8,0,347,partially correct
4122,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director d,
    person  p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-28 17:41:55.302328+10,8,1,293,correct
4123,"select count(*) from movie m
where title not in 
(select title from crew_award ca where ca.title = m.title and m.production_year = ca.production_year and result = 'won')
and title not in (select title from director_award da where da.title = m.title and m.production_year = da.production_year and result = 'won')
and title not in (select title from writer_award wa where wa.title = m.title and m.production_year = wa.production_year and result = 'won')
and title not in (select title from actor_award aa where aa.title = m.title and m.production_year = aa.production_year and result = 'won');",2018-08-28 17:42:36.032708+10,11,0,203,partially correct
4124,"select count(*) from movie m
where not exists 
(select title, production_year from movie_award ma where lower(ma.result) = 'won' and m.title = ma.title and m.production_year = ma.production_year 
union 
select title, production_year from director_award da where lower(da.result) = 'won' and m.title = da.title and m.production_year = da.production_year
union
select title, production_year from writer_award wa where lower(wa.result)='won' and m.title = wa.title and m.production_year = wa.production_year
union
select title, production_year from actor_award aa where lower(aa.result) = 'won' and m.title = aa.title and m.production_year = aa.production_year
union
select title, production_year from crew_award ca where lower(ca.result) = 'won' and m.title = ca.title and m.production_year = ca.production_year);",2018-08-28 17:43:34.22259+10,11,1,99,correct
4125,"SELECT ID
FROM(
SELECT D.ID, COUNT(*) AS A FROM DIRECTOR D, WRITER W GROUP BY D.ID) AS B
WHERE B.A=(SELECT MAX(A) FROM (
SELECT D.ID, COUNT(*) AS A FROM DIRECTOR D, WRITER W GROUP BY D.ID) AS BB );",2018-08-28 17:44:51.887032+10,14,1,228,correct
4126,"select count(person.id) from (select distinct person.id, year_born from person, writer where person.id=writer.id and year_born='1935') as h;",2018-08-28 17:46:35.313821+10,1,0,140,noninterpretable
4127,"SELECT title, production_year
FROM  movie_award
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND lower(result) = 'won';",2018-08-28 17:48:02.775722+10,8,0,219,partially correct
4128,"select count(*) from movie m
where 
 title not in  (select title from crew_award ca where ca.title = m.title and m.production_year = ca.production_year and lower(result) = 'won')
and  title not in  (select title from director_award da where da.title = m.title and m.production_year = da.production_year and lower(result) = 'won')
and  title not in  (select title from writer_award wa where wa.title = m.title and m.production_year = wa.production_year and lower(result) = 'won')
and  title not in  (select title from actor_award aa where aa.title = m.title and m.production_year = aa.production_year and lower(result) = 'won')
and  title not in  (select title from movie_award ma where ma.title = m.title and m.production_year = ma.production_year and lower(result) = 'won');",2018-08-28 17:49:04.238307+10,11,1,203,correct
4129,"SELECT o.first_name, o.last_name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film';",2018-08-28 17:49:56.445636+10,8,0,338,partially correct
4130,"SELECT o.first_name, o.last_name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film';",2018-08-28 17:50:14.17054+10,8,0,338,partially correct
4131,"select id 
from Person p 
where year_born = (select max(a.year_born) 
from Person a 
where a.year_born < (select max(b.year_born) from Person b) ) ;
",2018-08-28 17:50:48.874432+10,3,1,19,correct
4132,"SELECT title, production_year, first_name, last_name
FROM  movie_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND lower(result) = 'won';",2018-08-28 17:50:51.21381+10,8,1,219,correct
4133,"SELECT *
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film' AND o.result='Won';",2018-08-28 17:51:33.111086+10,8,0,338,partially correct
4134,"select x3.id from (select id, count(distinct title) as total 
from (select id, title, production_year from director union select id, title, production_year from writer) as x1
group by id) as x3 where x3.total =( select max(total) from(
select count(distinct title) as total 
from (select id, title, production_year from director union select id, title, production_year from writer) as x1
group by id) as x2);",2018-08-28 17:51:34.707546+10,14,1,66,correct
4135,"SELECT w.title, w.production_year
 FROM WRITER w INNER JOIN PERSON p ON w.id = p.id
 WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-28 17:52:38.358016+10,5,1,98,correct
4136,"select Writer.title,Writer.production_year
from person  NATURAL join   Writer 
where  person.first_name=Kevin and person.last_name=Williamson;",2018-08-28 17:53:04.050636+10,5,0,244,noninterpretable
4137,"SELECT o.first_name, o.last_name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film' AND o.result='won';",2018-08-28 17:53:09.43119+10,8,1,338,correct
4138,"SELECT o.first_name, o.last_name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film' AND o.result='won';",2018-08-28 17:53:35.055918+10,8,1,338,correct
4139,"SELECT o.first_name, o.last_name, o.title, o.production_year
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film' AND o.result='won';",2018-08-28 17:53:43.708827+10,8,1,338,correct
4140,"select id from person
where year_born != (select max(year_born) from person)
order by year_born desc
limit 1;",2018-08-28 17:53:50.565769+10,3,1,203,correct
4141,"SELECT o.title, o.production_year, o.first_name, o.last_name
FROM (movie m natural join movie_award ma natural join director natural join person p) AS o
where o.award_name = 'BAFTA Film Award' AND o.category='best film' AND o.result='won';",2018-08-28 17:54:24.452233+10,8,1,338,correct
4142,"select Writer.title,Writer.production_year
from person,Writer 
where  person.id=Writer.id and person.first_name='Kevin' and person.last_name='Williamson';",2018-08-28 17:55:29.749709+10,5,1,244,correct
4143,"SELECT m.title, m.production_year
FROM MOVIE m, WRITER w, PERSON p
WHERE m.title = w.title
AND m.production_year = w.production_year
AND w.id = p.id
AND p.first_name = 'Kevin'
AND p.last_name = 'Williamson';",2018-08-28 17:56:11.04486+10,5,1,199,correct
4144,"with sub as (select id, count(*) total from Director d inner join Movie m on d.production_year = m.production_year and d.title =m.title  UNION
			select id,count(*) total from Writer w inner join Movie m on w.production_year= m.production_year and w.title =m.title)

select id from sub where total = (select max(total) from sub );",2018-08-28 17:56:50.606938+10,14,0,19,partially correct
4145,;,2018-08-28 17:57:36.960181+10,2,0,280,noninterpretable
4146,"select title, production_year
from (person natural join director) as dp
where exists (
select * 
from Movie_Award as ma
where dp.title = ma.title
and dp.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award'
and lower(ma.category) = 'best film'
and ma.result = 'won');
",2018-08-28 17:58:01.737621+10,8,0,347,partially correct
4147,"select id from role where description in (
select description from appearance where title like ""psycho"" and production_year=1960 
group by description 
having count(description)=1) and role.production_year=1960;",2018-08-28 17:58:42.153468+10,10,1,234,correct
4148,"select title, production_year, first_name, last_name
from (person natural join director) as dp
where exists (
select * 
from Movie_Award as ma
where dp.title = ma.title
and dp.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award'
and lower(ma.category) = 'best film'
and ma.result = 'won');
",2018-08-28 17:58:51.658019+10,8,1,347,correct
4149,"SELECT COUNT(*)
FROM person P
WHERE EXISTS (SELECT * FROM writer w
WHERE w.id = p.id
AND year_born = 1935);",2018-08-28 18:00:24.371929+10,1,1,121,correct
4150,"SELECT COUNT(*) AS NUM
FROM (Writer_Award wa natural join person p) as o
where o.last_name='Woody' and o.first_name='Allen' and o.result ='won' and (o.year_of_award=1991 or o.year_of_award=1992
or o.year_of_award=1993 or o.year_of_award=1994 or o.year_of_award=1995);",2018-08-28 18:01:18.321635+10,9,0,338,partially correct
4151,;,2018-08-28 18:02:09.380944+10,7,0,205,noninterpretable
4152,"SELECT Restriction.country
from Restriction join Movie
where Movie.title='Shakespeare in Love';",2018-08-28 18:03:00.127839+10,6,0,244,partially correct
4153,"SELECT pr.id
FROM (SELECT * FROM person,role WHERE person.id=role.id) AS pr, 
(SELECT * FROM movie,scene WHERE movie.title=scene.title AND movie.production_year=scene.production_year) AS ms
WHERE lower(pr.title)=lower(ms.title)=""psycho""
AND pr.production_year=ms.production_year=1960
GROUP BY pr.id HAVING COUNT(ms.scene_no)=1;",2018-08-28 18:03:15.99072+10,10,0,216,partially correct
4154,"with sceneappearno as
(select p.id, count(*) as sceneno from person p natural join role r natural join appearance a
where lower(r.title)='psycho'
and r.production_year=1960 group by p.id
having count(*) = 1)

select s.id from sceneappearno s;",2018-08-28 18:03:51.14427+10,10,1,274,correct
4155,"select title, production_year, first_name, last_name
from (person natural join director) as dp
where exists (
select * 
from Movie_Award as ma
where dp.title = ma.title
and dp.production_year = ma.production_year
and lower(ma.award_name) = lower('BAFTA Film Award')
and lower(ma.category) = lower('Best Film')
and ma.result = 'won');
",2018-08-28 18:04:00.375387+10,8,1,347,correct
4156,"SELECT country
from Restriction
where title='Shakespeare in Love' and description='M';",2018-08-28 18:04:47.129811+10,6,1,244,correct
4157,"SELECT Count(*)
FROM (Writer_Award wa natural join person p) as o
where o.result='won' and o.first_name='Woody' and o.last_name='Allen'and o.year_of_award>=1991 and o.year_of_award<=1995;",2018-08-28 18:06:00.902149+10,9,1,338,correct
4158,"select id,award_name,year_of_award,category from director_award da inner join director d on da.title = d.title
where result !='won';",2018-08-28 18:06:25.071225+10,13,1,203,correct
4159,"SELECT COUNT(*)
FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND lower(result) = 'won' AND year_of_award >=1991 AND year_of_award <= 1995;",2018-08-28 18:06:47.675923+10,9,1,219,correct
4160,"SELECT COUNT (first_name, last_name) FROM person p
WHERE EXISTS (SELECT * FROM director d 
AND SELECT * FROM writer w
WHERE d.id = w.id = p.id)
GROUP BY (first_name, last_name);
",2018-08-28 18:07:07.961233+10,4,0,121,noninterpretable
4161,"select id,first_name,last_name from person p where p.year_born=(select max(year_born) from person);",2018-08-28 18:07:32.132841+10,7,1,205,correct
4162,"SELECT country
FROM RESTRICTION
WHERE title = 'Shakespeare in Love'
AND description = 'M';",2018-08-28 18:08:02.202548+10,6,1,199,correct
4163,"select p.id, p.first_name, p.last_name from person p, director d, writer w 
where p.id = d.id and p.id = w.id and d.id = w.id 
and d.title = w.title and d.production_year = w.production_year
group by p.id having count(p.id) >= 2;",2018-08-28 18:10:28.021731+10,4,1,99,correct
4164,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE  w.id=p.id AND p.first_name=""Kevin"" AND p.last_name= ""Williamson"";",2018-08-28 18:11:59.366084+10,5,1,128,correct
4165,"select first_name, last_name, title, production_year, description from person natural join role where role.id =
(select id from role group by id having count(description)=
( select max(total) from (select id, count(description) as total from role group by id))) ;",2018-08-28 18:12:01.791722+10,15,1,66,correct
4166,"select id,first_name, last_name
from person
where year_born=(select MIN(year_born) from person) ;",2018-08-28 18:13:07.856909+10,7,0,244,partially correct
4167,"select id,first_name, last_name
from person
where year_born=(select MAX(year_born) from person) ;",2018-08-28 18:13:35.323897+10,7,1,244,correct
4168,"with sub as (select id, count(*) as total from (select w.id,w.production_year,w.title from Writer w union select d.id,d.production_year,d.title from Director d ) group by id )

select id from sub where total = (select max(total) from sub as sub1 );",2018-08-28 18:16:07.640557+10,14,1,19,correct
4169,"select  person.id, count(person.id) as count

from person join director on director.id = person.id join writer on writer.id = person.id 

Group by person.id

Order by count desc

limit 1;",2018-08-28 18:16:26.333872+10,14,0,235,partially correct
4170,select p.i d from person p where p.first_name in (select a.title from appearance a where a.title=Psycho group by a.title having count(*)=1);,2018-08-28 18:16:50.063737+10,10,0,258,noninterpretable
4171,"select dw.id, dw.first_name, dw.last_name
from (person p natural join director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-28 18:18:52.427237+10,4,1,121,correct
4172,"SELECT country
FROM restriction r
WHERE lower(title)=""shakespeare in love"" AND upper(description)=""M"";",2018-08-28 18:19:48.500674+10,6,1,128,correct
4173,"SELECT Count(PERSON.id)
FROM PERSON LEFT JOIN DIRECTOR ON PERSON.id=DIRECTOR.id;",2018-08-28 18:22:30.138887+10,12,0,280,partially correct
4174,"select title, production_year from writer w
where exists (select * from person p
where p.id=w.id
and p.first_name=kevin, p.last_name=williamson);",2018-08-28 18:22:32.300745+10,5,0,121,noninterpretable
4175,"Select * from PERSON
where year_born = '1935';",2018-08-28 18:24:00.291904+10,1,0,375,partially correct
4176,"Select * from PERSON
where year_born = '1935';",2018-08-28 18:25:56.524984+10,1,0,375,partially correct
4177,"select id, first_name, last_name
from person
where exists ;",2018-08-28 18:25:56.570384+10,4,0,22,noninterpretable
4178,"SELECT r.id
FROM role r,scene s,appearance a
WHERE r.title=s.title
AND s.title=a.title
AND lower(a.title)=""psycho""
AND r.production_year=s.production_year
AND s.production_year=a.production_year
AND s.production_year=1960
AND s.scene_no=a.scene_no
AND a.description=r.description
GROUP BY r.id HAVING COUNT(*)=1;",2018-08-28 18:25:59.851905+10,10,1,216,correct
4179," ""BAFTA Film Awa;",2018-08-28 18:26:12.628344+10,8,0,205,noninterpretable
4180,"select r.id
from role r
where r.description in(select a.description from appearance a);
",2018-08-28 18:26:53.989706+10,10,0,338,partially correct
4181,"select m.title,m.production_year from(movie m inner join writer w on m.title=w.title inner join person p on w.id=p.id)where first_name='Kevin'and last_name='Williamson';",2018-08-28 18:27:16.897228+10,5,1,317,correct
4182,"select count(*)
from person p
where exists (select * from writer w where w.id = p.id and p.year_born = 1935);
",2018-08-28 18:27:30.300926+10,1,1,375,correct
4183,"select w.title, w.production_year from writer w
where exists (select * from person p
where p.id=w.id
and lower(first_name)='kevin' and lower(last_name)='williamson');",2018-08-28 18:28:30.649158+10,5,1,121,correct
4184,"select id, first_name, last_name
from person
where exists ;",2018-08-28 18:29:46.484659+10,4,0,22,noninterpretable
4185,"select count(*) from movie m
where title not in(
(select title from movie_award ma where ma.title=m.title and ma.production_year=m.production_year) and
(select title from crew_award ca where ca.title=m.title and ca.production_year=m.production_year) and
(select title from director_award da where da.title=m.title and da.production_year=m.production_year) and
(select title from writer_award wa where wa.title=m.title and wa.production_year=m.production_year) and
(select title from actor_award aa where aa.title=m.title and aa.production_year=m.production_year));",2018-08-28 18:31:16.946884+10,11,0,234,partially correct
4186,"select person.first_name, person.last_name, role.title, role.production_year, role.description

from person join role on role.id = person.id 
;

",2018-08-28 18:31:36.396743+10,15,0,235,partially correct
4187,"select p.title, p.production_year, p.first_name, p.last_name
from  Director NATURAL join person NATURAL join Director_Award as p
where 

p.award_name=""BAFTA Film Award"" and p.category='Best Film';",2018-08-28 18:32:47.649764+10,8,0,244,noninterpretable
4188,"select r.id
from role r
where r.title='Psycho'and r.production_year=1960 and r.description in(select a.description from appearance a);
",2018-08-28 18:33:01.915449+10,10,0,338,partially correct
4189,"select sum(*)
where (select count (*))
from movie m
where exists (select * from movie m where 1991 <= m.production_year <= 1993);",2018-08-28 18:34:26.470888+10,2,0,375,noninterpretable
4190,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-28 18:34:52.787547+10,6,1,317,correct
4191,"select count(*) from movie m
where title not in
(select title from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and result like ""won"") and title not in
(select title from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and result like ""won"") and title not in
(select title from director_award da where da.title=m.title and da.production_year=m.production_year and result like ""won"") and title not in
(select title from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and result like ""won"") and title not in
(select title from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and result like ""won"");",2018-08-28 18:35:09.310501+10,11,1,234,correct
4192,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-28 18:35:29.63103+10,10,1,258,correct
4193,"SELECT id,first_name,last_name
FROM PERSON p
WHERE EXIST(SELECT d.id FROM DIRECTOR d
            WHERE EXIST( SELECT w.id FROM WRITER w
			        WHERE(d.id=w.id)
					AND(COUNT(*)>=2));",2018-08-28 18:35:47.869155+10,4,0,280,noninterpretable
4194,"select count(id)
from person
where not exists 
(select d.id from person p inner join director d ON p.id=d.id);",2018-08-28 18:36:39.561618+10,12,0,351,partially correct
4195,select * ;,2018-08-28 18:41:43.410109+10,8,0,157,noninterpretable
4196,"select l.id from
	(select id,count(*) as nums from
		(select d.id,d.title,d.production_year from DIRECTOR as d
		UNION
		select w.id,w.title,w.production_year from WRITER as w)
		group by id) as l
where l.nums in(select MAX(t.nums) from
		(select id,count(*) as nums from
		(select d.id,d.title,d.production_year from DIRECTOR as d
		UNION
		select w.id,w.title,w.production_year from WRITER as w)
		group by id) as t);",2018-08-28 18:41:50.66063+10,14,1,167,correct
4198,"select id, first_name,last_name from person where year_born=(select max(year_born) from person;",2018-08-28 18:42:05.612967+10,7,0,317,noninterpretable
4200,"select id, first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-28 18:42:48.302092+10,7,1,317,correct
4201,"select count(id)
from person p
where not exists 
(select p.id from director d where p.id=d.id);",2018-08-28 18:43:57.025854+10,12,1,351,correct
4202,"select count(id)
from person p
where not exists 
(select id from director d where p.id=d.id);",2018-08-28 18:44:34.486246+10,12,1,351,correct
4203,"with sub as (select id,title,production_year,description,count(*) as total from(
select r.id,r.title,r.production_year,r.description from Role r group by id,title,production_year,description))
select first_name,last_name,title,production_year,description from sub inner join Person p on p.id=sub.id where total = (select max(total) from sub as sub1) ;

",2018-08-28 18:44:35.027637+10,15,0,19,partially correct
4204,"select count(*) as number 
	from WRITER, PERSON
		where PERSON.id = WRITER.id  and PERSON.year_born = '1935';",2018-08-28 18:44:55.552302+10,1,0,167,partially correct
4205,"
with writer_1935 as
(select distinct w.id
from person p natural join writer w
where year_born = '1935')

select count(*)
from writer_1935;",2018-08-28 18:45:22.342259+10,1,1,170,correct
4206,"select count(year_born)
from writer 
inner join person
where year_born>1935;",2018-08-28 18:45:38.770317+10,1,0,18,partially correct
4208,"select count(year_born)
from writer 
inner join person
where year_born>1935;",2018-08-28 18:45:42.014724+10,1,0,18,partially correct
4209,"
with writer_1935 as
(select distinct w.id
from person p natural join writer w
where year_born = '1935')

select count(*)
from writer_1935;",2018-08-28 18:45:56.256533+10,1,1,170,correct
4210,"select  m.title, m.production_year, p.first_name, p.last_name
from (person p natural join director d natural join movie_award m)
where award_name='BAFTA Film Award' and lower(category)= 'best film' and lower(RESULT)= 'won';",2018-08-28 18:46:45.447479+10,4,0,270,partially correct
4211,"select  m.title, m.production_year, p.first_name, p.last_name
from (person p natural join director d natural join movie_award m)
where award_name='BAFTA Film Award' and lower(category)= 'best film' and lower(RESULT)= 'won';",2018-08-28 18:47:42.200396+10,4,0,270,partially correct
4212,"select count(*) from PERSON as p
	where p.id in(select w.id from WRITER as w) and p.year_born = '1935';",2018-08-28 18:48:18.112574+10,1,1,167,correct
4213,"select title, production_year
from writer 
where exists (select * from person where first_name = 'Kevin' and last_name = 'Williamson');



",2018-08-28 18:48:20.374591+10,5,0,22,partially correct
4214,"select title, production_year from movie natural join person where id='00000402';",2018-08-28 18:50:56.518965+10,5,0,137,partially correct
4215,"with number as (select id, count(*) as total from Role r group by id)
select first_name,last_name,title,production_year,description from Person p inner join Role r on r.id=p.id 
inner join number as no on no.id=r.id where no.total = (select max(total) from number na); ",2018-08-28 18:51:31.19294+10,15,1,19,correct
4216,"select m.production_year,count(*)as numbers from MOVIE as m
	where m.production_year = '1993' or m.production_year = '1992' or m.production_year = '1991'
	group by m.production_year;",2018-08-28 18:52:40.001167+10,2,1,167,correct
4217,"select title, production_year from writer natural join person where first_name='Kevin' AND last_name='Williamson';",2018-08-28 18:53:41.282513+10,5,1,137,correct
4218,"select p.title, p.production_year, person.first_name, person.last_name
from  person,director ,(select * from Movie_Award
                        where award_name='BAFTA Film Award' and category='Best Film' and result='won') as p


where person.id=director.id and p.title=director.title and p.production_year=director.production_year;
      ",2018-08-28 18:54:48.185429+10,8,0,244,partially correct
4219,"select count(*) as number from PERSON as p
where p.id not in (select d.id from DIRECTOR as d);",2018-08-28 18:55:00.728014+10,12,1,167,correct
4220,"select title, production_year
from writer 
nature join person
where first_name = 'Kevin' and last_name = 'Williamson';




",2018-08-28 18:55:28.683279+10,5,0,22,partially correct
4221,"select title, production_year
from writer natural join person
where first_name = 'Kevin' and last_name = 'Williamson';




",2018-08-28 18:56:21.229271+10,5,1,22,correct
4222,"select production_year, count(*)
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-28 18:56:40.066308+10,2,1,170,correct
4223,"select d.title,d.production_year,first_name,last_name from (director d inner join movie_award m on m.title=d.title inner join person p on d.id=p.id) where result='won'and award_name='BAFTA Film Award' and category='best film';",2018-08-28 18:57:56.439955+10,8,1,317,correct
4224,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM (
        SELECT title,production_year
        FROM movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;
      ",2018-08-28 19:01:16.755465+10,8,1,244,correct
4225,"SELECT id,first_name,last_name, MAX(year_born)
FROM person;",2018-08-28 19:01:59.248213+10,7,0,128,partially correct
4226,"select id, first_name, last_name from person where year_born <=
( select min(year_born) from person);",2018-08-28 19:02:23.38218+10,7,0,137,partially correct
4227,"select p.id, first_name,last_name
from person p
where p.id IN 
(select d.id 
from director d inner join writer w on d.id=w.id);",2018-08-28 19:03:16.187485+10,4,0,351,partially correct
4228,"select id, first_name, last_name from person where year_born >=
( select min(year_born) from person);",2018-08-28 19:04:25.511189+10,7,0,137,partially correct
4229,"select p.id, first_name,last_name
from person p
where p.id IN 
(select d.id 
from director d inner join writer w on d.id=w.id
group by d.id
having count(d.id)>1);",2018-08-28 19:04:25.544617+10,4,0,351,partially correct
4230,select count(*) from (writer_award w inner join person p on w.id=p.id) where w.id=(select id from person where first_name='Woody' and last_name='Allen');,2018-08-28 19:05:29.5307+10,9,0,317,partially correct
4231,"select p.id, first_name,last_name
from person p
where p.id IN 
(select d.id 
from director d inner join writer w on d.id=w.id
group by d.id
having count(d.id)>2);",2018-08-28 19:06:11.787928+10,4,1,351,correct
4232,select count(*) from (writer_award w inner join person p on w.id=p.id) where w.id=(select id from person where first_name='Woody' and last_name='Allen') and result='won';,2018-08-28 19:06:55.778264+10,9,1,317,correct
4233,"select count(*)
from person p
where p.id not in (select p.id
from person p natural join director d);",2018-08-28 19:07:35.942357+10,12,1,170,correct
4234,"select id, first_name, last_name from person where year_born >=
( select max(year_born) from person);",2018-08-28 19:07:51.947137+10,7,1,137,correct
4235,"select count(*)
from person p
where p.id not in (select p.id
from person p natural join director d);",2018-08-28 19:08:43.184821+10,12,1,170,correct
4236,"SELECT id,first_name,last_name
FROM(SELECT id,first_name,last_name,MAX(year_born)
FROM person);",2018-08-28 19:08:50.102785+10,7,1,128,correct
4237,"select country from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-28 19:09:35.97555+10,6,1,121,correct
4238,"select p.id,p.first_name,p.last_name from PERSON as p
where p.id in
		(select d.id from DIRECTOR as d, WRITER as w
			where d.id = w.id and d.title = w.title and d.production_year = w.production_year
			group by d.id
			having count(*)>=2);",2018-08-28 19:10:47.269616+10,4,1,167,correct
4239,"select m.title,
m.production_year,
first_name,last_name
from 
(select title,production_year from movie_award
where lower(award_name)= 'bafta film award' and
lower(category)='best film' and lower(result) ='won'
)as m,person as p,director as d

where p.id=d.id and d.title =m.title and d.production_year =m.production_year;",2018-08-28 19:12:19.752368+10,8,1,149,correct
4240,"select w.title,w.production_year
	from WRITER as w, PERSON as p
		where p.id = w.id and p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-28 19:13:32.279662+10,5,1,167,correct
4241,"select id, first_name, last_name from person
where year_born;",2018-08-28 19:14:25.516659+10,7,0,121,partially correct
4242,"select country from RESTRICTION
where lower(title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-28 19:15:35.408426+10,6,1,167,correct
4243,"select count(*)
from Writer_Award,(select title from person,Writer
where person.id=writer.id and person.first_name='Woody' and person.last_name='Allen')

where year_of_award>=1991 and year_of_award<=1995;",2018-08-28 19:15:35.57046+10,9,0,244,partially correct
4244,"select count(*)
from Writer_Award,(select title from person,Writer
where person.id=writer.id and person.first_name='Woody' and person.last_name='Allen')

where year_of_award>=1991 and year_of_award<=1995;",2018-08-28 19:16:09.77308+10,9,0,244,partially correct
4245,"select id, first_name, last_name from person
where year_born =
(select max(year_born) from person);",2018-08-28 19:17:17.305894+10,7,1,121,correct
4246,"select id, first_name, last_name from PERSON
	order by year_born DESC
	limit 1;",2018-08-28 19:17:27.864719+10,7,1,167,correct
4247,"select m.title, m.production_year, p.first_name, p.last_name from (person p natural join director d natural join movie_award m) where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';",2018-08-28 19:18:42.034527+10,8,1,270,correct
4248,select *;,2018-08-28 19:18:56.739131+10,14,0,157,noninterpretable
4249,"select count(*)
from (select id from writer_award as w natural join person as p where
w.id= p.id
and lower(p.first_name)='woody' and lower(p.last_name)='allen' and w.year_of_award between 1991 and 1995
);
",2018-08-28 19:18:59.095296+10,9,0,149,partially correct
4250,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma, person p, director d
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND p.id=d.id
AND lower(award_name)='bafta film award'
AND lower(category)='best film'
AND lower(result)='won';",2018-08-28 19:22:01.678491+10,8,1,124,correct
4251,"
	
select count(*) from person as p where not exists( select * from director as d where p.id=d.id);",2018-08-28 19:22:05.173737+10,12,1,91,correct
4252,"select production_year,count(*) as corresponding_numbers from movie
where production_year=1993 or production_year=1992 or production_year=1993
group by production_year;",2018-08-28 19:22:12.218302+10,2,0,18,partially correct
4253,select count(*) from person as p where not exists( select * from director as d where p.id=d.id); ,2018-08-28 19:22:25.269116+10,12,1,91,correct
4254,"select count(*)
from (select * from writer_award as w natural join person as p where 
w.id= p.id
and lower(p.first_name)='woody' and lower(p.last_name)='allen' and w.year_of_award between 1991 and 1995 and lower(result)='won'
) as aw;
",2018-08-28 19:22:48.770119+10,9,1,149,correct
4255,"select production_year,count(*) from movie
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-28 19:22:54.822905+10,2,1,18,correct
4256,"select dw.id, dw.first_name, dw.last_name
from (person p natural join writer w natural join director d)as dw
group by dw.id
having count(dw.id)>1;",2018-08-28 19:23:14.900357+10,4,1,351,correct
4257,"with dir_wri as
(select d.id, COUNT(*) as NoOfProduct
from director d natural join writer w
group by d.id)

select p.id, p.first_name, p.last_name
from dir_wri natural join person p
where dir_wri.NoOfProduct > 1;


",2018-08-28 19:23:19.719058+10,4,1,170,correct
4258,"select count(*)
from Writer_Award,writer,person

where year_of_award>=1991 and year_of_award<=1995 and 
person.id=writer.id and first_name='Woody' and last_name='Allen' and writer.title=writer_award.title and 
writer.production_year=writer_award.production_year and writer_award.id=writer.id and writer_award.result='won';",2018-08-28 19:23:37.981539+10,9,1,244,correct
4259,"with dir_wri as
(select d.id, COUNT(*) as NoOfProduct
from director d natural join writer w
group by d.id having count(*)>1)

select p.id, p.first_name, p.last_name
from dir_wri natural join person p;


",2018-08-28 19:24:08.857378+10,4,1,170,correct
4260,"
select ma.title, ma.production_year, p.first_name, p.last_name from PERSON as p, DIRECTOR as d,MOVIE_AWARD as ma
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year
	and lower(ma.award_name) = 'bafta film award' and lower(category) = 'best film';",2018-08-28 19:26:06.08102+10,8,0,167,partially correct
4261,"

select title, production_year
from writer
where id = (select id 
            from person
			where first_name = 'Kevin' and last_name = 'Williamson');",2018-08-28 19:27:34.224827+10,5,1,170,correct
4262,"
select ma.title, ma.production_year, p.first_name, p.last_name from PERSON as p, DIRECTOR as d,MOVIE_AWARD as ma
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year
	and lower(ma.award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-28 19:28:05.118739+10,8,1,167,correct
4263,"select count(*)
from person p
where exists(select *
             from writer w
                where w.id=p.id
                AND p.year_born=1935);",2018-08-28 19:29:20.564641+10,1,1,79,correct
4264,"select m.production_year, count(*)
from movie m
where m.production_year>1990
AND m.production_year<1994

group by m.production_year;",2018-08-28 19:30:10.708342+10,2,1,79,correct
4265,"SELECT country
 FROM RESTRICTION
WHERE title = ""Shakespeare in Love"" AND description = 'M';",2018-08-28 19:30:45.135395+10,6,1,98,correct
4266,"select distinct country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-28 19:31:02.192028+10,6,1,170,correct
4267,"select count(*)
from person p
where not exists (select *
                    from  director d
                   where p.id=d.id);",2018-08-28 19:31:16.472151+10,12,1,79,correct
4268,"select count(*)
from person p
where p.id not in (select d.id
                    from  director d
                   where p.id=d.id);",2018-08-28 19:31:43.111801+10,12,1,79,correct
4269,"select a.title,a.production_year,p.first_name,p.last_name
from(select title, production_year from movie_award c where    lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS a, director b ,person  p 
where a.title=b.title and a.production_year=b.production_year and b.id=p.id;",2018-08-28 19:32:16.43952+10,8,1,205,correct
4270,"select count(*) as number from WRITER_AWARD as wa
	where wa.id in(select p.id from PERSON as p
				where p.first_name = 'Woody' and p.last_name = 'Allen')
				and wa.year_of_award >='1991' and wa.year_of_award <='1995'
				and lower(result) = 'won';",2018-08-28 19:32:47.005028+10,9,1,167,correct
4271,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id 
group by p.id
having count(*)>1;",2018-08-28 19:33:37.022452+10,4,1,79,correct
5015,"SELECT COUNT(id)
FROM PERSON
WHERE NOT id IN (SELECT id FROM WRITER)
GROUP BY NULL;",2018-08-29 14:10:57.001174+10,12,0,392,partially correct
4272,"SELECT id, first_name, last_name
 FROM PERSON
WHERE year_born = (SELECT MIN(year_born) FROM PERSON );",2018-08-28 19:34:07.316187+10,7,0,98,partially correct
4273,"SELECT id, first_name, last_name
 FROM PERSON
WHERE year_born = (SELECT MAX(year_born) FROM PERSON );",2018-08-28 19:34:50.575977+10,7,1,98,correct
4274,"select id, first_name, last_name
from person
where year_born = (select min(year_born)
                   from person);",2018-08-28 19:34:54.590853+10,7,0,170,partially correct
4275,"select m.title, m.production_year
from movie m, writer w,person p
where m.title=w.title
AND m.production_year=w.production_year 
AND w.id=p.id
AND lower(p.first_name)='kevin'
AND lower(p.last_name)='williamson';

",2018-08-28 19:35:30.727964+10,5,1,79,correct
4276,"SELECT w.title, w.production_year
FROM WRITER w;
",2018-08-28 19:35:47.544443+10,5,0,280,partially correct
4277,"select pw.title, pw.production_year
from (person p natural join writer w)as pw
group by pw.id
having pw.first_name='Kevin' and pw.last_name='Williamson';",2018-08-28 19:36:33.812082+10,5,0,351,partially correct
4278,"select id
from role, scene

where scene_no=1 and scene.title=role.title and scene.production_year=role.production_year 
and role.production_year=1960 and lower(role.title)= Psycho;",2018-08-28 19:37:24.937589+10,10,0,244,noninterpretable
4279,"select pw.title, pw.production_year
from (person p natural join writer w natural join movie m)as pw
group by pw.id
having p.first_name='Kevin' and p.last_name='Williamson';",2018-08-28 19:37:48.792986+10,5,0,351,partially correct
4280,"select id, first_name, last_name
from person
where year_born = (select max(year_born)
                   from person);",2018-08-28 19:38:02.766605+10,7,1,170,correct
4281,"select r.country
from restriction r
where lower(r.title)= 'shakespeare in love'
AND lower(r.description)='m';

",2018-08-28 19:38:04.82462+10,6,1,79,correct
4282,"select first_name,last_name
from role as r ,person as p
where lower(r.title) ='psycho produced' and production_year = 1960 
and r.id = p.id;",2018-08-28 19:38:37.687879+10,10,0,149,partially correct
4283,select * from (role r inner join appearance a on r.title=a.title)where r.title='Psycho'and r.production_year=1960 group by scene_no;,2018-08-28 19:38:41.411598+10,10,0,317,partially correct
4284,"SELECT w.title, w.production_year
FROM WRITER w
WHERE EXISTS(SELECT* 
             FROM PERSON p
             WHERE w.id=p.id
	        AND lower(first_name)='kevin'
	        AND lower(last_name)='williamson');
",2018-08-28 19:39:09.888162+10,5,1,280,correct
4285,"select r.id from ROLE as r
where r.description in
			(select a.description from APPEARANCE as a
				where lower(a.title) = 'psycho' and a.production_year = '1960'
				group by a.description
				having count(*) = 1)
			and lower(r.title) = 'psycho' and r.production_year = '1960';",2018-08-28 19:39:19.895612+10,10,1,167,correct
4286,"select dintinct p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born)
                  from person p);
",2018-08-28 19:40:08.518021+10,7,0,79,noninterpretable
4287,"select  p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born)
                  from person p);
",2018-08-28 19:40:54.954178+10,7,1,79,correct
4288,"SELECT * country FROM restriction r 
WHERE 
description = 'M'
AND title = Shakespeare in Love;",2018-08-28 19:40:56.702414+10,6,0,362,noninterpretable
4289,"select count(*) from person p, Writer_Award w where p.id=w.id and p.first_name='Woody' and p.last_name='Allen' 
and w.year_of_award>=1991 and w.year_of_award<=1995 and lower(result)='won';",2018-08-28 19:41:05.652113+10,9,1,205,correct
4290,"SELECT * country FROM restriction r 
WHERE 
description = 'M'
AND lower(title) = lower (shakespeare in love);",2018-08-28 19:42:19.153663+10,6,0,362,noninterpretable
4291,"select a.title, a.production_year, p.first_name, p.last_name 
from Movie_Award a, Director d, Person p where 
a.award_name='BAFTA Film Award'AND a.category ='best film' AND
d.title = a.title AND d.production_year = a.production_year AND
p.id = d.id;
",2018-08-28 19:43:19.763413+10,8,0,137,partially correct
4292,"select ma.title, ma.production_year, p.first_name, p.last_name
from  Movie_Award ma, director d,person p
where p.id=d.id
AND ma.title=d.title
AND d.production_year=ma.production_year
AND lower(ma.result)='won'
AND lower(ma.category)= 'best film'
And lower(ma.award_name)='bafta film award';",2018-08-28 19:43:26.564759+10,8,1,79,correct
4293,"SELECT country
FROM restriction 
WHERE 
description = 'M'
AND lower(title) = 'shakespeare in love';",2018-08-28 19:44:27.677486+10,6,1,362,correct
4294,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name
 FROM MOVIE_AWARD ma NATURAL JOIN DIRECTOR d NATURAL JOIN PERSON p 
WHERE LOWER(ma.award_name) = 'bafta film award' AND LOWER(ma.category) = 'best film';",2018-08-28 19:45:55.142389+10,8,0,98,partially correct
4295,"SELECT r.country
FROM RESTRICTION r
WHERE EXISTS(SELECT*
             FROM MOVIE m
	       WHERE r.title=m.title
		  AND lower(title)='shakespeare in love'
		  AND lower(description)='m');
     ",2018-08-28 19:46:49.591418+10,6,1,280,correct
4296,"select count(*) 
from writer_award wa
where wa.id=(select p.id
                 from person p
                 where lower(p.first_name)='woody'
                 AND lower(p.last_name)='allen')
    AND wa.year_of_award>1990
    AND wa.year_of_award<1996;",2018-08-28 19:48:08.20356+10,9,0,79,partially correct
4297,"SELECT DISTINCT ma.title, ma.production_year, p.first_name, p.last_name
 FROM MOVIE_AWARD ma NATURAL JOIN DIRECTOR d NATURAL JOIN PERSON p 
WHERE LOWER(ma.award_name) = 'bafta film award' AND LOWER(ma.category) = 'best film' AND LOWER(ma.result) = 'won';",2018-08-28 19:49:09.678531+10,8,1,98,correct
4298,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
GROUP BY year_born
HAVING MAX(year_born);",2018-08-28 19:50:36.778285+10,7,0,280,partially correct
4299,"select count(*) 
from writer_award wa
where wa.id=(select p.id
                 from person p
                 where lower(p.first_name)='woody'
                 AND lower(p.last_name)='allen')
    AND wa.year_of_award>1990
    AND wa.year_of_award<1996
    AND lower(wa.result)='won';",2018-08-28 19:51:01.355881+10,9,1,79,correct
4300,"select 
     r.id
from 
    appearance a,
    role r,
    scene s
where s.title = a.title
AND s.title = r.title
ANd r.production_year = a.production_year
AND s.production_year = r.production_year
AND a.production_year=s.production_year
AND s.scene_no=a.scene_no
AND lower(a.title) = 'psycho'
AND a.production_year = 1960
AND a.description=r.description
group by r.id
having count(*)=1;


",2018-08-28 19:52:54.066591+10,10,1,79,correct
4301,select scene_no from appearance;,2018-08-28 19:53:55.045867+10,10,0,205,partially correct
4302,"select count(*) as number from MOVIE as m
where not exists
(select ma.title,ma.production_year from MOVIE_AWARD as ma
where lower(result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
select ca.title,ca.production_year from CREW_AWARD as ca
where lower(result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
select da.title,da.production_year from DIRECTOR_AWARD as da
where lower(result) = 'won'and da.title = m.title and da.production_year = m.production_year
UNION
select wa.title,wa.production_year from WRITER_AWARD as wa
where lower(result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
UNION
select aa.title,aa.production_year from ACTOR_AWARD as aa
where lower(result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);",2018-08-28 19:54:33.557837+10,11,1,167,correct
4303,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE p.year_born=(SELECT Max(year_born)
                   FROM PERSON p);",2018-08-28 19:54:35.976714+10,7,1,280,correct
4304,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
 FROM (SELECT title, production_year FROM MOVIE_AWARD WHERE
        LOWER(AWARD_NAME) = 'bafta film award' AND LOWER(category) = 'best film' AND LOWER (result) = 'won') AS ma,
	DIRECTOR d, PERSON p
WHERE ma.title = d.title
 AND ma.production_year = d.production_year
 AND d.id = p.id;",2018-08-28 19:54:57.761593+10,8,1,98,correct
4305,"select count(DISTINCT person.id) 
from person, writer
where person.id = writer.id and person.year_born = '1935'
group by person.id;",2018-08-28 19:57:44.363061+10,1,1,111,correct
4306,"select p.id from PERSON as p
group by p.year_born
order by p.year_born DESC
limit 1,1;",2018-08-28 19:58:02.107828+10,3,1,167,correct
4307,"SELECT r.id FROM
ROLE r, scene s, appearance a
WHERE r.title = s.title
AND s.title = a.title
AND r.description = a.description 
AND a.scene_no = s.scene_no
AND s.production_year = a. production_year
AND s.production_year = r.production_year
AND a.production_year = 1960
AND lower(s.title) = 'psycho'
GROUP By r.id HAVING COUNT(*)=1;",2018-08-28 19:59:21.165769+10,10,1,218,correct
4308,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where lower(da.result)='nominated'
AND d.title=da.title
AND d.production_year=da.production_year

AND d.title not in (select da.title
                   from director_award da
                    where d.title=da.title
                     AND d.production_year=da.production_year
                     AND lower(da.result)='won');
",2018-08-28 19:59:23.193946+10,13,1,79,correct
4309,"select count(*)
from person
where year_born='1935';",2018-08-28 20:00:10.57109+10,1,0,223,partially correct
4310,"select 
	id
from
	scene s,
	role r,
	appearance a
where
	s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no=a.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description =r.description
	and r.title ='Psycho'
	and r.production_year='1960'
group by r.id
having count(*)=1;


",2018-08-28 20:00:56.802364+10,10,1,149,correct
4311,"select count(*) 
from writer_award wa
where wa.id=(select p.id
                 from person p
                 where lower(p.first_name)='woody'
                 AND lower(p.last_name)='allen')
    AND wa.year_of_award>1990
    AND wa.year_of_award<1996
    AND lower(wa.result)='won';",2018-08-28 20:01:06.077086+10,9,1,79,correct
4312,"select count(*) from writer_award,writer, person where first_name='Woody' AND last_name='Allen' AND year_of_award IN (1991,1995);",2018-08-28 20:02:25.553111+10,9,0,137,partially correct
4313,"Select role.id
from role natural join appearance
Where lower(appearance.title)='psycho' AND appearance.production_year=1960;
",2018-08-28 20:02:46.687327+10,10,0,83,partially correct
4314,"SELECT id first_name,last_name
FROM person WHERE EXISTS(
SELECT COUNT(title) FROM writer,director WHERE(person.id=director.id));",2018-08-28 20:03:07.801692+10,4,0,372,noninterpretable
4315,"select id from PERSON
where PERSON.year_born in
(select p.year_born from PERSON as p
group by p.year_born
order by p.year_born DESC
limit 1,1);
",2018-08-28 20:05:09.07455+10,3,1,167,correct
4316,"SELECT COUNT(*)
 FROM WRITER_AWARD wa NATURAL JOIN WRITER w NATURAL JOIN PERSON p
 WHERE LOWER(p.first_name) = 'woody'AND LOWER(p.last_name) = 'allen' AND year_of_award >= '1991'AND year_of_award <= 1995;",2018-08-28 20:05:56.902872+10,9,0,98,partially correct
4317,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-28 20:06:26.282688+10,9,1,98,correct
4318," select id from(select id,max(year_born) from person where year_born not in (select max(year_born)from person));",2018-08-28 20:06:28.943516+10,3,1,234,correct
4319,"SELECT a.title, a.production_year
FROM MOVIE_AWARD a;
",2018-08-28 20:07:52.672675+10,8,0,280,partially correct
4320,"SELECT COUNT(*)
 FROM WRITER_AWARD wa NATURAL JOIN WRITER w NATURAL JOIN PERSON p
 WHERE LOWER(p.first_name) = 'woody'AND LOWER(p.last_name) = 'allen' AND year_of_award >= '1991'AND year_of_award <= 1995 AND LOWER(wa.result) = 'won';",2018-08-28 20:07:53.375002+10,9,1,98,correct
4321,"select pw.title, pw.production_year
from (person p inner join writer w on p.id=w.id)as pw
group by pw.id
having pw.first_name='Kevin' and pw.last_name='Williamson';",2018-08-28 20:08:05.201573+10,5,0,351,partially correct
4322,"select count(id) from person p
where exists(select id from director d where d.id=p.id);",2018-08-28 20:09:11.076916+10,12,0,18,partially correct
4323,"select count(id) from person p
where not exists(select id from director d where d.id=p.id);",2018-08-28 20:09:47.269247+10,12,1,18,correct
4324,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);

",2018-08-28 20:09:49.118831+10,1,1,20,correct
4325,"select count(*)
from person p
where (select w.id from writer where w.id=p.id and p.year_born='1935');",2018-08-28 20:11:06.42406+10,1,0,223,noninterpretable
4326,"SELECT production_year, count(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-28 20:11:55.439997+10,2,1,111,correct
4327,"select count(*)
from person p
where (select w.id from writer w where w.id=p.id and p.year_born='1935');",2018-08-28 20:12:09.271462+10,1,1,223,correct
4328,"SELECT production_year, count(*)
FROM movie
WHERE production_year  IN (1993,1992,1991)
GROUP BY production_year;",2018-08-28 20:13:20.41163+10,2,1,111,correct
4329,"Select production_year,count(*)
from MOVIE
where production_year = 1992 or production_year = 1993 or production_year = 1991

group by production_year;
",2018-08-28 20:14:23.29046+10,2,1,154,correct
4330,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;
",2018-08-28 20:15:56.711825+10,2,1,20,correct
4331,SELECT COUNT(*) FROM (SELECT title as title from person as p left join director as d on p.id=d.id) where title is NULL;,2018-08-28 20:17:55.726906+10,12,1,111,correct
4332,"select title, production_year
from person p, writer w 
where p.id=w.id and p.first_name='Kevin' and p.last_name='Williamson';",2018-08-28 20:18:20.272765+10,5,1,351,correct
4333,"select m.production_year, count(*)
from movie m
where  m.production_year='1993' and  m.production_year='1992' and  m.production_year='1991';",2018-08-28 20:19:50.017853+10,2,0,223,partially correct
4334,"SELECT COUNT (p.id) from person as p
where not exists (select d.id from director as d where p.id = d.id);",2018-08-28 20:20:36.774659+10,12,1,111,correct
4335,"select m.production_year, count(*)
from movie m
where  m.production_year>1990 and  m.production_year<1994
group by  production_year;",2018-08-28 20:21:32.805841+10,2,1,223,correct
4336,"select l.id , a.award_name, a.year_of_award,a.category from  (select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year
and lower(da.result) = 'nominated')as l, DIRECTOR_AWARD as a
where l.id not in 
(select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year
and lower(da.result) = 'won');
",2018-08-28 20:22:17.92954+10,13,0,167,partially correct
4337,"select country
from movie
where title='Shakespeare in Love' and 'major_genra'='M';",2018-08-28 20:23:17.944909+10,6,0,351,partially correct
4338,"select country
from restriction
where title='Shakespeare in Love' and 'description'='M';",2018-08-28 20:24:12.412446+10,6,0,351,partially correct
4339,"select country
from restriction
where title='Shakespeare in Love' and description='M';",2018-08-28 20:24:50.706541+10,6,1,351,correct
4340,"SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);",2018-08-28 20:29:04.390877+10,1,1,368,correct
4341,"select count(*)
from person as p 
where not exit(select p.id from p,Director d where p.id=d.id);",2018-08-28 20:31:35.492089+10,12,0,223,noninterpretable
4342,"select count(*)
from person as p 
where not exists(select p.id from Director d where p.id=d.id);",2018-08-28 20:32:42.311734+10,12,1,223,correct
4343,"SELECT p.id, p.first_name, p.last_name from person as p NATURAL JOIN (SELECT d.id as id from 
director as d NATURAL JOIN writer as d group by d.id having count(d.id) >= 2);",2018-08-28 20:33:46.324185+10,4,1,111,correct
4344," select person.id, first_name,last_name from person,
 ( 
 
 select d.id,count(*) 
from director as d
 where exists
 (
 select id 
 from writer as w 
 where d.id=w.id and d.title=w.title and d.production_year=w.production_year
 ) 
 group by d.id
 
 as foo
 
 where person.id=foo.id and foo.count(*)>2;",2018-08-28 20:34:09.083842+10,4,0,91,noninterpretable
4345,"select m.production_year, count(*)
from movie m
where  m.production_year='1991' or  m.production_year='1992' or m.production_year='1993'
group by  production_year;",2018-08-28 20:34:57.996596+10,2,1,223,correct
4528,"select dw.id,dw.first_name,dw.last_name
from (person p natural join director d natural join writer w)dw
group by dw.id
having count(*)>1;
",2018-08-28 22:42:25.107919+10,4,1,20,correct
4346,"SELECT COUNT(*)
FROM WRITER_AWARD a,WRITER w
WHERE EXISTS(SELECT *
      FROM PERSON p
	  WHERE w.id=p.id
	  AND lower(first_name)='woody'
	  AND lower(last_name)='allen')
AND a.title=w.title
AND year_of_award>=1991
AND year_of_award<=1995;",2018-08-28 20:35:00.759937+10,9,0,280,partially correct
4347,"SELECT p.id
FROM PERSON p
WHERE p.id IN (
 SELECT p.id FROM PERSON p NATURAL JOIN APPEARANCE a NATURAL JOIN ROLE r
  WHERE LOWER(a.title) = 'psycho' AND a.production_year = 1960
 GROUP BY p.id
 HAVING COUNT(p.id)=1);",2018-08-28 20:36:04.668345+10,10,1,98,correct
4348,"SELECT id
FROM role
WHERE description IN
(SELECT a.description
FROM appearance a
WHERE lower(a.title) = 'psycho' AND a.production_year = 1960
GROUP BY a.description HAVING COUNT(*) = 1) AND lower(title) = 'psycho' AND production_year = 1960;",2018-08-28 20:36:48.577632+10,10,1,219,correct
4349,"select id,first_name,last_name from person p
where exists(select*from writer w,director d where d.id=p.id and w.id=p.id)
;",2018-08-28 20:37:22.083921+10,4,0,18,partially correct
4350,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-28 20:37:41.639208+10,9,1,110,correct
4351,"SELECT p.id, p.first_name, p.last_name from person as p where p.id in 
(SELECT d.id from director as d natural join writer w group by d.id having count(d.id)>=2);",2018-08-28 20:37:54.038865+10,4,1,111,correct
4352,"select id, first_name, last_name
from person
group by year_born
having MAX(year_born);",2018-08-28 20:38:35.862563+10,7,0,351,partially correct
4353,"select id, first_name, last_name
from person p
where p.year_born=(select max(year_born) from person);
",2018-08-28 20:39:56.110787+10,7,1,351,correct
4354,"SELECT count(*)
FROM Movie
WHERE NOT EXISTS
(SELECT result FROM movie_award ma
WHERE (SELECT result FROM Crew_award ca
WHERE (SELECT result FROM Director_award da
WHERE (SELECT result FROM Writer_award wa
WHERE (SELECT result FROM Actor_award aa
WHERE lower(ma.result) = 'won'
OR lower(ca.result) = 'won'
OR lower(da.result) = 'won'
OR lower(wa.result) = 'won'
OR lower(aa.result) = 'won')))));",2018-08-28 20:41:15.601736+10,11,0,218,partially correct
4355,"SELECT count(*)
FROM Movie
WHERE NOT EXISTS
(SELECT result FROM movie_award ma
WHERE (SELECT result FROM Crew_award ca
WHERE (SELECT result FROM Director_award da
WHERE (SELECT result FROM Writer_award wa
WHERE (SELECT result FROM Actor_award aa
WHERE lower(ma.result) = 'won'
OR lower(ca.result) = 'won'
OR lower(da.result) = 'won'
OR lower(wa.result) = 'won'
OR lower(aa.result) = 'won')))));",2018-08-28 20:41:15.779106+10,11,0,218,partially correct
4356," 
 select person.id, first_name,last_name from person,
 ( 
 
select d.id,count(*) as c
from director as d
 where exists
 (
 select id 
 from writer as w 
 where d.id=w.id and d.title=w.title and d.production_year=w.production_year
 ) 
 group by d.id
 
 )as foo where person.id=foo.id and c>1;",2018-08-28 20:42:15.519202+10,4,1,91,correct
4357,"SELECT r.id
From scene s, appearance a, role r
WHERE s.title=a.title
  AND s.production_year=a.production_year
  AND s.title=r.title
  AND a.production_year=r.production_year
  AND a.description=r.description
  AND lower(a.title)='psycho'
  AND a.production_year=1960
GROUP BY r.id HAVING COUNT(*)=1;",2018-08-28 20:43:48.97751+10,10,0,272,partially correct
4358,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND s.production_year=r.production_year
  AND s.production_year=a.production_year
  AND a.description=r.description
  AND r.description=s.description
  AND s.scene_no=a.scene_no
  AND lower(s.title)='psycho'
  AND a.production_year=1960
GROUP BY r.id HAVING COUNT(*)=1;",2018-08-28 20:45:56.212347+10,10,0,272,partially correct
4359,"SELECT p.id
FROM PERSON p, APPEARANCE a, ROLE r
WHERE p.id = r.id
 AND a.title = r.title
 AND a.production_year = r.production_year
 AND a.description = r.description
 AND LOWER(a.title) = 'psycho'
 AND a.production_year = 1960
GROUP BY p.id
HAVING COUNT(*) = 1;",2018-08-28 20:46:30.932993+10,10,1,98,correct
4360,"SELECT w.title, w.production_year from writer as w, person as p
where w.id=p.id and p.first_name like 'Kevin' and p.last_name like 'Williamson';",2018-08-28 20:51:47.277109+10,5,1,111,correct
4361,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma,person p,director d
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film'
and lower(result) = 'won';",2018-08-28 20:52:59.751655+10,8,1,109,correct
4362,"SELECT count(*)
FROM Movie m
WHERE NOT EXISTS
(SELECT result FROM movie_award ma
WHERE lower(ma.result)='won' AND ma.title = m.title AND ma.production_year=m.production_year
UNION
SELECT result FROM Crew_award ca
WHERE lower(ca.result) = 'won' AND ca.title = m.title AND ca.production_year=m.production_year
UNION
SELECT result FROM Director_award da
WHERE lower(da.result)='won' AND da.title = m.title AND da.production_year = m.production_year
UNION
SELECT result FROM Writer_award wa
WHERE lower(wa.result)='won' AND wa.title = m.title AND wa.production_year = m.production_year
UNION
SELECT result FROM Actor_award aa
WHERE lower(aa.result)='won' AND aa.title = m.title AND aa.production_year = m.production_year
);",2018-08-28 20:53:36.488712+10,11,1,218,correct
4363,"SELECT r.id
FROM ROLE r
WHERE 1=(SELECT count(*)
      FROM SCENE s
	WHERE r.title=s.title
	AND lower(s.title)='Psycho'
	AND production_year=1960
	GROUP BY s.title
	HAVING count(*)=1);",2018-08-28 20:53:56.902496+10,10,0,280,partially correct
4364,select count(*) from person as p where p.year_born==1935;,2018-08-28 20:54:29.261794+10,1,0,379,noninterpretable
4365,"SELECT id
FROM role
WHERE descroption IN (SELECT description
                      FROM appearance
                      WHERE title = 'Psycho'
                        AND production_year = 1960
                        AND scene_no = 1);",2018-08-28 20:55:01.490362+10,10,0,83,noninterpretable
4366,"select * from director_award da,(select id from director,director_award da where da.title=director.title)
where da.title=director.title; ",2018-08-28 20:55:12.561926+10,13,0,234,noninterpretable
4367,"SELECT id
FROM role
WHERE description IN (SELECT description
                      FROM appearance
                      WHERE title = 'Psycho'
                        AND production_year = 1960
                        AND scene_no = 1);",2018-08-28 20:55:39.576097+10,10,0,83,partially correct
4368,"select t.id
from (scene s natural join role r ) as t
where (select count(*) from t group by t.id)=1 
and lower(t.title)='psycho'
and t.production_year=1960;

",2018-08-28 20:56:12.244025+10,10,0,110,noninterpretable
4369,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;

",2018-08-28 20:57:13.536977+10,10,1,110,correct
4405,"SELECT DISTINCT p.id, p.last_name, p.first_name
FROM person p, director d, writer w
WHERE p.id = d.id AND p.id = w.id AND d.title = w.title
GROUP BY p.id
HAVING COUNT(*) >= 2
;
",2018-08-28 21:29:07.939168+10,4,1,353,correct
4406,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title = da.title and d.production_year = da.production_year and lower(da.result) = 'nominated' and 
d.id not in(
	select d.id 
	from director d, director_award da
	where d.title = da.title and d.production_year = da.production_year and lower(da.result) = 'won');",2018-08-28 21:30:04.349996+10,13,1,109,correct
4370,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 20:58:01.640357+10,11,1,273,correct
4371,"SELECT country from restriction
where title='Shakespeare in Love' and description='M';",2018-08-28 20:58:03.821912+10,6,1,111,correct
4372,"select title, production_year
from moive m, movie_award ma
where m.title=ma.title 
and ma.award_name='BAFTA Film Award' and category='Best Film';
",2018-08-28 20:59:38.076344+10,8,0,351,noninterpretable
4373,"
select title, production_year from writer as w where w.id in (select id from person where lower(first_name)='kevin' and 
 lower(last_name)='williamson');",2018-08-28 21:00:54.515666+10,5,1,91,correct
4374,"select count(*)
from movie m
where not exists(select * from movie, movie_award where m.title=movie_award.title 
and m.production_year = movie_award.production_year and movie_award.result='won');



",2018-08-28 21:02:23.010055+10,11,0,110,partially correct
4375,"SELECT id, first_name, last_name from person where year_born=(SELECT MAX(year_born) from person);",2018-08-28 21:03:23.549445+10,7,1,111,correct
4376,"select d.id,da.award_name,da.year_of_award,da.category from director_award da,(select id from director,director_award da where da.title=director.title and result like ""nominated""),director d
where da.title=d.title and result like ""nominated""; 
",2018-08-28 21:03:47.685582+10,13,1,234,correct
4377,"select p.first_name,p.last_name,r.title, r.production_year,r.description from role r inner join person p
on r.id = p.id
where p.id in (
select r.id from role r 
group by r.id
order by count(*) desc
limit 1);",2018-08-28 21:05:20.758063+10,15,1,203,correct
4378,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);



",2018-08-28 21:06:01.118141+10,11,1,110,correct
4379,"SELECT id, first_name, last_name from person where year_born=(SELECT MAX(year_born) from person);",2018-08-28 21:07:18.995635+10,7,1,111,correct
4380,"SELECT id FROM Person
WHERE year_born = MIN(year_born)+1;",2018-08-28 21:10:43.5239+10,3,0,218,noninterpretable
4381,"select max p.year_born
From person as p
where p.year_born< (select max (p,year_born) from person as p);",2018-08-28 21:11:15.082975+10,3,0,273,noninterpretable
4382,"SELECT count(m.title)
FROM
   MOVIE m;
    
  ",2018-08-28 21:12:17.635412+10,11,0,280,partially correct
4383,"select id
from person
where year_born = (select max(year_born)
From person
where year_born < (select max (year_born) from person));",2018-08-28 21:13:59.990961+10,3,1,273,correct
4384,"select p.id
from person p
where p.year_born<(select max(year_born) from person);",2018-08-28 21:14:04.384175+10,3,0,110,partially correct
4385,"select count(distinct first_name) from Writer as w, Person as p where w.id=p.id and year_born=1935 group by first_name;",2018-08-28 21:14:53.525624+10,1,1,101,correct
4386,"SELECT p.id FROM Person p
WHERE year_born = (SELECT MAX(year_born)
FROM Person WHERE
year_born<(SELECT MAX(year_born) FROM PERSON));",2018-08-28 21:15:03.373118+10,3,1,218,correct
4387,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM 
(SELECT title, production_year 
FROM movie_award WHERE award_name= 'bafta film award' and category= 'best film'and result='won') AS ma,
director AS d,
person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;

",2018-08-28 21:16:00.673904+10,8,0,351,partially correct
4388,"select p.id
from person p
where p.year_born = (select max(year_born) from person 
where year_born < (select max(year_born) from person));",2018-08-28 21:16:29.886426+10,3,1,110,correct
4389,"select *
from (select title,production_year from movie_award where lower(result) = 'won') 
	natural join (select title, production_year from crew_award where lower(result) = 'won')
	natural join (select title, production_year from director_award where lower(result) = 'won')
	natural join (select title, production_year from writer_award where lower(result) = 'won')
	natural join (select title, production_year from actor_award where lower(result) = 'won')
;
",2018-08-28 21:16:40.73924+10,11,0,219,partially correct
4390,"SELECT p.id
FROM PERSON p;
",2018-08-28 21:17:39.956928+10,3,0,280,partially correct
4391,"(select id 
from person
where year_born >= (select year_born from person))
except
(select id 
from person
where year_born < (select max(year_born) from person));
",2018-08-28 21:18:11.293559+10,3,0,109,noninterpretable
4392,"select title, production_year from writer as w where w.id in (select id from person where lower(first_name)='kevin' and 
 lower(last_name)='williamson');",2018-08-28 21:19:07.885507+10,5,1,91,correct
4393,"SELECT p.id, p.last_name, p.first_name
FROM person p, director d, writer w
WHERE p.id = d.id AND p.id = w.id
GROUP BY p.id
HAVING COUNT(*) >= 2
ORDER BY COUNT(*) DESC
;
",2018-08-28 21:20:24.875389+10,4,0,353,partially correct
4394,;,2018-08-28 21:20:45.102875+10,10,0,138,noninterpretable
4395,select * from writer inner join Person on writer.id=person.id where year_born=1935;,2018-08-28 21:21:48.006902+10,1,0,29,partially correct
4396,select count(*) from writer inner join Person on writer.id=person.id where year_born=1935;,2018-08-28 21:22:06.47058+10,1,0,29,partially correct
4397,"select id 
from person
where year_born = (
	select max(year_born) 
	from person 
	where year_born < (select max(year_born) from person));
",2018-08-28 21:22:28.956704+10,3,1,109,correct
4398,"SELECT COUNT(*)
FROM WRITER_AWARD wa NATURAL JOIN PERSON p
WHERE p.first_name = 'Woody'
AND p.last_name = 'Allen'
AND wa.year_of_award > 1990
AND wa.year_of_award < 1995;",2018-08-28 21:22:47.927764+10,9,1,199,correct
4399,"select d.id, da.award_name, da.year_of_award,category
from director_award da, director d  
where da.title = d.title
and da.production_year=d.production_year
and da.result='nominated';
",2018-08-28 21:24:27.867093+10,13,1,110,correct
4400,select count(*) from movie m where not exists (select * from movie_award ma where m.title=ma.title) and not exists (select * from crew_award ca where m.title=ca.title) and not exists (select * from writer_award wa where m.title=wa.title) and not exists (select * from director_award da where m.title=da.title) and not exists (select * from actor_award aa where m.title=aa.title);,2018-08-28 21:24:36.155525+10,11,0,258,partially correct
4401,"SELECT d.id,a.award_name,a.year_of_award,a.category
FROM DIRECTOR d, DIRECTOR_AWARD a
WHERE d.title=a.title
AND lower(result)='nominated';
",2018-08-28 21:26:09.715169+10,13,1,280,correct
4402,select count(distinct writer.id) from writer inner join person on writer.id=person.id where year_born = 1935;,2018-08-28 21:26:53.437665+10,1,1,29,correct
4403,"select count(*) from 
(select distinct * from
(select p.id, p.year_born from person p natural join writer w) r 
where r.year_born = 1935);",2018-08-28 21:28:08.556323+10,1,1,379,correct
4404,;,2018-08-28 21:28:20.609326+10,14,0,280,noninterpretable
4407,"SELECT p.id, p.first_name, p.last_name
FROM person p, director d, writer w
WHERE p.id = d.id AND p.id = w.id AND d.title = w.title
GROUP BY p.id
HAVING COUNT(d.title) >= 2
;
",2018-08-28 21:30:11.428531+10,4,1,353,correct
4408,"select production_year, count(*) from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year;",2018-08-28 21:30:49.392803+10,2,1,101,correct
4409,"select production_year,count(*) from movie group by production_year having production_year in (1993,1992,1991);",2018-08-28 21:32:23.26306+10,2,1,29,correct
4410,select country from restriction where lower(title)='shakespeare in love' and lower(description)='m';,2018-08-28 21:33:35.399565+10,6,1,91,correct
4411,select count(*) from person where id in (select distinct(id) from writer) and year_born = 1935;,2018-08-28 21:33:56.671098+10,1,1,365,correct
4412,"SELECT first_name, last_name, title, production_year from person as p NATURAL JOIN (SELECT d.title, d.production_year,d.id from director as d natural join movie_award as m 
where m.award_name='BAFTA Film Award' and m.category='best film');",2018-08-28 21:34:12.338268+10,8,0,111,partially correct
4413,"select count(*) from person where id not in (
	select id from director
);",2018-08-28 21:35:08.720919+10,12,1,29,correct
4414,"SELECT r.id
FROM APPEARANCE a, SCENE s, ROLE r
WHERE s.title = 'Psycho'
AND s.title = a.title
AND s.title = r.title
AND s.scene_no = a.scene_no
AND s.production_year = r.production_year
AND a.production_year = r.production_year
AND a.description = r.description
AND s.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-28 21:35:30.353802+10,10,1,199,correct
4415,"select production_year, count(*) from movie where production_year<=1993 and production_year>=1991 group by production_year;",2018-08-28 21:35:46.953477+10,2,1,365,correct
4416,"SELECT title, production_year, first_name, last_name from person as p NATURAL JOIN (SELECT d.title, d.production_year,d.id from director as d natural join movie_award as m 
where m.award_name='BAFTA Film Award' and m.category='best film' and m.result='won');",2018-08-28 21:36:43.368819+10,8,1,111,correct
4417,"SELECT w.title, w.production_year
FROM person p, writer w
WHERE w.id = p.id AND p.last_name = 'Williamson' AND p.first_name = 'Kevin'
;
",2018-08-28 21:36:45.247978+10,5,1,353,correct
4418,"select country
from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-28 21:37:07.876665+10,6,1,22,correct
4419,select count(*) from person where id not in (select distinct(id) from director);,2018-08-28 21:37:09.037492+10,12,1,365,correct
4420,"select id,first_name,last_name from person where year_born in (select max(year_born) from person);





















",2018-08-28 21:37:49.65725+10,7,1,91,correct
4421,"SELECT d.id, da.award_name,da.year_of_award,da.category
FROM Director_award da, Director d
WHERE (d.title = da.title AND d.production_year = da.production_year AND 
lower(da.result) = 'nominated');
",2018-08-28 21:38:12.372013+10,13,1,218,correct
4422,select distinct * from person where ;,2018-08-28 21:38:42.997009+10,12,0,101,noninterpretable
4423,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (SELECT * FROM movie_award ma WHERE lower(ma.result) = 'won' AND m.title = ma.title AND m.production_year = ma.production_year)
AND NOT EXISTS (SELECT * FROM crew_award ca WHERE lower(ca.result) = 'won' AND m.title = ca.title AND m.production_year = ca.production_year)
AND NOT EXISTS (SELECT * FROM director_award da WHERE lower(da.result) = 'won' AND m.title = da.title AND m.production_year = da.production_year)
AND NOT EXISTS (SELECT * FROM writer_award wa WHERE lower(wa.result) = 'won' AND m.title = wa.title AND m.production_year = wa.production_year)
AND NOT EXISTS (SELECT * FROM actor_award aa WHERE lower(aa.result) = 'won' AND m.title = aa.title AND m.production_year = aa.production_year)
;
",2018-08-28 21:39:07.306187+10,11,1,219,correct
4424,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 21:40:17.18491+10,1,1,18,correct
4425,"select id,first_name,last_name from person where id in (select w.id from writer w join director d on w.title=d.title and w.production_year=d.production_year and w.id=d.id group by w.id having count(w.id)>=2);
",2018-08-28 21:41:30.905663+10,4,1,365,correct
4426,"SELECT DISTINCT r.country
FROM restriction r
WHERE r.description = 'M' AND r.title = 'Shakespeare in Love'
;
",2018-08-28 21:41:38.337712+10,6,1,353,correct
4427,"select p.id,first_name,last_name from person as p inner join (
	select distinct w.id from writer as w inner join director as d on w.id=d.id and w.title=d.title 
	and w.production_year=d.production_year group by w.id having count(*)>=2
) as r on p.id=r.id;",2018-08-28 21:42:18.32716+10,4,1,29,correct
4428,"select id,first_name,last_name
from person
where year_born in(
select min(year_born)
from person);
",2018-08-28 21:43:58.728371+10,7,0,364,partially correct
4429,"select title, production_year from writer where id='00000402';
",2018-08-28 21:44:30.859563+10,5,0,365,cheating
4430,"select id,first_name,last_name
from person
where year_born in(
select max(year_born)
from person);
",2018-08-28 21:44:31.949422+10,7,1,364,correct
4431,"SELECT production_year, COUNT(title)
FROM MOVIE
GROUP BY production_year
Having production_year>1990 AND production_year<1994;
",2018-08-28 21:45:45.349991+10,2,1,368,correct
4432,"select country from restriction where title='Shakespeare in Love' and description='M';
",2018-08-28 21:46:10.411996+10,6,1,365,correct
4433,"select id,first_name,last_name,MAX(year_born)
from person;
",2018-08-28 21:46:32.757514+10,7,0,22,partially correct
4434,"SELECT title,production_year from movie m
where exists(select title from director d where d.title=m.title);",2018-08-28 21:46:42.012036+10,5,0,18,partially correct
4435," select id,first_name, last_name from person where year_born in (select max(year_born) from person);
",2018-08-28 21:47:27.75681+10,7,1,365,correct
4436,"select title,production_year from writer as w inner join person as p on w.id=p.id where p.first_name='Kevin' and p.last_name='Williamson';",2018-08-28 21:47:43.545177+10,5,1,29,correct
4437,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-28 21:49:16.556233+10,5,1,18,correct
4438,"select country from Restriction
where title=Shakespeare in Loveand  description='M';",2018-08-28 21:51:27.632005+10,6,0,18,noninterpretable
4439,"select d.title,d.production_year,p.first_name,p.last_name 
from person as p, director as d, movie_award as m
where p.id=d.id
and d.title=m.title
and d.production_year=m.production_year
and lower(m.award_name)='bafta film award'
and lower(m.category)='best film'
and lower(result)='won';
",2018-08-28 21:51:45.061066+10,8,1,91,correct
4440,;,2018-08-28 21:52:13.081897+10,11,0,138,noninterpretable
4441,"select r.id from role r, scene s, appearance a
where s.title=a.title
and s.production_year = a.production_year
and s.title=r.title
and s.scene_no = a.scene_no 
and s.production_year = r.production_year
and a.description=r.description
and lower(s.title) = ""psycho""
and s.production_year=1960
group by r.id
having count(*)=1;",2018-08-28 21:52:58.22519+10,10,1,274,correct
4442,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (
        SELECT MAX(p.year_born)
        FROM person p
    )
;",2018-08-28 21:53:00.687262+10,7,1,353,correct
4443,"select country from Restriction
where lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-28 21:53:12.941929+10,6,1,18,correct
4444,"SELECT MAX(id) FROM
(SELECT d.id FROM Director d WHERE NOT EXISTS (
SELECT d1.id FROM Director d1, Writer w1 
WHERE d1.title = w1.title 
AND d1.production_year=w1.production_year 
AND d1.id=w1.id)
UNION 
SELECT w.id FROM Writer w WHERE NOT EXISTS (
SELECT w2.id FROM Director d2, Writer w2 
WHERE d2.title = w2.title 
AND d2.production_year=w2.production_year 
AND d2.id=w2.id)
UNION
SELECT d3.id FROM Director d3, Writer w3 
WHERE d3.title = w3.title 
AND d3.production_year=w3.production_year 
AND d3.id=w3.id
 );
 ",2018-08-28 21:53:25.926228+10,14,0,218,partially correct
4445,select country from Restriction where title='Shakespeare in Love' and description='M';,2018-08-28 21:53:35.269861+10,6,1,29,correct
4446,"select first_name,last_name,id  from Person as p natural join director natural join Writer group by first_name having count(first_name)>1;",2018-08-28 21:57:25.915896+10,4,0,101,partially correct
4448,"select r.id from role r,  appearance a
where r.title=a.title
and r.production_year = a.production_year
and a.production_year = r.production_year
and a.description=r.description
and lower(r.title) = ""psycho""
and r.production_year=1960
group by r.id
having count(*)=1;",2018-08-28 21:58:12.32819+10,10,1,274,correct
4449,"select id ,first_name,last_name from Person as p natural join director natural join Writer group by first_name having count(first_name)>1;",2018-08-28 21:58:12.956191+10,4,0,101,partially correct
4450,"SELECT m.title, m.production_year, p.first_name, p.last_name

FROM person p, director d,(SELECT * FROM movie_award m
WHERE lower(m.category)=""best film"" AND m.award_name=""BAFTA Film Award"" AND m.result=""won"") m

WHERE p.id=d.id AND d.title = m.title AND d.production_year=m.production_year;",2018-08-28 21:58:48.832871+10,8,1,128,correct
4451,"select a.title,a.production_year,p.first_name,p.last_name 
from movie_award a,director d,person p 
where a.award_name='BAFTA Film Award' 
and lower(a.category)='best film' 
and d.title=a.title 
and d.production_year=a.production_year 
and d.id=p.id;
",2018-08-28 21:58:56.423031+10,8,0,365,partially correct
4452,"select a.title,a.production_year,p.first_name,p.last_name 
from movie_award a,director d,person p 
where lower(a.award_name='BAFTA Film Award') 
and lower(a.category)='best film' 
and d.title=a.title 
and d.production_year=a.production_year 
and d.id=p.id;
",2018-08-28 21:59:22.079586+10,8,0,365,partially correct
4453,;,2018-08-28 21:59:47.554813+10,15,0,280,noninterpretable
4454,"select a.title,a.production_year,p.first_name,p.last_name 
from movie_award a,director d,person p 
where lower(a.award_name='BAFTA Film Award') 
and lower(a.category)='best film' 
and d.title=a.title 
and d.production_year=a.production_year 
and d.id=p.id
and a.result='won';
",2018-08-28 22:00:30.406223+10,8,1,365,correct
4455,"select id ,first_name,last_name from Person as p natural join director natural join Writer group by id having count(id)>1;",2018-08-28 22:00:50.457901+10,4,1,101,correct
4456,"select m.production_year, count(*) as total_produced from movie m
where m.production_year between 1991 and 1993
group by m.production_year
;",2018-08-28 22:03:25.452921+10,2,1,379,correct
4457,"SELECT COUNT(DISTINCT writer.id) FROM writer, person WHERE person.id=writer.id AND year_born=1935;",2018-08-28 22:03:40.974933+10,1,1,155,correct
4458,"select title,production_year from movie m
where m.title=(select a.title from Movie_Award a
where lower(a.category)='best film');",2018-08-28 22:03:50.826066+10,8,0,18,partially correct
4459,"SELECT id
FROM PERSON
WHERE (SELECT MAX(year_born) FROM PERSON WHERE PERSON.year_born < (SELECT MAX(year_born) FROM PERSON));",2018-08-28 22:03:59.790515+10,3,0,199,partially correct
4460,SELECT COUNT(distinct id) FROM person NATURAL JOIN writer WHERE year_born=1935;,2018-08-28 22:04:21.089122+10,1,1,155,correct
4461,"SELECT count(*)
FROM (SELECT title,production_year FROM movie) AS m
WHERE not exists (SELECT * FROM movie,movie_award WHERE m.title=movie_award.title)
and (SELECT * FROM movie,crew_award WHERE m.title=crew_award.title)
and ((SELECT * FROM movie,director_award WHERE m.title=director_award.title)
and (SELECT * FROM movie,writer_award WHERE m.title=writer_award.title)
and (SELECT * FROM movie,actor_award WHERE m.title=actor_award.title);",2018-08-28 22:06:18.861021+10,11,0,216,noninterpretable
4462,"SELECT COUNT(id)
From Person p
EXCEPT
SELECT id
FROM director d;",2018-08-28 22:06:36.266283+10,12,0,368,partially correct
4463,"SELECT production_year, COUNT(*) FROM movie GROUP BY production_year HAVING production_year<=1993 AND production_year>=1991;",2018-08-28 22:07:34.533753+10,2,1,155,correct
4464,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-28 22:08:21.331101+10,11,1,216,correct
4465,"select count(*)
from movie m, (select ma.title, ma.production_year
                 from movie_award ma
				 where m.title=ma.title
				 and m.production_year=ma.production_year) AS mam
				 
		    (select ca.title, ca.production_year
			from crew_award ca
			where m.title=ca.title
			and m.production_year=ca.production_year) AS cam
			
		     (select da.title, da.production_year
			 from director_award da
			 where m.title=da.title
			 and m.production_year=da.production_year) AS dam
			 
			 (select wa.title, wa.production_year
			 from writer_award wa
			 where m.title=wa.title
			 and m.production_year=wa.production_year) AS wam
			 
			 (select aa.title, aa.production_year
			 from actor_award aa
			 where m.title=aa.title
			 and m.production_year=aa.production_year) AS aam
where exists (select m.title, s.production_year
              from movie m
			  where m.title != mam.title
                     and m.peoduction_year != mam.production_year
                     and m.title != cam.title
                     and m.peoduction_year != cam.production_year
                     and m.title != dam.title
                     and m.peoduction_year != dam.production_year
                     and m.title != wam.title
                     and m.peoduction_year != wam.production_year
                     and m.title != aam.title
                     and m.peoduction_year != aam.production_year);",2018-08-28 22:08:48.111232+10,11,0,272,noninterpretable
4466,"SELECT COUNT(*) FROM person, director WHERE director.id!=person.id;",2018-08-28 22:09:28.928166+10,12,0,155,partially correct
4467,;,2018-08-28 22:09:52.416397+10,3,0,138,noninterpretable
4468," select count(*) from writer_award a,writer d,person p 
 where d.title=a.title 
 and d.production_year=a.production_year 
 and d.id=p.id 
 and p.first_name='Woody' 
 and p.last_name='Allen' 
 and a.result='won'
 and a.year_of_award>=1991 and a.year_of_award>=1995;
",2018-08-28 22:10:02.589468+10,9,0,365,partially correct
4469," select count(*) from writer_award a,writer d,person p 
 where d.title=a.title 
 and d.production_year=a.production_year 
 and d.id=p.id 
 and p.first_name='Woody' 
 and p.last_name='Allen' 
 and a.result='won'
 and a.year_of_award>=1991 and a.year_of_award<=1995;
",2018-08-28 22:10:24.323637+10,9,1,365,correct
4470,"SELECT COUNT(*)
 FROM MOVIE m
  WHERE m.title and m.production_year NOT EXISTS(
                 SELECT m.title FROM MOVIE m, MOVIE_AWARD ma
			WHERE (m.title = ma.title 
			AND m.production_year = ma.production_year)
			UNION
			SELECT m.title FROM MOVIE m, CREW_AWARD ca
			WHERE (m.title = ca.title 
			AND m.production_year = ca.production_year)
			UNION
			SELECT m.title FROM MOVIE m, DIRECTOR_AWARD da
			WHERE (m.title = da.title 
			AND m.production_year = da.production_year)
			UNION
			SELECT m.title FROM MOVIE m, WRITER_AWARD wa
			WHERE (m.title = wa.title 
			AND m.production_year = wa.production_year)
			UNION
			SELECT m.title FROM MOVIE m, ACTOR_AWARD aa
			WHERE (m.title = aa.title 
			AND m.production_year = aa.production_year));
  ",2018-08-28 22:10:35.931685+10,11,0,98,noninterpretable
4471,"select title, production_year, first_name, last_name
from movie_award, person
where exists (select*from person p, director d
where p.id=d.id)
and lower(category)='best film'
and lower(award_name)='bafta film award'
group by title;
",2018-08-28 22:10:38.014949+10,8,0,121,partially correct
4472,"select first_name, last_name, title, production_year, description
from role r1, person
where (select count(*), r1.id from role r1 group by r1.id)=
(select max(t.no) from (select count(*) as no, r.id from role r group by r.id) as t)
and person.id = r1.id;",2018-08-28 22:12:33.824376+10,15,0,110,noninterpretable
4473,"select count(*) from person p
where p.id not in (select d.id from director d)
;",2018-08-28 22:12:38.322836+10,12,1,379,correct
4474,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
  ",2018-08-28 22:12:50.194971+10,11,1,98,correct
4475,"SELECT DISTINCT d.title, d.production_year, p.first_name, p.last_name
FROM director d, person p
WHERE EXISTS(
    SELECT ma.title, ma.production_year
    FROM movie_award AS ma
    WHERE ma.award_name = 'BAFTA Film Award' AND 
        ma.category = 'best film' AND 
        lower(ma.result) = 'won' AND
        ma.title = d.title
    ) AND
    d.id = p.id
;
",2018-08-28 22:13:12.158193+10,8,1,353,correct
4476,;,2018-08-28 22:13:34.991147+10,3,0,138,noninterpretable
4477,"select title,production_year from writer natural join person where first_name='Kevin' and last_name='Williamson';",2018-08-28 22:13:35.290093+10,5,1,101,correct
4478,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-28 22:13:41.45465+10,15,1,110,correct
4479,"select d.title,d.production_year,d.first_name,d.last_name
from (person natural join director) as d
where d.id in (
select h.id
from (director natural join Movie_Award) as h
where h.award_name = 'BAFTA Film Award' and h.category = 'Best Film');",2018-08-28 22:14:03.876638+10,8,0,364,partially correct
4480,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-28 22:14:45.07492+10,15,1,110,correct
4481,"Select Count(*) From Movie m Where Not Exists (Select * From Movie_Award ma, Crew_Award ca, Director_Award da, Writer_Award wa, Actor_Award aa Where m.title = ma.title AND m.title = ca.title AND m.title = da.title AND m.title = wa.title AND m.title = aa.title);
",2018-08-28 22:14:51.796255+10,11,0,247,partially correct
4482,"select id from role 
where and title='Psycho' and production_year=1960 and description in (
select description from appearance 
where title='Psycho' and production_year=1960 
group by description 
having count(scene_no)=1) ;
",2018-08-28 22:16:12.506643+10,10,0,365,noninterpretable
4483,"select id from role 
where title='Psycho' and production_year=1960 and description in (
select description from appearance 
where title='Psycho' and production_year=1960 
group by description 
having count(scene_no)=1) ;
",2018-08-28 22:16:39.741312+10,10,1,365,correct
4484,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-28 22:16:49.541939+10,11,1,216,correct
4485,"SELECT COUNT(*)
From Person p
WHERE NOT EXISTS(SELECT *
FROM director d
WHERE p.id =d.id);",2018-08-28 22:17:15.088989+10,12,1,368,correct
4486,"select r.id from role r natural join appearance a
where lower(r.title) = ""psycho""
and r.production_year=1960
group by r.id
having count(*)=1;",2018-08-28 22:17:29.532446+10,10,1,274,correct
4487,"
SELECT
    id,
    first_name,
    last_name
FROM
    person 
WHERE
    year_born = (
        SELECT
            max(year_born)
        FROM
            person );



",2018-08-28 22:17:30.139109+10,7,1,22,correct
4488,"SELECT first_name, last_name, id FROM person NATURAL JOIN writer NATURAL JOIN director GROUP BY id HAVING COUNT(id)>=2;",2018-08-28 22:19:36.649364+10,4,1,155,correct
4489,"SELECT p.id
FROM
    person p,
    director d,
    writer r
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            director, writer
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-28 22:19:43.557081+10,14,0,110,noninterpretable
4490,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) x1 
GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
(SELECT MAX(x2.NoOfWorkedON) 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) x1 
GROUP BY x1.id) x2);",2018-08-28 22:20:49.291041+10,14,1,110,correct
4491,"select r.id from role r,  appearance a
where r.title=a.title
and r.production_year = a.production_year
and a.production_year = r.production_year
and a.description=r.description
and lower(r.title) = 'psycho'
and r.production_year=1960
group by r.id
having count(*)=1;",2018-08-28 22:22:48.813451+10,10,1,274,correct
4492,"select d.id, da.award_name, da.year_of_award,da.category
from director_award da, director d  
where da.title = d.title
and da.production_year=d.production_year
and da.result='nominated';
",2018-08-28 22:24:10.535056+10,13,1,110,correct
4493,"Select Count(*) From Movie m  Where Not Exists (Select * From Movie_Award ma, Crew_Award ca, Director_Award da, Writer_Award wa, Actor_Award aa Where
m.title = ma.title AND m.production_year = ma.production_year
AND m.title = ca.title AND m.production_year = ma.production_year
AND m.title = da.title AND m.production_year = da.production_year 
AND m.title = wa.title m.production_year = wa.production_year AND
AND m.title = aa.title m.production_year = aa.production_year);
",2018-08-28 22:25:07.149522+10,11,0,247,noninterpretable
4529,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d
 WHERE p.id = d.id;",2018-08-28 22:42:33.56675+10,12,0,378,noninterpretable
4530,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p,DIRECTOR d, WRITER w
WHERE
p.id=d.id
AND d.id=w.id
AND p.id=w.id
GROUP BY p.id
HAVING COUNT(*)>=2;

          ",2018-08-28 22:42:35.283127+10,4,0,280,partially correct
4494,"Select Count(*) From Movie m  Where Not Exists (Select * From Movie_Award ma, Crew_Award ca, Director_Award da, Writer_Award wa, Actor_Award aa Where
m.title = ma.title AND m.production_year = ma.production_year
AND m.title = ca.title AND m.production_year = ma.production_year
AND m.title = da.title AND m.production_year = da.production_year 
AND m.title = wa.title m.production_year = wa.production_year AND
AND m.title = aa.title m.production_year = aa.production_year);
",2018-08-28 22:25:15.564906+10,11,0,247,noninterpretable
4495,"SELECT Count(*) 
FROM PERSON p
WHERE EXISTS(SELECT *
      FROM WRITER w
	 WHERE p.id=w.id
	 AND p.year_born=1935);
",2018-08-28 22:26:10.871196+10,1,1,280,correct
4496,;,2018-08-28 22:27:12.398854+10,1,0,378,noninterpretable
4497,"select ma.title, ma.production_year, first_name, last_name
from (select title, production_year
from movie_award
where lower(award_name)='bafta film award'
and lower(category)='best film'
and lower(result)='won') as ma, director as d, person as p
where d.id=p.id
and ma.title=d.title
and ma.production_year=d.production_year;",2018-08-28 22:28:03.442174+10,8,1,121,correct
4498,"select dw.id,p.first_name,p.last_name
from person p, select*from director d natural join writer w natural join movie m)as dw
where  d.title=w.title 
and d.title=dw.title
and w.title=dw.title
group by dw.id
having count(*)>2;

",2018-08-28 22:29:15.543546+10,4,0,20,noninterpretable
4499,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-28 22:29:54.457687+10,7,1,101,correct
4500,"SELECT count(*)
FROM writer_award w,person p
WHERE w.id=p.id AND lower(p.first_name)=""woody"" AND lower(p.last_name)=""allen"" AND w.year_of_award BETWEEN 1991 AND 1995;",2018-08-28 22:30:36.193856+10,9,0,128,partially correct
4501,"select count(*) from movie a
where not exists (select 1 from movie_award ma where a.title=ma.title and a.production_year=ma.production_year and lower(ma.result)='won')
and not exists (select 1 from crew_award ca where a.title=ca.title and a.production_year=ca.production_year and lower(ca.result)='won')
and not exists (select 1 from director_award da where a.title=da.title and a.production_year=da.production_year and lower(da.result)='won')
and not exists (select 1 from writer_award wa where a.title=wa.title and a.production_year=wa.production_year and lower(wa.result)='won')
and not exists (select 1 from actor_award aa where a.title=aa.title and a.production_year=aa.production_year and lower(aa.result)='won');",2018-08-28 22:31:00.388182+10,11,1,365,correct
4502,"select id
from ((select * from person) except (select * from person where age=max(year_born))as A
where age=max(A.year_born);",2018-08-28 22:31:07.653556+10,3,0,216,noninterpretable
4503,"select d.title,d.production_year,d.first_name,d.last_name
from (person natural join director natural join movie natural join movie_award) as d
where d.award_name ='BAFTA Film Award' and
      lower(d.category) = 'best film' and lower(result) = 'won';

",2018-08-28 22:31:18.549332+10,8,1,364,correct
4504,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-28 22:31:26.209673+10,1,1,378,correct
4505,"SELECT m.production_year,COUNT(*)
FROM MOVIE m
WHERE m.production_year <=1993
AND m.production_year >=1991
GROUP BY m.production_year;",2018-08-28 22:31:34.282497+10,2,1,280,correct
4506,"SELECT X.id FROM
( SELECT X1.id, count(*) AS pair
FROM (SELECT id,title FROM Writer
UNION 
SELECT id,title FROM Director) X1
GRoup by X1.id ) AS X

WHERE X.pair = (
SELECT MAX(pair) 
FROM (SELECT X1.id,count(*) AS pair
FROM (SELECT id, Title FROM Writer
UNION
SELECT id,title FROM Writer)X1
GROUP by X1.id));",2018-08-28 22:32:47.875949+10,14,1,218,correct
4507,"select id from person 
where year_born in (
select min(year_born) from person 
where year_born not in(select min(year_born) from person));",2018-08-28 22:33:30.315106+10,3,0,365,partially correct
4508,"select id from person 
where year_born in (
select max(year_born) from person 
where year_born not in(select max(year_born) from person));",2018-08-28 22:33:48.798032+10,3,1,365,correct
4509,"SELECT COUNT(*) FROM person 
WHERE EXISTS(SELECT writer.id FROM writer
WHERE person.id=writer.id 
AND person.year_born=1935);",2018-08-28 22:34:50.263114+10,1,1,288,correct
4510,"SELECT count(*) from Person  p
where exists(select * from Writer w where w.id = p.id and p.year_born=1935);",2018-08-28 22:36:30.277887+10,1,1,238,correct
4511,"select id
from person
where year_born=(select max(year_born) from person where year_born<(select max(year_born) from person));",2018-08-28 22:36:33.665947+10,3,1,216,correct
4512,select count(*) from Person natural join writer_award where year_of_award>=1991 and year_of_award<=1995 and result='won' and first_name='Woody';,2018-08-28 22:36:51.020885+10,9,1,101,correct
4513,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 22:37:12.059632+10,11,1,272,correct
4514,"SELECT count(*)
FROM PERSON p
WHERE not EXISTS(
        SELECT*
	   FROM DIRECTOR d
	   WHERE p.id=d.id);",2018-08-28 22:37:19.031671+10,12,1,280,correct
4515,"select p.id, p.first_name, p.last_name from person p
where p.id in (select id 
	from writer natural join director
	group by id
	having count(*) > 1)
;",2018-08-28 22:38:11.209697+10,4,1,379,correct
4516,"SELECT COUNT(*) FORM PERSON p NATURAL JOIN WRITER w 
	WHERE p.year_born=1935;
",2018-08-28 22:38:16.583451+10,1,0,32,noninterpretable
4517,Select id From Person Order By year_born ASC Limit 1 Offset 1; ,2018-08-28 22:38:19.228956+10,3,0,247,partially correct
4518,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year = 1993 
GROUP BY production_year;",2018-08-28 22:38:38.660156+10,2,0,378,partially correct
4519,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year = 1993 
GROUP BY production_year;",2018-08-28 22:38:45.324045+10,2,0,378,partially correct
4520,"SELECT w.year_of_award, count(*)
FROM writer_award w,person p
WHERE w.id=p.id AND lower(p.first_name)=""woody"" AND lower(p.last_name)=""allen"" AND w.year_of_award BETWEEN 1991 AND 1995
GROUP BY w.year_of_award;",2018-08-28 22:39:03.617694+10,9,0,128,partially correct
4521,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year > 1990 AND production_year <1994
GROUP BY production_year;",2018-08-28 22:39:34.754683+10,2,1,378,correct
4522,"SELECT production_year, COUNT(*) FROM movie GROUP BY movie.production_year
HAVING production_year=1993 OR production_year=1992 OR production_year
=1991;",2018-08-28 22:40:40.883483+10,2,1,288,correct
4523,"select r.id
from appearance a
	natural join
	role r
where lower(a.title) = ""psycho"" and
	production_year = ""1960""
group by r.id
having count(r.id) = 1;",2018-08-28 22:40:50.268878+10,10,1,43,correct
4524,"SELECT *, count(*)
FROM writer_award w,person p
WHERE w.id=p.id AND lower(p.first_name)=""woody"" AND lower(p.last_name)=""allen"" AND w.year_of_award BETWEEN 1991 AND 1995 AND lower(result)=""won""
GROUP BY w.year_of_award;",2018-08-28 22:40:56.095985+10,9,0,128,partially correct
4525,"SELECT COUNT(wa.id)
FROM
(SELECT award_name, year_of_award, result
FROM writer_award
WHERE lower(award_name)='writer awards'
AND lower(result)='won'
AND 1991< year_of award <1996) AS wa, person AS p
WHERE lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND p.id=wa.id;",2018-08-28 22:41:20.395964+10,9,0,121,noninterpretable
4526,"SELECT COUNT(*)
FROM person
WHERE ;",2018-08-28 22:41:22.526544+10,12,0,378,noninterpretable
4527,"SELECT count(*) as number_of_awards
FROM writer_award w,person p
WHERE w.id=p.id AND lower(p.first_name)=""woody"" AND lower(p.last_name)=""allen"" AND w.year_of_award BETWEEN 1991 AND 1995 AND lower(result)=""won"";",2018-08-28 22:41:41.79424+10,9,1,128,correct
4533,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p,DIRECTOR d, WRITER w
WHERE
 d.id=w.id
AND p.id=w.id
GROUP BY p.id
HAVING COUNT(*)>=2;

          ",2018-08-28 22:44:05.846522+10,4,0,280,partially correct
4534,"SELECT COUNT(*) FROM person WHERE NOT EXISTS(SELECT id FROM director
WHERE person.id=director.id);",2018-08-28 22:44:14.837339+10,12,1,288,correct
4535,"select  d.id,da.award_name, da.years_of_awards,da.category
from director d, director_award da
where d.title = da.title
and lower(result) != 'won' and d.production_year = da.production_year;
",2018-08-28 22:44:20.910313+10,13,0,138,noninterpretable
4536,"select count(*)
from movie
where movie.title NOT IN (select title from movie_award where lower(movie_award.result)='won' and movie.production_year = movie_award.production_year)
and movie.title NOT IN (select title from crew_award where lower(crew_award.result)='won' and movie.production_year = crew_award.production_year)
and movie.title NOT IN (select title from director_award where lower(director_award.result)='won' and movie.production_year = director_award.production_year)
and movie.title NOT IN (select title from writer_award where lower(writer_award.result)='won' and movie.production_year = writer_award.production_year)
and movie.title NOT IN (select title from actor_award where lower(actor_award.result)='won' and movie.production_year = actor_award.production_year);",2018-08-28 22:44:43.519579+10,11,1,344,correct
4537,"select title, production_year from person p natural join writer
where p.first_name = 'Kevin' and p.last_name = 'Williamson'
;",2018-08-28 22:45:08.490798+10,5,1,379,correct
4538,"select p.id
from person p
where exists 
      (select p1.year_born
	  from person p1
	  where p.year_born < p1.year_born) as p11
	  and (select p2.year_born
	       from person p2
		   where pll.year_born < p2.year_born
		   and p.year_born > p2.year_born);",2018-08-28 22:45:31.222069+10,3,0,272,noninterpretable
4539,"SELECT p.id, p.first_name, p.last_name
FROM (PERSON p NATURAL JOIN DIRECTOR d NATURAL JOIN WRITER w)as dw

GROUP BY dw.id
HAVING COUNT(*)>=2;

          ",2018-08-28 22:45:34.581069+10,4,1,280,correct
4540,"SELECT id
FROM people p, role r
WHERE ;",2018-08-28 22:45:35.871929+10,10,0,329,noninterpretable
4541,"SELECT p.id,p.first_name,p.last_name
FROM person p,director d,writer w
WHERE p.id=d.id=w.id
GROUP BY w.id, w.title, w.production_year
HAVING COUNT(d.id)>2;",2018-08-28 22:46:14.392959+10,4,0,368,partially correct
4542,"select country from restriction
where description = 'M' and title = 'Shakespeare in Love'
;",2018-08-28 22:48:18.139057+10,6,1,379,correct
4543,"
select first_name,last_name,title, production_year
from movie_award natural join director natural join person
where lower(category)='best film'
and lower(award_name)='bafta film award';",2018-08-28 22:48:36.15791+10,8,0,22,partially correct
4544,"select count(*)
from movie m 
where not exists(select *
			from 
		(select ma.title,ma.production_year
		  from movie_award ma
		  where lower(ma.result) = ""won"" 
		  union
		  select ca.title,ca.production_year
		  from crew_award ca
		  where lower(ca.result) = ""won"" 
		  union
		  select da.title,da.production_year
		  from director_award da
		  where lower(da.result) = ""won""
		  union
		  select wa.title,wa.production_year
		  from writer_award wa
		  where lower(wa.result) = ""won""
		  union
		  select aa.title,aa.production_year
		  from actor_award aa
		  where lower(aa.result) = ""won"") as sub
		  where sub.title = m.title and
		  		sub.production_year = m.production_year)
		  ;",2018-08-28 22:49:54.262262+10,11,1,43,correct
4545,"
select first_name,last_name,title, production_year
from movie_award natural join director natural join person
where lower(category)='best film'
and lower(award_name)='bafta film award'
AND lower(RESULT)= 'won' ;",2018-08-28 22:51:40.084214+10,8,1,22,correct
4546,"SELECT id, first_name, last_name FROM (person NATURAL JOIN director 
NATURAL JOIN writer)
GROUP BY id HAVING COUNT(id)>1;",2018-08-28 22:52:11.187486+10,4,1,288,correct
4547,select * from Person;,2018-08-28 22:54:03.853696+10,11,0,101,partially correct
4548,"select id
from person
where person.year_born in (select year_born
from person
order by year_born DESC limit 1 offset 1);",2018-08-28 22:55:59.69684+10,3,1,344,correct
4549,"SELECT dw.id, dw.first_name,dw.last_name
FROM(person NATURAL JOIN director NATURAL JOIN writer)AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-28 22:56:16.586886+10,4,1,368,correct
4550,"SELECT DISTINCT p.id
FROM person p, role r, appearance a
WHERE lower(a.title)='psycho' AND a.production_year=1960 AND a.scene_no=1 AND a.title=r.title AND r.id=p.id;",2018-08-28 22:56:56.049333+10,10,0,128,partially correct
4551,"select MIN(year_born) from person
where year_born > 1900
;",2018-08-28 22:57:27.440766+10,7,0,379,partially correct
4552,"select MIN(year_born) from person

;",2018-08-28 22:57:42.590582+10,7,0,379,partially correct
4553,"select count(*) from movie m
where(m.production_year==1991 or 1992 or 1993);",2018-08-28 22:58:24.043866+10,2,0,238,noninterpretable
4554,"SELECT c.country, m.Movie Count(*)
FROM Restriction r
WHERE 
c.country = m.Movie
AND Lower(c.country)= 'Shakespeare in Love as M;",2018-08-28 22:58:43.418399+10,6,0,142,noninterpretable
4555,"SELECT COUNT(*)
FROM movie m
WHERE m.;",2018-08-28 22:59:18.755096+10,11,0,329,noninterpretable
4556,"SELECT id p, first_name p, last_name p
FROM person p
WHERE EXISTS (SELECT * FROM director d 
			WHERE ( d.id = p.id AND EXISTS ( SELECT * FROM writer w 
				WHERE ( w.title = d.title AND w.id = d.id))));",2018-08-28 22:59:19.082394+10,4,0,378,partially correct
4557,"SELECT a.title, a.production_year,p.first_name,p.last_name
FROM PERSON p, MOVIE_AWARD a,DIRECTOR d
WHERE a.title=d.title
AND d.id=p.id
AND lower(a.award_name)='bafta film award'
AND lower(a.category)='best film'
AND lower(a.result)='won';
",2018-08-28 23:00:24.022491+10,8,1,280,correct
4558,"select id
from (select id, count(*) as num
	from director natural join writer
	group by id) as pp
where pp.num = 3;",2018-08-28 23:00:32.657694+10,14,0,109,partially correct
4559,"select p.id
from person p
where p.year_born=(select max(year_born)
         from person 
		 where year_born < (select max(year_born)
                from person));",2018-08-28 23:00:47.848219+10,3,1,272,correct
4560,"SELECT COUNT(*)
FROM WRITER_AWARD a,WRITER w
WHERE EXISTS(SELECT *
      FROM PERSON p
	  WHERE w.id=p.id
	  AND lower(first_name)='woody'
	  AND lower(last_name)='allen')
AND a.title=w.title
AND year_of_award>=1991
AND year_of_award<=1995;",2018-08-28 23:00:48.93077+10,9,0,280,partially correct
4561,"SELECT COUNT(*)
FROM WRITER_AWARD a,WRITER w
WHERE EXISTS(SELECT *
      FROM PERSON p
	  WHERE w.id=p.id
	  AND lower(first_name)='woody'
	  AND lower(last_name)='allen'
	  AND lower(result)='won')
AND a.title=w.title
AND year_of_award>=1991
AND year_of_award<=1995;",2018-08-28 23:02:09.931384+10,9,1,280,correct
4562,"SELECT c.country
FROM Restriction
WHERE 
Lower(title)= 'Shakespeare in Love as M;",2018-08-28 23:03:02.750046+10,6,0,142,noninterpretable
4563,"select id,award_name,year_of_award,category
from director_award natural join director
where lower(result)!='won';",2018-08-28 23:03:43.214598+10,13,1,344,correct
4564,"select production_year, count(*) from movie m
where(production_year between 1991 and 1993)
group by production_year;",2018-08-28 23:03:44.554375+10,2,1,238,correct
4565,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-28 23:04:08.871365+10,6,1,142,correct
4566,;,2018-08-28 23:04:52.818075+10,15,0,148,noninterpretable
4567,"select id, first_name, last_name
from (select id, first_name, last_name, MAX(year_born)
	from person)
;",2018-08-28 23:06:08.228776+10,7,1,379,correct
4568,"select id,award_name,year_of_award,category
from director_award,director
where 
director_award.title = director.title
and director_award.production_year = director.production_year
and lower(result)!='won';",2018-08-28 23:06:52.683423+10,13,1,344,correct
4569,"SELECT movie.title, movie.production_year FROM movie, person, writer 
WHERE person.first_name='Kevin' AND person.last_name='Williamson'
AND movie.title=writer.title AND movie.production_year=writer.production_year
AND writer.id=person.id;",2018-08-28 23:07:24.955755+10,5,1,288,correct
4570,"select count(*) from Director d,person p;",2018-08-28 23:08:17.794213+10,12,0,238,partially correct
4730,"SELECT movie,p.id,p.first_name,p.last_name,movie.title,writer,title
FROM Person AS p JOIN writer JOIN Movie
WHERE Writer.title=Movie.title AND Writer.id=p.id AND p.first_name=KEVIN,p.last_name=Williamson;",2018-08-29 01:34:14.834529+10,5,0,370,noninterpretable
4571,"select p.id, da.award_name, da.year_of_award, da.category, da.result
from person p, director d, director_award da
where p.id=d.id and d.title=da.title and d.production_year=da.production_year
and p.id not in (select p.id from person p, director d, director_award da
where p.id=d.id and d.title=da.title and d.production_year=da.production_year and lower(da.result)='won');",2018-08-28 23:09:26.904354+10,13,0,365,partially correct
4572,"select p.id, da.award_name, da.year_of_award, da.category
from person p, director d, director_award da
where p.id=d.id and d.title=da.title and d.production_year=da.production_year
and p.id not in (select p.id from person p, director d, director_award da
where p.id=d.id and d.title=da.title and d.production_year=da.production_year and lower(da.result)='won');",2018-08-28 23:09:45.734814+10,13,1,365,correct
4573,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) as dw
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-28 23:10:19.609918+10,4,1,378,correct
4574,"SELECT country FROM restriction WHERE title='Shakespeare in Love' 
AND description='M';",2018-08-28 23:10:25.376591+10,6,1,288,correct
4575,"select count(*) from person p
where not exists(select id from Director d where d.id=p.id );",2018-08-28 23:11:23.69395+10,12,1,238,correct
4576,";
",2018-08-28 23:11:27.585057+10,13,0,247,noninterpretable
4577,"SELECT dd.id, dd.award_name, dd.year_of_award, dd.category
FROM (director d NATURAL JOIN director_award da) AS dd
WHERE lower (da.result)='nominate';",2018-08-28 23:11:56.47819+10,13,0,272,partially correct
4578,"select p.id from writer_award as wd,writer as w,person as p where
p.id =(select  wd.id where wd.year_of_award>=1991 AND wd.year_of_award<=1995) AND lower(p.first_name)=""woody"" AND lower (p.last_name)=""allen""
;",2018-08-28 23:12:21.76225+10,9,0,31,partially correct
4579,"select r.title, r.production_year, r.first_name, r.last_name
from (movie_award natural join director natural join person) as r
where lower(r.award_name) like 'bafta%'
;",2018-08-28 23:12:30.546415+10,8,0,379,partially correct
4580,"select r.title, r.production_year, r.first_name, r.last_name
from (movie_award natural join director natural join person) as r
where lower(r.award_name) like 'bafta%'
and lower(r.category) like 'best film'
;",2018-08-28 23:13:17.019442+10,8,0,379,partially correct
4581,"SELECT id, first_name, last_name FROM person WHERE person.year_born
=(SELECT MAX(year_born) FROM person);",2018-08-28 23:14:27.845836+10,7,1,288,correct
4582,"select *
from (movie_award natural join director natural join person) as r
where lower(r.award_name) like 'bafta film award'
and lower(r.category) like 'best film'
and lower(r.result) like 'won'
;",2018-08-28 23:14:47.161476+10,8,0,379,partially correct
4583,"SELECT COUNT(*) AS number_of_award
FROM writer_award wa, person p, writer w
WHERE wa.title=w.title
AND wa.production_year=w.production_year
AND wa.id=w.id
AND w.id=p.id
AND lower(first_name)='woody'
AND lower(last_name)='allen'
AND lower(result)='won'
AND year_of_award >=1991
AND year_of_award <=1995;",2018-08-28 23:14:47.693364+10,9,1,121,correct
4584,"select r.title, r.production_year, r.first_name, r.last_name
from (movie_award natural join director natural join person) as r
where lower(r.award_name) like 'bafta film award'
and lower(r.category) like 'best film'
and lower(r.result) like 'won'
;",2018-08-28 23:15:03.790784+10,8,1,379,correct
4585,"select count(*) 
from WRITER inner join PERSON on WRITER.id=PERSON.id and PERSON.year_born=""1935"" ;
",2018-08-28 23:15:40.667342+10,1,0,139,partially correct
4586,"Select d.id, da.award_name, da.year_of_award, da.category From Director d, Director_Award da Where da.result = 'nominated' And d.title = da.title;
",2018-08-28 23:16:21.873652+10,13,1,247,correct
4587,"SELECT dd.id, dd.award_name, dd.year_of_award, dd.category
FROM (director d NATURAL JOIN director_award da) AS dd
WHERE lower (da.result)='nominated';",2018-08-28 23:16:31.823214+10,13,1,272,correct
4588,;,2018-08-28 23:16:39.478267+10,4,0,378,noninterpretable
4589,"SELECT m.title
FROM (MOVIE m NATURAL JOIN person p NATURAL JOIN writer w)AS mpw

GROUP BY mpw.id
HAVING mpw.first_name= 'Kevin' AND mpw.last_name='Williamson';
",2018-08-28 23:17:03.144121+10,5,0,368,partially correct
4590,"SELECT mw.title, mw.production_year
FROM ( movie NATURAL JOIN person NATURAL JOIN writer) AS mw
WHERE mw.first_name = Kevin AND mw.last_name = Willianmson;",2018-08-28 23:17:25.468622+10,5,0,378,noninterpretable
4591,"SELECT mw.title, mw.production_year
FROM ( movie NATURAL JOIN person NATURAL JOIN writer) AS mw
WHERE lower(mw.first_name) = 'kevin' AND lower(mw.last_name) = 'willianmson';",2018-08-28 23:20:01.897516+10,5,0,378,partially correct
4592,"SELECT id, first_name, last_name, Count(*)
FROM Person p
ORDER BY year_born;",2018-08-28 23:21:38.299546+10,7,0,142,partially correct
4593,"SELECT id
FROM role
WHERE lower(title)='psycho'
AND lower(production_year)='1960';",2018-08-28 23:21:50.375971+10,10,0,121,partially correct
4594,"SELECT mw.title, mw.production_year
FROM ( movie NATURAL JOIN person p NATURAL JOIN writer) AS mw
WHERE lower(mw.first_name) = 'kevin' AND lower(mw.last_name) = 'willianmson';",2018-08-28 23:22:12.349664+10,6,0,378,partially correct
4595,"select count(*) from (writer natural join writer_award natural join person p) as r
where lower(r.result) like 'won'
and r.year_of_award between 1991 and 1995
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
;",2018-08-28 23:23:02.689911+10,9,1,379,correct
4596,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';
",2018-08-28 23:23:39.661436+10,5,1,368,correct
4597,"SELECT aa.title, aa.production_year
FROM ( movie NATURAL JOIN person NATURAL JOIN writer) AS aa
WHERE aa.first_name = 'Kevin' AND aa.last_name = 'Williamson';",2018-08-28 23:24:33.31424+10,5,1,378,correct
4598,"select count(*)
from (select title, production_year from writer_award where year_of_award>=1991 and year_of_award<=1995 and lower(result)='won')as wa
where wa=(select title, production_year from person, writer where lower(first_name)='woody' and lower(last_name)='allen');



",2018-08-28 23:25:04.540242+10,9,0,22,noninterpretable
4599,"
group by p.id
having count(*)>1;",2018-08-28 23:26:18.250312+10,4,0,223,noninterpretable
4600,"select first_name, last_name, title, production_year, description
from role natural join person
where id in ( 
	
	(select id 
	from 
	(select id, max(num) 
	from 
	(select id, count(*) as num
		from role
		group by id
		order by num)
		)));
",2018-08-28 23:27:02.896277+10,15,1,109,correct
4601,"SELECT country
FROM restriction
WHERE title = ""Shakespeare in Love"" AND description = ""M"";",2018-08-28 23:27:32.819111+10,6,1,378,correct
4602,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-28 23:28:01.456051+10,10,1,121,correct
4603,"SELECT id, first_name, last_name
FROM person;",2018-08-28 23:29:29.028445+10,7,0,378,partially correct
4604,"SELECT id, first_name, last_name
FROM person
WHERE year_born = ( SELECT max(year_born)FROM person);",2018-08-28 23:30:47.472261+10,7,1,378,correct
4605,"SELECT country
FROM (MOVIE NATURAL JOIN RESTRICTION)AS mr
WHERE mr.title='Shakespeare in Love as M? ';",2018-08-28 23:31:34.146913+10,6,0,368,partially correct
4606,"select wd.id,wd.last_name,wd.first_name
from (person p natural join director natural join writer) as wd
group by wd.id
having count(*)>1;",2018-08-28 23:31:46.993616+10,4,1,223,correct
4607,"SELECT COUNT(movie.title)
FROM MOVIE
WHERE movie.production_year=1993 UNION
movie.production_year=1992 UNION movie.production_year=1991;",2018-08-28 23:32:16.6933+10,2,0,370,noninterpretable
4608,"select wd.id,wd.first_name,wd.last_name
from (person p natural join director natural join writer) as wd
group by wd.id
having count(*)>1;",2018-08-28 23:32:31.991453+10,4,1,223,correct
4609,"SELECT MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(p.year_born) 
FROM person p);",2018-08-28 23:33:11.092141+10,3,0,219,partially correct
4761,"select production_year,count(*) 
from 
	movie 
group by production_year
having
	production_year between '1991' and '1993';",2018-08-29 03:18:54.370741+10,2,1,149,correct
4610,"select id
from (select id, count(*) as num
	from director natural join writer
	group by id)
where num = (
	(select max(num)
		from (
		select id, count(*) as num
		from director natural join writer
		group by id)
		)
	);",2018-08-28 23:34:01.52959+10,14,0,109,partially correct
4611,"SELECT country
FROM Restriction
WHERE title='Shakespeare in Love' AND description= 'M' ;",2018-08-28 23:34:28.590168+10,6,1,368,correct
4612,"SELECT COUNT(*) AS Number
FROM WRITER w,PERSON p
WHERE p.id = w.id AND p.year_born = 1935;
",2018-08-28 23:34:40.433522+10,1,0,132,partially correct
4613,;,2018-08-28 23:36:10.476668+10,14,0,247,noninterpretable
4614,;,2018-08-28 23:36:11.031414+10,14,0,247,noninterpretable
4615,"SELECT id
FROM (
SELECT id,MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(p.year_born) 
FROM person p))a;",2018-08-28 23:36:30.451754+10,3,1,219,correct
4616,select * from person;,2018-08-28 23:37:24.427675+10,4,0,238,partially correct
4617,"select id from appearance natural join role
where lower(title) = 'psycho'
and production_year = 1960
group by id
having count(*) = 1
;",2018-08-28 23:37:45.568295+10,10,1,379,correct
4618,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 23:38:08.941715+10,14,0,273,partially correct
4619,"select 
	id
from
	scene s,
	role r,
	appearance a
where
	s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no=a.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description =r.description
	and r.title ='Psycho'
	and r.production_year='1960'
group by r.id
having count(*)=1;


",2018-08-28 23:38:32.077687+10,10,1,149,correct
4620,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 23:38:33.899315+10,13,0,273,partially correct
4621,"
Select role.id
from role natural join appearance
Where lower(appearance.title)='psycho' AND appearance.production_year=1960
group by role.id
having count(role.id)=1;



  
  
",2018-08-28 23:39:10.506366+10,10,1,83,correct
4622,"select mv.title, mv.production_year
from (movie natural join writer natural join person) as mv
where first_name='Kevin' and last_name='Williamson';",2018-08-28 23:40:33.140701+10,5,1,223,correct
4623,"SELECT title, production_year FROM writer NATURAL JOIN person
GROUP BY title HAVING lower(first_name)='kevin' AND lower(last_name)= 'williamson';",2018-08-28 23:40:59.872576+10,5,1,155,correct
4624,"SELECT COUNT(*)
FROM movie m
WHERE (SELECT m.title, m.production_year, m.result, ma.title, ma.production_year, ma.result
FROM movie m, movie_award ma
WHERE m.title=ma.title
AND m.production_year=ma.production_year
AND lower(result)='lose');",2018-08-28 23:41:37.971766+10,11,0,121,noninterpretable
4625,"select id
from role r, appearance a
where scene_no=1
and r.title=a.title
and r.production_year=a.production_year
and lower(title)='psycho'
and production_year=1960;",2018-08-28 23:43:49.611566+10,10,0,22,noninterpretable
4626,"SELECT bm.title, bm.production_year, bm.first_name, bm.last_name
FROM (movie_award NATURAL JOIN movie NATURAL JOIN director NATURAL JOIN person) AS bm
WHERE (award_name = ""BAFTA Film Award"" AND category = ""Best Film"");
",2018-08-28 23:44:38.335618+10,8,0,378,partially correct
4627,"SELECT COUNT(*) FROM writer_award, writer, person
WHERE writer_award.id=writer.id AND writer_award.title=writer.title
AND writer_award.production_year=writer.production_year
AND person.id=writer.id AND person.first_name='Woody'
AND person.last_name='Allen'
AND writer_award.result='won'
GROUP BY writer.id, person.id
HAVING writer_award.year_of_award>=1991
AND writer_award.year_of_award<=1995;",2018-08-28 23:45:08.117155+10,9,1,288,correct
4628,SELECT country FROM restriction WHERE lower(title)='shakespeare in love' AND lower(description)='m';,2018-08-28 23:45:18.163857+10,6,1,155,correct
4629,"SELECT id, first_name, last_name
FROM person
GROUP BY id
HAVING MIN(year_born);",2018-08-28 23:45:23.891297+10,7,0,368,partially correct
4630,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-28 23:45:47.592288+10,11,1,121,correct
4631,"SELECT person, title
FROM PERSON,DIRECTOR
WHERE person.id=director.id;",2018-08-28 23:46:53.718109+10,12,0,370,noninterpretable
4632,"SELECT id, first_name, last_name FROM (SELECT *, MAX(year_born) FROM person);",2018-08-28 23:47:04.238678+10,7,1,155,correct
4633,"SELECT id, first_name, last_name
FROM person p
WHERE
p.year_born=(SELECT max(year_born)
FROM
person);
",2018-08-28 23:48:08.563393+10,7,1,368,correct
4634,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE EXISTS (
	SELECT * FROM director_award da1 WHERE d.title = da1.title AND d.production_year = da1.production_year AND lower(da1.result) = 'nominated')
AND NOT EXISTS (
	SELECT * FROM director_award da2 WHERE d.title = da2.title AND d.production_year = da2.production_year AND lower(da2.result) = 'won');",2018-08-28 23:50:03.763297+10,13,0,219,partially correct
4635,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
FROM person AS p, director AS d, movie_award AS ma 
WHERE d.title=ma.title
AND d.production_Year=ma.production_year
AND p.id=d.id
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film'
AND lower(ma.result)='won';",2018-08-28 23:52:41.06313+10,8,1,155,correct
4636,"select d.id, da.award_name, da.year_of_award, da.category
from director as d, director_award as da
where lower (da.result)='nominated'
         AND not exists (select id from director natural join director_award where lower(result)='won');",2018-08-28 23:53:51.053474+10,13,0,273,partially correct
4637,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
FROM person AS p NATURAL JOIN director AS d NATURAL JOIN movie_award AS ma 
WHERE d.title=ma.title
AND d.production_Year=ma.production_year
AND p.id=d.id
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film'
AND lower(ma.result)='won';",2018-08-28 23:54:38.280869+10,8,1,155,correct
5018,"SELECT country
FROM restriction r
WHERE lower(r.title)='shakespeare in love' AND lower(r.description)='M';",2018-08-29 14:13:11.022138+10,6,0,366,partially correct
4638,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE EXISTS (
	SELECT * FROM director_award da1 WHERE d.title = da1.title AND d.production_year = da1.production_year AND lower(da1.result) = 'nominated')
AND NOT EXISTS (
	SELECT * FROM director_award da2 WHERE d.title = da2.title AND d.production_year = da2.production_year AND lower(da2.result) = 'won')
AND d.title = da.title AND d.production_year = da.production_year;",2018-08-28 23:56:37.181179+10,13,1,219,correct
4639,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-28 23:56:38.488212+10,13,1,273,correct
4640,SELECT COUNT(distinct id) FROM writer_award AS wa NATURAL JOIN person AS p WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND wa.year_of_award>=1991 AND wa.year_of_award<=1995;,2018-08-28 23:59:08.676076+10,9,1,155,correct
4641,"SELECT COUNT(distinct(w.id)),p.year_born
FROM person as p join writer as w
ON p.id = w.id
WHERE p.year_born = 1935;",2018-08-28 23:59:20.65755+10,1,0,370,partially correct
4642,"SELECT id FROM role, appearance 
WHERE role.title='Psycho'
AND role.production_year=1960
AND appearance.title=role.title
AND appearance.production_year=role.production_year
AND appearance.description=role.description
GROUP BY id
HAVING COUNT(id)=1;",2018-08-28 23:59:51.814368+10,10,1,288,correct
4643,SELECT COUNT(*) FROM writer_award AS wa NATURAL JOIN person AS p WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND lower(result)='won' AND wa.year_of_award>=1991 AND wa.year_of_award<=1995;,2018-08-29 00:00:19.845233+10,9,1,155,correct
4644,"SELECT id, Count(*)
FROM person p
WHERE year_born = '1935'
GROUP BY person p;",2018-08-29 00:01:40.82519+10,1,0,352,noninterpretable
4645,"select production_year, count(*) 
from movie 
where production_year > 1990 and production_year < 1994 
group by production_year;",2018-08-29 00:03:24.019968+10,2,1,357,correct
4646,"select count(*)
from movie
where title not in 
(select title,production_year from movie_award as m join crew_award as c join writer_award as w Actor_Award as a join director_award as d on lower(m.result)='won'
and lower(c.result)='won' and lower(w.result)='won' and lower(a.result)='won' and lower(d.result)='won');",2018-08-29 00:04:06.62493+10,11,0,149,noninterpretable
4647,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 00:08:27.84335+10,11,1,149,correct
4648,"select count(*)from movie as m where not exists(
select title, production_year from movie_award as ma where lower(result)='won' and ma.title=m.title and ma.production_year=m.production_year
union
select title, production_year from crew_award as ca where lower(result)='won' and ca.title=m.title and ca.production_year=m.production_year
union
select title, production_year from director_award as da where lower(result)='won' and da.title=m.title and da.production_year=m.production_year
union
select title, production_year from writer_award as wa where lower(result)='won'and wa.title=m.title and wa.production_year=m.production_year
union
select title, production_year from actor_award as aa where lower(result)='won' and aa.title=m.title and aa.production_year=m.production_year);",2018-08-29 00:09:58.681251+10,11,1,33,correct
4649,"WITH b AS (SELECT a.id, COUNT(*) num
FROM (SELECT id, title, production_year FROM director UNION SELECT id, title, production_year FROM writer) a
GROUP BY a.id)

SELECT id
FROM b
WHERE num = (SELECT MAX(num) FROM b);",2018-08-29 00:10:38.404694+10,14,1,219,correct
4650,"select dw.id
from (
select id from person
except
select id from person
where id =max(id)
) as dw
where dw.id=max(dw.id);",2018-08-29 00:12:07.31086+10,3,0,149,noninterpretable
4651,"SELECT r.id FROM role AS r NATURAL JOIN appearance AS a NATURAL JOIN scene AS s 
WHERE 
lower(s.title)='psycho' 
AND s.production_year=1960
GROUP BY r.id 
HAVING COUNT(r.id)=1
;",2018-08-29 00:12:20.746142+10,10,0,155,partially correct
4652,"select movie.title

from movie join Movie_award on movie.title = movie_award.title join crew_award on crew_award.title = movie.title 
           join director_award on director_award.title = movie.title join writer_award on writer_award.title= movie.title
           join actor_award on actor_award.title= movie.title;",2018-08-29 00:12:24.814794+10,3,0,258,partially correct
4653,"SELECT r.id FROM role AS r NATURAL JOIN appearance AS a NATURAL JOIN scene AS s 
WHERE 
lower(title)='psycho' 
AND production_year=1960
GROUP BY r.id 
HAVING COUNT(*)=1
;",2018-08-29 00:13:57.447724+10,10,0,155,partially correct
4654,"select count(*) 
from (select distinct writer.id
from writer inner join person on writer.id=person.id and person.year_born=""1935"") as WP;
",2018-08-29 00:14:10.841312+10,1,1,139,correct
4655,"SELECT COUNT(*) FROM movie WHERE NOT EXISTS
(SELECT crew_award.title, crew_award.production_year FROM crew_award
WHERE crew_award.title=movie.title AND crew_award.production_year=
movie.production_year AND crew_award.result='won'
UNION
SELECT director_award.title, director_award.production_year FROM director_award
WHERE director_award.title=movie.title AND director_award.production_year=
movie.production_year AND director_award.result='won'
UNION
SELECT writer_award.title, writer_award.production_year FROM writer_award
WHERE writer_award.title=movie.title AND writer_award.production_year=
movie.production_year AND writer_award.result='won'
UNION
SELECT actor_award.title, actor_award.production_year FROM actor_award
WHERE actor_award.title=movie.title AND actor_award.production_year=
movie.production_year AND actor_award.result='won'
UNION
SELECT movie_award.title, movie_award.production_year FROM movie_award
WHERE movie_award.title=movie.title AND movie_award.production_year=
movie.production_year AND movie_award.result='won');",2018-08-29 00:15:10.421319+10,11,0,288,partially correct
4656,"select r.country
from movie as m, Restriction as r
where m.title=r.title and m.title='Shakespeare in Love' and description='M';",2018-08-29 00:15:15.632143+10,6,1,223,correct
4657,"SELECT
    r.id
FROM
    scene s NATURAL JOIN 
    appearance a
NATURAL JOIN    ROLE r
WHERE
   lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 00:15:38.795843+10,10,0,155,partially correct
4658,"select p.id
from person p
where p.year_born = (select max(year_born)
	from person
	where year_born<(select max(year_born) 
		from person));",2018-08-29 00:15:45.362312+10,3,1,149,correct
4659,"select WRITER id AND year_born from PERSON AND WRITER;
",2018-08-29 00:17:34.947996+10,1,0,380,noninterpretable
4660,"select e.id
from (

select c.id,count(*) as num
from (
select director.id,title
from director
UNION
select writer.id,title
from writer
) as c
group by c.id) as e

where e.num in

(select max(newg.num)
from (

select d.id,count(*) as num
from (
select director.id,title
from director
UNION
select writer.id,title
from writer
) as d
group by d.id) as newg);",2018-08-29 00:17:59.033786+10,14,1,344,correct
4661,"select p.id,p.first_name,p.last_name
from person as p
group by p.id
having max(year_born);",2018-08-29 00:20:49.999474+10,7,0,223,partially correct
4662,"WITH c AS (SELECT id, COUNT(*) num FROM role GROUP BY id)

SELECT p.id,first_name, last_name, title, production_year, description
FROM person p, role r, c
WHERE num =(SELECT MAX(num) FROM c) AND p.id = c.id AND p.id = r.id;",2018-08-29 00:23:06.240237+10,15,0,219,partially correct
4663,"WITH c AS (SELECT id, COUNT(*) num FROM role GROUP BY id)

SELECT first_name, last_name, title, production_year, description
FROM person p, role r, c
WHERE num =(SELECT MAX(num) FROM c) AND p.id = c.id AND p.id = r.id;",2018-08-29 00:23:22.434817+10,15,1,219,correct
4664,"select p.id,p.first_name,p.last_name
from person as p
where p.year_born=(
select max (year_born) from person);
",2018-08-29 00:23:32.715167+10,7,1,223,correct
4665,"select 
	p.id,
	a.award_name,
	a.category,
	a.year_of_award
from person p,
	director_award a,
	director d
where p.id=d.id
	and d.title = a.title
	and d.production_year = a.production_year
	and lower(a.result)='nominated';",2018-08-29 00:23:57.915263+10,13,1,149,correct
4666,select p.id from person p where p.year_born = (select max(year_born) from person where year_born<(select max(year_born) from person));,2018-08-29 00:24:10.237819+10,3,1,258,correct
4667,"SELECT *
FROM (movie_award NATURAL JOIN movie NATURAL JOIN director NATURAL JOIN person) AS bm
WHERE (lower(award_name) = 'bafta film award' AND lower(category) = 'best film');
",2018-08-29 00:24:16.611306+10,8,0,378,partially correct
4668,"SELECT dw.title,dw.production_year
FROM (person NATURAL JOIN movie NATURAL JOIN writer) AS dw
WHERE dw.first_name='Kevin' AND dw.last_name='Williamson' GROUP BY dw.title,dw.production_year;
",2018-08-29 00:24:41.268873+10,5,1,372,correct
4669,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-29 00:24:45.812965+10,12,1,370,correct
4670,"SELECT count*
from person p
WHERE EXISTS (SELECT * FROM writer w WHERE W.id = p.id AND p.year_born=1935);",2018-08-29 00:24:51.849769+10,1,0,380,noninterpretable
4671,"SELECT id
FROM PERSON p, PERSON q
WHERE NOT(p. year_born = q. year_born);",2018-08-29 00:27:48.393286+10,3,0,329,noninterpretable
4672,"select 
	p.id,
	a.award_name,
	a.category,
	a.year_of_award
from person p,
	director_award a,
	director d
where p.id=d.id
	and d.title = a.title
	and d.production_year = a.production_year
	and lower(a.result)='nominated'
	and d.id not in(
		select id 
		from director d,director_award da
		where
			 d.title = da.title
			and da.production_year = d.production_year
			and lower(a.result)='won'
		);",2018-08-29 00:29:06.310028+10,13,1,149,correct
4673,"SELECT count(*)
FROM (person NATURAL JOIN writer NATURAL JOIN writer_award) AS bb
GROUP BY bb.last_name
HAVING (bb.last_name = ""Allen"" AND bb.first_name = ""Woody"");",2018-08-29 00:29:21.804331+10,9,0,378,partially correct
4674,"
SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 00:29:58.29585+10,1,1,380,correct
4675,"select 
	d.id,
	a.award_name,
	a.category,
	a.year_of_award
from 
	director_award a,
	director d
where 
	d.title = a.title
	and d.production_year = a.production_year
	and lower(a.result)='nominated'
	and d.id not in(
		select id 
		from director d,director_award da
		where
			 d.title = da.title
			and da.production_year = d.production_year
			and lower(a.result)='won'
		);",2018-08-29 00:30:22.674664+10,13,1,149,correct
4676,"select 
	d.id,
	a.award_name,
	a.category,
	a.year_of_award
from 
	director_award a,
	director d
where 
	d.title = a.title
	and d.production_year = a.production_year
	and lower(a.result)='nominated'
	and d.id not in(
		select id 
		from director d,director_award da
		where
			 d.title = da.title
			and da.production_year = d.production_year
			and lower(a.result)='won'
		);",2018-08-29 00:30:30.822883+10,13,1,149,correct
4677,";
",2018-08-29 00:31:14.359297+10,15,0,247,noninterpretable
4678,";
",2018-08-29 00:31:22.702485+10,15,0,247,noninterpretable
4679,"SELECT COUNT(*) 
FROM WRITER w,PERSON p  
WHERE (p.id = w.id AND p.year_born = 1935);",2018-08-29 00:31:46.733377+10,1,0,329,partially correct
4680,"select 
	d.id,
	a.award_name,
	a.year_of_award,
	a.category
	
from 
	director_award a,
	director d
where 
	d.title = a.title
	and d.production_year = a.production_year
	and lower(a.result)='nominated'
	and d.id not in(
		select id 
		from director d,director_award da
		where
			 d.title = da.title
			and da.production_year = d.production_year
			and lower(a.result)='won'
		);",2018-08-29 00:32:19.323251+10,13,1,149,correct
4681,"SELECT country 
FROM restriction_category rc
NATURAL JOIN restriction r
WHERE rc.country=r.country
AND r.description='Shakespeare in Love'
AND r.description='M';
",2018-08-29 00:33:31.405524+10,6,0,372,partially correct
4682,SELECT * ;,2018-08-29 00:34:34.838053+10,2,0,380,noninterpretable
4683,"select count(*) 
from person p 
where (select * from director d where p.id = d.id);",2018-08-29 00:35:28.727261+10,12,0,357,noninterpretable
4684,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person as p, role as r,
(select id, count(*)as number_of_roles,title,production_year from role group by id)as n
where p.id=n.id 
and p.id = r.id 
and  n.number_of_roles =(select max(number_of_roles) from (select id, count(*)as number_of_roles,title,production_year from role group by id)as b); 
        ",2018-08-29 00:35:44.063319+10,15,1,33,correct
4685,"select title,production_year from movie where country='Australia';",2018-08-29 00:36:05.437484+10,1,0,104,partially correct
4686,"SELECT country
FROM restriction 
WHERE lower(title)='shakespeare in love'
AND description='M';

",2018-08-29 00:36:06.926117+10,6,1,372,correct
4687,"select * 
from director d,
	writer w 
where d.title =w.title
	and w.production_year =d.production_year
group by d.title,d.production_year;",2018-08-29 00:38:15.09601+10,14,0,149,partially correct
4688,"SELECT count(*)
FROM (person NATURAL JOIN writer NATURAL JOIN writer_award) AS bb
WHERE( bb.result = ""won"" AND bb.year_of_award > 1990 AND bb.year_of_award < 1996 AND bb.last_name = ""Allen"" AND bb.first_name = ""Woody"");

",2018-08-29 00:38:37.738626+10,9,1,378,correct
4689,"select count(*)
from writer_award
where id = (
select id 
from person
where lower(first_name) = lower('Woody') and lower(last_name) = lower('Allen'));
",2018-08-29 00:39:25.836981+10,9,0,347,partially correct
4690,"select first_name,last_name,title,production_year,description
from (select id,count(*) as num
from role
group by id) as e,role,person
where e.num in
(select max(num)
from
(select id,count(*) as num
from role
group by id) as d)

and e.id = role.id
and person.id = role.id;

",2018-08-29 00:39:51.435408+10,15,1,344,correct
4691,"select count(*)
from writer_award
where result = 'won' and id = (
select id 
from person
where lower(first_name) = lower('Woody') and lower(last_name) = lower('Allen'));
",2018-08-29 00:42:14.091727+10,9,1,347,correct
4692,"select dw.id from
(select a.id,count(*) as no_of_work from
(select d.id,d.production_year,d.title from director as d
	union
	select w.id,w.production_year,w.title from writer as w)as a
	group by a.id
)as dw
where dw.no_of_work =(select max(no_of_work) from (select b.id,count(*) as no_of_work from
(select d.id,d.production_year,d.title from director as d
	union
	select w.id,w.production_year,w.title from writer as w)as b
	group by b.id
));",2018-08-29 00:42:30.727652+10,14,1,33,correct
4693,"SELECT first_name,last_name,title,description,production_year
FROM (Person p INNER JOIN Role r ON p.id = r.id) 
WHERE (SELECT MAX(noOfRole)
FROM x1.noOfRole = (SELECT x.id, count(*)AS noOfRole
FROM (Person p INNER JOIN Role r ON p.id = r.id) AS x
Group by x.id)
AS x1);
",2018-08-29 00:43:03.502899+10,15,0,218,noninterpretable
4694,"ELECT id,first_name,last_name,MAX(year_born)
FROM person
GROUP BY id;
",2018-08-29 00:43:46.210774+10,7,0,372,noninterpretable
4695,"SELECT production_year,count(*)
FROM MOVIE m
WHERE ( m.production_year = 1993 or m.production_year = 1992 or m.production_year = 1991)
GROUP BY production_year;",2018-08-29 00:44:50.57483+10,2,1,329,correct
4696,"SELECT id,first_name,last_name               
FROM person p WHERE p.year_born= (SELECT MAX(year_born) FROM person);

",2018-08-29 00:45:07.140244+10,7,1,372,correct
4728,"select count(*)
from movie as m
where not exists (
select *
from movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where (m.title = ma.title and m.production_year = ma.production_year and ma.result = 'won')
or (m.title = ca.title and m.production_year = ca.production_year and ca.result = 'won'));",2018-08-29 01:31:54.46518+10,11,0,347,partially correct
4697,"select dw.id from(select a.id,count(*) as no_of_work from
(select d.id,d.production_year,d.title from director as d
	union
	select w.id,w.production_year,w.title from writer as w)as a
group by a.id)as dw

where dw.no_of_work=(select max(no_of_work)from (select a.id,count(*) as no_of_work from
(select d.id,d.production_year,d.title from director as d
	union
	select w.id,w.production_year,w.title from writer as w)as a
group by a.id)as dw)

;",2018-08-29 00:46:21.768165+10,14,1,33,correct
4698,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 00:48:21.684017+10,14,1,273,correct
4699,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT *
FROM director d
WHERE d.id = p.id
);",2018-08-29 00:50:55.651951+10,12,1,329,correct
4700,"select country from restriction where title='Shakespeare in Love';
",2018-08-29 00:51:04.326273+10,6,0,306,partially correct
4701,"select d.id, da.award_name, da.year_of_award, da.category from director d, director_award da where d.title=da.title and d. production_year=da.production_year and result='nominated' and result<>'won';",2018-08-29 00:51:13.041484+10,13,1,258,correct
4702,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 00:51:32.425435+10,14,1,149,correct
4703,; ,2018-08-29 00:52:33.152168+10,10,0,378,noninterpretable
4704,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 00:53:00.199894+10,15,0,273,partially correct
4705,"select count(*)
from movie
where not exists (select * from award as a
where 


and movie_award.award_name=a.award_name
and crew_award.award_name=a.award_name
and director_award.award_name=a.award_name
and writer_award.award_name=a.award_name

and actor_award.award_name=a.award_name);",2018-08-29 00:55:05.286968+10,11,0,22,noninterpretable
4706,"SELECT ww.id
FROM(scene NATURAL JOIN role NATURAL JOIN appearance) AS ww GROUP BY ww.id
HAVING count(*) =1;",2018-08-29 00:56:07.838508+10,10,0,378,partially correct
4707,"select count(*) 
from person p 
where not exists (select * from director d where p.id = d.id);",2018-08-29 00:57:07.933924+10,12,1,357,correct
4708,"select id, first_name, last_name from person where year_born is smallest;",2018-08-29 00:58:54.780674+10,7,0,306,noninterpretable
4709,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-29 00:59:50.139252+10,15,1,273,correct
4710,"SELECT COUNT*
FROM MOVIE
WHERE NOT EXISTS(SELECT title,production_year
FROM (movie_award NATURAL JOIN crew_award NATURAL JOIN director_award NATURAL JOIN writer_award
NATURAL JOIN actor_award)
;",2018-08-29 01:00:06.473482+10,11,0,368,noninterpretable
4711,"select first_name,
	last_name,
	title,
	production_year,
	description
	from person,role
	where;",2018-08-29 01:00:09.461896+10,15,0,149,noninterpretable
4712,"SELECT w.title, w.production_year
FROM Writer w, Person p
WHERE (w.id = p.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson');",2018-08-29 01:02:28.553154+10,5,1,329,correct
4713,"select ma.title,ma.production_year,p.first_name,p.last_name
from Movie_Award as ma,Director as d, person as p
where ma.award_name='BAFTA Film Award' and category='Best Film' 
and ma.title=d.title and d.id=p.id;",2018-08-29 01:03:51.622332+10,8,0,223,partially correct
4714,"select id
from scene, role
where scene.title = role.title and scene.production_year = role.production_year
and scene.title = 'Psycho' and scene.production_year = 1960
group by id having count(scene_no) = 1;",2018-08-29 01:04:52.63366+10,10,0,347,partially correct
4715,"

select p.id,p.first_name,p.last_name
from person p 
where EXISTS (select * from Director d , Writer w where d.id=w.id) AND (select count(*) as count_no from movie where count_no > 2)
GROUP BY p.id
;",2018-08-29 01:08:46.905663+10,4,0,309,noninterpretable
4716,"select id,first_name,last_name
from person 
NATURAL JOIN director NATURAL JOIN writer
group by id
having count(*)>1;


",2018-08-29 01:12:34.579683+10,4,1,309,correct
4717,"select id
from person p (delete from person p where year_born=max(year_born))
where year_born= (select max(year_born) from person p;",2018-08-29 01:14:02.838571+10,3,0,22,noninterpretable
4718,"select id
from scene, role, appearance
where scene.title = role.title and scene.production_year = role.production_year
and scene.title = 'Psycho' and scene.production_year = 1960
and scene.title = appearance.title and scene.production_year = appearance.production_year and scene.scene_no = appearance.scene_no
and role.description = appearance.description
group by id having count(*) = 1;",2018-08-29 01:17:07.173112+10,10,1,347,correct
4719,"SELECT first_name, last_name, title, production_year, description
FROM role, person, (SELECT id, COUNT(*) AS nor FROM role GROUP BY id) AS a
WHERE person.id=role.id AND person.id=a.id
AND a.nor=(SELECT MAX(nor) FROM 
(SELECT id, COUNT(*) AS nor FROM role GROUP BY id) AS b);",2018-08-29 01:20:47.516708+10,15,1,288,correct
4720,"select m.title,m.production_year
from Movie m,person p,writer w
Where p.first_name='Kevin' AND p.last_name='Williamson' AND p.id=w.id
GROUP BY m.production_year;",2018-08-29 01:22:17.609525+10,5,0,309,partially correct
4721,"SELECT m.title,m.production_year,p.first_name,p.last_name
FROM movie m,Movie_Award ma, director d,person p
WHERE(ma.category = 'Best Film' AND award_name = 'BAFTA Film Award' AND d.id = p.id
);",2018-08-29 01:22:30.213501+10,8,0,329,partially correct
4722,"select titles, production_year ;",2018-08-29 01:22:46.058997+10,8,0,306,noninterpretable
4723,"select d.id, da.award_name, da.year_of_award, da.category from director d, director_award da where d.title=da.title and d. production_year=da.production_year and result='nominated' and result<>'won';",2018-08-29 01:23:14.847542+10,14,0,258,partially correct
4724,"SELECT w.title, m.title, p.id
FROM Movie AS w, Writer AS w, Person AS p
WHERE  w.title=m.title
GROUP BY p;",2018-08-29 01:26:43.065862+10,4,0,370,noninterpretable
4725,"select m.title,m.production_year
from Movie m, 
person p NATURAL JOIN WRITER w
Where p.first_name='Kevin' AND p.last_name='Williamson' AND p.id=w.id 
GROUP BY m.production_year;",2018-08-29 01:26:45.633188+10,5,1,309,correct
4726,"select m.title,m.production_year
from Movie m, 
person p NATURAL JOIN WRITER w
Where p.first_name='Kevin' AND p.last_name='Williamson' AND p.id=w.id 
GROUP BY m.production_year;",2018-08-29 01:27:56.655546+10,5,1,309,correct
4727,"Select country from restriction
where title=""Shakespeare in Love"";",2018-08-29 01:31:43.478408+10,6,0,309,partially correct
4729,"Select country from restriction
where title='Shakespeare in Love';",2018-08-29 01:33:35.103854+10,6,0,309,partially correct
4760,"select count(*),production_year
from movie
where production_year ='1991' or production_year='1992' or production_year='1993'
group by production_year;",2018-08-29 03:15:42.774735+10,2,1,149,correct
4731,"SELECT m.title,m.production_year,p.first_name,p.last_name
FROM movie m,Movie_Award ma, director d,person p
WHERE(m.title =ma.title AND lower(ma.category) = 'best film' AND lower(ma.award_name) = 'bafta film award' AND ma.title = d.title AND ma.production_year = d.production_year AND d.id = p.id AND ma.result = 'won'
);",2018-08-29 01:34:45.965515+10,8,1,329,correct
4732,"Select country from restriction
where lower(title)='shakespeare in love' AND description='M';",2018-08-29 01:34:59.839972+10,6,1,309,correct
4733,"SELECT COUNT (year_of_award)
FROM person p, Writer_Award wa
WHERE(wa.id = p.id AND lower(wa.result) = 'won' AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen' AND year_of_award> 1990 AND year_of_award< 1996);",2018-08-29 01:39:06.238158+10,9,1,329,correct
4734,"SELECT p.id
FROM PERSON p
WHERE p.year_born=(SELECT MAX(a.year_born)
  FROM PERSON a
  WHERE year_born<(SELECT MAX(b.year_born)
     FROM PERSON b));

",2018-08-29 01:40:14.169298+10,3,1,280,correct
4735,"select count(*)
from (select distinct w.id, p.year_born
from PERSON p inner join WRITER w on p.id = w.id) as pw
where pw.year_born='1935';",2018-08-29 01:40:41.653216+10,1,1,64,correct
4736,"select count (*)
from movie as m
where not exists (
select title, production_year
from Movie_Award as ma
where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
union
select title, production_year
from Crew_Award
as ca
where ca.title = m.title and ca.production_year = m.production_year and lower(ca.result) = 'won'
union
select title, production_year
from Director_Award as da
where da.title = m.title and da.production_year = m.production_year and lower(da.result) = 'won'
union 
select title, production_year
from Writer_Award as wa
where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) = 'won'
union
select title, production_year
from Actor_Award as aa
where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) = 'won');",2018-08-29 01:47:46.960321+10,11,1,347,correct
4737,"select id,first_name,last_name,year_born
from person
where year_born=(select MAX(year_born) from person);",2018-08-29 01:48:24.63085+10,7,0,309,partially correct
4738,"select id,first_name,last_name,year_born
from person
where year_born=(select min(year_born) from person);",2018-08-29 01:48:40.450473+10,7,0,309,partially correct
4739,"select id,first_name,last_name
from person
where year_born=(select max(year_born) from person);",2018-08-29 01:49:16.405324+10,7,1,309,correct
4740,"select count(*)
from PERSON p
where p.id not in (select d.id 
from DIRECTOR d
);",2018-08-29 01:49:46.279182+10,12,1,64,correct
4741,"select title, production_year,first_name,last_name
from Movie_Award, person NATURAL JOIN director
where lower(award_name)='bafta film award' AND lower(category)='best film'
group by title
HAVING person.id=director.id;
",2018-08-29 01:56:10.309051+10,8,0,309,partially correct
4742,"SELECT p.id,ma.award_name,ma.year_of_award,ma.category
FROM PERSON p,movie_award ma,Director_Award da
WHERE(da.award_name = ma.award_name AND lower(ma.result) ='fail');",2018-08-29 01:59:52.379035+10,13,0,329,partially correct
4743,"select id 
from person
where year_born = ( select max (year_born)
from ( select id, year_born
from person 
group by person.year_born having count(*)>1) as pt);
",2018-08-29 02:00:22.081399+10,3,0,347,partially correct
4744,"select id 
from person
where year_born = (
select max(year_born)
from person
where year_born < (
select max(year_born)
from person));",2018-08-29 02:03:54.791562+10,3,1,347,correct
4745,"select m.title, m.production_year,p.first_name,p.last_name
from Movie_Award m, person p NATURAL JOIN director d
where p.id=d.id AND
lower(award_name)='bafta film award' AND 
lower(category)='best film' AND lower(result)='won'
;
",2018-08-29 02:05:39.225189+10,8,1,309,correct
4746,"select id, award_name, year_of_award, category, result
from director, director_award
where director.title = director_award.title and director.production_year = director_award.production_year and lower(director_award.result) = 'nominated'
group by id having count(*)>0;",2018-08-29 02:12:08.783154+10,13,0,347,partially correct
4747,"select id, award_name, year_of_award, category
from director, director_award
where director.title = director_award.title and director.production_year = director_award.production_year and lower(director_award.result) = 'nominated'
group by id having count(*)>0;",2018-08-29 02:12:22.637756+10,13,1,347,correct
4748,"select count(*) TOTAL
from writer_award w NATURAL JOIN person p
where w.id=p.id AND lower(p.first_name)='allen' AND lower(p.last_name)='woody'
AND year_of_award>=1991 AND year_of_award<=1995;",2018-08-29 02:17:09.105536+10,9,0,309,partially correct
4749,"select ma.title,ma.production_year,p.first_name,p.last_name
from (select title,production_year from Movie_Award where award_name='BAFTA Film Award' and category='Best Film' and result='won') as ma,person as p,director as d
where ma.title=d.title and ma.production_year=d.production_year and d.id=p.id;",2018-08-29 02:23:11.566819+10,8,0,223,partially correct
4750,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-29 02:26:20.670103+10,15,1,149,correct
4751,"select count(*) as TOTAL
from writer_award wa, person p, writer w
where

wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-29 02:31:12.385077+10,9,1,309,correct
4752,"select 
	x.count_number
from
	(select 
		count(*)as count_number,p.id 
	from 
		writer as w,
		person as p
	where 
		p.year_born ='1935'
		and w.id=p.id)as x;
",2018-08-29 02:33:16.411568+10,1,0,149,partially correct
4753,"select count(*)
from (select * from Writer_Award as wa, person as p where wa.id=p.id and p.first_name='Woody' and last_name='Allen' and  production_year<1996 and  production_year>1990) as wa
group by wa.id;",2018-08-29 02:38:17.950667+10,9,1,223,correct
4754,"select id 
from person p, scene a
where lower(a.title)='Psycho'AND production_year='1960';",2018-08-29 02:45:26.136638+10,10,0,309,partially correct
4755,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 02:48:36.945065+10,10,1,309,correct
4756,"SELECT r.id
FROM scene s,appearance a,ROLE r
WHERE s.title = a.title
AND s.production_year = a.production_year
AND s.scene_no = a.scene_no
AND s.title = r.title
AND s.production_year = r.production_year
AND a.description = r.description
AND lower(a.title) = 'psycho'
AND a.production_year = '1960'
GROUP BY r.id HAVING count(*) = 1;
",2018-08-29 02:52:32.883866+10,10,1,77,correct
4757,"Select *
From Movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
Where ma.result='nominated'
AND ca.result='nominated'
AND da.result='nominated'
AND wa.result='nominated'
AND aa.result='nominated'
Group by m.title;",2018-08-29 03:08:27.694996+10,11,0,77,partially correct
4758,"select 
	count(*)
from
	(select 
		count(*),p.id
	from 
		writer as w,
		person as p
	where 
		p.year_born ='1935'
		and w.id=p.id)as x;
",2018-08-29 03:10:22.064651+10,1,1,149,correct
4759,"select production_year,count(*)
from movie
where production_year ='1991' and production_year='1992' and production_year='1993';",2018-08-29 03:13:51.615478+10,2,0,149,partially correct
5237,select count(*) from person p left join director d on p.id=d.id where title is null;,2018-08-29 15:58:08.437622+10,12,1,117,correct
4762,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 03:29:37.265363+10,11,1,77,correct
4763,"SELECT m.title, m.production_year 
FROM movie m, kw(SELECT p.id FROM person p WHERE p.first_name=Kevin, p.last_name=Williamson AS kw) 
WHERE w.id=kw.id and w.title=m.title;",2018-08-29 03:52:36.642855+10,5,0,86,noninterpretable
4764,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-29 03:53:03.868698+10,5,1,86,correct
4765,;,2018-08-29 03:54:01.671287+10,6,0,86,noninterpretable
4766,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-29 03:54:32.799346+10,6,1,86,correct
4767,;,2018-08-29 03:54:55.491436+10,7,0,86,noninterpretable
4768,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-29 03:55:17.915184+10,7,1,86,correct
4769,"SELECT * from MOVIE;

",2018-08-29 03:55:39.501586+10,3,0,77,partially correct
4770,;,2018-08-29 03:55:43.013123+10,8,0,86,noninterpretable
4771,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 03:56:19.825455+10,8,1,86,correct
4772,;,2018-08-29 03:56:44.715277+10,9,0,86,noninterpretable
4773,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-29 03:57:07.597743+10,9,1,86,correct
4774,;,2018-08-29 04:00:56.450831+10,10,0,86,noninterpretable
4775,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 04:01:26.849575+10,10,1,86,correct
4776,;,2018-08-29 04:02:05.21541+10,11,0,86,noninterpretable
4777,"SELECT p.id
FROM person p
where year_born = (Select max(year_born) from person p
Where year_born < (Select max(year_born)from person p));",2018-08-29 04:05:52.431272+10,3,1,77,correct
4778,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 04:11:30.314701+10,11,1,86,correct
4779,"Select Director.id
from Director_award, Director
Where Director_award.result='nominated'
Group by director.id Having count(director.id)>=1
MINUS
Select Director.id
from Director_award, Director
Where Director_award.result='won'
Group by director.id Having count(director.id)>=1;",2018-08-29 04:34:29.91241+10,13,0,77,noninterpretable
4780,SElect * from MOVIE;,2018-08-29 04:44:39.581278+10,14,0,77,partially correct
4781,select * from Movie;,2018-08-29 05:07:38.447528+10,15,0,77,partially correct
4782,;,2018-08-29 05:21:43.999999+10,3,0,86,noninterpretable
4783,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-29 05:22:26.846644+10,3,1,86,correct
4784,;,2018-08-29 05:23:00.379125+10,13,0,86,noninterpretable
4785,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
Where da.title = d.title
    AND da.production_year = d.production_year
    And da.result='nominated'
    And d.id not in (select d.id
			    from director_award da, director d
			    where da.title = d.title
    			AND da.production_year = d.production_year
    			And da.result='won');",2018-08-29 05:56:22.183437+10,13,1,77,correct
4786,"select count(w.result)
from writer_award as w
Natural join person as p where p.first_name like ""Woody"" and
p.last_name like ""Allen"" and w.year_of_award IN (1991, 1992, 1993, 1994, 1995) and w.result =""won"";",2018-08-29 05:59:42.964938+10,9,1,111,correct
4787,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-29 06:06:31.561754+10,13,1,86,correct
4788,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-29 06:06:56.411368+10,13,1,86,correct
4789,;,2018-08-29 06:07:16.952146+10,14,0,86,noninterpretable
4790,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 06:07:36.604112+10,14,1,86,correct
4791,"select distinct role.id from role 
where role.title = 'Psycho' and role.production_year = '1960';



",2018-08-29 06:11:45.477227+10,10,0,111,partially correct
4792,;,2018-08-29 06:29:04.41406+10,15,0,86,noninterpretable
4853,"SELECT c.id
FROM crew AS c,scene AS s,movie m
 WHERE m.title=c.title
AND s.title=m.title
 AND s.production_year=m.production_year
 AND c.production_year=m.production_year
AND lower(m.title)='psycho'
AND m.production_year=1960
AND s.scene_no=1;
",2018-08-29 10:28:28.112159+10,10,0,372,partially correct
5956,"select id
from person
group by year_born
having year_born=max(year_born)-1;",2018-08-29 22:56:18.674959+10,3,0,351,partially correct
4793,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-29 06:30:20.802023+10,15,1,86,correct
4794,"select count(m.title)
from movie as m
 where not exists (select *
 FROM MOVIE_AWARD as ma, CREW_AWARD as c, DIRECTOR_AWARD as d, 
 WRITER_AWARD as w, ACTOR_AWARD as a
 where ma.result = 'won' and c.result = 'won' and d.result = 'won' and 
 w.result = 'won' and
 a.result = 'won');
 ",2018-08-29 06:42:56.770842+10,11,0,111,partially correct
4795,"SELECT count(*) 
FROM movie m 
WHERE not exists (
SELECT title, production_year 
FROM movie_award ma 
WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT title, production_year 
FROM crew_award ca 
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year 
FROM director_award da 
WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION
SELECT title, production_year 
FROM actor_award aa 
WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
UNION
SELECT title, production_year 
FROM writer_award wa 
WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 06:45:59.610316+10,11,1,111,correct
4796,"select id
from
(select id,count(*) as c
from writer
group by id
union
select id,count(*) as c
from director
group by id)
where c=(select max(c)
from 
(select id,count(*) as c
from writer
group by id
union
select id,count(*) as c
from director
group by id)
);",2018-08-29 07:02:30.548379+10,14,1,336,correct
4797,"select p.id from person as p where year_born = (SELECT MIN(year_born) from
(select year_born from person where year_born > 
(select min(year_born) from person) 
and year_born < (select MAX(year_born) from person)
));",2018-08-29 07:22:56.806532+10,3,0,111,partially correct
4798,"select p.id from person as p where year_born = (SELECT MAX(year_born) from
(select year_born from person where year_born > 
(select min(year_born) from person) 
and year_born < (select MAX(year_born) from person)
));",2018-08-29 07:26:11.957743+10,3,1,111,correct
4799,"select p.id from person as p where year_born = (SELECT MAX(year_born) from
(select year_born from person where year_born < (select MAX(year_born) from person)
));",2018-08-29 07:28:40.585239+10,3,1,111,correct
4800,"select production_year,count(*) 
from 
	movie 
group by production_year
having
	production_year between '1991' and '1993';",2018-08-29 07:42:37.291159+10,2,1,149,correct
4801,"select p.first_name, p.last_name
from (
select title, production_year
from movie_award
where award_name = lower(""BAFTA Film Award"") and category = lower(""Best Film"") ) as ma
, person p, director d
where 
p.id = d.id and ma.title = ma.title;",2018-08-29 07:42:44.191785+10,8,0,102,partially correct
4802,"select count(*)
from 
	 person as p
where 
	p.id not in (select id from director);",2018-08-29 07:48:10.117623+10,12,1,149,correct
4803,"select p.id,p.first_name,p.last_name
from 
	person as p,
	(select w.id,w.title,w.production_year 
		from director as d,writer as w
		group by w.id 
		having count(*)>=2 and w.id=d.id and w.title=d.title and w.production_year = d.production_year)as x
where 
	p.id=x.id;
",2018-08-29 07:54:29.667444+10,4,0,149,partially correct
4804,select * from movie limit 10;,2018-08-29 07:54:50.790908+10,10,0,194,partially correct
4805,select * from movie limit 1;,2018-08-29 07:55:56.164058+10,13,0,194,partially correct
4806,"select count(Person.id) as number
	from Person
	where year_born = '1935';",2018-08-29 08:23:20.656504+10,1,0,387,partially correct
4807,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 08:23:58.237019+10,1,1,387,correct
4808,"SELECT count(*)
	from person
	inner join 
		writer
		on person.id = writer.id
		where person.year_born = '1935'
		;
",2018-08-29 08:26:22.974343+10,1,0,387,partially correct
4809,"SELECT count(*)
	from person p
	where exists
		(select * 
			from writer w
				where w.id = p.id and
					p.year_born =1935)
					;",2018-08-29 08:31:09.005136+10,1,1,387,correct
4810,"select dw.id,dw.first_name,dw.last_name
from (person natural join writer natural join director)as dw
group by dw.id
having count(*)>=2;
",2018-08-29 08:46:33.094091+10,4,1,149,correct
4811,"select production_year, number
from
	(
	select production_year, count(production_year) as number
	from movie
	group by production_year
	)
	where production_year=1993 or production_year=1992 or production_year=1991

		;",2018-08-29 08:49:36.800651+10,2,1,387,correct
4812,"select d.title,d.production_year
from writer as d,
	person p
where 
	d.id=p.id
	and lower(p.first_name) ='kevin'
	and lower(p.last_name) ='williamson';

",2018-08-29 08:50:54.86947+10,5,1,149,correct
4813,"select country
from restriction as r
where lower(r.title)='shakespeare in love' and r.description ='M';",2018-08-29 08:53:43.501927+10,6,1,149,correct
4814,"select p.id,p.first_name,p.last_name
from person as p
where p.year_born in (select max(x.year_born)
			from (select year_born from person)as x);",2018-08-29 08:56:15.832018+10,7,1,149,correct
4815,"SELECT COUNT(*)
FROM writer
WHERE (production_year = 1935);",2018-08-29 09:06:30.448106+10,1,0,177,partially correct
4816,"SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS (SELECT *
			FROM WRITER w
			WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 09:15:53.564079+10,1,1,177,correct
4817,"select r.id
from role as r,appearance as a,scene as s
where s.title=a=title
and s.production_year=a.production_year
and s.title=r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-29 09:30:05.978775+10,10,0,91,noninterpretable
4818,"select r.id
from role as r,appearance as a,scene as s
where s.title=a.title
and s.production_year=a.production_year
and s.title=r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-29 09:31:04.170066+10,10,0,91,partially correct
4819,"SELECT title,production_year
FROM movie_award
WHERE movie_award.category='Best Film';",2018-08-29 09:31:08.259443+10,8,0,372,partially correct
4820,"select r.id
from role as r,appearance as a,scene as s
where s.title=a.title
and s.production_year=a.production_year
and s.scene_no=a.scene_no
and s.title=r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-29 09:32:21.52886+10,10,1,91,correct
4821,"Select Count(*) From Person p Where Exists (Select * From Writer w Where p.id = w.id And p.year_born = 1935);
",2018-08-29 09:32:24.654241+10,1,1,247,correct
4822,"SELECT production_year, COUNT(*)
FROM MOVIE m
WHERE (m.production_year = 1993);",2018-08-29 09:34:03.407847+10,2,0,177,partially correct
4823,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won'
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won'
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won'
);",2018-08-29 09:41:32.938885+10,11,0,91,noninterpretable
5010,"SELECT production_year,COUNT(*)
FROM movie m
WHERE m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991
GROUP BY m.production_year
;
",2018-08-29 14:04:42.192033+10,2,1,343,correct
6511,select country from restriction where lower(title) = 'shakespeare in love' and description='M';,2018-08-30 11:16:50.194391+10,6,1,99,correct
4824,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma
	WHERE lower(ma.result) = 'won'
	union
	SELECT title, production_year 
	FROM crew_award ca
	WHERE lower(ca.result) = 'won'
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won'
);",2018-08-29 09:42:56.397518+10,11,0,91,partially correct
4825,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma
	WHERE lower(ma.result) = 'won'
	union
	SELECT title, production_year 
	FROM crew_award ca
	WHERE lower(ca.result) = 'won'
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' 
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won'
);",2018-08-29 09:45:54.56539+10,11,0,91,partially correct
4826,select * from  role where title='Psycho' and production_year=1960;,2018-08-29 09:46:03.501954+10,10,0,101,partially correct
4827,"SELECT production_year, COUNT(*)
FROM MOVIE m
WHERE (m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993)
GROUP BY production_year;",2018-08-29 09:46:23.639938+10,2,1,177,correct
4828,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 09:48:53.189207+10,11,1,91,correct
4829,"SELECT ma.title,ma.production_year,first_name,last_name
FROM (SELECT title, production_year FROM movie_award
WHERE
lower(movie_award.award_name)='bafta film award'
AND lower(movie_award.category)='best film'
AND lower(movie_award.result)='won') AS ma,
director AS d, 
person AS p
WHERE
ma.title=d.title 
AND ma.production_year=d.production_year
AND d.id=p.id;
",2018-08-29 09:49:43.505775+10,8,1,372,correct
4830,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT *
			FROM DIRECTOR d
			WHERE p.id = d.id);",2018-08-29 09:50:50.560657+10,12,1,177,correct
4831,Select Count(id) From Person p Where Not Exists (Select * From Director d Where p.id = d.id);,2018-08-29 09:55:56.31822+10,12,1,247,correct
4832,"SELECT id, Count(scene_no) as No_Scene From
(SELECT r.id, r.title, r.production_year from ROLE r
left join scene s
on r.title=s.title and r.production_year = s.production_year
) as combine 
Group by id
having No_Scene=1
AND lower(title)='psycho'
AND production_year=1960;
",2018-08-29 09:57:54.421869+10,10,0,198,noninterpretable
4833,"select * from  role where title=""psycho"";",2018-08-29 09:59:02.870843+10,10,0,101,partially correct
4834,"select id 
from person
where p.year_born=(
select max(year_born) from person as p
where p.year_born <(
select max(year_born) from person)
);
",2018-08-29 10:02:20.314155+10,3,0,91,noninterpretable
4835,"select id 
from person
where person.year_born=(
select max(year_born) from person as p
where p.year_born <(
select max(year_born) from person)
);",2018-08-29 10:02:43.736487+10,3,1,91,correct
4836,"select id,first_name,last_name from person where year_born >=  (select max(year_born) from person);",2018-08-29 10:03:18.563994+10,7,1,29,correct
4837,"SELECT id, first_name, last_name
FROM DIRECTOR d
WHERE;",2018-08-29 10:08:39.698229+10,4,0,177,noninterpretable
4838,"SELECT r.id
FROM 
scene s,
appearance a,
role r
WHERE a.title=s.title
AND s.title=r.title
AND a.production_year=s.production_year
AND s.production_year=r.production_year
AND a.scene_no=s.scene_no
AND a.description=r.description
AND lower(a.title)='psycho'
AND a.production_year=1960
Group by r.id
Having COUNT(*)=1;",2018-08-29 10:10:24.094103+10,10,1,198,correct
4839,"SELECT COUNT(result)
FROM(SELECT first_name,last_name FROM person 
WHERE lower(person.first_name)='woody'
AND lower(person.last_name)='allen'),movie_award
WHERE lower(movie_award.result)='won'
AND production_year>1990
AND production_year<1996;
",2018-08-29 10:10:25.665658+10,9,0,372,partially correct
4840,"select id
from (select id, count(*) as num
	from (select d.id, title, production_year 
		from director d 
		union 
		select w.id, title, production_year 
		from writer w
		) 
	group by id) nj
where nj.num = (
	(select max(num)
		from (select id, count(*) as num
			from (select d.id, title, production_year 
				from director d 
				union 
				select w.id, title, production_year 
				from writer w
				)
			group by id)
		)
	)
;",2018-08-29 10:12:35.651075+10,14,1,109,correct
4841,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 10:12:53.650678+10,10,1,136,correct
4842,"select t.id from (select t0.id, count(*) as Number from (select w.id, w.production_year, w.title from writer w union select d.id, d.production_year, d.title from director d) t0 group by t0.id) t where t.Number=(select max(t2.Number) from (select t1.id, count(*) as Number from (select w.id, w.production_year, w.title from writer w union select d.id, d.production_year, d.title from director d) t1 group by t1.id) t2);",2018-08-29 10:13:10.547976+10,14,1,258,correct
4843,"SELECT DISTINCT m.title, ma.title FROM Movie m, Moive_award ma
Where EXISTS m.title not in (ma.title);",2018-08-29 10:16:39.915741+10,11,0,198,noninterpretable
4844,"Select Distinct id, first_name, last_name From Person Writer Where (Select Count(*) From Director As d Where d.id = Writer.id) > 2;
",2018-08-29 10:17:09.082913+10,4,0,247,partially correct
4845,"Select Distinct id, first_name, last_name From Person Writer Where (Select Count(*) From Director As d Where d.id = Writer.id) > 2;
",2018-08-29 10:17:23.496313+10,4,0,247,partially correct
4846,"select count(p.id) from person p where exists (select * from person,writer where person.id = writer.id and person.year_born = 1935);",2018-08-29 10:18:15.458486+10,1,0,200,partially correct
4847,"SELECT COUNT(*) AS number_award 
FROM person p, 
writer w,
writer_award wa
WHERE wa.title=w.title
AND wa.production_year=w.production_year
AND wa.id=w.id
AND w.id=p.id
AND lower(result)='won'
AND lower(first_name)='woody'
AND lower(last_name)='allen'
AND year_of_award>=1991
AND year_of_award<=1995;
",2018-08-29 10:18:37.192022+10,9,1,372,correct
4848,"Select dw.first_name, dw.last_name, dw.id From (Person p Natural Join Director d Natural Join Writer w) As dw Group By dw.id Having Count(*) >1;
",2018-08-29 10:20:27.141229+10,4,1,247,correct
4849,"Select dw.id, dw.first_name, dw.last_name From (Person p Natural Join Director Natural Join Writer) As dw Group By dw.id Having Count(*) >1;
",2018-08-29 10:21:53.581251+10,4,1,247,correct
4850,"select person.first_name,person.last_name,role.title,role.production_year,role.description
from (select id,max(c)
from (select id,count(*) as c
from role
group by id)) as a,person,role
where a.id=person.id
     and a.id=role.id;",2018-08-29 10:24:43.467766+10,15,1,336,correct
4851,"SELECT dw.id, dw.first_name, dw.last_name
FROM (PERSON p NATURAL JOIN DIRECTOR d NATURAL JOIN WRITER w) AS dw
GROUP BY dw.id
HAVING COUNT(*) > 1;",2018-08-29 10:26:16.98958+10,4,1,177,correct
4852,"select count(*) from writer w
where w.id=(select a.id from writer_award a) and w.id=(select p.id from 
person p where lower(first_name)='allen' and lower(last_name)='woody');",2018-08-29 10:27:59.07255+10,9,0,18,partially correct
4854,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-29 10:30:03.304329+10,9,1,18,correct
4855,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 10:30:37.605464+10,4,1,238,correct
4856,"SELECT id, first_name, last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 10:31:08.434189+10,4,1,238,correct
4857,"select d.title,d.production_year,p.first_name,p.last_name
from
	person as p,
	director as d,
	movie_award as ma
where
	lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won'
	and ma.title=d.title
	and ma.production_year = d.production_year
	and d.id=p.id;",2018-08-29 10:33:15.98556+10,8,1,149,correct
4858,"select id from role
where production_year=1960 and lower(title)='psycho';",2018-08-29 10:34:30.519709+10,10,0,18,partially correct
4859,"select count(*)
from (select distinct person.id
from person inner join writer on person.id=writer.id
where person.year_born='1935') as dwp;
",2018-08-29 10:34:49.561615+10,1,1,354,correct
4860,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 10:35:15.437981+10,10,1,18,correct
4861,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-29 10:35:26.836898+10,5,1,259,correct
4862,"select pd.title,pd.production_year,pd.first_name,pd.last_name
from
	(person natural join director) as pd,
	movie_award as ma
where
	lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won'
	and ma.title=pd.title
	and ma.production_year = pd.production_year;
",2018-08-29 10:37:39.35041+10,8,1,149,correct
4863,"SELECT mk.title, mk.production_year
FROM (MOVIE m NATURAL JOIN (SELECT *
					FROM WRITER w
					WHERE w.id = Kevin Williamson)) AS mk
GROUP BY mk.title;",2018-08-29 10:40:49.299951+10,5,0,177,noninterpretable
4864,"select count(*) from movie m
where m.title!=(select ma.title from movie_award ma) and m.title!=(select ca.title from crew_award ca)
and m.title!=(select da.title from director_award da) and m.title!=(select wa.title from writer_award  wa)
and m.title!=(select aa.title from actor_award aa;",2018-08-29 10:42:36.432418+10,11,0,18,noninterpretable
4865,"select count(*) from movie m
where m.title!=(select ma.title from movie_award ma) and m.title!=(select ca.title from crew_award ca)
and m.title!=(select da.title from director_award da) and m.title!=(select wa.title from writer_award  wa)
and m.title!=(select aa.title from actor_award aa);",2018-08-29 10:42:54.186631+10,11,0,18,partially correct
4866,"SELECT id, first_name, last_name
FROM person p
WHERE EXSITS(SELECT *, count(*) 
FROM writer w 
WHERE w.id = p.id AND  );",2018-08-29 10:43:35.449434+10,4,0,366,noninterpretable
4867,"select m.title,m.production_year from movie m, writer w,person p
where(m.title = w.title and w.id=p.id and p.first_name=""Kevin"" and p.last_name=""Williamson"");",2018-08-29 10:44:04.914268+10,5,1,238,correct
4868,"select production_year, count(*)
from movie m
where production_year= '1993' or production_year='1992' or production_year='1991'
group by production_year;",2018-08-29 10:44:06.716783+10,2,1,354,correct
4869,"select a.number_count
	from (select wa.id,count(*) as number_count
		from person as p,
			writer_award as wa
		where
			lower(p.first_name)='woody'
			and lower(p.last_name) ='allen'
			and p.id=wa.id
			and lower(wa.result)='won'
			and year_of_award>=1991 
			and year_of_award<=1995
		group by wa.id)as a;",2018-08-29 10:45:28.062455+10,9,1,149,correct
4870,"SELECT country
FROM ROLE, restriction_category r 
WHERE role.title ='Shakespeare in Love'AND r.description ='M';",2018-08-29 10:46:26.67794+10,6,0,370,partially correct
4871,"select count(*) from movie as m where not exists(
select title and production_year from movie_award as ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result) = 'won'
union
select title and production_year from crew_award as ca where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result) = 'won'
union
select title and production_year from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result) = 'won'
union
select title and production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result) = 'won'
union
select title and production_year from actor_award ac where ac.title=m.title and ac.production_year=m.production_year and lower(ac.result) = 'won'

);",2018-08-29 10:46:56.330353+10,11,1,101,correct
4872,"select country from restriction r
where(description=""M"" and title =""Shakespeare in Love"");",2018-08-29 10:47:36.682445+10,6,1,238,correct
4873,"SELECT  r.country
FROM restriction r
WHERE r.title = 'Shakespeare in Love' AND r.description = 'M';
",2018-08-29 10:47:37.785474+10,6,1,259,correct
4874,"select id,first_name,last_name from person p
where(min(year_born));",2018-08-29 10:49:03.422811+10,7,0,238,noninterpretable
4875,"SELECT country
FROM restriction r 
WHERE r.title ='Shakespeare in Love'AND r.description ='M';",2018-08-29 10:49:10.064888+10,6,1,370,correct
4876,Select country From Restriction_Category As r Where Exists(Select title From Movie As m Where m.title = 'Shakespeare in Love' And r.description = 'M');,2018-08-29 10:50:51.916421+10,6,0,247,partially correct
4877,select * from person;,2018-08-29 10:51:07.80568+10,3,0,101,partially correct
4878,"select id,first_name,last_name from person p
where(p.year_born=(select max(year_born) from person));",2018-08-29 10:51:47.709416+10,7,1,238,correct
4879,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 10:52:08.142438+10,10,1,372,correct
4880,"SELECT p.first_name, p.last_name,p.id, MAX(year_born)
FROM PERSON p
WHERE GROUP BY p.first_name, p.last_name, p.id;",2018-08-29 10:52:09.698142+10,7,0,370,noninterpretable
4881,Select country From Restriction r Where r.title = 'Shakespeare in Love' And r.description = 'M';,2018-08-29 10:52:16.347565+10,6,1,247,correct
4882,"SELECT COUNT(*)
FROM movie 
WHERE NOT EXISTS(SELECT*FROM movie_award,crew_award,director_award,writer_award,actor_award);
",2018-08-29 10:56:00.737192+10,11,0,372,partially correct
4883,"select count(*)
from person p 
where not exists(select *
from director d 
where p.id=d.id); 
",2018-08-29 10:56:01.581051+10,12,1,354,correct
4884,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 10:56:46.562095+10,10,1,244,correct
4885,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 10:56:47.591701+10,10,1,244,correct
4886,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-29 10:58:05.58393+10,11,1,372,correct
4887,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 10:58:45.0571+10,10,1,244,correct
4888,"select m.title,m.production_year from movie_award m
where(m.award_name=""BAFTA Film Award"" and m.category=""Best Film"");",2018-08-29 10:59:21.488817+10,8,0,238,partially correct
4889,select p.id from person as p where p.year_born=(select max(year_born) from person where year_born<(select max(year_born) from person));,2018-08-29 11:02:40.423328+10,3,1,101,correct
4890,"select p.id, p.first_name, p.last_name, count(*)
from person p, director d, writer w
where p.id=d.id=w.id
group by p.id, p.first_name, p.last_name
having count(*)>1;",2018-08-29 11:03:54.303653+10,4,0,354,partially correct
4891,"SELECT w.title, w.production_year
FROM WRITER w, PERSON p
WHERE w.id = p.id 
	AND p.first_name = 'Kevin' 
	AND p.last_name = 'Williamson';",2018-08-29 11:05:21.782684+10,5,1,177,correct
4892,"select Restriction.country
from movie, Restriction
where movie.title = Restriction.title 
and movie.production_year and Restriction.production_year
and movie.title = 'Shakespeare in Love' and Restriction.description = 'M';",2018-08-29 11:06:22.479013+10,6,1,123,correct
4893,"Select id, first_name, last_name From Person Where year_born = (Select Min(year_born) From Person);
",2018-08-29 11:06:34.312402+10,7,0,247,partially correct
4894,"select m.title,m.production_year,first_name,last_name from movie_award m,person p,director d
where(p.id=d.id and d.title=m.title and m.award_name=""BAFTA Film Award"" and lower(m.category)=""best film"");",2018-08-29 11:06:40.568294+10,8,0,238,partially correct
4895,SELECT COUNT(*) FROM Writer W INNER JOIN PERSON P ON W.id=P.id WHERE P.year_born=1935;,2018-08-29 11:06:59.71977+10,1,0,388,partially correct
4896,"select p.id, p.first_name, p.last_name,count(*)
from person p, director d, writer w
where p.id=d.id
and p.id=w.id
group by p.id, p.first_name, p.last_name
having count(*)>1;",2018-08-29 11:07:49.538567+10,4,0,354,partially correct
4897,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born = MIN(p.year_born)
GROUP BY p.id;",2018-08-29 11:07:57.176384+10,7,0,259,noninterpretable
4898,"select p.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=d.id
and p.id=w.id
group by p.id, p.first_name, p.last_name
having count(*)>1;",2018-08-29 11:08:29.689678+10,4,0,354,partially correct
4899,"select m.title,m.production_year,first_name,last_name from movie_award m,person p,director d
where(p.id=d.id and d.title=m.title and m.award_name=""BAFTA Film Award"" and lower(m.category)=""best film"" and m.result = ""won"");",2018-08-29 11:09:07.786312+10,8,1,238,correct
4900,"select p.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=d.id
and d.id=w.id
and p.id=w.id
group by p.id, p.first_name, p.last_name
having count(*)>1;",2018-08-29 11:09:28.316281+10,4,0,354,partially correct
4901,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born =(
          SELECT
		  max(year_born)
		  FROM person);",2018-08-29 11:09:41.077688+10,7,1,259,correct
4902,"select count(m.title)
from movie m,Movie_Award ma,Crew_Award ca,Director_Award da,Writer_Award wa,Actor_Award aa
where m.title=ma.title
and m.production_year=ma.production_year
and m.title=ca.title
and m.production_year=ca.production_year
and m.title=da.title
and m.production_year=da.production_year
and m.title=wa.title
and m.production_year=wa.production_year
and m.title=aa.title
and m.production_year=aa.production_year
and ma.result<>'won' and   ca.result<>'won'and da.result<>'won' and wa.result<>'won' and aa.result<>'won';

",2018-08-29 11:10:55.409705+10,11,0,244,partially correct
4903,"SELECT m.title, m.production_year, d;",2018-08-29 11:12:58.777884+10,8,0,259,noninterpretable
4904,"SELECT country
FROM RESTRICTION r
WHERE r.title = 'Shakespeare in Love';",2018-08-29 11:12:58.862055+10,6,0,177,partially correct
4905,"select p.id, p.first_name, p.last_name 
from person p, director d, writer w
where p.id=d.id
and d.id=w.id
and p.id=w.id
and d.title=w.title
and d.production_year=w.production_year
group by p.id, p.first_name, p.last_name
having count(*)>1;",2018-08-29 11:13:10.91541+10,4,1,354,correct
4906,"select count(*) 
from person p
where not exists (select * from director d where p.id = d.id);",2018-08-29 11:15:06.619543+10,12,1,357,correct
4907,"select p.id,award_name,year_of_award,category from director_award da inner join director d inner join person p 
where da.title=d.title and da.production_year=d.production_year and d.id=p.id and result='nominated';",2018-08-29 11:17:10.235745+10,13,1,101,correct
4908,"select id, fist_name, last_name
from person p;",2018-08-29 11:19:26.549735+10,4,0,357,noninterpretable
4909,"select id from director d,scene s,movie m
where(m.title = ""Psycho"" and m.production_year=1960 and m.title = d.title)
group by s.scene_no
having count(*)>1;",2018-08-29 11:21:06.518403+10,10,0,238,partially correct
4910,SELECT COUNT(*) FROM (SELECT * FROM Writer W INNER JOIN PERSON P ON W.id=P.id WHERE P.year_born=1935 GROUP BY W.id);,2018-08-29 11:22:06.60826+10,1,1,388,correct
4911,"select m.title, m.production_year
from movie m inner join writer w on m.title=w.title 
and m.production_year=w.production_year
where exists (select *
from writer w1 inner join person p1 on w1.id=p1.id
where p1.first_name='Kevin' and p1.last_name='Williamson');",2018-08-29 11:22:21.127538+10,5,0,354,partially correct
4912,"SELECT country
FROM RESTRICTION r
WHERE r.title = 'Shakespeare in Love' AND r.description = 'M';",2018-08-29 11:22:37.696196+10,6,1,177,correct
4913,"select id, first_name, last_name
from person
order by year_born limit 1
;",2018-08-29 11:24:22.180793+10,7,0,123,partially correct
4914,"select count(*)
from movie m
where not exists( 
select title,production_year
from Movie_Award ma 
where lower(ma.result)='won' and m.title=ma.title
and m.production_year=ma.production_year 
union 
select title,production_year
from Crew_Award ca where lower(ca.result)='won' and m.production_year=ca.production_year
and m.title=ca.title
union 
select title,production_year
from Director_Award da where lower(da.result)='won' and m.production_year=da.production_year
and m.title=da.title
union 
select title,production_year
from Writer_Award wa where lower(wa.result)='won' and m.production_year=wa.production_year
and m.title=wa.title
union 
select title,production_year
from Actor_Award aa where lower(aa.result)='won' and m.production_year=aa.production_year
and m.title=aa.title);




",2018-08-29 11:24:33.435697+10,11,1,244,correct
4915,"select w1.title, w1.production_year
from writer w1 inner join person p1 on w1.id=p1.id
where p1.first_name='Kevin' and p1.last_name='Williamson';",2018-08-29 11:26:22.05818+10,5,1,354,correct
4916,"select r.id from role r,appearance a,scene s
where a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and s.title=r.title
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id having count(*)=1;",2018-08-29 11:26:27.888117+10,10,0,341,partially correct
5012,"Select id,first_name,last_name
FROM person p
WHERE year_born>=( select MAX(year_born)
                   from person);",2018-08-29 14:06:34.625296+10,7,1,252,correct
6513,"select country 
from restriction
where title='Shakespeare in Love'
and description='M';",2018-08-30 11:17:34.426889+10,6,1,140,correct
4917,"select r.id from role r,appearance a,scene s
where a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and s.title=r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id having count(*)=1;",2018-08-29 11:27:46.606996+10,10,1,341,correct
4918,"select id, first_name, last_name
from person
order by year_born desc limit 1
;",2018-08-29 11:28:08.468634+10,7,1,123,correct
4919,"select country
from restriction
where title='Shakespeare in Love'
and description='M';",2018-08-29 11:29:35.376012+10,6,1,354,correct
4920,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 11:31:49.055146+10,8,1,259,correct
4921,"select id
from person p,person s
where p.year_born=s.year_born;",2018-08-29 11:32:21.961178+10,3,0,244,noninterpretable
4922,"select person.first_name, person.last_name from person, crew, movie, movie_award
where person.id = crew.id
and crew.title = movie.title
and crew.production_year = movie.production_year
and movie.production_year = movie_award.production_year
and movie.title = movie_award.title
and award_name = 'BAFTA Film Award';",2018-08-29 11:38:09.521081+10,8,0,123,partially correct
4923,"select p.id
from person p, 
where p.year_born=(select max(year_born) 
from person s 
where s.year_born<(select max(n.year_born) from person n ))
; ",2018-08-29 11:38:10.048953+10,3,0,244,noninterpretable
4924,"select p.id
from person p 
where p.year_born=(select max(year_born) 
from person s 
where s.year_born<(select max(n.year_born) from person n ))
; ",2018-08-29 11:39:23.169194+10,3,1,244,correct
4925,"select director.id, person.first_name, person.last_name from person, crew, movie, movie_award, director
where person.id = crew.id
and crew.title = movie.title
and crew.production_year = movie.production_year
and movie.production_year = movie_award.production_year
and movie.title = movie_award.title
and award_name = 'BAFTA Film Award';",2018-08-29 11:39:47.420675+10,8,0,123,partially correct
4926,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p, (SELECT MAX(year_born) AS min_year
			FROM PERSON) AS q

WHERE p.year_born = q.min_year;",2018-08-29 11:40:26.672442+10,7,1,177,correct
4927,"select t.first_name, t.last_name, t.title, t.production_year, t.description from (select t0.id, count(*) as Number from (select r.id, r.title, r.production_year, r.description, p.first_name, p.last_name from role r natural join person p) t0 group by t0.id) t
where t.Number=(select max(t2.Number) from (select t1.id, count(*) as Number from (select r.id, r.title, r.production_year, r.description, p.first_name, p.last_name from role r natural join person p) t1 group by t1.id) t2);",2018-08-29 11:41:07.379403+10,15,0,258,noninterpretable
4928,"select id, first_name, last_name
from person
where year_born= (select max(year_born) from person p1);",2018-08-29 11:43:15.158469+10,7,1,354,correct
4929,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (select
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) a );",2018-08-29 11:47:50.087309+10,15,1,258,correct
4930,"select r.id
from role as r,
	appearance as a,
	scene as s
where 
	a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and r.description = a.description
	and r.title = s.title
	and r.production_year = s.production_year
	and lower(a.title)='psycho'
	and a.production_year=1960
group by r.id
having count(*)=1;


",2018-08-29 11:48:16.499747+10,10,1,149,correct
4931,"SELECT m.title, m.production_year, d.first_name, d.last_name
FROM MOVIE AS m,
WHERE EXISTS (
		SELECT * FROM MOVIE_AWARD AS ma
		WHERE ma.award_name = 'BAFTA Film Award'
		AND ma.category = 'Best Film'
		AND m.title = ma.title);",2018-08-29 12:09:42.631135+10,8,0,177,noninterpretable
4932,"select first_name,last_name, title, production_year,description 
from person,role
where person.id=role.id
and person.id= (
select foo.id from
(
select id,count(*) as c from role group by id
) as foo
where foo.c= (
select max(c) from(
select id,count(*) as c from role group by id
)as foo
)
);",2018-08-29 12:10:48.975884+10,15,1,91,correct
4933,"SELECT  wa.award_name, COUNT (*)
FROM (SELECT award_name, year_of_award
      FROM writer_award, person
	  WHERE writer_award.id = person.id 
	  AND lower(first_name) = 'woody'
	  AND lower(last_name) = 'allen') AS wa
WHERE 1991<= year_of_award <=1995;",2018-08-29 12:19:11.685273+10,9,0,259,noninterpretable
4934,"
select d.id
from director d
where not exists 
(select * from Director_Award da  
where lower(da.result)='won' and da.title=d.title and da.production_year=d.production_year);",2018-08-29 12:19:54.330757+10,13,0,244,partially correct
4935,"SELECT COUNT (*) AS number_of_award
FROM (SELECT award_name, year_of_award
      FROM writer_award, person
	  WHERE writer_award.id = person.id 
	  AND lower(first_name) = 'woody'
	  AND lower(last_name) = 'allen') AS wa
WHERE 1991<= year_of_award <=1995;",2018-08-29 12:20:13.453773+10,9,0,259,noninterpretable
4936,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-29 12:21:26.550037+10,9,1,259,correct
4937,"select p.id, p.first_name, p.last_name from person p where p.id in (select t1.id from (select t.id, count(*) as Number from (select id from director natural join writer) t group by t.id) t1 where t1.Number>1);",2018-08-29 12:23:49.812047+10,4,1,258,correct
4938,"
select d.id,da.award_name,da.year_of_award,da.category
from director d,Director_Award da
where da.title=d.title and da.production_year=d.production_year and lower(da.result)='nominated' and 

d.id !=
(select d.id from director d,Director_Award da  
where lower(da.result)='won' and da.title=d.title and da.production_year=d.production_year);",2018-08-29 12:29:26.118384+10,13,1,244,correct
4939,"SELECT p.id
FROM person p, scene s, movie m, role r
WHERE p.id = r.id
AND r.title = m.title
AND m.title = s.title = 'Psycho'
AND m.production_year = s.production_year
AND s.production_year = '1960'
AND (SELECT COUNT(*)
     FROM scene
	 WHERE scene_no = '1');",2018-08-29 12:29:32.579599+10,10,0,259,partially correct
4940,"SELECT id FROM
(Select id, COUNT(*) as time from
  (Select p.id, w.title
    from Person p, writer w
    where p.id = w.id
   UNION
   Select p.id, d.title
    from Person p, director d
    where p.id = d.id) as res
 Group by id
 Order by time DESC)
where time = 3;",2018-08-29 12:33:11.435128+10,14,1,77,correct
4941,"SELECT 
	ma.title, 
	ma.production_year, 
	p.first_name, 
	p.last_name
FROM 
	(SELECT title, 
		  production_year
		FROM 
		  MOVIE_AWARD
		WHERE lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
	DIRECTOR AS d,
	PERSON AS p
WHERE ma.title = d.title
	AND ma.production_year = d.production_year
	AND d.id = p.id;",2018-08-29 12:37:42.909826+10,8,1,177,correct
5013,"SELECT ma.title
FROM Movie_Award ma,
WHERE ma.category =lower ('Best Film');",2018-08-29 14:06:35.958433+10,8,0,370,noninterpretable
5016,"SELECT mv.title,mv.production_year
FROM movie NATURAL JOIN writer AS mv, person p
WHERE mv.id = p.id AND p.first_name = 'Kevin' AND p.last_name = 'Willianmson';",2018-08-29 14:11:45.12185+10,5,0,132,partially correct
4942,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 12:43:08.282139+10,10,1,259,correct
4943,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 12:44:00.723474+10,10,1,155,correct
4944,"SELECT dw.id, MAX(dw. title)
FROM (director d NATURAL JOIN writer w) AS dw;
",2018-08-29 12:46:46.797892+10,14,0,272,partially correct
4945,"select s.number,s.production_year from (
	select count(*) as number, production_year from movie group by production_year) as s where 
	(s.production_year>=1991 and s.production_year<=1993);",2018-08-29 12:50:01.023918+10,2,1,32,correct
4946,"with t1 as (
select r.id,count(*) as num from role r group by id
)
select 
first_name,
last_name,
title,
production_year,
description

from 
person p,
role r,
t1

where
p.id = r.id and
r.id = t1.id and 
t1.num = (select max(t1.num) from t1);

",2018-08-29 12:50:10.341097+10,15,1,209,correct
4947,"with t1 as (
select r.id,count(*) as num from role r group by id
)
select 
first_name,
last_name,
title,
production_year,
description

from 
person p,
role r,
t1

where
p.id = r.id and
r.id = t1.id and 
t1.num = (select max(t1.num) from t1);

",2018-08-29 12:50:21.872012+10,15,1,209,correct
4948,"select count(distinct p.id) from person p where not exists
	(select d.id from director d where d.id=p.id);",2018-08-29 12:53:59.753386+10,12,1,32,correct
4949,"select p.id
from person p,      
where exists (

select max(*) from movie m
where (select count(*) from writer w,movie m,director d  
  where   
 d.title=m.title and d.production_year=m.production_year
 and w.title=m.title and w.production_year=m.production_year
 group by m.title));
",2018-08-29 12:54:24.161972+10,14,0,244,noninterpretable
4950,"SELECT COUNT(*) AS total_number
FROM (SELECT m.title 
FROM movie m, movie_award ma
WHERE m.title = ma.title
EXCEPT 
SELECT ma.title
FROM movie_award);

",2018-08-29 12:54:33.17493+10,11,0,259,noninterpretable
4951,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 13:05:29.40663+10,11,1,259,correct
4952,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 13:08:58.724246+10,4,1,366,correct
4953,"select p.first_name, p.last_name from person p,(select d.id from director d where exists 
	(select count(*) as number, w.id from WRITER w, MOVIE m WHERE 
	(w.title=m.title and w.production_year=m.production_year) group by w.id)) m
	where p.id=m.id;",2018-08-29 13:09:50.04904+10,4,0,32,partially correct
4954,"Select count(*)
From movie
Where not exists( Select * 
                  From movie_award, crew_award, director_award,writer_award,actor_award);",2018-08-29 13:12:17.615146+10,11,0,83,partially correct
4955,"SELECT COUNT(Person.year_born = '1935')
FROM Person, Writer
WHERE Person.id = Writer.id;",2018-08-29 13:13:01.885512+10,1,0,165,partially correct
4956,"select title, production_year
from writer
where id = (
	select id
	from person
	where first_name = 'Kevin' and last_name = 'Williamson')
;",2018-08-29 13:16:53.36604+10,5,1,211,correct
4957,"SELECT tb.title, tb.production_year
FROM (movie m NATURAL JOIN person p NATURAL JOIN writer w)AS tb
GROUP BY tb.id
HAVING tb.first_name = Kevin AND tb.last_name = Williamson;
",2018-08-29 13:16:56.441979+10,5,0,366,noninterpretable
4958,"SELECT COUNT(*)
FROM person
WHERE EXISTs(SELECT *
             FROM writer 
			 WHERE  writer.id = peron.id AND person.year_born =1935); 
  ",2018-08-29 13:20:03.950221+10,1,0,165,noninterpretable
4959,"SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS(SELECT * FROM WRITER w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-29 13:20:20.504766+10,1,1,132,correct
4960,"Select id, first_name, last_name
FROM Person p
Where exists (select * from director d where d.title, d.production_year= writer.title, writer.production_year group by director and having count(*)>2);",2018-08-29 13:21:55.844933+10,4,0,252,noninterpretable
4961,"SELECT COUNT(*)
FROM person
WHERE EXISTS(SELECT *
             FROM writer 
			 WHERE  writer.id = person.id AND person.year_born =1935); 
  ",2018-08-29 13:22:18.682034+10,1,1,165,correct
4962,"select t.title, t.production_year from (select w.id, m.title,m.production_year from movie m natural join writer w ) as t,
(select p.id, p.last_name, p.first_name from person p natural join writer e) as g 
	where (t.id=g.id and g.first_name='Kevin' and g.last_name='Williamson');",2018-08-29 13:24:49.22498+10,5,0,32,partially correct
4963,"SELECT production_year,COUNT(*) NumberOfMovies
From MOVIE m 
WHERE m.production_year=1993 OR m.production_year=1992 OR m.production_year=1991
GROUP BY m.production_year;",2018-08-29 13:25:21.443803+10,2,1,132,correct
4964,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 13:25:33.036589+10,4,1,252,correct
4965,"SELECT id FROM
(Select id, COUNT(*) as time from
  (Select p.id, w.title
    from Person p, writer w
    where p.id = w.id
   UNION
   Select p.id, d.title
    from Person p, director d
    where p.id = d.id) 
 Group by id
 Order by time DESC)
where time = (Select max(time) from 
(Select id, COUNT(*) as time from
  (Select p.id, w.title
    from Person p, writer w
    where p.id = w.id
   UNION
   Select p.id, d.title
    from Person p, director d
    where p.id = d.id) 
 Group by id
 Order by time DESC));",2018-08-29 13:26:57.586762+10,15,0,77,partially correct
4966,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year IN(1991,1992,1993);",2018-08-29 13:27:54.564839+10,2,0,165,partially correct
4967,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year IN(1991,1992,1993)
GROUP BY production_year;",2018-08-29 13:31:29.547551+10,2,1,165,correct
4968,"
SELECT x.id 
FROM (SELECT x1.id, count(*) AS c
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.c= 
	(SELECT MAX(x2.c) 
	FROM (SELECT x1.id, count(*) AS c 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 13:33:30.166135+10,14,1,244,correct
4969,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-29 13:35:21.747766+10,6,1,211,correct
4970,"select id, first_name, last_name
from person
where year_born = (
	select max(year_born)
	from person
);",2018-08-29 13:36:49.946563+10,7,1,211,correct
4971,"SELECT COUNT(*) number
FROM PERSON
WHERE NOT (SELECT PERSON.id FROM PERSON p,DIRECTOR d WHERE p.id = d.id );",2018-08-29 13:37:23.064043+10,12,0,132,partially correct
5014,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(p.first_name)= 'kevin'
    AND lower(p.last_name)= 'williamson';",2018-08-29 14:08:53.324278+10,5,1,366,correct
5017,"SELECT COUNT(*)
FROM WRITER w NATURAL JOIN PERSON p   
WHERE p.year_born=1935;",2018-08-29 14:12:57.010236+10,1,0,163,partially correct
4972,"Select count(*)
From movie m
Where not exists( Select title
                 From movie_award ma
                 Where ma.title=m.title AND lower(ma.result)='won'
                 UNION
                 Select title
                 From crew_award ca
                 Where ca.title=m.title AND lower(ca.result)='won'
                 UNION
                 Select title
                 From director_award da
                 Where da.title=m.title AND lower(da.result)='won'
                 UNION
                 Select title
                 From writer_award wa
                 Where wa.title=m.title AND lower(wa.result)='won'
                 UNION
                 From actor_award aa
                 Where aa.title=m.title AND lower(aa.result)='won'
);",2018-08-29 13:38:04.093737+10,11,0,83,noninterpretable
4973,"select count(*)
from (writer_award natural join person) as d
where  d.year_of_award>1990 and d.year_of_award<1996 and d.first_name ='Woody' and d.last_name='Allen' ;",2018-08-29 13:40:10.453731+10,9,0,364,partially correct
4974,"SELECT SUM(*)
FROM person
WHERE EXISTS (SELECT *
      FROM person
	  WHERE person.id = director.id AND director.title != NULL);",2018-08-29 13:40:19.850303+10,12,0,165,noninterpretable
4975,"select count(*)
from (writer_award natural join person) as d
where  d.year_of_award>1990 and d.year_of_award<1996 and d.first_name ='Woody' and d.last_name='Allen' and d.result ='won' ;",2018-08-29 13:41:42.784596+10,9,1,364,correct
4976,SELECT * FROM movie;,2018-08-29 13:42:06.86929+10,1,0,299,partially correct
4977,"select count(*) from 
pseron join writer on person.id=writer.id
where year_born='1935';",2018-08-29 13:42:26.599652+10,1,0,391,noninterpretable
4978,SELECT id FROM person WHERE year_born=(SELECT MAX(year_born) FROM person WHERE year_born< (SELECT MAX(year_born) from person));,2018-08-29 13:42:53.270691+10,3,1,155,correct
4979,"select count(*) from 
person join writer on person.id=writer.id
where year_born='1935';",2018-08-29 13:42:56.707184+10,1,0,391,partially correct
4980,"select p.rst_ame, p.last_name,r.title, r.production_year, r.description
from person p union role r as e

;",2018-08-29 13:43:02.38242+10,15,0,244,noninterpretable
4981,"SELECT title, production_year
FROM movie
WHERE exists (select * from writer where id= 'Kevin Williamson' and writer.title, writer.procuction_year= movie.title, movie.procuction_year); ",2018-08-29 13:43:21.119607+10,5,0,252,noninterpretable
4982,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS (SELECT *
      FROM director 
	  WHERE person.id = director.id);",2018-08-29 13:43:24.901593+10,12,1,165,correct
4983,"Select COUNT(Pr.Id) as Person_year_born_1935

From Person As Pr, Writer As wr

Where Pr.year_born = 1935 AND Pr.Id = wr.Id;",2018-08-29 13:44:50.670269+10,1,0,263,partially correct
4984,"select d.id,da.award_name,da.year_of_award,da.category
from director d
	natural join
	director_award da
where lower(da.result) = ""nominated"" and
	not exists (select *
			from director_award da1
			where da1.title = da.title and
				da1.production_year = da.production_year and
				lower(da1.result) = ""won"");",2018-08-29 13:46:11.840038+10,13,1,43,correct
4985,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person
WHERE
    w.id = person.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-29 13:47:13.938869+10,5,1,252,correct
4986,"SELECT COUNT(*) number
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id = d.id );",2018-08-29 13:47:52.198577+10,12,1,132,correct
4987,"Select id
From person
where person.year_born > ( Select year_born
                           From person
                           group by person.year_born
                           having min(person.year_born));",2018-08-29 13:47:55.700352+10,3,0,83,partially correct
4988,"SELECT COUNT(*)
FROM writer,person
where person.id=writer.id and person.year_born=1935;
",2018-08-29 13:48:22.543078+10,1,0,343,partially correct
4989,"select count(*)
from
writer natural join person
where
year_born = '1935';",2018-08-29 13:50:34.090029+10,1,0,271,partially correct
4990,"WITH d_w AS (SELECT id,title,production_year FROM writer NATURAL JOIN person

UNION 

SELECT id,title,production_year FROM director NATURAL JOIN person),

ids AS (SELECT id, COUNT(id) tot FROM d_w
GROUP BY id)

SELECT id FROM ids
WHERE tot = (SELECT MAX(tot) FROM ids);",2018-08-29 13:52:05.557614+10,14,1,25,correct
4991,"SELECT COUNT(p.id)
FROM PERSON AS p INNER JOIN WRITER AS w
ON p.id = w.id
WHERE year_born = 1935
GROUP BY year_born;",2018-08-29 13:52:18.278065+10,1,0,392,partially correct
4992,"select production_year, count(*)
from
movie
group by production_year
having
production_year >= '1991'
and
production_year <= '1993';",2018-08-29 13:53:13.26305+10,2,1,271,correct
4993,"SELECT m.title, m.production_year
FROM movie m
WHERE (m.title, m.production_year) NOT IN
(SELECT DISTINCT ma.title, ma.production_year 
FROM movie_award ma

UNION

SELECT DISTINCT ca.title, ca.production_year 
FROM crew_award ca

UNION

SELECT DISTINCT da.title, da.production_year 
FROM director_award da

UNION

SELECT DISTINCT wa.title, wa.production_year 
FROM writer_award wa

UNION

SELECT aa.title, aa.production_year 
FROM actor_award aa);",2018-08-29 13:54:29.460424+10,11,0,27,partially correct
4994,"SELECT d.id, da.award_name, da.year_of_award, da.category FROM director AS d, director_award AS da 
WHERE d.title=da.title 
AND d.production_year=da.production_year
AND lower(da.result)!='won'
GROUP BY d.id
HAVING COUNT(*)>=1;",2018-08-29 13:54:42.426996+10,13,1,155,correct
4995,"Select country
FROM Restriction r
WHERE r.title='Shakespeare in Love' and r.description='M' ;",2018-08-29 13:55:09.398616+10,6,1,252,correct
4996,"select count(*)
from
person
where
id not in
(select
id
from
Director);",2018-08-29 13:55:54.676951+10,12,1,271,correct
4997,"Select id
From person
Where person.year_born=(Select max(year_born)
                        From person
                        Where year_born<(Select max(year_born)
                                                From person));",2018-08-29 13:56:59.736238+10,3,1,83,correct
4998,"SELECT COUNT(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id = p.id AND p.year_born=1935);
",2018-08-29 13:57:26.74928+10,1,1,343,correct
4999,"SELECT COUNT(id)
FROM PERSON
WHERE year_born = 1935 AND id IN (SELECT id FROM WRITER)
GROUP BY year_born;",2018-08-29 13:58:07.162277+10,1,1,392,correct
5000,"WITH born_in AS (SELECT  FROM person NATURAL JOIN writer
WHERE year_born = 1935),

ids AS (SELECT DISTINCT id FROM born_in),

SELECT COUNT(id) FROM ids

;",2018-08-29 13:58:28.625909+10,1,0,25,noninterpretable
5001,"
SELECT COUNT(*)
FROM 
(SELECT DISTINCT id
FROM writer NATURAL JOIN person
WHERE year_born = 1935);",2018-08-29 13:58:40.77304+10,1,1,27,correct
5002,"SELECT d.id, da.award_name, da.year_of_award, da.category FROM director AS d, director_award AS da 
WHERE d.title=da.title 
AND d.production_year=da.production_year
AND lower(da.result)='nominated'
AND lower(da.result)!='won'
GROUP BY d.id
HAVING COUNT(*)>=1;",2018-08-29 13:58:54.948241+10,13,1,155,correct
5003,"SELECT id,first_name,last_name
FROM PERSON p
WHERE EXISTS (SELECT d.id,COUNT(*) FROM DIRECTOR d,WRITER w WHERE d.title = w.title AND d.id=w.id GROUP BY d.id HAVING COUNT(*)>=2);",2018-08-29 13:59:58.497916+10,4,0,132,partially correct
5004,"select id, first_name, last_name
from person
where
id in
(select id
from
director d
natural join
writer w
group by id
having
count(id) >= 2); ",2018-08-29 14:00:33.365156+10,4,1,271,correct
5005,"WITH born_in AS (SELECT * FROM person NATURAL JOIN writer
WHERE year_born = 1935),

ids AS (SELECT DISTINCT id FROM born_in)

SELECT COUNT(*) FROM ids;",2018-08-29 14:00:38.501845+10,1,1,25,correct
5006,"select title, production_year
from
person
natural join
writer
natural join
movie
where
first_name = 'Kevin'
and
last_name = 'Williamson';",2018-08-29 14:02:17.712747+10,5,1,271,correct
5007,"SELECT production_year, COUNT(title)
FROM MOVIE
WHERE production_year BETWEEN 1991 AND 1993
GROUP BY production_year
ORDER BY production_year DESC;",2018-08-29 14:03:21.903353+10,2,1,392,correct
5008,"select d.id
from (scene natural join movie natural join role) as d
lower(d.title)='psycho' and d.production_year =1960;
",2018-08-29 14:03:27.824838+10,10,0,364,noninterpretable
5009,"select country
from
restriction
where
title = 'Shakespeare in Love'
and
description = 'M';",2018-08-29 14:03:33.427958+10,6,1,271,correct
5011,"SELECT * 
FROM WRITER w NATURAL JOIN PERSON p  
WHERE p.year_born=1935;",2018-08-29 14:06:34.124365+10,1,0,163,partially correct
5019,"select id, first_name, last_name
from
(select id, first_name, last_name, max(year_born)
from person);",2018-08-29 14:13:35.515416+10,7,1,271,correct
5020,"SELECT w.title,w.production_year
FROM writer w, person p
WHERE w.id = p.id AND lower(p.first_name) = 'kevin' AND lower(p.last_name) = 'williamson';",2018-08-29 14:14:28.84752+10,5,1,132,correct
5021,"SELECT country
FROM restriction r
WHERE lower(r.title)='shakespeare in love' AND r.description='M';",2018-08-29 14:14:30.537375+10,6,1,366,correct
5022,"SELECT COUNT(*)
FROM PERSON
WHERE id NOT IN (SELECT id FROM DIRECTOR)
GROUP BY NULL;",2018-08-29 14:14:44.255955+10,12,1,392,correct
5023,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT id FROM writer w WHERE p.id = w.id);
",2018-08-29 14:15:15.119519+10,12,0,343,partially correct
5024,"Select COUNT(*) as Person_year_born_1935

From Person As Pr


WHERE EXISTS (SELECT * FROM Writer As wr Where Pr.year_born = 1935 AND Pr.Id = wr.Id);",2018-08-29 14:15:37.404707+10,1,1,263,correct
5025,"SELECT id, first_name, last_name
FROM person
WHERE min(year_born);",2018-08-29 14:16:06.322341+10,7,0,366,noninterpretable
5026,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);
",2018-08-29 14:16:27.171056+10,12,1,343,correct
5027,"SELECT id, first_name, last_name
FROM person
WHERE SUM (SELECT title
           FROM director, writer
	     WHERE writer.title = director.title AND director.id = person.id) >=2;
",2018-08-29 14:16:34.361103+10,4,0,165,noninterpretable
5028,"select title,production_year,first_name,last_name
from
movie_award
natural join
director
natural join
person
where
lower(result) = 'won'
and
lower(category) = 'best film'
and
award_name = 'BAFTA Film Award';",2018-08-29 14:17:07.945484+10,8,1,271,correct
5029,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born =(SELECT MAX(year_born) FROM person);",2018-08-29 14:17:42.654418+10,7,1,366,correct
5030,"select count(writer_award.award_name)
from writer, writer_award, person
where Writer_award.id = person.id
and person.first_name = 'Woody'
and person.last_name = 'Allen';",2018-08-29 14:17:59.762907+10,9,0,123,partially correct
5031,"select count(*)
from
writer_award
natural join
writer
natural join
person
where
first_name = 'Woody'
and
last_name = 'Allen'
and
lower(result) = 'won'
and
year_of_award >= '1991'
and
year_of_award <= '1995';",2018-08-29 14:19:13.856976+10,9,1,271,correct
5032,;,2018-08-29 14:20:07.651674+10,11,0,341,noninterpretable
5033,"Select d.id, da.title, da.year_of_award, da.category
From director d, director_award da
Where d.title= da.title
      AND d.production_year= da.production_year
      group by da.result having count(lower(da.result='nominate'))>1;
",2018-08-29 14:20:08.261646+10,13,0,83,partially correct
5034,"select id
from
role
natural join
Appearance
group by id
having
title = 'Psycho'
and
production_year = '1960'
and
count(id) = 1;",2018-08-29 14:21:24.216387+10,10,0,271,partially correct
5035,"SELECT p.first_name, p.last_name, ma.title, ma.production_year
FROM Director d, Person p,
(SELECT title,production_year
FROM movie_award
WHERE lower(category)='best film' AND
lower(award_name)= 'bafta film award' AND result ='won') AS ma

WHERE p.id = d.id AND ma.title=d.title;
",2018-08-29 14:22:03.649879+10,8,1,370,correct
5036,"select count(writer_award.award_name)
from writer, writer_award, person
where Writer_award.id = writer.id
and writer.title = writer_award.title
and writer.production_year = writer_award.production_year
and person.id = writer.id
and person.first_name = 'Woody'
and person.last_name = 'Allen'
and writer.production_year between 1991 and 1995;",2018-08-29 14:22:15.075638+10,9,1,123,correct
5037,"SELECT id, award_name,year_of_award, category FROM director NATURAL JOIN director_award
WHERE lower(result) != 'won';",2018-08-29 14:22:16.428603+10,13,1,25,correct
5038,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
     FROM person 
     WHERE year_born < (SELECT MAX(year_born) 
      FROM person));",2018-08-29 14:22:35.053672+10,3,1,247,correct
5039,"
HAVING COUNT(*)>1;",2018-08-29 14:22:39.78057+10,4,0,165,noninterpretable
5040,"SELECT w.id
FROM WRITER w
WHERE  w.id =(SELECT id FROM PERSON WHERE year_born='1935');",2018-08-29 14:22:43.786747+10,1,0,46,partially correct
5041,"select count(*) from movie m where not exists(
select title,production_year from movie_award ma 
where lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year 
union
SELECT title, production_year 
FROM crew_award ca 
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year 
FROM director_award da 
WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION
SELECT title, production_year 
FROM actor_award aa 
WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
UNION
SELECT title, production_year 
FROM writer_award wa 
WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 14:24:01.26407+10,11,1,341,correct
5042,"Select d.id, da.title, da.year_of_award, da.category
From director d, director_award da
Where d.title= da.title
      AND d.production_year= da.production_year
      AND lower(da.result)='nominated'
      AND d.id not in (Select id
                  From director d, director_award da
                  Where d.title=da.title
                  AND d.production_year=da.production_year
                  AND lower(da.result)='won');
",2018-08-29 14:25:14.532279+10,13,0,83,partially correct
5043,;,2018-08-29 14:25:47.588096+10,3,0,341,noninterpretable
5044,;,2018-08-29 14:25:48.073759+10,3,0,341,noninterpretable
5045,"Select d.id, da.award_name, da.year_of_award, da.category
From director d, director_award da
Where d.title= da.title
      AND d.production_year= da.production_year
      AND lower(da.result)='nominated'
      AND d.id not in (Select id
                  From director d, director_award da
                  Where d.title=da.title
                  AND d.production_year=da.production_year
                  AND lower(da.result)='won');
",2018-08-29 14:26:06.682509+10,13,1,83,correct
5046,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-29 14:26:25.467883+10,4,1,165,correct
5047,"SELECT id, first_name, last_name
FROM PERSON
WHERE id IN
(SELECT DIRECTOR.id
FROM DIRECTOR, WRITER
WHERE DIRECTOR.id = WRITER.id AND DIRECTOR.title = WRITER.title AND DIRECTOR.production_year = WRITER.production_year
GROUP BY DIRECTOR.id
HAVING COUNT(DIRECTOR.id) > 1);",2018-08-29 14:26:27.618406+10,4,1,392,correct
5048,"select wo.title,wo.production_year,p.first_name,p.last_name
from (select title,production_year 
from movie_award
where lower(award_name)='bafta film award' and category='best film' and lower(result)='won')as wo,
person as p,
director as dir
where dir.id=p.id 
and wo.title=dir.title
and dir.production_year=wo.production_year;",2018-08-29 14:27:33.841777+10,8,1,230,correct
5049,"select r.id
from appearance a, role r
where a.title =r.title
and   a.description = r.description
and   a.production_year = r.production_year
and lower(a.title)='psycho'
and a.production_year='1960'
group by r.id
having count(*)=1;
",2018-08-29 14:27:44.423955+10,10,1,364,correct
5050,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
FROM person 
WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-29 14:28:47.214972+10,3,1,341,correct
5079,"SELECT p.first_name, p.last_name, ma.title, ma.production_year
FROM Director d, Person p,
(SELECT title,production_year
FROM movie_award
WHERE lower(category)='best film' AND
lower(award_name)= 'bafta film award' AND result ='won') AS ma

WHERE p.id = d.id AND ma.title=d.title;
",2018-08-29 14:46:42.323333+10,8,1,370,correct
5080,"select production_year, count(*) as NoOfMovies
from movie 
group by(production_year)
having production_year = '1991'
	and production_year ='1992'
	and production_year ='1993';",2018-08-29 14:46:56.541806+10,2,0,46,partially correct
5166,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-29 15:26:19.76164+10,3,1,204,correct
5051,"select count(*)
from movie as m
where not exists (
		select title,production_year
		from movie_award as ma
		where ma.title=m.title
			and m.production_year =ma.production_year
			and lower(ma.result)='won'
		union
		select title,production_year
		from crew_award as ca
		where ca.title=m.title
			and m.production_year =ca.production_year
			and lower(ca.result)='won'
		union
		select title,production_year
		from director_award as da
		where da.title=m.title
			and m.production_year =da.production_year
			and lower(da.result)='won'
		union
		select title,production_year
		from writer_award as wa
		where wa.title=m.title
			and m.production_year =wa.production_year
			and lower(wa.result)='won'
		union
		select title,production_year
		from actor_award as aa
		where aa.title=m.title
			and m.production_year =aa.production_year
			and lower(aa.result)='won');",2018-08-29 14:30:18.482309+10,11,1,149,correct
5052,"select count(*)
from movie as m
where not exists (
		select title,production_year
		from movie_award as ma
		where ma.title=m.title
			and m.production_year =ma.production_year
			and lower(ma.result)='won'
		union
		select title,production_year
		from crew_award as ca
		where ca.title=m.title
			and m.production_year =ca.production_year
			and lower(ca.result)='won'
		union
		select title,production_year
		from director_award as da
		where da.title=m.title
			and m.production_year =da.production_year
			and lower(da.result)='won'
		union
		select title,production_year
		from writer_award as wa
		where wa.title=m.title
			and m.production_year =wa.production_year
			and lower(wa.result)='won'
		union
		select title,production_year
		from actor_award as aa
		where aa.title=m.title
			and m.production_year =aa.production_year
			and lower(aa.result)='won');",2018-08-29 14:30:30.53575+10,11,1,149,correct
5053,"select id,first_name,last_name
from PERSON p
where (select DIRECTOR.id
from DIRECTOR inner join WRITER
on director.id = writer.id and DIRECTOR.id =p.id);
",2018-08-29 14:32:48.278526+10,4,0,154,partially correct
5054,"select person.first_name, person.last_name
from movie, person, role, appearance, scene
where person.id = role.id
and role.title = appearance.title
and role.production_year = appearance.production_year
and role;",2018-08-29 14:32:59.547762+10,10,0,123,noninterpretable
5055,"SELECT h.id 
FROM (SELECT id, COUNT(*) AS noOfmovie FROM director GROUP BY id
UNION SELECT id, COUNT(*) AS noOfmovie FROM writer GROUP BY id) AS h
WHERE h.noOfmovie=
(SELECT MAX(noOfmovie) 
FROM (SELECT COUNT(*) AS noOfmovie FROM director GROUP BY id UNION SELECT COUNT(*) AS noOfmovie FROM writer GROUP BY id) AS h);",2018-08-29 14:33:58.389792+10,14,1,155,correct
5056,"
AND PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-29 14:35:36.648221+10,5,0,392,noninterpretable
5057,"SELECT count(*)
FROM person p,writer w
WHERE(p.id = w.id AND p. year_born=1935);",2018-08-29 14:35:41.617937+10,1,0,329,partially correct
5058,"select id
from person p
where 
	p.year_born =(select max(year_born)
				from person
				where year_born<(select max(year_born)
							from person));",2018-08-29 14:35:52.375691+10,3,1,149,correct
5059,"select count(award_name)
from writer_award
where year_of_award>=1991 and year_of_award<=1995
group by award_name
(select wa.id from (writer_award inner join person on writer_award.id=person.id))as wa
where wa.first_name='Woody' and wa.last_name='Allen')
having award_id=wa.id;",2018-08-29 14:35:54.529119+10,9,0,351,noninterpretable
5060,"SELECT MOVIE.title, MOVIE.production_year
FROM MOVIE, DIRECTOR, PERSON
WHERE MOVIE.title = DIRECTOR.title AND MOVIE.production_year = DIRECTOR.production_year
AND DIRECTOR.id = PERSON.id
AND PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-29 14:36:06.825022+10,5,0,392,partially correct
5061,"select id
from
(select id
from
role
natural join
Appearance
where
title = 'Psycho'
and
production_year = '1960')
group by id
having count(id) = 1;",2018-08-29 14:36:17.73534+10,10,1,271,correct
5062,"ELECT id,first_name,last_name 
FROM person
Where EXISTS (SELECT COUNT(*) 
	FROM director,writer
	WHERE COUNT(*)>1
	GROUP BY title,production_year,id);
",2018-08-29 14:36:20.274156+10,4,0,343,noninterpretable
5063,"SELECT pw.title, pw.production_year
FROM (person NATURAL JOIN writer NATURAL JOIN movie) AS pw
GROUP BY pw.id
HAVING (pw.first_name ='Kevin' AND pw.last_name = 'Williamson');",2018-08-29 14:36:40.983103+10,5,0,165,partially correct
5064,"SELECT MOVIE.title, MOVIE.production_year
FROM MOVIE, WRITER, PERSON
WHERE MOVIE.title = WRITER.title AND MOVIE.production_year = WRITER.production_year
AND WRITER.id = PERSON.id
AND PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-29 14:36:57.367029+10,5,1,392,correct
5065,"SELECT pw.title, pw.production_year
FROM (person NATURAL JOIN writer NATURAL JOIN movie) AS pw
GROUP BY pw.title
HAVING (pw.first_name ='Kevin' AND pw.last_name = 'Williamson');",2018-08-29 14:37:25.383207+10,5,1,165,correct
5066,"select count(*) 
from person p where exists(select id from writer w where w.id=p.id and p.year_born='1935');",2018-08-29 14:37:58.856414+10,1,1,46,correct
5067,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 14:38:20.881847+10,4,1,343,correct
5068,"select id
from
(select id
from
role
natural join
Appearance
where
title = 'Psycho'
and
production_year = '1960')
group by id
having count(id) = 1;",2018-08-29 14:38:43.709989+10,10,1,271,correct
5069,"SELECT country
FROM RESTRICTION
WHERE title = ""Shakespeare in Love"" and description = ""M"";",2018-08-29 14:39:47.71395+10,6,1,392,correct
5070,"SELECT GG.id, GG.first_name, GG.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS GG
GROUP BY GG.id 
HAVING count(*) > 1;",2018-08-29 14:39:59.611987+10,4,1,154,correct
5071,"SELECT id, first_name, last_name
FROM PERSON
WHERE year_born IN (SELECT MAX(year_born) FROM PERSON GROUP BY NULL);",2018-08-29 14:42:18.131945+10,7,1,392,correct
5072,"select count(*)
from
movie m
where
m.title not in (select title from Movie_Award ma where ma.production_year = m.production_year and lower(ma.result) = 'won')
and
m.title not in (select title from crew_Award ma where ma.production_year = m.production_year and lower(ma.result) = 'won')
and
m.title not in (select title from Director_Award ma where ma.production_year = m.production_year and lower(ma.result) = 'won')
and
m.title not in (select title from writer_Award ma where ma.production_year = m.production_year and lower(ma.result) = 'won')
and
m.title not in (select title from actor_Award ma where ma.production_year = m.production_year and lower(ma.result) = 'won');",2018-08-29 14:42:42.711394+10,11,1,271,correct
5073,"SELECT production_year, count(*) 
FROM movie m
WHERE m.production_year > 1990 AND m.production_year < 1994 
GROUP BY production_year;",2018-08-29 14:42:58.964177+10,2,1,36,correct
5074,"select distinct id
from writer_award
where year_of_award=(select max(year_of_award)
from writer_award);",2018-08-29 14:44:26.087458+10,13,0,394,partially correct
5075,"select id
from
(select id, max(year_born)
from
person
where
id !=
(
select id
from
(select id, max(year_born)
from
person)
));",2018-08-29 14:44:31.540788+10,3,1,271,correct
5076,select * from person;,2018-08-29 14:44:36.217646+10,14,0,101,partially correct
5077,"select d.id,
	 da.award_name,
	 da.year_of_award,
	 da.category
from director_award as da,
	director as d
where 
	d.title=da.title
	and d.production_year = da.production_year
	and d.id in (select id
			from director_award as da,
				director as d
			where lower(da.result)='nominated'
				and d.title=da.title
				and d.production_year = da.production_year)
	and d.id not in(select id
			from director_award as da,
				director as d
			where lower(result)='won'
				and d.title=da.title
				and d.production_year = da.production_year);",2018-08-29 14:45:38.012832+10,13,1,149,correct
5078,"Select pw.title,pw.production_year 
FROM (person NATURAL JOIN writer) AS pw
WHERE pw.first_name = 'Kevin'AND pw.last_name = 'Williamson';",2018-08-29 14:46:01.801114+10,5,1,343,correct
5081,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
And s.production_year = a.production_year
and s.title = a.title
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
	having
	count(s.scene_no) = 1;",2018-08-29 14:47:15.970525+10,10,1,123,correct
5082,"select id, award_name, year_of_award,category
from
director
natural join
director_award
where
lower(result) != 'won'
and
id not in
(select id
from
director
natural join
director_award
where
lower(result) = 'won');",2018-08-29 14:48:42.890173+10,13,1,271,correct
5083,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS(SELECT * FROM PERSON p, WRITER w WHERE p.id=w.id);",2018-08-29 14:49:02.614009+10,12,0,132,partially correct
5084,"SELECT MOVIE.title, first_name, last_name
FROM MOVIE, PERSON, DIRECTOR, MOVIE_AWARD
WHERE award_name = ""BAFTA Film Award"" AND category = ""Best Film""
AND PERSON.id = DIRECTOR.id AND MOVIE.title = DIRECTOR.title AND MOVIE.production_year = DIRECTOR.production_year
AND MOVIE_AWARD.title = MOVIE.title AND MOVIE_AWARD.production_year = MOVIE.production_year;",2018-08-29 14:49:14.810924+10,8,0,392,partially correct
5085,"select production_year, count(*) as NoOfMovies
from movie 
where production_year >='1991'
	and production_year <='1993'
group by production_year;
",2018-08-29 14:50:27.372948+10,2,1,46,correct
5086,"Select title, production_year, first_name, last_name
from movie_award ma;",2018-08-29 14:50:59.936737+10,8,0,252,noninterpretable
5087,"SELECT m.title, m.production_year
FROM movie m, movie_award ma
WHERE m.title = ma.title
AND m.production_year = ma.production_year
AND lower(ma.category) = 'best film' AND lower(ma.award_name) = 'bafta film award';",2018-08-29 14:51:39.67474+10,8,0,366,partially correct
5088,"select p.id, p.first_name,p.last_name
from person p natural join writer w natural join director d 
where w.id = d.id
group by p.id having count (*)>1;",2018-08-29 14:51:42.075795+10,4,1,237,correct
5089,"SELECT title, production_year
FROM movie_award ma
WHERE ma.production_year = ma.production_year
AND lower(ma.category) = 'best film' AND lower(ma.award_name) = 'bafta film award';",2018-08-29 14:52:51.224692+10,8,0,366,partially correct
5090,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person AS p, role AS r
WHERE (r.id = p.id)
GROUP BY r.id;

",2018-08-29 14:53:44.160105+10,15,0,378,partially correct
5091,"SELECT MOVIE.title, first_name, last_name
FROM MOVIE, PERSON, DIRECTOR, MOVIE_AWARD
WHERE lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND MOVIE_AWARD.result = ""won""
AND PERSON.id = DIRECTOR.id AND MOVIE.title = DIRECTOR.title AND MOVIE.production_year = DIRECTOR.production_year
AND MOVIE_AWARD.title = MOVIE.title AND MOVIE_AWARD.production_year = MOVIE.production_year;",2018-08-29 14:54:09.368579+10,8,0,392,partially correct
5092,"select p.id, p.first_name,p.last_name
from person p natural join writer w natural join director d 
group by p.id having count (*)>1;",2018-08-29 14:54:32.301879+10,4,1,237,correct
5093,"SELECT MOVIE.title, production_year, first_name, last_name
FROM MOVIE, PERSON, DIRECTOR, MOVIE_AWARD
WHERE lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND MOVIE_AWARD.result = ""won""
AND PERSON.id = DIRECTOR.id AND MOVIE.title = DIRECTOR.title AND MOVIE.production_year = DIRECTOR.production_year
AND MOVIE_AWARD.title = MOVIE.title AND MOVIE_AWARD.production_year = MOVIE.production_year;",2018-08-29 14:54:47.991816+10,8,0,392,noninterpretable
5094,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
And s.production_year = a.production_year
and s.title = a.title
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
	having
	count(s.title) = 1;",2018-08-29 14:55:03.284864+10,10,1,123,correct
5095,"SELECT MOVIE.title, MOVIE.production_year, first_name, last_name
FROM MOVIE, PERSON, DIRECTOR, MOVIE_AWARD
WHERE lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND MOVIE_AWARD.result = ""won""
AND PERSON.id = DIRECTOR.id AND MOVIE.title = DIRECTOR.title AND MOVIE.production_year = DIRECTOR.production_year
AND MOVIE_AWARD.title = MOVIE.title AND MOVIE_AWARD.production_year = MOVIE.production_year;",2018-08-29 14:55:03.312251+10,8,1,392,correct
5096,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 14:55:37.642558+10,4,1,36,correct
5097,"select *
from(
select id
from (select id,title,production_year
	from director
	union
	select id,title,production_year
	from writer)as dw,
	movie as m
where m.title=dw.title
	and m.production_year = dw.production_year)as x;",2018-08-29 14:57:09.621022+10,14,0,149,partially correct
5098,"select id 
from
(select id, max(ss)
from
(select id, count(id) ss
from
(select id, production_year from director
union
select id, production_year from writer)
group by id));",2018-08-29 14:57:23.229052+10,14,0,271,partially correct
5099," select production_year,count(distinct title) from movie where production_year=1991 or production_year=1992 or production_year=1993 group by production_year;",2018-08-29 14:57:24.391718+10,2,1,190,correct
5100,"select p.id, p.firstname ,p.lastname form person p inner join writer w on p.id = w.id inner join direc * from director d inner join movies m on 




select * from writers w inner join director d on w.id = d.id ;
",2018-08-29 14:58:34.381756+10,4,0,65,noninterpretable
5101,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person AS p, role AS r, (SELECT id, count(*) FROM role GROUP BY id) AS c
WHERE (r.id = p.id AND r.id = c.id)
GROUP BY r.id
HAVING count(*) = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );

",2018-08-29 14:59:25.76997+10,15,0,378,partially correct
5102,"select *
	from writer, person
	where writer.id = person.id and year_born = 1935;",2018-08-29 15:00:06.16225+10,1,0,396,partially correct
5103,"select gg.title, gg.production_year
from (writer left join movie) as gg

where (select id
from person
where first_name = 'Kevin' and last_name = 'Williamson')
group by gg.title




;

",2018-08-29 15:00:11.44517+10,5,0,154,partially correct
5104,"SELECT country
FROM restriction
WHERE restriction.description = 'M' AND restriction.title = 'Shakespeare in Love';",2018-08-29 15:00:29.576318+10,6,1,343,correct
5105,"select count (*)
from person p, writer_award wa
where 
wa.id=p.id
and
wa.year_of_award>=1991
and 
wa.year_of_award<=1995
and
wa.result='won'
and
p.first_name='Woody'
and 
p.last_name='Allen';

",2018-08-29 15:00:31.353594+10,9,1,351,correct
5106,"
select id
from
(select id, count(id) ss
from
(select id, production_year from director
union
select id, production_year from writer)
group by id)
where ss = 
(select max(ss)
from
(select id, count(id) ss
from
(select id, production_year from director
union
select id, production_year from writer)
group by id));",2018-08-29 15:01:11.522275+10,14,1,271,correct
5107,"SELECT
    title, production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-29 15:01:41.779224+10,5,1,36,correct
5108,"SELECT COUNT(*)
FROM (SELECT id
	 FROM WRITER_AWARD
	 WHERE year_of_award > 1990 AND year_of_award < 1996) AS wa,
	 
	 PERSON AS p,
	 WRITER AS w
	 
WHERE p.id = w.id
	AND lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen';",2018-08-29 15:01:45.969763+10,9,0,177,partially correct
5109,"SELECT country
FROM restriction r
WHERE lower(r.title)='shakespeare in love' and lower(r.description)='m';",2018-08-29 15:02:28.13842+10,6,1,132,correct
5406,"select id,max(year_born) 
from person
where year_born not in (select max(year_born)  from person)
group by year_born;",2018-08-29 17:03:19.409293+10,3,0,230,partially correct
5110,"SELECT count(*)
FROM (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS a , movie m
WHERE movie.title NOT IN (SELECT id From (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS b);",2018-08-29 15:03:17.387761+10,11,0,278,noninterpretable
5111,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name) = 'kevin'
    AND lower(last_name) = 'williamson';

",2018-08-29 15:03:33.638101+10,5,1,154,correct
5112,;,2018-08-29 15:03:38.29866+10,14,0,378,noninterpretable
5113,select count(id) from person where id not in (select distinct id from director);,2018-08-29 15:03:39.211486+10,12,1,190,correct
5114,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 15:04:10.559271+10,8,1,252,correct
5115,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-29 15:04:37.654198+10,6,1,165,correct
5116,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 15:04:38.950807+10,8,1,252,correct
5117,"
select id, count(*)
from pd
where title =null;",2018-08-29 15:04:54.544125+10,12,0,181,noninterpretable
5118,"select distinct spc.id
from (scene s inner join person p inner join crew c)as spc
where 
spc.scene_no =1
and spc.title='Psycho'
and spc.production_year=1960;",2018-08-29 15:05:10.061004+10,10,0,351,partially correct
5119,select count(*) from person where year_born=1935;,2018-08-29 15:05:31.942545+10,1,0,117,partially correct
5120,"SELECT id, first_name, last_name
FROM person
ORDER BY year_born DESC
LIMIT 1;",2018-08-29 15:06:30.675755+10,7,1,165,correct
5121,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT * 
FROM movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
WHERE m.title=ma.title=ca.title=da.title=wa.title=aa.title
AND m.production_year=ma.production_year=ca.production_year=da.production_year=wa.production_year=aa.production_year);",2018-08-29 15:06:40.972099+10,11,0,204,partially correct
5122,"select distinct first_name, last_name, title, production_year, description
from
person
natural join
role
where
id in (select id 
	from
      (select id, count(id) as ss
	  from
	  role)
	  where ss = (select max(ss)
	  			from
				(select id, count(id) as ss
	  			from
	  			role)
				)
	);",2018-08-29 15:06:41.196061+10,15,0,271,partially correct
5123,"select mad.title, mad.production_year, p.first_name, p.last_name
from person p,(select ma.title,ma.production_year, d.id
      from movie_award ma inner join director d
	  on (ma.title = d.title
	  and ma.production_year = d.production_year)
	where ma.award_name = 'BAFTA Film Award'
	and ma.category = 'Best Film'
	and ma.result = 'Won') as mad
where p.id = mad.id;
",2018-08-29 15:06:59.894113+10,8,0,237,partially correct
5124,"select count(title)
from movie m
where not exists(
select title
from movie_award ma
where m.title = ma.title)
and not exists(
select title
from crew_award ca
where m.title =ca.title)
and not exists(
select title
from director_award da
where m.title =da.title)
and not exists(
select title
from writer_award wa
where m.title =wa.title)
and not exists(
select title
from actor_award aa
where m.title =aa.title);

",2018-08-29 15:07:17.811799+10,11,0,364,partially correct
5125,"SELECT
    p.id,
    p.first_name,
    p.last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-29 15:07:26.580148+10,7,1,36,correct
5126," SELECT mma.title, mma.production_year, p.first_name, p.last_name
 FROM (SELECT title, production_year
       FROM movie_award ma
	 WHERE lower(ma.award_name) ='bafta film award' 
	 AND lower(ma.category) = 'best film' 
	 AND lower(ma.result) = 'won')AS mma,
	 person p,
	 director d
WHERE p.id = d.id
      AND mma.title = d.title
	AND mma.production_year = d.production_year;
",2018-08-29 15:08:03.349345+10,8,1,366,correct
5127,"select mad.title, mad.production_year, p.first_name, p.last_name
from person p,(select ma.title,ma.production_year, d.id
      from movie_award ma inner join director d
	  on (ma.title = d.title
	  and ma.production_year = d.production_year)
	where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film'
	and lower(ma.result) = 'Won') as mad
where p.id = mad.id;
",2018-08-29 15:08:13.938406+10,8,0,237,partially correct
5128,"select distinct first_name, last_name, title, production_year, description
from
person
natural join
role
where
id in (select id 
	from
      (select id, count(id) as ss
	  from
	  role
	  group by id)
	  where ss = (select max(ss)
	  			from
				(select id, count(id) as ss
	  			from
	  			role
				group by id)
				)
	);",2018-08-29 15:08:26.721207+10,15,1,271,correct
5129,"select mad.title, mad.production_year, p.first_name, p.last_name
from person p,(select ma.title,ma.production_year, d.id
      from movie_award ma inner join director d
	  on ma.title = d.title
	  and ma.production_year = d.production_year
	where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film'
	and lower(ma.result) = 'Won') as mad
where p.id = mad.id;
",2018-08-29 15:09:22.64718+10,8,0,237,partially correct
5130,"SELECT title,
FROM director d,
WHERE 
	  lower(first_name)='woddy'AND 
	  lower(last_name)='allen'
	  AND person.id = d.id;

",2018-08-29 15:09:31.280685+10,9,0,370,noninterpretable
5131,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-29 15:10:53.795111+10,12,1,181,correct
5132,"select x.id
from(
	select dw.id,count(*)as number
		from (
			select id,title,production_year
			from director
			union
			select id,title,production_year
			from writer)as dw,
		movie as m
	where m.title=dw.title
		and m.production_year = dw.production_year
	group by dw.id)as x)
where x.number=(select max(x2.number)
		from(
			select id,count(*)as number
				from (select id,title,production_year
					from director
					union
					select id,title,production_year
					from writer)as dw,
				movie as m
		where m.title=dw.title
			and m.production_year = dw.production_year
		group by dw.id)as x2);
",2018-08-29 15:10:55.694608+10,14,0,149,noninterpretable
5133,"SELECT id,first_name,last_name,year_born
FROM PERSON p
GROUP BY year_born
HAVING MIN(year_born);",2018-08-29 15:11:44.480112+10,7,0,132,partially correct
5134,;,2018-08-29 15:11:58.268808+10,13,0,378,noninterpretable
5164,"select ma.title, ma.production_year,p.first_name,p.last_name
from (select title,production_year
      from movie_award
	  where lower(award_name)='BAFTA film award'
	  and lower(category) ='Best Film'
	  and lower(result) ='won')as ma,
director as d,
person as p
where ma.title=d.title
and ma.production_year=d.production_year
and p.id=d.id;

",2018-08-29 15:26:00.980786+10,8,0,237,partially correct
5168,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from role r
	natural join
	person p
group by p.id
having count(*) = (select max(num)
			from (select count(*) as num
				from role r
					natural join
					person p
					group by p.id)
);",2018-08-29 15:26:46.272953+10,15,0,43,partially correct
5135,"select count(title)
from movie m
where not exists(
select title
from movie_award ma
where m.title = ma.title and lower(ma.result) = 'won' and ma.production_year = m.production_year)
and not exists(
select title
from crew_award ca
where m.title =ca.title and lower(ca.result) = 'won' and ca.production_year = m.production_year)
and not exists(
select title
from director_award da
where m.title =da.title and lower(da.result) = 'won' and da.production_year = m.production_year)
and not exists(
select title
from writer_award wa
where m.title =wa.title and lower(wa.result) = 'won'and wa.production_year = m.production_year)
and not exists(
select title
from actor_award aa
where m.title =aa.title and lower(aa.result) = 'won'and aa.production_year = m.production_year);

",2018-08-29 15:12:46.306237+10,11,1,364,correct
5136,"SELECT
    COUNT(*)
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award > 1990
    AND year_of_award < 1996;",2018-08-29 15:13:47.216161+10,9,1,370,correct
5137,"select mad.title, mad.production_year, p.first_name, p.last_name
from (select ma.title,ma.production_year, d.id
      from movie_award ma inner join director d
	  on ma.title = d.title
	  and ma.production_year = d.production_year
	where lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film'
	and lower(ma.result) = 'Won') as mad,
person p
where p.id = mad.id;

",2018-08-29 15:13:56.118537+10,8,0,237,partially correct
5138,"SELECT id,first_name,last_name
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born) FROM person);
",2018-08-29 15:14:00.471958+10,7,1,132,correct
5139,"select p.id, p.first_name, p.last_name 
from person p,(select id,title,production_year,count(*) as NoOfMovies 
from writer natural join director
group by id
having NoOfMovies > 1) as dw
where p.id=dw.id;",2018-08-29 15:14:20.957652+10,4,1,46,correct
5140,"SELECT id
FROM person
WHERE year_born = MAX(year_born);",2018-08-29 15:16:07.170592+10,3,0,378,noninterpretable
5141,"select x.id
from(
	select dw.id,count(*)as number
		from (
			select id,title,production_year
			from director
			union
			select id,title,production_year
			from writer
			)as dw
	group by dw.id)as x
where x.number=(select max(x2.number)
		from(
			select dw.id,count(*)as number
				from (select id,title,production_year
					from director
					union
					select id,title,production_year
					from writer)as dw
		group by dw.id)as x2);
",2018-08-29 15:16:27.165745+10,14,1,149,correct
5142,"select count(movie.title)
from movie
left join movie_award on movie_award.title = movie.title 
and movie.production_year = movie_award.production_year
left join award on award.award_name = movie_award.award_name;",2018-08-29 15:16:30.299203+10,11,0,123,partially correct
5143,"SELECT COUNT(*)
FROM WRITER_AWARD wa,
	WRITER w,
	PERSON p
	
WHERE (year_of_award > 1990 AND year_of_award < 1996)
	AND p.id = w.id
	AND wa.id = w.id
	AND wa.title = w.title
	AND wa.production_year = w.production_year
	
	AND lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen'
	AND lower(result) = 'won';",2018-08-29 15:16:37.429937+10,9,1,177,correct
5144,select count(*) from writer_award wa where lower(wa.id)='woody allen' and year_of_award>1990 and year_of_award<1994;,2018-08-29 15:17:16.518708+10,9,0,306,partially correct
5145,;,2018-08-29 15:17:21.309477+10,4,0,181,noninterpretable
5146,"select p.id,p.first_name,p.last_name
from (select * from Scene as s where s.title='Psycho' and production_year='1960') as s2,person as p,role as r
where s2.production_year=r.production_year and s2.title=r.title and r.id=p.id;",2018-08-29 15:18:30.63071+10,10,0,223,partially correct
5147,"select id, first_name, last_name
from
person
where
year_born =
(select max(year_born)
from person);",2018-08-29 15:19:02.209897+10,7,1,271,correct
5148,"select count(distinct p.id) from person p, writer w where p.year_born = 1935 and p.id = w.id;",2018-08-29 15:19:41.332836+10,1,1,200,correct
5149,"SELECT count(*)
FROM (SELECT *
      FROM writer_award wa
	WHERE wa.year_of_award BETWEEN 1991 AND 1995) as wwa,
	(SELECT *
	FROM person p
	WHERE lower(p.first_name) = 'woody' AND lower(p.last_name)='allen')as pp
WHERE wwa.id = pp.id;",2018-08-29 15:20:19.21985+10,9,0,366,partially correct
5150,"SELECT p.id
FROM person
WHERE ;",2018-08-29 15:20:20.290568+10,3,0,204,noninterpretable
5151,"select id,first_name,last_name from person where id in (select d.id from director d inner join writer w on d.id=w.id and d.title=w.title and d.production_year=w.production_year group by d.id having count(d.id)>=2);",2018-08-29 15:20:31.187928+10,4,1,190,correct
5152,"SELECT count( p.id)
FROM

scene s,person p, crew c

WHERE 
s.title = c.title AND
p.id = c.id AND
lower(c.title) = 'psycho' AND
c.production_year = 1960  ;",2018-08-29 15:20:39.84834+10,10,0,370,partially correct
5153,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person WHERE year_born < (SELECT MAX (year_born) FROM person));",2018-08-29 15:21:01.726541+10,3,1,378,correct
5154,"SELECT title,production_year
FROM MOVIE m
WHERE EXISTS (SELECT * FROM MOVIE_AWARD ma WHERE ma.award_name = ""BAFTA Film Award"" AND ma.category = 'Best Film');",2018-08-29 15:22:08.782524+10,8,0,132,partially correct
5155,"select count(*) from person p,writer w where p.id=w.id and p.year_born = 1935;",2018-08-29 15:22:27.779767+10,1,0,117,partially correct
5156,"select title,production_year from writer where id in (select id from person where first_name='Kevin' and last_name='Williamson');",2018-08-29 15:23:10.861348+10,5,1,190,correct
5157,"select sub1.id
from
(select d1.id,d1.title,d1.production_year
from 	director d1
		Union
select w1.id,w1.title,w1.production_year
from	writer w1) as sub1
group by sub1.id
having count(*) = (select max(num)
			from

			  (select count(*) as num
			  from
			  (select d1.id,d1.title,d1.production_year
			  from 	director d1
					  Union
			  select w1.id,w1.title,w1.production_year
			  from	writer w1) as sub
			  group by sub.id));


",2018-08-29 15:23:25.59397+10,14,1,43,correct
5158,"select ma.title, ma.production_year,p.first_name,p.last_name
from (select title,production_year
      from movie_award
	  where lower(award_name)='baft film award'
	  and lower(category)='best film'
	  and lower(result)='won')as ma,
director d,
person p
where ma.title=d.title
and ma.production_year=d.production_year
and p.id=d.id;

",2018-08-29 15:23:30.983043+10,8,0,237,partially correct
5159,"select ma.title, ma.production_year,p.first_name,p.last_name
from (select title,production_year
      from movie_award
	  where lower(award_name)='baft film award'
	  and lower(category)='best film'
	  and lower(result)='won')as ma,
director d,
person p
where ma.title=d.title
and ma.production_year=d.production_year
and p.id=d.id;

",2018-08-29 15:24:00.766526+10,8,0,237,partially correct
5160,"select ma.title, ma.production_year,p.first_name,p.last_name
from (select title,production_year
      from movie_award
	  where lower(award_name)='baft film award'
	  and lower(category)='best film'
	  and lower(result)='won')as ma,
director d,
person p
where ma.title=d.title
and ma.production_year=d.production_year
and p.id=d.id;

",2018-08-29 15:24:40.317407+10,8,0,237,partially correct
5161,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 15:24:55.639182+10,10,1,370,correct
5162,select count(p.id) from person p where exists (select distinct w.id from writer w where p.id = w.id and p.year_born = 1935 );,2018-08-29 15:25:35.069031+10,1,1,200,correct
5163,"select country
from Restriction
where title = ""Shakespeare in Love"" and description = 'M'

;",2018-08-29 15:25:54.646514+10,6,1,154,correct
5165,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 15:26:12.468067+10,4,1,181,correct
5167,"SELECT title
FROM movie m
WHERE ;",2018-08-29 15:26:25.428095+10,11,0,370,noninterpretable
5169,"SELECT count(*)
FROM (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS a , movie m
WHERE m.title NOT IN (SELECT title From (movie_award ma NATURAL JOIN crew_award ca 
	NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS b WHERE b.result='won');",2018-08-29 15:26:54.451213+10,11,0,228,partially correct
5170,"select ma.title, ma.production_year,p.first_name,p.last_name
from (select title,production_year
      from movie_award
	  where award_name='BAFTA Film Award'
	  and category ='Best Film'
	  and result ='won')as ma,
director as d,
person as p
where ma.title=d.title
and ma.production_year=d.production_year
and p.id=d.id;

",2018-08-29 15:27:05.331549+10,8,0,237,partially correct
5171,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 15:27:24.604561+10,8,1,237,correct
5172,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from role r
	natural join
	person p
group by p.id
having count(*) = (select max(num)
			from (select count(*) as num
				from role r1
					natural join
					person p1
					group by p1.id)
);",2018-08-29 15:27:38.795332+10,15,0,43,partially correct
5173,select country from restriction where lower(title)='shakespeare in love' and description='M';,2018-08-29 15:27:53.007186+10,6,1,190,correct
5174,select count(*) from person p where exists (select * from writer w where p.id=w.id and year_born=1935);,2018-08-29 15:28:46.634519+10,1,1,117,correct
5175,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description 
FROM person AS p, role AS r, 
(SELECT id, COUNT(*) AS noOfrole FROM role group by id) AS rr
WHERE p.id=r.id
AND p.id=rr.id
AND rr.noOfrole=(SELECT MAX(noOfrole) FROM (SELECT id, COUNT(*) AS noOfrole FROM role GROUP BY id) AS rr);",2018-08-29 15:28:48.097819+10,15,1,155,correct
5176,"SELECT count(*)
FROM (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS a , movie m
WHERE m.title NOT IN (SELECT title From (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS b);",2018-08-29 15:28:55.740158+10,11,0,278,partially correct
5177,"SELECT count(*)
FROM (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS a , movie m
WHERE m.title NOT IN (SELECT title From (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa
	NATURAL JOIN actor_award aa) AS b);",2018-08-29 15:28:56.030618+10,11,0,278,partially correct
5178,"SELECT id,first_name,last_name
FROM person p
where (year_born =( SELECT MIN(year_born) FROM person p));",2018-08-29 15:29:01.445928+10,7,0,343,partially correct
5179,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 15:29:52.203437+10,10,1,223,correct
5180,"SELECT id,first_name,last_name
FROM person p
where (p.year_born =( SELECT MAX(year_born) FROM person p));",2018-08-29 15:30:05.053925+10,7,1,343,correct
5181,"select p.first_name,
	 p.last_name,
	 r.title,
	 r.production_year,
	 r.description
from person p,
	role r
where r.id=p.id
	and r.id=(select r2.id
			from(select r4.id,r4.count(*)as number
				from role r4
				group by r4.id)as r2
			where r2.id=(select max(r3.number)
					from (select r1.id,r1.count(*)as number
						from role r1
						group by r1.id)as r3));
",2018-08-29 15:30:13.612117+10,15,0,149,noninterpretable
5182,"select  id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-29 15:30:29.276597+10,7,1,190,correct
5183,"select a.id, a.title, a.production_year,a.year_of_award
	from writer_award a,(
		select id,first_name,last_name 
		from person
		where lower(first_name)='woody'
		and lower(last_name)='allen')as b
	where year_of_award>=1991 
	and year_of_award<=1995
	and a.id=b.id;",2018-08-29 15:30:44.461873+10,9,0,230,partially correct
5184,"select count(id) from (select distinct person.id, year_born from person, writer where person.id=writer.id and year_born='1935') as h;",2018-08-29 15:31:04.839542+10,1,1,140,correct
5185,"select count(*) from person, writer where person.id = writer.id and person.year_born = 1935;",2018-08-29 15:31:23.19203+10,1,0,130,partially correct
5186,"
select x.id
from
(select m.id, count(id) ss
from
(select id, production_year from director
union
select id, production_year from writer) as m
group by id) as x
where ss = 
(
select max(z.ss)
from
(select n.id, count(id) ss
 from
(select id, production_year from director
union
select id, production_year from writer) as n
group by id) as z);",2018-08-29 15:31:32.374195+10,14,1,271,correct
5187,"select p2.first_name,p2.last_name,r2.title,r2.production_year,r2.description
from role r2
	natural join
	person p2
where p2.id = 



			(select p.id
			from role r
				natural join
				person p
			group by p.id
			having count(*) = (select max(num)
						from (select count(*) as num
							from role r1
								natural join
								person p1
								group by p1.id)
			));",2018-08-29 15:31:37.371155+10,15,1,43,correct
5188,"select count(*)
from Writer_Award w inner join person p
on p.id=w.id and p.first_name='woody' and p.last_name='Allen'
where year_of_award>=1991 and year_of_award<=1995;


",2018-08-29 15:32:17.952992+10,9,0,252,partially correct
5189,"SELECT r.id
FROM ROLE r,
	PERSON p,
	APPEARENCE a,

WHERE
	r.id = p.id
	AND r.title = a.title
	AND r.production_year = a.production_year
	AND r.description = a.description
	
	AND lower(r.title) = 'psycho'
	AND r.production_year = 1960
	AND r.title = a.title

	AND a.scene_no = 1;",2018-08-29 15:33:26.887584+10,10,0,177,noninterpretable
5190,"select count(title) as number_of_award
from(select a.id, a.title, a.production_year,a.year_of_award,a.result
	from writer_award a,(
		select id,first_name,last_name 
		from person
		where lower(first_name)='woody'
		and lower(last_name)='allen')as b
	where year_of_award>=1991 
	and year_of_award<=1995
	and a.id=b.id
	and lower(a.result)='won') as c;",2018-08-29 15:33:57.055946+10,9,1,230,correct
5191,"SELECT COUNT(*)
FROM PERSON p, Writer_Award a
WHERE lower(p.first_name) = 'woody' and lower(p.last_name)='allen' and p.id=a.id and a.year_of_award >=1991 and a.year_of_award<=1995 ;
",2018-08-29 15:35:15.148161+10,9,0,132,partially correct
5192,"select production_year,count(production_year) from movie m where m.production_year>=1991 and m.production_year <=1993 group by production_year;",2018-08-29 15:35:19.594432+10,2,1,200,correct
5193,"select title,production_year 
from (select * from writer natural join person 
where lower(first_name)='kevin'
	and lower(last_name)='williamson');",2018-08-29 15:36:12.17523+10,5,1,46,correct
5194,"SELECT title, production_year, first_name, last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) AS mdp 
WHERE award_name = 'BAFTA Film Award'
AND category = 'best film'
AND result = 'won';",2018-08-29 15:36:58.804318+10,8,1,222,correct
5195,"select id from person p, movie m,scene s where m.tile=s.tile and m.id=p.id and lower(m.tile)='psycho' having count(*)=1;",2018-08-29 15:37:00.876423+10,10,0,306,noninterpretable
5196,"select 
	max(year_born), id, first_name, last_name
from 
	person
;",2018-08-29 15:37:33.777767+10,7,0,154,partially correct
5197,"select production_year, count(production_year) from (select * from movie where production_year=1991 or production_year=1992 or production_year=1993) as h group by production_year;",2018-08-29 15:38:39.309799+10,2,1,140,correct
5236,select count(*) from person p left join director d on p.id=d.id where title is null;,2018-08-29 15:57:49.093798+10,12,1,117,correct
5198,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description 
FROM person AS p, role AS r, 
(SELECT id, COUNT(*) AS noOfrole FROM role group by id) AS rr
WHERE p.id=r.id
AND p.id=rr.id
AND rr.noOfrole=(SELECT MAX(noOfrole) FROM (SELECT id, COUNT(*) AS noOfrole FROM role GROUP BY id) AS rr);",2018-08-29 15:38:56.048876+10,15,1,155,correct
5199,"select count(*) 
from person p
where exists (select * from writer w where w.id=p.id and p.year_born= 1935);",2018-08-29 15:38:57.034224+10,1,1,391,correct
5200,"SELECT COUNT(*)
FROM PERSON p, Writer_Award a,writer w
WHERE 
		
		lower(p.first_name) = 'woody' 
		AND a.production_year = w.production_year
		and a.id = w.id
		and lower(p.last_name)='allen' 
		and p.id=w.id 
		and lower(a.result) = 'won'
		and a.year_of_award >=1991 
		and a.year_of_award<=1995 ;
",2018-08-29 15:39:23.815969+10,9,1,132,correct
5201,"

select a.id
from person a
where a.year_born=(select max(p.year_born)
from person p
where p.year_born < (select max(pp.year_born)
from person pp));
",2018-08-29 15:39:55.634333+10,3,1,364,correct
5202,"select title,production_year 
from (select title,production_year from writer natural join person 
where lower(first_name)='kevin'
	and lower(last_name)='williamson');",2018-08-29 15:39:58.257995+10,5,1,46,correct
5203,"select 
	id, first_name, last_name
from 
	person

Where person.year_born = (select max(year_born) from person) 
;",2018-08-29 15:40:09.480308+10,7,1,154,correct
5204,"select count(*)
from writer,person
where writer.id=person.id and person.year_born=1935;",2018-08-29 15:40:49.045474+10,1,0,397,partially correct
5205,"select count(*)
from Writer_Award a natural join person p natural join Writer w
where p.first_name='Woody' and p.last_name='Allen' and 
   a.year_of_award>=1991 and a.year_of_award<=1995 AND lower(RESULT)= 'won';


",2018-08-29 15:40:53.949694+10,9,1,252,correct
5206,"SELECT COUNT(*)
FROM PERSON p, Writer_Award a,writer w
WHERE 
		
		lower(p.first_name) = 'woody' 
		AND a.production_year = w.production_year
		and a.title = w.title
		
		and p.id=w.id 
		and lower(p.last_name)='allen' 
		and lower(a.result) = 'won'
		and a.year_of_award >=1991 
		and a.year_of_award<=1995 ;
",2018-08-29 15:41:15.131925+10,9,1,132,correct
5207,select count(*) from (select p.id from person p where not exists (select distinct director.id from director));,2018-08-29 15:41:20.070982+10,12,0,200,partially correct
5208,;,2018-08-29 15:41:56.442485+10,15,0,278,noninterpretable
5209,"SELECT count(*)
FROM (SELECT *
      FROM writer_award wa
	WHERE wa.year_of_award BETWEEN 1991 AND 1995
	AND wa.result ='won')as wwa,
	(SELECT *
	FROM person p
	WHERE lower(p.first_name) = 'woody' AND lower(p.last_name)='allen')as pp
WHERE wwa.id = pp.id;",2018-08-29 15:42:18.56563+10,9,1,366,correct
5210,"select count (distinct p.id)
	from writer w, person p
	where w.id = p.id and year_born = 1935;",2018-08-29 15:42:20.935293+10,1,1,396,correct
5211,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d,director_award da
WHERE lower(result)='nominated'
AND NOT EXISTS (SELECT da.result FROM director_award da WHERE d.title=da.title AND d.production_year=da.production_year 
AND lower(result)='won');",2018-08-29 15:44:00.572032+10,13,0,204,partially correct
5212,select count(*) from person where exists(select * from writer inner join person where person.id = writer.id and person.year_born= 1935);,2018-08-29 15:44:54.268066+10,1,0,130,partially correct
5213,"select * from (select production_year,count(*) from movie group by movie.production_year)as A where A.production_year=1991 or A.production_year=1992 or A.production_year=1993;",2018-08-29 15:45:26.939287+10,2,1,117,correct
5214,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND a.title = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 15:47:09.122555+10,10,0,36,partially correct
5215,"select country 
from restriction
where lower(title)= 'shakespeare in love'
	and lower(description)='m';",2018-08-29 15:47:42.486748+10,6,1,46,correct
5216,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 15:47:44.393092+10,10,1,36,correct
5217,"select count(w.id)
from WRITER w, PERSON p
where w.id=p.id;",2018-08-29 15:47:47.650077+10,1,0,359,partially correct
5218,select count(*) from writer w inner join person p on w.id =p.id where p.year_born = 1935;,2018-08-29 15:47:59.427438+10,1,0,130,partially correct
5219,"select production_year, count (distinct title)
from movie
where production_year in (1993,1992,1991);",2018-08-29 15:48:37.334579+10,2,0,396,partially correct
5220,"SELECT count(*)
FROM PERSON p
WHERE EXISTS(
SELECT * 
FROM WRITER w
WHERE p.id=w.id and p.year_born=1935);",2018-08-29 15:49:15.095007+10,1,1,143,correct
5221,select count(*) from ( select * from person where not exists ( select * from director where director.id=person.id) )as h;,2018-08-29 15:49:50.5298+10,12,1,140,correct
5222,"select production_year p, count (distinct title)
from movie
where p in (1993,1992,1991)
group by p;",2018-08-29 15:50:45.410785+10,2,1,396,correct
5223,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-29 15:50:47.149812+10,13,1,204,correct
5224,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 15:52:39.10676+10,1,1,359,correct
5225,"SELECT p.ID, p.first_name, p.last_name, c.title FROM 
person p
INNER JOIN
crew c ON p.id = c.id,
actor_award aa
GROUP BY last_name
HAVING COUNT(aa.result = 'won') > 1;",2018-08-29 15:52:59.983229+10,1,0,299,partially correct
5226,"SELECT COUNT(*)
FROM (writer_award NATURAL JOIN writer NATURAL JOIN person) AS wwp
WHERE lower(result) = 'won'
AND year_of_award >= 1991 
AND year_of_award <= 1995
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen';",2018-08-29 15:53:28.471908+10,9,1,222,correct
5227,"select cr.id
from crew cr,(select a.title,a.production_year,a.scene_no
from appearance a
join role r on a.title=r.title and a.production_year=r.production_year
where a.title='Psycho'and a.production_year=1960 and a.scene_no=1) as b
where b.title=cr.title and b.production_year=cr.production_year;",2018-08-29 15:53:51.917788+10,10,0,230,partially correct
5228,SELECT;,2018-08-29 15:54:48.243663+10,11,0,36,noninterpretable
5229,select * from actor_award;,2018-08-29 15:54:58.392195+10,4,0,394,partially correct
5230,"select m.production_year, count(*)
from MOVIE m
where m.production_year in (1993,1992,1991);",2018-08-29 15:55:27.7309+10,2,0,359,partially correct
5231,"select title,production_year from movie_award where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';",2018-08-29 15:55:44.767364+10,8,0,29,partially correct
5232,"select dad.id, dad.award_name, dad.year_of_award, dad.category
from (director_award natural join director d) dad
where lower(dad.result) = 'nominated'
group by dad.id
having count(*) > 0
and dad.id not in 

(select dad1.id
from (director_award natural join director d) dad1
where lower(dad1.result) = 'won')


;",2018-08-29 15:56:23.362197+10,13,1,254,correct
5233,select count(*) from person p left join director d on p.id=d.id where title is not null;,2018-08-29 15:56:42.984248+10,12,0,117,partially correct
5234,"select m.production_year, count(*)
from MOVIE m
where m.production_year in (1993,1992,1991)
group by m.production_year;",2018-08-29 15:57:03.343368+10,2,1,359,correct
5235,"SELECT r.id
FROM (SELECT *
      FROM appearance a
	WHERE lower(a.title)='psycho'
	AND a.production_year =1960)as aa,
	role r
Group by aa.description
HAVING count(*)=1;
",2018-08-29 15:57:05.745155+10,10,0,366,partially correct
5238,"SELECT DISTINCT d.id,MAX(*)
FROM director d,writer w 
WHERE d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year;
",2018-08-29 16:00:25.784221+10,14,0,204,noninterpretable
5239,"select count(person.id)
from person
    inner join
    director
    on person.id = director.id
    ;",2018-08-29 16:00:42.638569+10,12,0,387,partially correct
5240,"select d.title,d.production_year,p.first_name, p.last_name from director d inner join (
	select * from movie_award where lower(award_name)='bafta film award' and lower(category)='best film'   and lower(result)='won'
) m on m.title=d.title and m.production_year=d.production_year inner join person p on p.id=d.id;",2018-08-29 16:01:06.348386+10,8,1,29,correct
5241,"select count(*)
from person p
where exists (select d.id
                 from Director d
		     where d.id=p.id);",2018-08-29 16:01:12.971241+10,12,0,359,partially correct
5242,"select count(*)
from person p
where not exists (select d.id
                 from Director d
		     where d.id=p.id);",2018-08-29 16:01:36.389518+10,12,1,359,correct
5243,"SELECT id
FROM Crew c natural join Person p AS cp

WHERE a.title='Psycho' AND a.production_year=1960 AND a.scene_no=1 ;",2018-08-29 16:01:49.573442+10,10,0,252,noninterpretable
5244,"SELECT title,production_year
FROM movie_award  t
WHERE t.category ='Best Film';",2018-08-29 16:02:08.32719+10,8,0,343,partially correct
5245,"select p.id, rr.title, rr.production_year, rr.description
from person p, (select * from role
                where exists (select MAX(lrt.lr) from (select r.id, count(*) AS lr from role r) AS lrt)) AS rr
where p.id=rr.id;",2018-08-29 16:02:49.590467+10,15,0,272,partially correct
5246,"select country from restriction
where title='Shakespeare in Love' and description='M';",2018-08-29 16:03:35.956729+10,6,1,197,correct
5247,"SELECT country
FROM RESTRICTION
WHERE title=""Shakespeare in Love"" AND description=""M"";",2018-08-29 16:05:00.835538+10,6,1,249,correct
5248,select count(id) from person where person.year_born =1935;,2018-08-29 16:05:35.791435+10,1,0,323,partially correct
5249,"select x.id
from 

(select count(*) as number_of_movies, worker.id
from
(select id, title, production_year
from director

union

select id, title, production_year
from writer) worker
group by worker.id) x

where x.number_of_movies = 


(select max(number_of_movies)
from
(select count(*) as number_of_movies, worker.id
from
(select id, title, production_year
from director

union

select id, title, production_year
from writer) worker
group by worker.id) x)
;",2018-08-29 16:05:42.829614+10,14,1,254,correct
5250,select count(p.id) from person p where not exists (select director.id from director where director.id = p.id);,2018-08-29 16:05:46.516037+10,12,1,200,correct
5251,"SELECT 
	id
FROM
	scene
	NATURAL JOIN crew
WHERE
	scene_no = 1
	AND lower(title) = 'psycho'
	AND production_year = 1960
;",2018-08-29 16:06:28.973321+10,10,0,222,partially correct
5252,"with distincW as 
(select distinct id from writer 
)
select count(*)
from person,distincW
where person.year_born=1935
and person.id=distincW.id;",2018-08-29 16:06:29.145777+10,1,1,397,correct
5253,"select count(*) from(select distinct p.id from person p,writer w where p.id = w.id and year_born=1935)as A;
",2018-08-29 16:06:30.128591+10,1,1,117,correct
5254,"	SELECT r.id,COUNT(s.scene_no)
	FROM APPEARANCE a,ROLE r,SCENE s
	WHERE a.title =s.title
		and lower(a.title) = 'psycho'
		and a.scene_no = s.scene_no
		and a.title = r.title
		and a.description = r.description
		and r.title=s.title
		and r.production_year = s.production_year
	GROUP BY r.id
	HAVING COUNT(s.scene_no)=1;
",2018-08-29 16:06:58.420364+10,10,0,132,partially correct
5255,"SELECT r.id
FROM scene c natural join appearance a natural join role r 
WHERE a.title='Psycho' AND a.production_year=1960
group by r.id
having  count(*)=1;",2018-08-29 16:07:08.395387+10,10,0,252,partially correct
5256,"	
select count(*)
from person
where not exists (
        select *
        from director
        where person.id = director.id


)
;",2018-08-29 16:07:30.561642+10,12,1,387,correct
5257,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-29 16:07:48.374367+10,1,1,323,correct
5258,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 16:08:43.283971+10,14,1,204,correct
5259,"select count(*)
from (select distinct id
from person natural join writer
where year_born = '1935');",2018-08-29 16:08:52.767597+10,1,1,109,correct
5260,;,2018-08-29 16:09:45.053498+10,15,0,204,noninterpretable
5261,"select * from person p inner join writer_award w on p.id=w.id where 
	lower(first_name)='woody' and lower(last_name)='allen' and
	year_of_award<=1995 and year_of_award>=1991
	and lower(result)='won';",2018-08-29 16:10:23.650392+10,9,0,29,partially correct
5262,"select production_year,count(*)
from movie
group by production_year
having production_year in (1991,1992,1993);",2018-08-29 16:10:47.343635+10,2,1,391,correct
5263,"select count(*) from person p inner join writer_award w on p.id=w.id where 
	lower(first_name)='woody' and lower(last_name)='allen' and
	year_of_award<=1995 and year_of_award>=1991
	and lower(result)='won';",2018-08-29 16:10:48.744026+10,9,1,29,correct
5264,"select count(*) from writer_award as wd,writer as w,person as p where
w.id in (select wd.id where wd.year_of_award>=1991 AND wd.year_of_award<=1995)
AND p.id=w.id
AND lower(p.first_name)=""woody"" AND lower (p.last_name)=""allen""
;",2018-08-29 16:11:04.601453+10,9,0,31,partially correct
5265,"select count(distinct person.id)
from person,writer
where person.id=writer.id and person.year_born=1935;",2018-08-29 16:11:18.178474+10,1,1,397,correct
5266,"select id, year_born desc from person
order by year_born desc
limit 1,1;",2018-08-29 16:12:05.034844+10,3,0,123,partially correct
5267,"select id from person
order by year_born desc
limit 1,1;",2018-08-29 16:12:25.852583+10,3,1,123,correct
5268,"select count (p.id)
from person p
where p.id NOT IN (SELECT id from director);",2018-08-29 16:12:29.127702+10,12,1,396,correct
5269,"select distinct p.id, p.first_name, p.last_name
from PERSON p, Writer w
where w.id=p.id and (select count(*)
               from Movie natural join Director  natural join Writer 
			  )>=2;",2018-08-29 16:12:54.662852+10,4,0,359,partially correct
5270,"select dw.title, dw.production_year
from (movie outer join writer outer join person) as dw
where (select *
        from person
        where person.first_name=Kevin and person.last_name=Williamson);",2018-08-29 16:13:02.398961+10,5,0,181,noninterpretable
5271,"select title
from movie
group by production_year
having production_year=1993 or production_year=1992 or production_year=1991;",2018-08-29 16:13:24.321234+10,2,0,397,partially correct
5272,"select count(*)
from person p
where exists(select * from writer w where w.id = p.id and year_born = 1935);",2018-08-29 16:14:04.876579+10,1,1,87,correct
5273,"SELECT id, first_name, last_name, MIN(year_born)
FROM PERSON;
",2018-08-29 16:14:16.533816+10,7,0,249,partially correct
5274,"select x.id, p.first_name, p.last_name, r.title, r.production_year, r.description 
from
(select count(*) as num_of_roles, *
from role
group by id) x, person p, role r

where x.num_of_roles = 

(select max(num_of_roles)
from
(select count(*) as num_of_roles, *
from role
group by id) x)

and p.id = x.id
and r.id = x.id

;",2018-08-29 16:14:38.744322+10,15,0,254,partially correct
5275,"select production_year,count(title)
from movie
group by production_year
having production_year=1993 or production_year=1992 or production_year=1991;",2018-08-29 16:14:39.005784+10,2,1,397,correct
5276,"
select count(*) from movie m where production_year=1993;",2018-08-29 16:14:49.345664+10,2,0,323,partially correct
5277,"select count(*) from person p
where not exists(select * from director d where d.id = p.id);",2018-08-29 16:14:59.305625+10,12,1,87,correct
5278,"select p.first_name, p.last_name, r.title, r.production_year, r.description 
from
(select count(*) as num_of_roles, *
from role
group by id) x, person p, role r

where x.num_of_roles = 

(select max(num_of_roles)
from
(select count(*) as num_of_roles, *
from role
group by id) x)

and p.id = x.id
and r.id = x.id

;",2018-08-29 16:15:04.633608+10,15,1,254,correct
5279,"SELECT
    r.id
FROM
    scene s natural join appearance a natural join ROLE r
WHERE
   lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 16:15:07.752828+10,10,0,252,partially correct
5280,"select id, first_name, last_name
from person natural join writer natural join director
group by id
having count(*) > 1;",2018-08-29 16:15:45.321414+10,4,1,87,correct
5281,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 16:15:51.297677+10,10,1,252,correct
5282,"select id,first_name, last_name
from person
where year_born in (select max(year_born) from person);",2018-08-29 16:16:07.358884+10,7,1,197,correct
5283,"select title, production_year
from writer natural join person
where lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-29 16:16:44.142358+10,5,1,87,correct
5284,"SELECT count(*), production_year 
FROM movie
GROUP BY production_year
HAVING production_year=1993 OR production_year=1992 OR production_year=1991;",2018-08-29 16:17:07.234879+10,2,1,143,correct
5285,"select country
from restriction
where lower(title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-29 16:17:42.171774+10,6,1,87,correct
5286,"with Largestwork as
(Select id count(*) as Noofwork
 From writer, director
 group by person.id);",2018-08-29 16:18:01.478879+10,14,0,83,noninterpretable
5287,"select distinct person.id, first_name, last_name 
from person, (select w.id, w.title, w.production_year, count(w.id)
from director as d, writer as w
where d.id=w.id
and d.title=w.title
and d.production_year=w.production_year
group by w.id, w.title, w.production_year
having count(w.id)>2)as h
where person.id=h.id;",2018-08-29 16:18:28.951301+10,4,0,140,partially correct
5288,"select count(distinct person.id)
from person,director
where person.id !=director.id;",2018-08-29 16:18:31.550997+10,12,0,397,partially correct
5289,"Select distinct country
from Restriction  
where title = 'Shakespeare in Love'
AND description = 'M';",2018-08-29 16:18:32.850186+10,6,1,92,correct
5290,"select production_year,count(*) 
from movie where 1990<production_year and production_year<1994
group by production_year;",2018-08-29 16:18:51.076931+10,2,1,323,correct
5291,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-29 16:18:53.749654+10,7,1,87,correct
5292,"select distinct person.id, first_name, last_name 
from person, (select w.id, w.title, w.production_year, count(w.id)
from director as d, writer as w
where d.id=w.id
and d.title=w.title
and d.production_year=w.production_year
group by w.id, w.title, w.production_year
having count(w.id)>1)as h
where person.id=h.id;",2018-08-29 16:19:05.007937+10,4,0,140,partially correct
5293,,2018-08-29 16:20:00.401353+10,11,0,309,noninterpretable
5294,"select count(*) as total
from movie m NATURAL JOIN 
     Movie_Award ma NATURAL JOIN
     crew_award c NATURAL JOIN 
     director_award d NATURAL JOIN
     writer_award w NATURAL JOIN
     actor_award a
where m.title!=ma.title 
  AND m.title!=c.title
  AND m.title!=d.title
  AND m.title!=w.title
  AND m.title!=a.title;
",2018-08-29 16:20:04.023993+10,11,0,309,partially correct
5295,"SELECT movie_award.title, movie_award.production_year, 
FROM movie_award
WHERE award_name = 'BAFTA Film Award';
",2018-08-29 16:20:28.489195+10,8,0,165,noninterpretable
5296,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 16:20:40.157755+10,4,1,359,correct
5297,"select * from role r,scene s,appearance a
where(r.title = ""Psycho"" and r.production_year=1960 and 
r.title= a.title and s.title = r.title and r.production_year=a.production_year 
AND s.scene_no = a.scene_no and   a.description = r.description)
group by r.id
;

",2018-08-29 16:20:45.834888+10,10,0,238,partially correct
5298,"SELECT count(*), production_year 
FROM movie
GROUP BY production_year
HAVING production_year=1993 OR production_year=1992 OR production_year=1991
ORDER BY production_year;",2018-08-29 16:21:11.41357+10,2,1,143,correct
5299,"select title,production_year from writer w,person p where w.id=p.id and first_name='Kevin' and last_name='Williamson';
",2018-08-29 16:21:35.227529+10,5,1,117,correct
5300,"SELECT production_year,count(*)
FROM movie
GROUP BY production_year
HAVING production_year=1993 OR production_year=1992 OR production_year=1991
ORDER BY production_year;",2018-08-29 16:21:40.764275+10,2,1,143,correct
5301,"select person.id 
from 
(select person.id from person
order by year_born desc
limit 2), person
order by year_born asc
limit 1;

",2018-08-29 16:21:52.862925+10,3,0,123,partially correct
5302,"select count (p.id)
from person p
where p.id NOT exists (SELECT id from director d where p.id = d.id);",2018-08-29 16:22:27.308118+10,12,0,396,noninterpretable
5303,"select b.first_name, b.last_name, i.title, i.production_year, i.description 
from person b, role i, (
            select id, count(*) from role group by id
            having count(*)=(select max(number) from (select count(*) as number from role group by id))) as h
WHERE b.id=h.id
  and i.id=h.id;
",2018-08-29 16:22:33.65288+10,15,1,272,correct
5304," 
select person.id as IID from person
order by year_born desc
limit 1,1;",2018-08-29 16:23:25.019209+10,3,1,123,correct
5305,select count(*) from ;,2018-08-29 16:23:49.95733+10,11,0,306,noninterpretable
5306,"select count (p.id)
from person p
where not exists(SELECT * from director d where p.id = d.id);",2018-08-29 16:23:55.279646+10,12,1,396,correct
5307,"select country from restriction where title='Shakespeare in Love' and description='M';
",2018-08-29 16:23:55.706957+10,6,1,117,correct
5308,"select count(*) from person p
where not exists (select id from director d where d.id=p.id);",2018-08-29 16:24:00.399643+10,12,1,323,correct
5309,"select m.title, m.production_year
from Movie m natural join Writer w natural join PERSON p
where p.first_name='Kevin' and p.last_name='Williamson';",2018-08-29 16:24:33.6998+10,5,1,359,correct
5310,"select d.id
from(select id,count(*) as num
from(select distinct *
from role cr,(select a.title,a.production_year,a.scene_no,a.description
from appearance a
where a.title='Psycho'and a.production_year=1960 ) as b
where b.title=cr.title and b.production_year=cr.production_year and b.description=cr.description) as c
group by c.id) as d
where d.num=1;",2018-08-29 16:24:34.19477+10,10,1,230,correct
5311,"select p.id from Appearance a inner join role r on a.title=r.title and a.production_year=r.production_year and a.description=r.description 

inner join person p on p.id=r.id where a.title='Psycho' and a.production_year=1960 group by p.id having count(*)=1;",2018-08-29 16:25:06.555915+10,10,1,29,correct
5312,"select r.id
from role r, scene s, appearance a
where a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.description=s.description
and r.title=s.title
and r.production_year=s.production_year
and lower(a.title)='psycho'
and a.production_year='1960'
group by r.id
having count(*)=1;",2018-08-29 16:25:08.194691+10,10,0,237,partially correct
5313,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 16:26:40.047807+10,10,1,366,correct
5314,"SELECT dw.id, MAX(dw. title)
FROM (director d NATURAL JOIN writer w) AS dw;
",2018-08-29 16:26:48.583411+10,14,0,272,partially correct
5315,"select dw.title, dw.production_year
from (writer natural join person)as dw
where exists (dw.first_name=Kevin and dw.last_name=Williamson);",2018-08-29 16:26:53.285543+10,5,0,181,noninterpretable
5316,"select country
from Restriction 
where title='Shakespeare in Love' and  description='M';",2018-08-29 16:27:21.805963+10,6,1,359,correct
5384,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-29 16:53:22.454976+10,3,1,370,correct
5317,"select count(*)  from writer_award as wd,writer as w,person as p where
w.id in (select wd.id where wd.year_of_award>=1991 AND wd.year_of_award<=1995 AND wd.title=w.title AND wd.production_year=w.production_year)
AND p.id=w.id
AND lower(p.first_name)=""woody"" AND lower (p.last_name)=""allen""
AND lower(wd.result=""won"")
;",2018-08-29 16:27:26.786146+10,9,1,31,correct
5318,"Select count(*)
From movie, movie_awards natural join crew_wards natural join director_awards natural join writer_awards natural join actor_awards a
Where not exists movie.title = a.title and movie.production_year=a.production_year;",2018-08-29 16:27:29.881517+10,11,0,252,noninterpretable
5319,"SELECT count(*)
FROM writer w,person p
WHERE w.id = p.id 
	AND p.year_born = 1935;",2018-08-29 16:28:08.549159+10,1,0,49,partially correct
5320,"SELECT *
FROM person p
WHERE NOT EXISTS(
SELECT *
FROM director d
WHERE p.id=d.id);",2018-08-29 16:28:10.521305+10,12,0,143,partially correct
5321,"select gg.title, gg.production_year, gg.first_name, gg.last_name

from (person natural join director) as gg

where exists (select award_name = ""BAFTA Film Award"" and category = ""Best Film"" from movie_award)

group by gg.title ;",2018-08-29 16:28:14.921753+10,8,0,154,partially correct
5322,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 16:28:20.36316+10,14,1,272,correct
5323,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(
SELECT *
FROM director d
WHERE p.id=d.id);",2018-08-29 16:28:34.286398+10,12,1,143,correct
5324,"select id, first_name, last_name
from person 
order by  year_born DESC
LIMIT 1;",2018-08-29 16:28:54.742235+10,7,1,359,correct
5325,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 16:29:24.298477+10,11,1,252,correct
5326,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
     s.title=a.title
	 and s.title =r.title
	 and s.production_year=a.production_year
	 and r.production_year=a.production_year
	 and s.scene_no=a.scene_no
	 and a.description=r.description
	 and s.title=""Psycho""
	 and s.production_year=1960
group by r.id
having count(*)=1;",2018-08-29 16:29:27.383869+10,10,1,238,correct
5327,"select p1.id, p1.first_name, p1.last_name, p1.year_born
from (select distinct max(p2.year_born) as myb, p2.id, p2.first_name, p2.last_name from person as p2) as p3, person as p1
where p1.id = p3.id
and p1.year_born = p3.myb;  
",2018-08-29 16:30:26.402176+10,7,0,92,partially correct
5328,"SELECT movie_award.title, movie_award.production_year, person.first_name, person.last_name
FROM movie_award, person, director
WHERE award_name = 'BAFTA Film Award' AND category = 'best film' AND result = 'won' AND person.id= director.id AND director.title =movie_award.title;
",2018-08-29 16:31:18.135706+10,8,1,165,correct
5329,"select aaa
from ;",2018-08-29 16:31:45.029337+10,10,0,239,noninterpretable
5330,"SELECT title, production_year
FROM Movie_Award
where award_name='BAFTA Film Award' and  result='won';",2018-08-29 16:32:16.595022+10,8,0,359,partially correct
5331,"select p1.id, p1.first_name, p1.last_name
from (select max(p2.year_born) as myb, p2.id, p2.first_name, p2.last_name from person as p2) as p3, person as p1
where p1.id = p3.id
and p1.year_born = p3.myb;  
",2018-08-29 16:32:30.799177+10,7,1,92,correct
5332,"SELECT COUNT(m.title )
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 16:32:56.410231+10,11,1,370,correct
5333,select * from person;,2018-08-29 16:33:30.687799+10,7,0,117,partially correct
5334,"SELECT ma.title,ma.production_year, p.first_name,p.last_name
From (
	SELECT title,production_year
	FROM movie_award 
	WHERE lower(award_name) = 'bafta film award' AND lower(category)='best film' AND result='won')as ma,
	person AS p,
	director AS d
WHERE ma.title = d.title
	AND ma.production_year = d.production_year
	and d.id = p.id;",2018-08-29 16:33:35.012573+10,8,1,343,correct
5335,"SELECT 
	*
FROM
	appearance NATURAL JOIN role
WHERE
	lower(title) = 'psycho'
	AND production_year = 1960
GROUP BY 
	id
HAVING
	COUNT(*) == 1;",2018-08-29 16:33:45.789686+10,10,0,222,noninterpretable
5336,"select count(*)
from (select id from person p where exists (select id from director d where d.id=p.id));",2018-08-29 16:33:47.287624+10,12,0,391,partially correct
5337,"SELECT 
	id
FROM
	appearance NATURAL JOIN role
WHERE
	lower(title) = 'psycho'
	AND production_year = 1960
GROUP BY 
	id
HAVING
	COUNT(*) == 1;",2018-08-29 16:34:03.737357+10,10,0,222,noninterpretable
5338,select id from writer w;,2018-08-29 16:34:07.985191+10,4,0,323,partially correct
5339,"select dw.title, dw.production_year   
from (writer natural join person)as dw
where exists (lower(dw.first_name)= 'kevin'
    AND lower(dw.last_name)= 'williamson');",2018-08-29 16:34:20.014004+10,5,0,181,noninterpretable
5340,"select count(*)
from (select id from person p where not exists (select id from director d where d.id=p.id));",2018-08-29 16:34:20.887881+10,12,1,391,correct
5341,select count(*) from person p where exists(select * from writer w where p.id = w.id and p.year_born =1935);,2018-08-29 16:34:35.67517+10,1,1,130,correct
5342,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-29 16:34:38.55344+10,7,1,117,correct
5343,;,2018-08-29 16:34:44.823561+10,4,0,387,noninterpretable
5344,"select id
from (
select person.id, title, production_year
from person, director
where person.id = director.id
union 
select person.id, title, production_year
from person, writer
where person.id = writer.id) as dw
group by id having count(*) = (
select max(count) 
from (select id, count(*) 
       from (select person.id, title, production_year from person, director
             where person.id = director.id
             union 
             select person.id, title, production_year
             from person, writer
             where person.id = writer.id) as dw2
       group by id)as dw3);

",2018-08-29 16:35:22.668862+10,14,0,347,noninterpretable
5345,"SELECT m.title, m.production_year,p.first_name, p.last_name
FROM Movie_Award m natural join Director natural join person p
where award_name='BAFTA Film Award' and  result='won' and category='Best Film';",2018-08-29 16:35:36.069428+10,8,0,359,partially correct
5385,"select count(*)
from person natural join writer_award
where lower(first_name) = 'woody' and lower(last_name) = 'allen' and (year_of_award between 1991 and 1995) and lower(result) = 'won';",2018-08-29 16:54:13.802849+10,9,1,109,correct
5407,"select count(*) from person p
where not exists (select * from director where director.id = p.id ) ;",2018-08-29 17:04:12.558177+10,12,1,400,correct
5346,"SELECT
    r.id
FROM
    scene s,
    appearance a,
		ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
	
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
	
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 16:36:27.819046+10,10,1,177,correct
5347,"SELECT m.title, m.production_year,p.first_name, p.last_name
FROM Movie_Award m natural join Director natural join person p
where m.award_name='BAFTA Film Award' and  m.result='won' and lower(m.category)= 'best film';",2018-08-29 16:36:36.095469+10,8,1,359,correct
5348,"select count (person.id)
from person
where person.id not in
(select id from director);",2018-08-29 16:37:09.615915+10,12,1,397,correct
5349,"select dw.id, dw.first_name, dw.last_name
from (person p natural join director natural join writer) as dw
group by dw.id
having count(*)>1
;",2018-08-29 16:37:44.607958+10,4,1,387,correct
5350,"select count(*) as total
from (select * from  movie m, Movie_Award,crew_award,director_award,writer_award,actor_award 
where m.title!=movie_award.title AND lower(movie_award.result)!='won'
  AND m.title!=crew_award.title AND lower(crew_award.result)!='won'
  AND m.title!=director_award.title AND lower(director_award.result)!='won'
  AND m.title!=writer_award.title AND lower(writer_award.result)!='won'
  AND m.title!=actor_award.title AND lower(actor_award.result)!='won') AS result;
  ",2018-08-29 16:38:05.606129+10,11,0,309,partially correct
5351,"select production_year , count(*) from movie where production_year = 1991 or production_year = 1992 or production_year = 1993
group by production_year;",2018-08-29 16:38:37.696686+10,2,1,130,correct
5352,";
",2018-08-29 16:38:39.116402+10,9,0,343,noninterpretable
5353,;,2018-08-29 16:39:43.193329+10,3,0,370,noninterpretable
5354,"SELECT first_name, last_name, title, production_year
FROM Director D INNER JOIN PERSON P ON D.id=P.id
WHERE(SELECT title, production_year
FROM MOVIE_AWARD
WHERE award_name='BAFTA Film Award' AND category='BEST FILM');",2018-08-29 16:40:19.462792+10,8,0,249,noninterpretable
5355,"SELECT production_year,COUNT(*)FROM MOVIE where production_year=1993||1992||1991
Group by production_year;",2018-08-29 16:40:31.032386+10,2,0,401,partially correct
5356,"select r.id
from role r,scene s,appearance a 
where s.title=a.title
and s.production_year=a.production_year
and s.scene_no=a.scene_no
and r.title=a.title
and r.production_year=a.production_year
and r.description=a.description
and lower(s.title)='psycho'
and s.production_year='1960'
group by r.id
having count(*)=1;",2018-08-29 16:40:42.495823+10,10,1,237,correct
5357,"select restriction.country
from restriction
where (restriction.title=Shakespeare in LoveAND restriction.description=M);",2018-08-29 16:40:48.036563+10,6,0,181,noninterpretable
5358,select count(*) from person p where not exists (select * from director d where d.id = p.id);,2018-08-29 16:41:21.032677+10,12,1,130,correct
5359,"SELECT  COUNT(*) FROM WRITER AS w
WHERE EXISTS (SELECT * FROM Person AS p WHERE w.id = p.id
AND p.year_born = 1935);",2018-08-29 16:41:54.354708+10,1,0,385,partially correct
5360,"select sum(*)
from PERSON
where year_born=1935;",2018-08-29 16:42:07.910202+10,1,0,377,noninterpretable
5361,"select count(*) from movie m
where not exists(select * from movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
where m.title=ma.title and m.title=ca.title and m.title=da.title and m.title=wa.title and m.title=aa.title );

",2018-08-29 16:42:33.885953+10,11,0,238,partially correct
5362,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=r.title
  AND r.title=a.title
  AND s.production_year=r.production_year
  AND s.production_year=a.production_year
  AND a.description=r.description
  AND r.description=s.description
  AND s.scene_no=a.scene_no
  AND lower(s.title)='psycho'
  AND a.production_year=1960
GROUP BY r.id HAVING COUNT(*)=1;",2018-08-29 16:43:10.309925+10,10,0,272,partially correct
5363,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 16:44:00.586799+10,10,1,272,correct
5364,"select *
from person p natural join writer natual join Writer_Award a
where a.year_of_award>=1991 and a.year_of_award<=1995 and a.result='won'
and p.first_name='Woody' and p.last_name='Allen';",2018-08-29 16:44:02.853252+10,9,0,359,partially correct
5365,"SELECT  COUNT(*) FROM Person AS p
WHERE EXISTS (SELECT * FROM WRITER AS W WHERE w.id = p.id
AND p.year_born = 1935);",2018-08-29 16:44:22.551313+10,1,1,385,correct
5366,"select production_year, count (*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-29 16:44:28.828847+10,2,1,401,correct
5367,"SELECT COUNT(*)
FROM writer_award,person
WHERE writer_award.year_of_award In (1991,1992,1993,1994,1995) AND person.first_name = 'Woody' AND person.last_name = 'Allen'
GROUP BY person.first_name;",2018-08-29 16:44:43.62795+10,9,0,165,partially correct
5368,"select p.id from person as p, appearance as a, role as r where lower(a.title)=""psycho"" AND a.production_year=1960 AND scene_no=1
AND r.title=a.title AND r.production_year=a.production_year AND r.description=a.description
AND r.id=p.id;",2018-08-29 16:45:03.704756+10,10,0,31,partially correct
5369,"select max(year_born),id,first_name,last_name
from person;",2018-08-29 16:45:10.272978+10,7,0,181,partially correct
5370,"select d.id,da.award_name,da.year_of_award,da.category
from director_award da, director d
where da.title =d.title
and da.production_year=d.production_year
and lower(da.result) !='won';",2018-08-29 16:45:17.91095+10,13,1,364,correct
5371,"select count(*) from  (person inner join writer on person.id = writer.id)
where year_born = '1935' ;",2018-08-29 16:45:59.191684+10,1,0,400,partially correct
5372,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma,director d,person p where ma.title=d.title and ma.production_year=d.production_year and p.id=d.id;
",2018-08-29 16:47:04.596545+10,8,0,117,partially correct
5373,"select count(*)
from writer,person
where writer.id=person.id and person.year_born=1935;",2018-08-29 16:47:15.322959+10,1,0,401,partially correct
5374,"select * from person;
",2018-08-29 16:48:38.415593+10,4,0,117,partially correct
5375,"SELECT COUNT(*)
FROM writer AS w,person AS p , writer_award AS wa
Where 
w.id = p.id 
AND w.title = wa.title 
AND w.production_year = wa.production_year
AND lower(p.first_name) = 'woody'
AND lower(p.last_name) = 'allen'
AND wa.year_of_award >1990
AND wa.year_of_award <1996;

",2018-08-29 16:48:40.427437+10,9,0,343,partially correct
5376,select * from movie;,2018-08-29 16:50:13.147507+10,15,0,184,partially correct
5377,"SELECT
    COUNT(*)
	from (select *
from person p inner join writer w  inner join Writer_Award a
on a.title=w.title and a.id=w.id and w.id=p.id
where a.year_of_award>=1991 and a.year_of_award<=1995 and a.result='won'
and p.first_name='Woody' and p.last_name='Allen');",2018-08-29 16:50:23.16573+10,9,1,359,correct
5378,"SELECT PRODUCTION_YEAR AS YEAR, COUNT(*) FROM MOVIE
GROUP BY YEAR HAVING YEAR=1993 OR YEAR= 1992 OR YEAR=1991;
",2018-08-29 16:50:27.230336+10,2,1,385,correct
5379,"SELECT COUNT(*)
FROM writer AS w,person AS p , writer_award AS wa
Where 
w.id = wa.id
AND w.id = p.id 
AND w.title = wa.title 
AND w.production_year = wa.production_year
AND lower(RESULT)= 'won'
AND lower(p.first_name) = 'woody'
AND lower(p.last_name) = 'allen'
AND wa.year_of_award >1990
AND wa.year_of_award <1996;

",2018-08-29 16:50:34.956768+10,9,1,343,correct
5380,"select id,first_name,last_name
from person
group by id
having (year_born=1992);",2018-08-29 16:50:51.023466+10,7,0,181,cheating
5381,"Select production_year, count (*)
From movie
where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-29 16:52:05.423865+10,2,1,252,correct
5382,"SELECT wd.id,wd.first_name,wd.last_name
FROM writer natural join director natural join person AS wd
group by wd.id
HAVING count(*)>1;",2018-08-29 16:52:19.82234+10,4,1,329,correct
5383,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-29 16:53:01.11838+10,2,1,252,correct
5386,"

select dr.title, dr.production_year, p.first_name, p.last_name
from (select title, production_year from movie_award
where lower(award_name) = lower('BAFTA Film Award') and  lower(category)= lower('Best Film')) as maward, director as dr, person as p
where maward.title = dr.title
and maward.production_year = dr.production_year
and dr.id = p.id;

",2018-08-29 16:55:26.008254+10,8,0,92,partially correct
5387,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
from 
(select  p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description, rank() over (order by sum(r.id) number_roles desc) rank
    from role group by r.id) 
from person p inner join role r on p.id = r.id
where rank = 1;

",2018-08-29 16:55:55.195035+10,15,0,76,noninterpretable
5388,"SELECT COUNT(*)
FROM writer_award,person,writer
WHERE writer_award.year_of_award>=1991 AND writer_award.year_of_award<=1995 AND person.first_name = 'Woody' AND person.last_name = 'Allen' AND writer_award.id = person.id
AND writer_award.id = writer.id AND writer_award.result = 'won' AND writer_award.production_year= writer.production_year;",2018-08-29 16:56:07.119072+10,9,1,165,correct
5389,"select count(*) from (select * from writer_award wa,person p where wa.id=p.id and p.first_name='Woody' and p.last_name='Allen' and wa.year_of_award>1990 and wa.year_of_award<1996)as A;",2018-08-29 16:56:22.043194+10,9,0,117,partially correct
5390,"with movwritid as 
(with modir as
(select movie.title,movie.production_year,id
from movie,director
where movie.title=director.title and movie.production_year=director.production_year)

select modir.title,modir.production_year,modir.id
from modir, writer
where modir.id=writer.id and modir.title=writer.title and modir.production_year=writer.production_year)

select t.id,t.first_name, t.last_name from(

select person.id,person.first_name, person.last_name,count(*)as number
from person, movwritid
where person.id=movwritid.id
group by person.id) as t
where t.number>1;
",2018-08-29 16:56:53.417296+10,4,1,397,correct
5391,"select count(*) from (select * from writer_award wa,person p where wa.id=p.id and p.first_name='Woody' and p.last_name='Allen' and wa.year_of_award>1991 and wa.year_of_award<1996)as A;
",2018-08-29 16:56:57.55463+10,9,1,117,correct
5392,"select count(*) from movie as numberofmovies where production_year = '1993'  group by production_year
add select count(*) from movie where production_year = '1992'
add select count(*) from movie where productino_year = '1991' ;",2018-08-29 16:58:36.856592+10,2,0,400,noninterpretable
5393,"select   mw.title, mw.production_year from (movie m natural join writer w natural join person p)as mw 


where mw.first_name = 'Kevin' And mw.last_name = 'Williamson' ;",2018-08-29 16:58:46.830914+10,5,1,65,correct
5394,"select dr.title, dr.production_year, p.first_name, p.last_name
from (select distinct title, production_year from movie_award
where lower(award_name) = lower('BAFTA Film Award') and  lower(category)= lower('Best Film') and result='won') as maward, director as dr, person as p
where maward.title = dr.title
and maward.production_year = dr.production_year
and dr.id = p.id;




",2018-08-29 16:59:12.50043+10,8,1,92,correct
5395,"select p.id,p.first_name,p.last_name
from person p,writer w where p.id = w.id and exists (select p.id from person p,director d where d.id=person.id and count(person.id)>=0 group by p.id);",2018-08-29 16:59:50.054462+10,4,0,200,noninterpretable
5396,"SELECT COUNT(*) FROM PERSON AS p 
WHERE NOT EXISTS (SELECT * FROM DIRECTOR  AS d WHERE p.id = d.id);",2018-08-29 17:00:57.659947+10,12,1,385,correct
5397,"SELECT p.id, p.first_name, p.last_name FROM person p
WHERE p.id IN (SELECT w.id FROM writer w
NATURAL JOIN director d
GROUP BY w.id
HAVING COUNT(w.title)>=2);",2018-08-29 17:01:42.03693+10,4,1,130,correct
5398,"select id 
from (select id, count(*) as No from (select id, title, production_year from writer union select id, title, production_year from director) as dw group by id) as dw1
where No = (
select max(No2)
from (select id, count(*) as No2 from (select id, title, production_year from writer union select id, title, production_year from director) as dw2 group by id) as dw3);
",2018-08-29 17:01:56.523337+10,14,1,347,correct
5399,"SELECT COUNT(*)
FROM MOVIE m

WHERE NOT EXISTS 
		(SELECT ma.title
		FROM MOVIE_AWARD ma
		WHERE m.title = ma.title
		AND m.production_year = ma.production_year)
		
		OR (SELECT ca.title
		FROM CREW c,
		     CREW_AWARD ca
		WHERE m.title = c.title
		AND m.production_year = c.production_year
		AND ca.id = c.id
		AND ca.title = c.title
		AND ca.production_year = c.production_year)
		
		OR (SELECT da.title
		FROM DIRECTOR d,
		     DIRECTOR_AWARD da
		WHERE m.title = d.title
		AND m.production_year = d.production_year
		AND da.title = d.title
		AND da.production_year = d.production_year)
		
		OR (SELECT wa.title
		FROM WRITER w,
		     WRITER_AWARD wa
		WHERE w.title = m.title
		AND w.production_year = m.production_year
		AND w.id = wa.id
		AND w.title = wa.title
		AND w.production_year = wa.production_year)
		
		OR (SELECT aa.title
		FROM ROLE r,
		     ACTOR_AWARD aa
		WHERE r.title = m.title
		AND r.production_year = m.production_year
		AND aa.title = r.title
		AND aa.production_year = r.production_year
		AND aa.description = r.description);",2018-08-29 17:01:58.724437+10,11,0,177,partially correct
5400,"SELECT COUNT(*) 
FROM movie
WHERE NOT EXISTS (
	SELECT * 
	FROM (
		SELECT title, production_year 
		FROM movie_award 
		UNION 
		SELECT title, production_year  
		FROM crew_award
		UNION
		SELECT title, production_year 
		FROM director_award
		UNION
		SELECT title, production_year 
		FROM writer_award
		UNION
		SELECT title, production_year 
		FROM actor_award) AS awards
	WHERE movie.title = awards.title
	AND movie.production_year = awards.production_year)
;",2018-08-29 17:01:59.728281+10,11,0,222,partially correct
5401,"select count(*) from person p
where not exists (select count(*) from person, director where director.id = person.id ) ;",2018-08-29 17:02:43.690493+10,12,0,400,partially correct
5402,"select dw.title,dw.production_year,dw.first_name,dw.last_name
from(movie_award natural join movie natural join person)
where (upper(dw.award_name)='bafta film award' and upper(dw.category)='best film');",2018-08-29 17:02:45.157703+10,8,0,181,noninterpretable
5403,"select id 
from (select id, count(*) as No from (select id, title, production_year from writer union select id, title, production_year from director) as dw group by id) as dw1
where No = (
select max(No2)
from (select id, count(*) as No2 from (select id, title, production_year from writer union select id, title, production_year from director) as dw2 group by id) as dw3);
",2018-08-29 17:02:45.813748+10,14,1,347,correct
5404,"SELECT COUNT(*)
FROM MOVIE m

WHERE NOT EXISTS 
		(SELECT ma.title
		FROM MOVIE_AWARD ma
		WHERE m.title = ma.title
		AND m.production_year = ma.production_year)
		
	AND NOT EXISTS 
		(SELECT ca.title
		FROM CREW c,
		     CREW_AWARD ca
		WHERE m.title = c.title
		AND m.production_year = c.production_year
		AND ca.id = c.id
		AND ca.title = c.title
		AND ca.production_year = c.production_year)
		
	AND NOT EXISTS
		(SELECT da.title
		FROM DIRECTOR d,
		     DIRECTOR_AWARD da
		WHERE m.title = d.title
		AND m.production_year = d.production_year
		AND da.title = d.title
		AND da.production_year = d.production_year)
		
	AND NOT EXISTS
		(SELECT wa.title
		FROM WRITER w,
		     WRITER_AWARD wa
		WHERE w.title = m.title
		AND w.production_year = m.production_year
		AND w.id = wa.id
		AND w.title = wa.title
		AND w.production_year = wa.production_year)
		
	AND NOT EXISTS
		(SELECT aa.title
		FROM ROLE r,
		     ACTOR_AWARD aa
		WHERE r.title = m.title
		AND r.production_year = m.production_year
		AND aa.title = r.title
		AND aa.production_year = r.production_year
		AND aa.description = r.description);",2018-08-29 17:03:03.468496+10,11,0,177,partially correct
5405,"WITH d_id AS(
SELECT d.id
FROM director d inner join writer w on d.title = w.title AND d.production_year=w.production_year
WHERE d.id=w.id
GROUP BY d.id
HAVING count(*)>1
)
SELECT id, first_name, last_name
FROM PERSON
WHERE id IN (SELECT * FROM d_id);",2018-08-29 17:03:15.620567+10,4,1,143,correct
5408,"select m.id
from(select id,max(year_born) 
from person
where year_born not in (select max(year_born)  from person))as m
;",2018-08-29 17:05:14.48435+10,3,1,230,correct
5409,"select m.title, m.production_year , person.first_name, person.last_name
from person,(select * from movie_award, director where movie_award.production_year=director.production_year and
movie_award.title=director.title) as m
where person.id =m.id and m.award_name='BAFTA Film Award' and m.category='Best Film'
;

",2018-08-29 17:05:32.064623+10,8,0,197,partially correct
5410," select wm.title, wm.production_year
    from (writer natural join movie) as wm
    inner join person
    on person.id =wm.id
    where person.first_name = 'Kevin' and person.last_name = 'Williamson'
    ;
    ",2018-08-29 17:06:46.556439+10,5,1,387,correct
5411,"SELECT COUNT(*) 
FROM movie
WHERE NOT EXISTS (
	SELECT * 
	FROM (
		SELECT title, production_year, result 
		FROM movie_award
		UNION 
		SELECT title, production_year, result  
		FROM crew_award
		UNION
		SELECT title, production_year, result  
		FROM director_award
		UNION
		SELECT title, production_year, result  
		FROM writer_award
		UNION
		SELECT title, production_year, result  
		FROM actor_award) AS awards
	WHERE lower(awards.result) = 'won'
	AND movie.title = awards.title
	AND movie.production_year = awards.production_year);",2018-08-29 17:07:47.095665+10,11,1,222,correct
5412,"select count(*) from (select * from writer_award wa,person p where wa.id=p.id and p.first_name='Woody' and p.last_name='Allen' and wa.year_of_award>1990 and wa.year_of_award<1996 and wa.result='won')as A;
",2018-08-29 17:07:52.783247+10,9,1,117,correct
5413,"select count(*) from person p
where exists (select * from writer w where p.id = w.id and year_born = '1935') ;",2018-08-29 17:08:16.365531+10,1,1,400,correct
5414,"SELECT *
FROM writer w INNER JOIN person p on w.id = p.id
WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-29 17:09:13.72362+10,5,0,143,partially correct
5415,"SELECT w.title, w.production_year
FROM writer w INNER JOIN person p on w.id = p.id
WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-29 17:09:50.021668+10,5,1,143,correct
5416,"select count(*) as total
from movie m

where not EXISTS(select title,production_year from  movie_award where m.title=movie_award.title AND lower(movie_award.result)='won' AND m.production_year = movie_award.production_year 
UNION
select title,production_year from crew_award where m.title=crew_award.title AND lower(crew_award.result)='won' AND m.production_year = crew_award.production_year
UNION
select title,production_year from director_award where m.title=director_award.title AND lower(director_award.result)='won'AND m.production_year = director_award.production_year
UNION
select title,production_year from writer_award where m.title=writer_award.title AND lower(writer_award.result)='won' AND m.production_year = writer_award.production_year
UNION
select title,production_year from actor_award where m.title=actor_award.title AND lower(actor_award.result)='won' AND m.production_year = actor_award.production_year

 );
  
  ",2018-08-29 17:10:17.465678+10,11,1,309,correct
5417,"SELECT COUNT(*)
FROM MOVIE m

WHERE NOT EXISTS 
		(SELECT ma.title
		FROM MOVIE_AWARD ma
		WHERE m.title = ma.title
		AND m.production_year = ma.production_year
		AND lower(ma.result) = 'won')
		
	AND NOT EXISTS 
		(SELECT ca.title
		FROM CREW c,
		     CREW_AWARD ca
		WHERE m.title = c.title
		AND m.production_year = c.production_year
		AND ca.id = c.id
		AND ca.title = c.title
		AND ca.production_year = c.production_year
		AND lower(ca.result) = 'won')
		
	AND NOT EXISTS
		(SELECT da.title
		FROM DIRECTOR d,
		     DIRECTOR_AWARD da
		WHERE m.title = d.title
		AND m.production_year = d.production_year
		AND da.title = d.title
		AND da.production_year = d.production_year
		AND lower(da.result) = 'won')
		
	AND NOT EXISTS
		(SELECT wa.title
		FROM WRITER w,
		     WRITER_AWARD wa
		WHERE w.title = m.title
		AND w.production_year = m.production_year
		AND w.id = wa.id
		AND w.title = wa.title
		AND w.production_year = wa.production_year
		AND lower(wa.result) = 'won')
		
	AND NOT EXISTS
		(SELECT aa.title
		FROM ROLE r,
		     ACTOR_AWARD aa
		WHERE r.title = m.title
		AND r.production_year = m.production_year
		AND aa.title = r.title
		AND aa.production_year = r.production_year
		AND aa.description = r.description
		AND lower(aa.result) = 'won');",2018-08-29 17:10:23.59935+10,11,1,177,correct
5418,"select d.id,da.award_name,da.year_of_award, da.category
from director d,director_award da
where d.title=da.title and d.production_year=da.production_year and da.result !='won';",2018-08-29 17:10:45.825872+10,13,1,230,correct
5419,"SELECT id, first_name, last_name FROM PERSON AS p
WHERE EXISTS (SELECT * FROM DIRECTOR AS d, WRITER AS w where
d.id= w.id AND p.id=d.id AND COUNT(d.title)>1);",2018-08-29 17:15:11.998534+10,4,0,385,noninterpretable
5420,"SELECT da.id, da.award_name, da.year_of_award, da.category
FROM director_award da,
WHERE lower(result='won');",2018-08-29 17:15:48.854196+10,13,0,370,noninterpretable
5421,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-29 17:16:28.786952+10,6,1,143,correct
5422,"SELECT count(*)
FROM WRITER_AWARD
WHERE award_name='Woody Allen', year_of_award=(1991:1995);",2018-08-29 17:18:06.86179+10,9,0,249,noninterpretable
5423,select * from movie;,2018-08-29 17:18:56.417698+10,11,0,31,partially correct
5424,"select ma.title, ma.production_year,
	p.first_name, p.last_name
from (select title,
			production_year
		from movie_award
		where lower(award_name) = 'bafta film award'
		and lower(category) = 'best film'
		and lower(result) = 'won') as ma,
	director as d,
	person as p
where ma.title = d.title
	and ma.production_year = d.production_year
	and d.id = p.id;",2018-08-29 17:19:34.14372+10,8,1,136,correct
5425,"SELECT id, MAX(Year_born)
FROM person p
GROUP BY id
HAVING COUNT(*) = 1;


 
 
 
        ",2018-08-29 17:19:34.331623+10,3,0,259,partially correct
5426,"select count(*) from person p where exists
(select * from writer w 
where w.id = p.id 
and p.year_born = 1935);",2018-08-29 17:19:48.532721+10,1,1,76,correct
5427,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));


 
 
 
        ",2018-08-29 17:20:12.415773+10,3,1,259,correct
5428,"  select country
    from restriction
    where lower(title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-29 17:20:33.635329+10,6,1,387,correct
5429,"SELECT production_year,count (*)
FROM movie 
WHERE production_year <1994 AND production_year >1990 
GROUP BY production_year;",2018-08-29 17:20:57.156423+10,2,1,49,correct
5430,"SELECT COUNT(*)
FROM WRITER_AWARD, PERSON
WHERE WRITER_AWARD.id = PERSON.id
AND PERSON.first_name = ""Woody"" AND PERSON.last_name = ""Allen""
AND WRITER_AWARD.year_of_award BETWEEN 1991 AND 1995
GROUP BY PERSON.id;",2018-08-29 17:21:17.785546+10,9,0,392,partially correct
5431,"select count(*)
from movie as m, Movie_Award as ma, Crew_Award as ca, Director_Award as da, Writer_Award as wa,Actor_Award as aa
where not EXISTS (m.title=ma.title and m.production_year=ma.production_year) or (m.title=ca.title and m.production_year=ca.production_year)
 or(m.title=da.title and m.production_year=da.production_year) or (m.title=aa.title and m.production_year=aa.production_year)
group by m.title,m.production_year;",2018-08-29 17:21:21.168276+10,11,0,223,noninterpretable
5432,"SELECT person.first_name, person.last_name
FROM scene, movie,person,crew
WHERE scene.title = 'Psycho' AND scene.production_year = '1960' AND scene.title = movie.title 
AND scene.production_year = movie.production_year AND person.id = crew.id AND crew.title = movie.title 
AND movie.production_year = crew.production_year
GROUP BY scene.title
HAVING COUNT(*) =1;
",2018-08-29 17:22:15.510885+10,10,0,165,partially correct
5433,"SELECT *
FROM person
WHERE year_born IN (SELECT MAX(year_born) from person);",2018-08-29 17:22:19.571753+10,7,0,143,partially correct
5434,"select first_name, last_name
from person
order by year_born
limit 1
;",2018-08-29 17:22:27.586849+10,7,0,387,partially correct
5435,"	select a.id,max(a.num)
	from(
	select pp.id,count(title) as num
	from(
	select distinct *
	from person p
	join director d on p.id=d.id
	join writer w on p.id=w.id) as pp
	group by pp.id) as a;",2018-08-29 17:22:29.751534+10,14,0,230,partially correct
5436,"SELECT id, first_name, last_name FROM (PERSON AS p
 NATURAL JOIN DIRECTOR AS d NATURAL JOIN WRITER AS w )
AS dw
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-29 17:22:39.687485+10,4,1,385,correct
5437,"SELECT id, first_name, last_name
FROM person
WHERE year_born IN (SELECT MAX(year_born) from person);",2018-08-29 17:22:44.736797+10,7,1,143,correct
5438,"  
where (select count(*) from e2 where e2.id = p.id);",2018-08-29 17:22:56.360776+10,4,0,400,noninterpretable
5439,"SELECT *
FROM WRITER_AWARD, PERSON
WHERE WRITER_AWARD.id = PERSON.id
AND result = ""won""
AND PERSON.first_name = ""Woody"" AND PERSON.last_name = ""Allen""
AND WRITER_AWARD.year_of_award BETWEEN 1991 AND 1995;",2018-08-29 17:23:06.831026+10,9,0,392,partially correct
5440,"select person.id,first_name,last_name
from person,(select director.id as tid
from director,writer 
where director.id=writer.id and director.title=writer.title and director.production_year=writer.production_year) as tt
where person.id =tt.tid
group by person.id
having count(*)>1;",2018-08-29 17:23:07.060421+10,4,1,397,correct
5441,"SELECT id  FROM (select id,(2018-year_born)  as age from person  order by age asc) as t1 limit 1,1;
",2018-08-29 17:23:18.027563+10,3,1,16,correct
5442,"SELECT COUNT(*)
FROM WRITER_AWARD, PERSON
WHERE WRITER_AWARD.id = PERSON.id
AND result = ""won""
AND PERSON.first_name = ""Woody"" AND PERSON.last_name = ""Allen""
AND WRITER_AWARD.year_of_award BETWEEN 1991 AND 1995;",2018-08-29 17:23:20.890379+10,9,1,392,correct
5443,"	select a.id,max(a.num)
	from(
	select pp.id,count(distinct title) as num
	from(
	select distinct *
	from person p
	join director d on p.id=d.id
	join writer w on p.id=w.id) as pp
	group by pp.id) as a;",2018-08-29 17:23:23.167403+10,14,0,230,partially correct
5444,"SELECT COUNT(*)
FROM WRITER_AWARD, PERSON
WHERE WRITER_AWARD.id = PERSON.id
AND result = ""won""
AND PERSON.first_name = ""Woody"" AND PERSON.last_name = ""Allen""
AND WRITER_AWARD.year_of_award BETWEEN 1991 AND 1995
GROUP BY PERSON.id;",2018-08-29 17:23:43.477754+10,9,1,392,correct
5445,"select id,first_name, last_name, year_born
from person
order by year_born desc
limit 1
;",2018-08-29 17:23:47.811267+10,7,0,387,partially correct
5446,"select id,first_name, last_name
from person
order by year_born desc
limit 1
;",2018-08-29 17:24:00.776212+10,7,1,387,correct
5447,"select production_year, count(*) 
from movie 
where production_year > 1990 and production_year <1994 group by production_year;",2018-08-29 17:24:47.252688+10,2,1,76,correct
5448,"SELECT id
FROM person
WHERE year_born = (
		SELECT MAX(year_born) 
		FROM person
		WHERE year_born < (
			SELECT MAX(year_born) 
			FROM person))
;",2018-08-29 17:25:04.401428+10,3,1,222,correct
5449,"select dw.id, dw.first_name, dw.last_name from 
(person natural join director natural join writer) as dw
group by dw.id
having count(*) >1 ;",2018-08-29 17:26:34.525083+10,4,1,400,correct
5450,"select production_year,count(production_year) from movie m where m.production_year between 1991 and 1993 group by production_year;",2018-08-29 17:27:12.414746+10,2,1,200,correct
5451,"select count(*)
from person p
where not exists 
(select * 
from director d where d.id = p.id);
",2018-08-29 17:27:25.857709+10,12,1,76,correct
5452,"SELECT COUNT(*)
FROM person p, writer_award wa
WHERE p.id = wa.id
    AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen'
    AND wa.year_of_award >= 1991 AND wa.year_of_award <= 1995 AND wa.result = 'won'
;
",2018-08-29 17:27:39.549707+10,9,1,353,correct
5453,select * from movie;,2018-08-29 17:28:31.962357+10,3,0,31,partially correct
5454,"select id,YEAR_BORN from person
where year_born=(select MIN(year_born)from person WHERE YEAR_BORN > (select MIN(year_born)from person));

",2018-08-29 17:29:18.78184+10,3,0,309,partially correct
5455,"select production_year, count(*) as numbersofmovies
from movie where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-29 17:29:34.882905+10,2,1,400,correct
5456,"select id,YEAR_BORN from person
where year_born=(select MIN(year_born)from person WHERE YEAR_BORN > (select MIN(year_born)from person));

",2018-08-29 17:29:35.751676+10,3,0,309,partially correct
5457,"SELECT id
FROM APPEARANCE, ROLE
WHERE ROLE.title = ""Psycho"" AND APPEARANCE.title = ""Psycho"" AND ROLE.production_year = 1960 AND APPEARANCE.production_year = 1960
AND APPEARANCE.description = ROLE.description
GROUP BY id
HAVING COUNT(scene_no) = 1;",2018-08-29 17:29:38.43286+10,10,1,392,correct
5458,"select id from person
where year_born=(select MIN(year_born)from person WHERE YEAR_BORN > (select MIN(year_born)from person));

",2018-08-29 17:29:54.274165+10,3,0,309,partially correct
5459,"select dw.title,dw.production_year,dw.first_name,dw.last_name,dw.award_name,dw.category
from(movie_award natural join director natural join person)as dw
where(lower(dw.award_name)='bafta film award' and lower(dw.category)='best film');",2018-08-29 17:31:10.406533+10,8,0,181,partially correct
5460,"select dw.title,dw.production_year,dw.first_name,dw.last_name
from(movie_award natural join director natural join person)as dw
where(lower(dw.award_name)='bafta film award' and lower(dw.category)='best film');",2018-08-29 17:31:45.778621+10,8,0,181,partially correct
5461,"(select title,production_year from movie) 
EXCEPT
(
	(select title,production_year from movie_award where lower(result)='won')
	union
	(select title,production_year from crew_award where lower(result)='won')
	union
	(select title,production_year from director_award where lower(result)='won')
	union
	(select title,production_year from writer_award where lower(result)='won')
	union
	(select title,production_year from actor_award where lower(result)='won')
) order by production_year;",2018-08-29 17:32:28.495537+10,11,0,29,noninterpretable
5462,"SELECT title, production_year FROM MOVIE AS m
WHERE EXISTS (SELECT * FROM (WRITER AS w natural join PERSON AS p) as wp where wp.title= m.title AND wp.first_name='Kevin' AND wp.last_name='Williamson');",2018-08-29 17:33:06.311029+10,5,1,385,correct
5463,"select id, first_name, last_name
from
(select count(*),id from director d natural join writer w
group by id
having count(*)> 1) natural join person
;",2018-08-29 17:35:30.613012+10,4,1,391,correct
5464,"select id from person where first_name in (select description from appearance where title='Psycho' group by description having count(*)=1)
and last_name in (select description from appearance where title='Psycho' group by description having count(*)=1);",2018-08-29 17:35:45.009993+10,10,0,186,partially correct
5465,"select dw.title,dw.production_year,dw.first_name,dw.last_name,dw.award_name,dw.category
from(movie_award natural join director natural join person)as dw
where(lower(dw.award_name)='bafta film award' and lower(dw.category)='best film'and lower(dw.result)='won');",2018-08-29 17:36:07.335694+10,8,0,181,partially correct
5466,"select id  from person
where year_born=(select max(year_born)from person WHERE YEAR_BORN < (select MAX(year_born)from person));

",2018-08-29 17:36:07.594845+10,3,1,309,correct
5467,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS (SELECT movie.title
                  FROM movie_award, crew_award, director_award, writer_award, actor_award,movie
				  WHERE movie_award.result ='won' OR crew_award.result = 'won' OR director_award.result = 'won'
				        OR writer_award.result ='won' OR actor_award.result ='won' AND movie.title = movie_award.title
						);",2018-08-29 17:36:08.185214+10,11,0,165,partially correct
5468,"select m.title,m.production_year 
from movie as m,writer as w,person as p 
where m.title=w.title and m.production_year = w.production_year and w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson' ;

",2018-08-29 17:36:15.609233+10,5,1,200,correct
5469,"select dw.title,dw.production_year,dw.first_name,dw.last_name
from(movie_award natural join director natural join person)as dw
where(lower(dw.award_name)='bafta film award' and lower(dw.category)='best film'and lower(dw.result)='won');",2018-08-29 17:36:22.229657+10,8,1,181,correct
5470,"select count (wa.id) from writer_award as wa, person as p 
where lower(wa.result)='won'
and wa.id=p.id and lower(p.first_name)='woody'and lower(p.last_name)='allen'
and wa.year_of_award >= 1991
and wa.year_of_award <= 1995;",2018-08-29 17:36:31.822458+10,9,1,92,correct
5471,"select title, production_year from 
(movie natural join writer natural join person) 
where person.first_name = 'Kevin' and person.last_name = 'Williamson' 
group by title ;",2018-08-29 17:36:58.191423+10,5,1,400,correct
5472,"select title,production_year
from person natural join writer
where first_name =""Kevin"" and last_name=""Williamson"";
",2018-08-29 17:37:02.565857+10,5,1,397,correct
5473,"   select abc.title, abc.production_year
    from (movie_award natural join movie ) as abc
    where abc.award_name = 'BAFTA' and lower(category) = 'best film'
    ;
    
    ",2018-08-29 17:37:36.723902+10,8,0,387,partially correct
5474,"select title,production_year from movie
EXCEPT
(
	select title,production_year from movie_award where lower(result)='won'
	union
	select title,production_year from crew_award where lower(result)='won'
	union
	select title,production_year from director_award where lower(result)='won'
	union
	select title,production_year from writer_award where lower(result)='won'
	union
	select title,production_year from actor_award where lower(result)='won'
);",2018-08-29 17:37:39.327377+10,11,0,29,noninterpretable
5475,"select count (wa.id) 
from writer_award as wa, person as p 
where wa.id=p.id
and lower(wa.result)='won'
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award >= 1991
and wa.year_of_award <= 1995;",2018-08-29 17:38:03.822379+10,9,1,92,correct
5476,"select title, production_year
from 
movie natural join writer natural join person
where first_name='Kevin' and last_name='Williamson';",2018-08-29 17:38:22.135682+10,5,1,391,correct
5477,"SELECT COUNT(*) FROM PERSON, WRITER WHERE PERSON.id = WRITER.id AND year_born = 1935;",2018-08-29 17:38:50.245542+10,1,0,50,partially correct
5478,"SELECT id
FROM person
ORDER BY year_born DESC
LIMIT 1,1;",2018-08-29 17:39:30.146521+10,3,1,165,correct
5479,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 17:39:34.14162+10,1,1,50,correct
5480,"select count(*) from movie where title not in (select title from movie_award) and title not in (select title from crew_award)
and title not in (select title from director_award) and title not in (select title from writer_award) and title not in(select title from actor_award);",2018-08-29 17:41:35.884187+10,11,0,186,partially correct
5481,"select country
from restriction
where restriction.title=""Shakespeare in Love"" and  description='M';",2018-08-29 17:41:38.524506+10,6,1,397,correct
5482,SELECT * FROM crew;,2018-08-29 17:42:18.24134+10,1,0,299,partially correct
5483,"    select title, production_year, first_name,last_name
    from (movie_award natural join movie natural join director natural join person) as abc
    where lower(abc.award_name) = lower('BAFTA Film Award') and lower(category) = 'best film' and lower(abc.result) = 'won'
    ;
    
    ",2018-08-29 17:42:26.370973+10,8,1,387,correct
5484,"select country
from restriction
where lower(title)=""Shakespeare in Love"" and  description='M';",2018-08-29 17:42:28.725646+10,6,0,397,partially correct
5485,SELECT COUNTRY FROM (RESTRICTION NATURAL JOIN MOVIE ) AS RM WHERE RM.title='Shakespeare in Love' AND RM.description='M';,2018-08-29 17:42:34.896232+10,6,0,385,partially correct
5486,"select country
from restriction
where lower(title)=""shakespeare in love"" and  description='M';",2018-08-29 17:42:51.479709+10,6,1,397,correct
5487,"select count(*)
from writer_award w
where(w.id=(select person.id
		from person
		where(lower(person.first_name)='woody' and lower(person.last_name)='allen')) and w.year_of_award<1996 and w.year_of_award>1990 and lower(w.result)='won');",2018-08-29 17:43:13.816516+10,9,1,181,correct
5488,"select country from
(restriction natural join movie natural join restriction_category) as mr
where lower(mr.title)='shakespeare in love' and lower(mr.description)='m';",2018-08-29 17:43:16.0461+10,6,0,391,partially correct
5489,"select first_name, last_name, title, production_year, description
from (select person.id, first_name, last_name, movie.title, movie.production_year, description
      from person, movie, role
	 where role.id = person.id and role.title = movie.title and
	 role.production_year = movie.production_year) as pr
where id = (
	select id
	from (
		select id,count(*) as rm
		from role, movie
		where role.title = movie.title and role.production_year = movie.production_year
		group by id) as pr2
	where rm = (
		select max(rm2)
		from (
			select id,count(*) as rm2
			from role, movie
			where role.title = movie.title and role.production_year = movie.production_year
			group by id) as pr3
			));",2018-08-29 17:43:17.519511+10,15,1,347,correct
5490,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 17:43:38.342887+10,11,1,186,correct
5491,"SELECT 
COUNT(p.year_born) AS 'Number of Writers born in 1935'
FROM
person p INNER JOIN writer wr ON wr.id=p.id
WHERE 
p.year_born LIKE '1935';",2018-08-29 17:44:04.037835+10,1,0,403,partially correct
5492,"select count(*) from (
	select title,production_year from movie
	EXCEPT
	 select * from(
		select title,production_year from movie_award where lower(result)='won'
		union all
		select title,production_year from crew_award where lower(result)='won'
		union all
		select title,production_year from director_award where lower(result)='won'
		union all
		select title,production_year from writer_award where lower(result)='won'
		union all
		select title,production_year from actor_award where lower(result)='won'
	) d
) b;
   ",2018-08-29 17:44:09.657752+10,11,1,29,correct
5493,SELECT COUNTRY FROM RESTRICTION WHERE lower(title)='shakespeare in love' AND description='M';,2018-08-29 17:44:28.910149+10,6,1,385,correct
5494,"select country from
restriction 
where lower(title)='shakespeare in love' and lower(description)='m';",2018-08-29 17:44:35.8613+10,6,1,391,correct
5495,"select id, first_name,last_name 
form person 
where year_born= (select max(year_born) from person);",2018-08-29 17:46:29.333121+10,7,0,391,noninterpretable
5496,"select id, first_name,last_name 
from person 
where 
year_born= (select max(year_born) from person);",2018-08-29 17:47:47.062799+10,7,1,391,correct
5497,"SELECT id 
FROM role r
WHERE lower(r.title) = 'psycho' AND r.production_year = 1960 
AND (
	SELECT COUNT(*) 
	FROM scene s
	WHERE lower(s.title) = 'psycho' AND s.production_year = 1960
	)=1;
",2018-08-29 17:47:56.181951+10,10,0,343,partially correct
5498,"SELECT DISTINCT
COUNT(p.year_born)
FROM
person p INNER JOIN writer wr ON wr.id=p.id
WHERE 
p.year_born LIKE '1935';",2018-08-29 17:48:28.12663+10,1,0,403,partially correct
5499,"SELECT ; 
",2018-08-29 17:48:51.347577+10,14,0,311,noninterpretable
5500,"SELECT description FROM actor_award
HAVING COUNT(result = 'nominated')>3;
",2018-08-29 17:49:37.610816+10,1,0,299,noninterpretable
5501,"select id from person where year_born=(
select max(year_born) from person where year_born <> (select max(year_born) from person)
);
",2018-08-29 17:49:39.889246+10,3,1,29,correct
5502,"SELECT;
",2018-08-29 17:50:01.028843+10,15,0,311,noninterpretable
5503,"WITH B_MOVIE as(
SELECT title, production_year
FROM MOVIE_AWARD
WHERE award_name='BAFTA Film Award' AND category='best film')
SELECT d.title, d.production_year, p.first_name, p.last_name 
FROM person p inner join director d ON p.id=d.id
WHERE (d.title, d.production_year) IN (SELECT * FROM B_MOVIE);",2018-08-29 17:50:19.213418+10,8,0,143,partially correct
5504,"select 2p.id
from(select * from person p where not exit (select max(year_born) from person as p1)) as 2p;

",2018-08-29 17:51:15.188036+10,3,0,223,noninterpretable
5505,"select count(distinct(person.id))
from person, writer
where person.id = writer.id and person.year_born = 1935;",2018-08-29 17:51:19.508592+10,1,1,347,correct
7781,SELECT count(*) FROM person WHERE NOT EXISTS(SELECT * from director WHERE person.id = director.id);,2018-08-30 19:13:16.425805+10,12,1,213,correct
5506,"select count(sc.scene_no) as scount, rl.id  
from scene as sc, role as rl, appearance as ac
where lower(ac.title)='psycho'
and ac.production_year='1960'
and ac.scene_no = sc.scene_no
and sc.description = rl.description
group by sc.scene_no
having count(sc.scene_no)<2;
",2018-08-29 17:51:47.635866+10,10,0,92,partially correct
5507,"select w.title,w.production_year 
from writer as w,person as p 
where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson' ;

",2018-08-29 17:51:51.892995+10,5,1,200,correct
5508,"SELECT r.id
FROM role r
WHERE EXISTS(
    SELECT a.description, COUNT(a.scene_no)
    FROM appearance a
    WHERE lower(a.title) = 'psycho' AND a.production_year = 1960
        AND lower(a.description) = lower(r.description)
    GROUP BY a.description
    HAVING COUNT(a.scene_no) = 1
    ) AND lower(r.title) = 'psycho' AND r.production_year = 1960
;
",2018-08-29 17:53:00.027518+10,10,1,353,correct
5509,"   select count(*)
    from (writer_award natural join writer natural join person) as result
    where result.first_name = 'Woody' and result.last_name= 'Allen' and year_of_award >=1991
			and year_of_award<1996 and result = 'won'
			;",2018-08-29 17:53:05.493085+10,9,1,387,correct
5510,"select p.id
from person p
where p.year_born=(select max(year_born)
                   from person
				   where year_born<(select max(year_born)
				   from person));

",2018-08-29 17:54:31.617359+10,3,1,223,correct
5511,"select id from director d inner join (
select title,production_year from director_award where lower(result)='nominated' 
EXCEPT 
select title,production_year from director_award where lower(result)='won'
) a on d.title=a.title and d.production_year=a.production_year;",2018-08-29 17:54:35.633659+10,13,0,29,partially correct
5512,"select sc.scene_no, rl.id  
from scene as sc, role as rl, appearance as ac
where lower(sc.title)='psycho'
and sc.production_year='1960'
and sc.description = rl.description;
",2018-08-29 17:54:36.260057+10,10,0,92,partially correct
5513,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-29 17:54:57.063653+10,2,1,347,correct
5514,"select id,award_name,year_of_award,category from director d inner join (
select title,production_year from director_award where lower(result)='nominated' 
EXCEPT 
select title,production_year from director_award where lower(result)='won'
) a on d.title=a.title and d.production_year=a.production_year;",2018-08-29 17:55:17.35228+10,13,0,29,noninterpretable
5515,"SELECT id, first_name, last_name FROM PERSON as p WHERE exists(select  MAX(p.year_born) from p) ;",2018-08-29 17:56:58.935722+10,7,0,385,noninterpretable
5516,"select count(*)
from person
where id not in (
	select id
	from director);",2018-08-29 17:57:13.611795+10,12,1,347,correct
5517,"SELECT id, first_name, last_name FROM PERSON as p WHERE p.year_born=(select  MAX(year_born) from person) ;",2018-08-29 17:57:55.045562+10,7,1,385,correct
5518,select id from person where year_born >(select max(year_born) from person) order by year_born desc limit 1;,2018-08-29 17:58:23.600103+10,3,0,186,partially correct
5519,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-29 17:59:12.02483+10,3,1,186,correct
5520,"With cr AS(select r.id, r.title, r.production_year,r.description, count(*) as largestrole
      from role r
      group by r.id)

Select p.first_name, p.last_name, cr.title, cr.production_year, cr.description
From cr inner join person p on(cr.id=p.id)
Where largestrole=(select MAX(largestrole)
                   from cr );",2018-08-29 17:59:36.169564+10,15,0,83,partially correct
5521,"SELECT person.first_name, person.last_name, role.title, role.production_year, role.description
FROM person, role 
WHERE person.id = role.id
GROUP BY person.id
HAVING role;
",2018-08-29 17:59:37.594193+10,15,0,165,noninterpretable
5522,"select id,award_name,year_of_award,category from director_award a inner join director d on d.title=a.title and d.production_year=a.production_year where lower(result)='nominated' and not exists(
	select * from director_award a2 where a2.title=a.title and a2.production_year=a.production_year and lower(result)='won'
);",2018-08-29 18:00:33.987126+10,13,1,29,correct
5523,"SELECT;
",2018-08-29 18:00:39.405908+10,8,0,311,noninterpretable
5524,"WITH B_MOVIE as(
SELECT title, production_year
FROM MOVIE_AWARD
WHERE award_name='BAFTA Film Award' AND category='best film' AND result='won')
SELECT d.title, d.production_year, p.first_name, p.last_name 
FROM person p inner join director d ON p.id=d.id
WHERE (d.title, d.production_year) IN (SELECT * FROM B_MOVIE);",2018-08-29 18:00:58.805495+10,8,1,143,correct
5525,select country from restriction where title = 'Shakespeare in Love' and description = 'M' group by country;,2018-08-29 18:01:32.963769+10,6,1,200,correct
5526,"select count(*),production_year from movie where production_year>='1991' and production_year<='1993' group by production_year;",2018-08-29 18:01:40.341185+10,2,1,266,correct
5527,"select count(*),production_year from movie where production_year>='1991' and production_year<='1993' group by production_year;",2018-08-29 18:03:09.44099+10,2,1,266,correct
5528,"select id, first_name, last_name
from person
where id in (
	select id
	from (writer natural join director) as wd
	group by id having count(*)>1);",2018-08-29 18:03:21.004435+10,4,1,347,correct
5529,"select production_year,count(*) from movie where production_year>='1991' and production_year<='1993' group by production_year;",2018-08-29 18:04:13.817002+10,2,1,266,correct
5530,"SELECT title, production_year, first_name, last_name FROM (MOVIE NATURAL JOIN DIRECTOR NATURAL JOIN PERSON) AS p WHERE EXISTS 
(SELECT * FROM MOVIE_AWARD AS ma WHERE p.title = ma.title AND ma.category=  'Best Film');",2018-08-29 18:04:44.35724+10,8,0,385,partially correct
5531,"SELECT r.id 
FROM ROLE r,appearance a,scene s
WHERE 
	s.title = a.title
	AND s.title = r.title
	AND s.scene_no = a.scene_no
	AND s.production_year = a.production_year
	AND s.production_year = r.production_year
	AND a.description = r.description
	AND lower(a.title) = 'psycho'
	AND a.production_year = 1960
GROUP BY r.id
Having Count(*)=1;
",2018-08-29 18:04:55.423478+10,10,1,343,correct
5532,"select title, production_year
from writer
where id = (
	select id
	from person
	where lower(first_name) = lower('Kevin')
	and lower(last_name) = lower('Williamson')
	);",2018-08-29 18:07:48.126281+10,5,1,347,correct
5533,"
SELECT id,award_name,year_of_award,category
FROM director d,director_award da

where (select count(*) from director_award where da.result!='won' AND da.title=d.title AND da.production_year=d.production_year)
group by id

HAVING count(*)>1;



",2018-08-29 18:08:08.978253+10,13,0,309,partially correct
5534,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 18:09:16.079027+10,10,1,239,correct
5535,select count(*) from person p inner join director d on p.id=d.id where p.id!=d.id; ,2018-08-29 18:09:24.733836+10,12,0,266,partially correct
5536,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 18:09:41.672873+10,10,1,239,correct
5537,"
SELECT id,award_name,year_of_award,category
FROM director d,director_award da
where EXISTS (select count(*) from director_award where da.result!='won' AND da.title=d.title AND da.production_year=d.production_year)
group by id
HAVING count(*)>1;



",2018-08-29 18:09:45.317496+10,13,0,309,partially correct
5538,"SELECT count(*)
FROM (person NATURAL JOIN writer) AS pw
WHERE pw.year_born = 1935;
",2018-08-29 18:09:53.002149+10,1,0,378,partially correct
5539,select count(*) from person p where not exists( select * from director d where p.id=d.id);,2018-08-29 18:10:51.802071+10,12,1,266,correct
8032,"SELECT id, first_name, last_name
FROM person
GROUP BY id
HAVING max(year_born);",2018-08-30 20:30:13.929844+10,7,0,373,partially correct
5540,"select country
from restriction
where lower(title) = lower('Shakespeare in Love') and lower(description) = 'm';",2018-08-29 18:11:12.413704+10,6,1,347,correct
5541,"select id,first_name,last_name from person where year_born<=(select min(year_born) from person);",2018-08-29 18:11:21.799206+10,7,0,200,partially correct
5542,"select d.id,da.award_name,da.year_of_award,da.category
from director_award as da,director as d
where d.title=da.title and d.production_year=da.production_year 
    and result='nominated';",2018-08-29 18:11:22.295574+10,13,1,223,correct
5543,"select distinct d.id,da.award_name,da.year_of_award,da.category from director d, director_award da where d.id in
(select id from director_award db where db.title=d.title and db.result ='nominated' and not exists
(select id from director_award dc where dc.title=db.title and db.result='won')); ",2018-08-29 18:11:34.555278+10,13,0,186,partially correct
5544,"select id, first_name, last_name
from person
where year_born = (
	select max(year_born)
	from person);",2018-08-29 18:13:18.675034+10,7,1,347,correct
5545,select * from restriction;,2018-08-29 18:15:32.049418+10,14,0,394,partially correct
5546,"select count(*)
from movie
where ;
",2018-08-29 18:15:32.773015+10,11,0,239,noninterpretable
5547,"

SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM 
(SELECT title,production_year FROM movie_award where lower(result)='won' AND lower(category)='best film' and lower(award_name)='bafta film award') AS ma,
director as d, person as p
where d.id=p.id and ma.title=d.title and ma.production_year=d.production_year;
",2018-08-29 18:16:49.359046+10,8,1,385,correct
5548,"select p.first_name,
	 p.last_name,
	 r.title,
	 r.production_year,
	 r.description
from person p,
	role r
where r.id=p.id
	and r.id in (select r2.id
			 from
				select 
					id,
					count(*)as number
				from 
					role r
				group by 
					r.id)as r2
			where r2.number in (
						select 
							max(r3.number)
						from (
							select 
								r.id,
								r.count(*)as number
							from 
					
					r.id)as r3));
",2018-08-29 18:16:53.38676+10,15,0,149,noninterpretable
5549,"select rl.id    
from appearance as ap, role as rl, scene as sc
where lower(ap.title)='psycho'
and ap.production_year=1960
and rl.description = ap.description
and sc.scene_no = ap.scene_no
and sc.title = rl.title
and sc.title = ap.title
and sc.production_year = rl.production_year
and sc.production_year = ap.production_year
group by rl.id
having count(*)=1;


",2018-08-29 18:17:09.977153+10,10,1,92,correct
5550,"select distinct p.id,p.first_name,p.last_name from person p inner join director d on p.id=d.id inner join writer w on d.id=w.id where w.id=d.id and d.title>=2;",2018-08-29 18:18:05.013716+10,4,0,266,partially correct
5551,"select p.id, p.first_name, p.last_name
from person p natural join writer w natural join director d
group by p.id
having count(*)>1;",2018-08-29 18:19:51.321592+10,4,1,76,correct
5552,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-29 18:20:41.543867+10,1,1,378,correct
5553,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT *
	FROM movie m,movie_award ma,crew_award ca, director_award da,writer_award wa,actor_award aa
	WHERE m.title = ma.title
		AND m.production_year = ma.production_year
	);",2018-08-29 18:20:51.161748+10,11,0,343,partially correct
5554,"select id,award_name,year_of_award,category from director_award as a  join Director as d on a.title=d.title and a.production_year=d.production_year where lower(a.result) is not  'won' ;",2018-08-29 18:20:59.387297+10,13,1,16,correct
5555,"select d.title, d.production_year, first_name, last_name
from (person natural join director) as d, 
(select title, production_year
from movie_award
where lower(award_name) = lower('BAFTA Film Award')
	 and lower(category) = lower('Best Film')
	 and lower(result) = 'won') as w
where d.title = w.title and d.production_year = w.production_year;",2018-08-29 18:22:17.071728+10,8,1,347,correct
5556,"select production_year, count(*)
from movie
where (production_year>1990 AND production_year<1994)
GROUP BY production_year;
",2018-08-29 18:24:27.079944+10,2,1,378,correct
5557,"select p.first_name,
	 p.last_name,
	 r.title,
	 r.production_year,
	 r.description
from person p,
	role r,
	 (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
where b.id=p.id
	and p.id=r.id
	and b.number_of_roles in(
					select max(a.number_of_roles)
					from(
						SELECT
            					id,
            					count(*) AS number_of_roles
        					FROM
            					ROLE
        					GROUP BY
           				 	id ) AS a
						);",2018-08-29 18:24:40.808585+10,15,1,149,correct
5558,"select count(*) from (
	select writer.id as iii from person, writer where person.id = writer.id and person.year_born = 1935
)as a group by iii;",2018-08-29 18:25:57.652558+10,1,0,405,partially correct
5559,"select p.id, p.first_name, p.last_name 
from person p 
where p.year_born=(select max(year_born)
				from person);",2018-08-29 18:27:05.244032+10,7,1,46,correct
5560,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
 	FROM movie_award ma
  	WHERE lower(ma.result) = 'won' and m.title = ma.title AND m.production_year = ma.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
	);",2018-08-29 18:27:53.557419+10,11,1,343,correct
5561,"select *
from
	select  id
	from writer
	);",2018-08-29 18:32:41.025826+10,1,0,149,noninterpretable
5562,"select count(*) from person,(
	select id from writer group by id
)as a where person.id = a.id and person.year_born = 1935;",2018-08-29 18:33:01.691542+10,1,1,405,correct
5563,;,2018-08-29 18:33:14.625519+10,14,0,186,noninterpretable
5564,"select count(*)
from(
	select 
		distinct id
	from writer) as w;",2018-08-29 18:34:22.149585+10,1,0,149,partially correct
5565,"select count(*) 
from person as p
where exists ( select * from writer as w where w.id = p.id and p.year_born = 1935);",2018-08-29 18:34:58.250757+10,1,1,405,correct
5566,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );


",2018-08-29 18:36:14.885192+10,13,1,309,correct
5567,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-29 18:37:02.586115+10,4,1,266,correct
5568,SELECT count(*) from writer_award as wa where lower(wa.award_name)='woody allen' and wa.year_of_award>=1991 and wa.year_of_award <=1995;,2018-08-29 18:37:39.273244+10,9,0,385,partially correct
5569,"select bf.title,bf.production_year,p.first_name,p.last_name
from person p, (select ma.title,ma.production_year,d.id
from movie_award ma natural join director d 
where ma.award_name= 'BAFTA Film Award'
and ma.category='best film'
and ma.result= 'won')AS bf
where p.id=bf.id;",2018-08-29 18:38:10.196946+10,8,1,354,correct
5570,"select w.title,w.production_year from writer w inner join person p on p.id=w.id where p.first_name='Kevin' and p.last_name='Williamson';",2018-08-29 18:39:48.538067+10,5,1,266,correct
5571,"select count(*) 
from MOVIE
where ( movie.production_year=""1991""
      or movie.production_year=""1992""
      or movie.production_year=""1993"");",2018-08-29 18:41:12.829562+10,2,0,139,partially correct
5648,"select p1.id,p1.first_name,p1.last_name
from person p1, person p2
where p1.year_born=max(p2.year_born)
and p1.id=p2.id;",2018-08-29 19:50:22.504913+10,7,0,397,noninterpretable
5572,"select production_year, c from (select production_year,count(*) as c from movie group by production_year Having production_year > 1990 and production_year < 1994) as a order by production_year DEsC;
",2018-08-29 18:42:55.729356+10,2,1,405,correct
5573,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-29 18:43:42.318076+10,6,1,266,correct
5574,"select production_year, count(*) 
from MOVIE
where ( movie.production_year='1991'
      or movie.production_year='1992'
      or movie.production_year='1993')
group by movie.production_year;",2018-08-29 18:44:01.705778+10,2,1,139,correct
5575,"select title, production_year, first_name, last_name 
from person,( select movie_award.*, id from movie_award, director
where movie_award.production_year=director.production_year and
movie_award.title=director.title and award_name='BAFTA Film Award'and category='best film') m
where m.id=person.id
;

",2018-08-29 18:44:24.352198+10,8,0,197,partially correct
5576,;,2018-08-29 18:45:22.932604+10,15,0,186,noninterpretable
5577,"select p.id, p.first_name, p.last_name
from person p
where exists(select * from (director d natural join writer w) as dw where (dw.id = p.id ) group by dw.id having count(*)>1);",2018-08-29 18:47:43.722966+10,4,1,378,correct
5578,"SELECT count(*) as number_of_award from writer_award as wa, person as p, writer as w where 
wa.title= w.title and wa.production_year=w.production_year and w.id = p.id
and wa.year_of_award>=1991 and wa.year_of_award <=1995
and lower(p.first_name)='woody' and lower(p.last_name)='allen' and lower(wa.result)='won';",2018-08-29 18:48:47.864931+10,9,1,385,correct
5579,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-29 18:49:00.089361+10,7,1,266,correct
5580,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE d.title = da.title
	AND lower(da.result)='nominated'
	AND d.production_year = da.production_year
	AND d.id NOT IN(SELECT id
				FROM  director_award da,director d
				WHERE d.title= da.title
					AND lower(da.result)='won'
					AND d.production_year = da.production_year);",2018-08-29 18:49:02.929034+10,13,1,370,correct
5581,"select md.title, md.production_year, p.first_name,p.last_name 
from person p,(select ma.title as title,ma.production_year as production_year,d.id as id
			from movie_award ma, director d
			where ma.title=d.title
				and ma.production_year=d.production_year
				and ma.award_name='BAFTA Film Award'
				and lower(ma.category)='best film'
				and lower(ma.result)='won') as md
where md.id=p.id;",2018-08-29 18:49:20.804733+10,8,1,46,correct
5582,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS (SELECT title, production_year
                FROM movie_award
                WHERE movie_award.result = 'won' AND movie_award.title = movie.title AND movie_award.production_year = movie.production_year
                 UNION
		     SELECT title, production_year
                FROM crew_award
			 WHERE crew_award.result = 'won' AND crew_award.title = movie.title AND crew_award.production_year = movie.production_year
			UNION
			SELECT title, production_year
                FROM director_award
			WHERE director_award.result = 'won' AND director_award.title = movie.title AND director_award.production_year = movie.production_year
			UNION
			SELECT title, production_year
                FROM writer_award
			WHERE writer_award.result = 'won' AND writer_award.title = movie.title AND writer_award.production_year = movie.production_year
			UNION
			SELECT title, production_year
                FROM actor_award
			WHERE actor_award.result = 'won' AND actor_award.title = movie.title AND actor_award.production_year = movie.production_year);",2018-08-29 18:50:55.31223+10,11,0,165,partially correct
5583,"select m.title, m.production_year
from movie m, writer w, person p
where (w.title = m.title and w.production_year = m.production_year and p.id = w.id and p.first_name = ""Kevin"" and p.last_name = ""Williamson"");",2018-08-29 18:51:36.417719+10,5,1,378,correct
5584,"select w.title, w.production_year
from  writer w, person p
where (p.id = w.id and p.first_name = ""Kevin"" and p.last_name = ""Williamson"");",2018-08-29 18:52:37.637606+10,5,1,378,correct
5585,"select country
from restriction
where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-29 18:54:41.581284+10,6,1,378,correct
5586,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);",2018-08-29 18:58:05.696657+10,7,1,378,correct
5587,"select title,production_year,first_name,last_name
from movie natural join movie_award natural join director natural join person
where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';
",2018-08-29 18:58:47.213002+10,8,1,391,correct
5588,"select r.id from role as r, scene as s
where r.title= s.title and r.production_year = s.production_year and s.scene_no=1 and lower(r.title)='psycho' and r.production_year=1960;",2018-08-29 18:59:11.785611+10,10,0,385,partially correct
5589,"select r.id from role as r, scene as s
where r.title= s.title and r.production_year = s.production_year and s.scene_no=1 and lower(r.title)='psycho' and r.production_year=1960;",2018-08-29 18:59:18.80232+10,10,0,385,partially correct
5590,"select p.first_name, p.last_name
from (
select title, production_year
from movie_award
where 
award_name = lower(""BAFTA Film Award"") 
and category = lower(""Best Film"") 
and result = ""won"") as ma
, person p, director d
where 
p.id = d.id and ma.title = ma.title;",2018-08-29 18:59:31.527733+10,8,0,102,partially correct
5591,select count(*) from movie_award where;,2018-08-29 19:00:57.440972+10,11,0,137,noninterpretable
5592,"
SELECT t1.first_name,t1.last_name,t1.title,t1.production_year,t1.description
FROM (SELECT p.first_name,p.last_name,r.title,r.production_year,r.description,p.id, count(p.id) AS noOfRole
FROM Person p, Role r
WHERE p.id = r.id
Group by p.first_name) AS t1
WHERE t1.noOfRole = (SELECT MAX(t2.noOfRole) 
FROM (SELECT p.first_name,p.last_name,r.title,r.production_year,r.description,p.id, count(p.id) AS noOfRole
FROM Person p, Role r
WHERE p.id = r.id
Group by p.first_name)AS t2);",2018-08-29 19:01:42.204112+10,15,0,218,partially correct
5593,;,2018-08-29 19:02:27.663323+10,14,0,309,noninterpretable
5594,"select title, production_year
from movie_award
where lower(award_name) = ""bafta film award"" and lower(category) = ""best film"" and lower(result) = ""won"";
",2018-08-29 19:02:53.307967+10,8,0,378,partially correct
5595,"select count(*) 
from person as p
where not exists (select * from director as d where d.id = p.id);
",2018-08-29 19:04:33.234557+10,12,1,405,correct
5596,;,2018-08-29 19:04:37.96802+10,8,0,266,noninterpretable
5597,"select r.id from role as r, scene as s, appearance as a
where a.title= s.title and a.production_year = s.production_year and a.scene_no= s.scene_no 
and  a.title= r.title and a.production_year = r.production_year and a.description = r.description
and lower(r.title)='psycho' and r.production_year=1960
group by r.id
having count(*)=1;",2018-08-29 19:06:07.925154+10,10,1,385,correct
5598,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 19:06:26.243558+10,8,1,266,correct
5599,"SELECT count(*)
FROM writer_award w inner join person p on w.id=p.id
WHERE p.first_name = 'Woody' AND p.last_name = 'Allen' AND w.production_year>1990 AND w.production_year<1996;",2018-08-29 19:06:47.278596+10,9,1,143,correct
5600,"select p.first_name, p.last_name
from (
select title, production_year
from movie_award
where 
lower(award_name) = ""BAFTA Film Award"" 
and lower(category) = ""Best Film""
and result = ""won"") as ma
, person p, director d
where 
p.id = d.id and d.title = ma.title and ma.production_year = d.production_year;",2018-08-29 19:07:04.350006+10,8,0,102,partially correct
5649,"select id
from
   role
   natural join
   Appearance
group by id, title, production_year
having
   title = 'Psycho'
   and
   production_year = '1960'
   and
   count(id) = 1;",2018-08-29 19:50:51.140261+10,10,1,271,correct
5601,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 19:07:41.604419+10,14,1,309,correct
5602,"select distinct id as num from (
		select distinct id,title,production_year from director
		union
	select distinct id,title,production_year from writer
) d1 group by id having count(*)=

(	select max(num) from (
		select id,count(*) as num from (
			select distinct id,title,production_year from director
			union
			select distinct id,title,production_year from writer
		) d2 group by id
	) as a
);",2018-08-29 19:08:19.839097+10,14,1,29,correct
5603,"select pd.title, pd.production_year, pd.first_name, pd.last_name 
from (movie_award m natural join director natural join person p)as pd
where lower(pd.award_name) = ""bafta film award"" and lower(pd.category) = ""best film"" and lower(pd.result) = ""won"" and pd.title = m.title;
",2018-08-29 19:09:22.565485+10,8,1,378,correct
5604,"select p.first_name, p.last_name
from (
select title, production_year
from movie_award
where 
lower(award_name) = 'BAFTA Film Award' 
and lower(category) = 'Best Film') as ma
, person p, director d
where 
p.id = d.id and d.title = ma.title and ma.production_year = d.production_year;",2018-08-29 19:09:38.180894+10,8,0,102,partially correct
5605,select count(*) as numberofawards from writer_award;,2018-08-29 19:10:29.28057+10,9,0,266,partially correct
5606,"select p.id
from person as p,director as d,writer as w
where p.id=d.id or p.id=w.id or (p.id=d.id and p.id=w.id)
group by id
count(*)>any count(*);",2018-08-29 19:13:12.406707+10,14,0,223,noninterpretable
5607,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-29 19:13:17.586329+10,9,1,266,correct
5608,"select r.id,res.description
from
role r,
restriction res
where r.title=res.title
AND
r.production_year=res.production_year
AND (RES.description='G'
OR RES.description='PG-13'
OR RES.description='R'
OR RES.description='PG')
group by id,description;",2018-08-29 19:14:35.226888+10,14,0,394,noninterpretable
5609,;,2018-08-29 19:14:35.926702+10,14,0,370,noninterpretable
5610,"select 
  ma.title, 
  ma.production_year, 
  p.first_name, 
  p.last_name
from (
       select title, 
	        production_year
       from 
	      movie_award
       where 
           lower(award_name) = 'BAFTA Film Award' 
           and lower(category) = 'Best Film' 
	     and lower(RESULT) = 'won') as ma, 
		 person p, 
		 director d
       where 
           p.id = d.id 
	     and d.title = ma.title 
	     and ma.production_year = d.production_year;",2018-08-29 19:16:39.499284+10,8,0,102,partially correct
5611,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-29 19:17:28.536222+10,8,1,102,correct
5612,"select *
from writer_award w, (writer natural join person) as pw
where w.id = pw.id and w.production_year = pw.production_year and w.title = pw.title and pw.first_name = ""Woody"" 
and pw.last_name = ""Allen"" and w.year_of_award > 1990 and w.year_of_award < 1996 and w.result = ""won"";",2018-08-29 19:18:09.784171+10,9,0,378,partially correct
5613,"select count(*)
from writer_award w, (writer natural join person) as pw
where w.id = pw.id and w.production_year = pw.production_year and w.title = pw.title and pw.first_name = ""Woody"" 
and pw.last_name = ""Allen"" and w.year_of_award > 1990 and w.year_of_award < 1996 and w.result = ""won"";",2018-08-29 19:18:22.770826+10,9,1,378,correct
5614,"select ids.id, first_name, last_name from person,(select id from (select id 
from director as d
where exists (select * from writer as w where d.id = w.id and d.title = w .title and d.production_year = w.production_year))as a 
group by id having count(*) > 1) as ids where ids.id = person.id
;",2018-08-29 19:19:36.714552+10,4,1,405,correct
5615,select p.id from person p;,2018-08-29 19:20:21.634329+10,10,0,266,partially correct
5616,"select count(*)
from writer_award
where writer_award.id=(select id from person
where first_name='Woody' and last_name='Allen')
group by writer_award.id having year_of_award> 1990 and year_of_award<1996;
",2018-08-29 19:21:54.00801+10,9,0,197,partially correct
5617,;,2018-08-29 19:22:36.395122+10,15,0,309,noninterpretable
5618,"SELECT COUNT(*) AS number
FROM movie m
WHERE m.title NOT IN (SELECT title from movie NATURAL JOIN movie_award)
AND m.production_year NOT IN (SELECT production_year from movie NATURAL JOIN movie_award)

AND m.title NOT IN (SELECT title from crew NATURAL JOIN crew_award)
AND m.production_year NOT IN (SELECT production_year from crew NATURAL JOIN crew_award)

AND m.title NOT IN (SELECT title from director NATURAL JOIN director_award)
AND m.production_year NOT IN (SELECT production_year from director NATURAL JOIN director_award)

AND m.title NOT IN (SELECT title from writer NATURAL JOIN writer_award)
AND m.production_year NOT IN (SELECT production_year from writer NATURAL JOIN writer_award)

AND m.title NOT IN (SELECT title from role NATURAL JOIN actor_award)
AND m.production_year NOT IN (SELECT production_year from role NATURAL JOIN actor_award);
",2018-08-29 19:22:38.900005+10,11,0,128,partially correct
5619,"select count(*)
from writer_award
where writer_award.id=(select id from person
where first_name='Woody' and last_name='Allen')
group by writer_award.id having year_of_award> 1990 and year_of_award<1996;
",2018-08-29 19:24:57.69911+10,9,0,197,partially correct
5620,"select count(DISTINCT PERSON.id) 
from PERSON, DIRECTOR
where PERSON.id != DIRECTOR.id;",2018-08-29 19:25:04.226182+10,12,0,139,partially correct
5621,"select p.first_name,p.last_name,r.title,r.production_year,r.description from person as p inner join role as r on p.id=r.id where p.id in
(
	select id from role r group by id having count(*)=
	(
		select max(num) from (
			select count(*) as num from role group by id
		) as b
	)
);",2018-08-29 19:25:25.474818+10,15,1,29,correct
5622,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title 
		FROM director d 
		UNION 
		SELECT w.id, title
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title
			FROM director d 
			UNION 
			SELECT w.id, title
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 19:25:27.396349+10,14,1,370,correct
5623,;,2018-08-29 19:25:40.00556+10,14,0,370,noninterpretable
5624,"select first_name,last_name from person inner join (select d.* from director d inner join (select title,production_year from movie_award where lower(award_name)=lower('BAFTA Film Award') and lower(category)=lower('Best Film') and lower(result)='won')as a on a.title=d.title and a.production_year=d.production_year)as b on person.id=b.id;",2018-08-29 19:28:15.892365+10,8,0,190,partially correct
5625,"select count(*)
from PERSON
WHERE NOT EXISTS( select * from DIRECTOR
                 WHERE DIRECTOR.id= person.id);",2018-08-29 19:30:03.485612+10,12,1,139,correct
5626,;,2018-08-29 19:33:59.890034+10,11,0,385,noninterpretable
5627,"select title,production_year,first_name,last_name from person inner join (select d.* from director d inner join (select title,production_year from movie_award where lower(award_name)=lower('BAFTA Film Award') and lower(category)=lower('Best Film') and lower(result)='won')as a on a.title=d.title and a.production_year=d.production_year)as b on person.id=b.id;",2018-08-29 19:34:07.185231+10,8,1,190,correct
5628,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 19:34:45.73759+10,11,1,385,correct
5629,"SELECT p.first_name,p.last_name,r.production_year,r.description,r.title,p.id
FROM Person p,
Role r,
(SELECT id,count(*) AS noOfRole 
FROM ROLE 
Group by id) AS idNo
WHERE 
p.id = r.id
AND idNo.id = p.id
AND idNo.noOfRole IN (SELECT MAX(idNo1.noOfRole)
FROM (SELECT r0.id,count(*) AS noOfRole 
FROM ROLE r0
Group by r0.id)AS idNo1);",2018-08-29 19:35:25.171163+10,15,0,218,partially correct
5630,"select qq.id
from (role natural join appearance) as qq
where lower(qq.title) = ""psycho"" and qq.production_year = 1960
group by qq.id
having count(*)=1
;",2018-08-29 19:35:49.527607+10,10,1,378,correct
5631,"SELECT COUNT(*) AS number
FROM movie m
WHERE 
(m.title NOT IN (SELECT title FROM movie NATURAL JOIN movie_award)
OR m.production_year NOT IN (SELECT production_year FROM movie NATURAL JOIN movie_award))

AND 
(m.title NOT IN (SELECT title from crew NATURAL JOIN crew_award)
OR m.production_year NOT IN (SELECT production_year from crew NATURAL JOIN crew_award))

AND
(m.title NOT IN (SELECT title from director NATURAL JOIN director_award)
OR m.production_year NOT IN (SELECT production_year from director NATURAL JOIN director_award))

AND
(m.title NOT IN (SELECT title from writer NATURAL JOIN writer_award)
OR m.production_year NOT IN (SELECT production_year from writer NATURAL JOIN writer_award))

AND
(m.title NOT IN (SELECT title from role NATURAL JOIN actor_award)
OR m.production_year NOT IN (SELECT production_year from role NATURAL JOIN actor_award));
",2018-08-29 19:36:16.79661+10,11,0,128,partially correct
5632,"SELECT p.first_name,p.last_name,r.production_year,r.description,r.title,p.id
FROM Person p,
Role r,
(SELECT id,count(*) AS noOfRole 
FROM ROLE 
Group by id) AS idNo
WHERE 
p.id = r.id
AND idNo.id = p.id
AND idNo.noOfRole IN (SELECT MAX(idNo1.noOfRole)
FROM (SELECT r0.id,count(*) AS noOfRole 
FROM ROLE r0
Group by r0.id)AS idNo1);",2018-08-29 19:36:54.789134+10,15,0,218,partially correct
5633,"SELECT p.first_name,p.last_name,r.production_year,r.description,r.title
FROM Person p,
Role r,
(SELECT id,count(*) AS noOfRole 
FROM ROLE 
Group by id) AS idNo
WHERE 
p.id = r.id
AND idNo.id = p.id
AND idNo.noOfRole IN (SELECT MAX(idNo1.noOfRole)
FROM (SELECT r0.id,count(*) AS noOfRole 
FROM ROLE r0
Group by r0.id)AS idNo1);",2018-08-29 19:37:21.541166+10,15,1,218,correct
5634,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM Person p,
Role r,
(SELECT id,count(*) AS noOfRole 
FROM ROLE 
Group by id) AS idNo
WHERE 
p.id = r.id
AND idNo.id = p.id
AND idNo.noOfRole IN (SELECT MAX(idNo1.noOfRole)
FROM (SELECT r0.id,count(*) AS noOfRole 
FROM ROLE r0
Group by r0.id)AS idNo1);",2018-08-29 19:37:54.07125+10,15,1,218,correct
5635,"select ids.id, first_name, last_name from person,(select id from (select id 
from director as d
where exists (select * from writer as w where d.id = w.id and d.title = w .title and d.production_year = w.production_year))as a 
group by id having count(*) > 1) as ids where ids.id = person.id
;",2018-08-29 19:39:07.213155+10,4,1,405,correct
5636,"select count(*)
from 
  writer_award as wa,
  writer as w,
  person as p
where 
  wa.id = w.id
  and p.id = w.id
  and lower(p.last_name) = 'woody'
  and lower(p.first_name) = 'allen'
  and wa.year_of_award >= 1991
  and wa.year_of_award <= 1995;",2018-08-29 19:39:09.892082+10,9,0,102,partially correct
5637,"SELECT COUNT(id)
FROM Person
WHERE year_born = 1935;",2018-08-29 19:39:50.37559+10,1,0,406,partially correct
5638,select count(*) from writer_award where id in (select id from person where first_name='Woody' and last_name='Allen') and year_of_award>1990 and year_of_award<1995 and lower(result)='won';,2018-08-29 19:40:46.29633+10,9,1,190,correct
5639,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id AND p.year_born =1935);",2018-08-29 19:42:40.473021+10,1,1,406,correct
5640,"SELECT COUNT(*) AS number
FROM movie m
WHERE 
(m.title NOT IN (SELECT title FROM movie NATURAL JOIN ( SELECT * FROM movie_award WHERE lower(result)=""won""))
OR m.production_year NOT IN (SELECT production_year FROM movie NATURAL JOIN ( SELECT * FROM movie_award WHERE lower(result)=""won"")))

AND 
(m.title NOT IN (SELECT title from crew NATURAL JOIN ( SELECT * FROM crew_award WHERE lower(result)=""won""))
OR m.production_year NOT IN (SELECT production_year from crew NATURAL JOIN ( SELECT * FROM crew_award WHERE lower(result)=""won"")))

AND
(m.title NOT IN (SELECT title from director NATURAL JOIN ( SELECT * FROM director_award WHERE lower(result)=""won""))
OR m.production_year NOT IN (SELECT production_year from director NATURAL JOIN ( SELECT * FROM director_award WHERE lower(result)=""won"")))

AND
(m.title NOT IN (SELECT title from writer NATURAL JOIN ( SELECT * FROM writer_award WHERE lower(result)=""won""))
OR m.production_year NOT IN (SELECT production_year from writer NATURAL JOIN ( SELECT * FROM writer_award WHERE lower(result)=""won"")))

AND
(m.title NOT IN (SELECT title from role NATURAL JOIN ( SELECT * FROM actor_award WHERE lower(result)=""won""))
OR m.production_year NOT IN (SELECT production_year from role NATURAL JOIN ( SELECT * FROM actor_award WHERE lower(result)=""won"")));
",2018-08-29 19:43:25.737892+10,11,0,128,partially correct
5641,"select DISTINCT title, production_year, credits from writer 
where writer.id in (select id from person where first_name = 'Kevin' and last_name = 'Williamson');
",2018-08-29 19:47:22.973661+10,5,0,405,partially correct
5642,"select DISTINCT title, production_year from writer 
where writer.id in (select id from person where first_name = 'Kevin' and last_name = 'Williamson');
",2018-08-29 19:47:58.39697+10,5,1,405,correct
5643,"SELECT production_year, COUNT(*) 
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-29 19:48:03.332802+10,2,1,406,correct
5644,select id from role where description in (select description from appearance where title='Psycho' and production_year='1960' group by description having count(scene_no)=1) and title='Psycho' and production_year='1960';,2018-08-29 19:49:06.372444+10,10,1,190,correct
5645,"select res.country from Restriction res

where res.title = 'Shakespeare in Love' and  res.description = 'M'; ",2018-08-29 19:49:16.273798+10,6,1,65,correct
5646,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 19:49:23.04975+10,11,1,18,correct
5647,"select id
from
role
natural join
Appearance
group by id, title, production_year
having
title = 'Psycho'
and
production_year = '1960'
and
count(id) = 1;",2018-08-29 19:49:25.117237+10,10,1,271,correct
5650,"select count(*)
from movie m
where not exists 
(select * from 
(select title from movie_award union select title from crew_award
union select title from director_award union select title from writer_award
union select title from actor_award) as aw 
where aw.title = m.title);",2018-08-29 19:52:54.895595+10,11,0,378,partially correct
5651,"with youngest as (select max(person.year_born) as y from person)
select p1.id,p1.first_name,p1.last_name
from person p1, youngest
where p1.year_born=youngest.y;
",2018-08-29 19:53:36.579783+10,7,1,397,correct
5652,"select title, production_year from person, writer
where person.id = writer.id and first_name = 'Kevin' and last_name = 'Williamson';
",2018-08-29 19:53:58.581231+10,5,1,405,correct
5653,"select country 
from restriction 
where title = 'Shakespeare in Love' and description = 'M';",2018-08-29 19:56:55.986828+10,6,1,405,correct
5654,"select id from person 
where year_born=(select max(year_born) from person p
where p.year_born!=(select max(year_born) from person));",2018-08-29 19:57:27.913298+10,3,1,18,correct
5655,"select count(*) from(select title,production_year from movie
EXCEPT
select title,production_year from movie_award where lower(result)='won'
EXCEPT
select title,production_year from crew_award where lower(result)='won'
EXCEPT
select title,production_year from director_award where lower(result)='won'
EXCEPT
select title,production_year from writer_award where lower(result)='won'
EXCEPT
select title,production_year from actor_award where lower(result)='won')as a;
",2018-08-29 19:58:13.766787+10,11,1,190,correct
5656,"select 
	id,
	first_name,
	last_name
from 
	person
where 
	person.year_born=(
	select 
		max(year_born) 
	from 
		person);
",2018-08-29 19:58:37.497661+10,7,1,397,correct
5657,"SELECT p.id, d.award_name, d.year_of_award, d.category 
FROM person p, director_award d
WHERE EXISTS
(SELECT * FROM director_award WHERE lower(d.result)=""nominated"")
AND NOT EXISTS
(SELECT * FROM director_award WHERE lower(d.result)=""won"");",2018-08-29 19:58:52.821203+10,13,0,128,partially correct
5658,"SELECT r.id 
FROM role r INNER JOIN scene s ON r.title=s.title AND r.production_year=s.production_year 
WHERE r.title = 'Psycho' AND r.production_year = 1960 AND s.scene_no=1;",2018-08-29 19:59:50.190189+10,10,0,143,partially correct
5659,"select m.title, m.production_year
from movie m natural join writer w natural join person p
where p.first_name = 'Kevin' and p.last_name = 'Williamson'
group by m.title;",2018-08-29 20:03:39.313028+10,5,1,76,correct
5660,"SELECT COUNT(*)
FROM person p
WHERE (SELECT * FROM DIRECTOR WHERE p.id = w.id );",2018-08-29 20:03:41.145286+10,12,0,406,noninterpretable
5661,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id = d.id );",2018-08-29 20:05:21.337788+10,12,1,406,correct
5662,"select id,award_name,year_of_award,category from director d inner join
(select * from director_award where lower(result)='nominated' group by title,production_year having count(*)>=1
except
select * from director_award where lower(result)='won') as a on a.title=d.title and a.production_year=d.production_year; ",2018-08-29 20:07:26.621541+10,13,1,190,correct
5663,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-29 20:08:17.037459+10,10,1,266,correct
5664,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma, person p, director d
WHERE ma.title=d.title
AND p.id=d.id
AND lower(award_name)='bafta film award'
AND lower(category)='best film'
AND lower(result)='won';",2018-08-29 20:10:01.782995+10,8,1,124,correct
5665,"select count(*)
from 
  writer_award as wa,
  writer as w,
  person as p
where 
  wa.id = w.id
  and wa.title = w.title
  and wa.production_year = w.production_year
  and lower(RESULT) ='won'
  and p.id = w.id
  and lower(p.last_name) = 'allen'
  and lower(p.first_name) = 'woody'
  and wa.year_of_award >= 1991
  and wa.year_of_award <= 1995;",2018-08-29 20:11:40.406099+10,9,1,102,correct
5666,"select movie_award.title, movie_award.production_year, first_name,last_name
from movie_award,director,person
where movie_award.title=director.title and movie_award.production_year=director.production_year
and director.id=person.id and lower(movie_award.category)=""best film"" and lower(movie_award.award_name)=""bafta film award"";",2018-08-29 20:11:53.049907+10,8,0,397,partially correct
5667,"select p.id, p.first_name, p.last_name
from person p
where p.year_born =
(select MAX(p2.year_born)
from person p2);",2018-08-29 20:14:14.193121+10,7,1,76,correct
5668,"SELECT COUNT(*)
FROM writer w, writer_award wa, person p
WHERE w.id=wa.id
AND w.id=p.id
AND w.production_year=wa.production_year
AND wa.production_year>1990
AND wa.production_year<1996
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen';
",2018-08-29 20:14:33.165963+10,9,1,124,correct
5669,"select a.title, a.production_year from (select * from writer natural join person) a where a.first_name='Kevin' and a.last_name='Williamson';",2018-08-29 20:14:45.273611+10,5,1,258,correct
5670,"SELECT r.id
FROM role r inner join appearance a ON r.title = a.title AND r.production_year = a.production_year 
WHERE r.title = 'Psycho' AND r.production_year = 1960 AND r.description = a.description
GROUP BY r.id
HAVING count(*) = 1;",2018-08-29 20:14:45.316643+10,10,1,143,correct
5671,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT * FROM director d, writer w, WHERE d.title=w.title Having count(*)>2);",2018-08-29 20:17:36.247652+10,4,0,406,noninterpretable
5672,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-29 20:19:08.626195+10,4,1,406,correct
5673,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-29 20:20:01.093303+10,4,1,406,correct
5674,"select movie_award.title, movie_award.production_year, first_name,last_name
from movie_award,director,person
where movie_award.title=director.title 
and movie_award.production_year=director.production_year
and director.id=person.id 
and lower(movie_award.category)=""best film"" 
and lower(movie_award.award_name)=""bafta film award""
and lower(result)='won';
",2018-08-29 20:20:05.784003+10,8,1,397,correct
5675,"select id, first_name, last_name from person order by year_born DESC
limit 1;
",2018-08-29 20:20:29.353206+10,7,1,405,correct
5676,"select id, fist_name, last_name
from person p;",2018-08-29 20:21:31.958322+10,4,0,357,noninterpretable
5677,select  award_name from writer_award where year_of_award = 1935;,2018-08-29 20:24:03.590691+10,1,0,398,partially correct
5678,"select count(*)
from writer_award natural join movie natural join writer natural join person
where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>1990 and year_of_award<1996; 

",2018-08-29 20:25:51.389325+10,9,0,391,partially correct
5679,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-29 20:26:03.592609+10,6,1,258,correct
5680,"WITH no_a_movie AS(
SELECT title, production_year
FROM movie
EXCEPT
SELECT DISTINCT title, production_year
FROM movie_award
EXCEPT
SELECT DISTINCT title, production_year
FROM crew_award
EXCEPT
SELECT DISTINCT title, production_year
FROM director_award
EXCEPT
SELECT DISTINCT title, production_year
FROM writer_award
EXCEPT
SELECT DISTINCT title, production_year
FROM actor_award)
SELECT count(*)
FROM no_a_movie;",2018-08-29 20:26:17.81162+10,11,0,143,partially correct
5681,"select d.id,da.award_name,da.year_of_award,da.category from 
director d,
director_award da
where d.title=da.title
and lower(da.result)!='won';",2018-08-29 20:26:34.51031+10,13,1,18,correct
5682,"select count(*) from
(select w.id,year_of_award,result
from writer_award w,person p
where w.id=p.id 
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and year_of_award<=1995
and year_of_award<=1991
and lower(result)='won');
",2018-08-29 20:26:44.200595+10,9,1,397,correct
5744,"select w.title, w.production_year 
from (person natural join movie natural join writer) as w
where w.first_name='Kevin'and w.last_name='Williamson';",2018-08-29 21:08:48.796509+10,5,1,323,correct
5683,"select count(*)
from writer_award natural join movie natural join writer natural join person
where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>1990 and year_of_award<1996 and lower(result)='won'; 

",2018-08-29 20:26:53.110978+10,9,1,391,correct
5684,"SELECT COUNT(re.id) FROM (SELECT p.id FROM person p
INNER JOIN writer w
ON p.id=w.id
WHERE p.year_born=1935) AS re;






",2018-08-29 20:28:10.967464+10,1,0,95,partially correct
5685,"select count(*)
from writer_award
where year_of_award>1990 and year_of_award<1996 and result = 'won'
and id = (
	select id
	from person
	where lower(first_name)= lower('Woody') and lower(last_name) = lower('Allen'));",2018-08-29 20:28:12.347661+10,9,1,347,correct
5686,"select id, first_name, last_name
from PERSON
where PERSON.id IN ( SELECT DIRECTOR.id from  
                     DIRECTOR INNER JOIN WRITER ON 
                     DIRECTOR.id = WRITER.id
                     GROUP BY DIRECTOR.id
                     HAVING COUNT(*) > 1);",2018-08-29 20:28:31.99745+10,4,0,139,partially correct
5687,"SELECT COUNT(re.id) FROM (SELECT DISTINCT p.id FROM person p
INNER JOIN writer w
ON p.id=w.id
WHERE p.year_born=1935) AS re;






",2018-08-29 20:28:34.324621+10,1,1,95,correct
5688,"SELECT p.id, d.award_name, d.year_of_award, d.category 

FROM person p, director_award d,
(director NATURAL JOIN 
(SELECT * FROM director_award d
WHERE EXISTS
(SELECT * FROM director_award WHERE lower(d.result)=""nominated"")
AND NOT EXISTS
(SELECT * FROM director_award WHERE lower(d.result)=""won""))) AS temp

WHERE p.id=temp.id;",2018-08-29 20:30:34.671091+10,13,0,128,partially correct
5689,"SELECT MAX(id)
FROM person p
WHERE p.year_born < (SELECT Max(year_born) FROM person);",2018-08-29 20:30:50.356432+10,3,0,343,partially correct
5690,"select id, first_name, last_name from person where year_born=(select max(year_born) from person);",2018-08-29 20:30:51.743126+10,7,1,258,correct
5691,"select movie_award.title, movie_award.production_year, first_name, last_name
from movie_award, director, person
where lower(award_name) = 'bafta film award' 
and lower(category) = 'best film' 
and movie_award.title = director.title
and movie_award.production_year = director.production_year
and director.id = person.id
;",2018-08-29 20:31:15.105844+10,8,0,405,partially correct
5692,"select p.id,count(p.id) from person p,
director d,writer w
where d.id=p.id or w.id=p.id
group by p.id;",2018-08-29 20:32:30.349572+10,14,0,18,partially correct
5693,"with youngest as (select id , first_name, last_name , year_born 

from person group by id , first_name, last_name)

select id , first_name, last_name from youngest 


where 
 
year_born = (select min(year_born) from youngest);",2018-08-29 20:33:08.018583+10,7,0,65,partially correct
5694,"WITH no_a_movie AS(
SELECT title, production_year
FROM movie
EXCEPT
SELECT title, production_year
FROM movie_award
WHERE lower(result)='won'
EXCEPT
SELECT title, production_year
FROM crew_award
WHERE lower(result)='won'
EXCEPT
SELECT title, production_year
FROM director_award
WHERE lower(result)='won'
EXCEPT
SELECT title, production_year
FROM writer_award
WHERE lower(result)='won'
EXCEPT
SELECT title, production_year
FROM actor_award
WHERE lower(result)='won')
SELECT count(*)
FROM no_a_movie;",2018-08-29 20:33:17.081654+10,11,1,143,correct
5695,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 20:34:08.7752+10,14,1,18,correct
5696,"with youngest as (select id , first_name, last_name , year_born 

from person group by id , first_name, last_name)

select id , first_name, last_name from youngest 


where 
 
year_born = (select max(year_born) from youngest);",2018-08-29 20:35:39.143427+10,7,1,65,correct
5697,"select movie_award.title, movie_award.production_year,  first_name, last_name
from movie_award, director, person
where lower(award_name) = 'bafta film award' 
and lower(category) = 'best film'
and lower(result) = 'won'
and movie_award.title = director.title
and movie_award.production_year = director.production_year
and director.id = person.id
;",2018-08-29 20:36:18.931997+10,8,1,405,correct
5698,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p,
role e;",2018-08-29 20:36:31.367748+10,15,0,18,noninterpretable
5699,"select distinct p.id
from 
    person as p,
	movie as m,
	role as r,
	scene as s
where
    r.id = p.id
	and r.title = m.title
	and r.production_year = m.production_year
	and m.production_year = 1960
	and lower(m.title) = 'psycho'
	and s.title = m.title
	and s.production_year = m.production_year;",2018-08-29 20:37:11.302339+10,10,0,102,partially correct
5700,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join director d natural join person p
where ma.award_name = 'BAFTA Film Award' and ma.category = 'Best Film' and ma. result = 'won';",2018-08-29 20:37:15.93438+10,8,0,76,partially correct
5701,"select distinct p.id
from 
    person as p,
	movie as m,
	role as r
where
    r.id = p.id
	and r.title = m.title
	and r.production_year = m.production_year
	and m.production_year = 1960
	and lower(m.title) = 'psycho';",2018-08-29 20:37:36.90193+10,10,0,102,partially correct
5702,"SELECT p.id
FROM person p
WHERE p.year_born = (
	SELECT MAX(year_born)
	FROM person
	WHERE year_born <(SELECT MAX(year_born)FROM person)

);
",2018-08-29 20:38:23.266872+10,3,1,343,correct
5703,"select id
from role, appearance
where appearance.title = role.title and appearance.production_year = role.production_year and appearance.description = role.description
and lower(appearance.title) = lower('Psycho') and appearance.production_year = 1960
group by id having count(scene_no) = 1;",2018-08-29 20:38:29.783389+10,10,1,347,correct
5704,"WITH n_person as(
SELECT *
FROM person
EXCEPT
SELECT *
FROM person
WHERE year_born IN (SELECT MAX(year_born) FROM person))
SELECT id
FROM n_person
WHERE year_born IN (SELECT MAX(year_born) FROM n_person);",2018-08-29 20:40:37.670268+10,3,1,143,correct
5705,"select id, fist_name, last_name
from person p;",2018-08-29 20:41:29.286357+10,4,0,357,noninterpretable
5706,"select id, first_name, last_name
from person p;",2018-08-29 20:41:48.937634+10,4,0,357,partially correct
5708,"with a as 
(select id
from role r,scene s
where r.title=s.title
and r.production_year=s.production_year
and lower(r.title)='psycho'
and r.production_year=1960)
select id
from a
group by a.id
having count(a.id)=1;
",2018-08-29 20:42:46.808509+10,10,0,397,partially correct
5709,"select count(*)
from movie
where (title, production_year) not in 


(select title, production_year
from movie_award
union
select title, production_year
from movie_award
union
select title, production_year
from movie_award
union
select title, production_year
from movie_award
union
select title, production_year
from movie_award) ;
",2018-08-29 20:43:51.177569+10,11,0,347,partially correct
5710,"SELECT ra.id
FROM (role NATURAL JOIN appearance) AS ra
WHERE ra.production_year=1960
AND lower(ra.title)='psycho'
GROUP BY ra.id
HAVING COUNT(*)=1;",2018-08-29 20:44:32.865557+10,10,1,124,correct
5711,"select id, first_name, last_name
from PERSON
where PERSON.id IN ( SELECT DIRECTOR.id from  
                     DIRECTOR NATURAL JOIN WRITER
                     GROUP BY DIRECTOR.id                     
                     HAVING COUNT(*) > 1);",2018-08-29 20:45:04.129204+10,4,1,139,correct
5745,"select first_name,last_name,title,production_year,description from person inner join(select * from role where id in (select id from (select count(id) b,id from role group by id) where b in (select max(a) from (select count(id) a,id from role group by id))))e on e.id=person.id;",2018-08-29 21:09:33.295531+10,15,1,190,correct
5747,"select count(*) from PERSON as P
where P.id in 
		(select  distinct w.id from WRITER as W)
		and p.year_born = '1935';",2018-08-29 21:10:19.250972+10,1,1,167,correct
5712,"select count(*)
from movie
where (title, production_year) not in 


(select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from movie_award
where lower(result) = 'won') ;
",2018-08-29 20:45:04.21363+10,11,0,347,partially correct
5713,"select count(*)
from movie
where (title, production_year) not in 


(select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from crew_award
where lower(result) = 'won'
union
select title, production_year
from director_award
where lower(result) = 'won'
union
select title, production_year
from writer_award
where lower(result) = 'won'
union
select title, production_year
from actor_award
where lower(result) = 'won') ;
",2018-08-29 20:46:30.278076+10,11,1,347,correct
5714,"
SELECT COUNT(*),pr.id
FROM (SELECT DISTINCT role.id, description
      FROM role, person 
      WHERE person.id = role.id) AS pr
GROUP BY pr.id
ORDER BY COUNT(*) DESC;




",2018-08-29 20:48:14.275987+10,15,0,165,partially correct
5715,"select id from 
(select count(id) c,id from(select id,title,production_year from director union select id,title,production_year from writer except
select d.id,d.title,d.production_year from director d inner join writer w on d.id=w.id and d.title=w.title and d.production_year=w.production_year) group by id)
where c in (select max(a) from (select count(id) a,id from (select id,title,production_year from director 
union
select id,title,production_year from writer
except
select d.id,d.title,d.production_year from director d inner join writer w on d.id=w.id and d.title=w.title and d.production_year=w.production_year) group by id));",2018-08-29 20:48:39.933639+10,14,0,190,partially correct
5716,"select title, production_year
from WRITER
WHERE WRITER.id IN (SELECT PERSON.id
                    from PERSON
                    where person.first_name=""Kevin"" and person.last_name=""Williamson"");",2018-08-29 20:49:47.508179+10,5,1,139,correct
5717,"select years, count();",2018-08-29 20:50:06.243159+10,2,0,398,noninterpretable
5718,"select id from 
(select count(id) c,id from(select id,title,production_year from director union select id,title,production_year from writer) group by id)
where c in (select max(a) from (select count(id) a,id from (select id,title,production_year from director 
union
select id,title,production_year from writer) group by id));",2018-08-29 20:50:57.167918+10,14,1,190,correct
5719,"select id
from person
where year_born = (
select max(year_born)
from person
where year_born < (
select max(year_born)
from person));",2018-08-29 20:51:18.649182+10,3,1,347,correct
5720,"SELECT COUNT(*)
FROM PERSON NATURAL JOIN WRITER 
WHERE PERSON.year_born = '1935';",2018-08-29 20:52:38.478841+10,1,0,96,partially correct
5721,select * from director_award d;,2018-08-29 20:52:56.637032+10,13,0,137,partially correct
5722,"SELECT count(*)
FROM person p,writer w
WHERE p.id=w.id AND p.year_born=1935;",2018-08-29 20:53:20.662662+10,1,0,106,partially correct
5723,"select role.id
from role,scene
where
lower(scene.title)='psycho'
and lower(role.title)='psycho'
and role.production_year=1960
and scene.production_year=1960
group by role.id
having count(role.id)=1;
",2018-08-29 20:53:56.21044+10,10,0,181,partially correct
5724,"select dw.id, dw.first_name, dw.last_name 
from( person p natural join director d natural join writer w) AS dw
Group by dw.id
having count(*)>1;",2018-08-29 20:54:11.160841+10,4,1,323,correct
5725,"select country 
from RESTRICTION
where RESTRICTION.title=""Shakespeare in Love"" and RESTRICTION.description=""M"";",2018-08-29 20:54:52.61725+10,6,1,139,correct
5726,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
              FROM writer w
	        WHERE p.id=w.id AND p.year_born=1935);",2018-08-29 20:56:02.185554+10,1,1,106,correct
5727,"select title, production_year, first_name, last_name from movie_award natural join movie natural join director natural join person where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';",2018-08-29 20:56:22.274368+10,8,1,258,correct
5728,"select 
	production_year,count(*)
from movie
where production_year=1993 or production_year=1992 or production_year=1991
group by production_year;",2018-08-29 20:58:08.854732+10,2,1,239,correct
5729,"SELECT production_year,COUNT(*)
FROM movie
WHERE production_year IN (1991,1992,1993)
GROUP BY production_year;",2018-08-29 20:58:57.429696+10,2,1,106,correct
5730,"select count(*)
from writer as w,person as p
where w.id=p.id and p.year_born='1935';",2018-08-29 20:59:28.345867+10,1,0,223,partially correct
5731,"SELECT mw.title, mw.production_year
FROM (movie m NATURAL JOIN writer w) as mw
WHERE (SELECT pw.first_name, pw.last_name 
       FROM (person p NATURAL JOIN writer w) as pw
       WHERE());",2018-08-29 20:59:42.553733+10,5,0,406,noninterpretable
5732,"select distinct count(*) from movie where not
  (select m.title from movie as m, Movie_Award as ma
  where m.title = ma.title
  and lower(ma.result)='won'
  union
  select m.title from movie as m, Crew_Award as ca
  where m.title = ca.title
  and lower(ca.result)!='won'
  union
  select m.title from movie as m, Director_Award as da
  where m.title = da.title
  and lower(da.result)!='won'
  union
  select m.title from movie as m,  Writer_Award as wa
  where m.title = wa.title
  and lower(wa.result)!='won'
  union
  select m.title from movie as m,  Actor_Award as aa
  where m.title = aa.title
  and lower(aa.result)!='won');",2018-08-29 21:00:37.141412+10,11,0,92,partially correct
5733,"SELECT COUNT(*)
FROM PERSON
WHERE EXISTS (SELECT * FROM WRITER WHERE WRITER.id=PERSON.id AND PERSON.year_born = 1935);",2018-08-29 21:01:45.740448+10,1,1,96,correct
5734,select count(*) from Director where ;,2018-08-29 21:02:19.587548+10,12,0,398,noninterpretable
5735,"SELECT person.first_name, person.last_name,role.title, role.production_year, role.description
FROM person,role, movie,(SELECT COUNT(*),pr.id
                         FROM (SELECT DISTINCT role.id, description
                         FROM role, person 
                         WHERE person.id = role.id) AS pr
                         GROUP BY pr.id
                         ORDER BY COUNT(*) DESC
                         LIMIT 1) AS maxnum
WHERE  person.id = maxnum.id AND role.id = maxnum.id AND role.title = movie.title AND role.production_year = movie.production_year;




",2018-08-29 21:02:26.26635+10,15,1,165,correct
5736,"SELECT COUNT(8)
FROM writer AS w INNER JOIN person AS p
ON w.id = p.id
WHERE p.year_born > 1935;",2018-08-29 21:04:29.922809+10,1,0,340,partially correct
5737,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma natural join director d natural join person p
where lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film' and lower(ma. result) = 'won';",2018-08-29 21:04:43.321759+10,8,1,76,correct
5738,"SELECT COUNT(*)
FROM writer AS w INNER JOIN person AS p
ON w.id = p.id
WHERE p.year_born > 1935;",2018-08-29 21:04:59.297651+10,1,0,340,partially correct
5739,"select id 
from (
	select id, count(*) as no
	from (
		select id, title, production_year
		from writer
		union
		select id, title, production_year
		from director) dw
	group by id ) as dw2
where no = (
	select max(no2)
	from (
		select id, count(*) as no2
		from (
			select id, title, production_year
			from writer
			union
			select id, title, production_year
			from director
		) as dw3
		group by id ) 
	as dw4);",2018-08-29 21:05:33.091892+10,14,1,347,correct
5740,"SELECT m.production_year, COUNT(m.title) FROM movie m
WHERE m.production_year IN (1991,1992,1993)
GROUP BY m.production_year;",2018-08-29 21:07:05.399041+10,2,1,95,correct
5741,"select title,production_year,description from role where id in (select id from (select count(id) b,id from role group by id) where b in (select max(a) from (select count(id) a,id from role group by id)));",2018-08-29 21:07:30.382192+10,15,0,190,partially correct
5742,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id AND lower(first_name)='kevin' AND lower(last_name)='williamson';",2018-08-29 21:07:59.918666+10,5,1,406,correct
5743,select ids;,2018-08-29 21:08:00.934915+10,4,0,398,noninterpretable
5746,;,2018-08-29 21:09:52.028996+10,15,0,309,noninterpretable
5748,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-29 21:10:21.864746+10,15,1,309,correct
5749,"SELECT COUNT(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 21:11:10.887133+10,1,1,340,correct
5750,"select id,scene_no
from role r,scene s
where r.title=s.title
and r.production_year=s.production_year
and lower(r.title)='psycho'
and r.production_year=1960;
",2018-08-29 21:13:19.593272+10,10,0,397,partially correct
5751,"select count(*) from (SELECT title from movie  where title not in (select title from Movie_Award 
UNION SELECT title from crew_award 
union select title from Director_award 
union select title from writer_award
union select title from actor_award) group by title);",2018-08-29 21:13:37.39388+10,11,0,366,partially correct
5752,"select title, production years from;",2018-08-29 21:14:41.541042+10,5,0,398,noninterpretable
5753,"select country from restriction
where title='Shakespeare in Love'and description='M';",2018-08-29 21:15:05.112556+10,6,1,323,correct
5754,"select production_year,count(*) as num from MOVIE
where production_year = '1993' or production_year = '1992' or production_year = '1991'
group by production_year;
",2018-08-29 21:15:37.185847+10,2,1,167,correct
5755,"select count(*) from (SELECT title from movie  where (title,production_year) not in (
select title,production_year from Movie_Award 
UNION SELECT title,production_year from crew_award 
union select title,production_year from Director_award 
union select title,production_year from writer_award
union select title,production_year from actor_award) group by title,production_year);",2018-08-29 21:16:37.978576+10,11,0,366,partially correct
5756,"SELECT id, first_name, last_name
from PERSON
WHERE PERSON.year_born=( select MAX(year_born) 
                         from PERSON );",2018-08-29 21:16:57.11156+10,7,1,139,correct
5757,"SELECT p.id,p.first_name,p.last_name FROM person p
WHERE p.id IN (SELECT d.id FROM director d
NATURAL JOIN writer w
GROUP BY d.id
HAVING COUNT(d.title) >=2);",2018-08-29 21:17:07.927642+10,4,1,95,correct
5758,"WITH movieByYear AS 
(SELECT production_year, COUNT(*) AS count
FROM movie
GROUP BY production_year)
SELECT *
FROM movieByYear
WHERE production_year = 1992 
OR production_year = 1993
OR production_year = 1991;",2018-08-29 21:17:28.789643+10,2,1,340,correct
5759,"select count(*) as num from PERSON as p
where p.id not in
			(select distinct d.id from DIRECTOR as d);",2018-08-29 21:17:53.654734+10,12,1,167,correct
5760,"select D.id, A.Award_name, A.Year_Of_Award, A.Production_Year from 
Director_award A natural join Director D where lower (A.result)= 'nominated';",2018-08-29 21:18:10.444402+10,13,0,137,partially correct
5761,"select count(*)

from person p

where EXISTS(select w.id from writer as w where p.id=w.id and p.year_born=1935);",2018-08-29 21:18:23.575439+10,1,1,223,correct
5762,"select count(*) from (SELECT title from movie  where (title,production_year) not in (
select title,production_year from Movie_Award WHERE result='won'
UNION SELECT title,production_year from crew_award WHERE result='won'
union select title,production_year from Director_award WHERE result='won'
union select title,production_year from writer_award WHERE result='won'
union select title,production_year from actor_award WHERE result='won') group by title,production_year);",2018-08-29 21:18:26.752244+10,11,0,366,partially correct
5763,"select count(*)
from writer_award wa, writer w, person p
where wa.id = w.id
and wa.title = w.title
and wa.production_year = w.production_year
and w.id = p.id
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
and wa.year_of_award >=1991
and wa.year_of_award <=1995;
",2018-08-29 21:18:27.278727+10,9,0,76,partially correct
5764,"  select count(*) from movie as m where not exists
  (select ma.title,ma.production_year from Movie_Award as ma
  where m.title = ma.title and m.production_year=ma.production_year and lower(ma.result)='won'
  union
  select ca.title,ca.production_year from Crew_Award as ca
  where m.title = ca.title and m.production_year=ca.production_year and lower(ca.result)='won'
  union
  select da.title,da.production_year from Director_Award as da
  where m.title = da.title and m.production_year=da.production_year and lower(da.result)='won'
  union
  select wa.title,wa.production_year from Writer_Award as wa
  where m.title = wa.title and m.production_year=wa.production_year and lower(wa.result)='won'
  union
  select aa.title,aa.production_year from Actor_Award as aa
  where m.title = aa.title and m.production_year=aa.production_year and lower(aa.result)='won');
",2018-08-29 21:18:27.906374+10,11,1,92,correct
5765,"select D.id, A.Award_name, A.Year_Of_Award, A.Production_Year, A.category from 
Director_award A natural join Director D where lower (A.result)= 'nominated';",2018-08-29 21:19:01.990187+10,13,0,137,partially correct
5766,"select D.id, A.Award_name, A.Year_Of_Award, A.category from 
Director_award A natural join Director D where lower (A.result)= 'nominated';",2018-08-29 21:19:38.687551+10,13,1,137,correct
5767,"SELECT country
FROM Restriction
WHERE title = 'Shakespeare in Love' and Description ='M';",2018-08-29 21:20:48.397038+10,6,1,406,correct
5768,;,2018-08-29 21:21:02.025441+10,13,0,343,noninterpretable
5769,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE MOVIE.production_year=1993 AND 1992 AND 1991
GROUP BY MOVIE.production_year;
",2018-08-29 21:21:14.383495+10,2,0,96,partially correct
5770,"select id
from person p
where p.year_born = (select max (year_born) from person where year_born < (select max (year_born) from person));",2018-08-29 21:22:31.518737+10,3,1,378,correct
5771,"select r.id
from role r,scene s,appearance a
where r.title=s.title
and s.title=a.title
and r.production_year=s.production_year
and r.production_year=a.production_year
and lower(a.title)='psycho'
and a.production_year=1960
AND a.description = r.description
and s.scene_no=a.scene_no
group by id
having count(*)=1;
",2018-08-29 21:22:47.420515+10,10,1,397,correct
5772,"select count(*) 
from person p
where exists (select * 
from writer w
where w.id=p.id 
and p.year_born=1935);",2018-08-29 21:24:14.044587+10,1,1,110,correct
5773,"
select id, first_name, last_name
from person p
group by year_born
having max(year_born);",2018-08-29 21:25:25.030711+10,7,0,323,partially correct
5774,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN (SELECT person.id 
FROM person, director
WHERE person.id = director.id);",2018-08-29 21:25:35.811269+10,12,1,340,correct
5775,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE MOVIE.production_year > 1990 AND MOVIE.production_year < 1994
GROUP BY MOVIE.production_year;
",2018-08-29 21:25:49.18286+10,2,1,96,correct
5776,"select id, first_name, last_name
from person p
group by p.year_born
having max(p.year_born);",2018-08-29 21:26:01.966757+10,7,0,323,partially correct
5777,"select count(*) from movie m
where not exists(select * from movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
where m.title=ma.title and m.title=ca.title and m.title=da.title and m.title=wa.title and m.title=aa.title );

",2018-08-29 21:26:21.741483+10,11,0,238,partially correct
5778,"

SELECT wd.id
FROM (SELECT id,title
      FROM writer
      UNION
      SELECT id, title
      FROM director) AS wd
GROUP BY wd.id
ORDER BY COUNT(*) DESC
LIMIT 3;


",2018-08-29 21:26:45.842431+10,14,1,165,correct
5806,"select first_name, last_name, title, production_year, description
from (person natural join role) as pr
where id = (
	select id
	from (
		select id, count(*) as num_role4
		from (person natural join role) as pr4
		group by id
	) as pr2
	where num_role4 = (
		select max(num_role1)
		from (
			select id, count(*) as num_role1
			from (person natural join role) as pr3
			group by id
		) as no3));",2018-08-29 21:42:12.550831+10,15,1,347,correct
8750,"SELECT *
FROM director d INNER JOIN writer wr ON d.title=wr.title;

",2018-08-30 23:59:43.263629+10,14,0,403,partially correct
5779,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 21:26:57.691405+10,11,1,238,correct
5780,"SELECT count(0)
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
) order by title;",2018-08-29 21:27:10.591075+10,11,1,366,correct
5781,select count(distinct(w.id)) from writer_award w where year_of_award>1990 and year_of_award<1995 and award_name='Woody Allen';,2018-08-29 21:27:51.453973+10,9,0,270,partially correct
5782,"select count(*) as number_of_awards
from writer_award wa, writer w, person p
where wa.id = w.id
and wa.title = w.title
and wa.production_year = w.production_year
and w.id = p.id
and wa.id = w.id
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
and lower(result) = 'won'
and wa.year_of_award >= 1991
and wa.year_of_award <= 1995;
",2018-08-29 21:28:34.440133+10,9,1,76,correct
5783,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=
(select max(year_born) from person);",2018-08-29 21:28:34.570027+10,7,1,323,correct
5784,"WITH dirc as(
SELECT *
FROM director_award da INNER JOIN director d ON da.title=d.title AND da.production_year=d.production_year)
SELECT id 
FROM dirc d
WHERE d.result='nominated' AND NOT EXISTS (SELECT * from dirc where result='won' and d.id = dirc.id)
GROUP BY id
HAVING count(*) > 0;",2018-08-29 21:29:28.495458+10,13,0,143,partially correct
5785,"select m.production_year, count(*)
from movie m
where m.production_year>1990
and m.production_year<1994
group by m.production_year;",2018-08-29 21:29:45.73051+10,2,1,110,correct
5786,"WITH dirc as(
SELECT *
FROM director_award da INNER JOIN director d ON da.title=d.title AND da.production_year=d.production_year)
SELECT id, award_name, year_of_award, category 
FROM dirc d
WHERE d.result='nominated' AND NOT EXISTS (SELECT * from dirc where result='won' and d.id = dirc.id)
GROUP BY id
HAVING count(*) > 0;",2018-08-29 21:30:26.286754+10,13,1,143,correct
5787,"select id,max(year_born) from person where id not in 
(select id from person where year_born in (select max(year_born) from person));
",2018-08-29 21:30:38.430361+10,3,0,92,partially correct
5788,"select count(*)
from person p
where not exists (select * 
from director d
where d.id=p.id);",2018-08-29 21:31:04.059148+10,12,1,110,correct
5789,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d,director_award da
WHERE da.title = d.title
	AND da.production_year = d.production_year
	AND lower(da.result)='nominated'
	AND d.id NOT IN (
	SELECT id 
	FROM director d,director_award da
	WHERE
		da.title = d.title
		AND da.production_year = d.production_year
		AND lower(da.result)='won'
	);",2018-08-29 21:32:05.831453+10,13,1,343,correct
5790,"SELECT id, first_name, last_name, year_born
From Person
GROUP BY year_born HAVING (year_born=1992);",2018-08-29 21:32:32.668675+10,7,0,406,partially correct
5791,"select id from person p, 
(select max(year_born) as myear from person where id not in 
(select id from person where year_born in (select max(year_born) from person))) as yd
where yd.myear = p.year_born;
",2018-08-29 21:32:36.411493+10,3,1,92,correct
5792,"select 

      dm.first_name , dm.last_name , dm.title , dm.production_year 

from  
     (person p natural join Director d natural join Movie_Award ma) as dm 
 
 where dm.award_name = 'BAFTA Film Award' AND dm.category = 'Best Film';
 
 

      
      
",2018-08-29 21:32:42.757757+10,8,0,65,partially correct
5793,"select dd.id, dd.award_name, dd.year_of_award, dd.category
from (director natural join director_award) as dd 
where not exists (select bb.id, bb.award_name, bb.year_of_award, bb.category
				from ( director natural join director_award ) as bb 
				where dd.id = bb.id and bb.result = ""won"");",2018-08-29 21:34:15.902058+10,13,1,378,correct
5794,"select id from person p, 
(select max(year_born) as myear from person where year_born < (select max(year_born) from person)) as yd
where yd.myear = p.year_born;
",2018-08-29 21:34:17.987612+10,3,1,92,correct
5795,"with m as
(select title,production_year
from movie natural join movie_award
where lower(result)!='won')
and 
with c as
(select title,production_year
from movie natural join crew_award
where lower(result)!='won')
and 
with d as
(select title,production_year
from movie natural join director_award
where lower(result)!='won')
and 
with w as
(select title,production_year
from movie natural join writer_award
where lower(result)!='won')
and 
with a as
(select title,production_year
from movie natural join actor_award
where lower(result)!='won')

select count(movie.*) from
movie,m,c,d,w,a
where (movie.title and movie.production_year) not in(
m,c,d,w,a);",2018-08-29 21:36:14.117164+10,11,0,397,noninterpretable
5796,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS ( SELECT * 
FROM DIRECTOR
WHERE DIRECTOR.id = PERSON.id);",2018-08-29 21:36:45.077449+10,12,1,96,correct
5797,"select title, production_year, first_name,last_name
from(person p natural join director d) as pm
where 
pm.title in
(select title from movie_award ma
where ma.award_name='BAFTA Film Award'
group by ma.title);",2018-08-29 21:36:57.696145+10,8,0,323,partially correct
5798,SELECT * FROM movie;,2018-08-29 21:36:58.628021+10,15,0,60,partially correct
5799,select id from role natural join appearance where production_year=1960 and lower(title)='psycho' group by id having count(*)=1;,2018-08-29 21:37:12.067807+10,10,1,258,correct
5800,"select id
from appearance a inner join role r on a.title=r.title
where  a.title='Psycho'
and a.production_year=1960
and a.description=r.description
group by id
having count(id)=1;",2018-08-29 21:40:15.289794+10,10,0,351,partially correct
5801,"WITH dwMovie AS(
	SELECT d.id, COUNT(*) AS count
	FROM director d, writer w
	WHERE d.id = w.id 
	AND w.title = d.title
	AND w.production_year = d.production_year
	GROUP BY d.id)
SELECT first_name,last_name
FROM person p, dwMovie dw
WHERE dw.id = p.id
AND dw.count > 1;",2018-08-29 21:40:30.231744+10,4,0,340,partially correct
5802,select * from movie;,2018-08-29 21:40:54.498682+10,14,0,60,partially correct
5803,"WITH dwMovie AS(
	SELECT d.id, COUNT(*) AS count
	FROM director d, writer w
	WHERE d.id = w.id 
	AND w.title = d.title
	AND w.production_year = d.production_year
	GROUP BY d.id)
SELECT p.id, first_name,last_name
FROM person p, dwMovie dw
WHERE dw.id = p.id
AND dw.count > 1;",2018-08-29 21:41:10.119148+10,4,1,340,correct
5804,"select id
from appearance a inner join role r on a.title=r.title
where  a.title='Psycho'
and a.production_year=1960
and a.production_year=r.production_year
and a.description=r.description
group by id
having count(id)=1;",2018-08-29 21:41:35.759389+10,10,1,351,correct
5805,"SELECT w.title,w.production_year FROM writer w,person p
WHERE w.id = p.id AND lower(p.first_name)='kevin' AND lower(p.last_name)='williamson';

",2018-08-29 21:41:48.51168+10,5,1,95,correct
5807,"select p.id, p.first_name, p.last_name
from (person p inner join director d on p.id=d.id inner join writer w on w.id=p.id) as t
group by t.id
having count(*)>1;",2018-08-29 21:43:13.129454+10,4,0,110,partially correct
5808,"SELECT id
FROM;",2018-08-29 21:43:18.20431+10,3,0,366,noninterpretable
5809,"SELECT r.country FROM restriction r
WHERE lower(r.title)='shakespeare in love' AND r.description='M';",2018-08-29 21:44:21.666714+10,6,1,95,correct
5810,"select pd.title,pd.first_name, pd.last_name, pd.production_year from 
(person p natural join director d) as pd
where pd.title in
(
select title from movie_award
where award_name ='BAFTA Film Award' and category='best film' and result='won');",2018-08-29 21:44:33.992564+10,8,1,323,correct
5811,"select t.id, t.first_name, t.last_name
from (person p natural join director d natural join writer w) as t
group by t.id
having count(*)>1;",2018-08-29 21:44:34.610348+10,4,1,110,correct
5812,"select pd.title,pd.production_year,pd.first_name, pd.last_name from 
(person p natural join director d) as pd
where pd.title in
(
select title from movie_award
where award_name ='BAFTA Film Award' and category='best film' and result='won');",2018-08-29 21:45:17.357452+10,8,1,323,correct
5813,"SELECT id
From Movie M natural join Role R natural join appearance A
Where M.title='Psycho' and M.production_year='1960'
Group By R.ID having count(*)=1; 

",2018-08-29 21:45:37.37593+10,10,1,77,correct
5814,"select w.title, w.production_year
from writer w, person p
where w.id=p.id
and lower(p.first_name)='kevin'
and lower(p.last_name)='williamson';",2018-08-29 21:47:24.627621+10,5,1,110,correct
5815,"SELECT title, production_year
FROM writer w, person p
WHERE w.id = p.id
AND p.first_name = 'Kevin'
AND p.last_name = 'Williamson';",2018-08-29 21:47:27.487042+10,5,1,340,correct
5816,"	SELECT r.id,COUNT(s.scene_no)
	FROM APPEARANCE a,ROLE r,SCENE s
	WHERE a.title =s.title
		and lower(a.title) = 'psycho'
		and a.scene_no = s.scene_no
		and a.production_year = s.production_year
		and a.title = r.title
		and a.production_year = r.production_year
		and a.description = r.description
		and r.title=s.title
		and r.production_year = s.production_year
	GROUP BY r.id
	HAVING COUNT(s.scene_no)=1;
",2018-08-29 21:48:14.843035+10,10,0,132,partially correct
5817,"SELECT id
FROM person p
WHERE (SELECT d.id,p.id
	FROM director d , writer r,
	WHERE p.id = d.id OR p.id = d.id
	AND SELECT COUNT(*)
	FROM writer w,director d,movie m
	WHERE (w.title = m.title AND w.production_year = m.production_year)
		OR (d.title = m.title AND d.production_year = m.production_year)

);
",2018-08-29 21:49:31.054167+10,14,0,343,noninterpretable
5818,"SELECT id
FROM person p
WHERE (SELECT d.id,p.id
	FROM director d , writer r,
	WHERE p.id = d.id OR p.id = d.id
	AND SELECT COUNT(*)
	FROM writer w,director d,movie m
	WHERE (w.title = m.title AND w.production_year = m.production_year)
		OR (d.title = m.title AND d.production_year = m.production_year)

);
",2018-08-29 21:49:44.762361+10,14,0,343,noninterpretable
5819,"
SELECT id, award_name, category,year_of_award
FROM (SELECT director.id, director_award.award_name, director_award.category,direct_award.year_of_award
FROM director_award, director,person
WHERE director_award.result = 'nominated' AND director_award.title = director.title 
AND director_award.production_year = director.production_year AND director.id = person.id
GROUP BY director.id
HAVING COUNT(*)>=1) AS nom 
INNER JOIN
(SELECT director.id, director_award.award_name, director_award.category,director_award.year_of_award
FROM director_award, director,person
WHERE director_award.result = 'won' AND director_award.title = director.title 
AND director_award.production_year = director.production_year AND director.id = person.id
GROUP BY director.id
HAVING COUNT(*)<1) AS nowin
ON nowin.id = nom.id;





",2018-08-29 21:50:19.035358+10,13,0,165,noninterpretable
5820,"select r.country
from restriction r
where lower(r.title)='shakespeare in love'
and lower(r.description)='m';",2018-08-29 21:50:36.885717+10,6,1,110,correct
5821,"	SELECT r.id,COUNT(*)
	FROM APPEARANCE a,ROLE r,SCENE s
	WHERE a.title =s.title
		and lower(a.title) = 'psycho'
		and a.scene_no = s.scene_no
		and a.production_year = s.production_year
		and a.title = r.title
		and a.production_year = r.production_year
		and a.description = r.description
		and r.title=s.title
		and a.production_year = 1960
	GROUP BY r.id
	HAVING COUNT(*)=1;
",2018-08-29 21:50:39.480498+10,10,0,132,partially correct
5822,select * from director;,2018-08-29 21:51:09.264387+10,14,0,137,partially correct
5823,"SELECT id 
FROM PERSON
WHERE year_born IN(
 SELECT MAX(year_born) 
 FROM
 (SELECT * FROM PERSON
 WHERE year_born NOT IN(SELECT MAX(year_born) FROM PERSON)));",2018-08-29 21:51:11.356686+10,3,1,98,correct
5824,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person);",2018-08-29 21:51:11.729316+10,7,1,406,correct
5825,"select 
	r.id 
from 
	appearance a natural join role r
where 
	a.title = 'Psycho'
	and a.production_year = 1960
group by 
	r.id
having
	count(*) = 1;",2018-08-29 21:51:36.750914+10,10,1,109,correct
5826,"with worked as(
select count(*) ct, id
from(
SELECT id,title,production_year 
FROM writer
UNION
SELECT *
FROM director)
group by id)
SELECT id
FROM worked
WHERE ct in (SELECT max(ct) from worked);",2018-08-29 21:51:38.112024+10,14,1,143,correct
5827,"	SELECT r.id
	FROM APPEARANCE a,ROLE r,SCENE s
	WHERE a.title =s.title
		and lower(a.title) = 'psycho'
		and a.scene_no = s.scene_no
		and a.production_year = s.production_year
		and a.title = r.title
		and a.production_year = r.production_year
		and a.description = r.description
		and r.title=s.title
		and a.production_year = 1960
	GROUP BY r.id
	HAVING COUNT(*)=1;
",2018-08-29 21:51:48.065539+10,10,1,132,correct
5828,"select country
from restriction
where lower(title) = ""shakespeare in love"" and lower(description) = 'm';",2018-08-29 21:52:16.992305+10,6,1,109,correct
5829,"SELECT 
	id, award_name, year_of_award, category
FROM 
	(director_award NATURAL JOIN director) AS dn
WHERE
	lower(result) = 'nominated'
	AND NOT EXISTS (SELECT 
					*
				FROM 
					(director_award NATURAL JOIN director) AS dw
				WHERE
					lower(result) = 'won'
					AND dn.id = dw.id)
;",2018-08-29 21:52:44.670935+10,13,1,222,correct
5830,"SELECT r.country
FROM restriction r
WHERE lower(r.title) = 'shakespeare in love'
AND lower(r.description) = 'm';",2018-08-29 21:52:58.958825+10,6,1,340,correct
5831,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p1.year_born) from person p1);",2018-08-29 21:53:10.876275+10,7,1,110,correct
5832,"SELECT a.id, a.award_name, a.year_of_award, a.category ,a.result

FROM (SELECT * FROM director NATURAL JOIN director_award) AS a

WHERE a.id IN
(SELECT p.id
FROM person p
WHERE 
p.id 
NOT IN
(SELECT id FROM (director NATURAL JOIN (SELECT * FROM director_award d WHERE lower(d.result)=""won"")))
AND
p.id
IN
(SELECT id FROM (director NATURAL JOIN (SELECT * FROM director_award d WHERE lower(d.result)=""nominated""))) 

) 
;",2018-08-29 21:53:11.839872+10,13,0,128,partially correct
5833,"select count(*) from writer_award wa
where wa.id=
(select id from person p
where p.first_name ='Woody' and p.last_name='Allen' )and(wa.year_of_award>1990 and wa.year_of_award<1996);",2018-08-29 21:53:34.841473+10,9,0,323,partially correct
5834,"SELECT p.id
FROM person p
WHERE year_born=(SELECT MAX(year_born) FROM person WHERE year_born<(SELECT MAX(year_born) FROM person));",2018-08-29 21:55:04.074024+10,3,1,124,correct
5835,"select count(*) from writer_award wa
where wa.id=
(select id from person p
where p.first_name ='Woody' and p.last_name='Allen' )and(wa.year_of_award>1990 and wa.year_of_award<1996)
and wa.result='won';",2018-08-29 21:55:12.715463+10,9,1,323,correct
5836,"SELECT COUNT(*)
FROM MOVIE
WHERE NOT EXISTS (SELECT * FROM MOVIE_AWARD NATURAL JOIN CREW_AWARD NATURAL JOIN DIRECTOR_AWARD NATURAL JOIN WRITER_AWARD NATURAL JOIN ACTOR_AWARD);",2018-08-29 21:55:17.233902+10,11,0,132,partially correct
5837,"SELECT a.id, a.award_name, a.year_of_award, a.category

FROM (SELECT * FROM director NATURAL JOIN director_award) AS a

WHERE a.id IN
(SELECT p.id
FROM person p
WHERE 
p.id 
NOT IN
(SELECT id FROM (director NATURAL JOIN (SELECT * FROM director_award d WHERE lower(d.result)=""won"")))
AND
p.id
IN
(SELECT id FROM (director NATURAL JOIN (SELECT * FROM director_award d WHERE lower(d.result)=""nominated""))) 

) 
;",2018-08-29 21:55:43.430721+10,13,1,128,correct
5838,"SELECT p.id,p.first_name,p.last_name FROM person p
WHERE p.year_born IN
(SELECT MAX(year_born) FROM person);",2018-08-29 21:56:31.518431+10,7,1,95,correct
5839,"SELECT id, first_name,last_name
FROM person p
WHERE p.year_born = (SELECT MIN(p1.year_born)
	FROM person p1);",2018-08-29 21:56:56.639203+10,7,0,340,partially correct
5840,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, director d, person p
where ma.title = d.title
and ma.production_year = d.production_year
and p.id = d.id
and lower(ma.category)='best film'
and lower(ma.award_name)='bafta film award'
and lower(ma.result)='won';",2018-08-29 21:57:17.07507+10,8,1,110,correct
5841,"SELECT id, first_name,last_name
FROM person p
WHERE p.year_born = (SELECT MAX(p1.year_born)
	FROM person p1);",2018-08-29 21:57:24.954549+10,7,1,340,correct
5842,"select count(*)
from person 
where id not in(
	select id 
	from director);",2018-08-29 21:57:38.863713+10,12,1,109,correct
5843,"select r.id
from appearance a natural join role r
where lower(a.title) = 'psycho'
and a.production_year = 1960
group by r.id
having count(*) = 1;
",2018-08-29 21:57:39.949211+10,10,1,76,correct
5844,"SELECT id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born)
       FROM person
	   WHERE year_born <(SELECT MAX(year_born)
       FROM person));",2018-08-29 21:57:55.561904+10,3,1,366,correct
5845,"select distinct id, first_name, last_name
from person p natural join director natural join writer
group by id
having count(*) > 1;",2018-08-29 21:59:03.459007+10,4,1,109,correct
5846,"SELECT DISTINCT p.id, first_name, last_name
FROM PERSON AS p, DIRECTOR NATURAL JOIN WRITER
WHERE p.id IN (SELECT id
FROM DIRECTOR NATURAL JOIN WRITER
GROUP BY id
HAVING COUNT(*)>1);",2018-08-29 21:59:10.323494+10,4,1,96,correct
5847,"SELECT d.id, da.award_name, da.year_of_award, da.category
 FROM DIRECTOR d NATURAL JOIN DIRECTOR_AWARD da
 WHERE LOWER(da.result) = 'nominated';",2018-08-29 21:59:46.530864+10,13,1,98,correct
5848,"select count(*)
from writer_award wa, person p
where wa.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award>1990
and wa.year_of_award<1996;",2018-08-29 22:01:18.01025+10,9,0,110,partially correct
5849,"select title, production_year
from person natural join writer
where lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-29 22:01:18.100401+10,5,1,109,correct
5850,;,2018-08-29 22:01:27.758575+10,3,0,132,noninterpretable
5851,"select id, first_name,last_name
from person
where year_born=(
	select max(year_born)
	from person);",2018-08-29 22:02:08.745924+10,7,1,109,correct
5852,"select count(*)
from writer_award wa, person p
where wa.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award>1990
and wa.year_of_award<1996
and lower(wa.result)='won';",2018-08-29 22:03:16.722016+10,9,1,110,correct
5853,"select title, production_year, first_name, last_name
from movie_award natural join person natural join director 
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-29 22:04:33.452175+10,8,1,109,correct
5854,"WITH s_person as(
SELECT max(ct),id
FROM(SELECT id, count(*) ct
FROM role
GROUP by id))
SELECT p.first_name, p.last_name, r.title,r.production_year,r.description
from role r inner join person p on r.id=p.id
WHERE r.id IN (select id from s_person);",2018-08-29 22:04:52.040003+10,15,1,143,correct
5855,"select count(*)
from person natural join writer_award
where lower(first_name) = 'woody' 
	and lower(last_name) = 'allen' 
	and (year_of_award between 1991 and 1995) 
	and lower(result) = 'won';",2018-08-29 22:06:23.089703+10,9,1,109,correct
5856,;,2018-08-29 22:06:32.278617+10,8,0,195,noninterpretable
5857,"select count(*)
from movie as m
where NOT EXISTS 
( select title, production_year from movie_award as ma where ma.title=m.title AND ma.production_year=m.production_year AND lower(ma.result)=""won"" )
AND NOT EXISTS
( select title, production_year from crew_award as ca where ca.title=m.title AND ca.production_year=m.production_year  AND lower(ca.result)=""won"")
AND NOT EXISTS
( select title, production_year from director_award as da where da.title=m.title AND da.production_year=m.production_year  AND lower(da.result)=""won"")
AND NOT EXISTS
( select title, production_year from writer_award as wa where wa.title=m.title AND wa.production_year=m.production_year  AND lower(wa.result)=""won"")
AND NOT EXISTS
( select title, production_year from actor_award as aa where aa.title=m.title AND aa.production_year=m.production_year  AND lower(aa.result)=""won"")
; 
",2018-08-29 22:06:40.997644+10,11,1,31,correct
5858,"SELECT aw.title, aw.production_year, aw.first_name, aw.last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) AS aw
WHERE lower(aw.award_name) = 'bafta film award'
AND lower(aw.category) = 'best film';",2018-08-29 22:06:48.8868+10,8,0,340,partially correct
5859,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE award_name='BAFTA Film Award' and category = 'best film' and result = 'won';",2018-08-29 22:07:01.76253+10,8,1,406,correct
5860,"select 
	id 
from 
	appearance natural join role 
where 
	title = 'Psycho'
	and production_year = 1960
group by 
	id
having
	count(*) = 1;",2018-08-29 22:07:48.764673+10,10,1,109,correct
5861,"SELECT ma.title,ma.production_year,p.first_name,p.last_name FROM movie_award ma,director d,
person p
WHERE lower(ma.award_name)='bafta film award' AND ma.category='best film' AND lower(result)='won'
AND ma.title=d.title AND ma.production_year=d.production_year AND p.id=d.id;",2018-08-29 22:08:25.072517+10,8,1,95,correct
5862,"

SELECT director.id, director_award.award_name, director_award.category,director_award.year_of_award
      FROM director_award, director,person
      WHERE director_award.result = 'nominated' AND director_award.title = director.title 
      AND director_award.production_year = director.production_year AND director.id = person.id
      GROUP BY director.id
      HAVING COUNT(*)>=1;
      




",2018-08-29 22:08:59.132037+10,13,1,165,correct
5863,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE d.title=da.title 
AND d.production_year=da.production_year 
AND da.result='dominated'
AND d.id NOT IN(
	SELECT id
	FROM director d, director_award da
	WHERE d.title=da.title
	AND d.production_year=da.production_year
	AND lower(da.result)='won');
",2018-08-29 22:09:03.703306+10,13,0,124,partially correct
5864,"SELECT daa.id, daa.award_name, daa.year_of_award, daa.categories
FROM (SELECT p.id, da.award_name, da.year_of_award, da.categories, da.result
FROM director_award da, person p, director d
WHERE p.id = d.id
AND d.title = da.title
AND d.production_year = da.production_year)AS daa
WHERE NOT EXISTS( daa.result ='won');
",2018-08-29 22:09:31.505683+10,13,0,366,noninterpretable
5865,"SELECT aw.title, aw.production_year, aw.first_name, aw.last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) AS aw
WHERE lower(aw.award_name) = 'bafta film award'
AND lower(aw.category) like 'best film%';",2018-08-29 22:09:33.258283+10,8,0,340,partially correct
5866,"

SELECT director.id, director_award.award_name,director_award.year_of_award,director_award.category
      FROM director_award, director,person
      WHERE director_award.result = 'nominated' AND director_award.title = director.title 
      AND director_award.production_year = director.production_year AND director.id = person.id
      GROUP BY director.id
      HAVING COUNT(*)>=1;
      




",2018-08-29 22:10:16.516108+10,13,1,165,correct
5867,"select description from appearance
where title= 'Psycho'
group by description
having count(*)=1;",2018-08-29 22:10:22.598429+10,10,0,323,partially correct
5868,"SELECT aw.title, aw.production_year, aw.first_name, aw.last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) AS aw
WHERE lower(aw.award_name) = 'bafta film award'
AND lower(aw.category) like 'best film%'
AND lower(aw.result) = 'won';",2018-08-29 22:10:47.455789+10,8,0,340,partially correct
5957,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991;
",2018-08-29 22:56:54.20894+10,2,0,369,partially correct
5958,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;
",2018-08-29 22:57:38.585308+10,2,1,369,correct
5869,"SELECT 
	d.id, 
	da.award_name, 
	da.year_of_award, 
	da.category
FROM 
	director d, 
	director_award da
WHERE 
	d.title=da.title 
	AND d.production_year=da.production_year 
	AND lower(da.result)='nominated'
	AND d.id NOT IN(
		SELECT id
		FROM director d, director_award da
		WHERE d.title=da.title
		AND d.production_year=da.production_year
		AND lower(da.result)='won');
",2018-08-29 22:10:53.560692+10,13,1,124,correct
5870,"SELECT aw.title, aw.production_year, aw.first_name, aw.last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) AS aw
WHERE lower(aw.award_name) = 'bafta film award'
AND lower(aw.category) = 'best film'
AND lower(aw.result) = 'won';",2018-08-29 22:11:04.425902+10,8,1,340,correct
5871,;,2018-08-29 22:11:24.212958+10,3,0,306,noninterpretable
5872,select;,2018-08-29 22:11:41.369191+10,14,0,364,noninterpretable
5873,"SELECT x.id
FROM (SELECT x1.id,count(*) AS NoOfWorkedON
	FROM (SELECT d.id,d.title,d.production_year
		FROM director d
		UNION
		SELECT w.id,w.title,w.production_year
		FROM writer w) x1
	GROUP BY x1.id)x
WHERE X.NoOfWorkedON = (
	SELECT MAX(x2.NoOfWorkedON)
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM(
		SELECT d.id,d.title,d.production_year
		FROM director d
		UNION
		SELECT w.id,w.title,w.production_year
		FROM writer w)x1
	GROUP BY x1.id)x2
);",2018-08-29 22:11:48.807949+10,14,1,343,correct
5874,"select COUNT (noaward.title)
from (select noaward.title from movie movie_award,crew_award,director_award,writer_award, actor_award)as noaward
where existis 
noaward.tittle=movie.title
and title <>movie_award.title
and title <>crew_award.title
and title<>director_award.title
and title<>writer_award.title
and title<> actor_award.title);",2018-08-29 22:12:27.757672+10,11,0,351,noninterpretable
5875,"SELECT x.id
FROM (SELECT x1.id,count(*) AS numberofworked
	FROM (SELECT d.id,title,production_year
	FROM director d 
	UNION
	SELECT w.id,title,production_year
	FROM writer w)x1
	GROUP BY x1.id)x
WHERE x.numberofworked = 
				  (SELECT MAX(x2.numberofworked)
				  FROM (SELECT x1.id,count(*) AS numberofworked
				  	   FROM (SELECT d.id,title,production_year
							FROM director d 
							UNION
							SELECT w.id,title,production_year
							FROM writer w)x1
				  GROUP BY x1.id)x2);
",2018-08-29 22:14:25.486212+10,14,1,49,correct
5876,"SELECT m1.title,m1.production_year,p.first_name,p.last_name
FROM
(SELECT title,production_year
FROM MOVIE_AWARD m
WHERE lower(m.award_name)='bafta film award' AND lower(m.category)='best film'
AND lower(m.result)='won') m1, director d, person p
WHERE m1.title = d.title AND m1.production_year=d.production_year AND d.id=p.id;
",2018-08-29 22:15:03.735249+10,8,1,195,correct
5877,"

SELECT director.id, director_award.award_name,director_award.year_of_award,director_award.category
FROM director_award, director,person
WHERE director_award.result = 'nominated' AND director_award.title = director.title 
      AND director_award.production_year = director.production_year AND director.id = person.id
	AND director.id NOT IN (SELECT director.id
                              FROM director_award, director,person
                              WHERE director_award.result = 'won' AND director_award.title = director.title 
                              AND director_award.production_year = director.production_year AND director.id = person.id)
GROUP BY director.id
HAVING COUNT(*)>=1;
      




",2018-08-29 22:15:26.940174+10,13,1,165,correct
5878,"SELECT Count(*)
FROM writer_award natural join person natural join writer
WHERE year_of_award >1990 and year_of_award <1996 and first_name = 'Woody' and last_name = 'Allen';",2018-08-29 22:16:35.785607+10,9,0,406,partially correct
5879,"select id,award_name,year_of_award,category from  director as d, director_award as da
where d.title = da.title
and d.production_year = da.production_year
and da.result = 'nominated';
",2018-08-29 22:17:50.191729+10,13,1,92,correct
5880,"SELECT title, production_year
FROM writer
WHERE writer.id IN (SELECT id
FROM person
WHERE first_name = Kevin AND last_name = Williamson);",2018-08-29 22:18:09.722564+10,5,0,96,noninterpretable
5881,"SELECT count(*)
FROM writer_award natural join person natural join writer
WHERE year_of_award >1990 and year_of_award <1996 and first_name = 'Woody' and last_name = 'Allen' and result = 'won';",2018-08-29 22:18:10.907245+10,9,1,406,correct
5882,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-29 22:18:23.528166+10,10,1,323,correct
5883,"select d.id,da.award_name,da.year_of_award,da.category from director as d, director_award as da 
where
d.title=da.title AND
d.production_year = da.production_year AND
lower(da.result)=""won"" 
Group by d.id
Having count(*)>1 
;",2018-08-29 22:19:01.699077+10,13,0,31,partially correct
5884,"SELECT count(*) as number_of_award
FROM writer_award natural join person natural join writer
WHERE year_of_award >1990 and year_of_award <1996 and first_name = 'Woody' and last_name = 'Allen' and result = 'won';",2018-08-29 22:19:08.819023+10,9,1,406,correct
5885,"SELECT title,production_year
FROM MOVIE_AWARD m
WHERE m.category='Best Film' AND award_name=""BAFTA Film Award"" AND result='won'
UNION
SELECT first_name,last_name
FROM DIRECTOR d,PERSON p,MOVIE m
WHERE d.title=m.title AND d.production_year = m.production_year AND d.id=p.id;",2018-08-29 22:19:47.676119+10,8,0,368,partially correct
5886,;,2018-08-29 22:21:39.251231+10,8,0,139,noninterpretable
5887,"select d.id,da.award_name,da.year_of_award,da.category from director as d, director_award as da 
where
d.title=da.title AND
d.production_year = da.production_year AND
lower(da.result)=""nominated"" 
Group by d.id
Having count(*)>=1 
;",2018-08-29 22:21:58.931319+10,13,1,31,correct
5888,"SELECT title, production_year
FROM writer
WHERE writer.id IN (SELECT id
FROM person
WHERE first_name = 'Kevin' AND last_name = 'Williamson');",2018-08-29 22:22:03.147502+10,5,1,96,correct
5889,"SELECT id
 FROM(
  SELECT *, COUNT(*) AS count
  FROM
  PERSON p NATURAL JOIN WRITER w NATURAL JOIN DIRECTOR d
  GROUP BY p.id)
 WHERE count IN(
  SELECT MAX(count) FROM(SELECT *, COUNT(*) AS count
  FROM
  PERSON p NATURAL JOIN WRITER w NATURAL JOIN DIRECTOR d
  GROUP BY p.id));",2018-08-29 22:24:02.751826+10,14,0,98,partially correct
5890,"SELECT COUNT(wa.result) FROM writer_award wa
INNER JOIN person p
ON p.id=wa.id
WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen' 
AND wa.production_year >= 1991 AND wa.production_year <= 1995
AND lower(wa.result) ='won';


",2018-08-29 22:24:35.496129+10,9,0,95,partially correct
5891,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower(da.result) ='nominated'
AND d.id NOT IN(SELECT id
                FROM director d, director_award da
				WHERE d.title = da.title
				AND d.production_year =da.production_year
				AND lower(da.result) = 'won');",2018-08-29 22:24:42.079481+10,13,1,366,correct
5892,"SELECT p.first_name,p.lastname,r.title,r.production_year,r.description
FROM (
	SELECT r.title,r.production_role
	FROM role r, movie m
	WHERE r.title = m.title
		AND r.production_role = m.production_role
	
)x
WHERE(

)

;
",2018-08-29 22:24:55.66954+10,15,0,343,noninterpretable
5893,"SELECT COUNT(*)
FROM writer_award w 
WHERE 1991<=w.year_of_award AND w.year_of_award<=1995 AND w.id=(SELECT id FROM person WHERE lower(first_name)='woody' AND lower(last_name)='allen');",2018-08-29 22:25:14.854194+10,9,0,195,partially correct
5919,"select id from
(select distinct (title), count (id) as cid, id from 
(select distinct d.id, m.title, m.production_year from movie as m, director as d
where m.title = d.title
and m.production_year = d.production_year
Union
select distinct w.id, m.title, m.production_year from movie as m, writer as w
where m.title = w.title
and m.production_year = w.production_year)
group by id)
where cid>2;
",2018-08-29 22:40:09.416842+10,14,1,92,correct
6046,"SELECT production_year, COUNT(*) FROM movie WHERE movie.production_year BETWEEN 1991 AND 1993;",2018-08-30 00:00:59.922432+10,2,0,393,partially correct
5894,"select COUNT (m.title)
from movie m
where not exists
(select title, production_year from movie_award ma
where ma.result='won' 
and m.title=ma.title
and m.production_year=m.production_year
Union
select title, production_year from crew_award ca
where ca.result='won'
and m.title=ca.title
and m.production_year=ca.production_year
union 
select title, production_year from director_award da
where da.result='won'
and da.title=m.title
and da.production_year=m.production_year
union
select title, production_year from writer_award wa
where wa.result='won'
and m.title=wa.title
and m.production_year=wa.production_year
union 
select title, production_year from actor_award aa
where aa.result='won'
and m.title=aa.title
and m.production_year=aa.production_year);
",2018-08-29 22:26:28.693777+10,11,0,351,partially correct
5895,"SELECT country
FROM restriction
WHERE lower (title) = shakespeare in love AND lower(description) = 'm';",2018-08-29 22:26:44.196109+10,6,0,96,noninterpretable
5896,"SELECT id
FROM appearance natural join role
WHERE scene_no < 2 and title ='Psycho';",2018-08-29 22:26:44.684374+10,10,0,406,partially correct
5897,"SELECT COUNT(*)
FROM person,writer
WHERE year_born='1935'
AND writer.id=person.id;",2018-08-29 22:27:02.082947+10,1,0,369,partially correct
5898,"select count(movie.title)
from movie
where not exists(select movie.title
   from movie_award m,crew_award c,director_award d,writer_award w,actor_award a
   where(m.title=movie.title and m.production_year=movie.production_year)
    or(m.title=movie.title and m.production_year=movie.production_year)
    or(c.title=movie.title and c.production_year=movie.production_year)
    or(d.title=movie.title and d.production_year=movie.production_year)
    or(w.title=movie.title and w.production_year=movie.production_year)
    or(a.title=movie.title and a.production_year=movie.production_year)
);",2018-08-29 22:28:13.346382+10,11,0,414,partially correct
5899,"SELECT COUNT(*)
FROM writer_award w, person 
WHERE 1991<=w.year_of_award AND w.year_of_award<=1995 AND lower(RESULT)= 'won' AND w.id=(SELECT id FROM person WHERE lower(first_name)='woody' AND lower(last_name)='allen');",2018-08-29 22:28:38.933951+10,9,0,195,partially correct
5900,"select count(*)
from movie m
where not exists(select title, production_year
from movie_award ma
where ma.title=m.title and
      ma.production_year=m.production_year and
      lower(ma.result)='won'
union
select title, production_year 
from crew_award ca
where ca.title=m.title and
      ca.production_year=m.production_year and
      lower(ca.result)='won'
union
select title, production_year 
from director_award da
where da.title=m.title and
      da.production_year=m.production_year and
      lower(da.result)='won'
union
select title, production_year 
from writer_award wa
where wa.title=m.title and
      wa.production_year=m.production_year and
      lower(wa.result)='won'
union
select title, production_year 
from actor_award aa
where aa.title=m.title and
      aa.production_year=m.production_year and
      lower(aa.result)='won');",2018-08-29 22:29:18.342034+10,11,1,300,correct
5901,"SELECT COUNT(*)
FROM writer_award w
WHERE 1991<=w.year_of_award AND w.year_of_award<=1995 AND lower(RESULT)= 'won' AND w.id=(SELECT id FROM person WHERE lower(first_name)='woody' AND lower(last_name)='allen');",2018-08-29 22:29:20.966269+10,9,1,195,correct
5902,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id=person.id AND person.year_born=1935);
",2018-08-29 22:30:03.552674+10,1,1,369,correct
5903,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-29 22:30:46.2367+10,6,1,96,correct
5904,"select id,year_born
from person
group by year_born
having (year_born=1988);",2018-08-29 22:31:03.427218+10,3,0,181,partially correct
5905,"SELECT id
FROM;",2018-08-29 22:31:05.106127+10,14,0,366,noninterpretable
5906,"SELECT COUNT(*)
FROM (writer_award NATURAL JOIN person) AS wa
WHERE lower(wa.first_name) = 'woody'
AND lower(wa.last_name) = 'allen'
AND wa.year_of_award > '1990'
AND wa.year_of_award < '1996'
AND lower(wa.result) = 'won';",2018-08-29 22:31:52.729946+10,9,1,340,correct
5907,select id from person;,2018-08-29 22:32:06.325288+10,3,0,238,partially correct
5908,select id from person;,2018-08-29 22:32:14.317913+10,3,0,238,partially correct
5909,;,2018-08-29 22:33:22.536314+10,10,0,195,noninterpretable
5910,"select COUNT (m.title)
from movie m
where not exists
(select title, production_year from movie_award ma
where lower(ma.result)='won' 
and m.title=ma.title
and m.production_year=m.production_year
Union
select title, production_year from crew_award ca
where lower(ca.result)='won'
and m.title=ca.title
and m.production_year=ca.production_year
union 
select title, production_year from director_award da
where lower(da.result)='won'
and da.title=m.title
and da.production_year=m.production_year
union
select title, production_year from writer_award wa
where lower(wa.result)='won'
and m.title=wa.title
and m.production_year=wa.production_year
union 
select title, production_year from actor_award aa
where lower(aa.result)='won'
and m.title=aa.title
and m.production_year=aa.production_year);
",2018-08-29 22:33:56.781915+10,11,1,351,correct
5911,"select count(movie.title)
from movie
where not exists(select movie.title
   from movie_award m,crew_award c,director_award d,writer_award w,actor_award a
   where(m.title=movie.title and m.production_year=movie.production_year)
    or(m.title=movie.title and m.production_year=movie.production_year)
    or(c.title=movie.title and c.production_year=movie.production_year)
    or(d.title=movie.title and d.production_year=movie.production_year)
    or(w.title=movie.title and w.production_year=movie.production_year)
    or(a.title=movie.title and a.production_year=movie.production_year)
);",2018-08-29 22:33:59.239803+10,11,0,414,partially correct
5912,"select id
from person
group by year_born
having (year_born=1988);",2018-08-29 22:34:39.079594+10,3,0,181,cheating
5913,"select max(tcount.cid), tcount.id from
((select distinct (title), count(id) as cid, id from 
(select distinct d.id, m.title, m.production_year from movie as m, director as d
where m.title = d.title
and m.production_year = d.production_year
Union
select distinct w.id, m.title, m.production_year from movie as m, writer as w
where m.title = w.title
and m.production_year = w.production_year))) as tcount;
",2018-08-29 22:35:27.569959+10,14,0,92,partially correct
5914,"select count(*)
from movie m
where m.title not in(
	select title
	from movie_award natural join movie
	where lower(result) = 'won' 
	union
	select title
	from actor_award aa 
	where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	union
	select title
	from director_award natural join movie wa
	where lower(result) = 'won'
	union
	select title
	from crew_award natural join movie
	where lower(result) = 'won'
	union
	select title
	from writer_award natural join movie
	where lower(result) = 'won'
);",2018-08-29 22:35:55.063068+10,11,1,109,correct
5915,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM (SELECT title,production_year
FROM movie_award
WHERE lower(award_name)='bafta film award' AND lower(category)= 'best film' AND lower(RESULT)= 'won') AS ma,
director AS d,
person AS p
WHERE ma.title=d.title AND ma.production_year = d.production_year AND d.id=p.id;

",2018-08-29 22:36:46.793774+10,8,1,368,correct
5916,"select id, first_name, last_name
from person p
where (select w.id, w.title from writer w) natural join (select d.id, d.title from director d);",2018-08-29 22:36:48.612872+10,4,0,357,noninterpretable
5917,"SELECT 
  COUNT(*) 
FROM
(
SELECT 
DISTINCT
  p.id
FROM person p, writer w 
WHERE 
p.year_born = 1935
AND p.id = w.id
) AS writers_born;",2018-08-29 22:37:04.822901+10,1,1,413,correct
5918,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(SELECT MAX(year_born)
FROM person);",2018-08-29 22:38:10.29281+10,7,1,96,correct
5955,"select mw.title, mw.production_year
from (person p natural join movie natural join writer) as mw
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-29 22:56:13.24015+10,5,1,357,correct
5920,"select sub1.id
from
(select d1.id,d1.title,d1.production_year
from 	director d1
		Union
select w1.id,w1.title,w1.production_year
from	writer w1) as sub1
group by sub1.id
having count(*) = (select max(num)
			from

			  (select count(*) as num
			  from
			  (select d1.id,d1.title,d1.production_year
			  from 	director d1
					  Union
			  select w1.id,w1.title,w1.production_year
			  from	writer w1) as sub
			  group by sub.id));


",2018-08-29 22:40:14.529223+10,14,1,43,correct
5921,"select id from person
where year_born =(select MAX(year_born) from person
where year_born< (select MAX(year_born) from person));",2018-08-29 22:40:45.009352+10,3,1,238,correct
5922,"select count(*)
from movie m
where m.title not in(
	select title
	from movie_award natural join movie
	where lower(result) = 'won' 
	union
	select title
	from actor_award aa natural join movie
	where lower(aa.result) = 'won'
	union
	select title
	from director_award natural join movie wa
	where lower(result) = 'won'
	union
	select title
	from crew_award natural join movie
	where lower(result) = 'won'
	union
	select title
	from writer_award natural join movie
	where lower(result) = 'won'
);",2018-08-29 22:41:31.508744+10,11,0,109,partially correct
5923,"select dw.id, dw.first_name, dw.last_name 
from (person natural join director natural join writer) as dw 
group by dw.id
having count(*) > 1;",2018-08-29 22:42:14.835669+10,4,1,357,correct
5924,"select id,award_name,year_of_award,category
from director_award da,director d
where da.title=d.title
and da.production_year=d.production_year
and lower(result)='nominated';",2018-08-29 22:43:47.542342+10,13,1,22,correct
5925,"select id
from person
where year_born = (
	select max(year_born)
	from person
	where year_born <(
		select max(year_born)
		from person));
",2018-08-29 22:44:15.245896+10,3,1,109,correct
5926,"SELECT SUM(WRITER.id)
FROM WRITER 
INNER JOIN PERSON ON WRITER.id = PERSON.id
WHERE year_born = 1935;",2018-08-29 22:44:41.367426+10,1,0,225,partially correct
5927,"
SELECT PERSON.first_name, PERSON.last_name, BF.title, BF.production_year
from (SELECT title, production_year 
from MOVIE_AWARD
WHERE MOVIE_AWARD.award_name=""BAFTA Film Award"" 
and MOVIE_AWARD.category=""best film""
and MOVIE_AWARD.result=""won"") AS BF, PERSON, DIRECTOR
WHERE BF.title=DIRECTOR.title
and BF.production_year = DIRECTOR.production_year
and DIRECTOR.id = PERSON.id;
",2018-08-29 22:45:17.172207+10,8,1,139,correct
5928,"SELECT COUNT(year_born)
FROM person,writer
WHERE person.id=writer.id;",2018-08-29 22:45:58.994329+10,1,0,395,partially correct
5929,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-29 22:46:06.309365+10,14,1,98,correct
5930,"select count(*)from movie m
where m.title not in
(select title from movie_award
union
select title from crew_award
union
select title from director_award
union
select title from writer_award
union
select title from actor_award
group by title);",2018-08-29 22:46:06.321324+10,11,0,323,partially correct
5931,"
SELECT BF.title, BF.production_year, PERSON.first_name, PERSON.last_name 
from (SELECT title, production_year 
from MOVIE_AWARD
WHERE MOVIE_AWARD.award_name=""BAFTA Film Award"" 
and MOVIE_AWARD.category=""best film""
and MOVIE_AWARD.result=""won"") AS BF, PERSON, DIRECTOR
WHERE BF.title=DIRECTOR.title
and BF.production_year = DIRECTOR.production_year
and DIRECTOR.id = PERSON.id;
",2018-08-29 22:46:26.487749+10,8,1,139,correct
5932,"select id, award_name, year_of_award, category
from director natural join director_award
where lower(result) = 'nominated' and 
id not in(
	select id 
	from director natural join director_award
	where lower(result) = 'won');",2018-08-29 22:46:49.929364+10,13,1,109,correct
5933,"select a.id,a.award_name,a.year_of_award,a.category,a.result
from(director_award left join director) as a;
",2018-08-29 22:47:04.018182+10,13,0,181,partially correct
5934,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 22:47:04.418764+10,11,1,165,correct
5935,"select p.first_name, p.last_name, r.title, r.production_year, r.description from person p, role r,
  (select max(cid), id from
  (select distinct count(id) as cid, id
  from role group by id)) as cid
where p.id = r.id
and p.id = cid.id;",2018-08-29 22:47:43.382174+10,15,1,92,correct
5936,"select mw.title, mw.production_year
from (person p natural join movie natural join writer) as mw
where p.first_name like 'Williamson' and p.last_name like 'Kevin';",2018-08-29 22:48:42.782111+10,5,0,357,partially correct
5937,"select count (*) from (select distinct p.id from person p ,writer w where p.id = w.id and year_born= '1938')as writer ; 
",2018-08-29 22:48:48.658581+10,1,0,412,partially correct
5938,;,2018-08-29 22:49:02.557388+10,13,0,132,noninterpretable
5939,"select count (*) from (select distinct p.id from person p ,writer w where p.id = w.id and year_born= '1935')as writer ; 
",2018-08-29 22:49:14.868267+10,1,1,412,correct
5940,"select id,award_name,year_of_award,category from director_award da,director d
where(
d.title=da.title and
d.production_year=da.production_year and
da.result = ""nominated""
);",2018-08-29 22:50:24.909626+10,13,1,238,correct
5941,"select p.first_name,p.last_name,r.*
from (select r.id from role as r group by r.id where count(*)>any count(*);",2018-08-29 22:50:54.940077+10,15,0,223,noninterpretable
5942,;,2018-08-29 22:51:20.622328+10,1,0,383,noninterpretable
5943,SELECT COUNT(*) from person WHERE year_born=1935 AND id IN(SELECT id FROM WRITER);,2018-08-29 22:51:23.642688+10,1,1,408,correct
5944,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-29 22:51:50.709695+10,1,1,383,correct
5945,"select id,award_name,year_of_award,category from director_award da,director d
where(
d.title=da.title and
d.production_year=da.production_year and
da.result = ""nominated"" and
d.id not in(
	select id from director_award da,director d
	where d.title=da.title and
	d.production_year=da.production_year and
	da.result = ""won"" )
);",2018-08-29 22:53:06.406101+10,13,1,238,correct
5946,"select count(*)
from writer
inner join person on person.id=writer.id
where person.year_born='1935';",2018-08-29 22:53:53.122036+10,1,0,349,partially correct
5947,"select m.production_year,count(*)
from movie as m
where m.production_year>1990 and m.production_year<1994;",2018-08-29 22:54:18.588071+10,2,0,223,partially correct
5948,"SELECT PRODUCTION_YEAR ,COUNT(*) FROM MOVIE WHERE PRODUCTION_YEAR BETWEEN 1991 AND 1993 GROUP BY PRODUCTION_YEAR;",2018-08-29 22:54:23.407979+10,2,1,408,correct
5949,;,2018-08-29 22:55:00.107265+10,11,0,195,noninterpretable
5950,SELECT count(*) FROM person p WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);,2018-08-29 22:55:35.448799+10,1,1,161,correct
5951,"SELECT *
FROM appearance;",2018-08-29 22:55:43.983032+10,10,0,406,partially correct
5952,"select id
from  (role natural join appearance) as ra
where lower(title) = lower('Psycho') and production_year = 1960
group by id having count(scene_no) = 1;",2018-08-29 22:56:01.110404+10,10,1,347,correct
5953,SELECT COUNT (*) FROM PERSON P where year_born = 1935 and exists (SELECT * from writer W where P.ID = W.ID) ;,2018-08-29 22:56:02.427697+10,1,1,415,correct
5954,SELECT COUNT(*) FROM PERSON WHERE ID NOT IN (SELECT ID FROM DIRECTOR);,2018-08-29 22:56:08.906559+10,12,1,408,correct
5959,;,2018-08-29 22:58:00.52954+10,3,0,195,noninterpretable
5960,"select count (*)
from person p
where exists (select *  from writer w where w.id=p.id and p.year_born='1935');",2018-08-29 22:58:15.088013+10,1,1,349,correct
5961,"WITH acs AS(SELECT id,COUNT(*) AS count
	FROM (appearance NATURAL JOIN role NATURAL JOIN person)
	WHERE lower(title) = 'psycho'
		AND production_year = '1960'
	GROUP BY id)
SELECT acs.id
FROM acs
WHERE acs.count = 1;",2018-08-29 22:58:59.724775+10,10,1,340,correct
5962,"SELECT COUNT(DISTINCT W.ID) FROM writer w, PERSON p WHERE w.id = p.id AND p.year_born = 1935;",2018-08-29 22:59:14.642782+10,1,1,161,correct
5963,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-29 23:00:07.314957+10,6,1,357,correct
5964,"select count(*)
from person as p 
where not EXISTS (select * from director as d where d.id=p.id);",2018-08-29 23:00:17.059135+10,12,1,223,correct
5965,FDWERE;,2018-08-29 23:00:19.453921+10,4,0,408,noninterpretable
5966,"select count(m.production_year)
from movie m
where (m.production_year='1993')
group by m.production_year
union
select count(m.production_year)
from movie m
where (m.production_year='1992')
group by m.production_year
union
select count(m.production_year)
from movie m
where (m.production_year='1991')
group by m.production_year;",2018-08-29 23:00:21.792828+10,2,0,349,partially correct
5967,;,2018-08-29 23:01:29.825031+10,13,0,195,noninterpretable
5968,"select m.production_year, count(m.production_year)
from movie m
where (m.production_year='1993')
group by m.production_year
union
select m.production_year, count(m.production_year)
from movie m
where (m.production_year='1992')
group by m.production_year
union
select m.production_year, count(m.production_year)
from movie m
where (m.production_year='1991')
group by m.production_year;",2018-08-29 23:01:51.346885+10,2,1,349,correct
5969,"Which crew members have worked on a movie that has won the greatest number of movie awards? Give
the ids of the crew members.

select id from crew
where;",2018-08-29 23:04:31.126812+10,14,0,238,noninterpretable
5970,"select d.id, da.award.name ,da.year_of_award,da.category from director d, directer_award da where d.title=da.title and lower(da.result)!='won' and count(*) from director_award where (*) >=1;",2018-08-29 23:04:36.478849+10,13,0,306,noninterpretable
5971,"

select id from crew
;",2018-08-29 23:04:45.79956+10,14,0,238,partially correct
5972,"select id
from appearance natural join  role as h
where lower(h.title) = 'psycho'
AND h.production_year = 1960
GROUP BY
    h.id
HAVING
    count(*) = 1;",2018-08-29 23:05:59.376561+10,10,1,138,correct
5973,"select t3.id  from (select max(most1+most),t1.id from (select count(*) as most1,id from writer group by id ) as t join
(select count(*) as most,id from director group by id) as t1  on t1.id=t.id ) as t3;",2018-08-29 23:06:27.605494+10,14,0,16,partially correct
5974,"SELECT id
 FROM
  (SELECT *, COUNT(*) AS count
    FROM(
      SELECT w.id, title, production_year
        FROM WRITER w
      UNION
      SELECT d.id,title, production_year
        FROM DIRECTOR d) wd
    GROUP BY wd.id)
WHERE count = (SELECT MAX(count) 
  FROM
  (SELECT *, COUNT(*) AS count
    FROM(
      SELECT w.id, title, production_year
        FROM WRITER w
      UNION
      SELECT d.id,title, production_year
        FROM DIRECTOR d) wd
    GROUP BY wd.id));",2018-08-29 23:07:01.562067+10,14,1,98,correct
5975,"SELECT P.id,count(*)
FROM person p,writer w,director d
WHERE w.id=p.id ;",2018-08-29 23:07:24.129911+10,14,0,195,partially correct
5976,"SELECT COUNT(*)
FROM person,director
WHERE person.id=director.id;",2018-08-29 23:07:59.021665+10,12,0,369,partially correct
5977,"SELECT production_year,COUNT(*)
FROM movie
WHERE production_year between 1991 and 1993
GROUP BY production_year;
",2018-08-29 23:09:47.725963+10,2,1,395,correct
5978,"select count(*)
from person p
where not exists
(
	select d.id
	from director d
	where d.id=p.id
);",2018-08-29 23:10:37.725908+10,12,1,349,correct
5979,"SELECT person.first_name, person.last_name
FROM scene, movie,person,crew
WHERE scene.title = 'Psycho' AND scene.production_year = '1960' AND scene.title = movie.title 
AND scene.production_year = movie.production_year AND person.id = crew.id AND crew.title = movie.title 
AND movie.production_year = crew.production_year
GROUP BY scene.title
HAVING COUNT(*) =1;
",2018-08-29 23:10:42.070061+10,10,0,165,partially correct
5980,"SELECT dm.id,da.award_name,da.year_of_award,da.category
FROM director_award AS da,(SELECT * FROM director,movie WHERE director.title=movie.title AND director.production_year=movie.production_year) AS dm
WHERE dm.title=da.title AND dm.production_year=da.production_year 
AND not exists (select * from da WHERE lower(result)=""won"");",2018-08-29 23:11:25.960019+10,13,0,216,noninterpretable
5981,"SELECT x.id FROM
(
SELECT X1.id,count(*) AS NoofworkedON
FROM (SELECT d.id,title,production_year
FROM director d 
UNION 
SELECT w.id,title,production_year
FROM writer w) x1
GROUP BY x1.id)x
WHERE x.NoofworkedON = (
SELECT MAX(X2.NoofworkedON) 
FROM 
(SELECT X1.id,count(*) AS NoofworkedON
FROM (SELECT d.id,title,production_year
FROM director d 
UNION 
SELECT w.id,title,production_year
FROM writer w) x1
GROUP BY x1.id)x2);",2018-08-29 23:13:28.385727+10,14,1,195,correct
5982,"select p.id
from person p
where p.year_born=(select max(year_born)
from person
group by year_born
having year_born < (select max(year_born)from person));",2018-08-29 23:14:57.702784+10,3,0,351,partially correct
5983,"Select P.first_name, P.last_name, R.title, R.production_year, R.description
From ROLE R natural join Person P
Where R.id = (Select id
From (Select R.id, COUNT(R.id) as time 
from ROLE R
   			Group by R.id)
Where time = (select max(time)
				From (Select count(R.id) as time
					From Role R
				Group by R.id)
				)
   );
",2018-08-29 23:15:00.169751+10,15,1,77,correct
5984,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS(SELECT *
     FROM director
     WHERE person.id=director.id);",2018-08-29 23:15:33.947424+10,12,1,369,correct
5985,"SELECT r.id
FROM scene s, appearance a, role r
WHERE s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY r.id 
HAVING count(*)=1;",2018-08-29 23:15:46.335387+10,10,1,406,correct
5986,"select p.id
from person p
where p.year_born=(select max(year_born)
from person
where year_born < (select max(year_born)from person));",2018-08-29 23:15:52.332384+10,3,1,351,correct
5987,"select id, first_name, last_name 
from person p
where  (year_born = min(year_born));",2018-08-29 23:17:14.384044+10,7,0,357,noninterpretable
5988,;,2018-08-29 23:18:24.415246+10,14,0,181,noninterpretable
5989,"select id, first_name, last_name 
from person p
where  (year_born = (select max(year_born) from person));",2018-08-29 23:18:55.946018+10,7,1,357,correct
5990,"SELECT COUNT(*)
FROM (SELECT*
FROM WRITER_AWARD
WHERE year_of_award >1990 AND year_of_award <1996)AS wa,
person AS p
WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND wa.id=p.id;",2018-08-29 23:20:15.114782+10,9,0,368,partially correct
5991,"SELECT COUNT(*)
FROM (SELECT*
FROM WRITER_AWARD
WHERE year_of_award >1990 AND year_of_award <1996)AS wa,
person AS p
WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND wa.id=p.id AND wa.result='won';",2018-08-29 23:21:21.931704+10,9,1,368,correct
5992,"SELECT first_name, last_name, title, production_year, description
 FROM(
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id)
WHERE count = (
 SELECT MAX(count) 
  FROM (
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id))
;",2018-08-29 23:22:07.350671+10,15,0,98,partially correct
5993,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-29 23:23:03.9549+10,15,1,98,correct
5994,"select count(*) 
from WRITER_AWARD
WHERE WRITER_AWARD.result=""won""
AND WRITER_AWARD.year_of_award <=1995
AND  WRITER_AWARD.year_of_award >1991
AND WRITER_AWARD.id = (select id 
                 from PERSON
                 WHERE PERSON.first_name=""Woody""
                 and PERSON.last_name=""Allen"");",2018-08-29 23:23:37.220213+10,9,0,139,partially correct
5996,select;,2018-08-29 23:24:10.788005+10,4,0,349,noninterpretable
5997,"SELECT p.first_name,p.last_name,role.title,role.production_year,role.description
FROM
(SELECT ROLE.id, COUNT(*) AS Noofrole
FROM ROLE
GROUP BY role.id) X,PERSON P, ROLE
WHERE ;",2018-08-29 23:24:30.722251+10,15,0,195,noninterpretable
5998,"select count(*) 
from WRITER_AWARD
WHERE WRITER_AWARD.result=""won""
AND WRITER_AWARD.year_of_award <=1995
AND  WRITER_AWARD.year_of_award >=1991
AND WRITER_AWARD.id = (select id 
                 from PERSON
                 WHERE PERSON.first_name=""Woody""
                 and PERSON.last_name=""Allen"");",2018-08-29 23:24:40.220722+10,9,1,139,correct
6000,"SELECT *
FROM movie;",2018-08-29 23:26:10.164422+10,11,0,406,partially correct
6001,"select pr.first_name, pr.last_name, pr.title, pr.production_year, pr.description 
from (person natural join role) as pr
where exists (select
x.id, count(*) as number_of_roles

from
(person natural join role) as x

where x.id = pr.id

group by
x.id

having
number_of_roles =(select max(number_of_roles) from(
						
					select count(*) as number_of_roles 
					
					from 
					(person natural join role)  group by id)))

;

",2018-08-29 23:26:22.926307+10,15,1,378,correct
6002,"select dw.id, dw.first_name, dw.last_name
from (person natural join writer natural join director) as dw
group by dw.id
having count(*)>1;",2018-08-29 23:26:52.504229+10,4,1,349,correct
6003,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT *
                 FROM director d
		      WHERE p.id=d.id);",2018-08-29 23:27:33.312278+10,12,1,106,correct
6004,"SELECT p.first_name,p.last_name,role.title,role.production_year,role.description
FROM
(SELECT ROLE.id, COUNT(*) AS Noofrole
FROM ROLE
GROUP BY role.id) X,PERSON P, ROLE
WHERE  p.id=x.id AND x.Noofrole IN 
(SELECT max(Noofrole)
        FROM (
                SELECT
                    id,
                    count ( * ) AS Noofrole
                FROM
                    ROLE
                GROUP BY
                    id ));",2018-08-29 23:27:55.315803+10,15,0,195,partially correct
6005,"SELECT p.first_name,p.last_name,role.title,role.production_year,role.description
FROM
(SELECT ROLE.id, COUNT(*) AS Noofrole
FROM ROLE
GROUP BY role.id) X,PERSON P, ROLE
WHERE  p.id=x.id AND x.Noofrole IN 
(SELECT max(Noofrole)
        FROM (
                SELECT
                    id,
                    count ( * ) AS Noofrole
                FROM
                    ROLE
                GROUP BY
                    id )AS A );",2018-08-29 23:29:45.721832+10,15,0,195,partially correct
6006,"SELECT person.id
FROM person,role,movie,(SELECT app.description AS name 
                        FROM(SELECT appearance.description
                             FROM appearance,scene
                             WHERE appearance.title ='Psycho' AND appearance.production_year = '1960' AND appearance.title = scene.title
                                   AND appearance.production_year = scene.production_year AND appearance.scene_no = scene.scene_no) AS app
                        GROUP BY name
                        HAVING COUNT(*)=1)
WHERE person.id =role.id AND role.description =name AND role.title = movie.title AND role.production_year =movie.production_year;",2018-08-29 23:30:10.133595+10,10,0,165,partially correct
6007,"SELECT p.first_name,p.last_name,role.title,role.production_year,role.description
FROM
(SELECT ROLE.id, COUNT(*) AS Noofrole
FROM ROLE
GROUP BY role.id) X,PERSON P, ROLE
WHERE  P.id = role.id AND p.id=x.id AND x.Noofrole IN 
(SELECT max(Noofrole)
        FROM (
                SELECT
                    id,
                    count ( * ) AS Noofrole
                FROM
                    ROLE
                GROUP BY
                    id ));",2018-08-29 23:30:23.367886+10,15,1,195,correct
6008,"select id, award_name, year_of_award, category
from director d , director_award da
where d.title=da.title
and d.production_year=da.production_year
and lower(result)<>'won';
",2018-08-29 23:30:43.49926+10,13,1,351,correct
6009,"SELECT count(*)
FROM movie m
WHERE not exists(SELECT title, production_year
			FROM movie_award ma
			WHERE lower(ma.result)='won' and ma.title = m.title and ma.production_year = m.production_year
			UNION
			SELECT title, production_year
			FROM crew_award ca
			WHERE lower(ca.result)='won' and ca.title = m.title and ca.production_year = m.production_year
			UNION
			SELECT title, production_year
			FROM director_award da
			WHERE lower(da.result)='won' and da.title = m.title and da.production_year = m.production_year
			UNION
			SELECT title, production_year
			FROM writer_award wa
			WHERE lower(wa.result)='won' and wa.title = m.title and wa.production_year = m.production_year
			UNION
			SELECT title, production_year
			FROM actor_award aa
			WHERE lower(aa.result)='won' and aa.title = m.title and aa.production_year = m.production_year);",2018-08-29 23:34:27.135964+10,11,1,406,correct
6010,"select b.id from(
select a.id,count(a.title) as work
from(
select id,title,production_year
from writer w
union
select id,title,production_year
from director d) as a
group by a.id) as b
where b.work=(select max(work) from
(select a1.id,count(a1.title) as work
from(
select id,title,production_year
from writer w
union
select id,title,production_year
from director d) as a1
group by a1.id))
;",2018-08-29 23:34:30.999383+10,14,1,230,correct
6011,"SELECT COUNT(*) FROM (SELECT DISTINCT person.id FROM person, writer WHERE person.id=writer.id AND year_born = 1935) ;
",2018-08-29 23:36:03.822935+10,1,1,196,correct
6012,"select id 
from Person
where year_born>=ALL(select year_born from person where id!=(select id from person where year_born>=all (select year_born from person)));",2018-08-29 23:36:19.254877+10,3,0,300,noninterpretable
6013,"select r.id from role r ,movie m where r.title= m.title and r.production_year=m.production_year
and lower(description)='director'or lower(description)='writer' or lower(description)='director and writer';",2018-08-29 23:37:12.293477+10,14,0,306,partially correct
6014,"select id from
(select a1.id, count(*) as num_of_movie
from (select id, title, production_year from director union select id, title, production_year from writer) as a1
group by a1.id
having num_of_movie = 
(select max(num_of_movie) from 
(select id, count(*) as num_of_movie
from (select id, title, production_year from director union select id, title, production_year from writer)
group by id)));",2018-08-29 23:37:22.563584+10,14,1,378,correct
6015,"select count(*)
from movie m
where not exists(
select title, production_year
from movie_award ma
where lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
union
select title, production_year
from crew_award ca
where lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
union
select title, production_year
from director_award da
where lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
union
select title, production_year
from writer_award wa
where lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
union
select title, production_year
from actor_award aa
where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
);",2018-08-29 23:38:10.160912+10,11,1,76,correct
6016,"select mp.title, mp.production_year, mp.first_name, mp.last_name
from (movie m natural join person p natural join movie_award a) as mp
where a.category = 'Best Film' and a.award_name = 'BAFTA Film Award';",2018-08-29 23:39:18.854176+10,8,0,357,partially correct
6017,"Select max(t.id) as ids,first_name,last_name,t.title,t.production_year,t.description from
(select id,count(id),title,production_year,description  from Role group by id)  as t natural join Person ;",2018-08-29 23:39:38.568358+10,15,0,16,partially correct
6018,"select p.id
from person p
where p.year_born <
(select max(p2.year_born)
from person p2);",2018-08-29 23:42:47.581761+10,3,0,76,partially correct
6019,"SELECT id,first_name,last_name
FROM person, (SELECT COUNT(*) AS num
              FROM movie,director,writer
	        WHERE director.title=movie.title AND writer.title=movie.title AND director.id=writer.id) AS h
WHERE h.num>1;",2018-08-29 23:42:52.188432+10,4,0,369,partially correct
6020,"select mp.title, mp.production_year, mp.first_name, mp.last_name
from (movie m natural join person p natural join movie_award a) as mp
where a.category = 'Best Film' and a.award_name = 'BAFTA Film Award';",2018-08-29 23:43:22.713661+10,8,0,357,partially correct
6021,"select a.first_name,a.last_name, a.title,a.production_year,a.description
from(
select p.id,p.first_name,p.last_name, x.title,x.production_year,x.description,count(x.description) as num
from person p, role x
where p.id=x.id
group by p.id) as a
where a.num=(select max(b.num)
from(
select p.id,p.first_name,p.last_name, x.title,x.production_year,x.description,count(x.description) as num
from person p, role x
where p.id=x.id
group by p.id) as b);",2018-08-29 23:43:40.097958+10,15,0,230,partially correct
6022,"select m.title, m.production_year
from movie m
inner join ( writer natural join person) pw on m.title=pw.title and m.production_year=pw.production_year
where pw.first_name='Kevin' and pw.last_name='Williamson';",2018-08-29 23:44:02.503624+10,5,1,349,correct
6023,;,2018-08-29 23:44:12.959915+10,15,0,306,noninterpretable
6024,"select id
from ROLE
where ROLE.description IN ( SELECT description
                            from APPEARANCE
                            WHERE APPEARANCE.title=""Psycho""
                            and APPEARANCE.production_year=1960
                            GROUP BY APPEARANCE.description
                            HAVING count(*) = 1)
AND ROLE.title=""Psycho""
AND  ROLE.production_year=1960;",2018-08-29 23:44:14.89637+10,10,1,139,correct
6025,"select p.id
from person p
where p.year_born <
(select max(p2.year_born)
from person p2)
order by year_born desc
limit 1;",2018-08-29 23:44:16.809972+10,3,1,76,correct
6026,"
SELECT id 
FROM (Select id, COUNT(*) as time 
	from(Select p.id, w.title
    	        from Person p, writer w
    	        where p.id = w.id
   	        UNION
   	        Select p.id, d.title
    	        from Person p, director d
   	        where p.id = d.id)
   	 Group by id)
WHERE time = (select max(time) 
 	          from (Select COUNT(*) as time 
		       from (Select p.id, w.title
    		  	     from Person p, writer w
    		  	     where p.id = w.id
			     UNION
   			     Select p.id, d.title
    		  	     from Person p, director d
    		 	     where p.id = d.id)
   		        Group by id)
		);
",2018-08-29 23:44:20.537277+10,14,1,77,correct
6027,"SELECT role.id
FROM person,role,movie,(SELECT app.description AS name 
                        FROM(SELECT appearance.description
                             FROM appearance,scene
                             WHERE appearance.title ='Psycho' AND appearance.production_year = '1960' AND appearance.title = scene.title
                                   AND appearance.production_year = scene.production_year AND appearance.scene_no = scene.scene_no) AS app
                        GROUP BY name
                        HAVING COUNT(*)=1)
WHERE person.id =role.id AND role.description =name AND role.title = movie.title AND role.production_year =movie.production_year
      AND role.production_year ='1960';",2018-08-29 23:44:45.003397+10,10,1,165,correct
6028,"select r.country
from restriction r
where r.title='Shakespeare in Love' and r.description='M';",2018-08-29 23:46:47.555076+10,6,1,349,correct
6029,"SELECT COUNT(*) FROM writer JOIN person ON writer.id=person.id
WHERE year_born;",2018-08-29 23:46:49.189744+10,1,0,320,partially correct
6030,"SELECT *
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM person pp
				);
",2018-08-29 23:47:45.393756+10,3,0,406,partially correct
6031,"select id, first_name, last_name
from person
order by year_born desc
limit 1;",2018-08-29 23:48:06.500266+10,7,1,349,correct
6032,"select id 
from Person
where year_born=(select max(year_born) from person where year_born< (select max(year_born) from person)));",2018-08-29 23:48:19.02664+10,3,0,300,noninterpretable
6033,"select id 
from Person
where year_born=(select max(year_born) from person where year_born< (select max(year_born) from person));",2018-08-29 23:49:05.349753+10,3,1,300,correct
6034,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM person
				WHERE year_born <(SELECT MAX(year_born)
							FROM person))
				;
",2018-08-29 23:49:09.66167+10,3,1,406,correct
6035,"SELECT COUNT(*) FROM writer JOIN person ON writer.id=person.id
WHERE year_born=1935
GROUP BY person.id;",2018-08-29 23:50:06.632215+10,1,0,320,partially correct
6036,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;
",2018-08-29 23:50:31.058787+10,4,1,369,correct
6037,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-29 23:54:18.132329+10,11,1,378,correct
6038,"select c.first_name,c.last_name, x.title,x.production_year,x.description
from person p, role x,(
select a.first_name,a.last_name, a.title,a.production_year,a.description
from(
select p.id,p.first_name,p.last_name, x.title,x.production_year,x.description,count(x.description) as num
from person p, role x
where p.id=x.id
group by p.id) as a
where a.num=(select max(b.num)
from(
select p.id,p.first_name,p.last_name, x.title,x.production_year,x.description,count(x.description) as num
from person p, role x
where p.id=x.id
group by p.id) as b))as c
where c.first_name=p.first_name and c.last_name=p.last_name and p.id=x.id;",2018-08-29 23:54:46.344535+10,15,1,230,correct
6039,"SELECT COUNT(*)
FROM person,writer
WHERE person.id = writer.id
AND person.year_born = 1935;",2018-08-29 23:57:09.181395+10,1,0,307,partially correct
6040,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS ( SELECT * FROM MOVIE,DIRECTOR WHERE director.title=movie.title);",2018-08-29 23:57:59.573818+10,12,0,395,partially correct
6041,"SELECT id, award_name, year_of_award, category
FROM director_award natural join director natural join person
WHERE result = 'nominated';",2018-08-29 23:58:22.885127+10,13,1,406,correct
6042,"SELECT production_year, COUNT(*) FROM MOVIE
WHERE production_year IN (1993,1992,1991)
GROUP BY production_year;",2018-08-29 23:59:00.974929+10,2,1,320,correct
6043,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da natural join director d
where 
lower(da.result) = 'nominated'
and d.id not in 
(
select title
from director_award
where lower(result) = 'won'
)
group by d.id
having count(*) > 0;
",2018-08-30 00:00:27.726346+10,13,1,76,correct
6044,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 00:00:29.112097+10,12,1,395,correct
6045,"select ma.title, ma.production_year
from movie_award ma
where ma.award_name='BAFATA Film Award' and ma.category='Best Film';",2018-08-30 00:00:45.022331+10,8,0,349,partially correct
6047,"SELECT production_year, COUNT(*) AS num_movie
FROM movie
WHERE movie.production_year = 1993 OR movie.production_year = 1992 OR movie.production_year = 1991
GROUP BY production_year;",2018-08-30 00:01:31.690148+10,2,1,307,correct
6048,"select x.id
from(select x1.id, count(*) as worked
from(select d.id, d.title,d.production_year
from director d
union
select w.id,w.title,w.production_year
from writer w) x1
group by x1.id) x
where x.worked=
(select max(x2.worked)
from(select x1.id, count(*) as worked
from(select d.id, d.title,d.production_year
from director d
union
select w.id,w.title,w.production_year
from writer w) x1
group by x1.id) x2);",2018-08-30 00:04:31.17843+10,14,1,364,correct
6049,"SELECT COUNT(*) FROM person LEFT JOIN director ON person.id=director.id
WHERE director.id IS NOT NULL;",2018-08-30 00:04:31.686332+10,12,0,320,partially correct
6050,"SELECT m.title, COUNT(*)
FROM movie m
WHERE m.production_year = 1993'
GROUP BY m.title;
",2018-08-30 00:05:43.854515+10,2,0,163,noninterpretable
6051,"select ma.title, ma.production_year, pd.first_name || ' '|| pd.last_name
from movie_award ma
inner join (person natural join director) pd on pd.title=ma.title and pd.production_year=ma.production_year
where ma.award_name='BAFATA Film Award' and ma.category='Best Film';",2018-08-30 00:05:44.311198+10,8,0,349,partially correct
6052,"Select person.first_name,person.last_name,t1.title,t1.production_year,t1.description from(select max(most),t.id,t.title,t.production_year,t.description from 
(select count(*) as most,id,title,production_year,description from Role group by id) as t) as t1 natural join Person ;",2018-08-30 00:05:47.520754+10,15,0,16,partially correct
6053,"SELECT COUNT(*) FROM person LEFT JOIN director ON person.id=director.id
WHERE director.id IS NULL;",2018-08-30 00:06:11.565672+10,12,1,320,correct
6054,"SELECT m.id FROM (SELECT h.id, COUNT(*) AS ni FROM (SELECT director.id
, production_year, title FROM director 
UNION
SELECT writer.id, production_year, title FROM writer) AS h GROUP BY h.id) AS m
WHERE m.ni=(SELECT MAX(l.ni) FROM (SELECT h.id, COUNT(*) AS ni 
FROM (SELECT director.id, production_year, title
FROM director 
UNION
SELECT writer.id, production_year, title FROM writer) AS h GROUP BY h.id) AS l);",2018-08-30 00:06:19.10161+10,14,1,288,correct
6055,"SELECT dm.id,da.award_name,da.year_of_award,da.category
FROM director_award AS da,(SELECT * FROM director,movie WHERE director.title=movie.title AND director.production_year=movie.production_year) AS dm
WHERE dm.title=da.title AND dm.production_year=da.production_year 
AND not exists (select * from da WHERE lower(result)=""won"");",2018-08-30 00:06:24.669654+10,13,0,250,noninterpretable
6056,"SELECT COUNT(*)
FROM person p
WHERE EXISTS(SELECT id 
FROM director d WHERE d.id!=p.id);",2018-08-30 00:06:52.343703+10,12,0,307,partially correct
6057,"SELECT  id
FROM (SELECT *
FROM ROLE r ,SCENE n
WHERE lower(r.title) =lower(n.title)='psycho' AND r.production_year AND n.production_year=1960)AS rn
GROUP BY rn.scene_no
HAVING COUNT(id)=1;
",2018-08-30 00:08:02.975751+10,10,0,368,partially correct
6058,"SELECT title,production_year
FROM movie, (SELECT *
             FROM person LEFT JOIN writer ON person.id=writer.id) AS p
WHERE p.fist_name='Kevin' AND p.last_name='Williamson' AND movie.title=p.title;
",2018-08-30 00:08:30.47775+10,5,0,369,noninterpretable
6059,"SELECT id,first_name,last_name
FROM person p
WHERE EXISTS(SELECT * FROM director d, writer w WHERE d.id=w.id AND d.title=w.title
GROUP BY d.id
HAVING COUNT(*)>2);",2018-08-30 00:09:18.061001+10,4,0,395,partially correct
6060,"SELECT m.production_year, COUNT(*)
FROM movie m
WHERE m.production_year = 1993', m.production_year = 1992', m.production_year = 1991' 
GROUP BY production_year;",2018-08-30 00:09:34.568169+10,2,0,163,noninterpretable
6061,"SELECT count(*)
FROM person p
WHERE EXISTS(SELECT * FROM WRITER w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 00:10:57.396094+10,1,1,329,correct
6062,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year = 1991 OR production_year = 1992 OR production_year = 1993 
GROUP BY production_year;",2018-08-30 00:12:48.008282+10,2,1,163,correct
6063,"SELECT m.production_year, count(*) 
FROM movie m
WHERE m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 
GROUP BY m.production_year;",2018-08-30 00:13:34.285369+10,2,1,163,correct
6064,"SELECT dm.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director dm
WHERE dm.title=da.title AND dm.production_year=da.production_year 
AND dm.id NOT IN (SELECT * FROM director_award WHERE lower(result)=""won"");",2018-08-30 00:13:39.387429+10,13,0,216,noninterpretable
6065,"SELECT writer.title,writer.production_year
FROM writer,person
WHERE writer.id=person.id AND person.first_name='Kevin' AND person.last_name='Williamson';
",2018-08-30 00:13:43.259808+10,5,1,369,correct
6066,;,2018-08-30 00:14:31.427149+10,11,0,340,noninterpretable
6067,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 00:14:47.406702+10,4,1,395,correct
6068,"SELECT *
FROM writer natural join director natural join person;",2018-08-30 00:15:01.805647+10,14,0,406,partially correct
6069,"SELECT COUNT(*)
FROM(SELECT movie.title
     FROM movie
     WHERE NOT EXISTS (SELECT movie_award.result,movie_award.title
                  FROM movie_award
			 WHERE movie_award.result ='won'AND movie_award.title =movie.title 
			 AND movie_award.production_year=movie.production_year)
     UNION
     SELECT movie.title
     FROM movie
     WHERE NOT EXISTS (SELECT crew_award.result,crew_award.title
                  FROM crew_award
			 WHERE crew_award.result ='won'AND crew_award.title =movie.title 
			 AND crew_award.production_year=movie.production_year)
     UNION
     SELECT movie.title
     FROM movie
     WHERE NOT EXISTS (SELECT director_award.result,director_award.title
                  FROM director_award
			 WHERE director_award.result ='won'AND director_award.title =movie.title 
			 AND director_award.production_year=movie.production_year)
     UNION
     SELECT movie.title
     FROM movie
     WHERE NOT EXISTS (SELECT writer_award.result,writer_award.title
                  FROM writer_award
			 WHERE writer_award.result ='won'AND writer_award.title =movie.title 
			 AND writer_award.production_year=movie.production_year)
     UNION
     SELECT movie.title
     FROM movie
     WHERE NOT EXISTS (SELECT actor_award.result, actor_award.title
                  FROM actor_award
			 WHERE actor_award.result ='won'AND actor_award.title =movie.title 
			 AND actor_award.production_year=movie.production_year));",2018-08-30 00:15:46.476223+10,11,0,165,partially correct
6070,"select p.year_born as bornIn, count(*) as number
from person p
where EXISTS(SELECT * FROM writer w WHERE w.id=p.id and p.year_born=1935)
group by p.year_born;",2018-08-30 00:16:14.807689+10,1,0,128,partially correct
6071,"select count(*)
from person p
where EXISTS(SELECT * FROM writer w WHERE w.id=p.id and p.year_born=1935)
group by p.year_born;",2018-08-30 00:17:03.152147+10,1,1,128,correct
6072,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-30 00:18:14.875912+10,10,1,368,correct
6073,"select id
from
   role
   natural join
   Appearance
group by id, title, production_year
having
   title = 'Psycho'
   and
   production_year = '1960'
   and
   count(id) = 1;",2018-08-30 00:18:30.085262+10,10,1,102,correct
6074,"select a.title, a.production_year, p.first_name, p.last_name
from ((select title, production_year from movie_award
where category = 'best film' and award_name = 'BAFTA Film Award' and result = 'won') as a, director d, person p)
where (d.title = a.title and d.production_year = a.production_year and d.id = p.id);",2018-08-30 00:18:59.968284+10,8,1,357,correct
6092,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love' AND upper(description)='M';",2018-08-30 00:35:41.956631+10,6,1,369,correct
6094,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (
	SELECT *
	FROM director d
	WHERE d.id = p.id
);",2018-08-30 00:36:05.092876+10,12,1,343,correct
6075,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
	FROM movie_award ma
	WHERE lower(ma.result) = 'won' AND ma.title = m.title AND ma.production_year = m.production year
	UNION
	SELECT title,production_year
	FROM crew_award ca
	WHERE lower(ca.result) = 'won' AND ca.title = m.title AND ca.production_year = m.production year
	UNION
	SELECT title,production_year
	FROM director_award da
	WHERE lower(da.result) = 'won' AND da.title = m.title AND da.production_year = m.production year
	UNION
	SELECT title,production_year
	FROM writer_award wa
	WHERE lower(wa.result) = 'won' AND wa.title = m.title AND wa.production_year = m.production year
	UNION
	SELECT title,production_year
	FROM actor_award aa
	WHERE lower(aa.result) = 'won' AND aa.title = m.title AND aa.production_year = m.production year);",2018-08-30 00:19:04.50518+10,11,0,340,noninterpretable
6076,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from role r natural join person p 
where number_of_roles = (
select id, count(*) as number_of_roles
from role 
group by id) as b
and number_of_roles =
(
select max(number_of_roles)
from (select id, count(*) as number_of_roles
from role 
group by id) );


",2018-08-30 00:19:54.570421+10,15,0,76,noninterpretable
6077,"SELECT director.id, first_name, last_name FROM director JOIN writer ON (director.id=writer.id AND director.title=writer.title) JOIN person ON director.id=person.id
GROUP BY director.id
HAVING COUNT(*)>1;",2018-08-30 00:20:01.266518+10,4,1,320,correct
6078,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
	FROM movie_award ma
	WHERE lower(ma.result) = 'won' AND ma.title = m.title AND ma.production_year = m.production_year
	UNION
	SELECT title,production_year
	FROM crew_award ca
	WHERE lower(ca.result) = 'won' AND ca.title = m.title AND ca.production_year = m.production_year
	UNION
	SELECT title,production_year
	FROM director_award da
	WHERE lower(da.result) = 'won' AND da.title = m.title AND da.production_year = m.production_year
	UNION
	SELECT title,production_year
	FROM writer_award wa
	WHERE lower(wa.result) = 'won' AND wa.title = m.title AND wa.production_year = m.production_year
	UNION
	SELECT title,production_year
	FROM actor_award aa
	WHERE lower(aa.result) = 'won' AND aa.title = m.title AND aa.production_year = m.production_year);",2018-08-30 00:20:03.204924+10,11,1,340,correct
6079,"SELECT DISTINCT person.id,first_name,last_name
FROM (SELECT director.id FROM director INNER JOIN writer
ON director.title=writer.title AND director.production_year=writer.production_year)AS h,person
WHERE (SELECT COUNT(*) AS num_dir
FROM person,director WHERE person.id=director.id)>1 AND h.id=person.id;",2018-08-30 00:20:56.678407+10,4,0,307,partially correct
6080,"SELECT title, production_year
FROM person p NATURAL JOIN writer w NATURAL JOIN movie m
WHERE first_name='Kevin' AND last_name='Williamson'; 
",2018-08-30 00:22:59.703826+10,5,1,395,correct
6081,"SELECT *
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 00:24:07.796815+10,14,0,406,partially correct
6082,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 00:24:32.50946+10,14,1,406,correct
6083,"SELECT COUNT(*)
FROM(SELECT movie.title,movie.production_year
     FROM movie
     WHERE NOT EXISTS (SELECT movie_award.title,movie_award.production_year
                  FROM movie_award
			 WHERE movie_award.result ='won'AND movie_award.title =movie.title 
			 AND movie_award.production_year=movie.production_year)
     UNION
     SELECT movie.title,movie.production_year
     FROM movie
     WHERE NOT EXISTS (SELECT crew_award.title,crew_award.production_year
                  FROM crew_award
			 WHERE crew_award.result ='won'AND crew_award.title =movie.title 
			 AND crew_award.production_year=movie.production_year)
     UNION
     SELECT movie.title,movie.production_year
     FROM movie
     WHERE NOT EXISTS (SELECT director_award.title,director_award.production_year
                  FROM director_award
			 WHERE director_award.result ='won' AND director_award.title =movie.title 
			 AND director_award.production_year=movie.production_year)
     UNION
     SELECT movie.title,movie.production_year
     FROM movie
     WHERE NOT EXISTS (SELECT writer_award.title,writer_award.production_year
                  FROM writer_award
			 WHERE writer_award.result ='won'AND writer_award.title =movie.title 
			 AND writer_award.production_year=movie.production_year)
     UNION
     SELECT movie.title,movie.production_year
     FROM movie
     WHERE NOT EXISTS (SELECT actor_award.title, actor_award.production_year
                  FROM actor_award
			 WHERE actor_award.result ='won'AND actor_award.title =movie.title 
			 AND actor_award.production_year=movie.production_year));",2018-08-30 00:26:58.070437+10,11,0,165,partially correct
6084,"select count(*)
from writer_award wa, person p
where (wa.id = p.id and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <= 1995);",2018-08-30 00:28:15.626537+10,9,0,357,partially correct
6085,"SELECT title, production_year FROM writer
WHERE id = (SELECT id from person WHERE first_name='Kevin' AND last_name='Williamson');",2018-08-30 00:28:46.438331+10,5,1,320,correct
6086,"select count(*)
from writer_award wa, person p
where (wa.id = p.id and lower(p.first_name) = 'woody' and wa.result = 'won' and lower(p.last_name) = 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <= 1995);",2018-08-30 00:29:01.824562+10,9,1,357,correct
6087,"select w.title,w.production_year
from person p NATURAL JOIN WRITER w
Where p.first_name='Kevin' AND p.last_name='Williamson' AND p.id=w.id
GROUP BY w.title,w.production_year;
",2018-08-30 00:31:13.831489+10,5,1,309,correct
6088,"

SELECT d.id, p.first_name, p.last_name, COUNT(*)
FROM director d,person p
WHERE
d.id IN
(SELECT id
FROM writer)

AND d.id=p.id

GROUP BY d.id
HAVING COUNT(*)>1
;",2018-08-30 00:31:27.555571+10,4,0,128,partially correct
6089,"SELECT title, production_year
FROM person NATURAL JOIN movie NATURAL JOIN writer
GROUP BY title, production_year
HAVING first_name=""Kevin"" AND last_name=""Williamson"";",2018-08-30 00:31:44.577312+10,5,1,307,correct
6090,"select count(*)
from movie m
where not exists
(select title,production_year from movie_award ma where m.title=ma.title and m.production_year=ma.production_year
and lower(ma.result)='won'
union select title,production_year from crew_award ca where m.title=ca.title and m.production_year=ca.production_year
and lower(ca.result)='won'
union select title,production_year from director_award da where m.title=da.title and m.production_year=da.production_year
and lower(da.result)='won'
union select title,production_year from writer_award wa where m.title=wa.title and m.production_year=wa.production_year
and lower(wa.result)='won'
union select title,production_year from actor_award aa where m.title=aa.title and m.production_year=aa.production_year
and lower(aa.result)='won');
",2018-08-30 00:32:56.888972+10,11,1,397,correct
6091,"select director.id,director_award.title,director_award.production_year,director_award.category
from director,director_award
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='nominated';",2018-08-30 00:33:06.928879+10,13,0,300,partially correct
6095,"SELECT title, production_year
FROM person NATURAL JOIN writer
WHERE first_name=""Kevin"" AND last_name=""Williamson"";",2018-08-30 00:36:30.434251+10,5,1,307,correct
6096,"select Director.id,director_award.title,director_award.production_year,director_award.category
from Director,director_award
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='nominated' and
Director.id not in (select Director.id
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='won');",2018-08-30 00:38:04.319045+10,13,0,300,partially correct
6097,"SELECT production_year, COUNT(*) AS number FROM MOVIE WHERE 
production_year=1993 OR production_year=1992 OR production_year=1991 GROUP BY production_year;",2018-08-30 00:38:11.611695+10,2,1,388,correct
6098,"WITH newPerson AS(
SELECT id, year_born
FROM person p
WHERE p.year_born < (
SELECT MAX(p1.year_born)
FROM person p1)
)
SELECT p2.id
FROM newPerson p2
WHERE p2.year_born = (
SELECT MAX(p3.year_born)
FROM newPerson p3);",2018-08-30 00:38:11.733633+10,3,1,340,correct
6099,"select Director.id,director_award.title,director_award.year_of_award,director_award.category
from Director,director_award
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='nominated' and
Director.id not in (select Director.id
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='won');",2018-08-30 00:38:37.365354+10,13,0,300,partially correct
6100,"select distinct p1.id 
from person p1, person p2
where p1.year_born>=any p2.year_born;",2018-08-30 00:38:42.499895+10,3,0,397,noninterpretable
6101,"select country
from restriction
where lower(title)=""shakespeare in love""
and lower(description)='m';",2018-08-30 00:39:36.037456+10,6,1,307,correct
6102,"select Director.id,director_award.award_name,director_award.year_of_award,director_award.category
from Director,director_award
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='nominated' and
Director.id not in (select Director.id
where director_award.title=director.title and
director.production_year=director_award.production_year and
lower(director_award.result)='won');",2018-08-30 00:39:38.324425+10,13,1,300,correct
6103,"select id, first_name, last_name 
from person p
where p.year_born = (select max(year_born) from person) ;",2018-08-30 00:39:58.561547+10,7,1,265,correct
6104,select country from restriction where title = 'Shakespeare in love' and description = 'M' ;,2018-08-30 00:40:32.138134+10,6,0,400,partially correct
6105,"select count(*)
from movie_award
natural join 
crew_award
natural join
crew_award
natural join
director_award
natural join
writer_award
natural join
actor_award
having 
lower(result) <> 'won'
group by
title, production_year;

",2018-08-30 00:41:21.372852+10,11,0,102,noninterpretable
6106,"select p.first_name, p.last_name
from movie m, role r, scene s, person p
where m.title = 'Psycho' and m.production_year = 1960 and s.scene_no = 1 and p.id = r.id and r.title = s.title;",2018-08-30 00:42:27.407654+10,10,0,357,partially correct
6107,"SELECT COUNT(*) FROM PERSON p WHERE NOT EXISTS
(SELECT * FROM DIRECTOR d WHERE d.id = p.id);",2018-08-30 00:42:51.90158+10,12,1,388,correct
6108,select country from restriction where lower(title) = 'Shakespeare in love' and description = 'M' ;,2018-08-30 00:43:05.986971+10,6,0,400,partially correct
6109,"select id,first_name,last_name
from person,(select MIN(year_born) as youngest from person) as y
where person.year_born=y.youngest;",2018-08-30 00:43:10.807784+10,7,0,307,partially correct
6110,"select r.id
from movie m, role r, scene s
where m.title = 'Psycho' and m.production_year = 1960 and s.scene_no = 1 and r.title = s.title;",2018-08-30 00:43:53.990056+10,10,0,357,partially correct
6111,"select first_name, last_name, title, production_year, description
from role natural join person
where id in ( 
	(select id 
	from (select id, max(num) 
		from (select id, count(*) as num
			from role
			group by id)
		)
	)
);
",2018-08-30 00:44:27.076832+10,15,1,109,correct
6112,"SELECT count(*)
FROM person p 
WHERE EXISTS(SELECT * FROM writer w WHERE p.id = w.id AND p.year_born =1935);",2018-08-30 00:45:16.079246+10,1,1,410,correct
6113,"SELECT D.id, DA.Award_name, DA.Year_of_award, DA.category
FROM Director D natural join Director_award DA
WHERE lower (DA.result) = 'nominated'
	  AND D.id NOT IN (Select id
			        From Director D Natural Join Director_award DA
			        Where lower (DA.result)  = 'won');
",2018-08-30 00:45:32.794294+10,13,1,77,correct
6114,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d, director_award da
WHERE d.title = da.title
	AND d.production_year = da.production_year
	AND lower(da.result) != 'won';",2018-08-30 00:45:47.273762+10,13,1,340,correct
6115,"SELECT p.id, p.first_name, p.last_name 
FROM person p ,director d, writer w
where p.id = d.id
and d.id = w.id
and p.id = w.id
and d.title = w.title
and d.production_year=w.production_year
GROUP BY p.id 
HAVING count(*) > 1;",2018-08-30 00:46:38.837637+10,4,1,265,correct
6116,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 00:47:07.396212+10,4,1,343,correct
6117,"SELECT production_year, count(*)
FROM movie WHERE production_year >1990 AND production_year<1994;",2018-08-30 00:48:09.123298+10,2,0,410,partially correct
6118,"SELECT id,first_name,last_name
FROM person
GROUP BY year_born
HAVING year_born=MAX(year_born);",2018-08-30 00:48:33.570092+10,7,0,369,partially correct
6119,"SELECT id,first_name,last_name
FROM person
WHERE year_born=(SELECT MAX(year_born)
                 FROM person);",2018-08-30 00:49:54.353623+10,7,1,369,correct
6120,"SELECT COUNT(*)
FROM person 
WHERE EXISTS (SELECT * 
              FROM writer 
              WHERE person.id = writer.id
              AND person.year_born = 1935);
",2018-08-30 00:50:16.92776+10,1,1,169,correct
6121,"SELECT D.id, DA.Award_name, DA.Year_of_award, DA.category
FROM Director D natural join Director_award DA
WHERE D.id IN (Select id 
		    From Director D Natural Join Director_award DA
		    Where lower (DA.result)  = 'nominated') 
	 AND 
	 D.id NOT IN (Select id
			   From Director D Natural Join Director_award DA
			   Where lower (DA.result)  = 'won') ;
",2018-08-30 00:51:36.403346+10,13,1,77,correct
6122,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM 
    director AS d,
    person AS p,
    movie_award ma
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id
    and lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ;",2018-08-30 00:53:32.960169+10,8,1,265,correct
6123,"SELECT production_year, count(*)
FROM movie WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-30 00:54:21.687479+10,2,1,410,correct
6124,"select director.title,director.production_year,first_name,last_name
from movie_award natural join director,person
where lower(movie_award.award_name)=""bafta film award""
and lower(movie_award.category)=""best film""
and director.id=person.id;",2018-08-30 00:55:45.836648+10,8,0,307,partially correct
6125,"select r.id
from role r, scene s, appearance a
where (s.title = a.title
    and s.production_year = a.production_year
    and s.scene_no = a.scene_no
    and s.title = r.title
    and s.production_year = r.production_year
    and a.description = r.description
    and lower(a.title) = 'psycho'
    and a.production_year = 1960)
group by r.id
having count(*) = 1;",2018-08-30 00:56:27.594973+10,10,1,357,correct
6126,"SELECT COUNT(*) FROM person p WHERE p.id IN (SELECT P.id FROM person, writer w WHERE p.id=w.id AND p.year_born = 1935);
",2018-08-30 00:57:39.303457+10,1,1,196,correct
6127,select count(*) from (person p natural join writer w natural join writer_award wa) d where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>=1991 and year_of_award<=1995; ,2018-08-30 00:58:37.790357+10,9,0,270,partially correct
6128,select count(*) from (person p natural join writer w natural join writer_award wa) d where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>=1991 and year_of_award<=1995; ,2018-08-30 00:58:50.477776+10,9,0,270,partially correct
6129,"SELECT COUNT(*), production_year
FROM movie AS m
GROUP BY m.production_year
HAVING m.production_year = 1993
OR m.production_year = 1992
OR m.production_year = 1991;",2018-08-30 01:00:06.361776+10,2,1,169,correct
6130,"select director.title,director.production_year,first_name,last_name
from movie_award natural join director,person
where lower(movie_award.award_name)=""bafta film award""
and lower(movie_award.category)=""best film""
and lower(movie_award.result)=""won""
and director.id=person.id;",2018-08-30 01:00:23.451878+10,8,1,307,correct
6131,select count(distinct(d.id)) from (person p natural join writer w natural join writer_award wa) d where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>=1991 and year_of_award<=1995; ,2018-08-30 01:00:39.113976+10,9,1,270,correct
6132,"SELECT COUNT(*), production_year
FROM movie AS m
WHERE m.production_year = 1991
OR m.production_year = 1992
OR m.production_year = 1993
GROUP BY m.production_year;
",2018-08-30 01:01:44.740389+10,2,1,169,correct
6133,select count(distinct(d.id)) from (person p natural join writer w natural join writer_award wa) d where lower(first_name)='woody' and lower(last_name)='allen' and year_of_award>=1991 and year_of_award<=1995; ,2018-08-30 01:02:17.966516+10,9,1,270,correct
6134,"SELECT p.id, p.first_name, p.last_name FROM PERSON p WHERE EXISTS 
(SELECT COUNT(*) AS COUNTS, w.id FROM WRITER w INNER JOIN DIRECTOR d ON w.id=d.id GROUP BY w.id);",2018-08-30 01:02:41.848415+10,4,0,388,partially correct
6135,"SELECT movie_award.title,movie_award.production_year,person.first_name,person.last_name
FROM movie_award, person,director
WHERE lower(movie_award.award_name)='bafta film award'
      AND lower(movie_award.category)='best film'
	AND movie_award.title=director.title
	AND director.id=person.id;",2018-08-30 01:02:49.169835+10,8,0,369,partially correct
6136,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id HAVING count(*) > 1;
",2018-08-30 01:04:01.344866+10,4,1,388,correct
6137,"SELECT movie_award.title,movie_award.production_year,person.first_name,person.last_name
FROM movie_award, person,director
WHERE lower(movie_award.award_name)='bafta film award'
      AND lower(movie_award.category)='best film'
	AND lower(result)='won'
	AND movie_award.title=director.title
	AND director.id=person.id;",2018-08-30 01:04:32.489847+10,8,1,369,correct
6138,"
SELECT pw.title,pw.production_year
FROM (person NATURAL JOIN writer )AS pw
WHERE lower(pw.first_name='Kevin')
AND lower(pw.last_name='Williamson');",2018-08-30 01:04:49.722879+10,5,1,343,correct
6139,"SELECT COUNT(*), m.production_year
FROM movie AS m
WHERE m.production_year > 1990 AND m.production_year < 1994
GROUP BY m.production_year;
",2018-08-30 01:05:18.758602+10,2,1,169,correct
6140,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description 
from Role as r,person as p,

(select max(most),t.id from 
(select count(*) as most,id from Role group by id)as t) as t1
WHERE r.id=p.id AND
p.id=t1.id;",2018-08-30 01:05:37.509759+10,15,1,16,correct
6141,"select count(*) from writer_award,writer,person where 
year_of_award > 1990 
and year_of_award < 1996 
and lower(result) = 'won' 
and writer_award.title = writer.title 
and writer_award.production_year = writer.production_year
and lower(person.first_name) = 'woody'
and lower(person.last_name) = 'allen'
and person.id = writer.id
and writer.id = writer_award.id
;",2018-08-30 01:06:24.613027+10,9,1,405,correct
6142,"WITH work_on AS 
	(SELECT tmp.id, COUNT(*) AS count
	FROM (
	SELECT id, title, production_year
	FROM writer
	UNION
	SELECT id, title, production_year
	FROM director) AS tmp
	GROUP BY tmp.id)
SELECT w.id
FROM work_on w
WHERE w.count = (
	SELECT MAX(w2.count)
	FROM work_on w2);",2018-08-30 01:06:26.397444+10,14,1,340,correct
6143,"SELECT production_year
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-30 01:06:41.321029+10,2,0,169,partially correct
6144,"select count(*)
from movie m
where not exists (select * from movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where m.title = ma.title and m.production_year = ma.production_year
  and m.title = ca.title and m.production_year = ca.production_year
  and m.title = da.title and m.production_year = da.production_year
  and m.title = aa.title and m.production_year = aa.production_year);",2018-08-30 01:06:42.134278+10,11,0,357,partially correct
6145,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-30 01:07:02.403162+10,2,1,169,correct
6146,"SELECT movie_award.title,movie_award.production_year,person.first_name,person.last_name
FROM movie_award, person,director
WHERE lower(movie_award.award_name)='bafta film award'
      AND lower(movie_award.category)='best film'
	AND lower(movie_award.result)='won'
	AND movie_award.title=director.title
	AND director.id=person.id;",2018-08-30 01:09:40.81634+10,8,1,369,correct
6147,"SELECT dw.TITLE, dw.production_year FROM (SELECT * FROM PERSON NATURAL JOIN WRITER NATURAL JOIN MOVIE) AS dw 
WHERE dw.first_name ='Kevin' AND dw.last_name ='Williamson' ;",2018-08-30 01:10:32.879703+10,5,1,388,correct
6148,"select count(*)
from movie m
where not exists (select title, production_year from 
(select movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year)
union
(select crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year)
union
(select director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year)
union
(select writer_award wa and m.title = wa.title and m.production_year = wa.production_year)
union
(select actor_award aa and m.title = aa.title and m.production_year = aa.production_year));",2018-08-30 01:12:00.385264+10,11,0,357,noninterpretable
6149,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS(SELECT * FROM director
                 WHERE director.id = person.id);",2018-08-30 01:12:04.629555+10,12,1,169,correct
6150,"select count(*)
from movie m
where not exists (select title, production_year from 
(select movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year)
union
(select crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year)
union
(select director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year)
union
(select writer_award wa where wa.result = 'won' and m.title = wa.title and m.production_year = wa.production_year)
union
(select actor_award aa where aa.result = 'won' and m.title = aa.title and m.production_year = aa.production_year));",2018-08-30 01:12:54.904813+10,11,0,357,noninterpretable
6151,"SELECT production_year, count(*)
FROM movie WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-30 01:13:29.741531+10,2,1,410,correct
6152,"select id from appearance, role 
where lower(appearance.title) = 'psycho' 
and appearance.production_year = 1960 
and scene_no = 1
and appearance.title = role.title
and appearance.production_year = role.production_year
and appearance.description = role.description
;",2018-08-30 01:14:10.918924+10,10,0,405,partially correct
6153,"select count(*)
from movie m
where not exists (select title, production_year from 
(select title, production from movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year)
union
(select title, production from crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year)
union
(select title, production from director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year)
union
(select title, production from writer_award wa where wa.result = 'won' and m.title = wa.title and m.production_year = wa.production_year)
union
(select title, production from actor_award aa where aa.result = 'won' and m.title = aa.title and m.production_year = aa.production_year));",2018-08-30 01:14:30.753686+10,11,0,357,noninterpretable
6207,"select id
from (select p.id ,p.year_born
       from person p
        order by p.year_born desc
        limit 2)
order by year_born asc
limit 1;",2018-08-30 01:56:12.286916+10,3,1,298,correct
6154,"select count(*)
from movie m
where not exists (
(select title, production from movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year)
union
(select title, production from crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year)
union
(select title, production from director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year)
union
(select title, production from writer_award wa where wa.result = 'won' and m.title = wa.title and m.production_year = wa.production_year)
union
(select title, production from actor_award aa where aa.result = 'won' and m.title = aa.title and m.production_year = aa.production_year));",2018-08-30 01:15:34.677826+10,11,0,357,noninterpretable
6155,"select count(*)
from movie m
where not exists (
(select title, production_year from movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year)
union
(select title, production_year from crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year)
union
(select title, production_year from director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year)
union
(select title, production_year from writer_award wa where wa.result = 'won' and m.title = wa.title and m.production_year = wa.production_year)
union
(select title, production_year from actor_award aa where aa.result = 'won' and m.title = aa.title and m.production_year = aa.production_year));",2018-08-30 01:16:22.731275+10,11,0,357,noninterpretable
6156,"SELECT movie_award.title,movie_award.production_year,person.first_name,person.last_name
FROM movie_award, person,director
WHERE lower(movie_award.award_name)='bafta film award'
      AND lower(movie_award.category)='best film'
	AND lower(movie_award.result)='won'
	AND movie_award.title=director.title
	AND movie_award.production_year=director.production_year
	AND director.id=person.id;",2018-08-30 01:17:51.606888+10,8,1,369,correct
6157,"WITH rolecount AS(
	SELECT id,COUNT(*) AS count
	FROM role
	GROUP BY id)
SELECT p.first_name,p.last_name, r.*
FROM person p, role r, rolecount rc
WHERE p.id = r.id
	AND p.id = rc.id
	AND rc.count = (SELECT MAX(rc1.count)
				FROM rolecount rc1);",2018-08-30 01:18:20.371284+10,15,0,340,partially correct
6158,"WITH rolecount AS(
	SELECT id,COUNT(*) AS count
	FROM role
	GROUP BY id)
SELECT p.first_name,p.last_name, r.title,r.production_year, r.description
FROM person p, role r, rolecount rc
WHERE p.id = r.id
	AND p.id = rc.id
	AND rc.count = (SELECT MAX(rc1.count)
				FROM rolecount rc1);",2018-08-30 01:19:08.170801+10,15,1,340,correct
6159,"select count(*)
from movie m
where not exists (
select title, production_year from movie_award ma where ma.result = 'won' and m.title = ma.title and m.production_year = ma.production_year
union
select title, production_year from crew_award ca where ca.result = 'won' and m.title = ca.title and m.production_year = ca.production_year
union
select title, production_year from director_award da where da.result = 'won' and m.title = da.title and m.production_year = da.production_year
union
select title, production_year from writer_award wa where wa.result = 'won' and m.title = wa.title and m.production_year = wa.production_year
union
select title, production_year from actor_award aa where aa.result = 'won' and m.title = aa.title and m.production_year = aa.production_year);",2018-08-30 01:19:08.460298+10,11,0,357,partially correct
6160,"select id from appearance, role 
where lower(appearance.title) = 'psycho' 
and appearance.production_year = 1960 
and appearance.title = role.title
and appearance.production_year = role.production_year
and appearance.description = role.description
group by appearance.description
having count(*) = 1
;",2018-08-30 01:19:19.802625+10,10,1,405,correct
6161,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 01:20:01.751152+10,11,1,357,correct
6162,"select m.production_year, count(*) FROM movie m where m.production_year=1993 OR m.production_year = 1992 OR m.production_year=1991 GROUP by m.production_year;",2018-08-30 01:20:13.485681+10,2,1,196,correct
6163,"select id from role,
(select * from appearance 
where lower(appearance.title) = 'psycho' 
and appearance.production_year = 1960 
group by appearance.description
having count(*) = 1)as aa
where aa.title = role.title
and aa.production_year = role.production_year
and aa.description = role.description
;",2018-08-30 01:21:09.054023+10,10,1,405,correct
6164,SELECT country FROM Restriction WHERE title='Shakespeare in Love' AND description='M';,2018-08-30 01:21:42.453555+10,6,1,388,correct
6165,"select id
from person;",2018-08-30 01:22:17.664541+10,3,0,357,partially correct
6166,"select count(*) from person p WHERE NOT EXISTS(select p.id from person, director d where p.id=d.id);",2018-08-30 01:25:24.177444+10,12,1,196,correct
6167,"select id
from person
where p.year_born = (select p.year_born < max(year_born) from person where (select max(year_born) from person));",2018-08-30 01:26:31.234694+10,3,0,357,noninterpretable
6168,"SELECT COUNT(*)
FROM writer_award,person
WHERE writer_award.year_of_award>1990 
      AND writer_award.year_of_award<1996
	AND lower(writer_award.result)='won'
	AND writer_award.id=person.id
	AND lower(person.first_name='woody')
	AND lower(person.last_name='allen');",2018-08-30 01:26:45.403214+10,9,0,369,partially correct
6169,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 01:27:27.020632+10,3,1,357,correct
6170,"SELECT COUNT(*)
FROM writer_award,person
WHERE writer_award.year_of_award>1990 
      AND writer_award.year_of_award<1996
	AND lower(writer_award.result)='won'
	AND writer_award.id=person.id
	AND lower(person.first_name)='woody'
	AND lower(person.last_name)='allen';",2018-08-30 01:28:07.254672+10,9,1,369,correct
6171,"select count(*) from (Select id from Person where year_born=1935) as table1 where table1.id in (select id from writer);
",2018-08-30 01:28:41.392171+10,1,1,16,correct
6172,"select id from person p1
where p1.year_born=(
select max(year_born) from person p
where p.year_born<(select max(year_born) from person));",2018-08-30 01:28:51.482248+10,3,1,397,correct
6173,"SELECT COUNT(*) AS number_of_award
FROM writer_award,person
WHERE writer_award.year_of_award>1990 
      AND writer_award.year_of_award<1996
	AND lower(writer_award.result)='won'
	AND writer_award.id=person.id
	AND lower(person.first_name)='woody'
	AND lower(person.last_name)='allen';",2018-08-30 01:28:52.459669+10,9,1,369,correct
6174,"SELECT COUNT(*) AS number_of_award
FROM writer_award,person
WHERE writer_award.year_of_award>1990 
      AND writer_award.year_of_award<1996
	AND lower(writer_award.result)='won'
	AND writer_award.id=person.id
	AND lower(person.first_name)='woody'
	AND lower(person.last_name)='allen';",2018-08-30 01:29:04.784655+10,9,1,369,correct
6175,"select p.id, da.award_name, da.year_of_award, da.category
from director_award da, person p
where exists (select * from person p, director d where p.id = d.id and d.production_year = da.production_year and da.title = d.title)
and da.result != 'won';",2018-08-30 01:35:05.539172+10,13,0,357,partially correct
6313,"select *
from appearance natural join role natural join person
where title = 'Psycho' and production_year = '1960'

;",2018-08-30 09:12:35.537618+10,10,0,387,partially correct
6176,"

SELECT COUNT(*)
FROM (person NATURAL JOIN writer_award) AS w 
WHERE 
	lower(w.first_name)='woody'
	AND lower(w.last_name)='allen'
	AND w.production_year>1990
	AND w.production_year<1995
;
",2018-08-30 01:35:15.421279+10,9,1,343,correct
6177,"SELECT p.id,p.firstname,p.lastname
FROM person p, writer w NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-30 01:35:37.015337+10,4,0,106,noninterpretable
6178,"SELECT count(*) 
FROM movie  
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award 
	WHERE lower(movie_award.result) = 'won' and movie_award.title = movie.title and movie_award.production_year = movie.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award  
	WHERE lower(crew_award.result) = 'won' and crew_award.title = movie.title and crew_award.production_year = movie.production_year
	UNION
	SELECT title, production_year 
	FROM director_award  
	WHERE lower(director_award.result) = 'won' and director_award.title = movie.title and director_award.production_year = movie.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award  
	WHERE lower(actor_award.result) = 'won' and actor_award.title = movie.title and actor_award.production_year = movie.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award  
	WHERE lower(writer_award.result) = 'won' and writer_award.title = movie.title and writer_award.production_year = movie.production_year
);
  ",2018-08-30 01:35:48.664059+10,1,0,165,partially correct
6179,"SELECT p.id,p.firstname,p.lastname
FROM person p, writer NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-30 01:36:32.497677+10,4,0,106,noninterpretable
6180,"SELECT p.id,p.firstname,p.lastname
FROM person p, writer NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-30 01:36:40.38164+10,4,0,106,noninterpretable
6181,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT d.id 
FROM director d
WHERE d.id=p.id
GROUP BY d.id);",2018-08-30 01:36:43.827983+10,12,0,163,partially correct
6182,select w.id from (role r natural join appearance a) w group by w.id having count(scene_no)=1;,2018-08-30 01:36:47.318945+10,10,0,270,partially correct
6183,"SELECT p.id,p.first_name,p.last_name
FROM person p, writer NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>=2;",2018-08-30 01:36:59.989597+10,4,0,106,partially correct
6184,"SELECT id, first_name, last_name FROM PERSON WHERE year_born= (SELECT MAX(year_born) FROM PERSON);",2018-08-30 01:37:31.428593+10,7,1,388,correct
6185,"SELECT p.id,p.first_name,p.last_name
FROM person p, writer NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>1;",2018-08-30 01:37:54.176759+10,4,0,106,partially correct
6186,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT d.id 
FROM director d
WHERE d.id=p.id
GROUP BY d.id);",2018-08-30 01:38:40.561307+10,12,1,163,correct
6187,"SELECT p.id,p.first_name,p.last_name
FROM person p, writer NATURAL JOIN director as wd
WHERE p.id=wd.id
GROUP BY p.id
HAVING count(*)>1;",2018-08-30 01:39:20.60964+10,4,0,106,partially correct
6188,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 01:40:11.393492+10,4,1,106,correct
6189,"select 
p.id, da.award_name,
da.year_of_award, 
da.category
from
director_award da,
director d
where
d.title = da.title
and d.production_year = da.production_year
and lower(da.result) = 'nominated'
and d.id not in (select
id 
from
director d,
director_award da
where
d.title = da.title 
and d.production_year = da.production_year 
and da.result = 'won');",2018-08-30 01:41:09.393593+10,13,0,357,noninterpretable
6190,"select 
d.id, da.award_name,
da.year_of_award, 
da.category
from
director_award da,
director d
where
d.title = da.title
and d.production_year = da.production_year
and lower(da.result) = 'nominated'
and d.id not in (select
id 
from
director d,
director_award da
where
d.title = da.title 
and d.production_year = da.production_year 
and da.result = 'won');",2018-08-30 01:41:52.039279+10,13,1,357,correct
6191,"SELECT COUNT(*)
FROM WRITER w  
WHERE (SELECT p.id 
FROM person p
WHERE p.year_born=1935
AND p.id=w.id);",2018-08-30 01:43:28.067601+10,1,0,163,partially correct
6192,"select * from where id in (select count(*) as no_movies,id from director group by id having no_movies>=2 and director.id in
(select id from writer )) as table1;",2018-08-30 01:44:23.935958+10,4,0,16,noninterpretable
6193,"SELECT COUNT(*)
FROM WRITER w  
WHERE (SELECT p.id 
FROM person p
WHERE p.year_born=1935
AND p.id=w.id
GROUP BY p.id);",2018-08-30 01:44:24.972324+10,1,0,163,partially correct
6194,"


SELECT COUNT(*)
FROM WRITER w NATURAL JOIN PERSON p   
WHERE p.year_born=1935;",2018-08-30 01:44:39.38092+10,1,0,163,partially correct
6195,"SELECT id, Count(*)
FROM person p
WHERE year_born = '1935'
GROUP BY person p;",2018-08-30 01:44:54.433505+10,1,0,352,noninterpretable
6196,"with pride as (select title,production_year,award_name,year_of_award,category
from director_award da
where lower(da.result)='nominated'
and not exists (select title,production_year
from director_award da1
where da1.title=da.title
and da1.production_year=da.production_year
and lower(da.result)='won'))

select id,award_name,year_of_award,category
from director,pride
where director.title=pride.title
and director.production_year=pride.production_year;",2018-08-30 01:46:02.295418+10,13,1,397,correct
6197,"select distinct p.id, p.first_name, p.last_name from person p where p.id in (select d.id from director d where exists (select foo.id from (select w.id, count(*) as count from writer w group by w.id) as foo where foo.count>1));",2018-08-30 01:48:13.165153+10,4,0,196,partially correct
6198,select w.id from (role r natural join appearance a) w where w.production_year=1960 and lower(w.title)='psycho' group by w.id having count(w.id)=1;,2018-08-30 01:48:21.655273+10,10,1,270,correct
6199,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 01:49:46.630531+10,1,1,352,correct
6200,"SELECT role.id
FROM role,(SELECT title,production_year,COUNT(*) AS scene_sum
                 FROM scene
		      WHERE lower(title)='psycho'
			       AND production_year=1960) AS h
WHERE h.scene_sum=1
      AND role.title=h.title
	AND role.production_year=h.production_year;",2018-08-30 01:50:26.449402+10,10,0,369,partially correct
6201,"select first_name,last_name from person natural join  (select count(*) as no_movies,id from director group by id having no_movies>=2 and director.id in
(select id from writer )) ;",2018-08-30 01:50:48.963038+10,4,0,16,partially correct
6202,"select count(*)
from movie as m
where not exists ( select * from
(select distinct title,production_year from actor_award
where lower(result) = 'won'
union
select distinct title,production_year from writer_award
where lower(result) = 'won'
union
select distinct title,production_year from director_award
where lower(result) = 'won'
union
select distinct title,production_year from crew_award
where lower(result) = 'won' 
union
select distinct title, production_year from movie_award 
where lower(result) = 'won') as all_movies 
where m.title = all_movies.title
and m.production_year = all_movies.production_year
);",2018-08-30 01:53:07.577775+10,11,1,405,correct
6203,"SELECT title,production_year
FROM movie NATURAL JOIN person NATURAL JOIN writer AS mpw
WHERE mpw.first_name ='Kevin' AND mpw.last_name = 'Williamson';
",2018-08-30 01:53:39.645968+10,5,0,106,noninterpretable
6204,"SELECT mdp.title, mdp.production_year, mdp.first_name, mdp.last_name FROM
(SELECT * FROM MOVIE_AWARD m INNER JOIN DIRECTOR d ON m.title = d.title INNER JOIN PERSON p ON p.id=d.id) AS mdp
WHERE LOWER(mdp.award_name) = 'bafta film award' and LOWER(mdp.category) = 'best film';",2018-08-30 01:53:40.227233+10,8,0,388,partially correct
6205,"select distinct p.id, p.first_name, p.last_name 
from person p where p.id 
in 
(select d.id from director d 
where d.id in (select foo.id from 
(select w.id, count(*) as count from writer w 
group by w.id) as foo where foo.count>1));",2018-08-30 01:55:04.633707+10,4,1,196,correct
6206,"select id
from person p;",2018-08-30 01:55:55.482072+10,14,0,357,partially correct
6315,";
",2018-08-30 09:13:12.464753+10,10,0,249,noninterpretable
6208,"SELECT title,production_year
FROM movie NATURAL JOIN writer AS mw
WHERE id = (SELECT id
             FROM person
             WHERE first_name='Kevin' AND last_name='Williamson');
",2018-08-30 01:57:48.104407+10,5,1,106,correct
6209,"SELECT mdp.title, mdp.production_year, mdp.first_name, mdp.last_name FROM
(SELECT * FROM MOVIE_AWARD m INNER JOIN DIRECTOR d ON m.title = d.title INNER JOIN PERSON p ON p.id=d.id) AS mdp
WHERE LOWER(mdp.award_name) = 'bafta film award' AND LOWER(mdp.category) = 'best film' AND LOWER(mdp.result) = 'won';
",2018-08-30 01:58:59.558888+10,8,1,388,correct
6210,"SELECT id
FROM role NATURAL JOIN scene 
GROUP BY id,title,production_year
HAVING lower(title)='psycho'
       AND production_year=1960
	 AND COUNT(id)=1;",2018-08-30 02:01:58.466606+10,10,0,369,partially correct
6211,"select id 
from person where year_born = 
(select year_born 
from person 
group by year_born 
order by year_born desc limit 1 offset 1)
;",2018-08-30 02:02:33.940915+10,3,1,405,correct
6212,"SELECT id
FROM role NATURAL JOIN appearance 
GROUP BY id,title,production_year
HAVING lower(title)='psycho'
       AND production_year=1960
	 AND COUNT(id)=1;",2018-08-30 02:02:47.37699+10,10,1,369,correct
6213,"select count(*) from movie m, (movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award) d where not exists (select * from movie, (movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award) d where m.title=d.title);",2018-08-30 02:05:02.46659+10,11,0,270,partially correct
6214,"SELECT country
FROM restriction r
WHERE title = 'Shakespeare in Love' AND description ='M';
",2018-08-30 02:07:35.114568+10,6,1,106,correct
6215,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 02:07:49.649538+10,14,1,357,correct
6216,"select count(*) from movie m where not exists (select d.title,d.production_year  from (movie_award natural join crew_award natural join director_award natural join writer_award natural join actor_award) d where m.title=d.title and m.production_year=d.production_year);",2018-08-30 02:09:15.917549+10,11,0,270,partially correct
6217,"SELECT id,first_name,last_name
FROM person p
WHERE year_born = (SELECT MAX(year_born)
                   FROM person);",2018-08-30 02:09:18.083231+10,7,1,106,correct
6218,;,2018-08-30 02:11:22.852591+10,15,0,357,noninterpretable
6219,"select id, award_name, year_of_award, category 
from director as d1, director_award as a1
where lower(result) = 'nominated'
and d1.title = a1.title
and d1.production_year = a1.production_year
and not exists 
(select * 
from director as d2, director_award as a2
where lower(result) = 'won'
and d2.title = a2.title
and d2.production_year = a2.production_year
and d1.id = d2.id
)
;",2018-08-30 02:13:34.377507+10,13,1,405,correct
6220,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 02:26:28.131893+10,15,1,357,correct
6221,"select title, production_year 
from movie m natural join writer w 
where w.id in 
	(select p.id 
	from person p
	where w.id=p.id and p.first_name = ""Kevin"" and p.last_name=""Williamson"");",2018-08-30 02:30:36.876825+10,5,1,196,correct
6222,"select count(*)
from writer w
where (select id from person p where p.id = w.id and p.year_born > 1935);",2018-08-30 02:31:23.757185+10,1,0,357,partially correct
6223,"select count(*)
from writer w
where (select id from person p where p.id = w.id and p.year_born = 1935);",2018-08-30 02:31:42.784265+10,1,0,357,partially correct
6224,"select id from 
(select id, title, production_year from writer
union 
select id, title, production_year from director) 
group by id order by count(*) desc limit 

(select count(*) from (
select id, count(*) as c from 
(select id, title, production_year from writer
union 
select id, title, production_year from director) 
group by id order by c desc ) group by c order by c desc limit 1)


;",2018-08-30 02:34:34.346446+10,14,1,405,correct
6225,"SELECT count(*) 
FROM person  
WHERE EXISTS (SELECT * FROM writer  WHERE writer.id = person.id AND person.year_born = 1935);",2018-08-30 02:34:53.90967+10,1,1,377,correct
6226,"select count(*)
from writer w
where exists (select * from person p where p.id = w.id and p.year_born = 1935);",2018-08-30 02:36:16.417807+10,1,0,357,partially correct
6227,"select m.title,m.production_year
from (movie as m natural join director) as md,person as p
where p.first_name='Kevin' and p.last_name='Williamson';",2018-08-30 02:38:33.433607+10,5,0,223,partially correct
6228,"SELECT production_year, COUNT(*) 
FROM MOVIE 
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991 
GROUP BY production_year;",2018-08-30 02:40:12.27698+10,2,1,50,correct
6229,"SELECT COUNT(*) FROM PERSON p, WRITER_AWARD w
WHERE p.first_name='Woody' AND p.last_name='Allen' AND w.result='won' AND w.year_of_award>=1991 AND w.year_of_award<=1995;",2018-08-30 02:41:56.570321+10,9,0,388,partially correct
6230,"SELECT COUNT(*) FROM PERSON p, WRITER_AWARD w
WHERE LOWER(p.first_name)='Woody' AND LOWER(p.last_name)='Allen' AND LOWER(w.result)='won' AND w.year_of_award>=1991 AND w.year_of_award<=1995;",2018-08-30 02:42:49.828043+10,9,0,388,partially correct
6231,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 02:45:42.901232+10,9,1,388,correct
6232,"select count(*)
from writer w
where exists (select * from person p where p.year_born = 1935);",2018-08-30 02:46:57.259299+10,1,0,357,partially correct
6233,"select first_name, last_name,title, production_year, description 
from role, person, (select id,count(*)as c from role group by id) as aa
where c =
(select MAX(c) from
(select id,count(*)as c from role group by id))
and aa.id = role.id
and aa.id = person.id
;",2018-08-30 02:47:56.22667+10,15,1,405,correct
6234,"select r.country
from restriction as r 
where r.title='Shakespeare in Love' and description='M';",2018-08-30 02:49:43.761331+10,6,1,223,correct
6235,"select count(*) 
from person p
where not exists (select * from director d where d.id = p.id);",2018-08-30 02:59:06.95109+10,12,1,357,correct
6236,"SELECT * FROM role NATURAL JOIN appearance GROUP BY id, title, production_year having
   title = 'Psycho'
   and
   production_year = '1960'
   and
   count(id) = 1;",2018-08-30 03:00:33.197299+10,10,0,388,partially correct
6237,"SELECT id FROM role NATURAL JOIN appearance GROUP BY id, title, production_year having
   title = 'Psycho'
   and
   production_year = '1960'
   and
   count(id) = 1;",2018-08-30 03:00:49.495302+10,10,1,388,correct
6238,"select m.tle, m.oduction_year
from movie m, person p, director d
where p.id = d.id and m.title = d.title and m.production_year = p.production_year and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'wlliamson';",2018-08-30 03:19:48.790377+10,5,0,357,noninterpretable
6239,"select m.title, m.oduction_year
from movie m, person p, director d
where p.id = d.id and m.title = d.title and m.production_year = p.production_year and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'wlliamson';",2018-08-30 03:20:03.206114+10,5,0,357,noninterpretable
6355,"select id
from person
where year_born=(select max (year_born)
			from person
			where year_born< (select max(year_born)
						from person));",2018-08-30 09:55:25.615008+10,3,1,134,correct
6240,"select m.title, m.production_year
from movie m, person p, director d
where p.id = d.id and m.title = d.title and m.production_year = p.production_year and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'wlliamson';",2018-08-30 03:20:25.725761+10,5,0,357,noninterpretable
6241,"select count(*)
from movie 
where production_year=1993 or production_year=1992 or production_year=1991;",2018-08-30 03:20:37.994582+10,2,0,377,partially correct
6242,"select m.title, m.production_year
from movie m, person p, director d
where p.id = d.id and m.title = d.title and m.production_year = d.production_year and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'wlliamson';",2018-08-30 03:21:09.271469+10,5,0,357,partially correct
6243,"select m.title, m.production_year
from movie m, person p, director d
where p.id = d.id and m.title = d.title and m.production_year = d.production_year 
and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';
",2018-08-30 03:22:09.420873+10,5,0,357,partially correct
6244,"select production_year, count(*)
from movie 
where production_year<1994 and production_year>1990
group by production_year;",2018-08-30 03:23:26.540816+10,2,1,377,correct
6245,"select m.title, m.production_year
from movie m, person p, writer w
where p.id = w.id and m.title = w.title and m.production_year = w.production_year 
and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';
",2018-08-30 03:24:23.079569+10,5,1,357,correct
6246,"select country
from restriction
where lower(name) = 'shakespeare in love' and lower(description) = 'm';",2018-08-30 03:27:07.331406+10,6,0,357,noninterpretable
6247,"select id,count(*)
from person, director
where person.id=director.id and director.title=null
group by id;",2018-08-30 03:27:17.153783+10,12,0,377,noninterpretable
6248,"select country
from restriction
where lower(title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-30 03:27:31.014619+10,6,1,357,correct
6249,"select id, first_name, last_name
from person
where year_born = min(select year_born from person);",2018-08-30 03:30:38.080937+10,7,0,357,noninterpretable
6250,"SELECT id, first_name, last_name, Count(*)
FROM Person p
ORDER BY year_born;",2018-08-30 03:31:02.965216+10,7,0,142,partially correct
6251,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-30 03:36:46.867775+10,7,1,142,correct
6252,"select m.title, m.production_year, p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title
and d.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film';",2018-08-30 03:43:49.655919+10,8,0,357,noninterpretable
6253,"select ma.title, ma.production_year, p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title
and d.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film';",2018-08-30 03:44:07.524118+10,8,0,357,partially correct
6254,"select ma.title, ma.production_year, d.first_name, d.last_name
from director d, movie_award ma
where d.title = ma.title and d.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film';",2018-08-30 03:47:04.142743+10,8,0,357,noninterpretable
6255,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM Movie_Award m, person p NATURAL JOIN director d
where p.id = d.id AND
lower(award_name) = 'bafta film award' AND
lower(category) = 'best film' AND lower(result) = 'won';",2018-08-30 03:47:56.682995+10,8,1,142,correct
6256,"select ma.title, ma.production_year, p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id = d.id, d.title = ma.title and d.production_year = ma.production_year and ma.result = 'won'
and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film';",2018-08-30 03:49:09.937288+10,8,0,357,noninterpretable
6257,"select ma.title, ma.production_year, p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year
and lower(ma.award_name) = 'bafta film award' and lower(ma.category) = 'best film' and lower(ma.result) = 'won';",2018-08-30 03:51:14.413268+10,8,1,357,correct
6258,"SELECT count(*) as TOTAL
FROM writer_award wa, person p, writer w
WHERE wa.title = w.title AND wa.production_year = w.production_year
AND wa.id = w.id = p.id
AND lower(RESULT) = 'won'
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
AND year_of_award>=1991
AND year_of_award<=1995;",2018-08-30 03:57:01.553395+10,9,0,142,partially correct
6259,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 03:58:36.328704+10,9,1,142,correct
6260,"select count(*)
from writer_award wa, person p, director d
where p.id = d.id and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'
and wa.year_of_award >= 1991 and wa.year_of_award <= 1995;",2018-08-30 04:00:51.967714+10,9,0,357,partially correct
6261,"select count(*)
from writer_award wa
where (select p.id from person p, director d where p.id = d.id and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'
and wa.year_of_award >= 1991 and wa.year_of_award <= 1995);",2018-08-30 04:04:11.300536+10,9,0,357,partially correct
6262,"select count(*)
from writer_award wa, person p, director d
where p.id = d.id and wa.title = d.title and wa.production_year = d.production_year and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'
and wa.year_of_award >= 1991 and wa.year_of_award <= 1995;",2018-08-30 04:06:32.196725+10,9,0,357,partially correct
6263,"select count(*)
from writer_award wa, person p, director d
where p.id = d.id and wa.title = d.title and wa.production_year = d.production_year and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'
and wa.year_of_award >= 1991 and wa.year_of_award <= 1995 and wa.result = 'won';",2018-08-30 04:07:10.045951+10,9,1,357,correct
6264,"SELECT p.id
FROM Scene s, appearance a, ROLE r
WHERE
     s.title = a.title
	 AND s.production_year = a.production_year
	 AND s.scene_no = a.scene_no
	 AND s.title= r.title
	 AND s.production_year = r.production_year
	 AND a.description = r.description
	 AND lower(a.title) = 'psycho'
	 AND a.production_year = 1960
GROUP BY
r.id
HAVING count(*)= 1;",2018-08-30 04:12:26.306924+10,10,0,142,noninterpretable
6265,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 04:13:17.350741+10,10,1,142,correct
6266,';,2018-08-30 04:17:24.948444+10,11,0,142,noninterpretable
6267,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 04:22:36.797801+10,11,1,142,correct
6268,"SELECT id
FROM person
WHERE year_born = (SELECT max(year_born) FROM person WHERE YEAR_BORN<(select maz(year_born) FROM person));",2018-08-30 04:26:54.152526+10,3,0,142,noninterpretable
6356,"select country from restriction 
where lower(title) = lower('Shakespeare in Love')
and lower(description) = lower('M');
",2018-08-30 09:56:06.192388+10,6,1,92,correct
6269,"select r.id
from scene s, appearance a, role r
where s.title = r.title and s.production_year = r.production_year
and a.scene_no = s.scene_no and a.title = s.title and a.production_year = s.production_year and a.description = s.description
and lower(m.title) = 'psycho' and lower(m.production_year) = 1960;",2018-08-30 04:33:35.581722+10,10,0,357,noninterpretable
6270,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
	FROM person));",2018-08-30 04:39:29.552646+10,3,1,142,correct
6271,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director_award da, director d
WHERE da.title = d.title AND da.production_year = d.production_year
AND lower(da.result) = 'nominated' AND d.id NOT IN (SELECT id FROM director_award da, director d
WHERE da.title = d.title AND da.production_year = d.production_year AND lower(da.result) = 'won');
",2018-08-30 04:58:58.067824+10,13,1,142,correct
6272,;,2018-08-30 05:02:35.715367+10,14,0,142,noninterpretable
6273,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 05:03:39.113654+10,14,1,142,correct
6274,;,2018-08-30 05:04:05.092719+10,15,0,142,noninterpretable
6275,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 05:04:33.220791+10,15,1,142,correct
6276,"SELECT DISTINCT writer.id, person.id, person.year_born FROM writer, person WHERE person.id=writer.id AND person.year_born='1935';",2018-08-30 05:50:34.719307+10,1,0,393,partially correct
6277,"select p.id,
	p.first_name,
	p.last_name
from actor_award as aa,
	person as p,
	role as r
where 
	r.id=p.id
	and aa.title=r.title
	and aa.production_year=r.production_year
	and aa.description =r.description
	and lower(aa.result)='nominated'
	and not exists (select p.id,
				p.first_name,
				p.last_name
			from actor_award as aa,
				person as p,
				role as r
			where 
				r.id=p.id
				and aa.title=r.title
				and aa.production_year=r.production_year
				and aa.description =r.description
				and lower(aa.result)='won')
group by p.id
having count(*)>=2
order by id;",2018-08-30 06:51:49.861535+10,1,0,149,noninterpretable
6278,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-30 07:32:37.278693+10,12,0,189,partially correct
6279,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 07:32:55.212609+10,12,1,189,correct
6280,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;
",2018-08-30 07:34:11.024781+10,4,0,189,partially correct
6281,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 07:35:04.247929+10,5,0,189,partially correct
6282,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 07:36:25.857039+10,6,0,189,partially correct
6283,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-30 07:37:14.97368+10,7,0,189,partially correct
6284,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-30 07:39:28.963147+10,8,0,189,partially correct
6285,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 07:40:37.651064+10,8,1,189,correct
6286,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 07:40:50.467022+10,9,0,189,partially correct
6287,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 07:41:18.927981+10,9,1,189,correct
6288,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 07:41:51.014923+10,10,0,189,partially correct
6289,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 07:42:18.52178+10,10,1,189,correct
6290,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 07:42:57.959915+10,11,0,189,partially correct
6291,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 07:43:23.976418+10,11,1,189,correct
7097,"select id,first_name, last_name from person p natural join director d natural join writer w group by id having count(*) >1;",2018-08-30 15:41:47.906122+10,4,1,172,correct
6292,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 07:44:56.784852+10,3,0,189,partially correct
6293,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 07:45:18.571077+10,3,1,189,correct
6294,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 07:45:38.568745+10,13,0,189,partially correct
6295,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 07:46:01.830791+10,13,1,189,correct
6296,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 07:46:19.649883+10,14,0,189,partially correct
6297,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 07:46:53.463314+10,14,1,189,correct
6298,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 07:47:40.032116+10,15,0,189,partially correct
6299,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 07:48:11.544716+10,15,1,189,correct
6300,"select p1.id,p2.id
from person as p1,
	person as p2,
	writer as w1,
	writer as w2
where p1.id<p2.id
	and p1.id=w1.id
	and p2.id=w2.id
	and w1.title=w2.title
	and w1.production_year=w2.production_year
group by p1.id;
",2018-08-30 08:01:42.563302+10,1,0,149,partially correct
6301,"select p1.id,p2.id
from person as p1,
	person as p2,
	writer as w1,
	writer as w2
where p1.id<p2.id
	and p1.id=w1.id
	and p2.id=w2.id
	and w1.title=w2.title
	and w1.production_year=w2.production_year
group by p1.id;
",2018-08-30 08:01:42.980734+10,1,0,149,partially correct
6302,"select p1.id,p2.id,count(*)
from person as p1,
	person as p2,
	writer as w1,
	writer as w2
where p1.id<p2.id
	and p1.id=w1.id
	and p2.id=w2.id
	and w1.title=w2.title
	and w1.production_year=w2.production_year
group by p1.id,p2.id
having number =(select max(x.number)
					from (
					select p1.id,p2.id,count(*)
					from person as p1,
						person as p2,
						writer as w1,
						writer as w2

					where p1.id<p2.id
						and p1.id=w1.id
						and p2.id=w2.id
						and w1.title=w2.title
						and w1.production_year=w2.production_year
					group by p1.id,p2.id)as x
);
",2018-08-30 08:02:33.106678+10,1,0,149,noninterpretable
6303,"



with sub as (select d.id from director d inner join writer w on w.id=d.id and w.title=d.title and w.production_year=d.production_year
group by d.id having count(*)>=2)
select p.id,first_name,last_name from Person p inner join sub on p.id = sub.id order by p.id;",2018-08-30 08:49:52.571727+10,4,1,19,correct
6304,"



with sub as (select d.id from director d inner join writer w on w.id=d.id and w.title=d.title and w.production_year=d.production_year
group by d.id having count(*)>=2)
select p.id,first_name,last_name from Person p inner join sub on p.id = sub.id ;",2018-08-30 08:50:03.503758+10,4,1,19,correct
6305,"select count(*)
from writer_award as wa
where wa.id =(select id 
				from person 
				where lower(first_name)='woody'
					and lower(last_name)='allen')
	and wa.result='won'
group by wa.id
having year_of_award>='1991'
	and year_of_award<='1995'
;",2018-08-30 08:52:51.191425+10,9,1,46,correct
6306,"



select m.title,m.production_year from Movie m inner join Writer w on m.title = w.title and m.production_year= w.production_year 
inner join person p on p.id=w.id where lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-30 08:54:33.854142+10,5,1,19,correct
6307,"select count(*) as NoOfAwards
from writer_award as wa, writer as w, person as p
where w.id=wa.id
	and w.id= p.id
	and w.title=wa.title
	and w.production_year=wa.production_year
	and lower(p.first_name)='woody'
	and lower(p.last_name)='allen'
	and wa.year_of_award >='1991'
	and wa.year_of_award <='1995'
	and wa.result='won';",2018-08-30 09:01:29.335567+10,9,1,46,correct
6308,"select count(writer.id)
from writer natural join person
where person.year_born = 1935;",2018-08-30 09:04:01.624757+10,1,0,111,partially correct
6309,"select count(distinct writer.id)
from writer natural join person
where person.year_born = 1935;",2018-08-30 09:05:09.414705+10,1,1,111,correct
6310,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) as x1 
		GROUP BY x1.id) as x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) as x1 
			GROUP BY x1.id) as x2);",2018-08-30 09:05:20.671955+10,14,1,238,correct
6311,"select count(*)
from person p natural join writer w natural join writer_award wa
where lower(p.first_name) ='woody'
	and lower(p.last_name) ='allen'
	and wa.result='won'
	and wa.year_of_award >='1991'
	and wa.year_of_award <='1995'
;",2018-08-30 09:08:23.841259+10,9,1,46,correct
6312,"select movie.production_year, count(movie.title)
from movie
where movie.production_year in(1993,1992,1991)
group by movie.production_year;",2018-08-30 09:10:35.691154+10,2,1,111,correct
6314,";
",2018-08-30 09:13:11.62286+10,10,0,249,noninterpretable
6316,"SELECT first_name, last_name, title, production_year, description
FROM PERSON p, ROLE r
WHERE p.id = r.id
AND p.id = (
SELECT id
 FROM(
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id)
WHERE count = (
 SELECT MAX(count) 
  FROM (
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id)))
;",2018-08-30 09:13:45.724274+10,15,1,98,correct
6317,"select id
from appearance natural join role natural join person
where title = 'Psycho' and production_year = '1960'
group by first_name, last_name
having count(*) =1;",2018-08-30 09:16:37.540767+10,10,1,387,correct
6318,"Select *

From Movies K

Where K.Production_year in (1991,1992,1993)

Group by K.Production_year

Order by K.title;",2018-08-30 09:17:12.273861+10,2,0,263,noninterpretable
6319,"select count(person.id)
from person
where not exists (select director.id
                  from director
			where director.id = person.id);",2018-08-30 09:17:50.166174+10,12,1,111,correct
6320,"Select production_year, count(*)

From movie K

Where K.Production_year in (1991,1992,1993)

Group by K.Production_year;",2018-08-30 09:19:35.847252+10,2,1,263,correct
6321,"select distinct count (p.id) 
from person as p, writer as w
where p.id=w.id
and p.year_born = 1935;
",2018-08-30 09:21:39.147244+10,1,0,92,partially correct
6322,"select distinct count (p.id) 
from person as p
where p.id in (select w.id from writer as w)
and p.year_born = 1935;
",2018-08-30 09:23:30.155811+10,1,1,92,correct
6323,"select production_year,count(*)
From movie k
where k.production_year in (1991,1992,1993)
Group by k.production_year;",2018-08-30 09:24:06.551062+10,2,1,263,correct
6324,"select x.id
	from(select x1.id,count(*) as nowork from
	(SELECT d.id, title, production_year 
		FROM director d union 
		SELECT w.id, title, production_year 
		FROM writer w)x1 
		group by x1.id)as x
where x.nowork=
	(select max(nowork)
	from(select x1.id,count(*) as nowork from
	(SELECT d.id, title, production_year 
		FROM director d union 
		SELECT w.id, title, production_year 
		FROM writer w)x1 
		group by x1.id)as x2);",2018-08-30 09:27:02.296093+10,14,1,238,correct
6325,"select count(*)
from person as p
where exists (select * from writer as w where p.id=w.id and p.year_born =1935);",2018-08-30 09:27:28.425402+10,1,1,401,correct
6326,"select m.production_year, count(m.title)
from movie as m
where m.production_year>=1991
and m.production_year <=1993
group by m.production_year;",2018-08-30 09:27:34.627774+10,2,1,92,correct
6327,"select production_year, count(*) from movie where production_year in (1993, 1992, 1991) group by production_year;",2018-08-30 09:28:26.9659+10,2,1,99,correct
6328,"select count(p.id) from person as p
where p.id not in (select d.id from director as d);",2018-08-30 09:29:43.261425+10,12,1,92,correct
6329,"select count(*)
from person as p
where exists (select * from director as d where p.id=d.id);",2018-08-30 09:30:57.163888+10,12,0,401,partially correct
6330,;,2018-08-30 09:32:00.345499+10,11,0,387,noninterpretable
6331,"Select COUNT (Pr.Id) As Person_not_directed

From Person As Pr, Director As Dr

Where Pr.ID!=Dr.Id;",2018-08-30 09:34:22.455088+10,12,0,263,partially correct
6332,"Select COUNT (*)
from person pr
where not exists(select * from director dr
where pr.id= dr.id);",2018-08-30 09:36:39.842742+10,12,1,263,correct
6333,"select person.id, person.first_name, person.last_name
from person, director, writer
where person.id = director.id 
      and director.id = writer.id
      and director.title = writer.title
      and director.production_year = writer.production_year
group by person.id
having count(person.id) = 2;
",2018-08-30 09:38:38.885497+10,4,0,111,partially correct
6334,"select count(w.id) from writer as w, person as p where w.id=p.id and p.year_born=1935;",2018-08-30 09:39:52.453885+10,1,0,99,partially correct
6335,"select count(*)
from person
where not exists(select * from  director where person.id=director.id);",2018-08-30 09:40:03.33445+10,12,1,377,correct
6336,"
SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN writer w NATURAL JOIN director d) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1
;",2018-08-30 09:40:31.359742+10,4,1,128,correct
6337,"select count(*) from (select distinct w.id from writer as w, person as p where w.id=p.id and p.year_born=1935);",2018-08-30 09:41:16.975091+10,1,1,99,correct
6338,"select person.id, person.first_name, person.last_name
from person, director, writer
where person.id = director.id 
      and director.id = writer.id
      and director.title = writer.title
      and director.production_year = writer.production_year
group by person.id
having count(person.id) >= 2;
",2018-08-30 09:41:34.362921+10,4,1,111,correct
6339,"select p.id, p.first_name, p.last_name from person as p, 
(select count(d.id) as countD, d.id as did from director d where d.id in (select w.id from writer as w) group by d.id) as dcount
 where p.id = dcount.did 
 and dcount.countD>1;",2018-08-30 09:42:01.275053+10,4,0,92,partially correct
6340,"select count(*)
from person pr
where exisit (select * from director dr,writer wr 
              where pr.id=dr.id and pr.id = wr.id;",2018-08-30 09:43:18.506155+10,4,0,263,noninterpretable
6341,"select id 
from (select * 
	from role r, scene s, appearance a
	where s.title = a.title
		and s.production_year=a.production_year
		and s.scene_no = a.scene_no
		and a.title=r.title
		and a.production_year=r.production_year
		and a.description=r.description
		and lower(s.title)='psycho'
		and s.production_year='1960') as rsa
group by id
having count(*) = 1;

",2018-08-30 09:43:34.961502+10,10,1,46,correct
6342,"select id, first_name,last_name
from person
where exists (select count(*) from director, person where writer.id=director.id and count(*)>=2);",2018-08-30 09:45:56.653762+10,4,0,377,noninterpretable
6343,"select p.id, p.first_name, p.last_name, dcount.countD from person as p, 
  (select distinct count(d.id) as countD, d.id as did 
  from director d, writer as w 
  where d.id = w.id
  and d.title = w.title
  and d.production_year = w.production_year
  group by d.id) as dcount
 where p.id = dcount.did 
 and dcount.countD>1;",2018-08-30 09:46:06.117711+10,4,0,92,partially correct
6344,select * from person;,2018-08-30 09:46:21.729524+10,15,0,238,partially correct
6345,"select p.id, p.first_name, p.last_name, dcount.countD from person as p, 
  (select distinct count(d.id) as countD, d.id as did 
  from director d, writer as w 
  where d.id = w.id
  and d.title = w.title
  and d.production_year = w.production_year) as dcount
 where p.id = dcount.did 
 and dcount.countD>1;",2018-08-30 09:46:26.954412+10,4,0,92,partially correct
6346,"select p.id, p.first_name, p.last_name, dcount.countD from person as p, 
  (select distinct count(d.id) as countD, d.id as did 
  from director d, writer as w 
  where d.id = w.id
  and d.title = w.title
  and d.production_year = w.production_year) as dcount
 where p.id = dcount.did 
 and dcount.countD>1;",2018-08-30 09:46:34.042328+10,4,0,92,partially correct
6347,"select p.id, p.first_name, p.last_name from person as p, 
  (select count(d.id) as countD, d.id as did 
  from director d, writer as w 
  where d.id = w.id
  and d.title = w.title
  and d.production_year = w.production_year
  group by d.id) as dcount
 where p.id = dcount.did 
 and dcount.countD>1;",2018-08-30 09:47:36.637193+10,4,1,92,correct
6348,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-30 09:47:38.567033+10,12,1,401,correct
6349,"SELECT COUNT(*)
FROM(SELECT DISTINCT person.year_born, writer.id
     FROM person, writer
     WHERE person.id = writer.id AND person.year_born = '1935');
",2018-08-30 09:48:29.11065+10,1,1,165,correct
6350,"select dw.id, dw.first_name, dw.last_name
from (person p NATURAL JOIN director natural join writer) as dw
group by dw.id
having count(*)>1;
",2018-08-30 09:49:11.810416+10,4,1,263,correct
6351,"select writer.title, writer.production_year
from writer, person
where person.id = writer.id
	and person.first_name = 'Kevin'
	and person.last_name = 'Williamson';",2018-08-30 09:51:22.570602+10,5,1,111,correct
6352,"select w.title, w.production_year from writer as w, person as p
where lower(p.first_name) = 'kevin'
and lower(p.last_name) = 'williamson'
and p.id = w.id;",2018-08-30 09:51:28.100227+10,5,1,92,correct
6353,"




SELECT movie.Production_year, COUNT(*) 
FROM movie
WHERE movie.production_year IN(1991,1992,1993)
GROUP BY movie.production_year;",2018-08-30 09:51:56.522509+10,2,1,165,correct
6354,"select id
from person
where year_born=select max year_born
			from person
			group by year_born)-1;",2018-08-30 09:52:09.051718+10,3,0,134,noninterpretable
6357,"select *
from movie_award ma, 
	crew_award ca, 
	director_award da, 
	writer_award wa, 
	actor_award aa
where result = 'won';",2018-08-30 09:56:15.081342+10,11,0,46,noninterpretable
6358,"select m.title
from movie m
where pr.id=m.id in (select pr.id from person pr where pr.first_name = Kevin and pr.last_name= Williamson);",2018-08-30 09:57:36.905819+10,5,0,263,noninterpretable
6359,"select country 
from restriction 
where title = 'Shakespeare in Love'
       and description = 'M';",2018-08-30 09:59:38.363489+10,6,1,111,correct
6360,"select p.id, p.first_name, p.last_name from person as p
where year_born in (select max(year_born) from person);",2018-08-30 10:00:15.156301+10,7,1,92,correct
6361,"select p.id, p.first_name, p.last_name
from person as p
where exists (select count(*) from writer as w,director as d  
where w.id =d.id and w.title =d.title )>2;",2018-08-30 10:02:40.067854+10,4,0,401,partially correct
6362,"select id, first_name, last_name
from person
group by year_born
having max(year_born);",2018-08-30 10:03:38.161532+10,7,0,111,partially correct
6363,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
   (select id,count(*) as noact from role r
   group by r.id)x
where 
     p.id=r.id and
	p.id=x.id and
	x.noact=(select max(actno)from
	(select id,count(*) as actno from role r
	group by r.id)x1);",2018-08-30 10:04:28.008914+10,15,1,238,correct
6364,"
with sub as (select distinct wa.id, count(*) as total from Writer_Award wa inner join Writer w on w.title=wa.title and w.production_year=wa.production_year and w.id=wa.id where year_of_award between 1991 and 1995  and lower(result)='won' group by wa.id,wa.title,wa.production_year)
select total from sub inner join Person p on p.id=sub.id where lower(p.first_name)='woody' and lower(p.last_name)='allen';",2018-08-30 10:05:29.734095+10,9,1,19,correct
6365,"SELECT COUNT(*) 
FROM person
WHERE NOT EXISTS (SELECT DISTINCT director.id, movie.title, movie.production_year
                  FROM director, movie
                  WHERE director.id = person.id AND director.title = movie.title AND director.production_year = movie.production_year);",2018-08-30 10:05:48.689993+10,12,1,165,correct
6366,"select count(*)
from
(
select p.id
from person as p,
	writer as w
where 
	p.id=w.id
	p.year_born=1935
);",2018-08-30 10:06:38.747282+10,1,0,149,noninterpretable
6367,"select count(*), m.production_year
from movie m
where m.production_year>1990
AND m.production_year<1994
group by m.production_year;",2018-08-30 10:07:18.053905+10,2,1,79,correct
6368,"select count(*)
from
(
select p.id
from person as p,
	writer as w
where 
	p.id=w.id
	and p.year_born=1935
);",2018-08-30 10:07:21.135115+10,1,0,149,partially correct
6369,"
SELECT PERSON.first_name, PERSON.last_name, ROLE.title, ROLE.production_year, ROLE.description
from ROLE LEFT JOIN PERSON ON ROLE.id= PERSON.id
WHERE ROLE.id IN (SELECT Q15.id 
                  from (select id, count(*) AS idnumber
                        from ROLE
                        GROUP BY ROLE.id) AS Q15
                   WHERE Q15.idnumber =
                        ( select MAX(Q152.idnumber)
                           from  (select R1.id, count(*) AS idnumber
                                   from ROLE R1
                                   GROUP BY R1.id) AS Q152 ));",2018-08-30 10:07:36.812401+10,15,1,139,correct
6370,"select *
from
(
select distinct p.id
from person as p,
	writer as w
where 
	p.id=w.id
	and p.year_born=1935
);",2018-08-30 10:08:05.467534+10,1,0,149,partially correct
6371,"select dw.id, dw.first_name, dw.last_name
from (person  natural join director natural join writer) as dw
group by dw.id
Having count(*)>1;",2018-08-30 10:08:28.089297+10,4,1,377,correct
6372,"select count(*)
from
(
select distinct p.id
from person as p,
	writer as w
where 
	p.id=w.id
	and p.year_born=1935
);",2018-08-30 10:08:45.339031+10,1,1,149,correct
6373,"select count(*)
from
(
select distinct p.id
from person as p,
	writer as w
where 
	p.id=w.id
	and p.year_born=1935
);",2018-08-30 10:09:01.47663+10,1,1,149,correct
6374,"select id, first_name, last_name
from person
where year_born = (select max (year_born)
	from person);",2018-08-30 10:10:00.620045+10,7,1,111,correct
6375,"select count(*)
from person p
where p.id not in(select d.id
                from director d
                     where d.id=p.id);
",2018-08-30 10:10:53.9502+10,12,1,79,correct
6376,"select wr.title,wr.production_year
from writer wr,
     person pr
where pr.id=wr.id 
and lower(first_name)= 'kevin' 
and lower(last_name)='williamson';",2018-08-30 10:11:05.803744+10,5,1,263,correct
6377,"select mw.title ,mw.production_year
from (movie inner join writer inner join person) as mw
group by wd.title
where person.first_name=Williamson and person.last_name=Kevin;",2018-08-30 10:13:04.747168+10,5,0,377,noninterpretable
6378,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 10:13:46.608928+10,5,1,377,correct
6379,"
with sub as (select id,from Role rl inner join Appearance app on rl.title=app.title and rl.production_year=app.production_year and rl.description =app.description
where app.title like'Psycho' and app.production_year =1960 group by id count(scene_no)=1)
select id from sub;",2018-08-30 10:13:52.249674+10,10,0,19,noninterpretable
6380,"select rt.country
from restriction rt
where lower(rt.title)='Shakespeare in Love';",2018-08-30 10:15:06.78692+10,6,0,263,partially correct
6381,"select country
from restriction
where title='Shakespeare in Love' and description='M';",2018-08-30 10:15:50.86336+10,6,1,377,correct
6382,"select p.id, p.first_name, p.last_name
from person as p,director as d, writer as w
where p.id =d.id and d.id =w.id and d.title =w.title
group by p.id 
having count(*)>1;",2018-08-30 10:16:15.94238+10,4,1,401,correct
6383,"SELECT COUNT(*)
FROM writer, person
WHERE person.id=writer.id AND person.year_born=1935;
",2018-08-30 10:16:58.540797+10,1,0,382,partially correct
6384,"select p.id,p.first_name,p.last_name
from person p, director d, writer w 
where p.id=w.id
AND w.id=d.id
AND w.title=d.title
AND w.production_year=d.production_year
group by p.id
having count(*)>1;",2018-08-30 10:18:20.049849+10,4,1,79,correct
6385,"select ma.title, ma.production_year, p.first_name, p.last_name from movie_award as ma, director as d, person as p
where lower(ma.award_name) = lower('BAFTA Film Award')
and lower(ma.category) = lower('Best Film')
and lower(ma.result) = lower('won')
and ma.title = d.title
and ma.production_year = d.production_year
and d.id = p.id;
",2018-08-30 10:18:20.286139+10,8,1,92,correct
6386,"select
rt.country
from 
restriction rt
where 
lower(rt.title)='shakespeare in love'
and description= 'M';",2018-08-30 10:19:02.394496+10,6,1,263,correct
6387,"
SELECT writer.id, person.first_name, person.last_name
FROM writer, director, person,movie
WHERE writer.id= director.id AND writer.id = person.id AND director.id = person.id
      AND writer.title = director.title AND writer.production_year = director.production_year
	AND writer.title = movie.title AND writer.production_year = movie.production_year
	AND director.title = movie.title AND director.production_year = movie.production_year
GROUP BY director.id
HAVING COUNT(*)>=2;",2018-08-30 10:19:08.052335+10,4,1,165,correct
6388,"select p.first_name,p.last_name,r2.title,r2.production_year,r2.description
from person p
	natural join
    role r2
where r2.id = 
				(select r.id
				from role r
				group by r.id
				having count(*) = (select max(num)
									from (select count(*) as num
											from role r1
											group by r1.id) as sub));",2018-08-30 10:19:36.033994+10,15,1,43,correct
6389,"select id,first_name, last_name
from person
where max(year_born);",2018-08-30 10:19:43.842078+10,7,0,377,noninterpretable
6390,"select m.title,m.production_year from movie m where m.title in 
(select w.title from writer w where w.id =(select p.id from person p 
where p.first_name like ""%Kevin%"" and p.last_name like ""%Williamson%""));",2018-08-30 10:20:16.918524+10,5,1,130,correct
6391,"select id,first_name, last_name
from person
where person.year_born=(select max(year_born)
from person);",2018-08-30 10:21:03.251586+10,7,1,377,correct
6392,"select w.title, w.production_year
from person p, writer w
where p.id=w.id
AND lower(p.first_name)='kevin'
AND lower(p.last_name)='williamson';
",2018-08-30 10:23:21.219842+10,5,1,79,correct
6393,"SELECT p.id from person as p, (select id, max(year_born) as max_year from person) as pp
where p.year_born=pp.max_year and p.id=pp.id;",2018-08-30 10:23:27.122307+10,3,0,385,partially correct
6394,"select m.title, m.production_year
from movie as m
where exists (select * from writer as w,person as p where w.title =m.title
			and w.id =p.id  and p.first_name ='Kevin'and p.last_name = 'Williamson');",2018-08-30 10:23:38.023754+10,5,1,401,correct
6395,"SELECT movie.title, movie.production_year
FROM movie, writer, person
WHERE person.id = writer.id AND person.first_name = 'Kevin' AND person.last_name = 'Williamson'
      AND writer.title = movie.title AND writer.production_year = movie.production_year;",2018-08-30 10:24:01.329152+10,5,1,165,correct
6396,"SELECT COUNT(*)
FROM person p
WHERE p.year_born = '1935'
	AND p.id IN (SELECT w.id
				FROM writer w);",2018-08-30 10:24:58.285756+10,1,1,340,correct
6397,"select count(wa.id) from writer_award as wa, person as p
where lower(p.first_name) = lower('Woody')
and lower(p.last_name) = lower('Allen')
and p.id = wa.id
and year_of_award >= 1991
and year_of_award <= 1995
group by wa.id;
",2018-08-30 10:25:22.163073+10,9,0,92,partially correct
6398,"select count(*) as num from PERSON as p
where p.id in
		(select w.id from WRITER as w)
		and p.year_born = '1935';",2018-08-30 10:25:30.585183+10,1,1,167,correct
6399,"select r.country
from restriction r 
where lower(r.title)='shakespeare in love'
AND lower(r.description)='m';",2018-08-30 10:26:06.579068+10,6,1,79,correct
6400,"SELECT p.id from person as p
where p.year_born=(select max(year_born)  from person where year_born<(select max(year_born) from person));",2018-08-30 10:26:15.585838+10,3,1,385,correct
6401,"select country from restriction where lower(title) like '%shakespeare in love%' and 
lower(description) like '%m%' ;",2018-08-30 10:26:31.647728+10,6,1,130,correct
6402,"select r.country 
from restriction as r
where r.title ='Shakespeare in Love' and r.description='M';",2018-08-30 10:27:45.073433+10,6,1,401,correct
6403,"SELECT COUNT(*)
FROM movie m
WHERE m.production_year>1990
	AND m.production_year<1994
GROUP BY m.production_year;",2018-08-30 10:28:02.498987+10,2,0,340,partially correct
6404,"select production_year,count(*) as num from MOVIE
where production_year = '1993' or production_year = '1992' or production_year = '1991'
group by production_year;",2018-08-30 10:28:31.224448+10,2,1,167,correct
6405,"SELECT restriction.country
FROM restriction, restriction_category, movie
WHERE restriction.description = 'M' AND restriction.title = 'Shakespeare in Love'
      AND restriction.title = movie.title AND restriction.production_year = movie.production_year
	AND restriction.description = restriction_category.description AND restriction.country = restriction_category.country;
",2018-08-30 10:29:04.758587+10,6,1,165,correct
6406,"SELECT m.production_year, COUNT(*)
FROM movie m
WHERE m.production_year>1990
	AND m.production_year<1994
GROUP BY m.production_year;",2018-08-30 10:29:37.865601+10,2,1,340,correct
6407,"select count(wa.id) from writer_award as wa, person as p
where lower(p.first_name) = lower('Woody')
and lower(p.last_name) = lower('Allen')
and p.id = wa.id
and wa.year_of_award >= 1991
and wa.year_of_award <= 1995
and lower(wa.result) = 'won'
group by wa.id;


",2018-08-30 10:30:15.962422+10,9,1,92,correct
6408,"select count(*) as numOfPerson from PERSON as p
where p.id not in 
			(select d.id from DIRECTOR as d);",2018-08-30 10:30:45.644138+10,12,1,167,correct
6409,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born)
                       from person p);",2018-08-30 10:30:48.968382+10,7,1,79,correct
6410,";
",2018-08-30 10:30:53.150666+10,11,0,139,noninterpretable
6411,"SELECT DISTINCT person.id, person.first_name, person.last_name
FROM person
ORDER BY person.year_born DESC
LIMIT 1;

",2018-08-30 10:31:35.45511+10,7,1,165,correct
6412,"select p.id,p.first_name,p.last_name
from person as p
where year_born =(select MAX(year_born)from person);",2018-08-30 10:31:38.026237+10,7,1,401,correct
6413,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN (
	SELECT d.id
	FROM director d);",2018-08-30 10:31:50.284279+10,12,1,340,correct
6414,"select title, production_year, first_name, last_name 
from person,( select movie_award.*, id from movie_award, director
where movie_award.production_year=director.production_year and
movie_award.title=director.title and lower(result)='won' and lower(award_name)='bafta film award'and lower(category)='best film') m
where m.id=person.id
;

",2018-08-30 10:32:09.281188+10,8,1,197,correct
6415,"select pr.first_name, pr.last_name,pr.id
from person pr
where exisit 
group by min(pr.year_born);",2018-08-30 10:33:10.074028+10,7,0,263,noninterpretable
6416,"with sub as (select d.id,d.title,d.production_year
		from director d
		Union
		select w.id,w.title,w.production_year
		from writer w)
select sub.id
from sub
group by sub.id
having count(*) = (select max(num)
					from (select count(*) as num
							from sub
                            group by sub.id) as sub2
								);


",2018-08-30 10:33:31.042204+10,14,1,43,correct
6417,"select d.id,da.award_name,da.years_of_award,da.categories
from  director_award as da,
	director as d
where d.title =da.title 
	and d.production_year = da.production_year 
	and lower(da.result) = ""nominated"" 
	and not exists (select *
				from da
				where lower(da.result)=""won"");",2018-08-30 10:34:05.977674+10,13,0,134,noninterpretable
6418,"select p.id, p.first_name, p.last_name from PERSON as p
where p.id in
		(select d.id from DIRECTOR as d, WRITER as w
		where d.id = w.id and d.title = w.title and d.production_year = w.production_year
		group by d.id
		having count(*)>1);",2018-08-30 10:34:20.862625+10,4,1,167,correct
6419,"SELECT count(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE p.id=w.id AND p.year_born=1935);
",2018-08-30 10:34:52.281662+10,1,1,382,correct
6420,"select p2.id,p2.first_name, p2.last_name from person p2 where
p2.year_born= (select max(year_born) from person p1);",2018-08-30 10:35:02.403303+10,7,1,130,correct
6421,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, person p, director d
where d.id=p.id
AND d.title=ma.title
AND d.production_year=ma.production_year
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film'
AND lower(result)='won';",2018-08-30 10:36:12.214159+10,8,1,79,correct
6422,"WITH dwm AS(
	SELECT id, COUNT(*) AS count
	FROM writer NATURAL JOIN director NATURAL JOIN person
	GROUP BY id)
SELECT dwm.id, p.first_name, p.last_name
	FROM dwm, person p
	WHERE dwm.id = p.id
		AND dwm.count > 1;",2018-08-30 10:36:39.237434+10,4,1,340,correct
6423,"select w.title, w.production_year from WRITER as w
where w.id in
		(select p.id from PERSON as p
		where p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-30 10:36:40.482257+10,5,1,167,correct
6424,"SELECT production_year,COUNT(*)
FROM MOVIE 
GROUP BY production_year HAVING production_year BETWEEN 1991 AND 1993;",2018-08-30 10:36:42.218114+10,2,1,182,correct
6425,"select first_name, last_name,id
from person pr
where pr.year_born=(select max(year_born) from person);",2018-08-30 10:37:02.231744+10,7,1,263,correct
6426,"select id,first_name, last_name
from person pr
where pr.year_born=(select max(year_born) from person);",2018-08-30 10:37:48.69179+10,7,1,263,correct
6427,"SELECT id, COUNT(*) AS count
FROM writer NATURAL JOIN director NATURAL JOIN person
GROUP BY id
HAVING count>1;",2018-08-30 10:38:23.657707+10,4,0,340,partially correct
6428,"select country from RESTRICTION
where lower(title) = 'shakespeare in love' and lower(description) = 'm'; ",2018-08-30 10:38:25.463242+10,6,1,167,correct
6429,"select d.id,da.award_name,da.year_of_award,da.category
from  director_award as da,
	director as d
where d.title =da.title 
	and d.production_year = da.production_year 
	and lower(da.result) = ""nominated"" 
	and not exists (select *
				from director_award
				where lower(da.result)=""won"");",2018-08-30 10:38:43.806259+10,13,1,134,correct
6430,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-30 10:38:51.546268+10,2,1,382,correct
6431,"SELECT id, first_name, last_name
FROM writer NATURAL JOIN director NATURAL JOIN person
GROUP BY id
HAVING COUNT(*)>1;",2018-08-30 10:39:22.798104+10,4,1,340,correct
6509,"select p2.id from person p2
where p2.year_born = (select max(year_born) from person as p where p.year_born != (select max(year_born) from person));",2018-08-30 11:14:14.203401+10,3,1,92,correct
6432,"with sub as (
select *
from 	director 
		natural join
		director_award)
select sub.id,sub.award_name,sub.year_of_award,sub.category
from sub
where lower(sub.result) = 'nominated' 
and not exists(select *
				from sub as sub2
					where sub2.id = sub.id
							and 
							lower(sub2.result) = 'won');",2018-08-30 10:39:46.026714+10,13,1,43,correct
6433,"select m.title, m.production_year
from movie_award as m 
where m.award_name ='BAFTA Film Award'and m.category='Best Film';",2018-08-30 10:40:49.946774+10,8,0,401,partially correct
6434,"select r.country from restriction r where
	r.title='Shakespeare in Love' and r.description='M';",2018-08-30 10:40:52.733822+10,6,1,32,correct
6435,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id
AND lower(p.first_name) = 'kevin'
AND lower(p.last_name) = 'williamson';",2018-08-30 10:41:28.420704+10,5,1,340,correct
6436,"select id, first_name, last_name from PERSON
where PERSON.year_born in
				(select p.year_born from PERSON as p
				order by p.year_born DESC
				limit 1);",2018-08-30 10:42:01.036243+10,7,1,167,correct
6437,"Select movie name
;",2018-08-30 10:43:17.636354+10,8,0,189,noninterpretable
6438,"select s.rid from
(select count(ap.scene_no) as countscene, rl.id as rid from appearance as ap, role as rl
where ap.title = rl.title
and ap.production_year = rl.production_year
and ap.description = rl.description
group by rl.id) as s
where s.countscene = 1;",2018-08-30 10:43:27.095649+10,10,0,92,partially correct
6439,SELECT * movie ;,2018-08-30 10:43:57.937519+10,8,0,189,noninterpretable
6440,"select m.title, m.production_year, p.first_name,p.last_name 
from person p, director d, movie_award m
where
p.id = d.id
and 
d.title = m.title
and 
lower(m.award_name) like'%bafta Film award%'
and 
lower(m.category) like '%best film%'
and 
lower(m.result) like '%won%';",2018-08-30 10:44:02.772237+10,8,0,130,partially correct
6441," select count(*)
 from writer_award wa
 where exists (select *
                  from person p 
                   where  p.first_name='Woody'
				   AND p.last_name='Allen'
				   AND wa.id=p.id)
				   AND wa.year_of_award>1990
				   AND wa.year_of_award<1996
				   AND lower(wa.result)='won';
",2018-08-30 10:44:14.273757+10,9,1,79,correct
6442,"SELECT r.country
FROM restriction r
WHERE lower(r.title) = 'shakespeare in love'
	AND r.description = 'M';",2018-08-30 10:44:26.879694+10,6,1,340,correct
6443,"SELECT * title 
FROM MOVIE;",2018-08-30 10:44:53.228781+10,8,0,189,noninterpretable
6444,"SELECT  title 
FROM MOVIE;",2018-08-30 10:45:10.568616+10,8,0,189,partially correct
6445,"select p.id, p.first_name, p.last_name from person p where
	p.year_born=(select max(year_born) from person);",2018-08-30 10:45:14.157227+10,7,1,32,correct
6446,"select m.title, m.production_year, p.first_name,p.last_name 
from person p, director d, movie_award m
where
p.id = d.id
and 
d.title = m.title
and 
d.production_year = m.production_year
and
lower(m.award_name) like'%bafta Film award%'
and 
lower(m.category) like '%best film%'
and 
lower(m.result) like '%won%';",2018-08-30 10:45:29.662769+10,8,0,130,partially correct
6447,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS ( SELECT id FROM director WHERE person.id=director.id);",2018-08-30 10:46:01.148716+10,12,1,382,correct
6448,"SELECT 
	id, first_name, last_name
FROM
	person p
WHERE
	p.year_born = (SELECT MAX(year_born)
				FROM person);",2018-08-30 10:46:18.747011+10,7,1,340,correct
6449,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS ( SELECT * FROM director WHERE person.id=director.id);",2018-08-30 10:46:20.659688+10,12,1,382,correct
6450,"select ma.title, ma.production_year, p.first_name, p.last_name
from PERSON as p, DIRECTOR as d, MOVIE_AWARD as ma
where p.id = d.id and d.title = ma.title and d.production_year = ma.production_year
	and lower(ma.award_name) = 'bafta film award' 
	and lower(ma.category) = 'best film' and lower(ma.result) = 'won';",2018-08-30 10:47:12.343208+10,8,1,167,correct
6451,"select distinct d.id, da.award_name, da.year_of_award, da.category from director as d, director_award as da
where  lower(da.result)='nominated' and lower(da.result) !='won';",2018-08-30 10:47:15.551611+10,13,0,385,partially correct
6452,"select s.rid from
(select count(ap.scene_no) as countscene, rl.id as rid from appearance as ap, role as rl
where ap.title = rl.title
and ap.production_year = rl.production_year
and ap.description = rl.description
and lower(ap.title) = lower('Psycho')
and ap.production_year = 1960
group by rl.id) as s
where s.countscene = 1;
",2018-08-30 10:47:28.896976+10,10,1,92,correct
6453,"select ad.title, ad.production_year, pr.first_name,pr.last_name
from movie_award ad, person pr
where lower(ad.movie_award)='bafta film award'
and lower(ad.category)='best film';",2018-08-30 10:48:00.886114+10,8,0,263,noninterpretable
6454," select distinct person.id, first_name, last_name
from person, (select writer.id from director, writer 
where director.id=writer.id
and director.title=writer.title
and director.production_year=writer.production_year
group by writer.id
having count(writer.id)>1) as h
where person.id=h.id;",2018-08-30 10:48:12.222155+10,4,1,140,correct
6455,"select distinct d.id, da.award_name, da.year_of_award, da.category from director as d, director_award as da
where  d.title=da.title and d.production_year=da.production_year and  lower(da.result)='nominated' and lower(da.result) !='won';",2018-08-30 10:49:03.461845+10,13,1,385,correct
6456,"select count(*)
from writer_award
where writer_award.id=(select id from person
where first_name='Woody' and last_name='Allen')
group by result having year_of_award> 1990
and year_of_award<1996
and lower(result)='won';
",2018-08-30 10:49:34.774818+10,9,1,197,correct
6457,"SELECT person.id, first_name, last_name
FROM person
WHERE EXISTS  (SELECT director.id FROM director, writer WHERE director.id=writer.id);",2018-08-30 10:49:45.825626+10,4,0,382,partially correct
6458,"SELECT M.TITLE,M.PRODUCTION_YEAR
FROM MOVIE M
INNER JOIN WRITER W ON M.TITLE=W.TITLE
INNER JOIN PERSON P ON W.ID=P.ID
WHERE TOLOWER(P.FIRST_NAME)='kevin' AND tolower(P.LAST_NAME)='williamson';",2018-08-30 10:50:35.316596+10,5,0,182,noninterpretable
6459,"SELECT M.TITLE,M.PRODUCTION_YEAR
FROM MOVIE M
INNER JOIN WRITER W ON M.TITLE=W.TITLE
INNER JOIN PERSON P ON W.ID=P.ID
WHERE LOWER(P.FIRST_NAME)='kevin' AND lower(P.LAST_NAME)='williamson';",2018-08-30 10:50:59.975807+10,5,1,182,correct
6460,"select count(*) as num from WRITER_AWARD as wa
where wa.id in
		(select p.id from PERSON as p
		where p.first_name = 'Woody' and p.last_name = 'Allen')
		and wa.year_of_award between '1991' and '1995';",2018-08-30 10:51:09.677516+10,9,0,167,partially correct
6461,"select p.id
from person p, appearance a, role r
where p.id=r.id
AND r.title=a.title
AND r.production_year=a.production_year
AND r.description=a.description
AND lower(r.title)='psycho'
AND r.production_year=1960
group by p.id
Having count(*)=1;

",2018-08-30 10:51:10.47603+10,10,1,79,correct
6462,"select count(*) as num from WRITER_AWARD as wa
where wa.id in
		(select p.id from PERSON as p
		where p.first_name = 'Woody' and p.last_name = 'Allen')
		and wa.year_of_award between '1991' and '1995'
		and lower(result) = 'won';",2018-08-30 10:51:41.890838+10,9,1,167,correct
6463,"select m.title, m.production_year, p.first_name,p.last_name 
from person p, director d, movie_award m
where
p.id = d.id
and 
d.title = m.title
and 
d.production_year = m.production_year
and
m.award_name like 'bafta Film award'
and 
m.category like 'best film'
and 
m.result like  'won';",2018-08-30 10:51:43.187582+10,8,1,130,correct
6464,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
		from movie_award
		where award_name = 'BAFTA Film Award'
		and category = 'Best Film'
		and result  = 'won') as ma,
		director as d,
		person as p
where ma.title  = d.title
and d.id = p.id
and ma.production_year = d.production_year;",2018-08-30 10:51:44.126322+10,8,0,111,partially correct
6465,"SELECT id
 FROM
  (SELECT *, COUNT(*) AS count
    FROM(
      SELECT w.id, title, production_year
        FROM WRITER w
      UNION
      SELECT d.id,title, production_year
        FROM DIRECTOR d) wd
    GROUP BY wd.id)
WHERE count = (SELECT MAX(count) 
  FROM
  (SELECT *, COUNT(*) AS count
    FROM(
      SELECT w.id, title, production_year
        FROM WRITER w
      UNION
      SELECT d.id,title, production_year
        FROM DIRECTOR d) wd
    GROUP BY wd.id));",2018-08-30 10:51:59.759906+10,14,1,76,correct
6466,"WITH adp AS(SELECT *
		FROM (movie_award NATURAL JOIN director NATURAL JOIN person))
SELECT adp.title, adp.production_year, adp.first_name, adp.last_name
FROM adp
WHERE lower(adp.award_name) = 'bafta film award'
	AND lower(adp.category) = 'best film'
	AND lower(adp.result) = 'won';",2018-08-30 10:52:31.782711+10,8,1,340,correct
6467,"select m.title,m.production_year from movie_award m where
	m.award_name='BAFTA Film Award' and m.category='Best Film';",2018-08-30 10:53:29.551076+10,8,0,32,partially correct
6468,"select r.id
from role r
where r.title='Psycho'and r.production_year=1960 and r.description in(select a.description from appearance a 
where a.title ='Psycho'and a.production_year=1960 group by a.description having count(*)=1)
group by r.id
having count(*)=1;
",2018-08-30 10:53:35.606918+10,10,1,338,correct
6469,"

SELECT movie.title, movie.production_year,person.first_name, person.last_name
FROM person,director,movie
WHERE EXISTS (SELECT movie.title, movie.production_year
              FROM  award,movie_award 
              WHERE movie_award.award_name = 'BAFTA Film Award' AND movie_award.category = 'best film' AND lower(movie_award.result) ='won'
                    AND movie_award.award_name = award.award_name
	              AND movie_award.title = movie.title AND movie_award.production_year = movie.production_year)
	AND person.id = director.id 
	AND director.title =movie.title AND director.production_year = movie.production_year;
",2018-08-30 10:54:16.107259+10,8,1,165,correct
6470,"select p.id, p.first_name, p.last_name from person p, director d, writer w where p.id = d.id and p.id = w.id and w.id = d.id and  d.title = w.title and d.production_year = w.production_year
group by w.id having count (*)>= 2;",2018-08-30 10:54:32.603897+10,4,1,99,correct
6471,"select m.title, m.production_year,p.first_name,p.last_name
from movie_award as m, person as p,director as d
where m.category='best film'and m.award_name='BAFTA Film Award'and result ='won' and p.id =d.id 
and d.title=m.title;",2018-08-30 10:56:19.728717+10,8,1,401,correct
6472,"select w.title, w.production_year, pr.first_name,pr.last_name
from (select title,production_year
from movie_award
where lower(award_name)='bafta film award'
and lower(category)='best film'
and lower(result)='won') as w,
person pr,
director dr
where dr.title=w.title
and dr.id=pr.id
and w.production_year=dr.production_year;",2018-08-30 10:56:26.619042+10,8,1,263,correct
6473,"select title, production_year
from writer, (select distinct person.id 
from person, writer
where writer.id=person.id
and person.first_name='Kevin'
and person.last_name='Williamson')as h;",2018-08-30 10:56:51.383978+10,5,0,140,partially correct
6474,"select r.id from ROLE as r
where r.description in
			(select a.description from APPEARANCE as a
			where lower(a.title) = 'psycho' and a.production_year = '1960'
			group by a.description
			having count(*) = 1)
			and lower(r.title) = 'psycho' and r.production_year = '1960';",2018-08-30 10:56:53.067949+10,10,1,167,correct
6475,"select title, production_year
from writer, (select distinct person.id 
from person, writer
where writer.id=person.id
and person.first_name='Kevin'
and person.last_name='Williamson')as h;",2018-08-30 10:57:00.703653+10,5,0,140,partially correct
6476,"select ma.title, ma.production_year, p.first_name, p.last_name
from (
	select title, production_year
		from movie_award
		where award_name = 'BAFTA Film Award'
		and category = 'best film'
		and result  = 'won') 
	as ma,
	director as d,
	person as p
where ma.title  = d.title
and ma.production_year = d.production_year
and d.id = p.id;",2018-08-30 10:57:23.382794+10,8,1,111,correct
6477,"SELECT count(*)
FROM writer AS w inner join person AS p on w.id = p.id
WHERE p.year_born = 1935;",2018-08-30 10:58:36.636009+10,1,0,54,partially correct
6478,"select distinct count(m.title) from movie as m
where m.title not in 
(select title from movie_award as ma where result = 'won'
union
select title from crew_award as ma where result = 'won'
union
select title from director_award as ma where result = 'won'
union
select title from writer_award as ma where result = 'won'
union
select title from actor_award as ma where result = 'won');
",2018-08-30 10:59:02.155588+10,11,0,92,partially correct
6479,"WITH wa AS(SELECT *
		FROM writer_award NATURAL JOIN person)
SELECT COUNT(*)
FROM wa
WHERE wa.production_year >1990
	AND wa.production_year < 1996
	AND lower(wa.first_name) = 'woody'
	AND lower(wa.last_name) = 'allen'
	AND lower(wa.result) = 'won';",2018-08-30 10:59:20.179868+10,9,0,340,partially correct
6480,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM person p
INNER join director d ON p.id=d.id
INNER join movie_award m ON d.title=m.title
WHERE m.award_name='BAFTA Film Award' AND m.category='best film' AND m.result='won';",2018-08-30 11:00:32.440738+10,8,1,182,correct
6481,"select r.id
from scene s, appearance a, role r
where a.scene_no = s.scene_no
and a.title=s.title
and a.production_year=s.production_year
and s.title = r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-30 11:01:00.265714+10,10,1,110,correct
6482,"WITH wa AS(SELECT *
		FROM writer_award NATURAL JOIN person)
SELECT COUNT(*)
FROM wa
WHERE wa.year_of_award >1990
	AND wa.year_of_award < 1996
	AND lower(wa.first_name) = 'woody'
	AND lower(wa.last_name) = 'allen'
	AND lower(wa.result) = 'won';",2018-08-30 11:01:11.860913+10,9,1,340,correct
6483,"select count(*)
from writer_award as wa,person as p
where wa.id =p.id and p.first_name ='Woody' and p.last_name ='Allen'
and wa.result ='won' and wa.production_year >1990 and wa.production_year <1996;",2018-08-30 11:02:59.826718+10,9,0,401,partially correct
6484,"

SELECT COUNT(*)
FROM person, writer, writer_award
WHERE person.first_name = 'Woody' AND person.last_name = 'Allen'
      AND writer_award.year_of_award IN (1991,1992,1993,1994,1995)
	AND lower(writer_award.result) = 'won'
	 AND writer.id = person.id 
	 AND writer_award.id = writer.id AND writer_award.title = writer.title 
	 AND writer_award.production_year = writer.production_year;",2018-08-30 11:04:17.502574+10,9,1,165,correct
6485,"select w.award_name count(*)
from (select award_name from writer_award 
where production_year in (1991,1992,1993,1994,1995)) as w,
writer wr,
person pr
where w.id = wr.id
and wr.id=pr.id
and lower(pr.first_name)='woody'
and lower(pr.last_name)='allen';",2018-08-30 11:04:20.782339+10,9,0,263,noninterpretable
6486,"select count(*) as number_of_award
from writer_award as wa,person as p
where wa.id =p.id and p.first_name ='Woody' and p.last_name ='Allen'
and wa.result ='won' and wa.year_of_award >1990 and wa.year_of_award <1996;",2018-08-30 11:04:44.495007+10,9,1,401,correct
6487,"select distinct id from (director natural join writer ) 
where (select count(*) from (director natural join writer ) );",2018-08-30 11:06:16.229612+10,14,0,385,partially correct
6488,"SELECT count(*) year_born 
FROM person, WRITER 
WHERE year_born = '1935' AND PERSON.id= WRITER.id;",2018-08-30 11:06:17.594391+10,1,0,189,partially correct
6489,"select count (wa.id)
from writer_award as wa, person as p
where wa.year_of_award in (1991, 1992,1993,1994,1995)
and wa.id = p.id
and p.first_name = 'Woody'
and p.last_name = 'Allen';",2018-08-30 11:06:34.604327+10,9,0,111,partially correct
6490,"SELECT COUNT*
FROM MOVIE
WHERE NOT EXISTS(SELECT title,production_year 
FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE ma.result='won' OR ca.result ='won' OR da.result ='won' OR wa.result='won'OR aa.result='won' 
);
",2018-08-30 11:06:40.326864+10,11,0,368,noninterpretable
6508,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title
and d.production_year=da.production_year
and lower(da.result)='nominated';",2018-08-30 11:13:59.369752+10,13,1,110,correct
6510,"select PERSON.id from PERSON
where PERSON.year_born in
				(select p.year_born from PERSON as p
				group by p.year_born
				order by p.year_born DESC
				limit 1,1);",2018-08-30 11:15:33.785832+10,3,1,167,correct
6512,"Director Award(title, production year, award name, year of award, category, result)
Director(id, title, production year)

select da.title, da.production_year from director_award as da ;",2018-08-30 11:17:13.122779+10,13,0,92,noninterpretable
6491,"select count(m.title)
from movie m
where not exists 
				(select *
				from 
					(select ma.title,ma.production_year
					from movie_award ma
					where lower(ma.result) = 'won'
					union
					select ca.title,ca.production_year
					from crew_award ca
					where lower(ca.result) = 'won'
					union
					select da.title,da.production_year
					from director_award da
					where lower(da.result) = 'won'
					union
					select wa.title,wa.production_year
					from writer_award wa
					where lower(wa.result) = 'won'
					union
					select aa.title,aa.production_year
					from actor_award aa
					where lower(aa.result) = 'won') as sub
					where sub.title = m.title and
						sub.production_year = m.production_year);",2018-08-30 11:07:13.000729+10,11,1,43,correct
6492,"SELECT id
	FROM role NATURAL JOIN appearance
	WHERE lower(title) = 'psycho' AND production_year = 1960
	GROUP BY id
	HAVING COUNT(*) = 1;",2018-08-30 11:07:19.886823+10,10,1,340,correct
6493,"select title, production_year
from writer 
where writer.id=(select distinct person.id 
from person, writer
where writer.id=person.id
and person.first_name='Kevin'
and person.last_name='Williamson');",2018-08-30 11:08:07.045154+10,5,1,140,correct
6494,"select count(*)
from movie m 
where not exists(select title, production_year from movie_award ma where lower(ma.result) = 'won'and ma.title=m.title and ma.production_year=m.production_year
union
select title,production_year from crew_award ca where  lower(ca.result) = 'won' and ca.title=m.title and ca.production_year=m.production_year
union
select title,production_year from director_award da where lower(da.result) = 'won' and da.title=m.title and da.production_year=m.production_year
union
select title,production_year from  writer_award wa where lower(wa.result) = 'won' and wa.title=m.title and wa.production_year=m.production_year
union 
select title,production_year from  actor_award aa where lower(aa.result) = 'won' and aa.title=m.title and aa.production_year=m.production_year);",2018-08-30 11:08:07.78294+10,11,1,110,correct
6495,"select count(m.title) from movie as m
where not exists
(select title,production_year from movie_award as ma where lower(result) = 'won' and m.title = ma.title and m.production_year = ma.production_year
union
select title,production_year from crew_award as ca where lower(result) = 'won' and m.title = ca.title and m.production_year = ca.production_year
union
select title,production_year from director_award as da where lower(result) = 'won' and m.title = da.title and m.production_year = da.production_year
union
select title,production_year from writer_award as wa where lower(result) = 'won' and m.title = wa.title and m.production_year = wa.production_year
union
select title,production_year from actor_award as aa where lower(result) = 'won' and m.title = aa.title and m.production_year = aa.production_year);
",2018-08-30 11:08:43.534824+10,11,1,92,correct
6496,"select count(distinct p.id)
from writer w
	natural join 
    person p
where p.year_born = '1935';",2018-08-30 11:09:25.387009+10,1,1,43,correct
6497,"SELECT d.id,
	 da.award_name,
	 da.year_of_award,
	 da.category 
FROM director d,
	director_award da
WHERE
	da.title = d.title
	AND da.production_year = d.production_year
	AND lower(da.result) = 'nominated'
	AND d.id NOT IN 
			(SELECT id 
			 FROM director d,
			 	 director_award da
			WHERE 
				d.title = da.title
				AND d.production_year = da.production_year
				AND lower(da.result) = 'won');",2018-08-30 11:10:44.204852+10,13,1,49,correct
6498,"select count(*) from person 
where person.id in 
( select  person.id from person, writer where person.id =writer.id and year_born=1935);",2018-08-30 11:10:56.271852+10,1,1,197,correct
6499,"select p.id
from person p
where p.year_born=(select max(year_born) 
from person p1 
where p1.year_born<(select max(year_born) from person ));",2018-08-30 11:10:58.139664+10,3,1,110,correct
6500,"select count(*) 
from movie m
where not exists
	(select ma.title,ma.production_year 
	from movie_award ma
	where lower(ma.result)='won' and ma.title = m.title and ma.production_year =m.production_year 
	
	union
	
	select ca.title,ca.production_year 
	from crew_award ca
	where lower(result)='won' and ca.title=m.title and ca.production_year =m.production_year 
	
	union
	
	select da.title,da.production_year 
	from director_award da
	where lower(da.result)='won' and da.title=m.title and da.production_year =m.production_year 
	
	union 
	
	select wa.title,wa.production_year  
	from writer_award wa
	where lower(wa.result)='won' and wa.title = m.title and wa.production_year =m.production_year 
	
	union
	
	select aa.title,aa.production_year  
	from actor_award aa
	where lower(aa.result)='won' and aa.title = m.title and aa.production_year =m.production_year );",2018-08-30 11:11:46.459217+10,11,1,46,correct
6501,"select count (distinct p.id)
from (select id
	from writer_award
	where writer_award.year_of_award in (1991, 1992,1993,1994,1995))
	as wa,
	person as p
where
    wa.id = p.id
and p.first_name = 'Woody'
and p.last_name = 'Allen';
",2018-08-30 11:12:12.860416+10,9,1,111,correct
6502,"select count(*) as num from MOVIE as m
where not exists
(select ma.title,ma.production_year from MOVIE_AWARD as ma
where lower(result) = 'won' and m.title = ma.title 
and m.production_year = ma.production_year
UNION
select ca.title,ca.production_year from CREW_AWARD as ca
where lower(result) = 'won' and m.title = ca.title 
and m.production_year = ca.production_year
UNION
select da.title,da.production_year from DIRECTOR_AWARD as da
where lower(result) = 'won' and m.title = da.title 
and m.production_year = da.production_year
UNION
select wa.title,wa.production_year from WRITER_AWARD as wa
where lower(result) = 'won' and m.title = wa.title 
and m.production_year = wa.production_year
UNION
select aa.title,aa.production_year from ACTOR_AWARD as aa
where lower(result) = 'won' and m.title = aa.title 
and m.production_year = aa.production_year);
",2018-08-30 11:12:18.093965+10,11,1,167,correct
6503,"SELECT count(*)
FROM person AS p
WHERE (SELECT id
	FROM writer AS w
	WHERE p.year_born = 1935 AND p.id=w.id);",2018-08-30 11:12:25.389841+10,1,1,54,correct
6504,"select count(*) as number_of_award
from writer_award w, writer wr,person pr
where w.year_of_award in (1991,1992,1993,1994,1995)
and w.id = wr.id
and wr.id=pr.id
and lower(pr.first_name)='woody'
and lower(pr.last_name)='allen'
and lower(w.result)='won'
and w.title= wr.title
and w.production_year = wr.production_year;",2018-08-30 11:12:44.743718+10,9,1,263,correct
6505,"select m.title, m.production_year from person p, movie m, writer w where p.id = w.id and m.title = w.title and m.production_year = w.production_year and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson';",2018-08-30 11:12:48.499993+10,5,1,99,correct
6506,"




SELECT role.id
FROM role, person, appearance
WHERE appearance.title = 'Psycho' AND appearance.production_year = '1960'
      AND appearance.title = role.title AND appearance.production_year = role.production_year AND appearance.description = role.description
	AND role.id = person.id 
GROUP BY role.id
HAVING count(*)=1;",2018-08-30 11:12:55.714744+10,10,1,165,correct
6507,"select count(*) 
from movie m
where not exists
	(select ma.title,ma.production_year 
	from movie_award ma
	where lower(ma.result)='won' and ma.title = m.title and ma.production_year =m.production_year 
	
	union
	
	select ca.title,ca.production_year 
	from crew_award ca
	where lower(result)='won' and ca.title=m.title and ca.production_year =m.production_year 
	
	union
	
	select da.title,da.production_year 
	from director_award da
	where lower(da.result)='won' and da.title=m.title and da.production_year =m.production_year 
	
	union 
	
	select wa.title,wa.production_year  
	from writer_award wa
	where lower(wa.result)='won' and wa.title = m.title and wa.production_year =m.production_year 
	
	union
	
	select aa.title,aa.production_year  
	from actor_award aa
	where lower(aa.result)='won' and aa.title = m.title and aa.production_year =m.production_year );",2018-08-30 11:13:32.394175+10,11,1,46,correct
6514,"SELECT m.id FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE NOT EXISTS m.title = w.title
;",2018-08-30 11:18:41.621241+10,11,0,388,noninterpretable
6515,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-30 11:19:37.910233+10,4,1,382,correct
6516,"SELECT COUNT(*)
FROM MOVIE
WHERE NOT EXISTS(SELECT aw.title,aw.production_year 
                 FROM (SELECT *
				 FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
				 WHERE ma.result='won' OR ca.result ='won' OR da.result ='won' OR wa.result='won'OR aa.result='won' ) AS aw
				 )
	           
;
",2018-08-30 11:21:04.298223+10,11,0,368,partially correct
6517,"SELECT p.id,p.first_name,p.last_name
from person p
where exists (select *
from director e
where e.id=p.id
group by e.id
having count(*)>=2);",2018-08-30 11:21:12.986273+10,4,0,163,partially correct
6518,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
	FROM movie_award ma
	WHERE ma.title = m.title AND ma.production_year = m.production_year AND lower(ma.result) = 'won'
	UNION
	SELECT title, production_year
	FROM crew_award ca
	WHERE ca.title = m.title AND ca.production_year = m.production_year AND lower(ca.result) = 'won'
	UNION
	SELECT title, production_year
	FROM director_award da
	WHERE da.title = m.title AND da.production_year = m.production_year AND lower(da.result) = 'won'
	UNION
	SELECT title, production_year
	FROM writer_award wa
	WHERE wa.title = m.title AND wa.production_year = m.production_year AND lower(wa.result) = 'won'
	UNION
	SELECT title, production_year
	FROM actor_award aa
	WHERE aa.title = m.title AND aa.production_year = m.production_year AND lower(aa.result) = 'won');",2018-08-30 11:23:03.012237+10,11,1,340,correct
6519,"SELECT COUNT(*) FROM movie m
WHERE NOT EXISTS
(SELECT title, production_year FROM movie_award ma
WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT title, production_year FROM crew_award ca
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year FROM director_award da
WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION
SELECT title, production_year FROM writer_award wa
WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
UNION
SELECT title, production_year FROM actor_award aa
WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);",2018-08-30 11:23:14.954885+10,11,1,388,correct
6520,"select ra.id
from (role as r natural join appearance as a) as ra
where exists (select * from scene as s 
where s.scene_no =ra.scene_no and s.scene_no =1 and ra.title ='Psycho' and ra.production_year=1960);
",2018-08-30 11:24:37.642208+10,10,0,401,partially correct
6521,"select count(*)
from movie m
where 
not exists (select * from movie_award ma 
where ma.title = m.title and ma.production_year = m.production_year and ma.result ='won')

and not exists (select * from Crew_Award ca 
where ca.title = m.title and ca.production_year = m.production_year and ca.result ='won')

and not exists (select * from Director_Award da
where da.title = m.title and da.production_year = m.production_year and da.result ='won')

and not exists (select * from Actor_award aa
where aa.title = m.title and aa.production_year = m.production_year and aa.result ='won')

and not exists (select * from writer_award wa
where wa.title = m.title and wa.production_year = m.production_year and wa.result ='won');",2018-08-30 11:25:39.308759+10,11,0,338,partially correct
6522,"SELECT title,production_year
FROM movie NATURAL JOIN writer NATURAL JOIN person
WHERE person.first_name =""Kevin"" AND person.last_name=""Williamson"";",2018-08-30 11:26:05.538603+10,5,1,382,correct
6523,"select ra.id
from (role as r natural join appearance as a) as ra
where exists (select * from scene as s 
where s.scene_no =ra.scene_no and ra.title ='Psycho' and ra.production_year=1960)
group by ra.id
having count(*)=1;
",2018-08-30 11:26:22.03439+10,10,1,401,correct
6524,"SELECT COUNT(*)
FROM MOVIE m
WHERE NOT EXISTS(SELECT aw.title,aw.production_year 
                 FROM (SELECT *
				 FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
				 WHERE ma.result='won' OR ca.result ='won' OR da.result ='won' OR wa.result='won'OR aa.result='won' ) AS aw
				 WHERE aw.title = m.title AND aw.production_year=m.production_year)
	           
;
",2018-08-30 11:26:26.003487+10,11,0,368,partially correct
6525,"SELECT p.id,p.first_name,p.last_name
from person p
where exists (select *
from director e, writer w
where e.id=p.id=w.id
group by e.id and w.id
having count(*)>=2);",2018-08-30 11:26:39.455665+10,4,0,163,partially correct
6526,"SELECT DISTINCT count(*) year_born 
FROM person, WRITER 
WHERE year_born = '1935' AND PERSON.id= WRITER.id;",2018-08-30 11:27:45.670553+10,1,0,189,partially correct
6527,"SELECT person.id, first_name, last_name 
from person
where year_born=(select max(year_born) from person);",2018-08-30 11:28:24.63953+10,7,1,140,correct
6528,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
       FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 11:28:51.099635+10,15,1,182,correct
6529,"WITH modifiedP AS (SELECT *
				FROM person p
				WHERE p.year_born < (SELECT MAX(p1.year_born)
								FROM person p1))
SELECT id
FROM modifiedP mp
WHERE mp.year_born = (SELECT MAX(mp1.year_born)
 				FROM modifiedP mp1);",2018-08-30 11:28:53.914659+10,3,1,340,correct
6530,SELECT id FROM PERSON WHERE year_born = (SELECT MAX(year_born) FROM PERSON WHERE year_born<(SELECT MAX(year_born) FROM PERSON));,2018-08-30 11:28:57.988999+10,3,1,388,correct
6531,select count(*) from writer natural join person where person.year_born = 1935;,2018-08-30 11:29:24.277648+10,1,0,399,partially correct
6532,"SELECT production_year, COUNT(*)
FROM movie 
WHERE production_year <=1993;",2018-08-30 11:31:20.331601+10,2,0,54,partially correct
6533,"SELECT production_year, COUNT(*)
FROM movie 
WHERE production_year <=1993 AND production_year >=1991 
GROUP BY production_year;",2018-08-30 11:32:27.743256+10,2,1,54,correct
6534,"
select COUNT(*) from (select distinct person.* from person, writer where person.id = writer.id and person.year_born = 1935) m;",2018-08-30 11:33:12.467187+10,1,1,183,correct
6535,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-30 11:33:21.775587+10,11,1,368,correct
6536,"SELECT wd.id, wd.first_name, wd.last_name
from (person p natural join director natural join writer) as wd
group by wd.id
having count(*)>=1;",2018-08-30 11:33:39.215357+10,4,0,163,partially correct
6782,"select dw.id, dw.first_name, dw.last_name from (person natural join director natural join writer) as dw group by dw.id having COUNT(*) > 1;",2018-08-30 13:44:54.036003+10,4,1,183,correct
6537,"
SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(SELECT movie.title,movie.production_year
                 FROM  movie_award
                 WHERE lower(movie_award.result) = 'won' 
                 AND movie_award.title = movie.title AND movie_award.production_year = movie.production_year
                 UNION
                 SELECT movie.title,movie.production_year
                 FROM  crew_award
                 WHERE lower(crew_award.result) = 'won' 
                 AND crew_award.title = movie.title AND crew_award.production_year = movie.production_year
                 UNION
                 SELECT movie.title,movie.production_year
                 FROM  director_award
                 WHERE lower(director_award.result) = 'won' 
                 AND director_award.title = movie.title AND director_award.production_year = movie.production_year
                 UNION
                 SELECT movie.title,movie.production_year
                 FROM  writer_award
                 WHERE lower(writer_award.result) = 'won' 
                 AND writer_award.title = movie.title AND writer_award.production_year = movie.production_year
                 UNION
                 SELECT movie.title,movie.production_year
                 FROM  actor_award
                 WHERE lower(actor_award.result) = 'won' 
                 AND actor_award.title = movie.title AND actor_award.production_year = movie.production_year);",2018-08-30 11:33:45.148752+10,11,1,165,correct
6538,"SELECT country
FROM restriction
WHERE title = ""Shakespeare in Love"" AND description=""M"";",2018-08-30 11:34:04.060947+10,6,1,382,correct
6539,"WITH WD AS
(SELECT *, COUNT(*) AS count
    FROM(
      SELECT w.id, title, production_year
        FROM WRITER w
      UNION
      SELECT d.id,title, production_year
        FROM DIRECTOR d) wd
    GROUP BY wd.id)
SELECT id
 FROM WD
WHERE count = (SELECT MAX(count)
FROM WD);",2018-08-30 11:39:28.942264+10,14,1,98,correct
6540,"WITH da AS(SELECT *
		FROM director NATURAL JOIN director_award)
SELECT da.id, da.award_name, da.year_of_award, da.category 
FROM da
WHERE lower(da.result) = 'nominated'
	AND da.id NOT IN (SELECT id 
				FROM da d1
				WHERE lower(d1.result) = 'won');",2018-08-30 11:40:03.279755+10,13,1,340,correct
6541,"select r.id
from scene as s,
	role as r,
	appearance as a
where 
	s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no = a.scene_no
	and s.description = a.description
	and s.title = r.title
	and s.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by
	r.id
having
	count(*) = 1;",2018-08-30 11:40:34.16548+10,10,0,111,partially correct
6542,"select id
from role, appearance
where scene_no=1 
and role.production_year=appearance.production_year
and role.title=appearance.title;",2018-08-30 11:41:45.474634+10,10,0,197,partially correct
6543,"SELECT count(*)
FROM person p 
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id=d.id);",2018-08-30 11:42:07.713635+10,12,1,410,correct
6544,"SELECT id,first_name,last_name
FROM (SELECT *,MAX(year_born)
		FROM person);
",2018-08-30 11:42:27.897283+10,7,1,382,correct
6545,"select production_year, count(*) from movie where production_year = 1991 or production_year = 1992 or production_year = 1993 group by production_year;",2018-08-30 11:44:01.596276+10,2,1,399,correct
6546,"WITH dw AS (SELECT id, COUNT(*) AS count
		FROM writer NATURAL JOIN director
		GROUP BY id)
SELECT dw1.id
FROM dw dw1
WHERE dw1.count = (SELECT MAX(dw2.count)
				FROM dw dw2);",2018-08-30 11:45:27.233665+10,14,0,340,partially correct
6547,"select id 
from person pp
where pp.year_born =(select max(p.year_born)
from person p
where p.year_born <(select max(year_born) from person p ));

",2018-08-30 11:46:56.869228+10,3,1,46,correct
6548,select r.id from role r natural join appearance a where lower(r.title) = 'psycho' and r.production_year = 1960 group by r.id having count (r.id)= 1;,2018-08-30 11:48:14.724402+10,10,1,99,correct
6549,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w)
AS dw GROUP BY dw.id HAVING COUNT(*)>1; ",2018-08-30 11:49:09.50728+10,4,1,410,correct
6550,"select d.id,da.award_name,da.year_of_award,da.category from director d,director_award da
where
da.production_year=d.production_year
and da.title=d.title
and da.result!='won'
;",2018-08-30 11:49:41.350129+10,13,1,341,correct
6551,"
	NATURAL JOIN (SELECT title, production_year FROM director_award WHERE lower(result) = 'won') AS da
	NATURAL JOIN (SELECT title, production_year FROM writer_award WHERE lower(result) = 'won') AS wa
	NATURAL JOIN (SELECT title, production_year FROM actor_award WHERE lower(result) = 'won') AS aa;",2018-08-30 11:49:55.875889+10,11,0,81,noninterpretable
6552,"SELECT id
FROM person p
Where p.year_born < (select MAX(year_born) from person);",2018-08-30 11:50:05.718297+10,3,0,252,partially correct
6553,"select title from movie where production_year = (1991, 1992);",2018-08-30 11:50:13.712138+10,2,0,183,noninterpretable
6554,"SELECT title,production_year,first_name,last_name
FROM (movie NATURAL JOIN movie_award NATURAL JOIN director NATURAL JOIN person)
WHERE award_name=""BAFTA Film Award"" AND category = ""best film"";",2018-08-30 11:50:21.101704+10,8,0,382,partially correct
6555,"select max(p1.year_born)
from person p1
where p1.year_born not in (select max(p.year_born)
from person p);",2018-08-30 11:50:38.775706+10,3,0,338,partially correct
6556,"SELECT title,production_year,first_name,last_name,category
FROM (movie NATURAL JOIN movie_award NATURAL JOIN director NATURAL JOIN person)
WHERE award_name=""BAFTA Film Award"" AND category = ""best film"";",2018-08-30 11:50:49.854366+10,8,0,382,partially correct
6557,"select g.title, g.production_year, first_name, last_name
from person, ( select id, h.title, h.production_year
from director, (select title, production_year
from movie_award
where award_name='BAFTA Film Award'
and category='best film') as h
where director.title=h.title 
and director.production_year=h.production_year)as g
where person.id=g.id;",2018-08-30 11:50:58.268917+10,8,0,140,partially correct
6558,"select COUNT(title), production_year from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 11:51:29.453692+10,2,1,183,correct
6559,"select COUNT(title), production_year from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 11:51:43.217694+10,2,1,183,correct
6560,"select COUNT(*), production_year from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 11:52:36.011896+10,2,1,183,correct
6561,"select production_year, COUNT(*) from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 11:53:06.377485+10,2,1,183,correct
6562,"WITH LgstMoviePerson AS 
(Select id, COUNT(*) as time 
	from(Select p.id, w.title
    	        from Person p, writer w
    	        where p.id = w.id
   	        UNION
   	        Select p.id, d.title
    	        from Person p, director d
   	        where p.id = d.id)
   	 Group by id)
SELECT id 
FROM LgstMoviePerson
WHERE time = (select max(time) 
 	          from LgstMoviePerson
		);
",2018-08-30 11:53:22.887826+10,14,1,77,correct
6563,"SELECT id
	FROM person as p,director as d
	WHERE p.id=d.id;",2018-08-30 11:53:50.287294+10,12,0,54,noninterpretable
6564,"select g.title, g.production_year, first_name, last_name
from person, ( select id, h.title, h.production_year
from director, (select title, production_year
from movie_award
where award_name='BAFTA Film Award'
and category='best film'
and result='won') as h
where director.title=h.title 
and director.production_year=h.production_year)as g
where person.id=g.id;",2018-08-30 11:54:03.80753+10,8,1,140,correct
6565,"select d.id, da.award_name, da.year_of_award, da.category
from director as d, director_award as da
where da.title = d.title
and da.result = 'nominated';",2018-08-30 11:54:41.775312+10,13,1,111,correct
6566,"select p1.id, max(p1.year_born)
from person p1
where p1.year_born not in (select max(p.year_born)
from person p);",2018-08-30 11:54:50.059643+10,3,0,338,partially correct
6846,"select *
from movie
;",2018-08-30 14:12:11.567663+10,4,0,396,partially correct
6567,"WITH dwc AS(SELECT tmp.id, COUNT(*) AS count
		FROM (SELECT title, production_year, id
		FROM director
		UNION
		SELECT title, production_year, id
		FROM writer) AS tmp
		GROUP BY tmp.id)
SELECT d1.id
FROM dwc d1
WHERE d1.count = (SELECT MAX(count)
			FROM dwc);",2018-08-30 11:54:51.53866+10,14,1,340,correct
6568,"select COUNT(*) from (select distinct person.id from person, director where person.id != director.id) m;",2018-08-30 11:55:34.111839+10,12,0,183,partially correct
6569,"SELECT p.id
FROM person p
Where p.year_born = (select max(year_born) from person
                     where year_born < (select max(year_born) from person));",2018-08-30 11:57:13.701697+10,3,1,252,correct
6570,"select id, da.award_name, da.year_of_award,da.category
from director d,director_award da
where lower(da.result)='nominated'
	and d.title=da.title
	and d.production_year=da.production_year
group by id;",2018-08-30 11:58:32.638145+10,13,1,46,correct
6571,"select COUNT(*) from (select id from person where not exists (select * from director d where person.id = d.id)) m;
",2018-08-30 11:58:57.4102+10,12,1,183,correct
6572,"select p1.id
from (select p2.id, max(p2.year_born) from person p2
where p2.year_born not in (select max(p.year_born)
from person p)) as p1
;",2018-08-30 11:58:58.078342+10,3,1,338,correct
6573,"SELECT person.id
FROM person
ORDER BY person.year_born DESC
LIMIT 1,1;",2018-08-30 11:59:08.874491+10,3,1,165,correct
6574,"SELECT COUNT(*)
	FROM person as p
	WHERE not EXISTS(SELECT id
		FROM director d
		WHERE p.id = d.id);",2018-08-30 11:59:49.467915+10,12,1,54,correct
6575,"select d.id, da.award_name, da.year_of_award, da.category 
from DIRECTOR as d,DIRECTOR_AWARD as da
where d.title = da.title and d.production_year = da.production_year 
	and lower(da.result) = 'nominated'
	and d.id not in
		(select DIRECTOR.id from DIRECTOR, DIRECTOR_AWARD
		where DIRECTOR.title = DIRECTOR_AWARD.title 
		and DIRECTOR.production_year = DIRECTOR_AWARD.production_year
		and lower(da.result) = 'won');",2018-08-30 12:00:16.076217+10,13,1,167,correct
6576,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE p.id=w.id 
AND lower(first_name)='Kevin'
AND lower(last_name) ='Williamson';",2018-08-30 12:00:24.359717+10,5,0,410,partially correct
6577,select p.id from person;,2018-08-30 12:00:59.953868+10,14,0,341,noninterpretable
6578,"select id, da.award_name, da.year_of_award,da.category
from director d,director_award da
where lower(da.result)='nominated'
	and d.title=da.title
	and d.production_year=da.production_year;",2018-08-30 12:01:09.483627+10,13,1,46,correct
6579,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE 
w.id = p.id 
AND lower(first_name)='Kevin'
AND lower(last_name) ='Williamson';",2018-08-30 12:02:19.465181+10,5,0,410,partially correct
6580,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person WHERE year_born<(SELECT MAX(year_born) FROM person))
;",2018-08-30 12:02:36.410872+10,3,1,368,correct
6581,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE p.id=w.id 
AND lower(first_name)= 'kevin'
AND lower(last_name) = 'williamson';",2018-08-30 12:03:17.487865+10,5,1,410,correct
6582,"SELECT title,production_year,first_name,last_name
FROM (movie NATURAL JOIN movie_award NATURAL JOIN director NATURAL JOIN person)
WHERE award_name=""BAFTA Film Award"" AND category = ""best film"" AND result=""won"";
",2018-08-30 12:03:37.614891+10,8,1,382,correct
6583,"select count (distinct p.id) from writer w, person p
where w.id=p.id
and p.year_born = 1935;",2018-08-30 12:04:41.917626+10,1,1,274,correct
6584,"Select count(*)
from person 
where exists( select * from writer where writer.id= person.id and year_born=1935);",2018-08-30 12:04:57.621747+10,1,1,158,correct
6585,"SELECT COUNT(*)
FROM writer_award NATURAL JOIN writer NATURAL JOIN person
WHERE first_name=""Woody"" AND last_name=""Allen"" AND year_of_award>=1991 AND year_of_award<=1995;",2018-08-30 12:06:22.349514+10,9,0,382,partially correct
6586,"SELECT COUNT(*)
FROM writer_award NATURAL JOIN writer NATURAL JOIN person
WHERE first_name=""Woody"" AND last_name=""Allen"" AND year_of_award>=1991 AND year_of_award<=1995 AND result= ""won"";",2018-08-30 12:07:03.366572+10,9,1,382,correct
6587,"select count(*)
from movie 
where production_year>1990 and production_year<1994;
",2018-08-30 12:07:56.044205+10,2,0,158,partially correct
6588,SELECT * FROM (director_award da NATURAL JOIN director d) AS dad WHERE lower(da.result)='nominated';,2018-08-30 12:07:58.841431+10,13,0,388,partially correct
6589,"SELECT country 
FROM restriction r 
WHERE 
lower (title) ='shakespeare in Love'
AND description = 'M';",2018-08-30 12:08:22.629374+10,6,0,410,partially correct
6590,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 12:08:41.106803+10,13,1,388,correct
6591,"select p.id, da.award_name, da.year_of_award, da.category
FROM person p, diredtor d, director_award da
where not exists p.id=d.id
and d.title=da.title
and d.production_year=da.production_year
and da.result='won';",2018-08-30 12:08:49.902566+10,13,0,252,noninterpretable
6592,"

SELECT director.id,director_award.award_name,director_award.year_of_award,director_award.category
FROM person, director, director_award, award
WHERE lower(director_award.result) = 'nominated' AND lower(director_award.result) != 'won'
      AND director_award. title = director.title AND director_award.production_year = director.production_year
	AND director.id = person.id
	AND director_award.award_name = award.award_name
GROUP BY director.id
HAVING COUNT(*)>=1;

",2018-08-30 12:09:02.821592+10,13,1,165,correct
6593,"select production_year, count(*)
from movie 
where production_year>1990 and production_year<1994
group by Production_year;
",2018-08-30 12:09:25.989333+10,2,1,158,correct
6594,"SELECT id,first_name,last_name from (person as p natural join director as d natural join writer as w) group by id having count(*)>1;",2018-08-30 12:10:07.864072+10,4,1,16,correct
6595,"select count(*)
from person 
where not exists (select * from director where director.id=person.id);",2018-08-30 12:11:20.873877+10,12,1,158,correct
6596,"select o.id, o.award_name, o.year_of_award, o.category
from (director d natural join director_award da) as o
where o.result='nominated' and o.result not in(
select da1.result from director_award da1
where da1.result = 'won');",2018-08-30 12:11:24.152154+10,13,1,338,correct
6597,"select x.id from (
select x1.id,count(*) as NoOfWorkedOn from(
select d.id,title,production_year from director d 
union 
select w.id,title,production_year from writer w) x1 group by x1.id) x
where x.NoOfWorkedOn=(select max(x2.NoOfWorkedOn)from (select x1.id,count(*) as NoOfWorkedOn from (select d.id,title,production_year from director d 
union 
select w.id,title,production_year from writer w)x1 group by x1.id)x2)
;",2018-08-30 12:12:04.746377+10,14,1,341,correct
6598,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 12:12:53.849207+10,13,1,252,correct
6599,"SELECT country 
FROM restriction r 
WHERE EXISTS
( SELECT * FROM restriction_category rc WHERE rc.country = r.country 
AND r.title = 'shakespeare in love' AND description ='M');",2018-08-30 12:13:25.211883+10,6,0,410,partially correct
6600,;,2018-08-30 12:13:46.536329+10,15,0,341,noninterpretable
6601,"SELECT country 
FROM restriction r 
WHERE EXISTS
( SELECT * FROM restriction_category rc WHERE rc.country = r.country 
AND r.title = 'Shakespeare in Love' AND description ='M');",2018-08-30 12:14:14.979198+10,6,1,410,correct
6602,"select count(person.id)
from person
inner join writer
on person.id=writer.id
where person.year_born=1935;",2018-08-30 12:15:34.925886+10,1,0,389,partially correct
6603,"select count(award_name)
from writer_award, (select id
from person 
where first_name='Woody'
and last_name='Allen') as h
where result='won'
and writer_award.id=h.id
and year_of_award>1990
and year_of_award<1996
group by award_name;",2018-08-30 12:16:39.11457+10,9,1,140,correct
6604,"SELECT count(*) 
FROM person, DIRECTOR  
WHERE PERSON.id !=  DIRECTOR.id  ;",2018-08-30 12:16:40.915519+10,12,0,189,partially correct
6605,"select w.title, w.production_year
from writer w natural join person p
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-30 12:16:45.542509+10,5,1,163,correct
6606,"select a.first_name,a.last_name,a.id
from (select first_name, last_name, id, count (*)as h from person natural join director natural join writer) as a
where a.h>1;",2018-08-30 12:18:39.39784+10,4,0,158,partially correct
6607,"select p.first_name,p.last_name,r.title,r.production_year,r.description from
person p,role r,(select id, count(*) as number from role group by id) as b
where
r.id =p.id
and p.id=b.id
and b.number in (select max(number) from(select id, count(*) as number from role group by id));",2018-08-30 12:18:46.925845+10,15,1,341,correct
6608,"SELECT id, first_name, last_name 
FROM person p
WHERE year_born = (SELECT MAX(year_born) FROM person p);",2018-08-30 12:19:11.043709+10,7,1,410,correct
6609,"select count(*)
from person p
where exists (select * from writer w where w.id=p.id and p.year_born=1935);",2018-08-30 12:19:33.139681+10,1,1,389,correct
6610,"select distinct id from writer group by id having count(*)>=ALL(select count(*) from writer group by id)
union 
select distinct id from director group by id having count(*)>=ALL(select count(*) from director group by id);",2018-08-30 12:19:56.016911+10,14,0,300,noninterpretable
6611,"select count(award_name) as number_of_award
from writer_award, (select id
from person 
where first_name='Woody'
and last_name='Allen') as h
where result='won'
and writer_award.id=h.id
and year_of_award>1990
and year_of_award<1996;",2018-08-30 12:19:59.712015+10,9,1,140,correct
6612,"select pr.id
from crew cr,
  scene sn,
  person pr
  where lower(cr.title)='psycho'
  and cr.scene_no=1
  and cr.production_year=1960
  and sn.production_year=pr.production_year
  and sn.title =pr.title
  and cr.id=pr.id;",2018-08-30 12:20:28.160565+10,10,0,263,noninterpretable
6613,"WITH roleinfo AS(SELECT id, COUNT(*) AS count
			FROM role
			GROUP BY id)
SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r, roleinfo rf
WHERE p.id = r.id AND p.id = rf.id
	AND rf.count = (SELECT MAX(count)
				FROM roleinfo);",2018-08-30 12:21:17.920359+10,15,1,340,correct
6614,"select id, award_name, year_of_award, category
From Director d,
     Director_Award da
where d.title=da.title
and d.production_year=da.production_year
and lower(da.result)='nominated'
and d.id not in (select d.id
from 
Director d,
Director_Award da
where d.title=da.title
and d.production_year=da.production_year
and lower(da.result)='won');",2018-08-30 12:22:23.953298+10,13,1,252,correct
6615,"select count(title),production_year
from movie
where production_year=1993 or production_year = 1992 or production_year=1991
group by production_year;",2018-08-30 12:23:10.904338+10,2,1,389,correct
6616,"select m.award_name,p.last_name,p.first_name from person p,
(select w.id,s.award_name from writer w,
(select wa.title,wa.award_name from writer_award wa where
	wa.production_year>=1991 and wa.production_year<=1995
	and lower(wa.result)='won')s
	where w.title=s.title)m 
	where p.id=m.id ;",2018-08-30 12:23:25.731347+10,9,0,32,partially correct
6617,"select production_year,count(title)
from movie
where production_year=1993 or production_year = 1992 or production_year=1991
group by production_year;",2018-08-30 12:23:47.716225+10,2,1,389,correct
6618,"select description
from appearance
where title='Psycho'
and production_year=1960
and scene_no=1;",2018-08-30 12:24:16.22296+10,10,0,140,partially correct
6619,"SELECT id,first_name,last_name
FROM person AS p,(SELECT id
				FROM director as d inner join writer as w on w.id = d.id
				GROUP BY d.id HAVING count(*)>1
				) AS s
WHERE p.id = s.id;
",2018-08-30 12:25:00.88146+10,4,0,54,noninterpretable
6620,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-30 12:26:50.539071+10,6,1,163,correct
6621,"select count(p.id)
from person p
where exists (select p.id<>d.id from director d);",2018-08-30 12:28:00.171916+10,12,0,389,partially correct
6622,select count (*) from movie m where not exists (select ma.title from movie_award ma where m.title=ma.title and m.production_year=ma.production_year union select ca.title from crew_award ca where ca.title=m.title and ca.production_year=m.production_year union select da.title from director_award da where da.title=m.title and m.production_year=da.production_year union select aa.title from actor_award aa where m.production_year=aa.production_year and m.title=aa.title union select wa.title from writer_award wa where m.title=wa.title and m.production_year=wa.production_year);,2018-08-30 12:28:51.506129+10,11,0,270,partially correct
6623,"select count(*)
from person p
where not exists (select * from director d where p.id=d.id);",2018-08-30 12:30:12.247687+10,12,1,389,correct
6624,"SELECT id,first_name,last_name
FROM (person natural join writer natural join director) as pwd
GROUP BY pwd.id 
HAVING count(*) >=2;",2018-08-30 12:30:20.195379+10,4,1,54,correct
6625,"select a.first_name,a.last_name,a.id
from ( person natural join director natural join writer) as a
group by a.id
having count(*)>1;",2018-08-30 12:30:25.105572+10,4,1,158,correct
6626,"select a.first_name,a.last_name,a.id
from ( person natural join director natural join writer) as a
group by a.id
having count(*)>1;",2018-08-30 12:30:38.370997+10,4,1,158,correct
6627,"select a.id,a.first_name,a.last_name
from ( person natural join director natural join writer) as a
group by a.id
having count(*)>1;",2018-08-30 12:31:14.991469+10,4,1,158,correct
6628,"SELECT id
FROM appearance NATURAL JOIN role NATURAL JOIN (SELECT title,production_year,scene_no FROM scene) s
WHERE title=""Psycho""
GROUP BY id
HAVING COUNT(*)=1;


",2018-08-30 12:31:37.389354+10,10,0,382,partially correct
6629,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title
AND d.production_year=da.production_year
AND lower(da.result)='nominated'
AND d.id not in (select d.id
                  from director d, director_award da
				  where d.title=da.title
				  AND d.production_year=da.production_year
				  AND lower(da.result)='won');",2018-08-30 12:31:38.17414+10,13,1,79,correct
6630,"SELECT id 
FROM appearance NATURAL JOIN role NATURAL JOIN (SELECT title,production_year,scene_no FROM scene) s
WHERE title=""Psycho"" AND production_year=1960
GROUP BY id
HAVING COUNT(*)=1;


",2018-08-30 12:33:00.199731+10,10,1,382,correct
6631,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 12:33:14.983461+10,11,1,270,correct
6632,"SELECT titles, production_year, first_name, last_names
FROM movie m, person p
WHERE (SELECT * FROM movie_award ma);",2018-08-30 12:33:41.060833+10,8,0,410,noninterpretable
6633,"select p.id,p.first_name,p.last_name
from person p
where exists (
select * from director d where d.id=writer.id
);",2018-08-30 12:34:25.573987+10,4,0,389,noninterpretable
6726,"select id,first_name,last_name from person
where id in(
select director.id from director inner join writer on director.id = writer.id
where director.title=writer.title
group by director.id
having count(director.id) >=2);
",2018-08-30 13:18:01.135734+10,4,1,313,correct
7098,"SELECT COUNT(year_born)
FROM PERSON natural join writer
WHERE year_born = 1935;",2018-08-30 15:42:30.611549+10,1,0,260,partially correct
6634,"SELECT re.id FROM (SELECT r.id, s.scene_no FROM role r
INNER JOIN scene s
ON r.title = s.title
AND r.production_year = s.production_year
INNER JOIN appearance a
ON a.title = s.title
AND a.production_year = s.production_year
AND a.scene_no = s.scene_no
AND a.description = r.description 
WHERE lower(s.title) = 'psycho'
AND a.production_year = 1960) AS re
GROUP BY re.id
HAVING COUNT (re.scene_no) =1;
",2018-08-30 12:34:29.963967+10,10,1,95,correct
6635,"select title, production_year
from writer, person
where writer.id=person.id
and lower(person.first_name)='kevin'
and lower(person.last_name)='williamson';",2018-08-30 12:35:27.543161+10,5,1,158,correct
6636,"SELECT count(*) 
FROM person
WHERE PERSON.id not in (select distinct DIRECTOR.id  from DIRECTOR) ;",2018-08-30 12:35:32.892949+10,12,1,189,correct
6637,"select count(*)
from PERSON p
where not exists (select * from DIRECTOR d where p.id = d.id );",2018-08-30 12:35:36.716345+10,12,1,174,correct
6638,"select count(*)
from person p,(select distinct id 
from writer) w
where p.id = w.id and year_born = 1935;

",2018-08-30 12:38:14.885819+10,1,1,348,correct
6639,"SELECT id
FROM witter w;",2018-08-30 12:39:07.790166+10,14,0,252,noninterpretable
6640,"select country
from restriction 
where lower (title)='shakespeare in love'
and lower(description)='m';",2018-08-30 12:39:15.892781+10,6,1,158,correct
6641,"SELECT id
FROM writer;",2018-08-30 12:39:45.439591+10,14,0,252,partially correct
6642,"select id, first_name, last_name
from person
order by year_born asc
limit 1;",2018-08-30 12:40:55.339552+10,7,0,163,partially correct
6643,"select *

from (person p natural join director natural join writer) as dw

group by dw.id

having count(*)>1;",2018-08-30 12:41:18.354573+10,4,0,389,partially correct
6644,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 12:41:21.455474+10,14,1,252,correct
6645,"select id, first_name, last_name
from person
order by year_born asc;",2018-08-30 12:41:22.722494+10,7,0,163,partially correct
6646,"select dw.id,dw.first_name,dw.last_name

from (person p natural join director natural join writer) as dw

group by dw.id

having count(*)>1;",2018-08-30 12:41:59.768146+10,4,1,389,correct
6647,"select id, first_name, last_name
from person
where year_born=(select max(year_born) from person);",2018-08-30 12:42:30.699519+10,7,1,158,correct
6648,"select id, first_name, last_name
from person
order by year_born desc
limit 1;",2018-08-30 12:42:40.557376+10,7,1,163,correct
6649,"select production_year y,count(*)
from movie
where y between 1991 and 1993
group by y;",2018-08-30 12:42:40.766+10,2,1,348,correct
6650,"select count(*)
from
writer
natural join
person
where
year_born = '1935';",2018-08-30 12:43:30.607603+10,1,0,271,partially correct
6651,"select production_year ,count(title) from movie
where production_year = 1993 or production_year =1992 or production_year =1991
group by production_year;",2018-08-30 12:43:31.267216+10,2,1,313,correct
6652,"SELECT count(*) 
FROM person
WHERE PERSON.id not in (select distinct DIRECTOR.id  from DIRECTOR) ;",2018-08-30 12:44:11.584871+10,12,1,189,correct
6653,"

select count(*)
from person p
where p.id not in (select distinct id
from director);",2018-08-30 12:44:35.038719+10,12,1,348,correct
6654,"WITH dwm as 
(select d.id, count(*) as NoOfMovies
from director d, movie m
where d.title=m.title
	and d.production_year=m.production_year
group by id

union 
select w.id, count(*) as NoOfMovies
from writer w,movie m
where w.title=m.title
	and w.production_year=m.production_year
group by id
order by NoOfMovies desc )

select id from dwm
where NoOfMovies = (select max(NoOfMovies) from dwm)

;",2018-08-30 12:45:30.936256+10,14,1,46,correct
6655,"select count(m.id)
from
(select distinct id
from
writer
natural join
person
where
year_born = '1935'
group by id) as m;",2018-08-30 12:45:52.280414+10,1,1,271,correct
6656,"select m.title,m.production_year
from movie m
where exists (select * from writer w where w.title=m.title and w.production_year=m.production_year);",2018-08-30 12:46:13.746854+10,5,0,389,partially correct
6657,"WITH dwm as 
(select d.id, count(*) as NoOfMovies
from director d
group by id
union 
select w.id, count(*) as NoOfMovies
from writer w
group by id
order by NoOfMovies desc )

select id from dwm
where NoOfMovies = (select max(NoOfMovies) from dwm)

;",2018-08-30 12:46:56.345495+10,14,1,46,correct
6658,"select r.id
from appearance a,
  scene sn,
  ROLE as r
  where lower(a.title)='psycho'
  and sn.title=a.title
  and a.production_year=1960
  and sn.production_year=a.production_year
  and sn.scene_no =a.scene_no
  and sn.title=r.title
  and sn.production_year=r.production_year
  and a.description=r.description
  group by r.id
 having count (*)=1;",2018-08-30 12:47:02.353865+10,10,1,263,correct
6659,select count(*) from person p where exists ( select * from writer w where p.year_born = 1935 and w.id = p.id)  ;,2018-08-30 12:47:09.989494+10,1,1,172,correct
6660,"
select production_year, count(production_year)
from
movie
where production_year >= 1991 and production_year <= 1993
group by production_year;",2018-08-30 12:47:55.34466+10,2,1,271,correct
6661,"

select p.id, p.first_name, p.last_name
from person p, (select d.id
	from director d, writer w
	where d.id = w.id and d.title = w.title and d.production_year = w.production_year) dw
where p.id = dw.id;",2018-08-30 12:48:12.917702+10,4,0,348,partially correct
6662,"select p.id
from person p
where p.year_born<(select max(year_born) from person)
order by year_born desc limit 1 ;",2018-08-30 12:49:14.558687+10,3,1,138,correct
6663,"

select p.id, p.first_name, p.last_name
from person p, (select d.id
	from director d, writer w
	where d.id = w.id and d.title = w.title and d.production_year = w.production_year
	group by d.id
	having count(*) > 1) dw
where p.id = dw.id;",2018-08-30 12:49:27.932447+10,4,1,348,correct
6664,"select count(m.id)
from
(select id from person
where id not in
(select id
from
director)
) as m;",2018-08-30 12:50:35.081769+10,12,1,271,correct
6665,"select m.title, m.production_year, p.first_name,p.last_name
from movie_award as m,director as d,person as p
where p.id=d.id
and lower(m.award_name)= 'bafta film award'
and lower(m.category)='best film'
and lower(m.result)='won'
and m.title=d.title
and m.production_year=d.production_year;",2018-08-30 12:50:57.063622+10,8,1,158,correct
6666,"select w.title,w.production_year

from writer w,person p

where w.id=p.id and lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-30 12:51:29.290843+10,5,1,389,correct
6667,"SELECT a1.id

FROM (role r NATURAL JOIN appearance a) AS a1

WHERE lower(a1.title)=""psycho"" AND production_year=1960
GROUP BY a1.id
HAVING count(*)=1;",2018-08-30 12:52:00.844014+10,10,1,128,correct
6668,"

select title,production_year
from writer w,(select id
	from person p
	where p.first_name = 'Kevin' and p.last_name = 'Williamson') pkw
where w.id = pkw.id;",2018-08-30 12:52:23.516108+10,5,1,348,correct
6669,"select id, first_name, last_name
from
director
natural join
writer
natural join
person
group by id, first_name, last_name
having count(id) >= 2;
",2018-08-30 12:52:24.8088+10,4,1,271,correct
6670,"select ma.title, ma.production_year, p.first_name, p.last_name
from MOVIE_AWARD ma, PERSON p, DIRECTOR d
where ma.title = d.title and d.id = p.id and
lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result)='won'
group by ma.title
having count(*)=1;",2018-08-30 12:52:33.907222+10,8,1,174,correct
6671,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma,director d,person p where p.id=d.id and ma.title=d.title and ma.production_year=d.production_year and ma.award_name='BAFTA Film Award' and ma.category='best film';",2018-08-30 12:53:02.457638+10,8,0,117,partially correct
6755,"SELECT count(*) AS number_of_award
FROM writer_award wa, writer w, person p

WHERE 
wa.title = w.title
AND p.id=w.id
AND w.id=wa.id
AND w.production_year = wa.production_year
AND lower(result)='won'
AND lower(first_name) = 'woody' 
AND lower(last_name) = 'allen' 
AND year_of_award >= 1991 
AND year_of_award <= 1995; ",2018-08-30 13:31:24.006552+10,9,1,410,correct
6672,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 12:53:45.059967+10,10,1,189,correct
6673,"select title, production_year
from
writer
natural join
person
natural join
movie
where first_name = 'Kevin'
and last_name = 'Williamson';",2018-08-30 12:54:07.004023+10,5,1,271,correct
6674,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 12:54:07.94338+10,8,1,410,correct
6675,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma,director d,person p where p.id=d.id and ma.title=d.title and ma.production_year=d.production_year and ma.award_name='BAFTA Film Award' and ma.category='best film' and ma.result='won';",2018-08-30 12:54:24.632218+10,8,1,117,correct
6676,"select count(*)
from 
movie as m
where not exisit
select title 
where movie_award as ma,
crew_award as ca,
writer_award as wa,
actor_award as aa
where
ma.title=m.title
and ca.title=m.title
and wa.title=m.title 
and aa.title=m.title
and ma.production_year=m.production_year
and wa.production_year=m.production_year
and ca.production_year=m.production_year
and aa.production_year=m.production_year;",2018-08-30 12:54:29.97219+10,11,0,263,noninterpretable
6677,"select r.country

from Restriction r

where lower(r.title) = 'shakespeare in love' and r.description = 'M';",2018-08-30 12:55:22.216662+10,6,1,389,correct
6678,"select country
from
Restriction
where
title = 'Shakespeare in Love'
and
description = 'M';",2018-08-30 12:55:24.149905+10,6,1,271,correct
6679,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-30 12:55:50.675403+10,6,1,348,correct
6680,"select id, first_name, last_name
from
person
where
year_born = (select max(year_born)
		from
		person);",2018-08-30 12:56:34.7336+10,7,1,271,correct
6681,"select count(*)
from person as p, writer_award as w
where p.id=w.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and w.year_of_award>1991
and w.year_of_award<1996;",2018-08-30 12:56:46.329185+10,9,1,158,correct
6682,"select count(id) from person
where id in(select person.id from person
except
select id from director);",2018-08-30 12:57:49.615994+10,12,1,313,correct
6683,"select id,first_name,last_name
from person p
where p.year_born = (select max(year_born)
	from person p2);

",2018-08-30 12:58:37.374266+10,7,1,348,correct
6684,"select title,production_year,first_name,last_name
from
movie_award
natural join
director
natural join
person
where
lower(result) = 'won'
and
lower(category) = 'best film'
and
award_name = 'BAFTA Film Award';",2018-08-30 12:59:21.068028+10,8,1,271,correct
6685,"select title, production_year, first_name, last_name
from
movie_award
natural join
person
where
award_name = 'BAFTA Film Award'
and
lower(category) = 'best film'
and
lower(result) = 'won;",2018-08-30 12:59:54.507714+10,8,0,271,noninterpretable
6686,"select p.id, p.first_name, p.last_name

from person p



order by p.year_born desc;",2018-08-30 13:00:12.544921+10,7,0,389,partially correct
6687,"select title, production_year, first_name, last_name
from
movie_award
natural join
person
where
award_name = 'BAFTA Film Award'
and
lower(category) = 'best film'
and
lower(result) = 'won';",2018-08-30 13:00:14.093167+10,8,0,271,partially correct
6688,"select title, production_year, first_name, last_name
from
movie_award
natural join
person
natural join
director
where
award_name = 'BAFTA Film Award'
and
lower(category) = 'best film'
and
lower(result) = 'won';
",2018-08-30 13:01:08.433012+10,8,1,271,correct
6689,select COUNT(*) from person where not exists (select * from director where person.id = director.id);,2018-08-30 13:01:14.858983+10,12,1,183,correct
6690,"select p.id, p.first_name, p.last_name

from person p

where p.year_born = (select max(year_born) from person);",2018-08-30 13:01:42.395279+10,7,1,389,correct
6691,"SELECT count(*), award_name 
FROM WRITER_AWARD wa
WHERE ( SELECT first_name, last_name FROM person p WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' ) 
AND year_of_award > 1991 AND year_of_award <= 1995; ",2018-08-30 13:01:58.025778+10,9,0,410,noninterpretable
6692,"select l.id from
(select d.id, d.title, d.production_year from DIRECTOR as d
UNION
select w.id, w.title, w.production_year from WRITER as w) as l
group by l.id
order by count(*) DESC
limit 1;",2018-08-30 13:02:08.110314+10,14,0,167,partially correct
6693,"select count(*)
from
writer_award
natural join
writer
natural join
person
where
year_of_award >= 1991
and
year_of_award <= 1995
and
first_name = 'Woody'
and
last_name = 'Allen';",2018-08-30 13:03:53.643744+10,9,0,271,partially correct
6694,"select v.id from (select u.* from (select p1.*,p1.max(year_born) as max from person p1 where not exists (select p2.* from person p2 where p2.year_born=p1.max) u ;
",2018-08-30 13:04:46.60299+10,3,0,270,noninterpretable
6695,"select count(*)
from
writer_award
natural join
writer
natural join
person
where
year_of_award >= 1991
and
year_of_award <= 1995
and
first_name = 'Woody'
and
last_name = 'Allen'
and
result = 'won';
",2018-08-30 13:05:00.141331+10,9,1,271,correct
6696,"SELECT COUNT(m.title) FROM movie m
WHERE m.title NOT IN
(SELECT ma.title FROM movie_award ma
WHERE lower(ma.result) = 'won'
UNION
SELECT ca.title FROM crew_award ca
WHERE lower(ca.result) = 'won'
UNION
SELECT da.title FROM director_award da
WHERE lower(da.result) = 'won'
UNION
SELECT wa.title FROM writer_award wa
WHERE lower(wa.result) = 'won'
UNION
SELECT aa.title FROM actor_award aa
WHERE lower(aa.result) = 'won');",2018-08-30 13:05:15.205606+10,11,0,95,partially correct
6697,"select p.id,p.first_name,p.last_name
from person as p, director as d, writer as w
where p.id=d.id
and w.id=p.id
and d.title=w.title
and d.production_year=w.production_year
group by p.id
having count(*)>1;",2018-08-30 13:05:50.616363+10,4,1,158,correct
6698,"select count(*)
from 
movie as m
where not exists
      SELECT title,production_year
	  from movie_award as ma 
	  where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
	  union
	  from crew_award as ca
	  where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won'
	  union
	  from writer_award as wa
	  where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
	  union
	  from actor_award as aa
	  where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won'
	  union
	  from director_award as da
	  where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
	  ;
",2018-08-30 13:06:51.108648+10,11,0,263,noninterpretable
6699,"select id
from
role
natural join
appearance
where lower(title) = 'psycho'
and
production_year = '1960'
group by id
having count(id) = 1;",2018-08-30 13:07:26.466255+10,10,1,271,correct
6700,"select count(distinct person.id)
from person,writer
where person.id = writer.id
and person.year_born=1935;",2018-08-30 13:07:29.957581+10,1,1,344,correct
6701,"select count(*)
from movie
where movie.production_year in (1991,1992,1993);",2018-08-30 13:08:38.631962+10,2,0,344,partially correct
6702,"select ma.title, ma.production_year

from movie_award ma

where ma.award_name = 'BAFTA File Award' and ma.category = 'Best Film';",2018-08-30 13:09:20.386565+10,8,0,389,partially correct
6703,"SELECT id
FROM
(SELECT id ,MAX(year_born)
FROM PERSON
WHERE id NOT IN
(SELECT a2.id 
FROM
(SELECT id,max(year_born)
FROM person) as a2));",2018-08-30 13:09:44.819+10,3,1,128,correct
6704,"SELECT production_year, SUM(title) FROM Movie
WHERE production_year = 1993 and production_year = 1992
and production_year = 1991;",2018-08-30 13:09:52.91358+10,2,0,224,partially correct
6705," select count(*)
 from movie m
 where  m.title not in
 
 (select m.title
                   from movie m inner join movie_award ma
				   on m.title = ma.title
				   union
				   select m.title 
				   from movie m inner join crew_award ca
				   on m.title =ca.title
				   union
				   select m.title 
				   from movie m inner join director_award da
				   on m.title = da.title
				   union 
				   select m.title
				   from movie m inner join writer_award wa
				   on m.title = wa.title
				   union 
				   select m.title
				   from movie m inner join actor_award aa
				   on m.title =aa.title);
",2018-08-30 13:10:10.767463+10,11,0,298,partially correct
6706,"select production_year,count(*)
from movie
where movie.production_year in (1991,1992,1993)
group by production_year;",2018-08-30 13:10:17.007528+10,2,1,344,correct
6707,"select count(*)
from
movie m
where
title not in (select title from movie_award where m.production_year=production_year and lower(result) = 'won')
and
title not in (select title from crew_award where m.production_year=production_year and lower(result) = 'won')
and
title not in (select title from director_award where m.production_year=production_year and lower(result) = 'won')
and
title not in (select title from writer_award where m.production_year=production_year and lower(result) = 'won')
and
title not in (select title from actor_award where m.production_year=production_year and lower(result) = 'won');
",2018-08-30 13:10:41.586023+10,11,1,271,correct
6708,"SELECT count(*) 
FROM movie as m 
WHERE not exists (
	SELECT title, production_year
	FROM movie_award as ma 
	  where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
	  union
	FROM crew_award as ca
	  where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won'
	  union
	FROM writer_award as wa
	  where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
	  union
	FROM actor_award as aa
	  where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won'
	  union
	FROM director_award as da
	  where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
	  ;",2018-08-30 13:11:00.839815+10,11,0,263,noninterpretable
6709,"select count(*)
from person
where person.id not in (select id from director);",2018-08-30 13:11:42.769288+10,12,1,344,correct
6710,"SELECT count(*) 
FROM movie as m 
WHERE not exists (
	SELECT title, production_year
	FROM movie_award as ma 
	  where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
	  union
	FROM crew_award as ca
	  where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won'
	  union
	FROM writer_award as wa
	  where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
	  union
	FROM actor_award as aa
	  where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won'
	  union
	FROM director_award as da
	  where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
	  ;",2018-08-30 13:11:51.563485+10,11,0,263,noninterpretable
6711,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year = 1991 AND production_year = 1992 AND production_year = 1993 
GROUP BY production_year;",2018-08-30 13:12:16.14958+10,2,0,224,partially correct
6712,"
select first_name, last_name, dma.title, dma.production_year
	from person p, (select id, d.title, d.production_year
	from  director d, (select title, production_year
		from movie_award
		where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won') ma
	where d.title = ma.title and d.production_year = ma.production_year) dma
where p.id = dma.id;
",2018-08-30 13:12:17.593507+10,8,1,348,correct
6713,"select id,first_name,last_name from person
where id in(
select director.id from director inner join writer on director.id = writer.id
group by director.id
having count(director.id) >=2);
",2018-08-30 13:12:30.323538+10,4,0,313,partially correct
6714,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year <1994
GROUP BY production_year;",2018-08-30 13:13:00.454088+10,2,1,224,correct
6715,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award as ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award as ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award as da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award as aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award as wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 13:13:29.498854+10,11,1,263,correct
6716,"select person.id,first_name,last_name
from person,writer,director
where writer.title = director.title
and writer.production_year = director.production_year
and writer.id = person.id
and writer.id = director.id
group by person.id
having count(*)>1;",2018-08-30 13:13:55.897124+10,4,1,344,correct
6717,"
select dma.title, dma.production_year,p.first_name, p.last_name 
	from  person p,(select id, d.title, d.production_year
	from  director d, (select title, production_year
		from movie_award
		where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won') ma
	where d.title = ma.title and d.production_year = ma.production_year) dma
where p.id = dma.id;
",2018-08-30 13:13:57.48181+10,8,1,348,correct
6718,"SELECT id, MAX(num) FROM
(SELECT dw.id, COUNT(*) AS num FROM 
(SELECT d.id,d.title,d.production_year FROM director d UNION SELECT w.id,w.title,w.production_year FROM writer w) AS dw GROUP BY dw.id)
GROUP BY num;",2018-08-30 13:14:27.164351+10,14,0,388,partially correct
6719,"select l.id  from
(select d.id, d.title, d.production_year from DIRECTOR as d
UNION
select w.id, w.title, w.production_year from WRITER as w) as l
group by l.id
having count(*) in
			(select MAX(number) from 
						(select count(*) as number from
						(select d.id, d.title, d.production_year from DIRECTOR as d
						UNION
						select w.id, w.title, w.production_year from WRITER as w) as l
						group by l.id) as j);",2018-08-30 13:14:51.155083+10,14,1,167,correct
6720,"select production_year,count (*) from Movie 
where production_year='1993' or production_year='1992' or production_year='1991' 
group by production_year;",2018-08-30 13:15:53.166598+10,2,1,202,correct
6721,select p.id from person p where p.year_born=(select max(year_born) from person where year_born < (select max (year_born) from person));,2018-08-30 13:16:43.661084+10,3,1,270,correct
6722,"select distinct r.id 
from role as r, appearance as a
where r.title=a.title
and lower(a.title)='psycho'
and r.production_year=a.production_year
and a.production_year=1960
and a.scene_no=1;
",2018-08-30 13:16:51.73848+10,10,0,158,partially correct
6723,"select movie.title,movie.production_year
from movie,writer,person
where movie.title = writer.title
and movie.production_year = writer.production_year
and writer.id=person.id
and lower(person.first_name)='kevin'
and lower(person.last_name)='williamson';",2018-08-30 13:17:10.895601+10,5,1,344,correct
6724,"select m.id
from
(select id, year_born from person
where year_born !=
(select max(year_born) from person)) as m
where year_born = (select max(m.year_born)
			from
			(select id, year_born from person
			where year_born !=
			(select max(year_born) from person)) as m
)
;",2018-08-30 13:17:13.837474+10,3,1,271,correct
6725,"select id
from
person
where year_born = (select max(m.year_born)
			from
			(select id, year_born from person
			where year_born !=
			(select max(year_born) from person)) as m
)
;",2018-08-30 13:17:43.462045+10,3,1,271,correct
8818,"select country from Restriction
where title = 'Shakespeare in Love'  and description = 'M';",2018-08-31 00:19:08.098024+10,6,1,430,correct
6727,"SELECT COUNT(*)
FROM movie m
WHERE 
(m.title NOT IN (SELECT title FROM movie_award WHERE lower(result)=""won"")
OR m.production_year NOT IN (SELECT production_year FROM movie_award WHERE lower(result)=""won""))

AND 
(m.title NOT IN (SELECT title FROM crew_award WHERE lower(result)=""won"")
OR m.production_year NOT IN (SELECT production_year FROM crew_award WHERE lower(result)=""won""))

AND
(m.title NOT IN (SELECT title FROM director_award WHERE lower(result)=""won"")
OR m.production_year NOT IN (SELECT production_year FROM director_award WHERE lower(result)=""won""))

AND
(m.title NOT IN (SELECT title FROM writer_award WHERE lower(result)=""won"")
OR m.production_year NOT IN (SELECT production_year FROM writer_award WHERE lower(result)=""won""))

AND
(m.title NOT IN (SELECT title FROM actor_award WHERE lower(result)=""won"")
OR m.production_year NOT IN (SELECT production_year FROM actor_award WHERE lower(result)=""won""));
",2018-08-30 13:18:02.079947+10,11,0,128,partially correct
6728,"select country
from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';
",2018-08-30 13:18:49.814039+10,6,1,344,correct
6729,;,2018-08-30 13:19:13.655656+10,3,0,263,noninterpretable
6730,"SELECT p.id FROM person p 
WHERE p.year_born IN
(SELECT MAX(re.year_born) FROM (SELECT * FROM person p 
WHERE p.year_born NOT IN 
(SELECT MAX(p.year_born) FROM person p)) AS re);",2018-08-30 13:19:18.641494+10,3,1,95,correct
6731,"select id,first_name,last_name
from person
where year_born in (select max(year_born) from person);",2018-08-30 13:20:00.443513+10,7,1,344,correct
6732,"select count(*)
from writer_award wa, (select id
	from person p
	where lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen') p_wa
where wa.id = p_wa.id and lower(result) = 'won'and wa.year_of_award between 1991 and 1995;",2018-08-30 13:20:23.932104+10,9,1,348,correct
6733,"select id, award_name, year_of_award, category
from
director
natural join
director_award
where
lower(result) = 'nominated'
and
id not in (select id
from
director
natural join
director_award
where
lower(result) = 'won');",2018-08-30 13:22:00.672104+10,13,1,271,correct
6734,"select movie.title,movie.production_year
from movie,movie_award
where movie.title = movie_award.title
and movie.production_year = movie_award.production_year
and lower(category)='best film'
and lower(award_name) = 'bafta film award'
and lower(result)='won';",2018-08-30 13:22:47.951107+10,8,0,344,partially correct
6735,"select person.first_name,person.last_name,role.title,role.production_year,role.description
from person,role
where person.id=role.id
      and role.id = any (select distinct id from role group by id having count(*)>=all(select count(*) from role group by id));",2018-08-30 13:23:17.51941+10,15,0,300,noninterpretable
6736,"select pr.id
from person pr
WHERE pr.year_born=(SELECT MAX(year_born)
 FROM person 
 WHERE year_born<(SELECT MAX(year_born) From person));",2018-08-30 13:23:20.299026+10,3,1,263,correct
6737,"select p.id,p.first_name,p.last_name
from person as p
where p. year_born=(select max(year_born) from person );",2018-08-30 13:24:37.15342+10,7,1,223,correct
6738,"select movie_award.title,movie_award.production_year,first_name,last_name
from director,movie_award,person
where director.id=person.id
and director.title = movie_award.title
and director.production_year = movie_award.production_year
and lower(category)='best film'
and lower(award_name) = 'bafta film award'
and lower(result)='won';",2018-08-30 13:24:51.291559+10,8,1,344,correct
6739,"SELECT id FROM
(SELECT dw.id, COUNT(*) AS num FROM 
(SELECT d.id,d.title,d.production_year FROM director d 
	UNION 
	SELECT w.id,w.title,w.production_year FROM writer w) AS dw GROUP BY dw.id)
WHERE num = (SELECT MAX(num) FROM 
(SELECT dw.id, COUNT(*) AS num FROM 
(SELECT d.id,d.title,d.production_year FROM director d 
	UNION 
	SELECT w.id,w.title,w.production_year FROM writer w) AS dw GROUP BY dw.id));",2018-08-30 13:25:02.889737+10,14,1,388,correct
6740,"
select p.first_name, p.last_name, r.title, r.production_year, r.description
from PERSON as p, ROLE as r
where p.id = r.id
	and r.id in
			(select ROLE.id from ROLE
			group by ROLE.id
			having count(*) in
						(select MAX(num) as maxNum 
						from
							(select count(*) as num from ROLE as r
						group by r.id) as l));",2018-08-30 13:26:06.782615+10,15,1,167,correct
6741,"select r.id 
from role as r, appearance as a,scene as s
where r.title=a.title
and lower(a.title)='psycho'
and r.production_year=a.production_year
and a.production_year=1960
and s.scene.no=a.scene.no
and a.description=r.description
and a.title=s.title
and a.production_year=r.production_year
group by r.id
count(*)=1
;",2018-08-30 13:26:42.635187+10,10,0,158,noninterpretable
6742,"select count(id) from Person
Except select id from Director ;
",2018-08-30 13:27:33.846662+10,12,0,202,partially correct
6743,"SELECT id, award_name, year_of_award, categories
FROM writer_award
WHERE lower(result)='moninate'
      and lower (result)!='won'
	  COUNT(*)>=1;",2018-08-30 13:27:45.234439+10,13,0,263,noninterpretable
6744,"select m.id
from
(select f.id, count(f.id) as maxx
	from
	((select id, title, production_year from director)
	union
	(select id, title, production_year from writer)) as f
	group by f.id) as m
where m.maxx = 
(select max(m.maxx)
from
(select f.id, count(f.id) as maxx
	from
	((select id, title, production_year from director)
	union
	(select id, title, production_year from writer)) as f
	group by f.id) as m);
",2018-08-30 13:27:55.868177+10,14,0,271,noninterpretable
6745,"select d.id, da.award_name,da.year_of_award,da.category
from director d, director_award da
where lower(da.result)='nominated' and da.title in (
select d.title
from director d
where d.title not in (select da.title 
                      from director_award da))
group by d.id
having count(*)>=1;",2018-08-30 13:27:59.028251+10,13,0,298,partially correct
6746,"select count(*)
from writer_award,person,writer
where writer_award.title = writer.title
and writer_award.production_year = writer.production_year
and person.id=writer.id
and person.first_name='Woody'
and person.last_name='Allen'
and writer_award.year_of_award between 1991 and 1995;",2018-08-30 13:28:19.774156+10,9,0,344,partially correct
6747,"SELECT country
FROM Restriction_Category r
WHERE r.title='Shakespeare in Love' AND r.description='M';",2018-08-30 13:28:20.019617+10,6,0,395,noninterpretable
6748,"select count(*)
from writer_award,person,writer
where writer_award.title = writer.title
and writer_award.production_year = writer.production_year
and person.id=writer.id
and person.first_name='Woody'
and person.last_name='Allen'
and lower(writer_award.result)='won'
and writer_award.year_of_award between 1991 and 1995;",2018-08-30 13:28:57.775952+10,9,1,344,correct
6749,"SELECT first_name, last_name, *
FROM  person, role
WHERE person.id=role.id;",2018-08-30 13:29:22.490258+10,15,0,233,partially correct
6750,"SELECT country
FROM Restriction r
WHERE r.title='Shakespeare in Love' AND r.description='M';",2018-08-30 13:29:26.484326+10,6,1,395,correct
6751,"
select count(id)from(
select id from Person
Except select id from Director )AS M;
",2018-08-30 13:29:30.736021+10,12,1,202,correct
6752,"select x.id from (
select x1.id, count(*) as noOfWorkedOn
from (select d.id, title, production_year
             from director as d
			union
			select w.id, title, production_year
			from writer as w) as x1
			Group by x1.id) as x
where x.noOfWorkedOn=(select max(x2.noOfWorkedOn)
                            from (select x1.id, count(*) as noOfWorkedOn
                                    from (select d.id, title, production_year
                                       from director as d
		                         	union
		                         	select w.id, title, production_year
		                         	from writer as w) as x1
									group by x1.id )as x2 );",2018-08-30 13:29:43.516046+10,14,1,385,correct
6753,SELECT COUNT(*) FROM WRITER W JOIN PERSON P ON W.id = P.id WHERE P.year_born == 1935;,2018-08-30 13:30:05.049152+10,1,0,384,noninterpretable
6754,"select r_p.id
from appearance a, (select r.id,description,title,production_year
	from role r 
	where lower(title) = 'psycho' and r.production_year = 1960) r_p
where a.title = r_p.title and a.production_year = r_p.production_year and a.description = r_p.description
group by r_p.id
having count(*) = 1;",2018-08-30 13:30:53.182835+10,10,1,348,correct
6756,"select h.id, h.first_name, h.last_name from (select COUNT(person.id), person.id, person.first_name, person.last_name from person, ((select * from director inner join movie on director.title = movie.title) as a 
inner join (select * from writer inner join movie on writer.title = movie.title) as b on a.id = b.id) as c where person.id = c.id group by person.id
having COUNT(person.id) > 1) h;",2018-08-30 13:33:07.444181+10,4,0,183,partially correct
6757,"select d.id, da.award_name,da.year_of_award,da.category
from director d, director_award da
where d.title = da.title and lower(da.result)='nominated' AND da.production_year = d.production_year  
                and da.title in (
                                 select d.title
                                 from director d
                                 where d.title not in (select da.title 
                                 from director_award da
                                 where lower(da.result='won') ));
",2018-08-30 13:34:13.969175+10,13,1,298,correct
6758,"
SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 13:34:24.851376+10,13,1,95,correct
6759,"SELECT id, first_name, last_name
FROM Writer as w, Person as p, (SELECT title, count(*) AS movie_count FROM Director group by title) as d
WHERE p.id = w.id
AND d.movie_count > 1;",2018-08-30 13:35:37.083309+10,4,0,224,noninterpretable
6760,"select id
from appearance,scene,role
where appearance.title = role.title
and appearance.title = scene.title
and appearance.production_year = role.production_year
and appearance.production_year = scene.production_year
and appearance.title='Psycho'
and appearance.production_year=1960
and appearance.description = role.description
and appearance.scene_no = scene.scene_no
group by id
having count(*)=1;",2018-08-30 13:36:16.161257+10,10,1,344,correct
6761,"SELECT id,first_name,last_name
FROM person
WHERE year_born < ANY (SELECT year_born From person);
",2018-08-30 13:36:19.0107+10,7,0,395,noninterpretable
6762,"SELECT dr.id, wa.award_name, wa.year_of_award, wa.category
FROM writer_award wa,
     director dr
WHERE lower(wa.result)='moninate'
      and dr.title=wa.title
	  and dr.production_year=wa.production_year
      and dr.id NOT IN (SELECT id 
	  FROM writer_award,
     director
WHERE lower(wa.result)!='won'
      and dr.title=wa.title
	  and dr.production_year=wa.production_year);",2018-08-30 13:36:32.893796+10,13,0,263,noninterpretable
6763,"select first_name, last_name, title, production_year,description
from
role
natural join
person
where
id in
(select m.id
from
(select id, count(id) as maxx
from
role
natural join
person
group by id) as m
where
m.maxx = 
(select max(m.maxx)
from
(select id, count(id) as maxx
from
role
natural join
person
group by id) as m));
",2018-08-30 13:36:42.014277+10,15,1,271,correct
6764,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p;

",2018-08-30 13:37:43.810372+10,4,0,191,partially correct
6765,"select ma1.title,ma1.production_year,p.first_name,p.last_name
from
  (select ma.title,ma.production_year 
   from Movie_Award as ma
   where  ma.award_name='BAFTA Film Award' and ma.category='Best Film' and ma.result='won') as ma1,
   person as p,Director as d
where ma1.title=d.title and ma1.production_year=d.production_year and d.id=p.id;",2018-08-30 13:37:46.94163+10,8,0,223,partially correct
6766,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 13:38:03.772036+10,4,1,224,correct
6767,"
SELECT COUNT ( DISTINCT W.id ) FROM WRITER W JOIN PERSON P ON W.id = P.id WHERE P.year_born == 1935;",2018-08-30 13:38:24.729436+10,1,0,384,noninterpretable
6768,"SELECT id,first_name,last_name
FROM person
WHERE year_born =(SELECT max(year_born) From person);
",2018-08-30 13:38:42.863797+10,7,1,395,correct
6769,"SELECT dr.id, wa.award_name, wa.year_of_award, wa.category
FROM writer_award wa,
     director dr
WHERE lower(wa.result)='moninated'
      and dr.title=wa.title
	  and dr.production_year=wa.production_year
      and dr.id NOT IN (SELECT wa.id 
	  FROM writer_award wa,
     director dr
WHERE lower(wa.result)!='won'
      and dr.title=wa.title
	  and dr.production_year=wa.production_year);",2018-08-30 13:38:54.832671+10,13,0,263,partially correct
6770,"SELECT production_year, COUNT(*) FROM MOVIE GROUP BY production_year HAVING production_year IN (1993, 1992, 1991);",2018-08-30 13:41:40.73749+10,2,1,384,correct
6771,"SELECT year_born, COUNT(*)
FROM person, writer
WHERE person.id=writer.id AND year_born=1935;
",2018-08-30 13:41:44.986394+10,1,0,233,partially correct
6772,"select count(*)
from movie m1
where m1.title not in 
(select title 
from movie_award ma 
where m1.title = ma.title and m1.production_year = ma.production_year and lower(ma.result)='won')
and m1.title not in 
(select title 
from writer_award ma 
where m1.title = ma.title and m1.production_year = ma.production_year and lower(ma.result)='won')
and m1.title not in 
(select title 
from director_award ma 
where m1.title = ma.title and m1.production_year = ma.production_year and lower(ma.result)='won')
and m1.title not in 
(select title 
from crew_award ma 
where m1.title = ma.title and m1.production_year = ma.production_year and lower(ma.result)='won')
and m1.title not in 
(select title 
from actor_award ma 
where m1.title = ma.title and m1.production_year = ma.production_year and lower(ma.result)='won')

;",2018-08-30 13:42:36.184891+10,11,1,344,correct
6773,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 13:42:58.227679+10,13,1,263,correct
6774,"WITH ids AS (SELECT id FROM writer NATURAL JOIN person
WHERE year_born = 1935),

 writer AS (SELECT DISTINCT id FROM ids)

SELECT COUNT(*) FROM writer;",2018-08-30 13:43:10.051402+10,1,0,25,noninterpretable
6775,"select id,max(total)
from (select id,count(*) as total
from (select distinct id,title,production_year 
from (select w.id,w.title,w.production_year
from writer w
union select d.id,d.title,d.production_year from director d))
group by id)
;",2018-08-30 13:43:30.372422+10,14,0,397,partially correct
6776,"
select id 
from person p
where p.year_born = (select max(p1.year_born)
	from person p1
	where p1.year_born < (select max(year_born)
				from person));
",2018-08-30 13:43:31.874816+10,3,1,348,correct
6777,"WITH ids AS (SELECT id FROM writer NATURAL JOIN person
WHERE year_born = 1935),

 writers AS (SELECT DISTINCT id FROM ids)

SELECT COUNT(*) FROM writers;",2018-08-30 13:43:48.261712+10,1,1,25,correct
6778,"select ma1.title,ma1.production_year,p.first_name,p.last_name
from
  (select title,production_year 
   from Movie_Award  
   where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won') as ma1,
   person as p,Director as d
where ma1.title=d.title and ma1.production_year=d.production_year and d.id=p.id;",2018-08-30 13:43:53.901644+10,8,1,223,correct
6779,"select id
from person
where year_born in (select year_born from person order by year_born limit 1 offset 1);",2018-08-30 13:44:20.382835+10,3,0,344,partially correct
6780,";
",2018-08-30 13:44:35.993921+10,14,0,263,noninterpretable
6781,"WITH movies AS (SELECT title,production_year FROM movie
WHERE production_year = 1993

UNION

SELECT title, production_year FROM movie
WHERE production_year= 1992

UNION

SELECT title, production_year FROM movie
WHERE production_year = 1991)

SELECT production_year, COUNT(production_year) FROM movies
GROUP BY production_year;",2018-08-30 13:44:45.437659+10,2,1,25,correct
6783,"WITH not_directors AS (SELECT DISTINCT id FROM person
WHERE id NOT IN (SELECT id FROM director))

SELECT COUNT(*) FROM not_directors;",2018-08-30 13:45:02.969457+10,12,1,25,correct
6784,"select id
from person
where year_born in (select year_born from person order by year_born desc limit 1 offset 1);",2018-08-30 13:45:15.525003+10,3,1,344,correct
6785,"WITH d_w AS (SELECT DISTINCT id,first_name, last_name,title, production_year FROM person NATURAL JOIN director NATURAL JOIN writer),

at_least AS (SELECT id, COUNT(id) tot FROM d_w
GROUP BY id)

SELECT DISTINCT id,first_name,last_name FROM d_w
WHERE id IN (SELECT id FROM at_least
		WHERE tot >= 2);",2018-08-30 13:45:24.319946+10,4,1,25,correct
6786,"select dw.id, dw.first_name, dw.last_name from (person natural join director natural join writer) as dw group by dw.id having COUNT(*) > 1;",2018-08-30 13:45:27.619853+10,4,1,183,correct
6787,"
SELECT title,production_year FROM writer NATURAL JOIN person
WHERE lower(first_name) = 'kevin'
AND lower(last_name) = 'williamson';",2018-08-30 13:45:43.14211+10,5,1,25,correct
6788,"
SELECT country FROM restriction
WHERE lower(title) = 'shakespeare in love'
AND lower(description) = 'm';",2018-08-30 13:45:59.11336+10,6,1,25,correct
6789,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);
",2018-08-30 13:46:18.510733+10,7,1,25,correct
6790,"SELECT title,production_year,first_name,last_name FROM person NATURAL JOIN movie_award NATURAL JOIN director
WHERE lower(result) = 'won'
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film';",2018-08-30 13:46:33.222048+10,8,1,25,correct
6791,"select count(person.year_born )  
from person
inner join writer
on person.id = writer.id;",2018-08-30 13:46:47.113981+10,1,0,358,partially correct
6792,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
AND year_of_award >= 1991 AND year_of_award <= 1995
AND lower(result) = 'won';",2018-08-30 13:46:47.479154+10,9,1,25,correct
6793,"WITH appearances AS (SELECT id,COUNT(id) tot FROM appearance NATURAL JOIN role
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY id)

SELECT id FROM appearances 
WHERE tot = 1;
",2018-08-30 13:47:00.462138+10,10,1,25,correct
6794,"select COUNT(*)
from writer_award w INNER JOIN (select id 
from person p where lower(p.first_name)=""woody"" and lower(p.last_name)=""allen"") AS woody
ON w.id=woody.id and w.year_of_award>1990 and w.year_of_award<1996;",2018-08-30 13:47:10.458141+10,9,0,307,partially correct
6795,"

select id,award_name,year_of_award,category
from director_award,director
where director_award.title = director.title
and director_award.production_year = director.production_year
and lower(result)!='won';",2018-08-30 13:47:23.771482+10,13,1,344,correct
6796,"WITH winners AS (
SELECT title,production_year FROM movie_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM crew_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM director_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM writer_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM actor_award
WHERE lower(result) = 'won'
)




SELECT DISTINCT title,production_year FROM movie
WHERE (title,production_year) NOT IN (SELECT * FROM winners);
",2018-08-30 13:47:23.773151+10,11,0,25,partially correct
6797,SELECT COUNT(*) FROM PERSON WHERE id NOT IN (SELECT P.id FROM DIRECTOR D JOIN PERSON P ON D.id = P.id);,2018-08-30 13:47:43.613752+10,12,1,384,correct
6798,"WITH winners AS (
SELECT title,production_year FROM movie_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM crew_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM director_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM writer_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM actor_award
WHERE lower(result) = 'won'
)




SELECT COUNT(*) FROM movie
WHERE (title,production_year) NOT IN (SELECT * FROM winners);
",2018-08-30 13:48:00.869628+10,11,1,25,correct
6799,"select COUNT(*) as num_of_award
from writer_award w INNER JOIN (select id 
from person p where lower(p.first_name)=""woody"" and lower(p.last_name)=""allen"") AS woody
ON w.id=woody.id and w.year_of_award>1990 and w.year_of_award<1996 and lower(w.result)=""won"";",2018-08-30 13:48:56.634114+10,9,1,307,correct
6800,"WITH oldest AS (SELECT id FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person))

SELECT MAX(year_born) FROM person
WHERE id NOT IN (SELECT * FROM oldest);

",2018-08-30 13:49:50.36973+10,3,0,25,partially correct
6801,"select p.first_name, p.last_name, r.title, r.production_year, r.description 
from person as p, role as r, (select count(r.id) as num from role as r, person
          where  r.id = person.id
		  group by r.id) as pr
where pr.num = max(pr.num);",2018-08-30 13:49:58.324907+10,15,0,385,noninterpretable
6802,"SELECT title, production_year FROM WRITER w NATURAL JOIN PERSON p
WHERE p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-30 13:50:10.231946+10,5,1,224,correct
6803,"WITH oldest AS (SELECT id FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person))

SELECT id FROM person
WHERE id NOT IN (SELECT * FROM oldest)
AND year_born = (SELECT (MAX(year_born) FROM person);

",2018-08-30 13:50:53.172669+10,3,0,25,noninterpretable
6804,"select count(*)

from Writer_Award as wa,person as p

where p.id=wa.id and p.first_name='Woody' and p.last_name='Allen' and wa.year_of_award>=1991 and wa.year_of_award<=1995;",2018-08-30 13:51:58.04616+10,9,0,223,partially correct
6805,"with t as (select id,total
from (select id,count(*) as total
from (select distinct id,title,production_year 
from (select w.id,w.title,w.production_year
from writer w
union select d.id,d.title,d.production_year from director d))
group by id)) 

select id from t
where total=(select max(total) from t);",2018-08-30 13:52:28.522656+10,14,1,397,correct
6806,"WITH oldest AS (SELECT MAX(year_born) FROM person)

SELECT id FROM person
		WHERE year_born NOT IN (SELECT * FROM oldest);

",2018-08-30 13:52:45.194168+10,3,0,25,partially correct
6807,"select title, production_year from writer inner join person on writer.id = person.id and person.first_name = 'Kevin' and person.last_name = 'Williamson';",2018-08-30 13:53:20.266295+10,5,1,183,correct
6808,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 13:53:27.546564+10,11,1,81,correct
6809,"select p.first_name, p.last_name, r.title, r.production_year, r.description 
from person as p, role as r, (select id, count(*) as num from role 
		  group by id) as pr
where p.id=r.id and p.id=pr.id and pr.num in 
                    (select max(num) from (select id, count(*) as num from role 
		  group by id) as q);",2018-08-30 13:54:11.386482+10,15,1,385,correct
6810,"WITH oldest AS (SELECT MAX(year_born) FROM person),

second AS (SELECT year_born FROM person
		WHERE year_born NOT IN (SELECT * FROM oldest))
		
SELECT id FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person)
			AND year_born NOT IN (SELECT * FROM second);

",2018-08-30 13:55:00.462188+10,3,0,25,partially correct
6811,"SELECT COUNT(*)
FROM writer, person 
WHERE writer.id=person.id 
AND person.year_born=1935;",2018-08-30 13:55:15.699979+10,1,0,421,partially correct
6847,"select d.id,award_name, year_of_award, category
from director d,director_award da
where lower(result) = 'nominated' and d.title = da.title and d.production_year = da.production_year;

",2018-08-30 14:12:29.079392+10,13,1,348,correct
6812,"SELECT  dw.id
FROM movie, director, writer,(SELECT person.id, movie.title, movie.production_year
                                                FROM person, director, movie
                                             WHERE person.id = director.id AND director.title = movie.title AND director.production_year =movie.production_year
                                            UNION
                                           SELECT person.id, movie.title, movie.production_year
                                           FROM person, writer, movie
                                    WHERE person.id = writer.id AND writer.title = movie.title AND writer.production_year =movie.production_year) AS dw
WHERE writer.title = director.title AND writer.production_year = director.production_year
              AND director.title = movie.title AND director.production_year =movie.production_year
             AND writer.title = movie.title AND writer.production_year =movie.production_year
GROUP BY dw.id
HAVING  COUNT(*)>=0
ORDER BY COUNT(*) DESC
LIMIT 3;
",2018-08-30 13:55:33.690243+10,14,1,165,correct
6813,"SELECT id,award_name,year_of_award,category FROM director_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(result) != 'won';
",2018-08-30 13:55:43.965019+10,13,1,25,correct
6814,"select a.id,a.first_name,a.last_name
from person a,movie b,crew c,scene d
where a.id=c.id 
  and b.production_year=1960 
  and lower(b.title)='psycho'
  and b.title=c.title
  and b.production_year=c.production_year
  and b.title=d.title
  and b.production_year=d.production_year
group by a.id,a.first_name,a.last_name
having count(*)=1;
",2018-08-30 13:55:59.700288+10,10,0,205,partially correct
6815,"select ma1.title,ma1.production_year,p.first_name,p.last_name
from
  (select title,production_year 
   from Movie_Award  
   where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won') as ma1,
   person as p,Director as d
where ma1.title=d.title and ma1.production_year=d.production_year and d.id=p.id;",2018-08-30 13:56:13.505061+10,8,1,223,correct
6816,"WITH role_count AS (SELECT id,COUNT(description) tot FROM person NATURAL JOIN role
GROUP BY id)

SELECT first_name,last_name,title,production_year,description FROM person NATURAL JOIN role
WHERE id IN (SELECT id FROM role_count 
		WHERE tot = (SELECT MAX(tot) FROM role_count));",2018-08-30 13:56:27.144024+10,15,1,25,correct
6817,"SELECT id, first_name, last_name FROM PERSON WHERE id IN (
SELECT D.id FROM WRITER W JOIN DIRECTOR D ON D.id = W.id GROUP BY D.id HAVING count(D.id) >= 2);",2018-08-30 13:56:37.351701+10,4,0,384,partially correct
6818,"SELECT country FROM RESTRICTION
WHERE title = 'Shakespeare in Love' and description = 'M';",2018-08-30 13:56:39.888271+10,6,1,224,correct
6819,"select a.id,count(*)
from (select w.id ,w.title
from writer w
union all
select d.id,d.title
from director d) as a
group by a.id
order by count(*) desc
limit 1;",2018-08-30 13:56:54.013182+10,14,0,298,partially correct
6820,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;",2018-08-30 13:57:32.519921+10,2,1,233,correct
6821,"select count(distinct writer.id)
from writer
left outer join person
on writer.id = person.id
where person.year_born = 1935;",2018-08-30 14:00:31.345994+10,1,1,358,correct
6822," 
 select person.id, first_name,last_name from person,
 ( 
 
select d.id,count(*) as c
from director as d
 where exists
 (
 select id 
 from writer as w 
 where d.id=w.id and d.title=w.title and d.production_year=w.production_year
 ) 
 group by d.id
 
 )as foo where person.id=foo.id and c>1;",2018-08-30 14:01:37.577635+10,4,1,91,correct
6823,"select count(*)
from person p
where exists (select id from writer w where w.id = p.id ) and year_born = 1935;",2018-08-30 14:02:22.386006+10,1,1,378,correct
6824,"SELECT COUNT(*)
FROM WRITER_AWARD wa,
	WRITER w,
	PERSON p
WHERE wa.id = w.id
	AND wa.production_year = w.production_year
	AND wa.title = w.title
	AND w.id = p.id
	AND lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen'
	AND wa.year_of_award >= 1991
	AND wa.year_of_award <= 1995
	AND lower(wa.result) = 'won';",2018-08-30 14:03:06.45639+10,9,1,177,correct
6825,;,2018-08-30 14:04:14.053381+10,15,0,263,noninterpretable
6826,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-30 14:04:41.498091+10,2,1,378,correct
6827,select country from restriction r where title = Shakespeare in Love and r.description = 'M'; ,2018-08-30 14:05:09.265072+10,6,0,183,noninterpretable
6828,select country from restriction  where lower(title) = 'shakespeare in love' and description = 'M'; ,2018-08-30 14:06:27.122612+10,6,1,183,correct
6829,"select role.id
from role NATURAL JOIN (select title,production_year from scene
where scene.production_year=1960 and lower(scene.title)=""psycho"" and scene.scene_no=1) as psycho;",2018-08-30 14:06:42.254898+10,10,0,307,partially correct
6830,"SELECT id, first_name, last_name FROM PERSON WHERE id IN (
SELECT D.id FROM WRITER W JOIN DIRECTOR D ON D.id = W.id AND D.title = W.title GROUP BY D.id HAVING count(*) >= 2);",2018-08-30 14:06:47.087369+10,4,1,384,correct
6831,"select count(*)
from person p
where not exists (select d.id from director d where d.id = p.id);",2018-08-30 14:06:52.179462+10,12,1,378,correct
6832,"SELECT COUNT(*)
FROM PERSON p, DIRECTOR d
WHERE p.id != d.id;",2018-08-30 14:06:53.347157+10,12,0,50,partially correct
6833,"select count(*)
from (select id,firt_name,last_name from writer where lower(first_name)='woody'AND lower(last_name)=allen)as xx,
writer_award wa
where wa.id = xx.id and lower(wa.result)='won',wa.production_year>=1991 and wa.production_year<=1995;",2018-08-30 14:07:26.62312+10,9,0,293,noninterpretable
6834,"select role.id
from role NATURAL JOIN (select title,production_year from scene
where scene.production_year=1960 and lower(scene.title)=""psycho"" and scene.scene_no=1) as psycho;",2018-08-30 14:07:33.579061+10,10,0,307,partially correct
6835,"with t2 as (select first_name,last_name,title,production_year,number
from person,role,(select id,count(*) as number
from role
group by id) t1
where person.id=t1.id and person.id=role.id) 
select first_name,last_name,title,production_year
from t2
where t2.number=(select max(number) from t2);",2018-08-30 14:08:09.117952+10,15,0,397,partially correct
6836,"with t2 as (select first_name,last_name,title,production_year,number,description
from person,role,(select id,count(*) as number
from role
group by id) t1
where person.id=t1.id and person.id=role.id) 
select first_name,last_name,title,production_year,description
from t2
where t2.number=(select max(number) from t2);",2018-08-30 14:09:11.147745+10,15,1,397,correct
6837,"select  production_year, count(title) as numbers
from movie
where production_year >= 1991
and production_year < 1994
group by production_year;
",2018-08-30 14:09:19.592965+10,2,1,358,correct
6838,"select distinct id
from movie m, director d, writer w
where m.title = d.title
and m.production_year = d.production_year
and m.title = w.title
and m.productino_year = w.production_year
and d.id = w.id
and id = (select count(id) from movie, director, writer
where m.title = d.title
and m.production_year = d.production_year
and m.title = w.title
and m.productino_year = w.production_year
and d.id = w.id
group by id
having max(count(id));

",2018-08-30 14:09:23.694654+10,14,0,250,noninterpretable
6839,"SELECT id
FROM person
WHERE year_born = 
	(SELECT MAX(year_born)
	FROM (SELECT *
		FROM person
		WHERE NOT EXISTS year_born = MAX(year_born)
		GROUP BY id)
	);",2018-08-30 14:09:28.953771+10,3,0,81,noninterpretable
6840,"SELECT id, first_name, last_name FROM PERSON
where year_born  = max_year_born;",2018-08-30 14:09:45.850233+10,7,0,224,noninterpretable
6841,"SELECT COUNT(*)
FROM PERSON p, DIRECTOR d
WHERE p.id != d.id;",2018-08-30 14:09:57.517497+10,12,0,50,partially correct
6842,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-30 14:10:32.12133+10,7,1,224,correct
6843,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id = d.id);",2018-08-30 14:10:34.68167+10,12,1,50,correct
6844,"select person.id, person.first_name, person.last_name from person, (select MAX(year_born) as m from person) 
as h where person.year_born = h.m;",2018-08-30 14:10:45.713575+10,7,1,183,correct
6845,SELECT;,2018-08-30 14:11:59.513036+10,8,0,224,noninterpretable
6848,"SELECT W.title, M.production_year FROM MOVIE M JOIN WRITER W ON M.title = W.title WHERE W.id = (
SELECT P.id FROM WRITER W JOIN PERSON P ON W.id = P.id WHERE P.first_name = ""Kevin"" AND P.last_name = ""Williamson"");",2018-08-30 14:12:31.494889+10,5,1,384,correct
6849,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 14:12:47.494554+10,4,1,396,correct
6850,"select count(*) as num
from(
select m.title,m.production_year
from movie m
where not exists(select *
	from movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
	where m.title =ma.title and m.production_year=ma.production_year and ma.result='won'
	and m.title=ca.title and m.production_year=ca.production_year and ca.result='won'
	and m.title=da.title and m.production_year=da.production_year and da.result='won'
	and m.title=wa.title and m.production_year=wa.production_year and wa.result='won'
	and m.title=aa.title and m.production_year=aa.production_year and aa.result='won') ) as a ;
",2018-08-30 14:13:25.705514+10,11,0,230,partially correct
6851,"
SELECT person.first_name, person.last_name,role.title, role.production_year, role.description 
FROM person, movie,role,(SELECT role.id
                   FROM person, role 
                   WHERE role.id = person.id
                   GROUP BY role.id
                   HAVING COUNT(*)>=0
                   ORDER BY COUNT(*) DESC
			  LIMIT 1) AS rolenum
WHERE role.id = rolenum.id AND role.id = person.id
      AND role.title = movie.title AND role.production_year = movie.production_year; ",2018-08-30 14:15:01.109645+10,15,1,165,correct
6852,"SELECT R.country FROM RESTRICTION R JOIN MOVIE M ON M.title = R.title WHERE M.title = ""Shakespeare in Love"" AND R.description = ""M"";
",2018-08-30 14:15:14.148929+10,6,1,384,correct
6853,"select id,first_name,last_name from Person
where id IN
(Select W.id from Director D,Writer W
where D.title=W.title AND D.id=W.id 
group by W.id
having count(*)>=2);",2018-08-30 14:15:38.765038+10,4,1,202,correct
6854,"select count(distinct writer.id)
from writer
inner join person
on writer.id = person.id
where person.year_born = 1935;",2018-08-30 14:16:37.797481+10,1,1,358,correct
6855,"SELECT id, first_name, last_name FROM PERSON ORDER BY year_born DESC LIMIT 1;",2018-08-30 14:17:12.422547+10,7,1,384,correct
6856,"select p.id, p.first_name, p.last_name
from person p
where exists (

select d.id, count(*)
from director d, writer w
where d.id = w.id and d.title = w.title and w.production_year = d.production_year and d.id = p.id
group by d.id
having count(*)>1

);",2018-08-30 14:17:38.413983+10,4,1,378,correct
6857,"SELECT title, production_year first_name, last_name FROM PERSON NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE_AWARD
WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film';",2018-08-30 14:18:19.426101+10,8,0,224,partially correct
6858,"SELECT p.id, p.first_name, p.last_name
FROM person p, (SELECT *,MAX(year_born)
                FROM person) AS h
WHERE p.id=h.id;",2018-08-30 14:19:41.861926+10,7,1,227,correct
6859,"select first_name, last_name from person, (select id from director, (select*from movie_award where lower(category) = 'best film' and lower(award_name) = 'bafta film award') as m
where director.title = m.title) as a where person.id = a.id;",2018-08-30 14:19:46.507307+10,8,0,183,partially correct
6860,"select title, production_year
from person natural join writer
where first_name = ""Kevin"" and last_name = ""Williamson"";",2018-08-30 14:19:49.935855+10,5,1,378,correct
6861,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-30 14:20:51.619553+10,10,1,205,correct
6862,"Select * from (Select count(*) as check_max ,table1.id from (select id,title,production_year from writer
UNION
select id,title,production_year from director) as table1
group by table1.id) as e where e.check_max in (
Select max(check_max) from
(
Select count(*) as check_max ,table1.id from (select id,title,production_year from writer
UNION
select id,title,production_year from director) as table1
group by table1.id
) as table2)
;",2018-08-30 14:20:58.929831+10,14,0,16,partially correct
6863,"SELECT P.first_name, P.last_name FROM PERSON P JOIN DIRECTOR D ON P.id = D.id WHERE D.title in (
SELECT M.title FROM MOVIE_AWARD MA JOIN MOVIE M ON MA.title = M.title WHERE MA.award_name = ""BAFTA Film Award"" AND MA.category = ""best film"");",2018-08-30 14:21:15.482528+10,8,0,384,partially correct
6864,"select id
from (select id, count(*) as num
	from (select d.id, title, production_year 
		from director d 
		union 
		select w.id, title, production_year 
		from writer w
		) 
	group by id) nj
where nj.num = (
	(select max(num)
		from (select id, count(*) as num
			from (select d.id, title, production_year 
				from director d 
				union 
				select w.id, title, production_year 
				from writer w
				)
			group by id)
		)
	)
;",2018-08-30 14:21:16.375433+10,14,1,109,correct
6865,"SELECT id, first_name, last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) dw 
GROUP BY id 
HAVING count(*) > 1
;",2018-08-30 14:21:28.567091+10,4,1,396,correct
6866,"select country
from restriction
where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-30 14:21:34.002195+10,6,1,378,correct
6867,"select * from movie inner join writer on movie.title = writer.title
where id in (select id from person
where first_name = 'Kevin' and last_name = 'Willamson');
",2018-08-30 14:21:36.261128+10,5,0,313,partially correct
6868,"
select title,production_year from Writer
where id=
(select id from Person
where first_name='Kevin' and last_name='Williamson');",2018-08-30 14:22:00.824416+10,5,1,202,correct
6869,"select count(*) as num
from(
select m.title,m.production_year
from movie m
where not exists(select *
	from director d,writer w,crew c, role r, 
	movie_award ma,crew_award ca,director_award da,writer_award wa,actor_award aa
	where m.title =ma.title and m.production_year=ma.production_year and ma.result='won'
	and c.title=ca.title and c.production_year=ca.production_year and c.id=ca.id and ca.result='won'
	and d.title=da.title and d.production_year=da.production_year and da.result='won'
	and w.title=wa.title and w.production_year=wa.production_year and wa.result='won' and w.id=wa.id
	and r.title=aa.title and r.production_year=aa.production_year and aa.result='won' and r.description=aa.description) ) as a ;
",2018-08-30 14:22:27.754194+10,11,0,230,partially correct
6870,"with r_max as (select id, title, production_year, description
from role
group by id
having count(*) = (select max(count)
	from (select count(*) as count
		from role
		group by id) r_count))
		
		
select first_name, last_name, title, production_year, description
from person p, r_max rm
where p.id = rm.id;",2018-08-30 14:22:35.562184+10,15,0,348,partially correct
6871,"Select id from (Select count(*) as check_max ,table1.id from (select id,title,production_year from writer
UNION
select id,title,production_year from director) as table1
group by table1.id) as e where e.check_max in (
Select max(check_max) from
(
Select count(*) as check_max ,table1.id from (select id,title,production_year from writer
UNION
select id,title,production_year from director) as table1
group by table1.id
) as table2)
;",2018-08-30 14:22:39.040132+10,14,1,16,correct
6872,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM movie_award ma, person p, director d
WHERE p.id=d.id
AND ma.title=d.title
AND ma.production_year=d.production_year
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film'
AND lower(ma.result)='won';",2018-08-30 14:23:42.909324+10,8,1,227,correct
6873,"SELECT first_name, last_name FROM PERSON WHERE id in (
SELECT D.id FROM MOVIE_AWARD MA JOIN DIRECTOR D ON MA.title = D.title WHERE MA.award_name = ""BAFTA Film Award"" AND MA.category = ""best film"");
",2018-08-30 14:23:46.388816+10,8,0,384,partially correct
6932,SELECT FROM;,2018-08-30 14:47:11.323034+10,1,0,162,noninterpretable
8819,"SELECT COUNT(*)
FROM  PERSON p
WHERE p.id IN (SELECT id FROM WRITER)
AND year_born=1935;",2018-08-31 00:19:13.377095+10,1,1,302,correct
6874,"select p.id 
from person p,
(select p.id from director d where d.id=p.id 
union
select p.id from writer w where p.id=w.id) as haswork
where haswork.id=max (count (haswork.id));

",2018-08-30 14:24:38.308948+10,14,0,351,noninterpretable
6875,"select p.id, p.first_name, p.last_name
from person p
where p.year_born = (
select max(year_born) from (
select year_born from person 
)
);",2018-08-30 14:24:39.757271+10,7,1,378,correct
6876,"SELECT first_name, last_name FROM PERSON WHERE id in (
SELECT D.id FROM MOVIE_AWARD MA JOIN DIRECTOR D ON MA.title = D.title WHERE MA.award_name = ""BAFTA Film Award"" AND MA.category = ""best film"" AND MA.result = ""won"");",2018-08-30 14:25:14.883394+10,8,0,384,partially correct
6877,"select country from Restriction
where title='Shakespeare in Love' and description='M';",2018-08-30 14:25:18.050723+10,6,1,202,correct
6878,"select count(p.id)
from person p
where not exists
(select per.id 
from person per
inner join Director
on per.id = Director.id);",2018-08-30 14:25:44.2004+10,12,0,358,partially correct
6879,"SELECT COUNT(*) AS number_of_award
FROM writer_award wa, person p
WHERE lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND lower(wa.result)='won'
AND wa.year_of_award>=1991
AND wa.year_of_award<=1995;",2018-08-30 14:26:37.19842+10,9,0,227,partially correct
6880,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (
	SELECT *
	FROM director d
	WHERE d.id = p.id
) ;",2018-08-30 14:26:38.378595+10,12,1,343,correct
6881,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id
AND p.year_born=1935);",2018-08-30 14:26:54.20301+10,1,1,421,correct
6882,"SELECT ma.title, ma.production_year p.first_name, p.last_name FORM 
	(SELECT title, production_year FROM MOVIE_AWARD
	WHERE award name = 'BAFTA Film Award"" under the category'
	AND category = 'Best Film'
	AND result = 'won') AS ma,
PERSON AS p,
DIRECOTOR AS d,
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-30 14:27:13.969087+10,8,0,224,noninterpretable
6883,"select count(distinct person.id)
from writer,person
where writer.id=person.id and person.year_born=1935;",2018-08-30 14:27:23.264631+10,1,1,397,correct
6884,"SELECT COUNT(*) AS number_of_award
FROM writer_award wa, person p
WHERE lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND lower(wa.result)='won'
AND wa.year_of_award>=1991
AND wa.year_of_award<=1995
AND wa.id=p.id;",2018-08-30 14:27:33.883215+10,9,1,227,correct
6885,"SELECT title, production_year, first_name, last_name FROM MOVIE_AWARD NATURAL JOIN DIRECTOR NATURAL JOIN PERSON WHERE award_name = ""BAFTA Film Award"" AND category = ""best film"" AND result = ""won"";",2018-08-30 14:27:36.446499+10,8,1,384,correct
6886,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FORM 
	(SELECT title, production_year FROM MOVIE_AWARD
	WHERE award name = 'BAFTA Film Award"" under the category'
	AND category = 'Best Film'
	AND result = 'won') AS ma,
PERSON AS p,
DIRECOTOR AS d,
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-30 14:27:38.088397+10,8,0,224,noninterpretable
6887,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM 
	(SELECT title, production_year FROM MOVIE_AWARD
	WHERE award name = 'BAFTA Film Award"" under the category'
	AND category = 'Best Film'
	AND result = 'won') AS ma,
PERSON AS p,
DIRECOTOR AS d,
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-30 14:28:16.369348+10,8,0,224,noninterpretable
6888,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 14:28:47.65172+10,15,1,263,correct
6889,"
select id,first_name,last_name from Person
where year_born in
(select MAX(year_born) from Person);",2018-08-30 14:28:51.587421+10,7,1,202,correct
6890,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(wa.RESULT)= 'won'
    AND lower(p.first_name)= 'woody'
    AND lower(p.last_name)= 'allen'
    AND wa.year_of_award >= 1991
    AND wa.year_of_award <= 1995;",2018-08-30 14:28:59.292199+10,9,1,293,correct
6891,"with p_max as (select id
from role
group by id
having count(*) = (select max(count)
	from (select count(*) as count
		from role
		group by id) r_count))
		

select first_name, last_name, title, production_year, description
from person p, role r, p_max pm
where p.id = pm.id and r.id = pm.id;",2018-08-30 14:29:09.298562+10,15,1,348,correct
6892,"select production_year,count(*) from movie where production_year=1993 or production_year=1992 or production_year=1991 group by production_year;",2018-08-30 14:29:32.494123+10,2,1,317,correct
6893,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM 
	(SELECT title, production_year FROM MOVIE_AWARD
	WHERE award_name = 'BAFTA Film Award"" under the category'
	AND category = 'Best Film'
	AND result = 'won') AS ma,
PERSON AS p,
DIRECTOR AS d
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-30 14:29:40.539294+10,8,0,224,partially correct
6894,"select a.title, a.production_year, person.first_name, person.last_name from person, (select director.id, m.title, m.production_year from director inner join (select title, production_year from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' 
and lower(result) = 'won') as m on director.title = m.title) as a where person.id = a.id;",2018-08-30 14:29:41.267787+10,8,1,183,correct
6895,"select count(*)
from person,writer
where person.id = writer.id
group by person.year_born
having person.year_born = 1935;",2018-08-30 14:29:46.721142+10,1,0,261,partially correct
6896,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-30 14:29:49.353744+10,12,1,358,correct
6897,"select count(*) as amount 
from person p,writer w 
where
w.id=p.id and p.year_born=1935;",2018-08-30 14:30:34.501762+10,1,0,293,partially correct
6898,"SELECT r.id
FROM role r, appearance a
WHERE lower(a.title)='psycho'
AND lower(a.production_year)='1960'
AND r.title=a.title
AND r.production_year=a.production_year
GROUP BY id
Having count(*)=1;",2018-08-30 14:31:48.496818+10,10,0,227,partially correct
6899,"select id, title, production_year
from director, writer
where ;",2018-08-30 14:31:54.342739+10,14,0,348,noninterpretable
6900,"select production_year,count(*)
from movie
group by production_year
having production_year=1993 or production_year=1992 or production_year=1991;",2018-08-30 14:32:10.81272+10,2,1,397,correct
6901,"SELECT ma.title, ma.production_year, p.first_name, p.last_name FROM 
	(SELECT title, production_year FROM MOVIE_AWARD
	WHERE lower(award_name) = 'bafta film award'
	AND lower(category) = 'best film'
	AND lower(result) = 'won') AS ma,
PERSON AS p,
DIRECTOR AS d
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND p.id = d.id;",2018-08-30 14:32:36.014346+10,8,1,224,correct
6933,"select writer.title from writer inner join movie on writer.title = movie.title
WHERE id = (select id from person where
     lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson');",2018-08-30 14:47:21.763996+10,5,0,313,partially correct
6934,"SELECT id
FROM 
((SELECT id
FROM (SELECT id FROM writer UNION SELECT id FROM director) as wdid
WHERE wdid.id NOT IN (SELECT id FROM director NATURAL JOIN writer))
UNION
SELECT id FROM director NATURAL JOIN writer)

GROUP BY id
HAVING max(*);",2018-08-30 14:47:45.243784+10,14,0,128,noninterpretable
6935,"select writer.title,writer.production_year from writer inner join movie on writer.title = movie.title
WHERE id = (select id from person where
     lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson');",2018-08-30 14:47:58.597917+10,5,1,313,correct
6902,"select count(*) as num from(
select m.title,m.production_year
from movie m
where not exists
(select ma.title,ma.production_year
	from movie_award ma
	where m.title =ma.title and m.production_year=ma.production_year and ma.result='won'
	union
	select ca.title,ca.production_year
	from crew_award ca,crew c
	where m.title=ca.title and m.production_year=ca.production_year and ca.result='won' and ca.id=c.id
	union 
	select da.title,da.production_year
	from director_award da
	where m.title=da.title and m.production_year=da.production_year and da.result='won'
	union
	select wa.title,wa.production_year
	from writer_award wa,writer w
	where m.title=wa.title and m.production_year=wa.production_year and wa.result='won' and w.id=wa.id
	union
	select aa.title,aa.production_year
	from actor_award aa,role r
	where m.title=aa.title and m.production_year=aa.production_year and aa.result='won' and r.description=aa.description) )as a;
",2018-08-30 14:32:41.523254+10,11,0,230,partially correct
6903,"SELECT m.title,m.production_year,p.first_name,p.last_name
FROM movie m natural join movie_award ma natural join writer w natural join person p
where ma.award_name = 'BAFTA Film Award';",2018-08-30 14:32:42.634903+10,8,0,106,partially correct
6904,"select production_year,count(*)
from movie
group by production_year
having production_year>1990 and production_year<1994;",2018-08-30 14:33:04.559157+10,2,1,397,correct
6905,"select id
from role, appearance
where 
role.production_year=appearance.production_year
and role.title=appearance.title
and role.description=appearance.description
and lower(appearance.title)='psycho'
and appearance.production_year=1960
group by id having count(*)=1;",2018-08-30 14:33:32.095561+10,10,1,197,correct
6906,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
",2018-08-30 14:34:00.445975+10,14,1,263,correct
6907,"select COUNT(*) from (select id from person where first_name = 'Woody' and last_name = 'Allen') as a inner join 
(select id from writer_award where lower(result) = 'won' and production_year >= 1991 and production_year <= 1995) as b on a.id = b.id;",2018-08-30 14:34:25.157439+10,9,0,183,partially correct
6908,"select count(*)
from person p, writer w 
where
w.id=p.id and p.year_born=1935;",2018-08-30 14:34:38.94424+10,1,0,293,partially correct
6909,"SELECT * FROM WRITER_AWARD NATURAL JOIN MOVIE NATURAL JOIN PERSON WHERE year_of_award BETWEEN 1991 AND 1995 AND result = ""won"" AND first_name = ""Woody"";",2018-08-30 14:35:25.183492+10,9,0,384,partially correct
6910,select * from appearance where title='Psycho' and production_year=1960;,2018-08-30 14:35:36.235604+10,10,0,117,partially correct
6911,"SELECT COUNT(*) FROM WRITER_AWARD NATURAL JOIN MOVIE NATURAL JOIN PERSON WHERE year_of_award BETWEEN 1991 AND 1995 AND result = ""won"" AND first_name = ""Woody"";",2018-08-30 14:35:48.168425+10,9,1,384,correct
6912,"select COUNT(*) from (select id from person where first_name = 'Woody' and last_name = 'Allen') as a inner join 
(select id from writer_award where lower(result) = 'won' and year_of_award >= 1991 and year_of_award <= 1995) as b on a.id = b.id;",2018-08-30 14:35:49.603089+10,9,1,183,correct
6913,"SELECT id
FROM (SELECT id, title, production_year
	FROM director
	UNION
	SELECT id, title, production_year
	FROM writer)
GROUP BY id
HAVING COUNT(*) = (

SELECT MAX(cnt) FROM (
	SELECT COUNT(*) AS cnt 
	FROM (
		SELECT id, title, production_year
		FROM director
		UNION
		SELECT id, title, production_year
		FROM writer)
	GROUP BY id))
;",2018-08-30 14:36:07.297361+10,14,1,222,correct
6914,"select count(*)
from person 
where not exists (select id from director where person.id=director.id);",2018-08-30 14:36:55.966798+10,12,1,397,correct
6915,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born)
	FROM person
	WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-30 14:37:19.905497+10,3,1,81,correct
6916,"select * from Movie_Award
where award_name='BAFTA Film Award'and  category='Best Film';",2018-08-30 14:37:21.639051+10,8,0,202,partially correct
6917,"SELECT r.id
FROM role r, appearance a, scene s
WHERE lower(a.title)='psycho'
AND a.production_year='1960'
AND r.title=a.title
AND r.production_year=a.production_year
AND s.title=a.title
AND s.production_year=a.production_year
AND s.scene_no=a.scene_no
AND s.description=a.description
AND s.description=r.description
GROUP BY r.id
Having count(*)=1;",2018-08-30 14:37:43.644272+10,10,0,227,partially correct
6918,SELECT COUNT(id);,2018-08-30 14:39:49.645715+10,9,0,224,noninterpretable
6919,"SELECT count(*)
FROM person, director
WHERE person.id=director.id AND (SELECT count(*) FROM director, movie
                                 WHERE director.title=movie.title)=0;
 ",2018-08-30 14:41:05.620791+10,12,0,233,partially correct
6920,"WITH h AS(
SELECT id, title, production_year
FROM movie_award NATURAL JOIN writer 
WHERE award_name='BAFTA Film Award')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;",2018-08-30 14:42:28.140215+10,8,0,106,partially correct
6921,"SELECT r.id
FROM role r, appearance a, scene s
WHERE lower(a.title)='psycho'
AND a.production_year='1960'
AND r.title=a.title
AND r.production_year=a.production_year
AND s.title=a.title
AND s.production_year=a.production_year
AND s.scene_no=a.scene_no
AND s.description=a.description
AND s.description=r.description
GROUP BY r.id
Having count(*)=1;",2018-08-30 14:42:28.384955+10,10,0,227,partially correct
6922,"SELECT COUNT(*) as number_of_aeard FROM
	WRITER_AWARD wa,
	WRITER w,
	PERSON p
WHERE
	wa.title = w.title
	AND wa.production_year = w.production_year
	AND wa.id = w.id
	AND wa.id = p.id
	AND lower(RESULT)= 'won'
     AND lower(first_name)= 'woody'
     AND lower(last_name)= 'allen'
     AND year_of_award >= 1991
     AND year_of_award <= 1995;",2018-08-30 14:42:53.973373+10,9,1,224,correct
6923,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND a.title='Psycho'
    AND a.production_year = 1960 group by r.id having count(*)=1;",2018-08-30 14:42:54.81435+10,10,1,317,correct
6924,"select title, production_year, first_name, last_name
from movie_award natural join director natural join person
where lower(award_name) = ""bafta film award"" and lower(category) = ""best film"" and result = ""won"";",2018-08-30 14:42:58.713973+10,8,1,378,correct
6925,"select person.id,first_name,last_name
from person,(select * from writer natural join director) t
where person.id=t.id 
group by person.id
having count(*)>1;",2018-08-30 14:43:43.229751+10,4,1,397,correct
6926,"WITH h AS(
SELECT id, title, production_year
FROM movie_award NATURAL JOIN writer 
WHERE award_name='BAFTA Film Award' AND category='Best Film')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;",2018-08-30 14:43:58.638211+10,8,0,106,partially correct
6927,"

SELECT DISTINCT P.id FROM 

SCENE S,
PERSON P,
MOVIE M

WHERE S.scene_no = 1
AND M.title = ""Psycho""
AND M.production_year = ""1960""
;",2018-08-30 14:44:03.404872+10,10,0,384,partially correct
6928,"SELECT wp.title, wp.production_year
FROM (WRITER w NATURAL JOIN PERSON p) wp
WHERE wp.first_name = 'Kevin';

",2018-08-30 14:45:14.750683+10,5,0,191,partially correct
6929,"select title , production_year from movie where
writer.title=movie.title ( 
select id from writer where
persion.id=writer.id and person.last_name=Williamson and person.first_name=Kevin
);",2018-08-30 14:45:49.981595+10,5,0,48,noninterpretable
6930,"select crew.id, crew.production_year from crew, scene where scene.title = 'Psycho' and crew.production_year = 1960;",2018-08-30 14:46:33.792712+10,10,0,183,partially correct
6931,"select count(*)
from person natural join writer_award
where first_name = ""Woody"" and last_name = ""Allen"" and result = ""won"" and year_of_award > 1990 and year_of_award < 1996;",2018-08-30 14:46:49.915884+10,9,1,378,correct
6936,"SELECT first_name, last_name, title, production_year, description FROM role NATURAL JOIN person
GROUP BY id
HAVING COUNT(*) = (
SELECT MAX(cnt) FROM (
SELECT COUNT(*) AS cnt
FROM role
GROUP BY id))
;",2018-08-30 14:48:18.998243+10,15,0,222,partially correct
6937,"select
 w.title, w.production_year
 from
   writer w,
   person p
  where 
  w.id=p.id
  and p.first_name='Kevin'
  and p.last_name='Williamson';",2018-08-30 14:48:19.74409+10,5,1,48,correct
6938,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 14:48:39.742583+10,1,1,162,correct
6939,"SELECT wp.title, wp.production_year
FROM (WRITER w NATURAL JOIN PERSON p) wp
WHERE lower(wp.first_name) = 'kevin' AND lower(wp.last_name) = 'williamson';
",2018-08-30 14:48:40.6324+10,5,1,191,correct
6940,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 14:49:32.376615+10,10,1,384,correct
6941,"
with t as (select id 
from person p
where lower(p.first_name)='kevin' and lower(p.last_name)='williamson')

select title,production_year
from t,writer
where t.id=writer.id;",2018-08-30 14:50:35.953518+10,5,1,397,correct
6942,"select p.id, p.first_name, p.last_name, count(p.id) > 1
from person p
inner join Director d
on p.id = d.id
inner join Writer w
on p.id = w.id
where d.id = w.id
group by p.id;",2018-08-30 14:50:42.702619+10,4,0,358,partially correct
6943,"WITH h AS(
SELECT id, title, production_year
FROM movie_award NATURAL JOIN writer 
WHERE lower(award_name)='BAFTA Film Award' AND lower(category)='Best Film' AND lower(result)='won')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;
",2018-08-30 14:51:13.851498+10,8,0,106,partially correct
6944,"select id
from appearance natural join role
where title = ""Psycho"" and production_year = 1960 
group by id
having count(*) = 1;",2018-08-30 14:51:16.10931+10,10,1,378,correct
6945,"SELECT id FROM PERSON p, ROLE r, APPEARANCE ap
WHERE p.id = r.id
	AND r.title = ap.title
	AND ap.scene_no = 1
	AND ap.porduction_year = 1960;",2018-08-30 14:52:04.938142+10,10,0,224,noninterpretable
6946,"select count(*)
from movie m
where not exists(
	select title, production_year
	from movie_award ma
	where m.title = ma.title and m.production_year = ma.production_year and lower(ma.result) = 'won'
	
	
	union
	
	select title, production_year
	from crew_award ca
	where m.title = ca.title and m.production_year = ca.production_year and lower(ca.result) = 'won'
	
	union
	
	select title, production_year
	from director_award da
	where m.title = da.title and m.production_year = da.production_year and lower(da.result) = 'won'
	
	union
	
	select title, production_year
	from writer_award wa
	where m.title = wa.title and m.production_year = wa.production_year and lower(wa.result) = 'won'
	
	union 
	
	select title, production_year
	from actor_award aa
	where m.title = aa.title and m.production_year = aa.production_year and lower(aa.result) = 'won'
	






);",2018-08-30 14:52:28.770556+10,11,1,387,correct
6947,"SELECT r.id FROM PERSON p, ROLE r, APPEARANCE ap
WHERE p.id = r.id
	AND r.title = ap.title
	AND ap.scene_no = 1
	AND ap.production_year = 1960;",2018-08-30 14:53:12.219468+10,10,0,224,partially correct
6948,"select country from restriction
where title = 'Shakespeare in Love' and description ='M';",2018-08-30 14:53:47.733828+10,6,1,313,correct
6949,"select country
from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-30 14:54:08.679098+10,6,1,397,correct
6950,"select c.id, da.award_name, da.year_of_award, da.category
from movie m, crew c, director_award da
where m.title = c.title
and m.production_year = c.production_year
and m.title = da.title
and m.production_year = da.production_year
and da.result <> 'Won'
group by c.id, da.award_name, da.year_of_award, da.category
having count(c.id) >= 1;",2018-08-30 14:54:32.37637+10,13,0,123,partially correct
6951,"SELECT r.country
FROM RESTRICTION r
WHERE r.title = 'Shakespeare in Love' AND r.description = 'M';",2018-08-30 14:54:41.949047+10,6,1,191,correct
6952,"WITH ids AS (SELECT id FROM writer NATURAL JOIN person
WHERE year_born = 1935),

 writers AS (SELECT DISTINCT id FROM ids)

SELECT COUNT(*) FROM writers;",2018-08-30 14:55:02.224353+10,1,1,25,correct
6953,select count(distinct p.first_name) from writer w inner join person p on w.id = p.id where p.year_born = 1935;,2018-08-30 14:55:12.148767+10,1,1,66,correct
6954,"select p.id,p.first_name,p.last_name from person p,(select d.id,count(*) as num from director d,writer w where d.id=w.id and d.title=w.title and d.production_year=w.production_year group by d.id)as a where p.id=a.id and a.num>=2;",2018-08-30 14:55:16.087156+10,4,1,117,correct
6955,"select id,first_name,last_name
from person
where year_born=(select max(year_born) from person);",2018-08-30 14:56:16.532901+10,7,1,397,correct
6956,"select country 
from restriction r, scene s
where r.description='M' 
and r.title='Shakespeare in Love' 
group by country;


",2018-08-30 14:56:17.317008+10,6,1,48,correct
6957,"select production_year, count(*) from movie where production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year;",2018-08-30 14:58:18.898737+10,2,1,66,correct
6958,"select count(*)
from person
group by year_born
order by year_born desc



;",2018-08-30 14:59:37.985013+10,3,0,387,partially correct
6959,select count(*) from WRITER w inner join PERSON p on w.id = p.id and p.year_born = 1935; ,2018-08-30 14:59:40.478565+10,1,0,371,partially correct
6960,"WITH movies AS (SELECT title,production_year FROM movie
WHERE production_year = 1993

UNION

SELECT title, production_year FROM movie
WHERE production_year= 1992

UNION

SELECT title, production_year FROM movie
WHERE production_year = 1991)

SELECT production_year, COUNT(production_year) FROM movies
GROUP BY production_year;",2018-08-30 14:59:43.74561+10,2,1,25,correct
6961,"WITH not_directors AS (SELECT DISTINCT id FROM person
WHERE id NOT IN (SELECT id FROM director))

SELECT COUNT(*) FROM not_directors;",2018-08-30 14:59:55.917805+10,12,1,25,correct
6962,"SELECT production_year, count(*)
FROM movie;",2018-08-30 15:00:07.795357+10,2,0,421,partially correct
6963,"select id, first_name,last_name from person
where year_born = (select min(year_born) from person);",2018-08-30 15:00:11.938818+10,7,0,313,partially correct
6964,select distinct count(*) from WRITER w inner join PERSON p on w.id = p.id and p.year_born = 1935; ,2018-08-30 15:00:56.966196+10,1,0,371,partially correct
6965,"WITH d_w AS (SELECT DISTINCT id,first_name, last_name,title, production_year FROM person NATURAL JOIN director NATURAL JOIN writer),

at_least AS (SELECT id, COUNT(id) tot FROM d_w
GROUP BY id)

SELECT DISTINCT id,first_name,last_name FROM d_w
WHERE id IN (SELECT id FROM at_least
		WHERE tot >= 2);",2018-08-30 15:01:02.723575+10,4,1,25,correct
6966,select count(p.id) from person p where not exists (select d.id from director d where d.id = p.id);,2018-08-30 15:01:28.57174+10,12,1,66,correct
6967,"select id, first_name,last_name from person
where year_born = (select max(year_born) from person);",2018-08-30 15:01:53.448403+10,7,1,313,correct
6968,"select id,first_name,last_name 
from person p1
where p1.id=p2.id and max(year_born) from p2
;",2018-08-30 15:02:04.61579+10,7,0,48,noninterpretable
6969,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;",2018-08-30 15:02:28.898651+10,2,1,421,correct
6970,"
SELECT title,production_year FROM writer NATURAL JOIN person
WHERE lower(first_name) = 'kevin'
AND lower(last_name) = 'williamson';",2018-08-30 15:02:41.456264+10,5,1,25,correct
6971,"select id,first_name,last_name 
from person p1
where 
p1.year_born=(
select 
max(year_born)
from person)
;",2018-08-30 15:03:12.843917+10,7,1,48,correct
6972,"
SELECT country FROM restriction
WHERE lower(title) = 'shakespeare in love'
AND lower(description) = 'm';",2018-08-30 15:03:28.402573+10,6,1,25,correct
7036,"select m.title, d.production_year, first_name, last_name   from movie_award m natural join director d natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) ='won';",2018-08-30 15:24:40.035743+10,8,1,313,correct
6973,"SELECT r.id FROM SCENE s, ROLE r, APPEARANCE ap
WHERE
	s.title = ap.title
	AND s.production_year = ap.production_year
	AND s.scene_no = ap.scene_no
	AND s.title = r.title
	AND s.production_year = r.production_year
	AND ap.description = r.description
	AND lower(ap.title) = 'psycho'
	AND ap.production_year = 1960
GROUP BY
	r.id
HAVING
	count(*) = 1;",2018-08-30 15:03:32.61824+10,10,1,224,correct
6974,select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935);,2018-08-30 15:03:36.87079+10,1,1,371,correct
6975,"SELECT first_name, last_name, title, production_year, description FROM role NATURAL JOIN person
WHERE id = (
SELECT id FROM role NATURAL JOIN person
GROUP BY id
HAVING COUNT(*) = (
SELECT MAX(cnt) FROM (
SELECT COUNT(*) AS cnt
FROM role
GROUP BY id)))
;",2018-08-30 15:04:10.892422+10,15,1,222,correct
6976,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);
",2018-08-30 15:04:27.543311+10,7,1,25,correct
6977,"select m.title,m.production_year,first_name,last_name
from movie_award m,person p,director d
where lower(category)='best film'
and lower(award_name)='bafta film award'
and lower(result)='won'
and m.title=d.title
and m.production_year=d.production_year
and p.id=d.id;",2018-08-30 15:04:54.585214+10,8,1,397,correct
6978,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE p.year_born = '1982';
",2018-08-30 15:05:58.262115+10,7,0,191,partially correct
6979,"select ma.title, ma.production_year,p.first_name, p.last_name

from select title,production_year
	from movie_award 
	where lower(award_name) = 'fafta film award' and lower(category) = 'best film' and lower(result) ='won')ma,
	direct d,people p

where exists (d.title = ma.title and d.production_year = ma.production_year and p.id = d.id );",2018-08-30 15:06:07.351947+10,8,0,389,noninterpretable
6980,"SELECT first_name, last_name, title, production_year, description 
FROM role NATURAL JOIN person
WHERE id = 
	(
	SELECT id 
	FROM role NATURAL JOIN person
	GROUP BY id
	HAVING COUNT(*) = 
		(
		SELECT MAX(cnt) 
		FROM 
			(
			SELECT COUNT(*) AS cnt
			FROM role
			GROUP BY id
			)
		)
	)
;",2018-08-30 15:06:43.372824+10,15,1,222,correct
6981,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS (SELECT title FROM movie_award NATURAL JOIN crew_award NATURAL JOIN 
director_award NATURAL JOIN writer_award NATURAL JOIN actor_award WHERE result=""won"");",2018-08-30 15:07:03.033933+10,11,0,382,partially correct
6982,"SELECT COUNT(*)
FROM person, director
WHERE person.id NOT IN director.id
;",2018-08-30 15:07:39.396337+10,12,0,421,noninterpretable
6983,"SELECT title, production_year 
FROM (writer natural join person) as pn
WHERE first_name = Kevin AND last_name = Williamson
GROUP BY title;",2018-08-30 15:07:49.087122+10,5,0,54,noninterpretable
6984,"SELECT id 
FROM crew c 
WHERE (SELECT m.title, m.production_year FROM movie m AND lower(title) = 'psycho' AND m.production_year = 1960) 
NATURAL JOIN crew c WHERE c.title = m.title AND c.production_year = m.production_year; ",2018-08-30 15:07:50.468437+10,10,0,410,noninterpretable
6985,"SELECT COUNT(*)
FROM PERSON
WHERE (Person.year_born=1935);",2018-08-30 15:08:58.021553+10,1,0,424,partially correct
6986,"select p.id, p.first_name, p.last_name
from person p
natural join Director d
natural join Writer w
group by p.id
having count(p.id) > 1;",2018-08-30 15:09:04.866511+10,4,1,358,correct
6987,"select title, production_year
from movie
where not exists
(select title, production_year
from movie_award
union
select title, production_year
from crew_award
union
select title, production_year
from director_award
union
select title, production_year
from writer_award);",2018-08-30 15:10:17.769833+10,11,0,197,partially correct
6988,"SELECT title, production_year 
FROM (writer natural join person) as pn
WHERE first_name = 'Kevin' AND last_name = 'Williamson'
GROUP BY title;",2018-08-30 15:10:23.934966+10,5,1,54,correct
6989,"SELECT id,award_name,year_of_award,category FROM director_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(result) != 'won';
",2018-08-30 15:10:32.943409+10,13,1,25,correct
6990,"SELECT COUNT(id), year_born FROM Person WHERE year_born = 1935;",2018-08-30 15:10:55.7419+10,1,0,425,partially correct
6991,"WITH d_w AS (SELECT id,title,production_year FROM writer NATURAL JOIN person

UNION 

SELECT id,title,production_year FROM director NATURAL JOIN person),

ids AS (SELECT id, COUNT(id) tot FROM d_w
GROUP BY id)

SELECT id FROM ids
WHERE tot = (SELECT MAX(tot) FROM ids);",2018-08-30 15:11:07.554584+10,14,1,25,correct
6992,"SELECT title, production_year, first_name, last_name
FROM MOVIE m NATURAL JOIN DIRECTOR d NATURAL JOIN MOVIE_AWARD a NATURAL JOIN PERSON p
WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film';",2018-08-30 15:11:17.715789+10,8,0,191,partially correct
6993,"WITH role_count AS (SELECT id,COUNT(description) tot FROM person NATURAL JOIN role
GROUP BY id)

SELECT first_name,last_name,title,production_year,description FROM person NATURAL JOIN role
WHERE id IN (SELECT id FROM role_count 
		WHERE tot = (SELECT MAX(tot) FROM role_count));",2018-08-30 15:11:41.036358+10,15,1,25,correct
6994,"select count(*)
from ( director inner join writer) as o
group by o.id;",2018-08-30 15:12:04.919848+10,14,0,338,partially correct
6995,"select count(*)
from ( director inner join writer) as o
group by o.id;",2018-08-30 15:12:18.304744+10,14,0,338,partially correct
6996,"select production_year, count(*) from movie where production_year;",2018-08-30 15:12:18.838433+10,2,0,371,partially correct
6997,"
select * from movie_award;",2018-08-30 15:12:23.071163+10,8,0,48,partially correct
6998,"select count(*)
from writer_award wa, writer w,person p
where w.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and w.title=wa.title
and w.production_year=wa.production_year
and wa.year_of_award>=1991
and wa.year_of_award<=1995;",2018-08-30 15:12:52.685939+10,9,0,397,partially correct
6999," select title, production_year,last_name,first_name
 from movie_award,director
 where award_name='BAFTA Film Award' and category='best film';",2018-08-30 15:13:10.743569+10,8,0,377,noninterpretable
7000,"select ma.title, ma.production_year,p.first_name, p.last_name

from(

	select title,production_year
	from movie_award 
	where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) ='won') as ma,
	director as d,
	person as p

where  d.title = ma.title and d.production_year = ma.production_year and p.id = d.id ;",2018-08-30 15:13:20.104281+10,8,1,389,correct
7001,"select ma.title, ma.production_year,p.first_name, p.last_name

from(

	select title,production_year
	from movie_award 
	where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) ='won') as ma,
	director as d,
	person as p

where  d.title = ma.title and d.production_year = ma.production_year and p.id = d.id ;",2018-08-30 15:13:40.762274+10,8,1,389,correct
7002,"select *
from writer_award wa, writer w,person p
where w.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and w.title=wa.title
and w.production_year=wa.production_year
and wa.year_of_award>=1991
and wa.year_of_award<=1995
and lower(wa.result)='won';",2018-08-30 15:14:17.430812+10,9,0,397,partially correct
7003,"select count(*)
from person p
where exists(select *
             from writer w
                where w.id=p.id
                AND p.year_born=1935);
",2018-08-30 15:14:17.823362+10,1,1,79,correct
7004,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w where w.id = p.id and p.year_born = 1935);",2018-08-30 15:14:39.656165+10,1,1,425,correct
7005,"select count(*)
from writer_award wa, writer w,person p
where w.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and w.title=wa.title
and w.production_year=wa.production_year
and wa.year_of_award>=1991
and wa.year_of_award<=1995
and lower(wa.result)='won';",2018-08-30 15:14:41.082232+10,9,1,397,correct
7006,"select m.production_year, count(*)
from movie m
where m.production_year>1990
AND m.production_year<1994

group by m.production_year;
",2018-08-30 15:14:45.594773+10,2,1,79,correct
7099,"select distinct country
from Restriction res
where res.title = 'Shakespeare in Love'
and res.description = 'M';",2018-08-30 15:43:02.036892+10,6,1,358,correct
9673,"SELECT count(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-31 10:20:02.611323+10,12,1,242,correct
7007,"select count(*)
from
movie m
where NOT exists
(select m.title
from
movie_award ma,director_award da,crew_award ca,writer_award wa,actor_award aa
where m.title=ma.title or m.title=da.title or m.title=ca.title or m.title=wa.title or m.title=aa.title)
;",2018-08-30 15:14:54.049853+10,11,0,307,partially correct
7008,"select m.production_year, count(*)
from movie m
where m.production_year>1990
AND m.production_year<1994

group by m.production_year;

",2018-08-30 15:14:55.820101+10,2,1,79,correct
7009,"SELECT country
FROM restriction 
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-30 15:15:26.515187+10,6,1,54,correct
7010,"select count(*)
from movie
where not exists
(select title, production_year
from movie_award
where lower(result)='won'
union
select title, production_year
from crew_award
where lower(result)='won'
union
select title, production_year
from director_award
where lower(result)='won'
union
select title, production_year
from writer_award
where lower(result)='won');",2018-08-30 15:15:31.200272+10,11,0,197,partially correct
7011,"select p.id, p.first_name, p.last_name from person p inner join 
(
select w.id
from writer w inner join movie m inner join director d 
on w.title = m.title and w.production_year = m.production_year and d.title = m.title and d.production_year = m.production_year
where w.id = d.id 
group by w.id
having count(*)>1)as x1 on p.id = x1.id; ",2018-08-30 15:15:31.75844+10,4,1,66,correct
7012,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 15:15:32.4323+10,14,1,366,correct
7013,"select count(*)
from person p
where not exists (select *
                    from  director d
                   where p.id=d.id); 
",2018-08-30 15:16:05.78529+10,12,1,79,correct
7014,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id 
group by p.id
having count(*)>1;
",2018-08-30 15:16:30.452997+10,12,0,79,partially correct
7015,"select p.id, p.first_name, p.last_name
from person p,director d, writer w
where d.id=w.id
AND d.title=w.title
AND d.production_year=w.production_year
AND p.id=d.id 
group by p.id
having count(*)>1;
",2018-08-30 15:17:19.528776+10,4,1,79,correct
7016,"select r.country
from restriction r
where lower(r.title)= 'shakespeare in love'
AND lower(r.description)='m';
",2018-08-30 15:17:55.853094+10,6,1,79,correct
7017,"select  p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born)
                  from person p);
",2018-08-30 15:18:19.086568+10,7,1,79,correct
7018,"select ma.title, ma.production_year, p.first_name, p.last_name
from  Movie_Award ma, director d,person p
where p.id=d.id
AND ma.title=d.title
AND d.production_year=ma.production_year
AND lower(ma.result)='won'
AND lower(ma.category)= 'best film'
And lower(ma.award_name)='bafta film award';
",2018-08-30 15:18:49.824632+10,8,1,79,correct
7019,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) x1 
GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
",2018-08-30 15:19:12.818148+10,14,1,351,correct
7020,"select count(*) 
from writer_award wa
where wa.id=(select p.id
                 from person p
                 where lower(p.first_name)='woody'
                 AND lower(p.last_name)='allen')
    AND wa.year_of_award>1990
    AND wa.year_of_award<1996
AND lower(wa.result)='won';
",2018-08-30 15:19:21.98507+10,9,1,79,correct
7021,"select production_year, count(*) from movie where production_year > 1990 and production_year < 1994 order by production_year;",2018-08-30 15:19:25.569936+10,2,0,371,partially correct
7022,"select count(*)
from writer_award wa, 
(select id
from person
where lower(person.first_name)='woody' and lower(person.last_name)='allen'
)as p
where p.id = wa.id and wa.year_of_award>=1991 and wa.year_of_award<=1995;",2018-08-30 15:20:11.042876+10,9,0,389,partially correct
7023,"select production_year, count(*) from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 15:20:17.223273+10,2,1,371,correct
7024,"select M.title,M.production_year,first_name,last_name from Person P inner join 

(	select MA.title,MA.production_year,id from Movie_Award MA inner join Director D on
	MA.title=D.title and MA.production_year=D.production_year
	where award_name='BAFTA Film Award' and lower(category)='best film' and lower(result)='won'
)AS M
	on M.id=P.id

;",2018-08-30 15:20:24.569829+10,8,1,202,correct
7025,"select m.title, d.production_year, first_name, last_name   from movie_award m natural join director d natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film';",2018-08-30 15:20:40.834124+10,8,0,313,partially correct
7026,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where lower(da.result)='nominated'
AND d.title=da.title
AND d.production_year=da.production_year

AND d.title not in (select da.title
                   from director_award da
                    where d.title=da.title
                     AND d.production_year=da.production_year
                     AND lower(da.result)='won');
",2018-08-30 15:21:07.378448+10,13,1,79,correct
7027,"select count(*)
from (person natural join Writer_award) as nw
where nw.name ='Woody Allen' and year_of_award>=1991 and year_of_award<=1995;",2018-08-30 15:21:20.869403+10,9,0,377,noninterpretable
7028,"select 
	ma.title,
	ma.production_year,
	p.first_name,
	p.last_name
from (
	select 
		title,
		production_year
	from
		movie_award
	where 
		award_name='BAFTA Film Award'
		and lower(category)='best film'
		and RESULT='won')  as ma,
director as d,
person as p
 where ma.title=d.title
 		and ma.production_year=d.production_year
		 and d.id=p.id;

",2018-08-30 15:21:24.598792+10,8,1,48,correct
7029,"SELECT COUNT(*)
FROM WRITER_AWARD wa 
WHERE year_of_award = '1991-1995' AND result = 'WON';",2018-08-30 15:21:43.377148+10,9,0,191,partially correct
7030,"select production_year,count(*)
from movie
group by production_year
having production_year = 1993 or production_year = 1992 or production_year = 1991  ;
",2018-08-30 15:22:01.411228+10,2,1,261,correct
7031,"SELECT id, first_name, last_name
FROM person
WHERE year_born = MAX(year_born);",2018-08-30 15:23:12.6679+10,7,0,54,noninterpretable
7032,"


select p2.id
from PERSON p2
where p2.year_born=(select max(year_born)
from(select p1.id,p1.year_born
from PERSON p1
where p1.year_born not in(select max(year_born)
from PERSON)) as a) ;",2018-08-30 15:23:22.857504+10,3,1,64,correct
7033,"select title, production_year 
from person p, writer w
where p.id = w. id and p.first_name = 'Kevin' and p.last_name = 'Williamson'
;",2018-08-30 15:23:47.620667+10,5,1,396,correct
7034,"select count(*) as number_of_award
from writer_award wa, 
(select id
from person
where lower(person.first_name)='woody' and lower(person.last_name)='allen'
)as p
where p.id = wa.id and wa.year_of_award>=1991 and wa.year_of_award<=1995 and lower(wa.result)='won';",2018-08-30 15:24:05.748837+10,9,1,389,correct
7035,"select *   from movie_award m natural join director d natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) ='won';",2018-08-30 15:24:13.108902+10,8,0,313,partially correct
7173,"select ww.title, ww.production_year from (writer natural join person) as ww where ww.first_name = 'Kevin' and last_name = 'Williamson';",2018-08-30 16:01:07.048663+10,5,1,126,correct
7037,"select m.title, m.production_year
from movie m inner join writer w inner join person p on m.title = w.title and m.production_year = w.production_year and p.id = w.id 
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-30 15:24:47.667046+10,5,1,66,correct
7038,"SELECT dm.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director dm
WHERE dm.title=da.title AND dm.production_year=da.production_year 
AND dm.id NOT IN (SELECT dm.id FROM director_award da,director dm WHERE dm.title=da.title AND dm.production_year=da.production_year AND lower(result)=""won"");",2018-08-30 15:24:54.881018+10,13,1,216,correct
7039,"select production_year, count(title) from movie where production_year in (1993,1992,1991) group by production_year ;",2018-08-30 15:25:06.365206+10,2,1,172,correct
7040,"select writer.title, writer.production_year
from movie
natural join writer
natural join person
where person.first_name = 'Kevin'
and person.last_name = 'Williamson';",2018-08-30 15:25:17.377295+10,5,1,358,correct
7041,"select p.id
from person p
where p.year_born = (select max(year_born)
	from person
	where year_born< (select max(year_born)
		from person
	
	)
	



);",2018-08-30 15:25:18.482408+10,3,1,387,correct
7042,"WITH h AS(
SELECT id, title, production_year
FROM movie_award NATURAL JOIN director 
WHERE lower(award_name)='BAFTA Film Award' AND lower(category)='Best Film' AND lower(result)='won')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;
",2018-08-30 15:25:46.487188+10,8,0,106,partially correct
7043,"SELECT id, first_name, last_name
FROM person p
WHERE year_born = (SELECT MAX(year_born)
		FROM person);",2018-08-30 15:25:55.503058+10,7,1,54,correct
7044,"SELECT P.first_name,P.last_name
FROM PERSON P
WHERE R.id=P.id AND R.id IN(
SELECT R.id
FROM ROLE R, SCENE S, MOVIE M
WHERE R.title= M.title AND R.production_year=M.production_year AND S.title=M.title AND S.prodution_year=M.production_year
AND M.title='Psycho' AND M.production_year=1960 
GROUP BY R.id HAVING S.scene_no=1);
",2018-08-30 15:26:09.934999+10,10,0,249,noninterpretable
7045,select * from movie;,2018-08-30 15:26:27.919551+10,13,0,334,partially correct
7046,SELECT count(*) FROM person p WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);,2018-08-30 15:26:35.475987+10,1,1,425,correct
7047,"select count(*)
from movie as m
where not exists
(select a.title, a.production_year
from movie_award as a
where lower(result)='won'
a.title=m.title and a.production_year=m.production_year
union
select c.title, c.production_year
from crew_award as c
where lower(result)='won'
c.title=m.title and  c.production_year=m.production_year
union
select title, production_year
from director_award as d
where lower(result)='won'
d.title=m.title and  d.production_year=m.production_year
union
select title, production_year
from writer_award as w
where lower(result)='won'
w.title=m.title and  w.production_year=m.production_year);",2018-08-30 15:26:48.974712+10,11,0,197,noninterpretable
7048,select count(*) from person p left join director d on p.id = d.id where d.title = null;,2018-08-30 15:26:59.466269+10,12,0,371,partially correct
7049,"SELECT a1.first_name, a1.last_name, a1.title, a1.production_year, a1.description
FROM (SELECT p.id, p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) AS nofrole 
      FROM (person p NATURAL JOIN ROLE r) AS a
	GROUP BY a.id) AS a1
WHERE a1.nofrole = (SELECT MAX(a2.nofrole)
                   FROM (SELECT p.id, p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) AS nofrole 
                         FROM (person p NATURAL JOIN ROLE r) AS a2
                   GROUP BY a2.id);
",2018-08-30 15:27:12.655395+10,15,0,366,noninterpretable
7050,"

select p1.id
from PERSON p1
WHERE year_born =(select max(year_born)
from PERSON p2
where p2.year_born<(select max(year_born)
from PERSON));",2018-08-30 15:27:24.431961+10,3,1,64,correct
7051,"select 
	count(a.award_name)
from (
	select award_name, id
	from writer_award w 
	where w.year_of_award>1991 and w.year_of_award<=1995) as a,
	person p
where p.id=a.id and p.first_name='Woody' and p.last_name='Allen';
  
  ",2018-08-30 15:28:03.206354+10,9,1,48,correct
7052,"select count(*)
from movie as m
where not exists
(select a.title, a.production_year
from movie_award as a
where lower(result)='won'
and
a.title=m.title and a.production_year=m.production_year
union
select c.title, c.production_year
from crew_award as c
where lower(result)='won'
and
c.title=m.title and  c.production_year=m.production_year
union
select title, production_year
from director_award as d
where lower(result)='won'
and
d.title=m.title and  d.production_year=m.production_year
union
select title, production_year
from writer_award as w
where lower(result)='won'
and
w.title=m.title and  w.production_year=m.production_year);",2018-08-30 15:28:48.454023+10,11,0,197,partially correct
7053,select count(*) from person p where not exists ( select * from director d where d.id = p.id);,2018-08-30 15:29:08.021118+10,12,1,172,correct
7054,"SELECT ID
FROM(
SELECT D.ID, COUNT(*) AS A FROM DIRECTOR D, WRITER W GROUP BY D.ID) AS B
WHERE B.A=(SELECT MAX(A) FROM (
SELECT D.ID, COUNT(*) AS A FROM DIRECTOR D, WRITER W GROUP BY D.ID) AS BB );",2018-08-30 15:29:08.426581+10,14,1,216,correct
7055,"SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1993'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1992'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1991';",2018-08-30 15:29:14.162381+10,2,1,424,correct
7056,"select count(award_name) from writer_award
where year_of_award >=1991 and year_of_award <=1995 and lower(result)='won' and id=(select id from person
where lower(first_name)='woody' and lower(last_name)='allen');",2018-08-30 15:29:35.805162+10,9,1,313,correct
7057,"select count(*) , production_year
from movie 
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by production_year;
",2018-08-30 15:29:44.792793+10,2,1,425,correct
7058,"SELECT id
FROM APPEARANCE a, PERSON p
WHERE 
title = 'Psycho' AND production_year = '1960' AND scene_no = '1';",2018-08-30 15:29:45.240411+10,10,0,191,partially correct
7059,"select production_year, count(*) 
from movie 
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by production_year;
",2018-08-30 15:30:25.128547+10,2,1,425,correct
7060,"SELECT DISTINCT m.title,m.production_year,p.first_name,p.last_name
FROM movie m,person p
WHERE director.id=p.id AND m.title=director.title=(SELECT movie_award.title FROM movie_award WHERE lower(movie_award.award_name)='bafta film award' AND lower(movie_award.category)='best film');",2018-08-30 15:30:27.44925+10,8,0,395,noninterpretable
7061,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-30 15:30:28.079088+10,6,1,66,correct
7062,"SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1993'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1992'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1991';",2018-08-30 15:30:39.945872+10,2,1,424,correct
7063,"SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1993'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1992'
UNION
SELECT MOVIE.production_year, COUNT(*)
FROM MOVIE
WHERE production_year='1991';",2018-08-30 15:30:46.706808+10,2,1,424,correct
7064,"select title, production_year 
from person p, writer w
where p.id = w. id and 
upper(p.first_name) = 'KEVIN' and 
lower(p.last_name) = 'williamson'
;",2018-08-30 15:30:47.217889+10,5,1,396,correct
7095,"select count(*) from Writer_Award
where (year_of_award>=1991 and year_of_award<=1995) and id=
(
  select Distinct W.id from Person P inner join Writer W on P.id=W.id
  where first_name='Woody' and last_name='Allen'
  )
;",2018-08-30 15:41:34.302038+10,9,0,202,partially correct
7065,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM 
(SELECT title, production_year 
FROM movie_award WHERE lower(award_name)= 'bafta film award' and lower(category)= 'best film'and lower(result)='won') AS ma,
director AS d,
person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;

",2018-08-30 15:30:59.786521+10,8,1,351,correct
7066,"WITH md AS(
SELECT title, production_year
FROM movie_award natural join director
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;
",2018-08-30 15:31:30.259229+10,8,0,106,noninterpretable
7067,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 15:31:43.055481+10,8,1,395,correct
7068,select ;,2018-08-30 15:31:46.369716+10,10,0,389,noninterpretable
7069,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 15:31:57.146213+10,15,1,366,correct
7070,"select count(*)
from person
where not exists (
  select *
  from director
  where director.id = person.id
);",2018-08-30 15:32:04.193946+10,12,1,261,correct
7071,"WITH md AS(
SELECT id,title, production_year
FROM movie_award natural join director
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won')

SELECT title,production_year,first_name,last_name
FROM h, person
WHERE h.id=person.id;
",2018-08-30 15:32:20.369433+10,8,0,106,noninterpretable
7072,"WITH md AS(
SELECT id,title, production_year
FROM movie_award natural join director
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won')

SELECT title,production_year,first_name,last_name
FROM md, person
WHERE md.id=person.id;
",2018-08-30 15:32:33.546222+10,8,1,106,correct
7073,"select production_year,count(*) from movie m
where(production_year between 1991 and 1993)
group by production_year; ",2018-08-30 15:32:34.030922+10,2,1,238,correct
7074,"select count(*)
from movie m
where not exists
(select a.title, a.production_year
from movie_award a
where lower(result)='won'
and
a.title=m.title and a.production_year=m.production_year
union
select c.title, c.production_year
from crew_award c
where lower(result)='won'
and
c.title=m.title and  c.production_year=m.production_year
union
select title, production_year
from director_award d
where lower(result)='won'
and
d.title=m.title and  d.production_year=m.production_year
union
select title, production_year
from writer_award w
where lower(result)='won'
and
w.title=m.title and  w.production_year=m.production_year
union
select title, production_year
from actor_award ac
where lower(result)='won'
and
ac.title=m.title and  ac.production_year=m.production_year);",2018-08-30 15:32:37.002077+10,11,1,197,correct
7075,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-30 15:32:39.457088+10,7,1,66,correct
7076,"select id,award_name,year_of_award,category
from director_award natural join director
where lower(result) = 'nominated'

;",2018-08-30 15:32:56.433314+10,13,1,387,correct
7077,"select count(*)
from movie m
where not exists
(select a.title, a.production_year
from movie_award a
where lower(result)='won'
and
a.title=m.title and a.production_year=m.production_year
union
select c.title, c.production_year
from crew_award c
where lower(result)='won'
and
c.title=m.title and  c.production_year=m.production_year
union
select title, production_year
from director_award d
where lower(result)='won'
and
d.title=m.title and  d.production_year=m.production_year
union
select title, production_year
from writer_award w
where lower(result)='won'
and
w.title=m.title and  w.production_year=m.production_year
union
select title, production_year
from actor_award ac
where lower(result)='won'
and
ac.title=m.title and  ac.production_year=m.production_year);",2018-08-30 15:33:08.186997+10,11,1,197,correct
7078,select count(id) from Person where id not in (select id from Director);,2018-08-30 15:33:18.401608+10,12,1,126,correct
7079,"select count(*)
from director d, person p
where p.id = d.id;",2018-08-30 15:33:54.137089+10,12,0,425,partially correct
7080,select count(*) from person p left join director d on p.id = d.id where title is null;,2018-08-30 15:34:04.463165+10,12,1,371,correct
7081,"select count(*)
from person p
where not exists (select * from director d where d.id = p.id);",2018-08-30 15:35:01.825802+10,12,1,425,correct
7082,select country from restriction where lower(title) = 'Shakespeare in love' and description = 'M' ;,2018-08-30 15:36:27.108739+10,6,0,400,partially correct
7083,"SELECT COUNT(*)
FROM MOVIE m
WHERE production_year='1960';
",2018-08-30 15:36:43.837641+10,11,0,191,partially correct
7084,"with temp as(
	select distinct d.id,d.title,d.production_year
	from director d
	union
	select w.id,w.title,w.production_year
	from writer w),
c as(
	select id, count(*) as num
	from temp
	group by id)

select id
from c
where num = (select max(num) from c);",2018-08-30 15:37:35.854605+10,14,1,128,correct
7085,"SELECT country
from restriction_category
where description = 'M'
;",2018-08-30 15:38:06.922239+10,6,0,396,partially correct
7086,"SELECT title, production_year
FROM Movie_Award
WHERE award_name = 'BAFTA Film Award'
GROUP BY title;",2018-08-30 15:38:20.397142+10,8,0,54,partially correct
7087,"SELECT COUNT(*)
FROM PERSON
WHERE EXISTS (SELECT*FROM WRITER WHERE WRITER.ID=PERSON.ID AND PERSON.year_born=1935);",2018-08-30 15:38:32.733621+10,1,1,424,correct
7088,"select v.id, v.award_name, v.year_of_award, v.category from (select u.id, u.award_name, u.year_of_award, u.category, u.result from (director d natural join director_award da) u where lower(u.result)=nominated) v where not exists (select * from director_ard da where v.award_name=(select da.award_name from director_award da where lower(result)=won));",2018-08-30 15:38:55.586223+10,13,0,270,noninterpretable
7089,"select production_year,count(*)
from movie
where production_year=1991 or
production_year=1992 or
production_year=1993 
group by production_year;
      ",2018-08-30 15:39:03.53443+10,2,1,300,correct
7090,"SELECT  id,first_name, last_name, year_born
FROM PERSON
WHERE year_born = 1935 




;",2018-08-30 15:39:16.07342+10,1,0,260,partially correct
7091,"SELECT COUNT(*)
FROM writer_award NATURAL JOIN person AS wa
WHERE lower(wa.first_name)='woody' AND lower(wa.last_name)='allen' AND writer_award.production_year BETWEEN 1991 AND 1995;  ",2018-08-30 15:39:18.527543+10,9,1,395,correct
7092,"
SELECT title,production_year,first_name,last_name
FROM movie_award ma natural join director d natural join person p
WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won';
",2018-08-30 15:39:42.639026+10,8,1,106,correct
7093,"SELECT
    COUNT(*) 
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 15:39:58.800111+10,9,1,377,correct
7094,"select count(Person.id)
from writer, person
where person.id=writer.id
and person.year_born=1935;
",2018-08-30 15:41:12.788744+10,1,0,300,partially correct
7096,"SELECT COUNT(year_born)
FROM PERSON
WHERE year_born = 1935;",2018-08-30 15:41:39.166435+10,1,0,260,partially correct
7100,"select r.id

from role r, scene s, appearance a

where 
s.title=a.title
and s.production_year = a.production_year
and s.scene_no = a.scene_no
and r.description = a.description
and s.title=r.title
and s.production_year = r.production_year
and lower(a.title) ='psycho'
and a.production_year=1960

group by r.id

having count(*)=1


;",2018-08-30 15:43:05.478623+10,10,1,389,correct
7101,select * from movie m natural join crew_award;,2018-08-30 15:43:39.895194+10,11,0,317,partially correct
7102,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d NATURAL JOIN director_award da
WHERE lower(result) = 'nominated';",2018-08-30 15:43:43.385928+10,13,1,81,correct
7103,"select count(*) from Writer_Award
where (year_of_award>=1991 and year_of_award<=1995) and lower(result)='won' and id=
(
  select Distinct W.id from Person P inner join Writer W on P.id=W.id
  where first_name='Woody' and last_name='Allen'
  )
;",2018-08-30 15:43:44.633753+10,9,1,202,correct
7104,"SELECT id, first_name, last_name
FROM (person NATURAL JOIN writer NATURAL JOIN director)
group by id
having count(*)>1;",2018-08-30 15:44:08.570467+10,4,1,148,correct
7105,;,2018-08-30 15:44:28.66105+10,14,0,81,noninterpretable
7106,;,2018-08-30 15:44:38.579611+10,14,0,81,noninterpretable
7107,"select id
from appearance a
role r

where r.title=a.title
and production_year=1960
and r.title= 'Psycho'
having count(id)=1;",2018-08-30 15:44:54.386374+10,10,0,377,noninterpretable
7108,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 15:45:04.199703+10,14,1,81,correct
7109,"select id,first_name,last_name from person p where exists (select * from director d inner join writer w on d.id = w.id where p.id = d.id);",2018-08-30 15:45:04.222132+10,4,0,371,partially correct
7110,"SELECT COUNT(*)
FROM PERSON
EXCEPT
SELECT COUNT(*)
FROM PERSON p
WHERE EXISTS (SELECT * FROM DIRECTOR d WHERE d.id=p.id);",2018-08-30 15:45:05.244756+10,12,0,424,partially correct
7111,"with t as (select id
from role r,scene s,appearance a 
where lower(r.title)='psycho'
and r.production_year=1960
and r.title=s.title
and a.title=s.title
and r.production_year=s.production_year
and r.production_year=a.production_year

and r.description=a.description
and s.scene_no=a.scene_no)

select id from t
group by id 
having count(*)=1;",2018-08-30 15:45:10.608124+10,10,1,397,correct
7112,;,2018-08-30 15:45:18.704818+10,15,0,81,noninterpretable
7113,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );
",2018-08-30 15:45:36.578601+10,15,1,81,correct
7114,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE p.id=w.id and p.year_born = 1935);",2018-08-30 15:45:51.239743+10,1,1,132,correct
7115,select p.id from person p where year_born = (select max(year_born) from person where year_born not in (select max(year_born) from person));,2018-08-30 15:46:47.746412+10,3,1,99,correct
7116,"SELECT id
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born) FROM PERSON p);",2018-08-30 15:47:00.145618+10,3,0,191,partially correct
7117,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND a.title = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 15:47:15.737581+10,10,0,377,partially correct
7118,"SELECT COUNT(*)
FROM WRITER w
WHERE EXISTS (SELECT * FROM person p
WHERE p.id=w.id AND p.year_born=1935);",2018-08-30 15:47:49.273426+10,1,0,185,partially correct
7119,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 15:48:17.55765+10,10,1,377,correct
7120,"select id
from role r,
	(select title, scene_no
	from scene
	where title='Psycho' 
	) as s
where r.title=s.title ;",2018-08-30 15:48:21.494999+10,10,0,48,partially correct
7121,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M'
; ",2018-08-30 15:49:00.556338+10,6,1,396,correct
7122,"select dw.id,dw.first_name,dw.last_name from (person p natural join director natural join writer) as dw group by dw.id having count(*)>1;",2018-08-30 15:49:21.150458+10,4,1,371,correct
7123,"select count(*)
from movie;",2018-08-30 15:49:28.300633+10,2,0,225,partially correct
7124,";
",2018-08-30 15:49:34.447748+10,11,0,249,noninterpretable
7125,"select * from role natural join appearance
where lower(title) = 'psycho' and production_year =1960
group by id
having count(scene_no)=1;
",2018-08-30 15:49:48.806767+10,10,0,313,partially correct
7126,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 15:50:00.100619+10,10,1,48,correct
7127,"select id from role natural join appearance
where lower(title) = 'psycho' and production_year =1960
group by id
having count(scene_no)=1;
",2018-08-30 15:50:13.2836+10,10,1,313,correct
7128,"select x.id 
from (select o.id, count(*) as num
from (select w.id, w.title, w.production_year
from writer w)
union
(select d.id, d.title, d.production_year
from director d) as o
group by o.id) as x
where x.num = (select max(x1.num)
from (select o.id, count(*) as num
from (select w.id, w.title, w.production_year
from writer w)
union
(select d.id, d.title, d.production_year
from director d) as o
group by o.id) as x1);",2018-08-30 15:50:22.125638+10,14,0,338,noninterpretable
7129,"select id, first_name, last_name from Person where id in (select id from Writer where exists (
select id, count(id) as aa from Director group by id having aa >=2 and Writer.id = Director.id));",2018-08-30 15:51:28.875908+10,4,0,126,partially correct
7130,"select v.id, v.award_name, v.year_of_award, v.category from (select u.id, u.award_name, u.year_of_award, u.category, u.result from (director d natural join director_award da) u where lower(u.result)='nominated') v;
",2018-08-30 15:51:36.041348+10,13,1,270,correct
7131,"select count(*) from (select distinct person.id from writer,person 
where writer.id = person.id
and person.year_born = 1935)
;",2018-08-30 15:51:44.596829+10,1,1,405,correct
7132,"select title, production_year from person natural join writer where lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-30 15:51:51.658771+10,5,1,172,correct
7133,"SELECT a.title, a.production_year, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN movie_award) AS a
WHERE lower(a.award_name)= 'bafta film award'
AND lower(a.category)='best film';",2018-08-30 15:51:59.242721+10,8,0,96,partially correct
7134,"SELECT COUNT(*)
FROM person s 
WHERE EXISTS (SELECT distinct * FROM WRITER natural join director)
GROUP BY s.id;
",2018-08-30 15:52:31.67352+10,14,0,132,partially correct
7135,"SELECT production_year, COUNT(*)
FROM MOVIE m
GROUP BY production_year
HAVING production_year>1990 AND production_year<1994;",2018-08-30 15:52:55.366043+10,2,1,185,correct
7136,"SELECT a.title, a.production_year, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN movie_award) AS a
WHERE lower(a.award_name)= 'bafta film award'
AND lower(a.category)='best film'
AND lower(a.result)='won';",2018-08-30 15:53:02.9416+10,8,1,96,correct
7137,"Select Count(*) from writer w, Person p
where w.id = p.id and p.year_born like '1935';",2018-08-30 15:53:29.171474+10,1,0,71,partially correct
7138,"Select Count(*) from writer w, Person p
where w.id = p.id and p.year_born like '1935';",2018-08-30 15:53:42.370402+10,1,0,71,partially correct
7139,"select id, first_name, last_name from Person where id in (select id from Director where exists (
select id, count(id) as aa from Writer group by id having aa >1 and Writer.id = Director.id));",2018-08-30 15:54:25.296852+10,4,1,126,correct
7140,"select production_year,count(*) from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-30 15:54:36.525529+10,2,1,405,correct
7141,"
SELECT m.title, m.production_year
FROM  movie m ,writer w ,person p 
WHERE m.title = w.title
	 AND m.production_year = w.production_year
	 AND w.id = p.id
	 AND lower(p.first_name)='kevin'
	 AND lower(p.last_name)= 'williamson';
",2018-08-30 15:54:45.505815+10,5,1,343,correct
7142,"SELECT m.production_year,COUNT(*)
FROM movie m
WHERE m.production_year>1990 and m.production_year<1994
GROUP BY m.production_year;",2018-08-30 15:55:18.836551+10,2,1,132,correct
7143,"select count(*)
from movie m
where not exists 
((select title,production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year 
and lower(result)='won')
union
(select title,production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year
and lower(result)='won')
union
(select title,production_year from director_award da where da.title=m.title and da.production_year=m.production_year
and lower(result)='won')
union
(select title,production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year
and lower(result)='won')
union
(select title,production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year 
and lower(result)='won')
);",2018-08-30 15:55:32.529676+10,11,0,397,noninterpretable
7144,"select aw.title, aw.production_year from (movie m natural join writer w natural join person p) as aw where aw.first_name = 'Kevin' and aw.last_name = 'Williamson';",2018-08-30 15:55:42.2945+10,5,1,371,correct
7145,"select distinct per1.id, per1.first_name, per1.last_name
from person per1
where per1.year_born = (select min(year_born) from person)
;",2018-08-30 15:55:52.074701+10,7,0,358,partially correct
7146,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d
WHERE d.id=p.id);",2018-08-30 15:56:22.88363+10,12,1,185,correct
7147,"select id
from
   role
   natural join
   Appearance
group by id, title, production_year
having
   title = 'Psycho'
   and
   production_year = '1960'
   and
   count(id) = 1;",2018-08-30 15:56:24.432039+10,10,1,410,correct
7148,"select production_year,title
from writer
where writer.id = (
select person.id
from person
where first_name = Williamson
);",2018-08-30 15:56:36.095494+10,5,0,261,noninterpretable
7149,"select distinct per1.id, per1.first_name, per1.last_name
from person per1
where per1.year_born = (select max(year_born) from person)
;",2018-08-30 15:56:38.620249+10,7,1,358,correct
7150,"SELECT id,first_name, last_name
from person
where year_born = 
(
select max (year_born)
from person
)
;",2018-08-30 15:56:54.003141+10,7,1,396,correct
7151,"select count(*)
from(
select distinct id
from writer natural join person
where year_born =1935
	

)






		;",2018-08-30 15:57:15.60043+10,1,1,387,correct
7152,"select count(*) from person as p 
where not exists (select * from director as d where p.id = d.id) 
;",2018-08-30 15:57:20.678427+10,12,1,405,correct
7153,"select count(*)
from movie m
where not exists 
(
select title,production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year 
and lower(result)='won'
union
select title,production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year
and lower(result)='won'
union
select title,production_year from director_award da where da.title=m.title and da.production_year=m.production_year
and lower(result)='won'
union
select title,production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year
and lower(result)='won'
union
select title,production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year 
and lower(result)='won'
);",2018-08-30 15:57:36.146065+10,11,1,397,correct
7154,"SELECT count(distinct w.id)
FROM person p 
inner join
writer w
on w.id = p.id
where year_born like '1935';",2018-08-30 15:57:38.867946+10,1,1,71,correct
7155,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT * FROM WRITER w WHERE p.id = w.id);
",2018-08-30 15:57:45.031735+10,12,0,132,partially correct
7156,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-30 15:57:57.764042+10,2,1,124,correct
7157,"SELECT COUNT(year_born)
FROM person p
WHERE EXISTS(SELECT year_born FROM writer w WHERE w.id = p.id AND p.year_born = 1935)
;",2018-08-30 15:57:58.114198+10,1,1,260,correct
7158,"select distinct count (w.id)
from writer w, person p
where w.id=p.id and p.year_born=1935;",2018-08-30 15:58:18.092716+10,1,0,273,partially correct
7159,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id = d.id);
",2018-08-30 15:58:31.62589+10,12,1,132,correct
7160,select country from restriction where lower(title) = 'shakespeare in love' and description = 'M';,2018-08-30 15:58:37.438801+10,6,1,172,correct
7161,"select id, first_name, last_name
from person
where year_born =  ( select max (year_born) from person ) ;",2018-08-30 15:58:40.217945+10,7,1,400,correct
7162,"select count(person.id)
from (select distinct writer.id from writer,person where writer.id=person.id and person.year_born=1935) m , person
where person.id =m.id ;



",2018-08-30 15:59:11.386842+10,1,1,300,correct
7163,"select rr.id from role rr,

(select description from (select r.description,count(r.description) as des_num from appearance a,role r where a.title=r.title and a.production_year=r.production_year and a.description=r.description and a.title='Psycho' and a.production_year=1960 group by r.description)as b where b.des_num=1)as c

where rr.description=c.description and rr.title='Psycho' and rr.production_year=1960;
",2018-08-30 15:59:21.056149+10,10,1,117,correct
7164,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id=d.id);",2018-08-30 15:59:44.758788+10,12,1,124,correct
7165,"SELECT MAX(P.year_born)
FROM PERSON P
;
",2018-08-30 15:59:52.1525+10,3,0,249,partially correct
7166,"with temp as (SELECT *, count(*) as num
FROM role
GROUP BY id),

maxid as(SELECT id
FROM temp
WHERE num= (SELECT max(num) from temp))

SELECT id, first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
WHERE id IN maxid;",2018-08-30 15:59:53.992936+10,15,0,128,partially correct
7167,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT * FROM director, d WHERE d.id=p.id);
",2018-08-30 16:00:07.855708+10,4,0,424,noninterpretable
7168,"select id 
from person p
where p.year_born = (select max(year_born) from person
where year_born < (select max(year_born) from person));",2018-08-30 16:00:20.994107+10,3,1,174,correct
7169,"select count (distinct w.id)
from writer w, person p
where w.id=p.id and p.year_born=1935;",2018-08-30 16:00:25.243651+10,1,1,273,correct
7170,"select d.id, da.award_name, da.year_of_award, da.category
from director d,
director_award as da
where da.title = d.title
and da.production_year = d.production_year
and lower(da.result)='nominated'
group by result
having count(0);",2018-08-30 16:00:29.025886+10,13,1,174,correct
7171,"SELECT id, first_name, last_name
FROM PERSON p WHERE EXISTS
(SELECT COUNT(*) AS movie_count FROM DIRECTOR d, WRITER w WHERE d.id = w.id AND d.title = w.title AND d.id = p.id AND movie_count > 1);",2018-08-30 16:00:46.263534+10,4,0,50,noninterpretable
7172,select r.country from restriction r inner join movie m on r.title = m.title where r.title = 'Shakespeare in Love' and r.description = 'M';,2018-08-30 16:00:58.623782+10,6,1,371,correct
11815,"select count(*)neverDirect
from person p 
where p.id not in (select d.id from director d);",2018-08-31 15:32:03.733345+10,12,1,293,correct
7174,"SELECT id,first_name,last_name
FROM PERSON p
WHERE EXISTS (SELECT d.id,COUNT(*) FROM DIRECTOR d,WRITER w WHERE d.title = w.title AND d.id=w.id GROUP BY d.id HAVING COUNT(*)>=2);",2018-08-30 16:01:10.453724+10,4,0,132,partially correct
7175,select title from movie;,2018-08-30 16:01:14.513891+10,11,0,313,partially correct
7176,"select count(*)
from person ;
",2018-08-30 16:01:48.454736+10,12,0,225,partially correct
7177,"select count(distinct id)
from (person natural join writer) as wp
where year_born = 1935;",2018-08-30 16:02:19.426307+10,1,1,347,correct
7178,"select person.id, first_name, last_name
from writer, director, person
where writer.id = director.id
and person.id = writer.id
and writer.title = director.title
and writer.production_year = director.production_year
group by writer.id
having count(*) > 1
;",2018-08-30 16:02:46.237329+10,4,1,405,correct
7179,"SELECT r.country
FROM restriction r
WHERE lower(r.title)= 'shakespeare in love'
	AND lower(r.description) = 'm';
",2018-08-30 16:02:51.558633+10,6,1,343,correct
7180,"with temp as (SELECT *, count(*) as num
FROM role
GROUP BY id),

maxid as(SELECT id
FROM temp
WHERE num= (SELECT max(num) from temp))

SELECT first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
WHERE id IN maxid;",2018-08-30 16:03:24.714848+10,15,1,128,correct
7181,"Select count(id) from role natural join Appearance group by id,title,production_year having title='Psycho' and production_year='1960'  ;
",2018-08-30 16:03:30.492301+10,10,0,16,partially correct
7182,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-30 16:03:36.582189+10,2,1,273,correct
7183,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-30 16:03:55.705819+10,6,1,126,correct
7184,"select id from person
where  year_born=(select  row 2 year_born from person
group by year_born order by year_born desc limit 1 offset 1);",2018-08-30 16:04:04.631784+10,3,0,197,noninterpretable
7185,"SELECT COUNT(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);",2018-08-30 16:04:06.191403+10,1,1,124,correct
7186,"select id from person
where  year_born=(select year_born from person
group by year_born order by year_born desc limit 1 offset 1);",2018-08-30 16:04:27.113092+10,3,1,197,correct
7187,"select MA.title, MA.production_year,per.first_name, per.last_name
from Movie_Award MA
natural join director di
natural join person per
where category = 'Best Film'
and award_name = 'BAFTA Film Award';",2018-08-30 16:04:31.197449+10,8,0,358,partially correct
7188,"Select id from role natural join Appearance group by id,title,production_year having title='Psycho' and production_year='1960' and count(id)=1 ;
",2018-08-30 16:04:47.644837+10,10,1,16,correct
7189,"SELECT
FROM
WHERE;",2018-08-30 16:04:51.067203+10,13,0,249,noninterpretable
7190,"select count(*) as num from(
select m.title,m.production_year
from movie m
where not exists
(select ma.title,ma.production_year
	from movie_award ma
	where m.title =ma.title and m.production_year=ma.production_year and ma.result='won'
	union
	select ca.title,ca.production_year
	from crew_award ca,crew c
	where m.title=ca.title and m.production_year=ca.production_year and ca.result='won' and ca.id=c.id
	union 
	select da.title,da.production_year
	from director_award da
	where m.title=da.title and m.production_year=da.production_year and da.result='won'
	union
	select wa.title,wa.production_year
	from writer_award wa,writer w
	where m.title=wa.title and m.production_year=wa.production_year and wa.result='won' and w.id=wa.id
	union
	select aa.title,aa.production_year
	from actor_award aa,role r
	where m.title=aa.title and m.production_year=aa.production_year and aa.result='won' and r.description=aa.description) )as a;
",2018-08-30 16:04:58.058069+10,11,0,230,partially correct
7191,"select id, first_name, last_name from person where (select max(year_born) from person);",2018-08-30 16:05:05.760218+10,7,0,371,partially correct
7192,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-30 16:05:06.959245+10,7,1,172,correct
7193,"select production_year, count(*) as No
from movie
where production_year >1990 and production_year < 1994
group by production_year;",2018-08-30 16:05:29.524385+10,2,1,347,correct
7194,"SELECT id, first_name, last_name
FROM person p NATURAL JOIN DIRECTOR d NATURAL JOIN WRITER w
GROUP BY id
HAVING COUNT(*)>1;",2018-08-30 16:05:31.266576+10,4,1,185,correct
7195,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-30 16:05:35.916168+10,7,1,371,correct
7196,"select count(*) from Movie_Award a, Crew_Award b, director_award c,writer_award d, actor_award e 
where not exists(select * from Movie_Award a, Crew_Award b, director_award c,writer_award d, actor_award e where
    lower(a.result)='won'
and lower(b.result)='won'
and lower(c.result)='won'
and lower(d.result)='won'
and lower(e.result)='won'
);",2018-08-30 16:05:49.712023+10,11,0,205,partially correct
7197,"select id from person
where  year_born=(select year_born from person
group by year_born order by year_born desc limit 1 offset 1);",2018-08-30 16:06:02.396107+10,3,1,197,correct
7198,"SELECT count(*)
FROM writer_award wa
WHERE id = (SELECT id
            FROM person
		 WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen') AND
      wa.year_of_award in (1991,1992,1993,1994,1995) AND 
	result = lower('won');",2018-08-30 16:06:13.509148+10,9,1,106,correct
7199,"select count(*) as num from(
select m.title,m.production_year
from movie m
where not exists
(select ma.title,ma.production_year
	from movie_award ma
	where m.title =ma.title and m.production_year=ma.production_year and lower(ma.result)='won'
	union
	select ca.title,ca.production_year
	from crew_award ca
	where m.title=ca.title and m.production_year=ca.production_year and lower(ca.result)='won' 
	union 
	select da.title,da.production_year
	from director_award da
	where m.title=da.title and m.production_year=da.production_year and lower(da.result)='won'
	union
	select wa.title,wa.production_year
	from writer_award wa
	where m.title=wa.title and m.production_year=wa.production_year and lower(wa.result)='won' 
	union
	select aa.title,aa.production_year
	from actor_award aa
	where m.title=aa.title and m.production_year=aa.production_year and lower(aa.result)='won' ) )as a;
",2018-08-30 16:06:25.028916+10,11,1,230,correct
7200,"select count (distinct p.id)
from person p, director d
where not exists (select p.id from person p natural join director d);",2018-08-30 16:06:28.965823+10,12,0,273,partially correct
7201,"select count(title)
from 
	(select * from director d , director_award  da where d.title=da.title and da.result!='won') as d1,
	(select * from movie m , movie_award  ma where m.title=ma.title and ma.result!='won') as m1,
	(select * from writer w , director_award  wa where d.title=wa.title and wa.result!='won') as w1,
	(select * from crew c , crew_award  ca where c.title=ca.title and ca.result!='won') as c1,
	(select * from role r , actor_award  aa where r.title=aa.title and aa.result!='won') as r1
where d1.title=m1.title
	  and d1.title=m1.title
	  and d1.title=w1.title
	  and d1.title=c1.title
	  and d1.title=r1.title;",2018-08-30 16:06:37.266317+10,11,0,48,noninterpretable
7202,"select title,production_year from writer, person
where writer.id = person.id
and lower(person.first_name) = 'kevin'
and lower(person.last_name) = 'williamson'
;",2018-08-30 16:06:54.485356+10,5,1,405,correct
7203,"SELECT production_year,count(*)
FROM movie m
WHERE production_year <= 1993 and production_year>1990

group by production_year


;",2018-08-30 16:06:58.790129+10,2,1,260,correct
7204,"SELECT writer.title, writer.production_year
FROM writer, person
WHERE writer.id = person.id AND person.first_name = 'Kevin' AND person.last_name = 'Williamson';",2018-08-30 16:07:07.006028+10,5,1,148,correct
7205,"select id from person
where  year_born=(select year_born from person
group by year_born order by year_born desc limit 2, 1);",2018-08-30 16:07:09.266984+10,3,0,197,partially correct
7206,"select id, first_name, last_name from person order by year_born limit 1;",2018-08-30 16:07:18.913941+10,7,0,126,partially correct
7268,"select dw.id, dw.first_name, dw.last_name
from (person natural join writer natural join director) as dw
group by dw.id
having count(*) > 1;",2018-08-30 16:24:50.685425+10,4,1,425,correct
7207,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 16:07:28.404323+10,11,1,48,correct
7208,"select count(*)
from(

select id, title, production_year
from director

union

select id, title, production_year
from writer

group by id


)



;",2018-08-30 16:07:46.38562+10,14,0,387,partially correct
7209,"SELECT p.id,p.first_name,p.last_name
FROM person p 
WHERE p.year_born = (
	SELECT max(p.year_born)
	FROM person p );",2018-08-30 16:07:58.452802+10,7,1,343,correct
7210,"SELECT count(*)
FROM writer_award wa
WHERE id = (SELECT id
            FROM person natural join writer
		 WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen') AND
      wa.year_of_award in (1991,1992,1993,1994,1995) AND 
	result = lower('won');",2018-08-30 16:08:16.525887+10,9,1,106,correct
7211,"SELECT COUNT(*)
FROM (person NATURAL JOIN writer NATURAL JOIN writer_award) AS a
WHERE lower (a.first_name)= 'woody'
AND lower(a.last_name)= 'allen'
AND lower(a.result)= 'won'
AND a.year_of_award>1990
AND a.year_of_award<1996;",2018-08-30 16:08:24.090785+10,9,1,96,correct
7212,"select id from person
where  year_born=(select year_born from person
group by year_born order by year_born desc limit 1, 2);",2018-08-30 16:08:48.453679+10,3,1,197,correct
7213,"select ma.title, ma.production_year, pd.first_name, pd.last_name
from movie_award ma
inner join (person natural join director) pd on pd.title=ma.title and pd.production_year=ma.production_year;",2018-08-30 16:08:51.71426+10,8,0,349,partially correct
7214,"select title,production_year from writer natural join person
where lower(person.first_name) = 'kevin'
and lower(person.last_name) = 'williamson'
;",2018-08-30 16:09:13.801918+10,5,1,405,correct
7215,"select distinct ma.title, ma.production_year, pd.first_name, pd.last_name
from movie_award ma
inner join (person natural join director) pd on pd.title=ma.title and pd.production_year=ma.production_year;",2018-08-30 16:09:14.343489+10,8,0,349,partially correct
7216,"select id, first_name, last_name from person order by year_born desc limit 1;",2018-08-30 16:09:35.824576+10,7,1,126,correct
7217,"select movie.title, movie.production_year, person.first_name, person.last_name
from (movie natural join director natural join movie_award natural join person)
where movie_award.award_name = 'BAFTA Film Award' and movie_award.category = 'Best Film' ;",2018-08-30 16:09:51.45302+10,8,0,400,partially correct
7218,"select country
from restriction
where title= 'Shakespeare in Love'and description ='M';",2018-08-30 16:10:41.991954+10,6,1,261,correct
7219,"SELECT COUNTr.id)
FROM appearance a,role r 
WHERE lower(r.title)='psycho' AND r.production_year=1960;",2018-08-30 16:10:48.465597+10,10,0,395,noninterpretable
7220,"select count(Person.id)
from Person
where Person.id not in (select Person.id from Person ,director where Person.id=director.id);",2018-08-30 16:10:58.613242+10,12,1,300,correct
7221,"SELECT title, production_year
FROM WRITER w
WHERE EXISTS (SELECT * FROM person p
WHERE w.id=p.id AND lower(p.first_name)='kevin' AND lower(p.last_name)='williamson');",2018-08-30 16:11:27.26019+10,5,1,185,correct
7222,"
select count(*) as countd
from person p, writer w, director d
where p.id = w.id and p.id = d.id 
group by p.id ;",2018-08-30 16:12:37.174487+10,4,0,425,partially correct
7223,"select p1.first_name, p1.last_name, title, production_year, descrption
from role r, (select id from person p
 where id=count (max(id))p1
 where r.id=p1.id;
 
",2018-08-30 16:12:39.581861+10,15,0,351,noninterpretable
7224,"



SELECT count(*)
FROM writer_award natural join writer natural join person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND wa.year_of_award in (1991,1992,1993,1994,1995) and result = lower('won');",2018-08-30 16:13:10.269968+10,9,0,106,noninterpretable
7225,"



SELECT count(*)
FROM writer_award natural join writer natural join person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND year_of_award in (1991,1992,1993,1994,1995) and result = lower('won');",2018-08-30 16:13:51.103952+10,9,1,106,correct
7226,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 16:14:07.517035+10,10,1,395,correct
7227,"SELECT title, production_year
FROM (writer w NATURAL JOIN person p) 
WHERE first_name='Kevin' AND last_name='Williamson';",2018-08-30 16:14:20.126394+10,5,1,424,correct
7228,"SELECT aw.title,aw.production_year,p.first_name,p.last_name
from person p,
	director d,
	(SELECT title,production_year 
	FROM movie_award 
	WHERE lower(award_name)=""bafta film award""
		and lower(category)='best film'
		and lower(result)='won') as aw
where aw.title = d.title
	and d.id = p.id
	and d.production_year = aw.production_year;",2018-08-30 16:14:58.214891+10,8,1,132,correct
7229,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year from movie_award where lower(award_name)= 'bafta film award' and lower(category) = 'best film' and lower (result) = 'won')
as ma, person as p, director as d
where ma.title = d.title and ma.production_year = d.production_year and d.id= p.id ;",2018-08-30 16:15:01.45003+10,8,1,400,correct
7230,"SELECT country
FROM RESTRICTION r
WHERE lower(r.title)='shakespeare in love' AND lower(r.description)='m';",2018-08-30 16:15:13.967608+10,6,1,185,correct
7231,;,2018-08-30 16:15:14.086429+10,10,0,195,noninterpretable
7232,"select 
	id
from
	person 
	
where 
	(select max(year_born) from person) 
	year_born=max(year_born);",2018-08-30 16:15:16.541256+10,3,0,48,noninterpretable
7233,"select title, first_name, last_name
from Movie_Award MA
natural join director di
natural join person per
where category = 'best film'
and result = 'won'
and award_name = 'BAFTA Film Award';",2018-08-30 16:15:28.856651+10,8,0,358,partially correct
7234,;,2018-08-30 16:15:42.60661+10,14,0,249,noninterpretable
7235,"select p1.id,p1.first_name,p1.last_name
from person p1
where p1.year_born =(
select max(p2.year_born)
from person p2
);",2018-08-30 16:15:49.763556+10,7,1,261,correct
7236,"
SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 16:16:07.758277+10,3,1,48,correct
7237,"select title, production_year, first_name, last_name
from Movie_Award MA
natural join director di
natural join person per
where category = 'best film'
and result = 'won'
and award_name = 'BAFTA Film Award';",2018-08-30 16:16:17.778139+10,8,1,358,correct
7238,"Select Count(distinct title) from movie
where production_year like '1991' or production_year like '1992' or production_year like '1993';",2018-08-30 16:16:45.261484+10,2,0,71,partially correct
7239,"Select production_year, Count(distinct title) from movie
where production_year like '1991' or production_year like '1992' or production_year like '1993'
group by production_year;",2018-08-30 16:17:27.05363+10,2,1,71,correct
7240,select id from person where year_born=(select max(year_born) from(select * from person where year_born !=(select max(year_born) from person))as a);,2018-08-30 16:18:08.109937+10,3,1,117,correct
7269,"select count(*) from
(select * from writer_award as wa, person as p  where wa.id = p.id and lower (p.first_name)= 'woody' and lower(p.last_name)= 'allan' and wa.year_of_award < 1996
and wa.year_of_award > 1990 );",2018-08-30 16:24:58.134474+10,9,0,400,partially correct
11816,select distinct id from role r where lower(r.title) = 'psycho' and r.production_year=1960;,2018-08-31 15:32:08.573607+10,10,0,196,partially correct
7241,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 16:18:11.098098+10,10,1,265,correct
7242,"select p.id,p.first_name,p.last_name
from Person p ,writer w,movie m ,director d
where d.id=w.id and
      w.id=p.id and
      d.title=w.title and
	 w.title=m.title and
	 d.production_year=w.production_year and
	 w.production_year=m.production_year
group by(p.id)
Having count(p.id)>=2;",2018-08-30 16:18:28.233431+10,4,1,300,correct
7243,"select ma.title, ma.production_year, p.first_name, p.last_name
from MOVIE_AWARD ma natural join director d natural join person p
where lower (category) = 'best film' and
lower (result) = 'won'
;",2018-08-30 16:18:47.127846+10,8,0,396,partially correct
7244,;,2018-08-30 16:19:01.912951+10,9,0,358,noninterpretable
7245,"select count(*) from movie m where not exists(select title,production_year from movie_award ma where m.title=ma.title and m.production_year=ma.production_year and ma.result='nominated' union select title,production_year from crew_award c where m.title=c.title and m.production_year=c.production_year and c.result='won' and c.result='Won' union select title,production_year from director_award d where m.title=d.title and m.production_year=d.production_year and d.result='Won' and d.result='won' union select title,production_year from writer_award w  where m.title=w.title and m.production_year=w.production_year and w.result='won' and w.result='Won' union select title,production_year from actor_award a where m.title=a.title and m.production_year=a.production_year and a.result='Won' and a.result='won');",2018-08-30 16:19:05.405551+10,11,0,317,partially correct
7246,"SELECT h.title, h.production_year, first_name, last_name
FROM director, person,
(SELECT title, production_year FROM movie_award
WHERE lower(award_name)='bafta film award'
AND lower(category)='best film'
AND lower(result)='won') AS h
WHERE director.id=person.id
AND director.title=h.title 
AND director.production_year=h.production_year;",2018-08-30 16:20:10.131183+10,8,1,288,correct
7247,"select id, count(*) from (select id from writer w union select id from director d) group by id;",2018-08-30 16:20:12.408807+10,14,0,99,partially correct
7248,"select count(*) from movie m where not exists(select title,production_year from movie_award ma where m.title=ma.title and m.production_year=ma.production_year and ma.result='Won' and ma.result='won' union select title,production_year from crew_award c where m.title=c.title and m.production_year=c.production_year and c.result='won' and c.result='Won' union select title,production_year from director_award d where m.title=d.title and m.production_year=d.production_year and d.result='Won' and d.result='won' union select title,production_year from writer_award w  where m.title=w.title and m.production_year=w.production_year and w.result='won' and w.result='Won' union select title,production_year from actor_award a where m.title=a.title and m.production_year=a.production_year and a.result='Won' and a.result='won');",2018-08-30 16:20:14.395569+10,11,0,317,partially correct
7249,"

select id 
from (select distinct a.id,count(*) as nom
from (select id,title,production_year
from DIRECTOR
UNION
SELECT id,title,production_year
from WRITER)as a
GROUP BY a.id)
where nom=
(select max(nom)
from(select distinct a.id,count(*) as nom
from (select id,title,production_year
from DIRECTOR
UNION
SELECT id,title,production_year
from WRITER)as a
GROUP BY a.id)as b);",2018-08-30 16:20:33.04262+10,14,1,64,correct
7250,"select ma.title, ma.production_year, p.first_name, p.last_name
from MOVIE_AWARD ma natural join director d natural join person p
where lower (category) = 'best film' and
lower (award_name) = 'bafta film award' and
lower (result) = 'won'
;",2018-08-30 16:20:44.104219+10,8,1,396,correct
7251,"select title, production_year, first_name, last_name from (person natural join director) as ww where title in (
select title from movie_award where lower(award_name)='bafta film award'and lower(category) = 'best film');",2018-08-30 16:21:06.150692+10,8,0,126,partially correct
7252,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM movie_award ma, director d,person p
WHERE lower(ma.award_name) = 'bafta film award'
	AND lower(ma.category) = 'best film'
	AND lower(result)='won'
	AND ma.title = d.title
	AND ma.production_year = d.production_year
	AND d.id = p.id;
",2018-08-30 16:21:26.774735+10,8,1,343,correct
7253,"select dw.id, dw.first_name, dw.last_name
from (select p.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id = d.id and p.id = w.id
group by p.id
having count(*) >1) as dw;",2018-08-30 16:21:41.434593+10,4,0,425,partially correct
7254,"select title, production_year, first_name, last_name from (movie_award natural join director) natural join person where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won'; ",2018-08-30 16:21:47.541166+10,8,1,172,correct
7255,"select count(*)
from person
where id not in (
	select id
	from director);",2018-08-30 16:22:10.756298+10,12,1,347,correct
7256,"select w.title,w.production_year
from writer w, person p
where w.id=p.id and
      p.first_name='Kevin' and
      p.last_name='Williamson';",2018-08-30 16:22:28.511533+10,5,1,300,correct
7257,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 16:22:53.315216+10,12,1,273,correct
7258,select * from director_award da where result='nominated';,2018-08-30 16:23:13.808983+10,13,0,117,partially correct
7259,select count(*) from writer w natural join person p where p.year_born =1935;,2018-08-30 16:23:27.577601+10,1,0,194,partially correct
7260,"select movie_award.title,movie_award.production_year,first_name,last_name
from director,movie_award,person
where movie_award.title = director.title and person.id = director.id
and lower(award_name) = 'bafta film award' and lower(category) = 'best film';",2018-08-30 16:23:30.959137+10,8,0,261,partially correct
7261,"Select p.first_name,p.last_name t.id, max(t.cId) from Person p, Movie m,
(SELECT id, count(id) as cId, title from role
group by id) as t;",2018-08-30 16:23:36.83411+10,15,0,71,noninterpretable
7262,"SELECT id
FROM role r, appearance a
WHERE lower(r.title)= 'psycho' AND r.production_year=1960 AND a.title=r.title AND a.description=r.description AND a.production_year=r.production_year
GROUP BY id
HAVING COUNT(*)=1;",2018-08-30 16:23:40.816934+10,10,1,195,correct
7263,"SELECT country
FROM RESTRICTION 
WHERE title='Shakespeare in Love' AND description='M';",2018-08-30 16:23:42.3641+10,6,1,424,correct
7264,select count(w.*) from writer w natural join person p where p.year_born =1935;,2018-08-30 16:23:45.950821+10,1,0,194,noninterpretable
7265,"select title, production_year, first_name, last_name from (person natural join director) as ww where title in (
select title from movie_award where lower(award_name)='bafta film award'and lower(category) = 'best film' and lower(result)='won');",2018-08-30 16:23:53.536354+10,8,1,126,correct
7266,"select r.id from scene s, role r, appearance a 
where s.scene_no = a.scene_no 
and s.title = a.title
and s.title = r.title
and s.production_year = r.production_year
and s.production_year = a.production_year
and a.description = r.description
and lower(a.title) = 'psycho'
and a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-30 16:23:53.932987+10,10,1,183,correct
7267,"SELECT COUNT(*)
FROM movie m1
WHERE NOT EXISTS (SELECT * FROM movie m,movie_award,crew_award,director_award,writer_award,actor_award WHERE m.title=movie_award.title OR m.title=crew_award.title OR m.title=director_award.title OR m.title=writer_award.title OR m.title=actor_award.title);",2018-08-30 16:24:46.727924+10,11,0,395,partially correct
11817,"Select count(*)
from Movie
where production_3;",2018-08-31 15:32:18.021961+10,11,0,45,noninterpretable
7270,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS
( SELECT m.title , m.production_year FROM movie_award m WHERE m.result=""won"" 
AND m.title=movie.title AND m.production_year=movie.production_year 
UNION
SELECT c.title, c.production_year FROM crew_award c WHERE c.result=""won"" 
AND c.title=movie.title AND c.production_year= movie.production_year
UNION
 SELECT d.title, d.production_year FROM director_award d WHERE d.result=""won"" 
 AND d.title=movie.title AND d.production_year= movie.production_year
UNION
 SELECT w.title,w.production_year FROM writer_award w WHERE w.result=""won"" 
 AND w.title=movie.title AND w.production_year= movie.production_year
UNION
 SELECT a.title, a.production_year FROM actor_award a WHERE a.result=""won"" 
 AND a.title=movie.title AND a.production_year= movie.production_year); ",2018-08-30 16:25:09.858404+10,11,0,382,partially correct
7271,"SELECT count(*)
FROM movies m
WHERE; ",2018-08-30 16:25:10.46299+10,11,0,410,noninterpretable
7272,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS
( SELECT m.title , m.production_year FROM movie_award m WHERE m.result=""won"" 
AND m.title=movie.title AND m.production_year=movie.production_year 
UNION
SELECT c.title, c.production_year FROM crew_award c WHERE c.result=""won"" 
AND c.title=movie.title AND c.production_year= movie.production_year
UNION
 SELECT d.title, d.production_year FROM director_award d WHERE d.result=""won"" 
 AND d.title=movie.title AND d.production_year= movie.production_year
UNION
 SELECT w.title,w.production_year FROM writer_award w WHERE w.result=""won"" 
 AND w.title=movie.title AND w.production_year= movie.production_year
UNION
 SELECT a.title, a.production_year FROM actor_award a WHERE a.result=""won"" 
 AND a.title=movie.title AND a.production_year= movie.production_year); ",2018-08-30 16:25:18.878171+10,11,0,382,partially correct
7273,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 16:25:52.097904+10,11,1,395,correct
7274,"select id, first_name, last_name
from (person natural join director natural join writer) as pwd
group by id having count(*) = 2;",2018-08-30 16:26:16.321567+10,4,0,347,partially correct
7275,"select a.title, a.production_year, a.first_name, a.last_name from (movie natural join person natural join movie_award) as a
where a.award_name = 'BAFTA Film Award' and a.category = 'Best Film' and a.result = 'Won';",2018-08-30 16:26:37.899516+10,8,0,371,partially correct
7276,"select id, first_name, last_name
from (person natural join director natural join writer) as pwd
group by id having count(*) > 1;",2018-08-30 16:26:39.971687+10,4,1,347,correct
7277,;,2018-08-30 16:26:46.26917+10,15,0,249,noninterpretable
7278,"select count(*)
from person per
natural join writer
natural join Writer_Award wa
where wa.year_of_award >= 1991
and wa.year_of_award <= 1995
and wa.result = 'won'
and per.first_name = 'Woody'
and per.last_name = 'Allen';",2018-08-30 16:26:51.395474+10,9,1,358,correct
7279,"





;
",2018-08-30 16:27:01.02029+10,15,0,387,noninterpretable
7280,"select movie_award.title,movie_award.production_year,first_name,last_name
from director,movie_award,person
where movie_award.title = director.title and person.id = director.id
and lower(award_name) = 'bafta film award' and lower(category) = 'best film'and lower(result)='won';",2018-08-30 16:27:07.038381+10,8,1,261,correct
7281,;,2018-08-30 16:27:10.918404+10,11,0,183,noninterpretable
7282,"select dw.id, p.first_name, p.last_name
from director natural join writer as dw, person p
where dw.id=p.id
group by dw.id
having count (dw.id)>=2;",2018-08-30 16:27:31.691238+10,4,1,273,correct
7283,"select w.title, w.production_year
from person p, writer w
where p.id = w.id and p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-30 16:27:36.023755+10,5,1,425,correct
7284,select count(distinct w.id) from writer w natural join person p where p.year_born = 1935;,2018-08-30 16:27:44.727397+10,1,1,194,correct
7285,"SELECT p.id,p.first_name,p.last_name
FROM
	(SELECT w.id,count(*)
	FROM writer w, director d
	WHERE w.id = d.id
	GROUP BY w.id
	having count(*)>1) as wd,
	person p
where p.id=wd.id;",2018-08-30 16:27:53.449411+10,4,0,132,partially correct
7286,"select 
	d.id, da.award_name,da.year_of_award, da.category
from director d,  director_award da
where d.title=da.title and da.category='nominated'

;",2018-08-30 16:28:17.971395+10,13,0,48,partially correct
7287,"SELECT id,first_name, last_name
FROM person
WHERE person.year_born = (SELECT MAX(year_born) AS my FROM person);",2018-08-30 16:28:55.900158+10,7,1,148,correct
7288,"select count(*)
from writer_award wa natural join writer w natural join person p
where lower(p.first_name) ='woody' and
lower(p.last_name) ='allen' and
year_of_award in (1991,1992,1993,1994,1995)
;
",2018-08-30 16:29:00.889976+10,9,0,396,partially correct
7289,select count(*) from writer_award where id = (select id from person where lower(first_name) = 'woody' and lower(last_name) = 'allen');,2018-08-30 16:29:06.053305+10,9,0,126,partially correct
7290,"SELECT id, award_name, year_of_award, category
FROM DIRECTOR d NATURAL JOIN DIRECTOR_AWARD da
WHERE NOT EXISTS (SELECT * FROM DIRECTOR_AWARD da WHERE da.result = 'WON');",2018-08-30 16:29:07.442643+10,13,0,191,partially correct
7291,"select id, d.award_name, d.year_of_award, d.category
from director, director_award d
where lower(result)='nominated'
and d.title=director.title
and d.production_year=director.production_year
and id not in (select id
from director, director_award d
where lower(result)='won'
and d.title=director.title
and d.production_year=director.production_year);",2018-08-30 16:29:18.054879+10,13,1,197,correct
7292,"select first_name, last_name
from person
where exists(select  count(*) from writer where writer.id = person.id);",2018-08-30 16:29:38.503934+10,4,0,225,partially correct
7293,"select count(*)
from writer_award wa natural join writer w natural join person p
where lower(p.first_name) ='woody' and
lower(p.last_name) ='allen' and
year_of_award in (1991,1992,1993,1994,1995) and
result = 'won'
;
",2018-08-30 16:29:43.941516+10,9,1,396,correct
7294,"select title, production_year
from writer
where id = (
	select id
	from person
	where lower(first_name) = lower('Kevin') and lower(last_name) = lower('Williamson'));",2018-08-30 16:29:45.981182+10,5,1,347,correct
7295,"SELECT p.id, MAX(p.year_born) 
FROM person p, (SELECT id, MAX(year_born) AS youngest_age
                FROM person
                GROUP BY id) AS h 
WHERE h.id=p.id
group by p.id
HAVING max(p.year_born)> (SELECT MAX(year_born)
                          FROM person
				   GROUP BY id);

",2018-08-30 16:30:12.563873+10,3,0,227,partially correct
7296,"WITH h AS (
SELECT title,production_year,description
FROM appearance
WHERE lower(title) = 'psycho' AND production_year = '1960'
GROUP BY title,production_year,description
HAVING COUNT(*) =1)

SELECT id
FROM role natural join h;",2018-08-30 16:30:23.98012+10,10,1,106,correct
7297,"select production_year, count(*) from movie where production_year in (1991, 1992, 1993)
group by production_year;",2018-08-30 16:30:39.728605+10,2,1,194,correct
7298,select count(*) from (writer_award natural join person) pw where pw.year_of_award > 1990 and pw.year_of_award < 1996 and pw.first_name = 'Woody' and pw.last_name = 'Allen';,2018-08-30 16:30:59.585515+10,9,0,172,partially correct
7299,"select w.title,w.production_year
from writer w, person p
where w.id=p.id
         and lower (p.first_name)='kevin'
         and lower(p.last_name)='williamson';",2018-08-30 16:31:43.424945+10,5,1,273,correct
7300,"select a.title, a.production_year, a.first_name, a.last_name from (director natural join person natural join movie_award) as a
where a.award_name = 'BAFTA Film Award' and a.category = 'best film' and a.result = 'won';",2018-08-30 16:31:49.408417+10,8,1,371,correct
7301,select count(*) from (writer_award natural join person) pw where pw.year_of_award > 1990 and pw.year_of_award < 1996 and pw.first_name = 'Woody' and pw.last_name = 'Allen' and pw.result = 'won';,2018-08-30 16:32:11.3994+10,9,1,172,correct
7302,"select count(*) from
writer_award as wa , person as p ,  writer as w  where wa.id = p.id and wa.production_year = w.production_year
and w.id = p.id and lower (p.first_name)= 'woody' and lower(p.last_name)= 'allan' and wa.year_of_award <= 1995
and wa.year_of_award >= 1991 and lower (result) = 'won';",2018-08-30 16:32:24.399251+10,9,0,400,partially correct
7303,"select country
from restriction
where lower(title) = lower('Shakespeare in Love') and lower(description) = 'm';",2018-08-30 16:32:51.686914+10,6,1,347,correct
7304,"SELECT p.id,p.first_name,p.last_name
FROM(
	SELECT w.id,count(*)
	FROM writer w natural join director d
	WHERE w.id = d.id
	GROUP BY w.id
	having count(*)>1) as wd
	, person p
where p.id=wd.id;
",2018-08-30 16:33:10.062051+10,4,1,132,correct
7305,"Select Count(distinct p.id) from
Director d
Left Join
Person p
on d.id = p.id;
",2018-08-30 16:33:32.07663+10,12,0,71,partially correct
7306,"select d.id,da.award_name,da.year_of_award,da.category from director d,director_award da where d.title=da.title and d.production_year=da.production_year and da.result='nominated';",2018-08-30 16:33:38.86467+10,13,1,117,correct
7307,"select r.country
from restriction r
where lower(r.title)='shakespeare in love'
         and lower(r. description) ='m';",2018-08-30 16:33:47.064098+10,6,1,273,correct
7308,"select country from restriction
where lower(title) = 'shakespeare in love'
and lower(description) = 'm';",2018-08-30 16:33:52.642826+10,6,1,405,correct
7309,"select id, first_name, last_name
from person
where year_born = (
	select max(year_born)
	from person);",2018-08-30 16:35:01.254093+10,7,1,347,correct
7310,"select id,first_name, last_name
from person
where person.year_born=(select max(year_born) from person);",2018-08-30 16:35:06.651454+10,7,1,273,correct
7311,"SELECT p1.id
FROM p1
WHERE
((SELECT p.year_born,p.id
FROM person p
EXCEPT
(SELECT max(p.year_born) FROM p))) AS p1;",2018-08-30 16:35:18.672852+10,3,0,395,noninterpretable
7312,"select count(*) 
from movie m
where not exists (
select title, production_year from movie_award ma 
where lower(ma.result) = 'won' and ma.title = m. title and m.production_year = ma.production_year
union
select title, production_year from crew_award ca 
where lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
union
select title, production_year from director_award da
where lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
union
select title, production_year from writer_award wa
where lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
union
select title, production_year from actor_award aa
where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);",2018-08-30 16:35:37.415455+10,11,1,183,correct
7313,"select id, first_name, last_name from person order by year_born desc limit 1;",2018-08-30 16:35:57.954156+10,7,1,405,correct
7314,"SELECT id, first_name, last_name
FROM person p
WHERE year_born
< ANY (SELECT year_born from p);",2018-08-30 16:36:03.913507+10,7,0,424,noninterpretable
7315,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 16:36:08.717562+10,3,1,395,correct
7316,"select count(*) from writer_award where id = (select id from person where lower(first_name) = 'woody' and lower(last_name) = 'allen')
and year_of_award between 1991 and 1995 and lower(result) = 'won';",2018-08-30 16:36:23.37328+10,9,1,126,correct
7317,"select first_name, last_name, role.*
from person natural join role
where id = 
(
select id
from
	(select count(*) as number,*
	from role natural join person
	group by id
	order by number desc
	limit 1) as result




)


;
",2018-08-30 16:36:58.564651+10,15,0,387,partially correct
7318,"select first_name, last_name, title,production_year,description
from person natural join role
where id = 
(
select id
from
	(select count(*) as number,*
	from role natural join person
	group by id
	order by number desc
	limit 1) as result




)


;
",2018-08-30 16:37:27.187812+10,15,1,387,correct
7319,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT *
	FROM director d
	WHERE p.id/d.id);",2018-08-30 16:37:32.381368+10,12,0,421,partially correct
7320,select count(*) from person where id not in (select id from director);,2018-08-30 16:37:42.127605+10,12,1,194,correct
7321,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT *
	FROM director d
	WHERE p.id=d.id);",2018-08-30 16:38:13.460328+10,12,1,421,correct
7322,"select count(*) as number_of_award
from writer_award wa , person p ,  writer w  
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id and w.id= p.id  and 
lower(p.first_name) = 'woody' and lower(p.last_name)= 'allan' and lower(wa.result) = 'won' and wa.production_year > 1990
and wa.production_year < 1996;",2018-08-30 16:38:28.491323+10,9,0,400,partially correct
7323,select * from movie;,2018-08-30 16:38:39.990703+10,11,0,117,partially correct
7324,"select id
from person per
natural join crew
natural join movie mov
where mov.title = 'Psycho'
and mov.production_year = 1960;
",2018-08-30 16:39:02.784619+10,10,0,358,partially correct
7325,select count(*) from (writer_award natural join writer natural join person) as a where a.first_name = 'Woody' and a.last_name = 'Allen' and a.year_of_award > 1990 and a.year_of_award > 1996;,2018-08-30 16:39:12.71957+10,9,0,371,partially correct
7326,"Select Count(id) from Person p
where not exists(Select id from Director d
where p.id = d.id );",2018-08-30 16:39:19.355984+10,12,1,71,correct
7327,"select p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id=d.id and d.title=ma.title and d.production_year=ma.production_year and lower(ma.award_name)='bafta film award' and lower(ma.category)='best film' and lower(ma.result)='won';",2018-08-30 16:39:41.126031+10,8,0,273,partially correct
7328,"SELECT count(*) FROM person p
WHERE p.id in (SELECT w.id from writer w);",2018-08-30 16:40:11.49486+10,1,0,374,partially correct
7329,"select country
from restriction_category
where description = 'M';",2018-08-30 16:40:16.993643+10,6,0,425,partially correct
7330,"select title, production_year, first_name, last_name
from (person natural join director natural join movie_award)
where lower(award_name) = lower('BAFTA Film Award') and
      lower(category) = lower('Best Film') and
	 lower(result) = 'won';",2018-08-30 16:40:47.891994+10,8,1,347,correct
7331,"select ma.title, ma.production_year,p.first_name, p.last_name
from person p, director d, movie_award ma
where p.id=d.id and d.title=ma.title and d.production_year=ma.production_year and lower(ma.award_name)='bafta film award' and lower(ma.category)='best film' and lower(ma.result)='won';",2018-08-30 16:40:59.505497+10,8,1,273,correct
7332,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 16:41:09.305992+10,11,1,117,correct
7333,"select title, production_year, first_name, last_name from Movie_Award natural join director natural join person
where lower(award_name) = 'bafta film award'
and lower(category) = 'best film'
and lower(result) = 'won'
;",2018-08-30 16:41:12.866066+10,8,1,405,correct
7415,"select m.title, m.production_year,p.first_name, p.last_name
from director d, (select *
from movie_award
where lower(award_name) = ""bafta film award"" and lower(category) = ""best film"") as m,
person p
where m.title = d.title and p.id = d.id;",2018-08-30 17:03:42.643551+10,8,0,425,partially correct
7334,"SELECT Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name
FROM Movie_Award, director, person
WHERE Movie_Award.title = director.title AND director.id = person.id
       AND lower(award_name) = 'BAFTA Film Award'
        AND lower(result) = 'won'
        AND lower(category) = 'Best Film';",2018-08-30 16:41:27.299607+10,8,0,148,partially correct
7335,"select country
from restriction
where lower(title) = 'shakespeare in love' and description = 'M';",2018-08-30 16:41:28.821068+10,6,1,425,correct
7336,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 16:41:31.633411+10,13,1,48,correct
7337,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id = d.id);",2018-08-30 16:41:32.786456+10,12,1,50,correct
7338,"select count(*) 

from (writer_award natural join writer natural join person) as a 

where a.first_name = 'Woody' and a.last_name = 'Allen' and a.year_of_award > 1990 and a.year_of_award < 1996 and a.result = 'won';",2018-08-30 16:41:46.739981+10,9,1,371,correct
7339,"SELECT id
FROM role, (SELECT title, production_year, description
FROM appearance
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY scene_no HAVING COUNT(*)=1) AS a
WHERE role.title = a.title
AND role.production_year = a.production_year
AND role.description = a.description;",2018-08-30 16:43:40.228812+10,10,0,96,partially correct
7340,"SELECT count(*) FROM person p 
WHERE p.id in (SELECT w.id from writer w)
AND p.year_born=1935
;",2018-08-30 16:43:49.088261+10,1,1,374,correct
7341,"SELECT ra.id
FROM (role NATURAL JOIN appearance) AS ra
WHERE lower(ra.title) = 'psycho' AND ra.production_year = 1960
GROUP BY ra.id
Having COUNT(ra.scene_no) = 1;",2018-08-30 16:43:56.99746+10,10,1,343,correct
7342,"Select w.id from
Director d
inner join
Writer w
on d.title = w.title and w.production_year = d.production_year
group by w.id
having Count(w.id) >1;",2018-08-30 16:44:13.783894+10,4,0,71,partially correct
7343,"select id, first_name, last_name from person where id in (
select d.id from director d inner join writer w on d.id = w.id where d.title = w.title group by d.id having count(*) > 1);",2018-08-30 16:44:54.735633+10,4,1,194,correct
7344,"Select w.id, p.first_name, p.last_name from Person p ,
Director d
inner join
Writer w
on d.title = w.title and w.production_year = d.production_year
where p.id = w.id
group by w.id
having Count(w.id) >1;",2018-08-30 16:45:08.749761+10,4,0,71,partially correct
7345,"select count(*) from
(select * from
writer_award as wa , person as p ,  writer as w  where wa.id = p.id and wa.production_year = w.production_year
and w.id = p.id and lower (p.first_name)= 'woody' and lower(p.last_name)= 'allen' and wa.year_of_award <= 1995
and wa.year_of_award >= 1991 and lower (result) = 'won');",2018-08-30 16:45:09.187365+10,9,1,400,correct
7346,"select count(*)
from writer_award
where lower(result) = 'won' and 
      year_of_award > 1990 and year_of_award < 1996 and
	 id = (
	 select id
	 from person
	 where lower(first_name) = lower('Woody')
	 and lower(last_name) = lower('Allen'));",2018-08-30 16:45:28.34497+10,9,1,347,correct
7347,"select count(*) 
from writer_award natural join person
where lower(first_name) = 'woody'
and lower(last_name) = 'allen'
and year_of_award > 1990
and year_of_award < 1996
and lower(result) = 'won' 
;",2018-08-30 16:46:35.968143+10,9,1,405,correct
7348,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 16:46:40.673873+10,8,1,349,correct
7349,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT *
                  FROM movie_award ma
		       WHERE m.title = ma.title AND m.production_year = ma.production_year AND lower(result) = 'won'
			 UNION 
			 SELECT *
                  FROM crew_award ca
		       WHERE m.title = ca.title AND m.production_year = ca.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM director_award da
		       WHERE m.title = da.title AND m.production_year = da.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM writer_award wa
		       WHERE m.title = wa.title AND m.production_year = wa.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM actor_award aa
		       WHERE m.title = aa.title AND m.production_year = aa.production_year AND lower(result) = 'won');",2018-08-30 16:46:45.347915+10,11,0,106,noninterpretable
7350,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 16:46:48.914772+10,8,1,349,correct
7351,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT *
                  FROM movie_award ma
		       WHERE m.title = ma.title AND m.production_year = ma.production_year AND lower(result) = 'won'
			 UNION 
			 SELECT *
                  FROM crew_award ca
		       WHERE m.title = ca.title AND m.production_year = ca.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM director_award da
		       WHERE m.title = da.title AND m.production_year = da.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM writer_award wa
		       WHERE m.title = wa.title AND m.production_year = wa.production_year AND lower(result) = 'won'
			 UNION
			 SELECT *
                  FROM actor_award aa
		       WHERE m.title = aa.title AND m.production_year = aa.production_year AND lower(result) = 'won');",2018-08-30 16:46:52.126958+10,11,0,106,noninterpretable
7352,"select count(*)
from writer_award wa,writer w, person p
where p.id=w.id
 and w.title=wa.title and w.production_year= wa.production_year
 and lower(p.first_name)='woody' and lower(p.last_name)='allen'
 and wa.year_of_award>1990
 and wa.year_of_award<1996;",2018-08-30 16:46:56.553272+10,9,0,273,partially correct
7353,"select count(*) 
from writer_award natural join person natural join writer
where lower(first_name) = 'woody'
and lower(last_name) = 'allen'
and year_of_award > 1990
and year_of_award < 1996
and lower(result) = 'won' 
;",2018-08-30 16:47:23.643294+10,9,1,405,correct
7354,"SELECT UNIQUE id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT *
	FROM director d, writer w
	WHERE d.id=w.id
	AND count(*)>1);",2018-08-30 16:47:29.579682+10,4,0,421,noninterpretable
7355,"select m.id, m.first_name, m.last_name
from (select min(year_born), id, first_name, last_name from person) as m;
",2018-08-30 16:47:56.765524+10,7,0,425,partially correct
7356,"select m.id, m.first_name, m.last_name
from (select min(year_born), id, first_name, last_name from person) as m;
",2018-08-30 16:48:05.407597+10,7,0,425,partially correct
7357,"select w.title from writer w natural join person p
where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-30 16:48:09.22781+10,5,0,194,partially correct
7358,"select count(*) as noofaward
from writer_award wa,writer w, person p
where p.id=w.id and w.id=wa.id
 and w.title=wa.title and w.production_year= wa.production_year
 and lower(p.first_name)='woody' and lower(p.last_name)='allen'
 and wa.year_of_award>1990
 and wa.year_of_award<1996;",2018-08-30 16:48:15.0985+10,9,0,273,partially correct
7359,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT title,production_year
                  FROM movie_award ma
		       WHERE m.title = ma.title AND m.production_year = ma.production_year AND lower(result) = 'won'
			 UNION 
			 SELECT title,production_year
                  FROM crew_award ca
		       WHERE m.title = ca.title AND m.production_year = ca.production_year AND lower(result) = 'won'
			 UNION
			 SELECT title,production_year
                  FROM director_award da
		       WHERE m.title = da.title AND m.production_year = da.production_year AND lower(result) = 'won'
			 UNION
			 SELECT title,production_year
                  FROM writer_award wa
		       WHERE m.title = wa.title AND m.production_year = wa.production_year AND lower(result) = 'won'
			 UNION
			 SELECT title,production_year
                  FROM actor_award aa
		       WHERE m.title = aa.title AND m.production_year = aa.production_year AND lower(result) = 'won');",2018-08-30 16:48:25.985757+10,11,1,106,correct
7360,"select w.title from writer w natural join person p
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-30 16:48:27.156318+10,5,0,194,partially correct
7361,"SELECT title, production_year, first_name, last_name
FROM (movie_award NATURAL JOIN person NATURAL JOIN director)
WHERE award_name='BAFTA Film Award' AND category='Best Film';",2018-08-30 16:48:36.861758+10,8,0,424,partially correct
7362,select person.id from person left join director group by person.id;,2018-08-30 16:48:47.583708+10,12,0,399,partially correct
7363,"select m.id, m.first_name, m.last_name
from (select max(year_born), id, first_name, last_name from person) as m;
",2018-08-30 16:48:49.75141+10,7,1,425,correct
7364,"select count(*) as noofaward
from writer_award wa,writer w, person p
where p.id=w.id and w.id=wa.id
 and w.title=wa.title and w.production_year= wa.production_year
 and lower(p.first_name)='woody' and lower(p.last_name)='allen'
 and lower(wa.result)='won'
 and wa.year_of_award>1990
 and wa.year_of_award<1996;",2018-08-30 16:48:57.109218+10,9,1,273,correct
7365,"SELECT first_name, last_name, title, production_year, description FROM
	(SELECT rp.id,rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description, COUNT(*) as num
	FROM (ROLE r NATURAL JOIN PERSON p) rp GROUP BY rp.id)
WHERE num = (SELECT MAX(num) FROM
	(SELECT rp.id,rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description, COUNT(*) as num
	FROM (ROLE r NATURAL JOIN PERSON p) rp GROUP BY rp.id))
;",2018-08-30 16:49:03.283149+10,15,0,388,partially correct
7366,"select id
from (role natural join appearance) as ra
where lower(title) = lower('Psycho') and 
      production_year = 1960
group by id having count(*) = 1;",2018-08-30 16:49:13.75516+10,10,1,347,correct
7367,"SELECT production_year ,count(*) from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-30 16:49:18.896166+10,2,1,374,correct
7368,"select count(*) from 
(

	select  title,production_year from Movie 
  	EXCEPT
	select * from (
		select title,production_year from Movie_Award where lower(result)='won'
		UNION
		select title,production_year from Crew_Award where lower(result)='won'
		UNION
		select title,production_year from Director_Award where lower(result)='won'
		UNION
		select title,production_year from Writer_Award where lower(result)='won'
		UNION
		select title,production_year from Actor_Award where lower(result)='won'
	) as bbb
	
)
AS M;",2018-08-30 16:49:43.503645+10,11,1,202,correct
7369,"select 
	p.id
from 
	person p, 
	director d,
	writer w
where 
	p.id=d.id
	or p.id=w.id
	and id= (
	select
	max(id) from director);",2018-08-30 16:49:53.750353+10,14,0,48,noninterpretable
7370,"select title, production_year from movie where title in (
select w.title from writer w natural join person p
where p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-30 16:49:57.855794+10,5,1,194,correct
7371,"SELECT id, first_name, last_name
FROM (PERSON p NATURAL JOIN DIRECTOR d NATURAL JOIN WRITER w)
GROUP BY id
HAVING COUNT(*) > 1;",2018-08-30 16:50:02.832133+10,4,1,50,correct
7372,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 16:50:03.47875+10,15,1,388,correct
7373,select id from (appearance natural join role)  where lower(title) = 'psycho' and production_year = 1960  group by id having count(*) = 1;,2018-08-30 16:50:07.627046+10,10,1,172,correct
7374,"select count(*)
from (

	select distinct id
	from person natural join writer
	where year_born = 1935

);",2018-08-30 16:50:29.742466+10,1,1,387,correct
7375,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-30 16:51:03.505104+10,4,1,421,correct
7376,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-30 16:51:36.668261+10,6,1,194,correct
7377,"SELECT count(*) from person
where person.id not in (
select director.id from director

);",2018-08-30 16:51:46.749314+10,12,1,374,correct
7378,"select count(*) from Movie m
where not exists(
select * from Movie_Award a where
    lower(a.result)='won' and a.title=m.title and a.production_year=m.production_year )
and not exists(
 select * from Crew_Award b where
 lower(b.result)='won' and b.title=m.title and b.production_year=m.production_year )
and not exists( select * from director_award c where
 lower(c.result)='won' and c.title=m.title and c.production_year=m.production_year )
and not exists( select * from writer_award d where
 lower(d.result)='won' and d.title=m.title and d.production_year=m.production_year) 
and not exists( select * from actor_award e where
 lower(e.result)='won' and e.title=m.title and e.production_year=m.production_year 
);",2018-08-30 16:52:12.374155+10,11,1,205,correct
7379,"SELECT count (*) FROM writer JOIN person ON (person.year_born = 1935);
",2018-08-30 16:52:26.952966+10,1,0,213,partially correct
7380,select count(*) from person p where not exists (select * from director d where p.id = d.id);,2018-08-30 16:52:29.450355+10,12,1,399,correct
7381,"select id
from appearance natural join role
where lower(title) = 'psycho'
and production_year = 1960
group by id
having count(*) = 1 
;",2018-08-30 16:52:31.145487+10,10,1,405,correct
7382,"select id from person
where year_born = (
select max(year_born)
from person
where year_born < (
select max(year_born) from person 
));",2018-08-30 16:52:32.802158+10,3,1,378,correct
7383,"select title, production_year, first_name, last_name
from director natural join person natural join movie natural join movie_award
where award_name = 'BAFTA Film Award' and lower(category) = 'best film' and lower(result) = 'won'; ",2018-08-30 16:52:40.038885+10,8,1,66,correct
7384,"select id, first_name, last_name from person where year_born in (
select min(year_born) from person);",2018-08-30 16:53:16.943998+10,7,0,194,partially correct
7385,"select id
from(
select id, count(id) as count
from (
 select id, title, production_year from writer w 
 union
 select id, title, production_year from director d) 
group by id)
where count = (select max(count) 
from(
select id, count(id) as count
from (
 select id, title, production_year from writer w 
 union
 select id, title, production_year from director d) 
group by id))
;
",2018-08-30 16:53:43.30564+10,14,1,99,correct
7386,"SELECT a.id, MAX (a.year_born)
FROM (SELECT b.id ,b.year_born FROM person b WHERE NOT EXISTS (SELECT c.id, MAX(c.year_born) FROM person c )) a
;
",2018-08-30 16:53:55.574375+10,3,0,382,partially correct
7416,"select m.title, m.production_year, p.first_name, p.last_name from movie_award m inner join director d on m.title = d.title
inner join person p on d.id = p.id 
where m.award_name = 'BAFTA Film Award' and m.category = 'best film' and result = 'won';",2018-08-30 17:04:03.142271+10,8,1,194,correct
7387,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 16:54:33.364965+10,14,1,48,correct
7388,"SELECT b.id
FROM (role NATURAL JOIN appearance) as b
WHERE lower (b.title) = 'psycho'
AND b.production_year = 1960
GROUP BY b.id
HAVING COUNT(*)=1;",2018-08-30 16:54:41.362255+10,10,1,96,correct
7389,"select count(*)
from movie
where (title, production_year) not in (
	select title, production_year
	from movie_award
	where lower(result) = 'won'
	union
	select title, production_year
	from Crew_award
	where lower(result) = 'won'
	union
	select title, production_year
	from Director_award
	where lower(result) = 'won'
	union
	select title, production_year
	from Writer_award
	where lower(result) = 'won'
	union
	select title, production_year
	from Actor_award
	where lower(result) = 'won');",2018-08-30 16:54:41.533891+10,11,1,347,correct
7390,"select id, first_name, last_name, year_born from person where year_born in (
select max(year_born) from person);",2018-08-30 16:55:14.606166+10,7,0,194,partially correct
7391,"select id, first_name, last_name from person where year_born in (
select max(year_born) from person);",2018-08-30 16:55:25.220859+10,7,1,194,correct
7392,select * from movie;,2018-08-30 16:55:47.037671+10,14,0,117,partially correct
7393,"select count(*)
from 
(
	select ww.id, ww.title, ww.production_year
	from (select *
	from writer_award 
	where year_of_award<'1995' and year_of_award>'1991' and result='won') as ww,
	writer as wr, person as pr
	where pr.id=wr.id
	and pr.first_name='Woody'
	and pr.last_name='Allen'
	and wr.id=ww.id
	and wr.title=ww.title
	and wr.production_year=ww.production_year
);",2018-08-30 16:56:14.843738+10,9,0,349,partially correct
7394,"select production_year, count(*) as number
from movie

group by production_year

having production_year >= 1991 and production_year <= 1993

;",2018-08-30 16:56:44.798295+10,2,1,387,correct
7395,"select p.id 
from person p, appearance a, role r, movie m
where a.title = r.title 
and r.title = m.title
and lower(m.title)= 'psycho'
and a.production_year = r.production_year
and r.production_year = m.production_year
and a.scene_no = 1
and r.id = p.id
and a.description = r.description ;",2018-08-30 16:57:11.898534+10,10,0,400,partially correct
7396,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born)
                      FROM person
			     WHERE year_born < (SELECT MAX(year_born)
                                         FROM person));",2018-08-30 16:57:31.473708+10,3,1,106,correct
7397,"SELECT count(*)
FROM MOVIE 
WHERE Exits(SELECT * FROM production_year p WHERE p= 1993);

",2018-08-30 16:57:44.571015+10,2,0,352,noninterpretable
7398,"select a.id 

from (scene natural join appearance natural join role) as a 

where a.title = 'Psycho' and a.production_year = 1960 

group by a.scene_no 

having count(*) = 1;",2018-08-30 16:58:05.76503+10,10,0,371,partially correct
7399,"select count(*)
from writer_award natural join writer natural join person
where first_name = 'Woody' and last_name = 'Allen' and year_of_award >= 1991 and year_of_award <= 1995 and lower(result)='won';",2018-08-30 16:58:47.787186+10,9,1,66,correct
7400,"select count(*) as number_of_award
from writer_award wa,
writer w,
person p
where wa.title=w.title
and wa.production_year=w.production_year
and wa.id=w.id
and w.id=p.id
and lower(wa.result)='won'
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award<='1995'
and wa.year_of_award>='1991';",2018-08-30 16:59:13.552684+10,9,1,349,correct
7401,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 16:59:14.21961+10,10,1,400,correct
7402,"select title, production_year from movie

EXCEPT

select title, production_year from

(select title, production_year from movie_award

union

select title, production_year from director_award

union

select title, production_year from writer_award

union

select title, production_year from actor_award)


;",2018-08-30 16:59:45.853136+10,11,0,405,partially correct
7403,"select id
from person
where year_born = (
	select max(year_born)
	from person
	where year_born <
	      (select max(year_born)
		  from person));",2018-08-30 17:00:51.21274+10,3,1,347,correct
7404,"SELECT id,award_name,year_of_award, category
FROM director d,director_award a
WHERE d.title=a.title AND d.production_year=a.production_year AND a.result='nominated';",2018-08-30 17:00:57.98614+10,13,1,395,correct
7405,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;

",2018-08-30 17:00:59.981642+10,2,1,352,correct
7406,"select title, production_year from movie

EXCEPT

select title, production_year from

(select title, production_year from movie_award

union

select title, production_year from director_award

union

select title, production_year from writer_award

union

select title, production_year from actor_award

union

select title, production_year from crew_award)


;",2018-08-30 17:01:10.146568+10,11,0,405,partially correct
7407,"select r.id
from scene s, appearance k, role r
where s.title=r.title and r.title=k.title
   and r. production_year= k.production_year
   and s.production_year=r.production_year
   and s.scene_no=k.scene_no
  and lower(r.title)='psycho'
  and r.production_year=1960
  and r.description=k.description
group by r.id
having count (*)=1;",2018-08-30 17:01:20.96896+10,10,1,273,correct
7408,"select distinct id from person
where id in(select id from(
select id, max(largest) from(select id, count(*) as largest from director
group by id)
union
select id, max(largest) from(select id, count(*) as largest from writer
group by id
)));
",2018-08-30 17:02:40.163776+10,14,0,197,partially correct
7409,"select id
from appearance natural join role
where lower(title) = 'psycho' and production_year = 1960 
group by id
having count (scene_no) = 1;",2018-08-30 17:02:40.307576+10,10,1,66,correct
7410,"select count (*) as number_of_award
from 
(
	select *
	from writer_award
	where year_of_award>='1991' and year_of_award<='1995' and lower(result)='won'
) wa, person p, writer w
where wa.title=w.title
and wa.production_year=w.production_year
and wa.id=w.id
and w.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen';",2018-08-30 17:03:04.172963+10,9,1,349,correct
7411,"select m.title, m.production_year, p.first_name, p.last_name from movie_award m inner join director d on m.title = d.title
inner join person p on d.id = p.id 
where m.award_name = 'BAFTA Film Award' and m.category like '%best film%' and result = 'won';",2018-08-30 17:03:14.033495+10,8,0,194,partially correct
7412,"select count(*)
from person
where not exists(
select *
from person inner join director
on person.id =director.id

)


;",2018-08-30 17:03:25.921118+10,12,0,387,partially correct
7413,"select count(*) from movie m where not exists(select title,production_year from movie_award ma where m.title=ma.title and m.production_year=ma.production_year and lower(ma.result)='won' union select title,production_year from crew_award c where m.title=c.title and m.production_year=c.production_year and lower(c.result)='won' union select title,production_year from director_award d where m.title=d.title and m.production_year=d.production_year and lower(d.result)='won' union select title,production_year from writer_award w  where m.title=w.title and m.production_year=w.production_year and lower(w.result)='won' union select title,production_year from actor_award a where m.title=a.title and m.production_year=a.production_year and lower(a.result)='won');",2018-08-30 17:03:29.759385+10,11,1,317,correct
7414,"Select * from person
where year_born = 1935;",2018-08-30 17:03:37.673708+10,1,0,123,partially correct
7417,"select count(*) from 
(select title, production_year from movie

EXCEPT

select title, production_year from

(select title, production_year from movie_award
where lower(result) = 'won'

union

select title, production_year from director_award
where lower(result) = 'won'

union

select title, production_year from writer_award
where lower(result) = 'won'

union

select title, production_year from actor_award
where lower(result) = 'won'

union

select title, production_year from crew_award
where lower(result) = 'won'

))
;",2018-08-30 17:04:05.515983+10,11,1,405,correct
7418,select * from movie;,2018-08-30 17:04:06.30275+10,15,0,117,partially correct
7419,"select m.title, m.production_year, p.first_name, p.last_name from movie_award m inner join director d on m.title = d.title
inner join person p on d.id = p.id 
where m.award_name = 'BAFTA Film Award' and m.category = 'Best Film' and result = 'won';",2018-08-30 17:04:16.718434+10,8,0,194,partially correct
7420,"SELECT count(year_born)
FROM PERSON, WRITER
WHERE PERSON.id= WRITER.id and year_born=1935;",2018-08-30 17:04:32.702331+10,1,0,428,partially correct
7421,"select m.title, m.production_year, p.first_name, p.last_name from movie_award m inner join director d on m.title = d.title
inner join person p on d.id = p.id 
where m.award_name = 'BAFTA Film Award' and m.category = 'best film' and result = 'won';",2018-08-30 17:04:36.192414+10,8,1,194,correct
7422,"Select count(*) 
from writer, person
where writer.id = person.id
and person.year_born = 1935;",2018-08-30 17:05:05.647315+10,1,0,123,partially correct
7423,"SELECT COUNT(*) 
FROM writer_award wa, writer w, person p
WHERE wa.title=w.title AND wa.production_year=w.production_year AND wa.id=w.id AND lower(result)='won' AND first_name='Woody' AND last_name='Allen'
And year_of_award<1996 AND year_of_award>1990;",2018-08-30 17:05:12.620397+10,9,0,424,partially correct
7424,select count(*) from person as p where not exists (select * from director as d where p.id=d.id);,2018-08-30 17:06:16.30533+10,12,1,101,correct
7425,"select distinct WRITER.id, first_name, last_name from PERSON, WRITER
where year_born > 1935 and PERSON.id = WRITER.id;",2018-08-30 17:06:30.599592+10,1,0,390,partially correct
7426,"select m.title, m.production_year,p.first_name, p.last_name
from director d, (select *
from movie_award
where lower(award_name) = ""bafta film award"" and lower(category) = ""best film"" and result = ""won"" ) as m,
person p
where m.title = d.title and p.id = d.id;
",2018-08-30 17:06:30.760409+10,8,1,425,correct
7427,"
SELECT *
FROM Writer_Award, writer, person
WHERE Writer_Award.id = writer.id
      AND Writer_Award.title = writer.title
	  AND Writer_Award.production_year = writer.production_year
	  AND writer.id = person.id
      AND 1990 < Writer_Award.year_of_award 
	  AND Writer_Award.year_of_award< 1996
	  AND lower(Writer_Award.result) = 'won'
	  AND person.first_name = 'Woody'
	  AND person.last_name = 'Allen';
",2018-08-30 17:06:31.292255+10,9,0,148,partially correct
7428,"SELECT COUNT(*) 
FROM writer_award wa, writer w, person p
WHERE wa.title=w.title AND wa.production_year=w.production_year AND wa.id=w.id AND lower(result)='won' AND first_name='Woody' AND last_name='Allen'
And year_of_award<1996 AND year_of_award>1990 AND w.id=p.id;",2018-08-30 17:06:47.983795+10,9,1,424,correct
7429,select p.id from person p where p.year_born = (select max(year_born) from person p1 where p1.year_born < (select max(year_born) from person));,2018-08-30 17:07:25.95903+10,3,1,172,correct
7430,;,2018-08-30 17:07:26.223091+10,3,0,183,noninterpretable
7431,"select count(*) from writer_award where id in
(select id from person where first_name = 'Woody' and last_name = 'Allen') 
and year_of_award >= 1991 and year_of_award <= 1995 and result = 'won';",2018-08-30 17:07:40.307593+10,9,1,194,correct
7432,"

select count(*)
from(select id,count(*) as num
from CREW_AWARD
where lower(result)='won'
group by id
having num>1);",2018-08-30 17:08:08.840977+10,1,0,64,partially correct
7433,"SELECT COUNT(*) FROM movie WHERE NOT EXISTS
(SELECT crew_award.title, crew_award.production_year FROM crew_award
WHERE crew_award.title=movie.title AND crew_award.production_year=
movie.production_year AND lower(crew_award.result)='won'
UNION
SELECT director_award.title, director_award.production_year FROM director_award
WHERE director_award.title=movie.title AND director_award.production_year=
movie.production_year AND lower(director_award.result)='won'
UNION
SELECT writer_award.title, writer_award.production_year FROM writer_award
WHERE writer_award.title=movie.title AND writer_award.production_year=
movie.production_year AND lower(writer_award.result)='won'
UNION
SELECT actor_award.title, actor_award.production_year FROM actor_award
WHERE actor_award.title=movie.title AND actor_award.production_year=
movie.production_year AND lower(actor_award.result)='won'
UNION
SELECT movie_award.title, movie_award.production_year FROM movie_award
WHERE movie_award.title=movie.title AND movie_award.production_year=
movie.production_year AND lower(movie_award.result)='won');",2018-08-30 17:08:14.691634+10,11,1,288,correct
7434,"SELECT DISTINCT COUNT(*) AS total_number
FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE m.title=ma.title AND m.production_year=ma.production_year AND lower(ma.result)='won'
AND m.title=ca.title AND m.production_year=ca.production_year AND lower(ca.result)='won'
AND m.title=da.title AND m.production_year=da.production_year AND lower(da.result)='won'
AND m.title=wa.title AND m.production_year=wa.production_year AND lower(wa.result)='won'
AND m.title=aa.title AND m.production_year=aa.production_year AND lower(aa.result)='won';",2018-08-30 17:08:25.576045+10,11,0,96,partially correct
7435,select id from person where year_born in (select year_born from person group by year_born order by year_born desc limit 1 offset 1);,2018-08-30 17:08:29.410225+10,3,1,405,correct
7436,"select r.id 

from scene s, appearance a, role r

where a.title = 'Psycho' and a.production_year = 1960 and a.scene_no = s.scene_no 

group by r.id 

having count(*) = 1;",2018-08-30 17:08:36.020077+10,10,0,371,partially correct
7437,"select ids,fname,lname from

(select p.id as ids ,first_name as fname,last_name  as lname,count(*) as number
from person p inner join director d on d.id=p.id 
   inner join writer w on w.id=p.id
group by p.id) as pp
 where number>=2;",2018-08-30 17:09:17.799026+10,4,0,374,partially correct
7438,"select id from Person
where year_born=
	(
	select MAX(year_born) From 
	(select year_born from Person
	EXCEPT select MAX(year_born) FROM Person)AS M);
",2018-08-30 17:09:25.809773+10,3,1,202,correct
7439,"select count(*)
from writer_award
where writer_award.id = 
(
select person.id
from person
where lower(first_name)='woody'and lower(last_name)='allen'
)
and result = 'won'and year_of_award >= 1991 and year_of_award <= 1995;
",2018-08-30 17:09:36.16624+10,9,1,261,correct
7440,"SELECT p.id
FROM person p
WHERE p.year_born = (
	SELECT max(year_born)
	FROM person P 
	WHERE P.year_born<(
			SELECT max(year_born)
			FROM person
		)
);",2018-08-30 17:09:37.081004+10,3,1,343,correct
7441,select p.id from person p where p.year_born = (select MAX(year_born) from person where year_born < (select MAX(year_born) from person));,2018-08-30 17:10:05.904769+10,3,1,183,correct
7442,"SELECT COUNT(DISTINCT person.id)
FROM person
INNER JOIN writer ON person.id=writer.id
WHERE person.year_born=1935;",2018-08-30 17:10:19.955922+10,1,1,221,correct
7443,"select distinct count(*) from PERSON 
where id in(
select distinct WRITER.id from PERSON, WRITER
where year_born = 1935 and PERSON.id = WRITER.id);",2018-08-30 17:10:30.461647+10,1,1,390,correct
7444,select count(person.id) from person where exists (SELECT person.id FROM writer WHERE writer.id = person.id AND person.year_born = 1935);,2018-08-30 17:10:47.986044+10,1,1,123,correct
7445,"SELECT title, production_year
FROM movie_award
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-30 17:10:50.370897+10,8,0,163,partially correct
7446,"select count(*) from movie where not exists movie.id = a.id and movie.title = a.title and movie.production_year = a.production_year
(movie right join movie_award on title and production_year where lower(result)= 'won')union
(movie right join crew_award on title and prooduction_year where lower(result) = 'won')union
(movie right join director_award on title and production_year where lower (result) = 'won')union
(movie right join writer_award on title and producton_year where lower(result) = 'won') union
(movie right join actor_award on title and production_year where lower(result) = 'won')as a ;",2018-08-30 17:11:45.767287+10,11,0,400,noninterpretable
7447,"SELECT DISTINCT wp.title, wp.production_year
FROM (writer w NATURAL JOIN person p) AS wp 
WHEN wp.first_name=Kevin AND wp.last_name=Williamson;  ",2018-08-30 17:11:56.306336+10,5,0,421,noninterpretable
7448,"select count(*) 
from movie m
where not exists(
	select ma.title, ma.production_year 
	from movie_award ma 
	where m.title = ma.title and m.production_year = ma.production_year and lower(ma.result) = 'won'
	union
	select ca.title, ca.production_year 
	from crew_award ca 
	where m.title = ca.title and m.production_year = ca.production_year and lower(ca.result) = 'won'
	union
	select da.title, da.production_year 
	from director_award da 
	where m.title = da.title and m.production_year = da.production_year and lower(da.result) = 'won'
	union
	select wa.title, wa.production_year 
	from writer_award wa 
	where m.title = wa.title and m.production_year = wa.production_year and lower(wa.result) = 'won'
	union
	select aa.title, aa.production_year 
	from actor_award aa 
	where m.title = aa.title and m.production_year = aa.production_year and lower(aa.result) = 'won'
);",2018-08-30 17:12:14.307995+10,11,1,66,correct
7449,"select count(*)
from writer w, person p
where w.id=p.id 
and p.year_born=1935;",2018-08-30 17:12:39.599125+10,1,0,272,partially correct
7450,"select id, first_name, last_name
from person
where director.title = writer.title;",2018-08-30 17:12:46.225388+10,4,0,123,noninterpretable
7451,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (
                SELECT title, production_year
			FROM movie_award ma 
			WHERE lower(ma.result) = 'won' AND ma.title = m.title AND ma.production_year = m.production_year
			UNION 
			
			SELECT title, production_year
			FROM crew_award ca
			WHERE lower(ca.result) ='won' AND ca.title = m.title AND ca.production_year = m.production_year
			UNION
			
			SELECT title, production_year
			FROM director_award da
			WHERE lower(da.result) ='won' AND da.title = m.title AND da.production_year = m.production_year
			UNION
		
			SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 17:13:06.408132+10,11,1,410,correct
7452,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 17:13:41.726909+10,11,1,400,correct
7453,select id from person p where p.year_born=(select min(year_born) from person p where p.year_born not in (select min(year_born)from person p));,2018-08-30 17:13:59.964792+10,3,0,205,partially correct
7454,"

select w.id, first_name, last_name,count(*) num
from writer w, (director natural join person) as d
where w.title = d.title and w.production_year = d.production_year and w.id =d.id
group by d.id
having num>=2

;",2018-08-30 17:14:09.107951+10,4,0,387,partially correct
7455,"select count(*) from movie where title not in(
(select distinct title from movie_award) union 
(select distinct title from crew_award) union 
(select distinct title from writer_award) union 
(select distinct title from writer_award));",2018-08-30 17:15:02.954241+10,11,0,194,noninterpretable
7456,"select id from (select id, max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-30 17:15:10.076814+10,3,1,66,correct
7457,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 17:15:18.01516+10,11,1,96,correct
7458,"select count(*) from movie where title not in(
(select distinct title from movie_award where result = 'won') union 
(select distinct title from crew_award where result = 'won') union 
(select distinct title from writer_award where result = 'won') union 
(select distinct title from writer_award where result = 'won'));",2018-08-30 17:15:53.897276+10,11,0,194,noninterpretable
7459,"select count(*)
from person p, writer w, (select *
from writer_award
where year_of_award <1996 and year_of_award > 1990 and lower(result) = ""won"" ) as wa
where w.id = wa.id and p.id = w.id
group by wa.title
having p.first_name = ""Woody"" and p.last_name = ""Allen"";
",2018-08-30 17:16:11.61396+10,9,0,425,partially correct
7460,"select count(distinct *) from movie where title not in(
(select distinct title from movie_award where result = 'won') union 
(select distinct title from crew_award where result = 'won') union 
(select distinct title from writer_award where result = 'won') union 
(select distinct title from writer_award where result = 'won'));",2018-08-30 17:16:12.657413+10,11,0,194,noninterpretable
7461,"select c.id, count (s.scene_no) as no_of_scene
		from crew c, scene s
		where c.title=s.title
		and c.production_year=s.production_year
		and c.title='Psycho'
		group by (s.scene_no) ;
",2018-08-30 17:16:36.795389+10,10,0,349,partially correct
7462,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE
w.id = p.id
AND lower(first_name)='kevin'
AND lower(last_name)='williamson';",2018-08-30 17:16:45.70816+10,5,1,421,correct
7463,"select d.id, c.award_name, c.year_of_award, c.category from director d, (select da.title, da.award_name, da.year_of_award, da.category 
from director_award da where lower(da.result) = 'nominated') c where d.title = c.title;",2018-08-30 17:16:45.887533+10,13,1,183,correct
7464,"select id,award_name, award_name, year_of_award, category from director_award natural join director as w
where id in
(select id
from director_award natural join director
where lower(result) = 'nominated')
and id not in
(
select id
from director_award natural join director
where lower(result) = 'won'
)

;",2018-08-30 17:17:23.940209+10,13,1,405,correct
7465,"SELECT COUNT (PERSON.id)
FROM WRITER INNER JOIN PERSON ON WRITER.id = PERSON.id
GROUP BY WRITER.id HAVING PERSON.year_born = 1935;",2018-08-30 17:17:33.735186+10,1,0,367,partially correct
7466,"select id,award_name, year_of_award, category from director_award natural join director as w
where id in
(select id
from director_award natural join director
where lower(result) = 'nominated')
and id not in
(
select id
from director_award natural join director
where lower(result) = 'won'
)

;",2018-08-30 17:18:00.97739+10,13,1,405,correct
7467,"select p.id, p.first_name, p.last_name
from person p 
	inner join
	(
		select w.id, count(*) num
		from writer w, director d
		where w.title = d.title and w.production_year = d.production_year and w.id =d.id
		group by d.id
		having num>=2

) as result
on p.id =result.id




;",2018-08-30 17:18:12.331267+10,4,1,387,correct
7468,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(writer.title) >= 2;",2018-08-30 17:18:32.069895+10,4,0,123,partially correct
7469,"SELECT title, production_year, first_name, last_name
FROM movie_award natural join director natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-30 17:18:34.479754+10,8,1,163,correct
7470,"select id,award_name, year_of_award, category 
from director_award natural join director as w
where lower(result) = 'nominated'
and id not in
(
select id
from director_award natural join director
where lower(result) = 'won'
)

;",2018-08-30 17:19:04.519453+10,13,1,405,correct
7471,"select id from person p 
where year_born = 
(select max(year_born) from person ) -1 ;",2018-08-30 17:19:32.969588+10,3,0,400,partially correct
7472,select id from person where year_born=1988;,2018-08-30 17:19:35.603904+10,3,0,317,cheating
7473,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(writer.title) >= 3;",2018-08-30 17:20:04.099396+10,4,1,123,correct
7474,"select r.id
from scene s,
appearance a,
role r
where s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
	group by r.id
	having count(*)=1;",2018-08-30 17:20:13.577565+10,10,1,349,correct
7475,"select m.first_name, m.last_name from 
	(select * from scene s, role r, person p
	where s.title=r.title
	and s.production_year=r.production_year
	and r.id=p.id
	and s.scene_no=1) m
	where m.production_year=1960
	and m.title='Psycho';
",2018-08-30 17:21:03.935652+10,10,0,32,partially correct
7476,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love'
AND lower(description)='m';
",2018-08-30 17:21:08.498051+10,6,1,421,correct
7477,select id from person p where p.year_born=(select max(year_born) from person p where p.year_born not in (select max(year_born)from person p));,2018-08-30 17:21:21.173605+10,3,1,205,correct
7478,"select m.production_year, count(*)
from movie m
where m.production_year < 1994 and m.production_year>1990
group by m.production_year;",2018-08-30 17:21:23.600019+10,2,1,272,correct
7479,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) >= 2;",2018-08-30 17:21:24.30625+10,4,0,123,partially correct
7480,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) >= 3;",2018-08-30 17:21:30.697603+10,4,1,123,correct
7481,"select id, award_name, year_of_award, category
from (director natural join director_award) as da
where (title, production_year) not in (
	select title, production_year
	from director_award
	where lower(result) = 'won');",2018-08-30 17:22:08.449992+10,13,1,347,correct
7482,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS 
(SELECT title, production_year
FROM movie_award ma
WHERE lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
UNION 
SELECT title, production_year
FROM crew_award ca
WHERE lower(ca.result)='won' and ca.title=m.title and ca.production_year=m.production_year
UNION 
SELECT title, production_year
FROM director_award da 
WHERE lower(da.result)='won' and da.title=m.title and da.production_year=m.production_year
UNION
SELECT title, production_year
FROM writer_award wa 
WHERE lower(wa.result)='won' and wa.title=m.title and wa.production_year=m.production_year
UNION
SELECT title, production_year
FROM actor_award aa 
WHERE lower(aa.result)='won' and aa.title=m.title and aa.production_year=m.production_year);
",2018-08-30 17:22:53.034932+10,11,1,195,correct
7483,"SELECT P*
FROM PERSON p
WHERE NOT EXISTS(SELECT*FROM MOVIE 
WHERE p.id=m.title);",2018-08-30 17:23:06.405301+10,12,0,352,noninterpretable
7484,"select id from person p 
where year_born = 
(select max(year_born) from person where year_born < (select max(year_born)from person)) ;",2018-08-30 17:23:26.262728+10,3,1,400,correct
7485,"select role.id
from role,scene
where lower(role.title)='psycho'and role.production_year = 1960 
and role.title = scene.title and scene_no=1
group by role.id;",2018-08-30 17:23:31.564816+10,10,0,261,partially correct
7486,"select p.id,p.first_name,p.last_name from person p natural join writer natural join director
group by id having count(*)>= 2;",2018-08-30 17:23:44.872412+10,4,1,209,correct
7487,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 3;",2018-08-30 17:23:47.70955+10,4,1,123,correct
7488,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 17:23:56.621331+10,4,1,123,correct
7489,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 17:23:57.441686+10,12,1,352,correct
7490,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 1;",2018-08-30 17:24:05.866893+10,4,0,123,partially correct
7491,"select person.id, first_name, last_name
from person
inner join writer on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 17:24:13.373758+10,4,1,123,correct
7492,"

SELECT production_year, count(production_year)
FROM MOVIE
WHERE production_year=1991;",2018-08-30 17:24:25.517033+10,2,0,428,partially correct
7493,"select title, production_year
from writer natural join person
where lower(first_name) = 'kevin' and lower(last_name) = 'williamson'


;",2018-08-30 17:24:40.397407+10,5,1,387,correct
7494,"select title, production_year
from writer natural join person
where lower(first_name) = 'kevin' and lower(last_name) = 'williamson'


;",2018-08-30 17:24:59.886867+10,5,1,387,correct
7495,"select count(*)
from movie m
where not exists (select ma.title,ma.production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
               union select ca.title,ca.production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won'
	        union select da.title,da.production_year from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
		union select wa.title,wa.production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
		union select aa.title,aa.production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won');",2018-08-30 17:25:04.830274+10,11,1,273,correct
7496,"SELECT person.id
FROM crew c, person p, scene s, movie m
WHERE c.id=p.id
AND c.title=m.title
AND c.production_year=m.production_year
AND s.title=m.title
AND s.production_year=m.production_year
AND title='Psycho'
AND production_year='1960';",2018-08-30 17:25:13.031644+10,10,0,424,noninterpretable
7497,"select id from person
where year_born = 1935
count;",2018-08-30 17:25:19.423234+10,1,0,276,noninterpretable
7498,"SELECT COUNT(DISTINCT title) AS number, production_year AS year
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:25:24.068698+10,2,1,221,correct
7499,"Select w.title, w.production_year from 
writer w 
inner join 
Person p
on w.id = p.id
where p.first_name like 'Kevin' and p.last_name like 'Williamson';",2018-08-30 17:25:39.221847+10,5,1,71,correct
7500,"

SELECT production_year, count(title)
FROM MOVIE
WHERE production_year=1991;",2018-08-30 17:25:45.298831+10,2,0,428,partially correct
7501,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
FROM (SELECT year_born
FROM person
EXCEPT
SELECT MAX(year_born)
FROM person)
);",2018-08-30 17:26:15.91317+10,3,1,96,correct
7502,"SELECT COUNT(DISTINCT title) AS number, production_year
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:26:22.743738+10,2,1,221,correct
7503,"SELECT id
FROM (SELECT *
		FROM PERSON
		WHERE NOT EXISTS (SELECT p.id
					FROM PERSON p
					WHERE p.year_born = (SELECT MAX(year_born)
									FROM PERSON))
	
	) 
WHERE year_born = (SELECT MAX(year_born)
				FROM PERSON);",2018-08-30 17:26:29.079426+10,3,0,177,partially correct
7504,"SELECT COUNT(DISTINCT title) AS number, production_year
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:26:39.050826+10,2,1,221,correct
7505,"SELECT COUNT(DISTINCT title), production_year
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:27:02.131092+10,2,1,221,correct
7506,"select country
from restriction
where lower(title) ='shakespeare in love' and description='M'

;",2018-08-30 17:27:10.787094+10,6,1,387,correct
7507,"select id from appearance as a 
inner join role as r on a.title=r.title and a.production_year=r.production_year and a.description=r.description
where lower(a.title)='psycho' and a.production_year=1960 group by id having count(id)=1;",2018-08-30 17:27:11.496986+10,10,1,101,correct
7508,"select person.id, first_name, last_name
from writer
inner join person on writer.id = person.id
inner join director on  person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 17:27:33.794623+10,4,1,123,correct
7509,"select id from
(select id, title, production_year from director
union 
select id, title, production_year from writer)
group by id
having count(*) = (select count(*) from
(select id, title, production_year from director
union 
select id, title, production_year from writer)
group by id
order by count(*) desc limit 1)
;",2018-08-30 17:27:41.23402+10,14,1,405,correct
7510,"select id from (select MAX(num) as max, id from (select COUNT(a.title) as num, a.id from (select id, title from (director natural join writer)) a group by a.id) b);",2018-08-30 17:27:49.839937+10,14,0,183,partially correct
7511,"select production_year, count(*) from movie
where production_year = 1993 and production_year = 1992 and production_year = 1991
group by production_year;",2018-08-30 17:28:51.839118+10,2,0,390,partially correct
7512,"select production_year, count(*) from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-30 17:29:30.571874+10,2,1,390,correct
7513,"SELECT production_year, count(*)
FROM MOVIE
WHERE production_year=1991 or production_year=1992 or production_year=1993
GROUP BY production_year;

",2018-08-30 17:30:16.837272+10,2,1,428,correct
7514,"select title,production_year from writer w where w.id in 
(select id from person where first_name='Kevin' and last_name = 'Williamson');",2018-08-30 17:30:18.090131+10,5,1,209,correct
7515,"SELECT COUNT(*), production_year
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:30:22.765058+10,2,1,221,correct
7516,"select id
from director natural join director_award x1
where lower(result) = 'nominated' and not exists (
	select da.title, da.production_year 
	from director_award da 
	where da.title = x1.title and da.production_year = x1.production_year and da.result = 'won' 
)
group by id
having count(result) > 0 ;
",2018-08-30 17:30:27.868558+10,13,0,66,partially correct
7517,"Select country from Restriction
where description like 'M' and title like 'Shakespeare in Love';
",2018-08-30 17:30:29.722062+10,6,1,71,correct
7518,"select writer.title, writer.production_year 
from writer
where writer.production_year = 'Kevin Williamson';",2018-08-30 17:30:55.4891+10,5,0,123,partially correct
7519,"select Count(*)
from Person Natural join writer
where year_born = 1935;",2018-08-30 17:31:03.201915+10,1,0,286,partially correct
7520,"select id, award_name, year_of_award, category
from director natural join director_award x1
where lower(result) = 'nominated' and not exists (
	select da.title, da.production_year 
	from director_award da 
	where da.title = x1.title and da.production_year = x1.production_year and da.result = 'won' 
)
group by id
having count(result) > 0 ;
",2018-08-30 17:31:10.066069+10,13,1,66,correct
7521,"select d.id, da.award_name, da.year_of_award, da.category
from director d inner join director_award da on title and production_year
where not exist d.title = da.title and d.production_year = da.production_year
and lower(da.result)= 'won' ;",2018-08-30 17:31:21.599968+10,13,0,400,noninterpretable
7522,"select writer.title, writer.production_year 
from writer, person
where writer.id = person.id
and person.first_name = 'Kevin'
and person.last_name = 'Williamson';",2018-08-30 17:32:29.93454+10,5,1,123,correct
7523,"select p.id,p.first_name,p.last_name
from person p
where p.year_born =(

select max(year_born)
from person


)




;
",2018-08-30 17:32:36.317695+10,7,1,387,correct
7524,"select COUNT(*) AS number_of_award
from person p, writer w, (select *
from writer_award
where year_of_award <1996 and year_of_award > 1990 and lower(result) = ""won"" ) as wa
where w.title = wa.title and p.id = w.id
group by p.first_name
having p.first_name = ""Woody"" and p.last_name = ""Allen"";

",2018-08-30 17:32:48.287586+10,9,1,425,correct
7525,"select p.id  
from person p
where p.year_born=(select max(year_born) from person where year_born<(select max(year_born) from person));",2018-08-30 17:32:49.919684+10,3,1,273,correct
7526,"Select * from person
where year_born = (Select max(year_born) from person);",2018-08-30 17:32:57.705542+10,7,0,71,partially correct
7527,"Select id, first_name, last_name from person
where year_born = (Select max(year_born) from person);",2018-08-30 17:33:19.340728+10,7,1,71,correct
7528,"select count(*) from person p, director d
where p.id != d.id;",2018-08-30 17:34:20.613252+10,12,0,390,partially correct
7529,"select first_name, last_name, title, production_year, description from role natural join person
where id =
(select id from role natural join person
group by id
having count(*) = (
select count(*) from role natural join person
group by id
order by count(*) desc limit 1));",2018-08-30 17:34:25.836822+10,15,1,405,correct
7530,"select count (*)
from person p
where exists (select * from writer w where p.id = w.id and p.year_born = 1935);",2018-08-30 17:34:37.808942+10,1,1,276,correct
7531,"select d.id, da.award_name, da.year_of_award, da.category
from director d , director_award da 
where  d.title = da.title and d.production_year = da.production_year
and lower(da.result)= 'nominated'
and d.id not in 
(select id from director d,director_award da
where d.title = da.title and d.production_year = da.production_year and
lower(result) = 'won');",2018-08-30 17:34:49.140621+10,13,1,400,correct
7558,"SELECT title, production_year
FROM WRITER LEFT JOIN PERSON ON PERSON.id = WRITER.id WHERE PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-30 17:44:49.002251+10,5,1,50,correct
7532,"select id
from (
select id, count(*) as movie_number
from (
	select id, title, production_year
	from director
	union
	select id, title, production_year
	from writer
	) as store
group by id ) as choice_table
where movie_number = (
select max(movie_number_2)
from (
select id, count(*) as movie_number_2
from(
     select id, title, production_year
	from director
	union
	select id, title, production_year
	from writer
	) as store_2
group by id) as choice_table_2);",2018-08-30 17:35:09.579075+10,14,1,347,correct
7533,"select person.id, first_name, last_name
from writer natural join person natural join director
group by person.id, first_name, last_name
having count(director.title) >= 2;",2018-08-30 17:35:25.629598+10,4,1,123,correct
7534,"select distinct id 
from role, (select title, production_year, description
from appearance
where title='Psycho'
and production_year=1960) as h
where role.title=h.title
and role.production_year=h.production_year
and role.description=h.description
group by id
having count(id)=1;",2018-08-30 17:35:31.537422+10,10,1,140,correct
7535,"SELECT  production_yearCOUNT(*)
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:35:52.529413+10,2,0,221,noninterpretable
7536,"SELECT production_yearCOUNT(*)
FROM movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;
",2018-08-30 17:36:02.762074+10,2,0,221,noninterpretable
7537,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-30 17:36:55.906988+10,2,1,221,correct
7538,"select title,production_year,first_name,last_name
from movie_award natural join director natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result ='won'

;",2018-08-30 17:37:27.085337+10,8,1,387,correct
7539,"SELECT first_name, last_name, title, production_year, description
FROM PERSON p, ROLE r
WHERE p.id = r.id
AND p.id = (
SELECT id
 FROM(
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id)
WHERE count = (
 SELECT MAX(count) 
  FROM (
  SELECT *, COUNT(*) AS count
  FROM PERSON NATURAL JOIN ROLE
  GROUP BY id)));


",2018-08-30 17:37:38.909101+10,15,1,76,correct
7540,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year = 1991 OR production_year=1992 OR production_year = 1993 
GROUP BY production_year;",2018-08-30 17:37:39.712829+10,2,1,221,correct
7541,SELECT country FROM Restriction WHERE lower(title)='shakespeare in love' and lower(description) = 'm';,2018-08-30 17:38:05.104279+10,6,1,209,correct
7542,"select p.rst_ame, p.last_name,r.title, r.production_year, r.description
from person p union role r as e

;",2018-08-30 17:39:53.348845+10,15,0,244,noninterpretable
7543,"SELECT p.id
FROM person p
WHERE (SELECT ;",2018-08-30 17:39:55.943951+10,3,0,410,noninterpretable
7544,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 17:40:17.413112+10,15,1,244,correct
7545,"select count(*) from person p
where p.id not in(select d.id from director d);",2018-08-30 17:40:32.3323+10,12,1,390,correct
7546,"

select count(*)
from writer_award natural join person
where first_name ='Woody' and last_name = 'Allen' and result = 'won' and year_of_award>=1991 and year_of_award<=1995
;",2018-08-30 17:40:39.363448+10,9,1,387,correct
7547,"select count(*) as no_noawardmovie
from (
select m.title, m.production_year
from movie m, movie_award ma
where not exists (m.title=ma.title and m.production_year=ma.production_year and lower(ma.result)='won')
union
select m.title, m.production_year
from movie m, crew c, crew_award ca
where not exists 
(m.title=c.title and m.production_year=c.production_year and ca.id=c.id and ca.title=c.title and ca.production_year=c.production_year and lower(ca.result)='won')
union
select m.title, m.production_year
from movie  m, director d, director_award da
where not exists 
(m.title=d.title and m.production_year=d.production_year and da.title=d.title and da.production_year=d.production_year and lower(da.result)='won')
union
select m.title, m.production_year
from movie m, writer w, writer_award wa
where not exists 
(m.title=w.title and m.production_year=w.production_year and wa.id=w.id and wa.title=w.title and wa.production_year=w.production_year and lower(wa.result)='won')
unioin
select m.title, m.production_year
from movie m, role r, actor_award aa
where not exists 
(m.title=r.title and m.production_year=r.production_year and aa.title=r.title and aa.production_year=r.production_year and lower(aa.result)='won'));",2018-08-30 17:40:46.154651+10,11,0,349,noninterpretable
7548,"SELECT COUNT (PERSON.id)
FROM WRITER INNER JOIN PERSON ON WRITER.id = PERSON.id
WHERE PERSON.year_born = 1935;",2018-08-30 17:41:00.893452+10,1,0,367,partially correct
7549,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 17:41:21.530402+10,11,1,349,correct
7550,"SELECT d* w.title AND w.id
FROM DIRECTOR d 
NATURAL JOIN WRITER W
WHERE w.title AND w.id IN
(SELECT m.title
FROM MOVIE m)
GROUP BY m.title
Having countj(*)<2;
",2018-08-30 17:41:54.85574+10,4,0,352,noninterpretable
7551,"select id, award_name, year_of_award, category
from director natural join director_award
where result = ""nominated"" and id not in(
select id
from director natural join director_award
where result = ""won""
)
group by id;
",2018-08-30 17:42:18.831534+10,13,1,378,correct
7552,"WITH h AS (
SELECT id,title,production_year
FROM director d 
WHERE NOT EXISTS(SELECT *
                 FROM director_award da
		      WHERE d.title=da.title AND d.production_year=da.production_year AND lower(result)='won')


SELECT id,award_name,year_of_award,category
FROM h natural join director_award;
",2018-08-30 17:42:29.334081+10,13,0,106,noninterpretable
7553,"select production_year, count (*) as numbers from movie
where production_year <= 1993 and production_year >= 1991;",2018-08-30 17:42:40.285075+10,2,0,276,partially correct
7554,"select id,count(id) from role group by id;",2018-08-30 17:43:05.327821+10,15,0,101,partially correct
7555,"WITH h AS (
SELECT id,title,production_year
FROM director d 
WHERE NOT EXISTS(SELECT *
                 FROM director_award da
		      WHERE d.title=da.title AND d.production_year=da.production_year AND lower(result)='won'))


SELECT id,award_name,year_of_award,category
FROM h natural join director_award;
",2018-08-30 17:43:12.861961+10,13,1,106,correct
7556,"SELECT title, production_year
FROM movie WHERE EXISTS
(SELECT * FROM WRITER LEFT JOIN PERSON ON PERSON.id = WRITER.id WHERE PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"");",2018-08-30 17:43:31.941641+10,5,0,50,partially correct
7557,"SELECT id 
FROM person
WHERE person.year_born=(

SELECT MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(year_born)
			 FROM person )
);
",2018-08-30 17:43:32.262211+10,3,1,195,correct
7883,"SELECT m.production_year, COUNT(*)
FROM movie m
WHERE m.production_year BETWEEN 1991 AND 1993
GROUP BY m.production_year;",2018-08-30 19:47:46.462517+10,2,1,285,correct
7559,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-30 17:44:57.722718+10,4,1,374,correct
7560,"select role.id
from role,scene,appearance
where lower(appearance.title)='psycho'
and appearance.production_year = 1960 
and role.title = scene.title 
and role.production_year = scene.production_year
and appearance.scene_no = scene.scene_no 
and appearance.title = scene.title 
and appearance.production_year = scene.production_year 
and appearance.description = role.description
group by role.id
having count(*)=1;


",2018-08-30 17:45:09.516676+10,10,1,261,correct
7561,"Select ma.title, ma.production_year, p.first_name,p.last_name from
(Director d
Inner Join
Person p
on d.id = p.id) as dp

inner join

(Select title, production_year from movie_award
where award_name like 'BAFTA Film Award' and result like 'won') as ma

on ma.title = dp.title and ma.production_year = dp.production_year;

",2018-08-30 17:45:13.073587+10,8,0,71,partially correct
7562,"select id from
(select id, count(*) from
(select distinct id, title, production_year from 
director, writer ) group by id )isx
where count(*) = (select max(count(*)) from isx) ;",2018-08-30 17:45:13.695433+10,14,0,400,noninterpretable
7563,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-30 17:45:22.244441+10,4,1,352,correct
7564,"select title, production_year
from movie_award
where lower(award_name) = 'bafta film award'
and  lower(category) = 'best film'
and lower(result) = 'won';",2018-08-30 17:45:52.092597+10,8,0,123,partially correct
7565,"SELECT id,first_name,last_name
FROM person p
WHERE MAX(year_born)=year_born;",2018-08-30 17:46:15.634462+10,7,0,421,noninterpretable
7566,"Select ma.title, ma.production_year, p.first_name,p.last_name from
(Director d
Inner Join
Person p
on d.id = p.id) as dp

inner join

(Select title, production_year from movie_award
where award_name like 'BAFTA Film Award' and result like 'won' and category like 'best film') as ma

on ma.title = dp.title and ma.production_year = dp.production_year;

",2018-08-30 17:46:36.883587+10,8,1,71,correct
7567,"select count(*)
from(
select person.id, person.first_name, person.last_name
from person

except

select person.id, person.first_name, person.last_name
from person
inner join director on person.id=director.id);",2018-08-30 17:47:03.319106+10,12,1,221,correct
7568,"select id,first_name,last_name from person where year_born = (select max(year_born) from person);",2018-08-30 17:47:45.403116+10,7,1,209,correct
7569,"select id
from 
(select id
from person
group by year_born 
where year_born<max(year_born))
group by year_born
having max(year_born);
",2018-08-30 17:47:51.343333+10,3,0,349,noninterpretable
7570,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born = 
	(SELECT MAX(year_born)
	FROM person);",2018-08-30 17:48:31.904543+10,7,1,421,correct
7571,"select r.id
from role as r,
 appearance as a,
 scene as s
where s.title=a.title
 and s.production_year=a.production_year
 and s.scene_no=a.scene_no
 and a.description=r.description
 and r.title=a.title
 and r.production_year=a.production_year
 and lower(a.title)='psycho'
 and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-30 17:48:50.91963+10,10,1,223,correct
7572,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 17:49:00.962687+10,12,1,273,correct
7573,"select id
from appearance natural join role 
where title='Psycho' and production_year = 1960

group by id
having count(*) =1
;",2018-08-30 17:49:05.222022+10,10,1,387,correct
7574,"select count(distinct p.id)
from person p
where not exists ( select d.id from director d where d.id=p.id);",2018-08-30 17:49:11.454096+10,12,1,272,correct
7575,"select count(*)
from person p
where exists(select * from writer w where w.id=p.id and p.year_born = 1935);",2018-08-30 17:49:17.609448+10,1,1,332,correct
7576,"SELECT COUNT(PERSON.id)
FROM PERSON, DIRECTOR
WHERE PERSON.id != DIRECTOR.id;",2018-08-30 17:49:23.110727+10,12,0,428,partially correct
7577,"SELECT COUNT(person.id)
FROM writer,person
WHERE writer.id = person.id
AND person.year_born = 1935;
",2018-08-30 17:50:40.944396+10,1,0,285,partially correct
7578,"select p.id, p.first_name, p.last_name from person p
where p.id in (select id from director d, writer w
d.id = w.id and d.title = w.title and d.production_year = w.production_year);",2018-08-30 17:51:15.068855+10,4,0,390,noninterpretable
7579,"select count(*)
from writer_award natural join writer natural join person
where 1991 <= year_of_award <= 1995 and lower(first_name) = 'woody' and lower(last_name) = 'allen';",2018-08-30 17:51:23.127397+10,9,0,163,noninterpretable
7580,"SELECT count(*) 
FROM PERSON
WHERE NOT EXISTS (SELECT * 
 FROM DIRECTOR  WHERE PERSON.id = DIRECTOR.id);",2018-08-30 17:52:22.511862+10,12,1,428,correct
7581,"SELECT 
d.id,
da.award_name,
da.year_of_award,
da.category 
FROM 
director_award da,
director d
WHERE 
da.title=d.title 
AND da.production_year=d.production_year 
AND lower(da.result)='nominated'
AND d.id NOT IN
(
SELECT id 
FROM director_award da,director d
WHERE da.title=d.title AND da.production_year=d.production_year AND lower(da.result)='won');
",2018-08-30 17:52:49.826928+10,13,1,195,correct
7582,"SELECT production_year, count(*)
FROM movie
WHERE production_year >1990
GROUP BY production_year
limit 3;",2018-08-30 17:52:55.087119+10,2,1,403,correct
7583,"select x.id from
(select x1.id, count(*) as noofworkedon from
(select d.id, title, production_year from director d
union
select w.id, title, production_year from writer w)x1
group by x1.id)x
where x.noofworkedon =
(select max(x2.noofworkedon)from
(select x1.id, count(*) as noofworkedon from
(select d.id, title, production_year from director d
union
select w.id, title, production_year from writer w)x1
group by x1.id) x2 );",2018-08-30 17:53:10.081719+10,14,1,400,correct
7584,"SELECT count (*) FROM writer JOIN person ON (writer.id = person.id AND person.year_born = 1935);
",2018-08-30 17:53:15.721426+10,1,0,213,partially correct
7585,"select id
from person p
where p.year_born=(
	select max(year_born)
	from person
	where year_born<(select max (year_born) from person)
);",2018-08-30 17:54:21.546278+10,3,1,349,correct
7586,"Select Count(wa.title) from
writer_award wa
inner Join
Person p 
on wa.id = p.id
where p.first_name like 'Woody' and wa.result like 'won';",2018-08-30 17:54:28.014397+10,9,1,71,correct
7587,"SELECT m.title, m.production_year
FROM MOvie m
WHERE m = Kevin Williams;",2018-08-30 17:54:48.57295+10,5,0,352,noninterpretable
7588,"select id 
from (select description
	from appearance
	where title = 'Psycho' and
	production_year = 1960 
	group by description
	having count(*)=1
	) natural join 
	(
	select *
	from role
	where title = 'Psycho' and
	production_year = 1960 
	)

;",2018-08-30 17:55:04.098175+10,10,1,396,correct
7589,"select count(*)
from writer_award natural join writer natural join person
where 1991 <= year_of_award <= 1995 and lower(first_name) = 'woody' and lower(last_name) = 'allen' and result = 'won';",2018-08-30 17:55:10.209605+10,9,0,163,noninterpretable
7590,"SELECT title, production_year
FROM WRITER NATURAL JOIN PERSON WHERE PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-30 17:55:53.484955+10,5,1,50,correct
7591,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM movie_award ma, person p, director d
WHERE
person NATURAL JOIN director AS pd
lower(ma.award_name)='BAFTA Film Award'
AND lower(ma.catergory)='Best Film';

",2018-08-30 17:56:34.014404+10,8,0,421,noninterpretable
7592,"select id, award_name,year_of_award,category from Director_Award DA inner join Director D
on DA.title=D.title and DA.production_year=D.production_year
where DA.result='nominated';",2018-08-30 17:56:40.12237+10,13,1,202,correct
7593,"select p.id, p.first_name, p.last_name
from person p, (select w.id, count(*) from writer w, director d where w.id=d.id group by w.id having count(*)>1) as h
where p.id=h.id;",2018-08-30 17:56:41.729251+10,4,0,272,partially correct
7594,"select id,award_name,year_of_award,category from director a,Director_Award b
where a.title=b.title
and a.production_year=b,production_year
and ;",2018-08-30 17:57:02.855426+10,13,0,205,noninterpretable
7626,SELECT count(Distinct production_year) from movie WHERE production_year = 1993 or production_year = 1992 or production_year = 1991;,2018-08-30 18:10:25.612231+10,2,0,213,partially correct
7595,"SELECT id, award_name, year_of_award, category
FROM (SELECT id, award_name, year_of_award, category, result
FROM director, director_award
WHERE director.title=director_award.title
AND director.production_year=director_award.production_year
EXCEPT
SELECT id, award_name, year_of_award, category,result
FROM director, director_award
WHERE director.title=director_award.title
AND director.production_year=director_award.production_year
AND lower(director_award.result)='won') AS a
WHERE lower(a.result)='nominated';",2018-08-30 17:57:34.258536+10,13,1,96,correct
7596,"
SELECT count(*)
FROM Writer_Award, writer, person
WHERE Writer_Award.id = writer.id
      AND Writer_Award.title = writer.title
	  AND Writer_Award.production_year = writer.production_year
	  AND writer.id = person.id
      AND 1990 < Writer_Award.year_of_award < 1996
	  AND lower(Writer_Award.result) = 'won'
	  AND person.first_name = 'Woody'
	  AND person.last_name = 'Allen';
",2018-08-30 17:58:59.43957+10,9,0,148,noninterpretable
7597,"select title, production_year
from movie m join person p as mp having m.title = p.title and m.production_year = p.production_year 
where exist(select * from person p where mp.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-30 17:59:07.379077+10,5,0,332,noninterpretable
7598,"SELECT count (*) FROM person WHERE EXISTS (SELECT * FROM writer where writer.id = person.id and person.id = 1935);
",2018-08-30 18:00:14.437022+10,1,0,213,partially correct
7599,"SELECT count (*) FROM person WHERE EXISTS (SELECT * FROM writer where writer.id = person.id and person.year_born = 1935);
",2018-08-30 18:00:54.92968+10,1,1,213,correct
7600,"select w.title, w.production_year
from writer w
where exists(select * from person p where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-30 18:01:43.493618+10,5,1,332,correct
7601,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director d,
    person p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;

",2018-08-30 18:01:51.960134+10,8,1,421,correct
7602,"select year_born, count(*)
from writer
join person on person.id == writer.id 
group by year_born
having year_born == 1935;",2018-08-30 18:03:24.495447+10,1,0,275,noninterpretable
7603,"select p.first_name, p.last_name, r.title, r.production_year,r.description 
from person p, role r 
where r.id = p.id
and r.id = 
(select x.id from x where x.noofrole =
(select max(x.noofrole) from
(select r.id, count(*)as noofrole from role group by r.id)x)) ;",2018-08-30 18:04:09.510138+10,15,0,400,noninterpretable
7604,"SELECT country FROM RESTRICTION WHERE title = ""Shakespeare in Love"" AND description = ""M"";",2018-08-30 18:04:23.755907+10,6,1,50,correct
7605,"select person.id, first_name, last_name
from person inner join writer on writer.id = person.id
inner join director on person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 18:05:15.014764+10,4,1,123,correct
7606,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-30 18:05:30.345285+10,6,1,332,correct
7607,"select production_year,count(*)
from movie
where production_year=1991 or production_year=1992 or production_year=1993
group by production_year;",2018-08-30 18:05:36.041886+10,2,1,149,correct
7608,"select x4.id
		from(
		select id, title, production_year from (director natural join movie) as d
		union
		select id, title, production_year from (writer natural join movie) as w
		union
		select id, title, production_year from (writer natural join director natural join movie) as wd
		) as x4
		

	
	
	group by x4.id
	having count(*) = (select max(x2.total) 
	from(
		select x1.id, count(*) as total 
		from(
		select id, title, production_year from (director natural join movie) as d
		union
		select id, title, production_year from (writer natural join movie) as w
		union
		select id, title, production_year from (writer natural join director natural join movie) as wd
		) as x1
		group by x1.id
	) as x2);",2018-08-30 18:05:55.015892+10,14,1,66,correct
7609,"select ww.title, ww.production_year from
(writer w natural join person p) as ww
where ww.first_name ='Kevin'
and ww.last_name ='Williamson';",2018-08-30 18:05:55.94387+10,5,1,374,correct
7610,"select u.id, u.award_name, u.year_of_award, u.category from (director d natural join director_award da) u where u.id not in (select id from (director d natural join director_award da) v  where lower(v.result)='won');
",2018-08-30 18:06:27.415521+10,13,1,270,correct
7611,"select person.id, first_name, last_name
from person inner join writer on writer.id = person.id
inner join director on person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 1;",2018-08-30 18:06:41.049433+10,4,0,123,partially correct
7612,"select person.id, first_name, last_name
from person inner join writer on writer.id = person.id
inner join director on person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 18:06:47.807757+10,4,1,123,correct
7613,"select person.id, first_name, last_name
from person inner join writer on writer.id = person.id
inner join director on person.id = director.id
group by person.id, first_name, last_name
having count(director.title) >= 2;",2018-08-30 18:06:57.262536+10,4,0,123,partially correct
7614,"select person.id, first_name, last_name
from person inner join writer on writer.id = person.id
inner join director on person.id = director.id
group by person.id, first_name, last_name
having count(director.title) > 2;",2018-08-30 18:07:07.12958+10,4,1,123,correct
7615,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 18:07:38.456216+10,4,1,390,correct
7616,"WITH h AS(
SELECT id,count(*) AS No
FROM (SELECT id,title,production_year
      FROM writer w
	UNION
	SELECT id,title,production_year
	FROM director d) wd
GROUP BY id
)

SELECT id
FROM h 
WHERE No=(SELECT MAX(No)
          FROM h);",2018-08-30 18:07:57.825192+10,14,1,106,correct
7617,"SELECT id, first_name, last_name
FROM person
WHERE id IN (
SELECT d.id
FROM director d,writer w
WHERE d.title = w.title AND d.id = w.id AND d.production_year = w.production_year
GROUP BY d.id
HAVING COUNT(*)>=2);",2018-08-30 18:08:23.913434+10,4,1,219,correct
7618,"select count(*)
from movie m
where m.title not in(
select movie.title
from movie,movie_award
where movie.title = movie_award.title
);
",2018-08-30 18:08:34.725513+10,11,0,261,partially correct
7619,"Select tt.id from
(((Select a.description from Appearance a
where a.title like 'Psycho' and a.production_year like '1960'
group by a.description
having Count(a.scene_no) =1) as app
inner join 
Role r
on r.description = app.description) as outT
Inner join
Person p
on outT.id = p.id) as tt
where production_year like '1960';",2018-08-30 18:09:00.482604+10,10,1,71,correct
7620,"select id, first_name, last_name
from person
order by year_born
limit 1;",2018-08-30 18:09:14.127545+10,7,0,332,partially correct
7621,"SELECT count(*)
FROM person p
WHERE EXISTS(
SELECT *
FROM writer w
WHERE w.id = p.id
AND p.year_born = 1935);

",2018-08-30 18:09:25.836261+10,1,1,285,correct
7622,"select id, first_name, last_name
from person
order by year_born desc
limit 1;",2018-08-30 18:09:35.809545+10,7,1,332,correct
7623,"select id
from appearance natural join role
where title = 'Psycho' and production_year = '1960' and scene_no = '1';",2018-08-30 18:09:36.150916+10,10,0,163,partially correct
7624,"select count(*)
from (select id from person) as p
where p.id not in(select id from director);
",2018-08-30 18:09:55.430524+10,12,1,149,correct
7625,"

SELECT title FROM ACTOR_AWARD WHERE result = ""won"";",2018-08-30 18:10:20.974042+10,11,0,384,partially correct
7627,"SELECT COUNT(*)

FROM 
writer_award wa,
person p

WHERE 
wa.year_of_award>1990
AND wa.year_of_award<1996
AND lower(wa.result)='won'

AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen'

AND p.id=wa.id;


",2018-08-30 18:10:28.608607+10,9,1,421,correct
7628,"select p.id, p.first_name, p.last_name
from person p, (select distinct w.id, count(*) from writer w, director d where w.id=d.id and w.title=d.title and w.production_year=d.production_year group by w.id having count(*)>=2) as h
where p.id=h.id;",2018-08-30 18:10:34.239069+10,4,1,272,correct
7629,"select country from restriction
where title = 'Shakespeare in Love' 
and description='M';",2018-08-30 18:10:35.461247+10,6,1,374,correct
7630,"SELECT count(*)
FROM person;",2018-08-30 18:11:38.598925+10,12,0,403,partially correct
7631,"select id,first_name, last_name from person p
where p.year_born = (
select max(year_born) from person pp


);",2018-08-30 18:12:25.222025+10,7,1,374,correct
7632,"SELECT role.id
FROM role, appearance
WHERE role.title = appearance.title 
AND role.production_year = appearance.production_year
AND role.description = appearance.description
AND lower(appearance.title) = 'psycho'
AND appearance.production_year = 1960
GROUP BY role.id
HAVING COUNT(*) = 1;",2018-08-30 18:12:58.101267+10,10,1,148,correct
7633,SELECT count(production_year) from movie WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 Group by production_year;,2018-08-30 18:13:06.382708+10,2,0,213,partially correct
7634,"select p.first_name, p.last_name, r.title, r.production_year, r.description from person as p inner join role as r on p.id = r.id 
where r.id in(
select id from (select r.id, count (r.id) as a from role r group by r.id)
where a = (select max(a) from (select r.id, count (r.id) as a from role r group by r.id)));",2018-08-30 18:13:29.97759+10,15,1,99,correct
7635,SELECT COUNT(*) FROM (SELECT p.id FROM person AS p WHERE p.id NOT IN (SELECT d.id FROM director AS d)) AS x;,2018-08-30 18:13:53.203524+10,12,1,273,correct
7636,"SELECT production_year, count(production_year) from movie WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 Group by production_year;",2018-08-30 18:14:27.875242+10,2,1,213,correct
7637,"SELECT count(*)
FROM person
WHERE NOT EXISTS (SELECT id FROM director WHERE person.id=director.id);",2018-08-30 18:14:40.477877+10,12,1,403,correct
7638,"SELECT count(*)
FROM person
WHERE NOT EXISTS (SELECT id FROM director);",2018-08-30 18:15:17.888007+10,12,0,403,partially correct
7639,"SELECT count (*) FROM person WHERE EXISTS (SELECT * FROM writer where writer.id = person.id and person.year_born = 1935);
",2018-08-30 18:15:44.675362+10,1,1,213,correct
7640,"select x.id,
	x.first_name,
	x.last_name
from (movie natural join director natural join person)as x
group by x.id
having count(x.id)>=2;",2018-08-30 18:15:59.639505+10,4,0,149,partially correct
7641,"select x.id,
	x.first_name,
	x.last_name
from (person natural join writer natural join director) as x 
group by x.id
having count(x.id)>=2;",2018-08-30 18:17:07.84481+10,4,1,149,correct
7642,"select first_name, last_name, title, production_year, description 
from role natural join person
where id = ( 
	select id
	from role natural join movie natural join person 
	group by id
	having count(*)= (
		select max(total) 
		from (
			select id, count(description) as total
			from role natural join movie natural join person 
			group by id
		)
	)
);",2018-08-30 18:17:12.273111+10,15,1,66,correct
7643,"WITH h AS(
SELECT id,COUNT(*) AS no
FROM role
GROUP BY id)

SELECT first_name,last_name,title,production_year,description
FROM role r NATURAL JOIN person p
WHERE id = (SELECT id
            FROM h
		 WHERE no = (SELECT MAX(no)
		             FROM h));",2018-08-30 18:17:34.562483+10,15,1,106,correct
7644,"select p.first_name, p.last_name, r.title, r.production_year,r.description 
from person p, role r ,(select r.id, count(*)as noofrole from role r group by r.id) as x
where r.id = p.id and r.id= x.id
and r.id = 
(select id from x where x.noofrole =
(select max(x.noofrole) from
(select r.id, count(*)as noofrole from role group by r.id)y)) ;",2018-08-30 18:17:46.904701+10,15,0,400,noninterpretable
7645,"SELECT count(*)
FROM person, writer
WHERE person.id = writer.id AND year_born = 1935;",2018-08-30 18:18:13.774595+10,1,0,373,partially correct
7646,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 18:18:26.752743+10,15,1,400,correct
7647,"WITH h AS(
SELECT id,COUNT(*) AS no
FROM role
GROUP BY id)


WITH maxno AS (
SELECT MAX(no)
FROM h
)



SELECT first_name,last_name,title,production_year,description
FROM role r NATURAL JOIN person p
WHERE id = (SELECT id
            FROM h
		 WHERE no = maxno;",2018-08-30 18:18:33.05172+10,15,0,106,noninterpretable
7648,"select count(*)
from person p
where exists(select * 
from writer 
where p.id=writer.id 
and p.year_born=1935)
group by p.id;",2018-08-30 18:18:42.69471+10,1,1,110,correct
7649,"SELECT *
FROM movie m
WHERE (m.title, m.production_year) NOT IN

((SELECT ma.title, ma.production_year
FROM movie_award ma
WHERE lower(ma.result) = 'won')

UNION

(SELECT ca.title, ca.production_year
FROM crew_award ca
WHERE lower(ca.result) = 'won')

UNION

(SELECT da.title, da.production_year
FROM director_award da
WHERE lower(da.result) = 'won')

UNION

(SELECT wa.title, wa.production_year
FROM writer_award wa
WHERE lower(wa.result) = 'won')

UNION

(SELECT aa.title, aa.production_year
FROM actor_award aa
WHERE lower(aa.result) = 'won'));",2018-08-30 18:18:43.879847+10,11,0,27,noninterpretable
7650,"WITH h AS(
SELECT id,COUNT(*) AS no
FROM role
GROUP BY id)


WITH maxno AS (
SELECT MAX(no)
FROM h
)



SELECT first_name,last_name,title,production_year,description
FROM role r NATURAL JOIN person p
WHERE id = (SELECT id
            FROM h
		 WHERE no = maxno);",2018-08-30 18:18:44.089241+10,15,0,106,noninterpretable
7651,"SELECT p.id, p.first_name, p.last_name
FROM person p INNER JOIN director d ON p.id=d.id;",2018-08-30 18:19:29.598916+10,4,0,403,partially correct
7652,"select x.production_year,
	x.title
from (writer natural join movie natural join person)as x
where x.first_name='Kevin' and x.last_name='Williamson';

",2018-08-30 18:19:52.258499+10,5,1,149,correct
7653,"select p.*, a.*,count(*)
from appearance a, person p, role r
where a.title = r.title and r.id = p.id
and lower(a.title) = ""psycho"" and a.production_year = 1960
group by p.first_name;",2018-08-30 18:19:56.310642+10,10,0,425,partially correct
7654,"select x.production_year,
	x.title
from (writer natural join movie natural join person)as x
where x.first_name='Kevin' and x.last_name='Williamson';

",2018-08-30 18:19:58.248296+10,5,1,149,correct
7655,"select x.title,x.production_year
from (writer natural join movie natural join person)as x
where x.first_name='Kevin' and x.last_name='Williamson';

",2018-08-30 18:20:21.983848+10,5,1,149,correct
7656,"select m.production_year, count(*)
from movie m
where m.production_year>1990
and m.production_year<1994
group by m.production_year;",2018-08-30 18:20:31.974549+10,2,1,110,correct
7657,"select d.title, d.production_year,p.first_name, p.last_name
from (
	select * 
	from movie_award ma join director d 
	having ma.title = d.title and ma.production_year = d.production_year
	where  ma.award_name ='BAFTA Film Award' and ma.category = 'Best Film' )
where exists(select * from person p where p.id = d.id);",2018-08-30 18:20:50.343443+10,8,0,332,noninterpretable
7658,"select count(m.id)
from
	(select distinct id
	from
	writer
	natural join
	person
	where
	year_born = 1935) as m;
",2018-08-30 18:21:01.051187+10,1,1,271,correct
7659,"select id
from appearance natural join role
where LOWER(title) = 'psycho' and production_year = '1960'
group by id
having count(id) = 1;",2018-08-30 18:21:57.659237+10,10,1,163,correct
7660,"select country
from Restriction
where lower(title)='shakespeare in love' 
	and lower(description)='m';",2018-08-30 18:22:05.886089+10,6,1,149,correct
7661,"select r.id
from scene s, appearance a, role r
where s.title = a.title and s.production_year = a.production_year and s.scene_no = a.scene_no
and s.title = r.title AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-30 18:22:26.590237+10,10,1,425,correct
7662,"SELECT *
FROM person
WHERE EXISTS (SELECT * FROM writer 
              WHERE person.id = writer.id AND person.year_born = 1935);",2018-08-30 18:22:27.078146+10,1,0,148,partially correct
7663,"select count(*)
from person p
where not exists(select * 
from director d
where p.id=d.id);",2018-08-30 18:22:39.087764+10,12,1,110,correct
7664,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT * FROM writer 
              WHERE person.id = writer.id AND person.year_born = 1935);",2018-08-30 18:22:44.541413+10,1,1,148,correct
7665,"select id,first_name,last_name
from person 
where year_born in(
			select max(year_born) 
			from person);",2018-08-30 18:24:07.944968+10,7,1,149,correct
7666,"SELECT * 
FROM person p
WHERE p.year_born < (SELECT MAX(year_born) FROM person p)
ORDER BY p.year_born desc
limit 1;",2018-08-30 18:24:20.282107+10,3,0,27,partially correct
7667,"SELECT p.id 
FROM person p
WHERE p.year_born < (SELECT MAX(year_born) FROM person p)
ORDER BY p.year_born desc
limit 1;",2018-08-30 18:24:42.44875+10,3,1,27,correct
7668,"select production_year, count(production_year)
from
movie
where
production_year <= '1993'
and
production_year >='1991'
group by production_year;",2018-08-30 18:24:44.434937+10,2,1,271,correct
7669,"SELECT id
FROM DIRECTOR d
WHERE production_year='1960';
",2018-08-30 18:25:33.45031+10,14,0,191,partially correct
7670,"select count(id)
from
person
where
id not in (select id from director);",2018-08-30 18:25:44.60526+10,12,1,271,correct
7671,"select p.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=w.id
and d.production_year=w.production_year
and d.title=w.title
and d.id=w.id
group by p.id
having count(*)>1;",2018-08-30 18:27:40.034012+10,4,1,110,correct
7672,"select distinct w.id
from
director d, writer w
where
w.id = d.id
group by w.id
having
count(w.id)>=2;",2018-08-30 18:28:00.003677+10,4,0,271,partially correct
7673,"select distinct id
from
director
natural join 
writer
group by id
having
count(id)>=2;
",2018-08-30 18:28:53.270257+10,4,0,271,partially correct
7674,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECTMAX(year_born)
FROM person p
WHERE year_born < (SELECT MAX(year_born)
FROM person ));",2018-08-30 18:28:55.089648+10,3,0,410,noninterpretable
7675,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECTMAX(year_born)
FROM person p
WHERE year_born < (SELECT MAX(year_born)
FROM person ));",2018-08-30 18:29:05.118215+10,3,0,410,noninterpretable
7676,;,2018-08-30 18:29:24.352699+10,14,0,395,noninterpretable
7677,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 18:29:52.084071+10,14,1,395,correct
7678,"select id, award_name,year_of_award,category from director a,Director_Award b
where
a.title=b.title 
and a.production_year=b.production_year
and lower(result)='nominated' 
and a.id not in(
select id
from director a, director_award b 
where a.title=b.title 
and a.production_year=b.production_year
and lower(result)='won');
",2018-08-30 18:30:07.96804+10,13,1,205,correct
7679,"select distinct id, first_name, last_name
from
director
natural join 
writer
natural join
person
group by id,first_name,last_name
having
count(id)>=2;",2018-08-30 18:30:10.671+10,4,1,271,correct
7680,;,2018-08-30 18:30:17.375922+10,15,0,395,noninterpretable
7681,"SELECT id, first_name, last_name FROM person NATURAL JOIN director NATURAL JOIN writer GROUP BY id HAVING COUNT(*)>2;",2018-08-30 18:30:23.510812+10,4,0,155,partially correct
7682,"select count(*)
from writer_award wa,writer w,person p
where year_of_award>=1991 and year_of_award<=1995
and wa.title=w.title
and wa.production_year=w.production_year
and lower(wa.result)='won'
and w.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen';",2018-08-30 18:30:25.205498+10,9,1,397,correct
7683,"select mm.title,mm.production_year,p.first_name,p.last_name

from 


(select title, production_year from movie_award
where award_name='BAFTA Film Award'
and category='Best Film'
and result='won') as mm   
  left join director d 
  on (d.title=mm.title  ) and  (d.production_year=mm.production_year)
  left join person p on p.id=d.id
  ;",2018-08-30 18:30:26.022676+10,8,0,374,partially correct
7684,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
 FROM person 
     WHERE year_born < (SELECT MAX(year_born)
       FROM person ));",2018-08-30 18:30:42.607798+10,3,1,410,correct
7685,"select w.title, w.production_year
from writer w, person p
where w.id=p.id
and lower(p.first_name)='kevin'
and lower(p.last_name)='williamson';",2018-08-30 18:31:25.574235+10,5,1,110,correct
7686,"select title, production_year
from
writer
natural join
movie
natural join
person
where
first_name = 'Kevin'
and
last_name = 'Williamson';",2018-08-30 18:31:39.146068+10,5,1,271,correct
7687,"select ma.title, ma.production_year, p.first_name, p.last_name
from(select ma.title, ma.production_year
	from movie_award ma
	where ma.award_name = 'BAFTA Film Award' and ma.category = 'best film' and result = 'won') as ma,
person as p, 
director as d
where d.title = ma.title
and d.production_year = ma.production_year
and p.id = d.id;",2018-08-30 18:31:41.034341+10,8,1,332,correct
7688,"SELECT sub.id, sub.award_name, sub.year_of_award, sub.category
FROM
((SELECT *
FROM director_award da2 NATURAL JOIN director d2
WHERE lower(da2.result) = 'nominated')

EXCEPT

(SELECT *
FROM director_award da1 NATURAL JOIN director d1
WHERE lower(da1.result) = 'won')) sub;",2018-08-30 18:32:15.036313+10,13,0,27,noninterpretable
7689,"SELECT title, production_year FROM writer NATURAL JOIN person
GROUP BY title, production_year HAVING lower(first_name)='kevin' AND lower(last_name)= 'williamson';",2018-08-30 18:32:34.205593+10,5,1,155,correct
7690,"select r.country
from restriction r
where lower(r.title)='shakespeare in love'
and lower(r.description)='m';",2018-08-30 18:32:38.884246+10,6,1,110,correct
7691,"select country
from
restriction
where
description = 'M'
and
title = 'Shakespeare in Love';",2018-08-30 18:32:47.330769+10,6,1,271,correct
7692,"select production_year, count(*) from movie where production_year = 1993 or production_year =  1992 or production_year = 1991 group by production_year;",2018-08-30 18:32:48.176264+10,2,1,99,correct
7693,"SELECT w.title, w.production_year
FROM writer w INNER JOIN person p ON p.id=w.id
WHERE p.last_name IN ('Williamson');",2018-08-30 18:33:33.80256+10,5,1,403,correct
7694,"select id, first_name,last_name
from
person
where
year_born = (select max(year_born) from person);",2018-08-30 18:33:34.238164+10,7,1,271,correct
7695,"select mm.title,mm.production_year,p.first_name,p.last_name

from 


(select title, production_year from movie_award
 WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS mm  
  left join director d 
  on (d.title=mm.title  ) and  (d.production_year=mm.production_year)
  left join person p on p.id=d.id
  ;",2018-08-30 18:33:59.660535+10,8,1,374,correct
7696,"SELECT ar.id

FROM 
appearance NATURAL JOIN role AS ar

WHERE
lower(ar.title)='Psycho'
AND ar.production_year=1960

GROUP BY ar.id HAVING COUNT(*)=1
;",2018-08-30 18:34:06.636684+10,10,0,421,partially correct
7697,"SELECT Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name
FROM Movie_Award, director, person
WHERE Movie_Award.title = director.title AND director.id = person.id
       AND lower(award_name) = 'BAFTA Film Award'
        AND lower(result) = 'won'
        AND lower(category) = 'Best Film';",2018-08-30 18:34:35.350303+10,8,0,148,partially correct
7698,"select distinct id, first_name, last_name
from (director natural join writer natural join person) as dwp
where exists (select* from director as d
	dwp.first_name = d.first_name
	group by d.title
	having count(*) >1
);",2018-08-30 18:35:05.441861+10,4,0,286,noninterpretable
7699,"SELECT Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name
FROM Movie_Award, director, person
WHERE Movie_Award.title = director.title AND director.id = person.id
       AND lower(award_name) = 'bafta film award'
        AND lower(result) = 'won'
        AND lower(category) = 'best film';",2018-08-30 18:35:08.309896+10,8,1,148,correct
7700,"select title, production_year, first_name, last_name
from
movie_award
natural join
director
natural join
person
where
lower(result) = 'won'
and
award_name = 'BAFTA Film Award'
and
lower(category) = 'best film';",2018-08-30 18:35:36.76096+10,8,1,271,correct
7701,"SELECT sub.id, count(*)
FROM 
((SELECT p.id, d.title, d.production_year
FROM person p NATURAL JOIN director d)

UNION

(SELECT p2.id, w.title, w.production_year
FROM person p2 NATURAL JOIN writer w)) sub
GROUP BY sub.id;",2018-08-30 18:36:46.864363+10,14,0,27,noninterpretable
7702,"SELECT country
FROM restriction
WHERE title IN ('Shakespeare in Love') AND description IN ('M');",2018-08-30 18:36:50.226574+10,6,1,403,correct
7703,"select count(*)
from
writer_award
natural join
writer
natural join
person
where
first_name = 'Woody'
and
last_name = 'Allen'
and
year_of_award >= 1991
and
year_of_award <=1995;",2018-08-30 18:37:22.03668+10,9,0,271,partially correct
7704,"select count(*)
from
writer_award
natural join
writer
natural join
person
where
first_name = 'Woody'
and
last_name = 'Allen'
and
year_of_award >= 1991
and
year_of_award <=1995
and
lower(result) = 'won';",2018-08-30 18:38:01.090622+10,9,1,271,correct
7705,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 18:39:11.895487+10,10,1,421,correct
7706,"select id
from
role
natural join
appearance
where
lower(title) = 'psycho'
and
production_year = 1960
group by id
having
count(id)=1;",2018-08-30 18:39:43.345319+10,10,1,271,correct
7707,"SELECT sub.id, sub.award_name, sub.year_of_award, sub.category
FROM
(SELECT *
FROM director_award da2 NATURAL JOIN director d2
WHERE lower(da2.result) = 'nominated'
EXCEPT
SELECT *
FROM director_award da1 NATURAL JOIN director d1
WHERE lower(da1.result) = 'won') sub;",2018-08-30 18:39:44.462727+10,13,1,27,correct
7708,"select count(re.title) from (select* from writer_award wa , person p where 
lower(p.first_name) = ""woody""
and
lower(p.last_name) =""allen""
and
wa.id = p.id) as re
where lower(re.result)=""won"" and re.year_of_award>=1991 and re.year_of_award<=1995;",2018-08-30 18:39:53.802542+10,9,1,130,correct
7709,"select count(*)
from ( select writer.id 
from person, writer
where person.id = writer.id and person.year_born = 1935);",2018-08-30 18:40:12.303065+10,1,0,337,partially correct
7710,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT*FROM writer w WHERE w.ID=p.ID AND p.year_born=1935);",2018-08-30 18:40:22.499761+10,1,1,424,correct
7711,;,2018-08-30 18:40:24.832822+10,3,0,261,noninterpretable
7712,"SELECT id, first_name, last_name
FROM person
ORDER BY year_born
limit 1;",2018-08-30 18:41:04.266774+10,7,0,403,partially correct
7713,"select count(*) from 


(select id, title, production_year from writer_award
where year_of_award<1996
and year_of_award>1990
and lower(result)='won') as ww left join person p on p.id=ww.id

where lower(p.last_name)='allen'
and lower(p.first_name)='woody';",2018-08-30 18:41:05.180395+10,9,1,374,correct
7714,"SELECT id, first_name, last_name
FROM person
ORDER BY year_born ASC
limit 1;",2018-08-30 18:41:36.837609+10,7,0,403,partially correct
7715,"select id
from scene s,role r,appearance a
where s.title=r.title
	and lower(s.title)='psycho'
	and s.production_year=1960
	and s.title=a.title
	and s.production_year=r.production_year
	and s.production_year=a.production_year
	and r.description=a.description
	and s.scene_no=a.scene_no
group by id
having count(*)=1;",2018-08-30 18:42:02.727224+10,10,1,397,correct
7716,"select count(title)
from
movie m
where
title not in (select title from movie_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from crew_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from director_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from writer_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from actor_award where lower(result) = 'won' and production_year = m.production_year);",2018-08-30 18:42:23.841705+10,11,1,271,correct
7717,"
and p.first_name = 'Woody'
and p.last_name = 'Allen';",2018-08-30 18:43:36.635523+10,9,0,332,noninterpretable
7718,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE da.title=d.title AND da.production_year=d.production_year
AND NOT EXISTS(SELECT d.id,da.award_name,da.year_of_award,da.category
               FROM director_award da,director d
		    WHERE da.title=d.title AND da.production_year=d.production_year AND da.result='won');",2018-08-30 18:44:14.169345+10,13,0,368,partially correct
7719,"SELECT id, first_name, last_name
FROM person
ORDER BY year_born DESC
limit 1;",2018-08-30 18:44:38.513802+10,7,1,403,correct
7720,"select count(*)
from
(select title, production_year from writer_award where year_of_award >= 1991 and year_of_award <= 1995 and result= 'won') as wa,
person p,
writer w
where
w.title = wa.title
and w.production_year = wa.production_year
and p.id = w.id
and p.first_name = 'Woody'
and p.last_name = 'Allen';",2018-08-30 18:44:54.365553+10,9,1,332,correct
7721,"SELECT p.first_name
FROM PERSON p
WHERE year_born = '1990';",2018-08-30 18:45:25.493112+10,15,0,191,partially correct
7722,"select id
from scene s,role r,appearance a
where s.title=r.title
	and lower(s.title)='psycho'
	and s.production_year=1960
	and s.title=a.title
	and s.production_year=r.production_year
	and s.production_year=a.production_year
	and r.description=a.description
	and s.scene_no=a.scene_no
group by id
having count(*)=1;",2018-08-30 18:46:28.513296+10,10,1,397,correct
7723,"select id
from scene s,role r,appearance a
where s.title=r.title
	and lower(s.title)='psycho'
	and s.production_year=1960
	and s.title=a.title
	and s.production_year=r.production_year
	and s.production_year=a.production_year
	and r.description=a.description
	and s.scene_no=a.scene_no
group by id
having count(*)=1;",2018-08-30 18:46:48.603273+10,10,1,397,correct
7724,"select id
from
person
where
year_born = (select max(year_born)
		from
		(select year_born
		 from  person
		 where year_born < (select max(year_born)
					from person)
		)
	    );",2018-08-30 18:47:20.778159+10,3,1,271,correct
7725,;,2018-08-30 18:48:14.608904+10,14,0,205,noninterpretable
7726,"SELECT title, production_year
FROM movie_award
WHERE award_name IN ('BAFTA Film Award') AND category IN ('best film');",2018-08-30 18:49:25.293302+10,8,0,403,partially correct
7727,"SELECT COUNT(*)
FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE NOT EXISTS (m.title=ma.title
OR m.title=ca.title
OR m.title=da.title
OR m.title=wa.title
OR m.title=aa.title);",2018-08-30 18:50:34.326626+10,11,0,424,noninterpretable
7728,"select distinct dwp.id, dwp.first_name, dwp.last_name
from (director natural join writer natural join person) as dwp
where exists (select* from writer as d
where d.id = dwp.id
group by d.id
having count(*) >1
);",2018-08-30 18:50:37.493107+10,4,1,286,correct
7729,"SELECT COUNT(*)

FROM movie m

WHERE NOT EXISTS (SELECT *
	FROM 
	movie_award ma,
	crew_award ca,
	director_award da,
	writer_award wa,
	actor_award aa
	WHERE 
	m.title=ma.title
	AND lower(ma.result)='won' AND m.title=ca.title
	AND lower(ma.result)='won'AND m.title=da.title
	AND lower(ma.result)='won'AND m.title=wa.title
	AND lower(ma.result)='won' AND m.title=aa.title);",2018-08-30 18:50:38.707493+10,11,0,421,partially correct
7730,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m NATURAL JOIN director d NATURAL JOIN person p
WHERE award_name IN ('BAFTA Film Award') AND category IN ('best film');",2018-08-30 18:51:25.909457+10,8,0,403,partially correct
7731,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m NATURAL JOIN director d NATURAL JOIN person p
WHERE m.award_name IN ('BAFTA Film Award') AND m.category IN ('best film');",2018-08-30 18:52:05.854897+10,8,0,403,partially correct
7732,"select person.id
from person
where person.year_born = (select max(p1.year_born)
                          from person p1
                          where p1.year_born < (select max(p2.year_born)
                          from person p2));",2018-08-30 18:52:47.369693+10,3,1,261,correct
7733,"select count(*) as total_number
from movie
where not exists (select * 
from movie,movie_award, crew_award, director_award, writer_award, actor_award
where movie.title=movie_award.title
and movie.production_year=movie_award.production_year
or movie.title=crew_award.title
and movie.production_year=crew_award.production_year
or movie.title=director_award.title
and movie.production_year=director_award.production_year
or movie.title=writer_award.title
and movie.production_year=writer_award.production_year
or movie.title=actor_award.title
and movie.production_year=writer_award.production_year);",2018-08-30 18:52:49.661545+10,11,0,140,partially correct
7734,"select p2.id from person p2
where p2.year_born = (select max(year_born) from person as p where p.year_born != (select max(year_born) from person));",2018-08-30 18:53:45.79997+10,3,1,92,correct
7735,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS 
(SELECT distinct title FROM movie_award as ma WHERE lower(result)='won'and m.title = ma.title
union
SELECT distinct title FROM crew_award as ca WHERE lower(result)='won' and m.title = ca.title
union
SELECT distinct title FROM director_award as da WHERE lower(result)='won' and m.title=da.title
union
SELECT distinct title FROM writer_award as wa WHERE lower(result)='won' and m.title=wa.title
union
SELECT distinct title FROM actor_award as aa WHERE lower(result)='won' and m.title=aa.title );
",2018-08-30 18:54:21.392307+10,11,0,132,partially correct
7736,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m NATURAL JOIN director d NATURAL JOIN person p
WHERE m.award_name IN ('BAFTA Film Award') AND m.category IN ('best film') AND result IN ('WON');",2018-08-30 18:54:30.982445+10,8,0,403,partially correct
7737,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie_award m NATURAL JOIN director d NATURAL JOIN person p
WHERE m.award_name IN ('BAFTA Film Award') AND m.category IN ('best film') AND m.result IN ('won');",2018-08-30 18:54:49.750718+10,8,1,403,correct
7738,"select id, award_name, year_of_award, category
from
director
natural join
director_award
where
lower(result) = 'nominated'
and
id not in (select id
from
director
natural join
director_award
where
lower(result) = 'won')
group by id, award_name, year_of_award, category
having
count(id) >= 1;",2018-08-30 18:55:18.889805+10,13,1,271,correct
7739,"WITH idcount as
(SELECT r.id, count(*) c
FROM role r
GROUP BY r.id),

maxcount AS
(SELECT idcount.id
FROM idcount
WHERE idcount.c = (SELECT max(idcount.c) FROM idcount))

SELECT p.first_name, p.last_name, r.*
FROM role r NATURAL JOIN maxcount NATURAL JOIN person p;",2018-08-30 18:55:45.398681+10,15,0,27,partially correct
7740,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS 
(SELECT title,production_year FROM movie_award as ma WHERE lower(result)='won'and m.title = ma.title and m.production_year=ma.production_year
union
SELECT title,production_year FROM crew_award as ca WHERE lower(result)='won' and m.title = ca.title and m.production_year=ca.production_year
union
SELECT  title,production_year FROM director_award as da WHERE lower(result)='won' and m.title=da.title and m.production_year=da.production_year
union
SELECT title,production_year FROM writer_award as wa WHERE lower(result)='won' and m.title=wa.title and m.production_year=wa.production_year
union
SELECT  title,production_year FROM actor_award as aa WHERE lower(result)='won' and m.title=aa.title  and m.production_year=aa.production_year);
",2018-08-30 18:56:35.423344+10,11,1,132,correct
7741,"select p.first_name,p.last_name,r.title,r.production_year,r.description from person p,role r,(select id,count(*) as r_num from role group by id)as a where p.id=r.id and p.id=a.id and r.id=a.id and a.r_num=(select max(r_num) from (select id,count(*) as r_num from role group by id)as a);",2018-08-30 18:56:41.089172+10,15,1,117,correct
7742,"SELECT count (*)
FROM movie
WHERE production_year>1990 AND production_year<1994
group by production_year;",2018-08-30 18:56:54.738974+10,2,0,373,partially correct
7743,"select first_name, last_name, title, production_year, description
from person natural join role 
where id = (select id from
(select id, first_name, last_name, title, production_year, description, count(*) as cn
from person natural join role 
group by id
having cn =
(select max(cn) from
(select id, count(*) as cn
from person natural join role 
group by id))));

",2018-08-30 18:57:02.507742+10,15,1,378,correct
7744,"SELECT production_year, count (*)
FROM movie
WHERE production_year>1990 AND production_year<1994
group by production_year;",2018-08-30 18:57:32.831218+10,2,1,373,correct
7745,"WITH idcount as
(SELECT r.id, count(*) c
FROM role r
GROUP BY r.id),

maxcount AS
(SELECT idcount.id
FROM idcount
WHERE idcount.c = (SELECT max(idcount.c) FROM idcount))

SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM role r NATURAL JOIN maxcount NATURAL JOIN person p;",2018-08-30 18:57:50.316103+10,15,1,27,correct
7746,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE p.id = w.id AND p.year_born = 1935);",2018-08-30 18:59:06.693179+10,1,1,373,correct
7747,"select m.id
from
((select id, title, production_year from director)
union
(select id, title, production_year from writer)) as m
group by m.id
having count(m.id) = (
select max(m1.maxx)
from
(select m.id, count(m.id) as maxx
from
((select id, title, production_year from director)
union
(select id, title, production_year from writer)) as m
group by m.id) as m1);",2018-08-30 18:59:38.196145+10,14,0,271,noninterpretable
7748,"SELECT count(title)
FROM writer_award w NATURAL JOIN person p
WHERE p.first_name IN ('Woody') AND w.production_year >= 1991 AND w.production_year <= 1995;
",2018-08-30 19:00:42.993851+10,9,1,403,correct
7749,"select d.id, da.title, da.production_year from director_award as da, director as d
where lower(da.result) = lower('nominated')
and d.title = da.title
and d.production_year = da.production_year
and d.id not in (select d.id from director_award as da, director as d
where lower(da.result) = lower('won') and d.title = da.title and d.production_year = da.production_year);",2018-08-30 19:00:46.60416+10,13,0,92,partially correct
7750,"select distinct p.first_name||' '|| p.last_name as 'actors/actresses'
 from person p ,role r, appearance a
 where a.title = r.title
 and a.production_year=r.production_year
 and a.description=r.description
 and p.id=r.id
 and lower(a.title)='psycho'
 and a.production_year=1960
 ;",2018-08-30 19:01:10.079467+10,10,0,374,partially correct
7751,"select d.id, da.title, da.production_year from director_award as da, director as d
where lower(da.result) = lower('nominated')
and d.title = da.title
and d.id not in (select d.id from director_award as da, director as d
where lower(da.result) = lower('won') and d.title = da.title);",2018-08-30 19:01:19.651212+10,13,0,92,partially correct
7752,"select count(distinct person.id) from person, writer
where writer.id = person.id and person.year_born = 1935;
",2018-08-30 19:01:23.459935+10,1,1,337,correct
7779,"SELECT DISTINCT p.first_name, P.last_name, p.id
FROM appearance a NATURAL JOIN role r NATURAL JOIN person p
WHERE a.title IN ('Psycho') AND a.production_year = 1960
ORDER BY scene_no;",2018-08-30 19:12:40.817621+10,10,0,403,partially correct
7782,"select production_year,title
from writer, person
where writer.id = person.id and lower(first_name) = 'kevin' and lower(last_name) = 'Williamson'
;",2018-08-30 19:13:51.596709+10,5,0,261,partially correct
7884,"select count(p.id) from person as p, writer as w
where p.year_born = 1935
and p.id = w.id;",2018-08-30 19:47:58.631044+10,1,0,92,partially correct
7753,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-30 19:02:30.890554+10,11,1,140,correct
7754,select p.id from person as p where p.id=0; ,2018-08-30 19:02:44.965437+10,14,0,31,partially correct
7755,"SELECT COUNT(*)

FROM movie m

WHERE NOT EXISTS (
	SELECT title, production_year 
	FROM 
	movie_award ma
	WHERE 
	lower(ma.result)='won' AND m.title=ma.title AND m.production_year=ma.production_year
	
	UNION
	SELECT title, production_year 
	FROM
	crew_award ca
	WHERE lower(ca.result)='won' AND m.title=ca.title AND m.production_year=ca.production_year
	
	UNION
	SELECT title, production_year 
	FROM
	director_award da
	WHERE lower(da.result)='won'AND m.title=da.title AND m.production_year=da.production_year
	
	UNION
	SELECT title, production_year 
	FROM
	writer_award wa
	WHERE
	lower(wa.result)='won'AND m.title=wa.title AND m.production_year=wa.production_year
	
	UNION
	SELECT title, production_year 
	FROM
	actor_award aa
	WHERE
	lower(aa.result)='won' AND m.title=aa.title AND m.production_year=aa.production_year);
",2018-08-30 19:02:57.511717+10,11,1,421,correct
7756,"select m.id
from
(select id, title, production_year from director
union
select id, title, production_year from writer) as m
group by m.id
having count(m.id) = (
select max(m1.maxx)
from
(select m.id, count(m.id) as maxx
from
(select id, title, production_year from director
union
select id, title, production_year from writer) as m
group by m.id) as m1);",2018-08-30 19:03:25.27765+10,14,1,271,correct
7757,"select distinct p.first_name , p.last_name from 
appearance a,
role r,
person p
where 
	a.title ='Psycho' 
	and a.production_year = 1960
	and r.title = 'Psycho'
	and r.production_year = 1960
	and r.id = p.id
	and r.description = a.description;",2018-08-30 19:03:26.866299+10,10,0,332,partially correct
7758,"
select P.first_name,P.last_name,R.title, R.production_year, R.description from Person P inner join Role  R on P.id=R.id

where P.id=

(select id from 
	(
	  select id,count(*)as c from Role
	  group by id
	)AS N
  where c=
	(
	 select MAX(c) from
	  (select count(*)c from Role
	  group by id)AS M
));",2018-08-30 19:03:34.681253+10,15,1,202,correct
7759,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-30 19:04:09.473173+10,12,1,373,correct
7760,"select d.id, da.title, da.production_year from director_award as da, director as d
where lower(da.result) = lower('nominated')
and d.title = da.title
and d.id not in (select d.id from director_award as da, director as d
where lower(da.result) = lower('won') and d.title = da.title);
",2018-08-30 19:04:21.746499+10,13,0,92,partially correct
7761,"select p.id,p.first_name,p.last_name from person p
where p.year_born in( select max(year_born)from person p);",2018-08-30 19:04:24.541209+10,7,1,323,correct
7762,"select count(*) from person p where exists(select * from writer w where w.id=p.id and p.year_born=1935);
",2018-08-30 19:04:51.588405+10,1,1,306,correct
7763,"select count(*)
from writer_award wa, person p
where lower(wa.result)='won'
and wa.id=p.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award>1990
and wa.year_of_award<1996;",2018-08-30 19:04:54.050346+10,9,1,110,correct
7764,"select d.id, da.award_name, da.year_of_award from director_award as da, director as d
where lower(da.result) = lower('nominated')
and d.title = da.title
and d.id not in (select d.id from director_award as da, director as d
where lower(da.result) = lower('won') and d.title = da.title);
",2018-08-30 19:04:55.523232+10,13,0,92,partially correct
7765,"select count(*)
from movie m
where not exists 
(select title,production_year from movie_award ma where lower(result)='won' 
and m.title=ma.title and m.production_year=ma.production_year
union
select title,production_year from crew_award ca where lower(result)='won' 
and m.title=ca.title and m.production_year=ca.production_year
union
select title,production_year from director_award da where lower(result)='won' 
and m.title=da.title and m.production_year=da.production_year
union
select title,production_year from writer_award wa where lower(result)='won' 
and m.title=wa.title and m.production_year=wa.production_year
union
select title,production_year from actor_award aa where lower(result)='won' 
and m.title=aa.title and m.production_year=aa.production_year
);
",2018-08-30 19:05:13.464931+10,11,1,397,correct
7766,"select d.id, da.award_name, da.year_of_award, da.category from director_award as da, director as d
where lower(da.result) = lower('nominated')
and d.title = da.title
and d.id not in (select d.id from director_award as da, director as d
where lower(da.result) = lower('won') and d.title = da.title);
",2018-08-30 19:05:28.394669+10,13,1,92,correct
7767,";
      ",2018-08-30 19:06:25.51893+10,13,0,261,noninterpretable
7768,"select distinct p.id from 
appearance a,
role r,
person p
where 
	a.title ='Psycho' 
	and a.production_year = 1960
	and r.title = 'Psycho'
	and r.production_year = 1960
	and r.id = p.id
	and r.description = a.description
group by r.id
having count(*)=1;",2018-08-30 19:06:25.877869+10,10,1,332,correct
7769,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE da.title=d.title AND da.production_year=d.production_year AND lower(da.result)='nominated'
AND  d.id NOT in (SELECT d.id
               FROM director_award da,director d
		    WHERE da.title=d.title AND da.production_year=d.production_year AND da.result='won');",2018-08-30 19:07:13.496668+10,13,1,368,correct
7770,"select count(title) as movieNumber, production_year
from movie
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by production_year;",2018-08-30 19:07:38.005682+10,2,1,337,correct
7771,"SELECT country FROM restriction
WHERE description = 'M' and title = 'Shakespeare in Love';",2018-08-30 19:08:13.634901+10,6,1,320,correct
7772,"SELECT id, first_name, last_name, MAX(year_born) FROM PERSON;",2018-08-30 19:08:34.964564+10,7,0,50,partially correct
7773,"select first_name, last_name, title, production_year, description
from
role
natural join
person
where id in (
select m.id
from
(select id, count(id) as maxx
from		
role
natural join
person
group by id) as m
where m.maxx=
(select max(m.maxx)
from (select id, count(id) as maxx
from		
role
natural join
person
group by id) as m)
);",2018-08-30 19:08:43.438665+10,15,1,271,correct
7774,"select production_year, count(title) as movieNumber
from movie
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by production_year;",2018-08-30 19:08:49.309004+10,2,1,337,correct
7775,"select r.id
from role r, scene s, appearance a
where a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and s.title=r.title
and s.production_year=r.production_year
and a.description=r.description
and lower(r.title)='psycho'
and r.production_year=1960
group by r.id
having count(*)=1;",2018-08-30 19:09:08.559754+10,10,1,110,correct
7776,"SELECT id

FROM person p

	SELECT(*
	
	FROM 
	;",2018-08-30 19:09:10.914588+10,3,0,421,noninterpretable
7777,"
select res.id
from person res
where res.year_born =(

select max(year_born)
from person
where person.year_born <(select max(p.year_born)
	from person p

)




)

;",2018-08-30 19:10:02.481912+10,3,1,387,correct
7778,SELECT count(*) person WHERE EXISTS(SELECT * from );,2018-08-30 19:12:11.845885+10,12,0,213,noninterpretable
7780,"select count *
from Writer,Person
where writer.id = person.id and year_born = 1935;",2018-08-30 19:12:55.891741+10,1,0,292,noninterpretable
7783,"SELECT p.id

FROM person p

WHERE p.year_born = 
	(SELECT MAX(year_born)
	FROM person
	WHERE year_born < 
		(SELECT MAX(year_born)
		FROM person))
;",2018-08-30 19:14:09.324727+10,3,1,421,correct
7784,"SELECT *
FROM person
WHERE year_born='1935';",2018-08-30 19:14:54.459877+10,1,0,322,partially correct
7785,"select production_year,title
from writer, person
where writer.id = person.id and lower(first_name) = 'kevin' and lower(last_name) = 'williamson'
;",2018-08-30 19:15:12.752127+10,5,1,261,correct
7786,"select production_year, count(*) from movie m where production_year>1990 and production_year<1994 group by production_year;",2018-08-30 19:15:17.287457+10,2,1,306,correct
7787,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM person
				where year_born < (SELECT MAX(year_born) FROM person));",2018-08-30 19:15:52.616672+10,3,1,132,correct
7788,"select id,award_name ,year_of_award ,category 
from director_award natural join director
where result = 'nominated'

;",2018-08-30 19:16:02.260324+10,13,1,387,correct
7789,"SELECT COUNT(*)
FROM(
SELECT *
FROM person
WHERE year_born='1935')
AS ct;",2018-08-30 19:16:03.230589+10,1,0,322,partially correct
7790,"select title,production_year
from writer, person
where writer.id = person.id and lower(first_name) = 'kevin' and lower(last_name) = 'williamson'
;",2018-08-30 19:16:25.451349+10,5,1,261,correct
7791,;,2018-08-30 19:16:47.054263+10,13,0,421,noninterpretable
7792,"SELECT COUNT(*)
FROM(
SELECT *
FROM person, writer
WHERE person.id=writer.id AND year_born='1935')
AS ct;",2018-08-30 19:18:23.874473+10,1,0,322,partially correct
7793,"SELECT count(*) FROM PERSON P
WHERE EXISTS (SELECT * FROM WRITER W 
WHERE P.ID = W.ID AND P.year_born = 1935);",2018-08-30 19:18:41.780625+10,1,1,367,correct
7794,SELECT COUNT(person.id) FROM person INNER JOIN writer ON person.id=writer.id;,2018-08-30 19:18:44.335847+10,1,0,166,partially correct
7795,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    role r
where 
a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.description=r.description
and a.title=r.title
and a.production_year=r.production_year
AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
group by r.id
having count(*)=1;",2018-08-30 19:19:17.543284+10,10,1,374,correct
7796,"with worker as (select id, title, production_year
from director 
union select id,title, production_year
from writer)

select distinct w.id
from worker w,(select id,count(*) as count
	from worker
	group by id
	having count = (select max(c)
			from (select count(*) as c
				from worker
				group by id) w_count)) max_w
where w.id = max_w.id;

",2018-08-30 19:19:30.630811+10,14,1,348,correct
7797,"select sum(year_born)=1935
from writer natural join person;",2018-08-30 19:19:44.775051+10,1,0,432,partially correct
7798,"select pd.title, pd.production_year, pd.first_name, pd.last_name from( person p natural join director d )as pd
where pd.title in
(select title from movie_award ma
where ma.award_name =  ""BAFTA Film Award""
and ma.category=""best film"" and ma.result= 'won');",2018-08-30 19:19:47.934835+10,8,1,323,correct
7799,"select count(*)
from movie m
where not exists (select result from movie_award ma where lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
union
select result from crew_award ca where lower(ca.result)='won' and ca.title=m.title and ca.production_year=m.production_year
union
select result from director_award da where lower(da.result)='won' and da.title=m.title and da.production_year=m.production_year
union
select result from writer_award wa where lower(wa.result)='won' and wa.title=m.title and wa.production_year=m.production_year
union
select result from actor_award aa where lower(aa.result)='won' and aa.title=m.title and aa.production_year=m.production_year);",2018-08-30 19:20:16.174503+10,11,1,110,correct
7800,"SELECT id, first_name, last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-30 19:20:54.762093+10,7,1,320,correct
7801,"select production_year,count(*) as numbers
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-30 19:21:10.220405+10,2,1,292,correct
7802,select * from role where id=0;,2018-08-30 19:21:25.201628+10,15,0,31,partially correct
7803,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 19:21:34.963032+10,1,1,432,correct
7804,"select u.id from (director d natural join writer w natural join movie) u group by u.id having count(*)=(select max(noofmovie) from (select u.id, count(*) as noofmovie from (director d natural join writer w natural join movie) u ) v);",2018-08-30 19:21:35.083083+10,14,0,270,partially correct
7805,"with p_max as (select id
from role
group by id
having count(*) = (select max(count)
	from (select count(*) as count
		from role
		group by id) r_count))
		

select first_name, last_name, title, production_year, description
from person p, role r, p_max pm
where p.id = pm.id and r.id = pm.id;",2018-08-30 19:21:38.529758+10,15,1,348,correct
7806,SELECT COUNT(person.id) FROM person INNER JOIN writer ON person.id=writer.id AND person.year_born='1935';,2018-08-30 19:22:03.039486+10,1,0,166,partially correct
7807,"select count(*) 
from movie m
where(not exists (select * from movie_award ma where ma.title = m.title  and ma.production_year = m.production_year))
and (not exists (select * from crew_award ca where ca.title = m.title  and ca.production_year = m.production_year))
and (not exists (select * from director_award da where da.title = m.title  and da.production_year = m.production_year))
and (not exists (select * from writer_award wa where wa.title = m.title  and wa.production_year = m.production_year))
and (not exists (select * from actor_award aa where aa.title = m.title  and aa.production_year = m.production_year));",2018-08-30 19:22:15.564434+10,11,0,332,partially correct
7808,"SELECT DISTINCT p.first_name, P.last_name, p.id
FROM appearance a NATURAL JOIN role r NATURAL JOIN person p
WHERE a.title IN ('Psycho') AND a.production_year = 1960
ORDER BY scene_no;",2018-08-30 19:22:24.158724+10,10,0,403,partially correct
7809,"select id 
from person
where year_born= (select max(year_born)
from person
where year_born !=(select max(year_born) from person ));",2018-08-30 19:22:43.606976+10,3,1,140,correct
7810,"SELECT production_year,count(*) FROM Movie 
Group by production_year Having production_year >= 1991 AND production_year <= 1993;",2018-08-30 19:22:55.14167+10,2,1,367,correct
7811,"SELECT person.id, person.first_name, person.last_name
FROM person p
WHERE EXISTS (SELECT * FROM director d, writer w WHERE p.id = d.id AND d.id = w.id);",2018-08-30 19:24:00.85644+10,4,0,373,noninterpretable
7812,"select count(id) 
from person
where not exists (select * 
from director
where person.id = director.id);",2018-08-30 19:24:04.392214+10,12,1,337,correct
7813,"SELECT p.id,da.award_name,da.year_of_award,da.category
FROM person p,director d,director_award da
WHERE p.id=d.id and d.title=da.title and d.production_year=da.production_year and lower(da.result)='nominated' and EXISTS

(SELECT p.id,da.award_name,da.year_of_award,da.category
FROM person p,director d,director_award da
WHERE p.id=d.id and d.title=da.title and d.production_year=da.production_year and lower(da.result)='won');




",2018-08-30 19:24:04.793019+10,13,1,132,correct
7814,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 19:24:05.245918+10,13,1,421,correct
7815,"select count(*) from writer_award  wa
where wa.result='won'and wa.id in
(select id from person p
where p.first_name=""Woody"" and p.last_name=""Allen"") ;",2018-08-30 19:25:03.443565+10,9,1,323,correct
7816,"select p.first_name, p.last_name from appearance a inner join role r on 
r.title = a.title and r.production_year = a.production_year inner join person p on 
p.id = r.id
where r.production_year = 1960
group by p.id
having count(*) > 1;
",2018-08-30 19:25:06.461053+10,10,0,130,partially correct
7817,"select p.id 
from person,person p
where person.id=p.id
and p.year_born=(select max(year_born) from (select * from person
where (year_born)<(select max(year_born) from person)) as p2);",2018-08-30 19:25:38.682962+10,3,1,397,correct
7818,"select pr.first_name,pr.last_name,pr.title,pr.production_year,pr.description
from (person natural join role) as pr
where pr.id=
(select r1.id
from
(select id, count(*) as count1
from role 
group by id) as r1

where r1.count1 =(
select max(count2)
from
(select id, count(*) as count2
from role
group by id) as r2));


",2018-08-30 19:25:46.476997+10,15,1,364,correct
7819,"select count(*),production_year
from movie
where  production_year=1993 or  production_year=1992 or  production_year=1991
group by  production_year;",2018-08-30 19:25:58.026278+10,2,1,432,correct
7820,"select title,production_year from movie 
intersect 
select title,production_year from movie_award
where lower(result) = 'won'
except
select title,production_year from crew_award
where lower(result) = 'won'
except
select title,production_year from director_award
where lower(result) = 'won'
except
select title,production_year from writer_award
where lower(result) = 'won'
except
select title,production_year from actor_award
where lower(result) = 'won';",2018-08-30 19:26:28.105703+10,11,0,348,partially correct
7821,"select count(*)
from person
where not exists(select * from director where person.id = director.id);",2018-08-30 19:26:46.361184+10,12,1,292,correct
7822,select count(*) from person p where not exists(select * from director d where d.id=p.id);,2018-08-30 19:26:59.349642+10,12,1,306,correct
7823,"select p.first_name,p.last_name,r.title,r.production_year,r.description from role as r, person as p where 
p.id=r.id AND
p.id in (select id from role Group by id order by count(*) desc limit 1);",2018-08-30 19:27:53.021614+10,15,1,31,correct
7824,"
select count(*)
from (select title,production_year from movie 
except
select title,production_year from movie_award
where lower(result) = 'won'
except
select title,production_year from crew_award
where lower(result) = 'won'
except
select title,production_year from director_award
where lower(result) = 'won'
except
select title,production_year from writer_award
where lower(result) = 'won'
except
select title,production_year from actor_award
where lower(result) = 'won');",2018-08-30 19:27:58.183846+10,11,1,348,correct
7825,"

SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id=p.id);

",2018-08-30 19:28:05.428039+10,12,1,195,correct
7826,"select id,count(*)  cnt from (
     select id ,title,production_year  from director 
     union 
     select id ,title,production_year  from writer  )  a
  group by a.id 
  having count(*)=( select max(cnt)  maxcnt  from (
    select id,count(*)  cnt from (
       select id ,title,production_year  from director 
       union 
       select id ,title,production_year  from writer  )  a
    group by a.id 
    )  ) ;",2018-08-30 19:28:12.519263+10,14,0,205,partially correct
7827,"SELECT id, first_name, last_name FROM person WHERE year_born = (SELECT max(year_born) FROM person);",2018-08-30 19:29:05.429485+10,7,1,50,correct
7828,"select id,count(*)  from (
     select id ,title,production_year  from director 
     union 
     select id ,title,production_year  from writer  )  a
  group by a.id 
  having count(*)=( select max(cnt)  maxcnt  from (
    select id,count(*)  cnt from (
       select id ,title,production_year  from director 
       union 
       select id ,title,production_year  from writer  )  a
    group by a.id 
    )  ) ;",2018-08-30 19:29:07.964406+10,14,0,205,partially correct
7829,"select p.id
from person p
where p.year_born=(select max(p1.year_born) 
from person p1 
where p1.year_born<(select max(p2.year_born) 
from person p2));",2018-08-30 19:29:08.285224+10,3,1,110,correct
7830,"SELECT id

FROM person p

WHERE MAX(COUNT(*);


",2018-08-30 19:29:12.874789+10,14,0,421,noninterpretable
7831,"SELECT count(*) FROM Person p
WHERE NOT EXISTS (SELECT * FROM Director d WHERE p.id = d.id);",2018-08-30 19:29:26.044665+10,12,1,367,correct
7832,"select id  from (
     select id ,title,production_year  from director 
     union 
     select id ,title,production_year  from writer  )  a
  group by a.id 
  having count(*)=( select max(cnt)  maxcnt  from (
    select id,count(*)  cnt from (
       select id ,title,production_year  from director 
       union 
       select id ,title,production_year  from writer  )  a
    group by a.id 
    )  ) ;",2018-08-30 19:29:31.139831+10,14,1,205,correct
7833,"select production_year,count(*)
from movie
where  production_year = 1991 OR production_year = 1992 OR production_year = 1993
group by  production_year;",2018-08-30 19:29:33.528946+10,2,1,432,correct
7834,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND first_name= 'Kevin'
    AND last_name= 'Williamson';",2018-08-30 19:29:45.211292+10,5,1,195,correct
7835,"select count(*) 
from movie m
where
	(not exists (
select title, production_year from movie_award ma 
	where ma.title = m.title  and ma.production_year = m.production_year and lower(ma.result)='won'
union
select title, production_year from crew_award ca 
	where ca.title = m.title  and ca.production_year = m.production_year and lower(ca.result)='won'
union
select title, production_year from director_award da 
	where da.title = m.title  and da.production_year = m.production_year and lower(da.result)='won'
union
select title, production_year from writer_award wa 
	where wa.title = m.title  and wa.production_year = m.production_year and lower(wa.result)='won'
union
select title, production_year from actor_award aa 
	where aa.title = m.title  and aa.production_year = m.production_year and lower(aa.result)='won'));",2018-08-30 19:30:59.297754+10,11,1,332,correct
7836,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);


",2018-08-30 19:31:02.77627+10,14,1,421,correct
7837,;,2018-08-30 19:31:35.48394+10,15,0,421,noninterpretable
7838,"select person.id,first_name,last_name
from person
where (select count(*) from director,writer where director.id = writer.id and writer.id = person.id) > 1;",2018-08-30 19:31:46.267335+10,4,0,292,partially correct
7839,"select b.id from (select a.id,count(*) as w_num from (select d.id,title,production_year from director d union select w.id,title,production_year from writer w) as a group by id)as b where b.w_num=(select max(b.w_num) from(select a.id,count(*) as w_num from (select d.id,title,production_year from director d union select w.id,title,production_year from writer w) as a group by id)as b);",2018-08-30 19:31:47.335069+10,14,1,117,correct
7840,"select count(*) from
(select title,production_year from movie m
where m.title not in (
select ma.title  from 
 movie_award ma,  crew_award, director_award, writer_award, actor_award

) 





)as aa;",2018-08-30 19:32:22.693507+10,11,0,374,partially correct
7841,"select id from
(
select count (title) as countt, id from 
(select distinct d.id, d.title, d.production_year from director as d union select distinct w.id, w.title, w.production_year from writer as w)
group by id
)
where countt=3; 
",2018-08-30 19:32:35.071675+10,14,1,92,correct
7842,"
WHERE COUNT(id) AS c  
GROUP BY wd.id;",2018-08-30 19:32:45.616596+10,14,0,368,noninterpretable
7843,"select id from
(
select count (title) as countt, id from 
(select distinct d.id, d.title, d.production_year from director as d union select distinct w.id, w.title, w.production_year from writer as w)
group by id
)
where countt=(select max(countt) from
(
select count (title) as countt, id from 
(select distinct d.id, d.title, d.production_year from director as d union select distinct w.id, w.title, w.production_year from writer as w)
group by id
)); 
",2018-08-30 19:33:25.8296+10,14,1,92,correct
11818,select count(p.id) from person p where p.id not in (select distinct w.id from writer w);,2018-08-31 15:32:18.157875+10,12,0,461,partially correct
7844,"select count(*)
from movie m
where 
not exists (select * from movie_award ma 
where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) ='won')

and not exists (select * from Crew_Award ca 
where ca.title = m.title and ca.production_year = m.production_year and lower(ca.result) ='won')

and not exists (select * from Director_Award da
where da.title = m.title and da.production_year = m.production_year and lower(da.result) ='won')

and not exists (select * from Actor_award aa
where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) ='won')

and not exists (select * from writer_award wa
where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) ='won');",2018-08-30 19:34:00.379293+10,11,1,338,correct
7845,"select count(*)
from director, person
where not director.id=person.id;",2018-08-30 19:34:03.922462+10,12,0,432,partially correct
7846,"select count(*) from person as p , writer as w where p.id=w.id
AND
p.year_born=1935;
",2018-08-30 19:34:06.72843+10,1,0,31,partially correct
7847,"select p.id 
from person p
where p.year_born=(select max(year_born) 
		from person 
		where year_born<(select max(year_born) from person) );",2018-08-30 19:34:16.707367+10,3,1,397,correct
7848,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-30 19:35:39.200944+10,12,1,432,correct
7849,"SELECT id,first_name,last_name
FROM PERSON,Director
;
",2018-08-30 19:36:31.138102+10,12,0,260,noninterpretable
7850,"select count(Distinct p.id) from person as p , writer as w where p.id=w.id
AND p.year_born=1935;
",2018-08-30 19:36:50.881624+10,1,1,31,correct
7851,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 19:36:54.838857+10,4,1,292,correct
7852,"select d.id, da.award_name, da.year_of_award,da.category
from director_award da, director d  
where da.title = d.title
and da.production_year=d.production_year
and da.result='nominated'
and d.id not in (select d1.id 
from director d1, director_award da1
where d1.title=da1.title
and da1.production_year=d1.production_year
and lower(da1.result)='won');
",2018-08-30 19:37:37.777394+10,13,1,110,correct
7853,select from person where year_born = 1935 and id natural join writer;,2018-08-30 19:38:37.472416+10,1,0,433,noninterpretable
7854,"SELECT id, first_name, last_name From person Where EXISTS(SELECT count(*) from writer WHERE writer.title = movie.title AND 
writer.production_year = movie.production_year) GROUP BY id having count(*) > 1;",2018-08-30 19:39:16.187261+10,4,0,213,noninterpretable
7855,"select p.first_name, p.last_name, r1.title, r1.production_year, r1.description from person as p, role as r1,
(select max(countidrole), id from (select count(r.id) as countidrole, r.id from Role as r group by r.id)) as rolemax
where p.id = rolemax.id
and r1.id = rolemax.id;",2018-08-30 19:39:31.411816+10,15,1,92,correct
7856,"select * from
(select id, row_number() over (group by year_born order by year_born) as rn 
	from persion)
where rn =2;",2018-08-30 19:39:36.157255+10,3,0,332,noninterpretable
7857,"select p.id, p.first_name, p.last_name from person p, writer w, director d where p.id=w.id=d.id and w.title=d.title group by p.id having count(*)>=2;",2018-08-30 19:40:03.249114+10,4,0,306,partially correct
7858,"select writer.title,writer.production_year
from writer
where exists(select * from person where person.id = writer.id and first_name = '/Kevin/' and last_name = '/Williamson/');",2018-08-30 19:41:17.489054+10,5,0,292,partially correct
7859,"select count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born =1935);
",2018-08-30 19:42:00.096201+10,1,1,433,correct
7860,"select writer.title,writer.production_year
from writer
where exists(select * from person where person.id = writer.id and first_name = 'Kevin' and last_name = 'Williamson');",2018-08-30 19:42:00.476007+10,5,1,292,correct
7861,"select p.id 
from person p
where p.year_born = (select Max(year_born) from person
	where year_born < (select max(year_born) from person)
);",2018-08-30 19:42:25.034817+10,3,1,332,correct
7862,"select u.id from (select u1.id, count(*) as noofmovie from (director d natural join writer w natural join movie m) u1 group by u1.id) u where u.noofmovie=(select max(u2.noofmovie) from (select u3.id,count(*) as noofmovie from (director d natural join writer w natural join movie m) u3 group by u3.id) u2 )  group by u.id;",2018-08-30 19:42:34.465619+10,14,0,270,partially correct
7863,"select count(distinct p.id) 
from writer w inner join person p
on w.id = p.id
where p.year_born =1935
group by p.id;",2018-08-30 19:42:37.921287+10,1,1,153,correct
7864,"select first_name, last_name, title, production_year, description from person p natural join role r
where p.id = (select id from 
(select id, count(*) from person p natural join role r 
group by id 
having count(*)= (select max (pr1.roleno) 
                   from (select count(*) as roleno from person p natural join role r group by id) as pr1)));",2018-08-30 19:43:00.447805+10,15,1,274,correct
7865,;,2018-08-30 19:43:36.55355+10,11,0,403,noninterpretable
7866,"SELECT first_name,last_name,title,production_year,description
FROM person p,role r
WHERE p.id=r.id
GROUP By p.id
order by count(*) DESC;
",2018-08-30 19:43:37.518037+10,15,0,132,partially correct
7867,"select id,award_name,year_of_award,category
from director_award da,director d
where not exists
(select * from director_award da1
where da.title=da1.title and da.production_year=da1.production_year and 
lower(da1.result)='won')
and da.title=d.title
and da.production_year=d.production_year;",2018-08-30 19:43:45.265283+10,13,1,397,correct
7868,"select country
from restriction
where title =  'Shakespeare in Love' and description = 'M';",2018-08-30 19:43:58.770429+10,6,1,292,correct
7869,"SELECT count(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT id
FROM director d
WHERE p.id = d.id)
;
",2018-08-30 19:44:01.054883+10,12,1,260,correct
7870,"select production_year,count(*) from movie as m where production_year>=1991 AND production_year<=1993 
Group by production_year;",2018-08-30 19:44:10.641534+10,2,1,31,correct
7871,"select first_name,last_name,title,production_year,description
from (person natural join role) as pr
where pr.id =(










select r1.id
from
(SELECT id,count(*) as count1
from role
group by id) as r1

where r1.count1=(






select max(count2)
from
(SELECT id,count(*) as count2
from role
group by id) as r2));",2018-08-30 19:44:11.854807+10,15,1,367,correct
7872,"SELECT count (*)
FROM PERSON p
WHERE NOT EXISTS(SELECT id
FROM director d
WHERE p.id = d.id)
;
",2018-08-30 19:44:38.88082+10,12,1,260,correct
7873,"SELECT dw.id, dw.first_name, dw.last_name FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id HAVING count(*) > 1;
",2018-08-30 19:44:53.983054+10,4,1,213,correct
7874,"select id,award_name,year_of_award,category
from director_award da,director d
where not exists
(select * from director_award da1
where da.title=da1.title and da.production_year=da1.production_year and 
lower(da1.result)='won')
and lower(da.result)='nominated'
and da.title=d.title
and da.production_year=d.production_year;",2018-08-30 19:44:58.918388+10,13,1,397,correct
7875,"SELECT count (id)
FROM PERSON p
WHERE NOT EXISTS(SELECT id
FROM director d
WHERE p.id = d.id)
;
",2018-08-30 19:45:17.906465+10,12,1,260,correct
7876,select year_born from person delete max(year_born);,2018-08-30 19:45:33.678459+10,3,0,323,noninterpretable
7877,"Select Count(id) from Person p
where not exists(Select id from Director d
where p.id = d.id );",2018-08-30 19:46:01.716128+10,12,1,71,correct
7878,"select person.id, first_name, last_name
from person
where exists(
	select distinct id, count(title) 
	from director
	where director.id = person.id
	and exists(
		select * 
		from writer
		where writer.id = director.id
		)
	group by id
	having count(title) >= 2
	);",2018-08-30 19:47:07.675305+10,4,0,337,partially correct
7879,"Select w.id, p.first_name, p.last_name from Person p ,
Director d
inner join
Writer w
on d.title = w.title and w.production_year = d.production_year
where p.id = w.id
group by w.id
having Count(w.id) >1;",2018-08-30 19:47:28.891466+10,4,0,71,partially correct
7880,select count(*) from person where person.id NOT in (select d.id from director as d);,2018-08-30 19:47:30.859163+10,12,1,31,correct
7881,"SELECT first_name,last_name FROM PERSON;",2018-08-30 19:47:40.766189+10,1,0,61,partially correct
7882,"SELECT id, first_name, last_name
FROM person p
WHERE director.id = writer.id
;",2018-08-30 19:47:42.337694+10,4,0,260,noninterpretable
7885,"select distinct id, award_name, year_of_award, category
from director, director_award, 
(select title, production_year from director_award 
where (select count(*) from director_award where result='nominated')>0) as h
where director.title=director_award.title
and director.production_year=director_award.production_year
and result!='won';

",2018-08-30 19:48:20.3094+10,13,1,140,correct
7886,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE result = 'won' AND award_name = 'BAFTA Film Award';",2018-08-30 19:48:26.786758+10,8,0,320,partially correct
7887,"select id,first_name,last_name
from person
where year_born = (select max(year_born) from person);",2018-08-30 19:48:50.74162+10,7,1,292,correct
7888,"select person.id, first_name, last_name
from person
where exists(
	select distinct id, count(title) 
	from director
	where director.id = person.id
	and exists(
		select * 
		from writer
		where writer.id = director.id and writer.title = director.title
		)
	group by id
	having count(title) >= 2
	);",2018-08-30 19:48:56.101562+10,4,1,337,correct
7889,"select count(p.id) from person as p
where p.year_born = 1935
and p.id in (select w.id from writer as w);",2018-08-30 19:49:05.949746+10,1,1,92,correct
7890,"select count(title)
from director,writer,movie
where director.production_year = movie.production_year
     and director.title = movie.title
     and writer.production_year = movie.production_year
     and writer.title = movie.title
group by id;",2018-08-30 19:49:35.717608+10,14,0,261,noninterpretable
7891,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 19:49:43.20959+10,14,1,270,correct
7892,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 19:49:44.144134+10,5,1,352,correct
7893,"select count(p.id) from person as p
where p.id in (select w.id from writer as w)
and p.year_born = 1935;",2018-08-30 19:49:49.465908+10,1,1,92,correct
7894,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 19:49:52.512325+10,5,1,352,correct
7895,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE result = 'won' AND award_name = 'BAFTA Film Award' AND category = 'Best Film';",2018-08-30 19:49:55.438456+10,8,0,320,partially correct
7896,"select production_year, count(*)
from movie m
where m.production_year = 1993 or m.production_year =1992 or m.production_year =1991
group by production_year;",2018-08-30 19:50:15.588027+10,2,1,153,correct
7897,"select p.id
from person p natural join(

select id, max(number)
from(
select count(*) as number,id
from(
select distinct id,title,production_year
from (
	select d.id, d.title,d.production_year
	from director d
	union
	select w.id, w.title,w.production_year
	from writer w
)

)
group by id

)
)
where p.id =id










;",2018-08-30 19:50:22.999425+10,14,0,387,partially correct
7898,"select production_year, count (title) from movie
where production_year >= 1991
and production_year <=1993
group by production_year;",2018-08-30 19:51:39.991591+10,2,1,92,correct
7899,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 19:52:57.564681+10,11,1,374,correct
7900,"select count(p.id) from person as p
where p.id not in (select d.id from director as d);",2018-08-30 19:53:15.786236+10,12,1,92,correct
7901,;,2018-08-30 19:53:22.659729+10,15,0,261,noninterpretable
7902,"SELECT COUNT(*)
FROM WRITER w, PERSON p
WHERE w.id = p.id
AND p.year_born = '1935';


",2018-08-30 19:53:48.096382+10,1,0,191,partially correct
7903,"select r.id from scene s , role r , appearance a 
where 
a.title = r.title 
and 
a.production_year = r.production_year
and
a.scene_no = s.scene_no
and
r.title = s.title
and 
r.production_year = s.production_year
and
lower(r.title) = 'psycho'
and 
r.production_year = 1960
and 
r.description = a.description
group by r.id
having count(r.id) = 1;
",2018-08-30 19:54:10.072834+10,10,1,130,correct
7904,"SELECT COUNT(p.id)
FROM person p
WHERE NOT EXISTS(
	SELECT *
	FROM director d
	WHERE d.id = p.id);",2018-08-30 19:54:37.785224+10,12,1,285,correct
7905,"

select id
from person natural join(

select count(*) as number,id
from(
select distinct id,title,production_year
from (
	select d.id, d.title,d.production_year
	from director d
	union
	select w.id, w.title,w.production_year
	from writer w
)

)
group by id
order by number desc
limit 3


)










;",2018-08-30 19:54:45.65442+10,14,1,387,correct
7906,"SELECT COUNT(p.id)
FROM person p
WHERE NOT EXISTS(
	SELECT *
	FROM director d
	WHERE d.id = p.id);",2018-08-30 19:55:01.28884+10,12,1,285,correct
7907,"select count(*)
from person p
where p.id not in(select d.id from director d);",2018-08-30 19:55:26.618431+10,12,1,153,correct
7908,"select director.title,production_year,first_name,last_name
from director,person
where director.id = person.id and exists(select * from movie_award where director.title = movie_award.title and award_name = 'BAFTA Film Award' and category = 'Best Film');",2018-08-30 19:55:31.682408+10,8,0,292,partially correct
7909,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE result = 'won' AND award_name = 'BAFTA Film Award' AND category = 'best film';",2018-08-30 19:55:40.769785+10,8,1,320,correct
7910,"select id, first_name, last_name
from person ,p right join director,d as p.id=d.id
where (select count(*)
	from director)>=2;",2018-08-30 19:55:51.027445+10,4,0,432,noninterpretable
7911,"select p.id,p.first_name,p.last_name from person as p, writer as w, director as d
where p.id =(select w.id where w.id=d.id AND d.title = w.title AND d.production_year = w.production_year);",2018-08-30 19:56:01.113308+10,4,0,31,partially correct
7912,"SELECT m.title,w.id,d.id
FROM movie m,writer w,director d
WHERE m.title=w.title
	and m.title=d.title
	and m.production_year=w.production_year
	and m.production_year=d.production_year;",2018-08-30 19:56:07.247747+10,14,0,132,partially correct
7913,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(
	SELECT *
	FROM director d
	WHERE d.id = p.id);",2018-08-30 19:56:08.252177+10,12,1,285,correct
7914,"select year_born as total_writers, COUNT(*)
from PERSON
where year_born < 1935;
",2018-08-30 19:56:25.309507+10,1,0,430,partially correct
7915,"select id from person a where 
a.year_born in
(select max(year_born)from person p0
where p0.year_born <(select max(year_born) from person p));",2018-08-30 19:57:25.657322+10,3,1,323,correct
7916,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 19:57:26.280767+10,4,1,432,correct
7917,"select r.id, p.first_name, p.last_name, r.title, r.production_year, r.description
from role r, person p
where r.id=(select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3)
and
p.id=(select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3);
",2018-08-30 19:58:05.072214+10,15,0,338,noninterpretable
7918,"SELECT production_year, COUNT(*) AS NoOfMovies
FROM MOVIE m
WHERE m.production_year = '1993' 
OR m.production_year = '1992'
OR m.production_year = '1991' 
GROUP BY m.production_year;",2018-08-30 19:58:11.386256+10,2,1,191,correct
7919,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-30 19:58:30.120214+10,4,1,373,correct
7920,"SELECT count(*) 
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id = person.id AND person.year_born = 1935);",2018-08-30 19:58:45.387809+10,1,1,430,correct
7921,"SELECT max(year_born)
FROM person
WHERE year_born<(SELECT max(year_born) FROM person)
ORDER BY year_born;",2018-08-30 19:59:22.934178+10,3,0,403,partially correct
7922,"select director.title,production_year,first_name,last_name
from director,person
where director.id = person.id and exists(select title  from movie_award
where movie_award.title = director.title
and lower(award_name) = 'bafta film award' 
and lower(category) = 'best film'
and lower(result) = 'won');",2018-08-30 20:00:24.220211+10,8,1,292,correct
7923,"SELECT id
FROM (SELECT year_born AS AGE FROM person p1)p
WHERE p.AGE
< ANY (SELECT p2.AGE FROM (SELECT year_born AS AGE FROM person p1)p2)
Having COUNT(*)=1;",2018-08-30 20:00:27.610772+10,3,0,424,noninterpretable
7924,"select count(*) from person p,writer w where p.id=w.id AND p.year_born=1935;
",2018-08-30 20:01:43.61711+10,1,0,437,partially correct
7925,"SELECT ma.title, ma.production_year,p.first_name,p.last_name
FROM person p, director d, (
	SELECT title, production_year 
	FROM Movie_Award
	WHERE award_name = 'BAFTA Film Award' AND lower(category) ='best film')AS ma
WHERE ma.title=d.title AND ma.production_year = d.production_year AND p.id = d.id;",2018-08-30 20:01:48.378821+10,8,0,54,partially correct
7926,"select p.id,p.first_name,p.last_name
from person p,(select d.id 
	from director d inner join writer w
	where d.title =w.title and d.production_year=w.production_year
	group by d.id
	having count(*) >1) as a
where a.id = p.id;",2018-08-30 20:02:00.657498+10,4,0,153,partially correct
7927,"select id from  
(select id , sum(dw.c)as s 
From (select id,count(*)as c from Director Group by id
union
select id,count(*) from Writer Group by id)as dw
Group by id)as dw2 
where dw2.s 

= (select Max(dw2.s)from 
(select id , sum(dw.c)as s 
From (select id,count(*)as c from Director Group by id
union
select id,count(*) from Writer Group by id)as dw
Group by id)as dw2);",2018-08-30 20:02:14.363706+10,14,0,367,partially correct
7928,"Select country from Restriction
where description like 'M' and title like 'Shakespeare in Love';
",2018-08-30 20:02:49.407408+10,6,1,71,correct
7929,"SELECT ws.title, ws.production_year from (person natural join writer natural join movie) as ws where (ws.first_name = ""Williamson"" and 
ws.last_name = ""Kelvin"") group by ws.title;
",2018-08-30 20:02:52.318052+10,5,0,213,partially correct
7930,"SELECT ma.title, ma.production_year,p.first_name,p.last_name
FROM person p, director d, (
	SELECT title, production_year 
	FROM Movie_Award
	WHERE award_name = 'BAFTA Film Award' AND lower(category) ='best film'AND lower(RESULT)='won')AS ma
WHERE ma.title=d.title AND ma.production_year = d.production_year AND p.id = d.id;",2018-08-30 20:02:52.721886+10,8,1,54,correct
7931," SELECT id, award_name, year_of_award, category
 FROM director d, director_award da
 WHERE ;",2018-08-30 20:03:49.143598+10,13,0,410,noninterpretable
7932,"Select id, first_name, last_name from person
where year_born = (Select max(year_born) from person);",2018-08-30 20:03:50.858114+10,7,1,71,correct
7933,"select d.id, ma.award_name, ma.year_of_award, ma.category
from director d, 
(
	select title, production_year, award_name, year_of_award, category
	from movie_award 
	where not exists (
			select title, production_year, award_name, year_of_award, category
			from movie_award 
			where lower(result)='won')
) ma, movie m
where d.title=m.title
and d.production_year=m.production_year
and ma.title=m.title
and ma.production_year=m.production_year;
",2018-08-30 20:03:53.693276+10,13,0,349,partially correct
7934,"select count(*)
from Writer_Award,person
where writer_award.id = person.id and first_name = 'Woody' and last_name = 'Allen'
group by award_name
having year_of_award < 1996 and year_of_award > 1990;",2018-08-30 20:03:53.942105+10,9,0,292,partially correct
7935,"select count(*)
from person
where exists
(
select *
from writer
where person.id = writer.id
and person.year_born = 1935
);",2018-08-30 20:04:57.353615+10,1,1,261,correct
7936,"select p.id,p.first_name,p.last_name from person as p,
(select count(d.id) as countid, d.id as did from director as d, writer as w 
where d.id = w.id
and d.title = w.title
and d.production_year = w.production_year
group by d.id) as countdw
where p.id = countdw.did
and countdw.countid>=2;
",2018-08-30 20:05:09.594883+10,4,1,92,correct
7937,"select count(*) from person p where exists (select * from writer w where p.id=w.id AND p.year_born=1935);
",2018-08-30 20:05:10.266079+10,1,1,437,correct
7938,"select p.id,p.first_name,p.last_name
from person p,(select d.id 
	from director d inner join writer w
	where d.title =w.title and d.production_year=w.production_year and d.id=w.id
	group by d.id
	having count(*) >1) as a
where a.id = p.id;",2018-08-30 20:05:11.373431+10,4,1,153,correct
7939,"Select Count(wa.title) from
writer_award wa
inner Join
Person p 
on wa.id = p.id
where p.first_name like 'Woody' and wa.result like 'won';",2018-08-30 20:05:20.457685+10,9,1,71,correct
7940,"Select tt.id from
(((Select a.description from Appearance a
where a.title like 'Psycho' and a.production_year like '1960'
group by a.description
having Count(a.scene_no) =1) as app
inner join 
Role r
on r.description = app.description) as outT
Inner join
Person p
on outT.id = p.id) as tt
where production_year like '1960';",2018-08-30 20:05:45.346072+10,10,1,71,correct
7941,"SELECT writer.title, writer.production_year from writer, person where writer.id = person.id and lower (first_name) = 'kelvin' 
and lower(last_name) = 'williamson';",2018-08-30 20:05:57.853244+10,5,0,213,partially correct
7942,"select count(*)
from Writer_Award,person
where writer_award.id = person.id and first_name = 'Woody' and last_name = 'Allen'and result = 'won'
group by award_name
having year_of_award < 1996 and year_of_award > 1990;",2018-08-30 20:06:20.86011+10,9,1,292,correct
7943,"select d.id, da.award_name, da.year_of_award, da.category
from director d,
	director_award da
where d.title = da.title
and d.production_year = da.production_year
and lower(da.result)='nominated';",2018-08-30 20:06:47.15424+10,13,1,332,correct
7944,"select p.id, p.first_name, p.last_name from person p ,(select d.id,count(*) as num from writer w, director d where d.id=w.id and 
d.title=w.title and d.production_year=w.production_year group by d.id) as a where p.id=a.id and num>1;",2018-08-30 20:06:49.334155+10,4,1,306,correct
7945,"select p.id,p.first_name,p.last_name from person as p where p.id in (select w.id from writer as w , director as d where w.id=d.id AND d.title = w.title AND d.production_year = w.production_year GROUP BY w.id 
HAVING COUNT(*)>=2);",2018-08-30 20:07:01.815831+10,4,1,31,correct
7946,"SELECT id, first_name, last_name
FROM person p
WHERE director.id = writer.id
;",2018-08-30 20:07:02.471067+10,4,0,260,noninterpretable
7947,"select id, first_name, last_name from(person natural join director natural join writer) as h group by h.id having count(*)>1;
",2018-08-30 20:07:38.473108+10,4,1,138,correct
7948,"select first_name ,last_name ,title ,production_year ,description 
from person natural join role
where id=(


select id
from (
	select id,max(num)
		from(
		select id, count(*) as num
		from person natural join role
		group by id

) as result
)
)

;",2018-08-30 20:07:40.301126+10,15,1,387,correct
7949,"select w.title, w.production_year from writer as w, person as p
where w.id = p.id
and lower(p.first_name) = lower('Kevin')
and lower(p.last_name) = lower('Williamson');",2018-08-30 20:07:49.061432+10,5,1,92,correct
7950,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) FROM person WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-30 20:08:47.226618+10,3,1,424,correct
8031,"select 
	count(*)
from 
	(select 
		title, id
	from
		writer_award
	where
		lower(result)= 'won') as wa,
	person as p

where wa.id = p.id and p.first_name = 'Woody'and p.last_name ='allen'
;",2018-08-30 20:29:59.106166+10,9,0,154,partially correct
7951,"select r.id, p.first_name, p.last_name, r.title, r.production_year, r.description
from role r, person p
where r.id=(select r4.id from(
select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3) as r4)
and
p.id=(select r4.id from(
select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3) as r4);
",2018-08-30 20:08:51.14861+10,15,0,338,partially correct
7952,"select count(*)
from Person p
where exists (select * from writer w where w.id = p.id and p.year_born = 1935);",2018-08-30 20:08:57.239313+10,1,1,286,correct
7953,;,2018-08-30 20:09:05.207138+10,10,0,292,noninterpretable
7954,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from role r, person p
where r.id=(select r4.id from(
select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3) as r4)
and
p.id=(select r4.id from(
select r3.id, max(r3.num)
from (select r1.id, count(*) as num
from role r1
group by r1.id) as r3) as r4);
",2018-08-30 20:09:19.216287+10,15,1,338,correct
7955,"SELECT title, production_year FROM MOVIE NATURAL JOIN MOVIE_AWARD WHERE lower(category) = ""best film"";",2018-08-30 20:09:53.621528+10,8,0,50,partially correct
7956,select count(*) from person where year_born='1935' and person.id in(select id from writer) ;,2018-08-30 20:10:05.309243+10,1,1,16,correct
7957,"select country from restriction
where lower(title) = lower('Shakespeare in Love')
and lower(description) = lower('M');",2018-08-30 20:10:23.665397+10,6,1,92,correct
7958,"select director.id
from director,writer
where director.title = 
(select writer.title
 from writer,director
 where director.id = writer.id
 group by director.id
 having count(director.title)>2
);",2018-08-30 20:11:06.677636+10,4,0,261,partially correct
7959,"SELECT title, production_year, first_name, last_name
FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE result = 'won' AND award_name = 'BAFTA Film Award' AND UPPER(category) = 'BEST FILM';",2018-08-30 20:11:20.028404+10,8,1,320,correct
7960,"SELECT ws.title, ws.production_year from (person Natural join writer Natural join movie) as ws where (ws.first_name = 'Kevin' 
and ws.last_name = 'Williamson');",2018-08-30 20:11:34.589652+10,5,1,213,correct
7961,"select id, first_name, last_name from person 
where year_born = (select max(year_born) from person);",2018-08-30 20:11:49.392698+10,7,1,92,correct
7962,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id=d.id);",2018-08-30 20:12:01.777307+10,12,1,424,correct
7963,select ;,2018-08-30 20:12:07.681593+10,2,0,433,noninterpretable
7964,"select count(*)
from(
select distinct id
from person natural join writer
where year_born = 1935


)group by id

;",2018-08-30 20:12:21.012805+10,1,1,387,correct
7965,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE EXISTS
	(SELECT d.id,COUNT(d.id)
	FROM director d,writer w
	WHERE d.id = w.id
	AND p.id = d.id
	GROUP BY d.id
	HAVING COUNT(*)>=2);",2018-08-30 20:12:27.664405+10,4,0,285,partially correct
7966,"SELECT p.id FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
FROM person 
WHERE year_born < (SELECT MAX(year_born) 
FROM person));",2018-08-30 20:13:20.950016+10,3,1,71,correct
7967,"select production_year, count(*)
from movie
where production_year>=1991 and production_year<=1993
group by production_year

;",2018-08-30 20:13:55.228278+10,2,1,387,correct
7968,"SELECT d.id, da.award_name, da.year_of_award,da.category from Director d, DIRECTOR_AWARD da, Person p
where da.result like 'nominated' and d.title = da.title and d.id = p.id;
",2018-08-30 20:13:55.585738+10,13,1,71,correct
7969,"SELECT title, production_year
FROM MOVIE NATURAL JOIN MOVIE_AWARD
WHERE award_name = ""BAFTA Film Award"" AND lower(category) = ""best film"" AND result = ""won"";",2018-08-30 20:14:31.139077+10,8,0,50,partially correct
7970,"select production_year, count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;
",2018-08-30 20:14:35.556931+10,2,1,433,correct
7971,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    And a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 20:14:46.880885+10,10,1,292,correct
7972,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw
GROUP BY dw.id
HAVING COUNT (*)>1;",2018-08-30 20:15:49.617673+10,4,1,424,correct
7973,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (SELECT id,count(*) AS number_of_rolesFROM
     ROLE
     GROUP BY id) AS b
WHERE r.id = p.id AND p.id = b.id AND b.number_of_roles IN 
(SELECT max(number_of_roles) FROM
(SELECT id,count ( * ) AS number_of_roles FROM ROLE
GROUP BY id ) AS a );",2018-08-30 20:17:02.991894+10,15,0,71,noninterpretable
7974,"select count(*) 
from person 
where person.id not in director.id
group by person;
",2018-08-30 20:17:03.165756+10,12,0,433,noninterpretable
7975,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title
and d.production_year=da.production_year
and d.id not in (
	select id
	from director_award da, director d
	where d.title=da.title
	and d.production_year=da.production_year
	and lower(result)='won'
);",2018-08-30 20:17:09.220731+10,13,1,349,correct
7976,"SELECT m.title, m.production_year
FROM movie m
WHERE EXISTS (SELECT * FROM writer w, person p WHERE m.title = w.title AND p.first_name = Kevin AND p.last_name = Williamson);",2018-08-30 20:17:12.136031+10,5,0,373,noninterpretable
7977,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 20:17:41.579793+10,11,1,223,correct
7978,"select t2.id
from (select t1.id, count(*) as t2no
from (select d.id,title, production_year 
from director d
union 
select w.id, title, production_year 
from writer w) t1
group by t1.id) t2
where t2.t2no = (select max(x2no)
from (select x1.id, count(*) as x2no
from (select d.id, title, production_year 
from director d
union select w.id, title, production_year 
from writer w) x1
group by x1.id) x2);",2018-08-30 20:18:15.243496+10,14,1,110,correct
7979,"SELECT re2.id FROM 
(SELECT re.id, COUNT(re.title) AS total FROM 
(SELECT * FROM director d
UNION
SELECT w.id,w.title,w.production_year FROM writer w) AS re
GROUP BY re.id) AS re2
WHERE re2.total IN (SELECT MAX(re2.total) FROM 
(SELECT re.id, COUNT(re.title) AS total FROM 
(SELECT * FROM director d
UNION
SELECT w.id,w.title,w.production_year FROM writer w) AS re
GROUP BY re.id) AS re2);

",2018-08-30 20:18:22.333831+10,14,1,95,correct
7980,"SELECT ;
",2018-08-30 20:18:35.311442+10,6,0,352,noninterpretable
7981,"SELECT id, first_name, last_name
FROM person p
WHERE year_born=MAX (year_born);",2018-08-30 20:18:45.710443+10,7,0,424,noninterpretable
7982,"select count(*)
from person p
where not exists(
	select *
	from director d
	where p.id =d.id

)


;",2018-08-30 20:19:04.011907+10,12,1,387,correct
7983,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id AND lower(first_name) = 'kevin' AND lower(last_name)='williamson';",2018-08-30 20:19:40.215381+10,5,1,373,correct
7984,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE EXISTS(
	SELECT d.id,COUNT(d.id)
	FROM director d,writer w
	WHERE d.id = w.id
	AND d.title = w.title
	AND p.id = d.id
	GROUP BY d.id
	HAVING COUNT(*)>=2)
ORDER BY p.id ASC;",2018-08-30 20:19:50.926004+10,4,1,285,correct
7985,";
",2018-08-30 20:20:03.383104+10,2,0,61,noninterpretable
7986,"select count(*)
from movie
where not exists(select * from movie_award
where movie.title = movie_award.title and movie.production_year = movie_award.production_year and result = 'won')
and not exists(select * from crew_award
where movie.title = crew_award.title and movie.production_year = crew_award.production_year and result = 'won')
and not exists(select * from director_award
where movie.title = director_award.title and movie.production_year = director_award.production_year and result = 'won')
and not exists(select * from writer_award
where movie.title = writer_award.title and movie.production_year = writer_award.production_year and result = 'won')
and not exists(select * from actor_award
where movie.title = actor_award.title and movie.production_year = actor_award.production_year and result = 'won');",2018-08-30 20:20:10.363392+10,11,0,292,partially correct
7987,"SELECT id, first_name, last_name
FROM person p
GROUP BY id
HAVING p.year_born=MAX(p.year_born);",2018-08-30 20:20:28.494103+10,7,0,185,partially correct
7988,"SELECT id, first_name, last_name
FROM person p
WHERE year_born=(SELECT MAX (year_born) FROM person);",2018-08-30 20:20:41.022312+10,7,1,424,correct
7989,;,2018-08-30 20:21:07.052342+10,4,0,433,noninterpretable
7990,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-30 20:21:10.618183+10,6,1,352,correct
7991,"select p.id
from person as p
where p.year_born=(select max(year_born) from person as p1 where p1.year_born<(select max(p2.year_born) from person p2));",2018-08-30 20:21:35.038313+10,3,1,223,correct
7992,"SELECT title, production_year, first_name, last_name
FROM (movie_award NATURAL JOIN person NATURAL JOIN director)
WHERE award_name='BAFTA Film Award' AND category='Best Film';",2018-08-30 20:22:14.165278+10,8,0,424,partially correct
7993,"SELECT COUNT (*)
FROM PERSON INNER JOIN WRITER 
WHERE PERSON.year_born = 1935;",2018-08-30 20:22:16.862769+10,1,0,435,partially correct
7994,"select count(*)
from movie
where not exists(select * from movie_award
where movie.title = movie_award.title and movie.production_year = movie_award.production_year and lower(result) = 'won')
and not exists(select * from crew_award
where movie.title = crew_award.title and movie.production_year = crew_award.production_year and lower(result) = 'won')
and not exists(select * from director_award
where movie.title = director_award.title and movie.production_year = director_award.production_year and lower(result) = 'won')
and not exists(select * from writer_award
where movie.title = writer_award.title and movie.production_year = writer_award.production_year and lower(result) = 'won')
and not exists(select * from actor_award
where movie.title = actor_award.title and movie.production_year = actor_award.production_year and lower(result) = 'won');",2018-08-30 20:22:30.175426+10,11,1,292,correct
7995,"select p3.id 

from (select p1.id from person p1
order by year_born desc
limit 2
)as p3 
 
 where p3.id not in (

select max(p2.id) from
(select p4.id from person p4
order by year_born desc
)as p2 
)
;",2018-08-30 20:22:30.531895+10,3,0,374,partially correct
7996,"SELECT COUNT (*)
FROM PERSON INNER JOIN WRITER 
WHERE PERSON.year_born = '1935';",2018-08-30 20:22:41.295703+10,1,0,435,partially correct
7997,"SELECT id, first_name, last_name
FROM person p
WHERE year_born=(SELECT MAX(year_born) FROM person);",2018-08-30 20:22:58.308975+10,7,1,185,correct
7998,;,2018-08-30 20:23:02.090673+10,5,0,433,noninterpretable
7999,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE year_of_award IN (1991, 1992, 1993, 1994, 1995) AND UPPER(first_name) = 'WOODY' AND UPPER(last_name) = 'ALLEN';
",2018-08-30 20:23:10.516132+10,9,0,320,partially correct
8000,;,2018-08-30 20:23:36.877129+10,6,0,433,noninterpretable
8001,select * from writer;,2018-08-30 20:23:38.900226+10,4,0,399,partially correct
8002," SELECT id, award_name, year_of_award, category
 FROM director_award da, director d
 WHERE 
 da.title =d.title
 AND da.production_year = d.production_year
 AND lower(da.result) = 'nominated'
 AND d.id NOT IN (
                SELECT id FROM director_award da,
				         director d 
						 WHERE da.title = d.title
						 AND da.production_year = d.production_year
						 AND lower(da.result) ='won');",2018-08-30 20:24:11.75338+10,13,1,410,correct
8003,;,2018-08-30 20:24:17.87282+10,7,0,433,noninterpretable
8004,Select Count(*) From person p Where Exists(Select * From Writer W Where p.id = w.id);,2018-08-30 20:24:45.298351+10,1,0,36,partially correct
8005,"SELECT * FROM writer_award NATURAL JOIN person
WHERE year_of_award IN (1991, 1992, 1993, 1994, 1995) AND UPPER(first_name) = 'WOODY' AND UPPER(last_name) = 'ALLEN' AND result = 'won';
",2018-08-30 20:24:51.792717+10,9,0,320,partially correct
8006,;,2018-08-30 20:25:01.481789+10,8,0,433,noninterpretable
8007,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE year_of_award IN (1991, 1992, 1993, 1994, 1995) AND UPPER(first_name) = 'WOODY' AND UPPER(last_name) = 'ALLEN' AND result = 'won';
",2018-08-30 20:25:03.016178+10,9,1,320,correct
8008,Select Count(*) From person p Where Exists(Select * From Writer W Where p.id = w.id);,2018-08-30 20:25:04.19747+10,1,0,36,partially correct
8009,"SELECT r.country
FROM restriction r
WHERE lower(r.title) = Shakespeare in Love AND lower(r.description) = 'm';",2018-08-30 20:25:17.157912+10,6,0,373,noninterpretable
8010,Select Count(*) From Person p Where Exists(Select * From Writer W Where p.id = w.id);,2018-08-30 20:25:23.839975+10,1,0,36,partially correct
8011,"SELECT COUNT (*)
FROM PERSON NATURAL JOIN WRITER 
WHERE PERSON.year_born = 1935;",2018-08-30 20:25:24.224799+10,1,0,435,partially correct
8012,"SELECT *
FROM person;",2018-08-30 20:25:24.409147+10,9,0,54,partially correct
8013,;,2018-08-30 20:25:35.450168+10,9,0,433,noninterpretable
8014,"select id,first_name, last_name
from person natural join(

select id, count(*) as count
from director natural join writer
group by id
having count>=2
)
;",2018-08-30 20:25:44.113999+10,4,1,387,correct
8015,";
",2018-08-30 20:25:58.654429+10,3,0,292,noninterpretable
8016,"select title, production_year from movie
where title =(
select w.title from writer as w
where w.id =
(select p.id from person as p
where p.first_name = 'Kevin' and p.last_name = 'Williamson'
))
;",2018-08-30 20:26:01.647956+10,5,0,390,partially correct
8017,;,2018-08-30 20:26:11.771124+10,10,0,433,noninterpretable
8018,"select title, production_year from movie
where title in(
select w.title from writer as w
where w.id =
(select p.id from person as p
where p.first_name = 'Kevin' and p.last_name = 'Williamson'
))
;",2018-08-30 20:26:36.826047+10,5,1,390,correct
8019,;,2018-08-30 20:26:44.655054+10,11,0,433,noninterpretable
8020,"SELECT r.country
FROM restriction r
WHERE lower(r.title) = 'shakespeare in love' AND lower(r.description) = 'm';",2018-08-30 20:26:56.542897+10,6,1,373,correct
8021,"select p.id, p.first_name, p.last_name from person p ,(select d.id,count(*) as num from writer w, director d where d.id=w.id and 
d.title=w.title and d.production_year=w.production_year group by d.id) as a where p.id=a.id and num>1;",2018-08-30 20:27:13.092801+10,4,1,306,correct
8022,;,2018-08-30 20:27:17.703929+10,3,0,433,noninterpretable
8023,Select Count(*) From Person p Where Exists(Select * From Writer W Where p.id = w.id AND p.year_born = 1935);,2018-08-30 20:27:58.679126+10,1,1,36,correct
8024,;,2018-08-30 20:27:59.131073+10,13,0,433,noninterpretable
8025,"SELECT id
FROM scene s, role r,appearance a
WHERE s.title=r.title
	and s.title = a.title
	and lower(s.title) ='psycho'
	and s.production_year = r.production_year
	and s.production_year = a.production_year
	and s.production_year = 1960
	and a.description = r.description
	and a.scene_no = s.scene_no
GROUP BY id
HAVING COUNT(*)=1;
",2018-08-30 20:28:22.230806+10,10,1,132,correct
8026,"select p3.id 

from (select p1.id from person p1
order by year_born desc
limit 2
)as p3 
 
 where p3.id not in (

select p2.id from
(select p4.id from person p4
order by year_born desc
)as p2
limit 1
)
;",2018-08-30 20:28:37.990061+10,3,1,374,correct
8027,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, (select id, count(*) as no
from role r1
group by r1.id) t
where r.id=p.id
and r.id=t.id
and t.no=(select max(t1.sno)
from (select id, count(*) as sno
from role r2
group by r2.id) t1);
",2018-08-30 20:28:43.368445+10,15,1,110,correct
8028,;,2018-08-30 20:28:46.409734+10,14,0,433,noninterpretable
8029,;,2018-08-30 20:29:08.05445+10,15,0,433,noninterpretable
8030,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM person p, MOVIE_AWARD ma
WHERE EXISTS (SELECT * FROM DIRECTOR d
WHERE d.id=p.id) AND lower(ma.result)='won' AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film';",2018-08-30 20:29:55.462349+10,8,0,185,partially correct
8033,"select dw.id,dw.first_name,dw.last_name from (person p natural join writer w natural join director d) as dw group by dw.id having count(*) >1;",2018-08-30 20:30:47.96306+10,4,1,306,correct
8034,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year FROM movie_award WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won')AS ma,
director d, person p
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND p.id=d.id;",2018-08-30 20:30:51.955772+10,8,1,424,correct
8035,"
ORDER BY dwm.id;",2018-08-30 20:31:33.20292+10,14,0,410,noninterpretable
8036,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born = (SELECT max(year_born) FROM person);",2018-08-30 20:31:47.843852+10,7,1,373,correct
8037,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));
",2018-08-30 20:31:48.029499+10,3,1,292,correct
8038,"SELECT COUNT (*)
FROM PERSON p
WHERE EXISTS (SELECT * 
              FROM WRITER w NATURAL JOIN p WHERE p.year_born - 1935);",2018-08-30 20:32:27.195695+10,1,0,435,noninterpretable
8039,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM person p, MOVIE_AWARD ma
WHERE EXISTS (SELECT * FROM DIRECTOR d
WHERE d.id=p.id AND d.production_year=ma.production_year) AND lower(ma.result)='won' AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film';",2018-08-30 20:32:49.874016+10,8,0,185,partially correct
8040,"SELECT  dw.id
FROM movie, director, writer,(SELECT person.id, movie.title, movie.production_year
                              FROM person, director, movie
                              WHERE person.id = director.id AND director.title = movie.title AND director.production_year =movie.production_year
                              UNION
                              SELECT person.id, movie.title, movie.production_year
                              FROM person, writer, movie
                              WHERE person.id = writer.id AND writer.title = movie.title 
						  AND writer.production_year =movie.production_year) AS dw
WHERE director.title = movie.title AND director.production_year =movie.production_year
      AND writer.title = movie.title AND writer.production_year =movie.production_year
GROUP BY dw.id
ORDER BY COUNT(*) DESC
LIMIT 3;
",2018-08-30 20:32:54.099864+10,14,1,165,correct
8041,"SELECT COUNT (*)
FROM PERSON p
WHERE EXISTS (SELECT * 
              FROM WRITER w NATURAL JOIN PERSON WHERE p.year_born = 1935);",2018-08-30 20:33:00.133088+10,1,0,435,partially correct
8042,;,2018-08-30 20:33:09.894797+10,8,0,373,noninterpretable
8043,"Select production_years, Count(*) From Movie m Where m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 Group By production_year;",2018-08-30 20:33:15.710135+10,2,0,36,noninterpretable
8044,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM person p, MOVIE_AWARD ma
WHERE EXISTS (SELECT * FROM DIRECTOR d
WHERE d.id=p.id AND d.production_year=ma.production_year AND d.title=ma.title) AND lower(ma.result)='won' AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film';",2018-08-30 20:33:20.839434+10,8,1,185,correct
8045,"Select production_years, Count(*) From Movie m Where m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 Group By production_year;",2018-08-30 20:33:39.181711+10,2,0,36,noninterpretable
8046,"select * from writer w, person p
where w.id=p.id
And year_born=1935;",2018-08-30 20:34:03.679443+10,1,0,137,partially correct
8047,"Select production_year, Count(*) From Movie m Where m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 Group By production_year;",2018-08-30 20:34:03.936506+10,2,1,36,correct
8048,"SELECT COUNT (*)
FROM PERSON p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 20:34:21.180191+10,1,1,435,correct
8049,Select id from Person p Where Not Exists(Select * From Director d Where p.id = d.id);,2018-08-30 20:35:41.243831+10,12,0,36,partially correct
8050,"SELECT role.id
FROM role,appearance 
WHERE role.title=appearance.title
      AND lower(appearance.title)='psycho'
      AND role.production_year=appearance.production_year
	 AND appearance.production_year=1960
	 AND appearance.description=role.description
GROUP BY role.id
HAVING COUNT(*)=1;",2018-08-30 20:35:52.203184+10,10,1,369,correct
8051,Select p.id from Person p Where Not Exists(Select * From Director d Where p.id = d.id);,2018-08-30 20:36:07.810274+10,12,0,36,partially correct
8052,"select id,award_name,year_of_award,category
from director,director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
group by director_award.title
having count(*)>0 and lower(result) != 'won';",2018-08-30 20:36:18.21457+10,13,1,292,correct
8053,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 20:36:30.959731+10,14,1,368,correct
8054,"SELECT COUNT(*)
FROM Writer_Award wa, person p
WHERE wa.id = p.id AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen'
	AND year_of_award >=1991 AND year_of_award<=1995 AND lower(wa.result)='won';",2018-08-30 20:36:36.118504+10,9,1,54,correct
8055,"select COUNT(*) FROM ;
",2018-08-30 20:37:03.158146+10,12,0,61,noninterpretable
8056,Select Count(*) from Person p Where Not Exists(Select * From Director d Where p.id = d.id);,2018-08-30 20:37:26.01776+10,12,1,36,correct
8057,"SELECT COUNT(*)
FROM WRITER_AWARD wa
WHERE EXISTS (SELECT * FROM person p
WHERE p.id=wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen')
AND year_of_award>1990 AND year_of_award<1996;",2018-08-30 20:37:55.265046+10,9,0,185,partially correct
8058,"with t1 as(
select id,count(distinct re.description) as num from restriction re inner join role r 
on re.title = r.title and re.production_year = r.production_year where lower(country)='usa' group by id 
)
,t2 as (
select count(*) from Restriction_Category where lower(country)= 'usa' group by country)

select first_name,last_name from t1,person p where t1.num in t2 and p.id = t1.id;",2018-08-30 20:38:12.061946+10,9,0,209,partially correct
8059,"SELECT COUNT(*)
FROM WRITER_AWARD wa
WHERE EXISTS (SELECT * FROM person p
WHERE p.id=wa.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen')
AND year_of_award>1990 AND year_of_award<1996 AND lower(wa.result)='won';",2018-08-30 20:38:50.413938+10,9,1,185,correct
8060,"SELECT p.id, p.first_name, p.last_name 
FROM PERSON p
WHERE year_born = (SELECT MAX(year_born) from PERSON)
GROUP BY p.id;",2018-08-30 20:39:55.848739+10,7,1,352,correct
8061,"SELECT m.title,m.production_year
FROM movie m
WHERE EXISTS(
	SELECT w.title
	FROM (person p NATURAL JOIN writer) AS w
	WHERE w.first_name = 'Kevin'
	AND w.last_name = 'Williamson');",2018-08-30 20:40:32.542444+10,5,0,285,partially correct
8062,"Select dw.id, dw.first_name, dw.last_name From (Person p Natural Join Director Natural Join Writer) As dw Group By dw.Having Count(*) > 1; ",2018-08-30 20:40:51.878188+10,4,0,36,noninterpretable
8063,SELECT COUNT(*) FROM person WHERE EXISTS ( SELECT * FROM writer where writer.id = person.id AND person.year_born=1935);,2018-08-30 20:40:58.634013+10,1,1,166,correct
8064,"select;
",2018-08-30 20:41:06.590848+10,4,0,61,noninterpretable
8065,"Select dw.id, dw.first_name, dw.last_name From (Person p Natural Join Director Natural Join Writer) As dw Group By dw.id Having Count(*) > 1; ",2018-08-30 20:41:41.792216+10,4,1,36,correct
8066,"select COUNT(id) as NumberOfWriters
from WRITER w LEFT JOIN PERSON p
	on w.id = p.id;",2018-08-30 20:42:11.112955+10,1,0,423,noninterpretable
8067,;,2018-08-30 20:42:11.610206+10,14,0,292,noninterpretable
8068,"SELECT md.title, md.production_year
FROM (movie_award NATURAL JOIN director) AS md
WHERE lower(md.award_name) = 'bafta film award' AND lower(md.category) = 'best film'
GROUP BY md.id;",2018-08-30 20:42:12.042799+10,8,0,373,partially correct
12099,"SELECT COUNT(*)
FROM (PERSON p NATURAL JOIN WRITER) AS pw
WHERE pw.year_born = 1935;",2018-08-31 15:54:56.924071+10,1,0,423,partially correct
8069,"select 
	count(*) as number_of_award
from 
	writer w,
	person p,
	writer_award wa
where 
	w.id = p.id and
	w.id = wa.id and
	w.title = wa.title and
	wa.production_year = w.production_year and
	lower(result) = 'won' and
	lower(first_name) = 'woody' and
	lower(last_name) = 'allen' and
	year_of_award >=1991 and
	year_of_award <=1995

;
",2018-08-30 20:42:16.727609+10,9,1,154,correct
8070,"select count(*)
from movie m  where 
not exists (
select title, production_year from movie_award as ma
where m.title = ma.title and m.production_year = ma.production_year and lower(RESULT)='won'
union
select title, production_year from crew_award as ca
where m.title = ca.title and m.production_year = ca.production_year and lower(RESULT)='won' 
union
select title, production_year from director_award as da
where m.title = da.title and m.production_year = da.production_year and lower(RESULT)='won'
union
select title, production_year from writer_award as wa
where m.title = wa.title and m.production_year = wa.production_year and lower(RESULT)='won'
union
select title, production_year from actor_award as aa
where m.title = aa.title and m.production_year = aa.production_year and lower(RESULT)='won');

",2018-08-30 20:42:27.000089+10,11,1,102,correct
8071,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 20:43:01.65306+10,14,1,292,correct
8072,"SELECT m.title,m.production_year
FROM movie m
WHERE EXISTS(
	SELECT w.title
	FROM (person p NATURAL JOIN writer) AS w
	WHERE w.first_name = 'Kevin'
	AND m.title = w.title
	AND w.last_name = 'Williamson');",2018-08-30 20:43:03.948835+10,5,1,285,correct
8073,"select COUNT(w.id) as NumberOfWriters
from WRITER w LEFT JOIN PERSON p
	on w.id = p.id
	where p.year_born = 1935;",2018-08-30 20:43:23.619686+10,1,0,423,partially correct
8074,"Select title, production_year From Writer w Where Exists(Select * From Person p Where p.id = w.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson');",2018-08-30 20:44:07.119399+10,5,1,36,correct
8075,"select id , max(large_number)from (select id, count(id) as large_number
from ((select p.id, director.title, director.production_year
from person as p, director, writer
where p.id=director.id
and p.id=writer.id)
union 
(select p.id, title, production_year
from person as p, director
where p.id=director.id)
union
(select p.id, title, production_year
from person as p, writer
where p.id=writer.id))as h
group by id )as g;",2018-08-30 20:45:09.349465+10,14,0,140,noninterpretable
8076,"SELECT
	w.title,w.production_year
FROM
	writer w, person p
WHERE
	w.id = p.id
	AND
	p.first_name = 'Kevin'
	AND
	p.last_name = 'Williamson';",2018-08-30 20:45:39.406253+10,5,1,285,correct
8077,Select Country From Restriction r Where r.title = 'Shakespeare in Love' AND r.description = 'M');,2018-08-30 20:46:12.259398+10,6,0,36,noninterpretable
8078,"select w.title, w.production_year from writer w where w.id=(select p.id from person p where lower(p.first_name)='kevin' and lower(p.last_name)='williamson');",2018-08-30 20:46:14.241862+10,5,1,272,correct
8079,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 20:46:18.875867+10,5,1,285,correct
8080,Select Country From Restriction r Where r.title = 'Shakespeare in Love' AND r.description = 'M';,2018-08-30 20:46:43.277182+10,6,1,36,correct
8081,"SELECT id
FROM ROLE r
WHERE EXISTS (SELECT * FROM APPEARANCE ap
WHERE r.title=ap.title AND r.production_year=ap.production_year
AND r.description=ap.description AND ap.scene_no=1)
GROUP BY id
HAVING r.production_year=1960;",2018-08-30 20:46:50.097473+10,10,0,185,partially correct
8082,"SELECT md.title, md.production_year, p.first_name, p.last_name
FROM (movie_award NATURAL JOIN director) AS md, person p
WHERE lower(md.award_name) = 'bafta film award' AND lower(md.category) = 'best film' AND lower(md.result) = 'won' AND md.id  = p.id
GROUP BY md.id;
",2018-08-30 20:46:55.360981+10,8,1,373,correct
8083,"select a.id, a.first_name, a.last_name from (select * from person natural join writer natural join director) AS a group by a.id, a.first_name, a.last_name having count(*) > 1;",2018-08-30 20:47:06.617091+10,4,1,399,correct
8084,"SELECT production_year, COUNT(*) FROM movie WHERE production_year IN(1993, 1992, 1991) GROUP BY production_year ORDER BY production_year DESC;
",2018-08-30 20:47:18.114262+10,2,1,166,correct
8085,"SELECT id FROM (SELECT id,title,production_year FROM writer UNION SELECT id,title,production_year FROM director ) AS xyz
GROUP BY id ORDER BY COUNT(*) DESC LIMIT 3;",2018-08-30 20:48:36.306152+10,14,1,410,correct
8086,fgfhj;,2018-08-30 20:48:52.260218+10,15,0,410,noninterpretable
8087,"Select id, first_name, last_name From Person Where year_born = (Select Min(year_born) From Person p);",2018-08-30 20:48:54.096927+10,7,0,36,partially correct
8088,"Select id, first_name, last_name From Person Where year_born = (Select Max(year_born) From Person p);",2018-08-30 20:49:12.311703+10,7,1,36,correct
8089,s;,2018-08-30 20:50:01.390375+10,15,0,270,noninterpretable
8090,"SELECT COUNT(*) as NumberOfWriters
FROM PERSON p
WHERE EXISTS (
	SELECT * 
	FROM WRITER w
	WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-30 20:50:07.017524+10,1,1,423,correct
8091,SELECT 77;,2018-08-30 20:51:11.263605+10,11,0,384,noninterpretable
8092,"SELECT 
	r.country
FROM 
	restriction r
WHERE 
	r.title = 'Shakespeare in Love'
	AND
	r.description = 'M';",2018-08-30 20:51:18.265697+10,6,1,285,correct
8093,"SELECT COUNT(id)
FROM Writer NATURAL JOIN Person
WHERE year_born = 1935;",2018-08-30 20:51:34.550058+10,1,0,434,partially correct
8094,"SELECT id
FROM Role r, (SELECT title, description, scene_no
			FROM Appearance a
			WHERE title = 'Psycho' AND
				a.production_year=1960 AND
				scene_no = 1)AS at
WHERE at.title = r.title AND at.description = r.description;",2018-08-30 20:51:42.706969+10,10,0,54,partially correct
8095,"SELECT 
	r.country
FROM 
	restriction r
WHERE 
	lower(r.title) = 'shakespeare in love'
	AND
	r.description = 'M';",2018-08-30 20:51:56.193531+10,6,1,285,correct
8096,"WITH notwon AS (
	WITH aout AS(
			SELECT title, production_year, result
			FROM actor_award aw
			UNION
			SELECT title, production_year, result
			FROM movie_award
			UNION
			SELECT title, production_year, result
			FROM director_award
			UNION
			SELECT title, production_year, result
			FROM crew_award
			UNION
			SELECT title, production_year, result
			FROM writer_award
		)
	SELECT DISTINCT m.title, m.production_year
	FROM aout, movie m
	WHERE lower(aout.result) = 'won'
		AND m.title != aout.title
		AND m.production_year != aout.production_year
)
SELECT COUNT(*)
FROM notwon
;
",2018-08-30 20:52:55.79241+10,11,0,353,partially correct
8097,"select country from restriction
where title = 'Shakespeare in Love' and description = 'M'
;",2018-08-30 20:53:12.921097+10,6,1,390,correct
8098,"SELECT id
FROM ROLE r
WHERE EXISTS (SELECT * FROM APPEARANCE ap, SCENE s
WHERE r.title=ap.title=s.title AND r.production_year=ap.production_year=s.production_year
AND r.description=ap.description=s.description AND ap.scene_no=s.scene_no AND ap.production_year=1960 AND ap.title='psycho')
GROUP BY id
HAVING COUNT(*)=1;",2018-08-30 20:53:19.424922+10,10,0,185,partially correct
8099,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id=d.id);",2018-08-30 20:53:28.968739+10,12,1,191,correct
8100,"select x.first_name,x.last_name,x.title,x.production_year,x.description
from (select role.id,first_name,last_name,title,production_year,description,count(*)as number
from person,role
where person.id = role.id
group by role.id)x
group by x.id
having max(number);",2018-08-30 20:53:30.061783+10,15,0,292,partially correct
8101,"SELECT rs.country FROM (movie natural join restriction natural join restriction_category) as rs where (rs.description = ""M"" and rs.title = ""Shakespeare"");",2018-08-30 20:53:35.954647+10,6,0,213,partially correct
8102,;,2018-08-30 20:53:41.323576+10,15,0,368,noninterpretable
8285,"select id, first_name, last_name from person where person.year_born = (select MAX(year_born) from person);",2018-08-30 21:51:02.081645+10,7,1,399,correct
8103,"SELECT m.production_year, COUNT(*)
FROM MOVIE m
GROUP BY m.production_year
HAVING m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991;",2018-08-30 20:54:07.664301+10,2,1,423,correct
8104,"select id from Scene S INNER JOIN Appearance A ON S.title=A.title AND S.production_year=a.production_year and A.scene_no=S.scene_no
INNER JOIN Role R ON S.title=R.title AND S.production_year=R.production_year AND A.description=R.description
where S.title='Psycho' AND S.production_year='1960'
GROUP BY id;

",2018-08-30 20:54:54.722075+10,10,0,202,partially correct
8105,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 20:55:08.485895+10,15,1,292,correct
8106,"select distinct count(*)
from WRITER, PERSON 
where WRITER.id = PERSON.id
and year_born=1935;",2018-08-30 20:55:33.052417+10,1,0,22,partially correct
8107,"select count *
from Writer,Person
where writer.id = person.id and year_born = 1935;",2018-08-30 20:55:44.928937+10,1,0,292,noninterpretable
8108,"select id from Scene S INNER JOIN Appearance A ON S.title=A.title AND S.production_year=a.production_year and A.scene_no=S.scene_no
INNER JOIN Role R ON S.title=R.title AND S.production_year=R.production_year AND A.description=R.description
where S.title='Psycho' AND S.production_year='1960'
GROUP BY id
having count(*)=1;

",2018-08-30 20:56:07.721697+10,10,1,202,correct
8109,"SELECT 
	p.id,
	p.first_name,
	p.last_name
FROM 
	person p
WHERE
	p.year_born = MAX(p.year_born);",2018-08-30 20:56:14.616157+10,7,0,285,noninterpretable
8110,"Select d.title, d.production_year, p.first_name, p.last_name From Director d Natural Join Person p Natural Join Movie_Award ma Where ma.award_name = 'BAFTA film award', ma.category = 'Best film', ma.result = 'won';",2018-08-30 20:56:27.412791+10,8,0,36,noninterpretable
8111,"WITH notwon AS (
	WITH aout AS(
			SELECT title, production_year, result
			FROM actor_award aw
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM movie_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM director_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM crew_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM writer_award
			WHERE lower(result) = 'won'
		)
	SELECT DISTINCT m.title, m.production_year
	FROM aout, movie m
	WHERE m.title != aout.title
		AND m.production_year != aout.production_year
)
SELECT COUNT(*)
FROM notwon
;
",2018-08-30 20:56:31.516198+10,11,0,353,partially correct
8112,SELECT country FROM restriction as rs where (description = 'M' and title = 'Shakespeare in Love');,2018-08-30 20:56:45.151531+10,6,1,213,correct
8113,"SELECT m.production_year as ProductionYear, COUNT(*) as NumberOfMovies
FROM MOVIE m
GROUP BY m.production_year
HAVING m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991;",2018-08-30 20:57:04.231743+10,2,1,423,correct
8114,"select movieworker.id, count(number) as no_of_movies
from (
	select d.id, count(*) as number
	from director d, movie m, writer w
	where d.title=m.title
	and d.production_year=m.production_year
	and d.id not in (
		select director.id
		from director, writer
		where d.id=w.id)
	group by d.id
	union
	select w.id, count(*) as number
	from writer w, movie m, director d
	where w.title=m.title
	and w.production_year=m.production_year
	and w.id not in (select director.id
		from director, writer
		where d.id=w.id)
	group by d.id
	union
	select w.id, count(*) as number
	from writer w, movie m, director d
	where w.title=m.title
	and w.production_year=m.production_year
	and w.id =d.id
	group by d.id
) movieworker
group by id
order by id desc
limit 1;
",2018-08-30 20:57:19.863687+10,14,0,349,partially correct
8115,"select count(*)
from writer
where exists(select * from person where writer.id = person.id and year_born = 1935);",2018-08-30 20:57:23.258686+10,1,0,292,partially correct
8116,"SELECT 
	p.id,
	p.first_name,
	p.last_name
FROM 
	person p
WHERE
	p.year_born = (
		SELECT 
			max(year_born)
		FROM
			person);",2018-08-30 20:57:24.855036+10,7,1,285,correct
8117,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM(
SELECT id,max(t.times)
FROM
(SELECT p.id,COUNT(*) as times
FROM person p,role r
WHERE p.id=r.id
GROUP By p.id
ORDER By times DESC) as t)as tt,person p,role r

WHERE p.id=tt.id
	and p.id = r.id

;",2018-08-30 20:57:53.413054+10,15,1,132,correct
8118,"select;
",2018-08-30 20:59:15.006309+10,5,0,61,noninterpretable
8119,"select count(*)
from person
where year_born = 1935 and exists(select * from writer where writer.id = person.id);",2018-08-30 20:59:16.917168+10,1,1,292,correct
8120,"
SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 20:59:44.08889+10,14,1,349,correct
8121," SELECT (SELECT COUNT(*) FROM person) - (SELECT COUNT(*) FROM director) as ""Non-Directors"";",2018-08-30 21:00:33.047079+10,12,0,166,partially correct
8122,"Select d.title, d.production_year, p.first_name, p.last_name From Director d Natural Join Person p Natural Join Movie_Award ma Where ma.award_name = 'BAFTA Film Award' ma.category = 'Best film' ma.result = 'won';",2018-08-30 21:00:51.739205+10,8,0,36,noninterpretable
8123,"select id, year_born
from person
group by year_born
order by year_born desc;",2018-08-30 21:01:00.127138+10,3,0,102,partially correct
8124,"SELECT e1.production_year, count (*)
FROM MOVIE e1
WHERE e1.production_year > 1990 
AND e1.production_year < 1994;",2018-08-30 21:01:45.619784+10,2,0,435,partially correct
8125,SELECT COUNT(*) FROM person where NOT EXISTS( SELECT * FROM director WHERE  person.id = director.id);,2018-08-30 21:01:58.404578+10,12,1,166,correct
8126,"with t1 as(
select id,count(distinct re.description) as num from restriction re inner join role r 
on re.title = r.title and re.production_year = r.production_year where lower(country)='usa' group by id 
)
,t2 as (
select count(*) as n from Restriction_Category where lower(country)= 'usa' group by country)

select first_name,last_name from t1,person p,t2 where t1.num = t2.n and p.id = t1.id;",2018-08-30 21:02:41.90595+10,9,0,209,partially correct
8127,"SELECT * FROM role NATURAL JOIN appearance
WHERE production_year = 1960 AND title = 'Psycho' AND scene_no = 1;",2018-08-30 21:02:55.584368+10,10,0,320,partially correct
8128,"SELECT COUNT(*) as NumberOfNonDirector
FROM PERSON p
WHERE EXISTS (
	SELECT * 
	FROM DIRECTOR d
	WHERE p.id != d.id);
",2018-08-30 21:03:00.161518+10,12,0,423,partially correct
8129,"select a.title, a.production_year from person natural join writer AS a Where person.first_name = 'Kevin' and person.last_name = 'Williamson';",2018-08-30 21:03:01.837993+10,5,1,399,correct
8130,"SELECT e1.production_year, count (*)
FROM MOVIE e1
GROUP BY e1.production_year
HAVING e1.production_year > 1990 
AND e1.production_year < 1994;",2018-08-30 21:03:06.406538+10,2,1,435,correct
8131,"SELECT id
FROM DIRECTOR d NATURAL JOIN WRITER w;
",2018-08-30 21:03:36.918207+10,4,0,191,partially correct
8132,"SELECT id FROM role NATURAL JOIN appearance
WHERE production_year = 1960 AND title = 'Psycho' AND scene_no = 1;",2018-08-30 21:03:40.72179+10,10,0,320,partially correct
8133,"select count(*) from Writer W,Person P
where P.id=W.id and year_born='1935';
",2018-08-30 21:03:59.113974+10,1,0,202,partially correct
8134,"SELECT id, first_name, last_name from person WHERE year_born = (SELECT min(year_born) from person);",2018-08-30 21:03:59.434557+10,7,0,213,partially correct
8745,SELECT country FROM restriction WHERE title='Shakespeare in Love' AND description='M' GROUP BY country;,2018-08-30 23:57:54.152656+10,6,1,427,correct
8135,"Select Count(*) From Writer_Award wa, Person p Where p.id = wa.id AND p.first_name = 'Woody' AND p.last_name = 'Allen' AND wa.year_of_award > 1990 AND wa.year_of_award < 1995;",2018-08-30 21:04:14.713545+10,9,1,36,correct
8136,"SELECT id, first_name, last_name from person WHERE year_born = (SELECT max(year_born) from person);",2018-08-30 21:04:19.323729+10,7,1,213,correct
8137,"select count(Distinct P.id)  from Writer W,Person P
where P.id=W.id and year_born='1935';
",2018-08-30 21:04:47.892931+10,1,1,202,correct
8138,"WITH notwon AS (
	WITH aout AS(
			SELECT title, production_year, result
			FROM actor_award aw
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM movie_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM director_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM crew_award
			WHERE lower(result) = 'won'
			UNION
			SELECT title, production_year, result
			FROM writer_award
			WHERE lower(result) = 'won'
		)
	SELECT DISTINCT m.title, m.production_year
	FROM aout, movie m
	WHERE NOT EXISTS(
		SELECT *
		FROM aout
		WHERE lower(aout.title) = lower(m.title)
			AND aout.production_year = m.production_year
	)
)
SELECT COUNT(*)
FROM notwon
;
",2018-08-30 21:05:14.335777+10,11,1,353,correct
8139,"SELECT id
FROM ROLE r
WHERE EXISTS (SELECT * FROM APPEARANCE a, SCENE s
WHERE a.title=r.title AND s.title=r.title AND a.production_year=s.production_year
AND r.production_year=s.production_year AND r.description=s.description
AND a.description=r.description AND s.scene_no=a.scene_no)
GROUP BY id
HAVING lower(r.title)='psycho' AND r.production_year=1960 AND COUNT(*)=1;",2018-08-30 21:05:22.381728+10,10,0,185,partially correct
8140,"SELECT COUNT(id)
FROM (
	SELECT id
	FROM Writer NATURAL JOIN Person
	WHERE year_born = 1935
	GROUP BY id);",2018-08-30 21:05:27.087128+10,1,1,434,correct
8141,"select id, first_name, last_name from person
where year_born = max(year_born);",2018-08-30 21:06:08.047993+10,7,0,390,noninterpretable
8142,"SELECT id
FROM ROLE r, APPEARANCE a, SCENE s
WHERE a.title=r.title AND s.title=r.title AND a.production_year=s.production_year
AND r.production_year=s.production_year AND r.description=s.description
AND a.description=r.description AND s.scene_no=a.scene_no
GROUP BY id
HAVING lower(r.title)='psycho' AND r.production_year=1960 AND COUNT(*)=1;",2018-08-30 21:06:11.53953+10,10,0,185,partially correct
8143,"SELECT id
FROM ROLE r, APPEARANCE a, SCENE s
WHERE a.title=r.title AND s.title=r.title AND a.production_year=s.production_year
AND r.production_year=s.production_year AND r.description=s.description
AND a.description=r.description AND s.scene_no=a.scene_no AND lower(r.title)='psycho' AND r.production_year=1960
GROUP BY id
HAVING COUNT(*)=1;",2018-08-30 21:06:46.474325+10,10,0,185,partially correct
8144,"SELECT COUNT(*)
FROM person p NATURAL JOIN writer w
WHERE p.year_born=1935;",2018-08-30 21:07:14.443395+10,1,0,439,partially correct
8145,"SELECT COUNT(*)
FROM person p NATURAL JOIN writer w
WHERE p.year_born=1935;",2018-08-30 21:07:15.128388+10,1,0,439,partially correct
8146,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 21:07:15.804871+10,15,1,368,correct
8147,"select id, first_name, last_name from person
where year_born = 
(select max(year_born) from person);",2018-08-30 21:07:21.174896+10,7,1,390,correct
8148,"select id 
from person 
Where person.year_born = (select max(year_born) from person) 
;",2018-08-30 21:09:34.007968+10,3,0,154,partially correct
8149,"Select r.id From Scene s, Appearance a, Role r Where s.title = a.title AND s.title = r.title AND a.description = r.description AND a.title = 'Psycho' AND a.production_year = '1960 Group By r.id Having Count(*) > 1;",2018-08-30 21:09:34.145348+10,10,0,36,noninterpretable
8150,"SELECT production_year, COUNT(*)
FROM Movie
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991
Group By production_year;",2018-08-30 21:09:43.156327+10,2,1,434,correct
8151,"select person.id
from person, (select MAX(year_born) as youngs,id from person
where not exists(
select MAX(year_born) from person))as remain
where person.id=remain.id and person.year_born=remain.youngs;",2018-08-30 21:09:58.936875+10,3,0,307,partially correct
8152,"Select r.id From Scene s, Appearance a, Role r Where s.title = a.title AND s.title = r.title AND a.description = r.description AND a.title = 'Psycho' AND a.production_year = '1960' Group By r.id Having Count(*) > 1;",2018-08-30 21:10:11.627299+10,10,0,36,partially correct
8153,"SELECT d.first_name,d.last_name
FROM (person p NATURAL JOIN director) AS d
WHERE d.title = 
(SELECT ma.title
FROM movie_award ma
WHERE
	lower(ma.category) = lower('Best Film')
	AND lower(ma.award_name) = lower('BAFTA Film Award')
	AND lower(ma.result) = lower('won'));",2018-08-30 21:10:53.017015+10,8,0,285,partially correct
8154,SELECT id FROM PERSON WHERE year_born = (SELECT MAX (year_born) FROM PERSON WHERE year_born < (SELECT MAX (year_born) FROM PERSON));,2018-08-30 21:11:18.151024+10,3,1,384,correct
8155,"
(select d.id
from director d,
	movie m
where d.title = m.title and
	d.production_year = m.production_year
union
select w.id
from writer w,
	movie m
where w.title = m.title and
	w.production_year = m.production_year);",2018-08-30 21:11:43.583076+10,14,0,332,noninterpretable
8156,"select count(*)
from person p
where exists (select * from writer w where w.id=p.id and year_born=1935);",2018-08-30 21:12:30.545537+10,1,1,22,correct
8157,"Select r.id From Scene s, Appearance a, Role r Where s.title = a.title AND s.production_year = a.production_year AND s.scene_no = a.scene_no AND s.title = a.title AND s.production_year = r.production_year AND a.description = r.description AND a.title = 'Psycho' AND a.production_year = '1960' Group By r.id Having Count(*) > 1;",2018-08-30 21:13:08.994281+10,10,0,36,partially correct
8158,"select id 
from person 
Where person.year_born = (select max(year_born) from person where year_born<(select max(year_born) from person));",2018-08-30 21:13:09.756358+10,3,1,154,correct
8159,"SELECT COUNT(*)
FROM Person
WHERE NOT EXISTS(SELECT *
			FROM Director
			WHERE Person.id = Director.id);",2018-08-30 21:13:11.177699+10,12,1,434,correct
8160,"Select * from person a,role b where a.id=b.id and a.id in(
select a.id  from person a,role b where a.id=b.id group by a.id 
having count(*)=(select max(cnt) from (select a.id  ,count(*) cnt from person a,role b where a.id=b.id group by a.id ))

);",2018-08-30 21:13:16.197206+10,15,0,205,partially correct
8161,select country from restriction AS r where r.title = 'Shakespeare in Love' and r.description = 'M';,2018-08-30 21:13:26.156661+10,6,1,399,correct
8162,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(SELECT *
                 FROM movie,movie_award,crew_award,director_award,writer_award,actor_award
		      WHERE (movie_award.title=movie.title
			      AND lower(movie_award.result)='won')
				OR (crew_award.title=movie.title
			      AND lower(crew_award.result)='won')
				OR (director_award.title=movie.title
			      AND lower(director_award.result)='won')
				OR (writer_award.title=movie.title
			      AND lower(writer_award.result)='won')
				OR (actor_award.title=movie.title
			      AND lower(actor_award.result)='won'));",2018-08-30 21:13:29.651251+10,11,0,369,partially correct
8163,"Select r.id From Scene s, Appearance a, Role r Where s.title = a.title AND s.production_year = a.production_year AND s.scene_no = a.scene_no AND s.title = r.title AND s.production_year = r.production_year AND a.description = r.description AND a.title = 'Psycho' AND a.production_year = '1960' Group By r.id Having Count(*) > 1;",2018-08-30 21:14:03.953911+10,10,0,36,partially correct
8164,"select production_year,count(*)
from movie
where production_year>=1991
and production_year<=1993
group by production_year;",2018-08-30 21:14:25.121674+10,14,0,22,partially correct
8165,"Select r.id From Scene s, Appearance a, Role r Where s.title = a.title AND s.production_year = a.production_year AND s.scene_no = a.scene_no AND s.title = r.title AND s.production_year = r.production_year AND a.description = r.description AND a.title = 'Psycho' AND a.production_year = '1960' Group By r.id Having Count(*) = 1;",2018-08-30 21:14:59.60295+10,10,1,36,correct
8166,"select production_year,count(*)
from movie
where production_year>=1991
and production_year<=1993
group by production_year;",2018-08-30 21:15:27.397011+10,2,1,22,correct
8167,"SELECT id
FROM ROLE r, APPEARANCE a, SCENE s
WHERE a.title=r.title AND s.title=r.title AND a.production_year=s.production_year
AND r.production_year=s.production_year AND r.description=s.description
AND a.description=r.description AND s.scene_no=a.scene_no AND lower(r.title)='psycho' AND r.production_year=1960
GROUP BY id
HAVING COUNT(*)=1;",2018-08-30 21:15:59.431844+10,10,0,185,partially correct
8168,"Select first_name,last_name,title,production_year,description from person a,role b where a.id=b.id and a.id in(
select a.id  from person a,role b where a.id=b.id group by a.id 
having count(*)=(select max(cnt) from (select a.id  ,count(*) cnt from person a,role b where a.id=b.id group by a.id))

);",2018-08-30 21:16:01.295011+10,15,1,205,correct
8169,"SELECT id
FROM ROLE r, APPEARANCE a, SCENE s
WHERE a.title=r.title AND s.title=r.title AND a.production_year=s.production_year
AND r.production_year=s.production_year
AND a.description=r.description AND s.scene_no=a.scene_no AND lower(r.title)='psycho' AND r.production_year=1960
GROUP BY id
HAVING COUNT(*)=1;",2018-08-30 21:16:23.838699+10,10,1,185,correct
8170,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(select p1.id, count(*) as noofrole from role r1 natural join person p1 group by p1.id) u1
where p.id=u1.id and u1.noofrole=
(select max(noofrole)
from (
select p2.id, count(*) as noofrole from role r2 natural join person p2 group by p2.id) u2);",2018-08-30 21:16:32.788274+10,15,0,270,partially correct
8171,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(select p1.id, count(*) as noofrole from role r1 natural join person p1 group by p1.id) u1
where p.id=u1.id and u1.noofrole=
(select max(noofrole)
from (
select p2.id, count(*) as noofrole from role r2 natural join person p2 group by p2.id) u2);",2018-08-30 21:16:41.212224+10,15,0,270,partially correct
8172,"SELECT id, first_name, last_name
FROM person 
WHERE (SELECT count(*)
       FROM director, writer,movie
	 WHERE director.id=writer.id AND director.title=writer.title=movie.title AND director.production_year=writer.production_year=movie.production_year
	 GROUP BY title,production_year
	 HAVING count(*)>2);",2018-08-30 21:17:14.05115+10,4,0,233,noninterpretable
8173,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(select p1.id, count(*) as noofrole from role r1 natural join person p1 group by p1.id) u1
where p.id=r.id and p.id=u1.id and u1.noofrole=
(select max(noofrole)
from (
select p2.id, count(*) as noofrole from role r2 natural join person p2 group by p2.id) u2);",2018-08-30 21:17:57.278582+10,15,1,270,correct
8174,"SELECT title, production_year
FROM writer w , person p
WHERE w.id=p.id
AND lower(p.first_name)='kevin'
AND lower(p.last_name)='williamson';",2018-08-30 21:18:04.764006+10,5,1,124,correct
8175,"SELECT po2.id
FROM person po2
WHERE po2.year_born IN(
	SELECT MIN(pout.year_born)
	FROM person pout
	WHERE pout.id NOT IN
	(
		SELECT p.id
		FROM person p
		WHERE p.year_born IN (
			SELECT MIN(pin.year_born)
			FROM person pin
		)
	)
)
;
",2018-08-30 21:18:17.869613+10,3,0,353,partially correct
8176,"select id from person
where id in(select id from(
select id, max(largest) from(select id, count(*) as largest from director
group by id)
union
select id, max(largest) from(select id, count(*) as largest from writer
group by id
)));
",2018-08-30 21:18:45.653745+10,14,0,197,partially correct
8177,"SELECT ID,FIRST_NAME,LAST_NAME FROM PERSON WHERE ID IN(SELECT ID FROM (SELECT * FROM PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS XYZ GROUP BY ID HAVING COUNT(TITLE)>1);",2018-08-30 21:18:51.417108+10,4,1,408,correct
8178,"with temp1 as
(
select id,count(*) as c from role group by id
)
select pr.first_name,pr.last_name,pr.title,pr.production_year,pr.description
from (person natural join role) as pr,(select id,max(c) from temp1)as t
where person.id=t.id
;",2018-08-30 21:19:01.951748+10,15,1,85,correct
8179,"select w.first_name, w.last_name, w.title, w.production_year, w.description
from (person p natural join role r) w,
(select p1.id, count(*) as noofrole from role r1 natural join person p1 group by p1.id) u1
where w.id=u1.id and u1.noofrole=
(select max(noofrole)
from (
select p2.id, count(*) as noofrole from role r2 natural join person p2 group by p2.id) u2);
",2018-08-30 21:19:19.990029+10,15,1,270,correct
8180,"SELECT po2.id
FROM person po2
WHERE po2.year_born IN(
	SELECT MAX(pout.year_born)
	FROM person pout
	WHERE pout.id NOT IN
	(
		SELECT p.id
		FROM person p
		WHERE p.year_born IN (
			SELECT MAX(pin.year_born)
			FROM person pin
		)
	)
)
;
",2018-08-30 21:19:24.146239+10,3,1,353,correct
8181,"select count(*)
from person p
where not exists (select * from director d where d.id=p.id);
",2018-08-30 21:19:25.50769+10,12,1,22,correct
8182,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-30 21:19:32.947307+10,4,1,233,correct
8183,"SELECT ma.title,ma.production_year,d.first_name,d.last_name
FROM (person p NATURAL JOIN director) AS d,
	(SELECT title,production_year
	FROM movie_award
	WHERE
		lower(movie_award.category) = lower('Best Film')
		AND lower(movie_award.award_name) = lower('BAFTA Film Award')
		AND lower(movie_award.result) = lower('won')) AS ma
WHERE 
	d.title = ma.title;",2018-08-30 21:19:58.452193+10,8,1,285,correct
8184,"SELECT COUNT(*) 
FROM PERSON p
WHERE NOT EXISTS (
	SELECT * 
	FROM DIRECTOR d
	WHERE p.id = d.id);
",2018-08-30 21:20:47.763565+10,12,1,423,correct
8185,"WITH w_d AS (
SELECT id,title,production_year FROM writer

UNION

SELECT id,title,production_year FROM director

),


id_count AS (SELECT id, COUNT(id) a FROM w_d
GROUP BY id)


SELECT id FROM id_count
WHERE a = (SELECT MAX(a) FROM id_count)
;

",2018-08-30 21:20:55.094354+10,14,1,25,correct
8186,"SELECT id FROM (
	SELECT d.id, COUNT(*) AS c
	FROM Director d INNER JOIN Writer w WHERE w.id = d.id AND w.title=d.title AND w.production_year = d.production_year
	GROUP BY d.id)
WHERE c > 1;",2018-08-30 21:21:17.076028+10,4,0,434,partially correct
8187,"With w_d AS (

SELECT id,title, production_year from director
UNION
SELECT id,title, production_year from writer

),

id_count AS (SELECT id, COUNT(id) a
FROM w_d
GROUP BY id)

SELECT id FROM id_count 
WHERE a= (SELECT MAX(a) FROM id_count);",2018-08-30 21:22:11.43761+10,14,1,406,correct
8188,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p,role r,(
SELECT t.id,max(t.times)
FROM
(SELECT p.id,p.first_name,p.last_name,r.title,r.production_year,r.description,COUNT(*) as times
FROM person p, role r
WHERE p.id=r.id
GROUP BY p.first_name,p.last_name) as t)as tt
WHERE tt.id=p.id and tt.id=r.id
;",2018-08-30 21:22:22.589772+10,15,1,132,correct
8189,"SELECT id, first_name, last_name FROM (
SELECT id FROM (
	SELECT d.id, COUNT(*) AS c
	FROM Director d INNER JOIN Writer w WHERE w.id = d.id AND w.title=d.title AND w.production_year = d.production_year
	GROUP BY d.id)
WHERE c > 1) NATURAL JOIN Person;",2018-08-30 21:22:36.579111+10,4,1,434,correct
8227,"SELECT P.id, DA.award_name, DA.year_of_award, DA.category FROM 

DIRECTOR_AWARD DA,
DIRECTOR D,
PERSON P

WHERE 

DA.title = D.title AND
DA.production_year = D.production_year AND
D.id = P.id AND
DA.result = ""nominated"" AND
DA.title != (

SELECT D.title FROM 

DIRECTOR_AWARD DA,
DIRECTOR D,
PERSON P

WHERE 

DA.title = D.title AND
DA.production_year = D.production_year AND
D.id = P.id AND
DA.result = ""won""
);
",2018-08-30 21:34:45.682389+10,13,1,384,correct
8323,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;
",2018-08-30 22:00:18.073632+10,4,1,204,correct
8190,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(SELECT title,production_year
                 FROM movie_award
		      WHERE movie.title=movie_award.title
			      AND movie.production_year=movie_award.production_year
				 AND lower(movie_award.result)='won'
		      UNION
			 SELECT title,production_year 
                 FROM crew_award
		      WHERE movie.title=crew_award.title
			      AND movie.production_year=crew_award.production_year
				 AND lower(crew_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM director_award
		      WHERE movie.title=director_award.title
			      AND movie.production_year=director_award.production_year
				 AND lower(director_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM writer_award
		      WHERE movie.title=writer_award.title
			      AND movie.production_year=writer_award.production_year
				 AND lower(writer_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM actor_award
		      WHERE movie.title=actor_award.title
			      AND movie.production_year=actor_award.production_year
				 AND lower(actor_award.result)='won');",2018-08-30 21:22:40.355646+10,11,1,369,correct
8191,"select id
from person person
where person.year_born = (slect max(year_born) from person p where p.year_born < max(p.year_born));
",2018-08-30 21:22:48.000339+10,3,0,102,noninterpretable
8192,"SELECT COUNT (*)
FROM PERSON e1
WHERE NOT EXISTS (SELECT * FROM DIRECTOR e2 WHERE e2.id = e1.id);",2018-08-30 21:23:11.858905+10,12,1,435,correct
8193,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT w.id FROM writer w
WHERE p.id=w.id AND p.year_born=1935);",2018-08-30 21:23:16.039141+10,1,1,204,correct
8194,"SELECT TITLE,PRODUCTION_YEAR FROM (SELECT * FROM PERSON NATURAL JOIN WRITER) AS XYZ  WHERE FIRST_NAME = ""KEVIN"" AND LAST_NAME =""WILLIAMSON"";",2018-08-30 21:23:52.612416+10,5,0,408,partially correct
8195,"With w_d AS (

SELECT id,title, production_year from director
UNION
SELECT id,title, production_year from writer

),

id_count AS (SELECT id, COUNT(id) a
FROM w_d
GROUP BY id)

SELECT id FROM id_count 
WHERE a= (SELECT MAX(a) FROM id_count);",2018-08-30 21:24:11.570612+10,14,1,406,correct
8196,"SELECT id
FROM Role r, Scene s, (SELECT title, description, production_year, scene_no
					FROM Appearance a
					WHERE a.title = 'Psycho' AND
					a.production_year=1960
					)AS at
WHERE s.title = at.title AND r.title = at.title AND at.description = r.description AND r.production_year = at.production_year
		AND at.scene_no = s.scene_no AND s.production_year = at.production_year
		GROUP BY id HAVING count(*) = 1;",2018-08-30 21:24:28.240417+10,10,1,54,correct
8197,"select count(*) AS NumberOfWritersBorn from person p where exists
(select * from writer w where w.id=p.id
AND year_born=1935);",2018-08-30 21:24:46.143852+10,1,1,137,correct
8198,"select title,production_year
from writer,(select id 
		from person 
		where lower(first_name) = ""kevin"" and lower(last_name) = ""williamson"") as a
where writer.id = a.id;
",2018-08-30 21:25:06.75962+10,5,1,153,correct
8199,"SELECT TITLE,PRODUCTION_YEAR FROM (SELECT * FROM PERSON NATURAL JOIN WRITER) AS XYZ  WHERE lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 21:25:11.471426+10,5,1,408,correct
8200,"select p3.id from person p3 where p3.year_born = (select max(p2.year_born) from person p2 where p2.year_born<
(select max(p.year_born) from person p));",2018-08-30 21:27:04.336843+10,3,1,130,correct
8201,"SELECT id, first_name, last_name
FROM PERSON p
WHERE;",2018-08-30 21:27:26.43546+10,4,0,423,noninterpretable
8202,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love'
AND lower(description)='m';",2018-08-30 21:28:19.325132+10,6,1,124,correct
8203,"SELECT production_year, count(*) NumberOfMovie
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;",2018-08-30 21:28:37.793571+10,2,1,204,correct
8204,"SELECT COUNT(*) 
FROM writer_award wa,
	person p
WHERE
	p.id = wa.id
	AND p.first_name = 'Woody'
	AND p.last_name = 'Allen'
	AND wa.year_of_award > 1990
	AND wa.year_of_award < 1996;",2018-08-30 21:29:14.783105+10,9,0,285,partially correct
8205,"SELECT COUNT(id)
FROM person, movie
WHERE year_born = 1935;",2018-08-30 21:29:37.679185+10,1,0,426,partially correct
8206,"select t2.id, 
from (select t.id, count(t.title) as no_movie from
(select d.id, d.title
from director d,
	movie m
where d.title = m.title and
	d.production_year = m.production_year
union
select w.id,w.title
from writer w,
	movie m
where w.title = m.title and
	w.production_year = m.production_year) t
group by t.id
order by count(t.title) desc) t2;

",2018-08-30 21:29:42.633644+10,14,0,332,noninterpretable
8207,"SELECT COUNT(id)
FROM person, movie
WHERE year_born = 1935;",2018-08-30 21:29:43.690431+10,1,0,426,partially correct
8208,"select country 
from restriction
where lower(title)=""shakespeare in love"" and description = ""M"";",2018-08-30 21:29:45.169266+10,6,1,153,correct
8209,"SELECT h.id,h.award_name,h.year_of_award,h.category
from (SELECT person.id,director_award.award_name,director_award.year_of_award,director_award.category,COUNT(*) as cot
from person natural join director_award group by director_award.result
having cot>0 and director_award.result !='won') as h;",2018-08-30 21:29:51.683528+10,13,0,307,partially correct
8210,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(SELECT MAX(year_born) FROM person);",2018-08-30 21:29:53.014613+10,7,1,124,correct
8211,"SELECT COUNTRY FROM(SELCET * FROM MOVIE NATURAL JOIN RESTRICTION) AS XYZ WHERE LOWER(TITLE)= ""shakesphere in love"" AND LOWER(DESCRIPTION) = ""m"";",2018-08-30 21:31:05.424764+10,6,0,408,noninterpretable
8212,"select a.id,count(*)
from (select w.id ,w.title
from writer w
union 
select d.id,d.title
from director d) as a
group by a.id
order by count(*) desc
limit 3;",2018-08-30 21:31:11.644345+10,14,0,298,partially correct
8213,"SELECT title, production_year
FROM (SELECT id FROM Person WHERE first_name = 'Kevin' AND last_name = 'Williamson') NATURAL JOIN Writer;",2018-08-30 21:31:14.775979+10,5,1,434,correct
8214,"select production_year, count(*) AS NumberOfMovies
FROM Movie WHERE production_year IN (1993,1992,1991) Group By Production_year
Order By NumberOfMovies DESC;",2018-08-30 21:31:29.360542+10,2,1,137,correct
8215,"select id,first_name,last_name
from person
where year_born = (select max(year_born)
			from person);",2018-08-30 21:32:11.898603+10,7,1,153,correct
8216,;,2018-08-30 21:32:15.510547+10,14,0,138,noninterpretable
8217,SELECT COUNTRY FROM RESTRICTION WHERE LOWER(TITLE)= 'shakesphere in love' AND LOWER(DESCRIPTION) = 'm';,2018-08-30 21:32:47.05671+10,6,0,408,partially correct
8218,"select id,count(title)
from person natural join writer natural join director as gg
group by id
;",2018-08-30 21:32:52.507406+10,14,0,154,partially correct
8219,"select ma.title, ma.production_year, p.first_name, p.last_name 
from (Movie_Award as ma, person as p)
where lower(ma.award_name) = 'bafta film award' 
and lower(ma.category) = 'best film' 
and lower(ma.result) = 'won';",2018-08-30 21:33:23.623081+10,8,0,390,partially correct
8220,;,2018-08-30 21:33:31.025106+10,15,0,138,noninterpretable
8221,;,2018-08-30 21:33:36.588104+10,1,0,217,noninterpretable
8222,SELECT COUNTRY FROM RESTRICTION WHERE lower(TITLE)= 'shakesphere in love' AND lower(DESCRIPTION) = 'm';,2018-08-30 21:33:40.004712+10,6,0,408,partially correct
8223,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id=d.id);",2018-08-30 21:33:53.687876+10,12,1,204,correct
8224,;,2018-08-30 21:34:11.468987+10,15,0,217,noninterpretable
8225,SELECT COUNTRY FROM RESTRICTION WHERE lower(title)= 'shakesphere in love' AND lower(description) = 'm';,2018-08-30 21:34:41.797109+10,6,0,408,partially correct
8226,"SELECT COUNT(*)
FROM MOVIE m
WHERE EXISTS (SELECT * FROM MOVIE_AWARD ma WHERE ma.title=m.title AND ma.production_year=m.production_year AND NOT lower(ma.result)='won'
UNION SELECT * FROM CREW_AWARD ca WHERE ca.title=m.title AND ca.production_year=m.production_year AND NOT lower(ca.result)='won'
UNION SELECT * FROM DIRECTOR_AWARD da WHERE da.title=m.title AND da.production_year=m.production_year AND NOT lower(da.result)='won'
UNION SELECT * FROM WRITER_AWARD wa WHERE wa.title=m.title AND wa.production_year=m.production_year AND NOT lower(wa.result)='won'
UNION SELECT * FROM ACTOR_AWARD aa WHERE aa.title=m.title AND aa.production_year=m.production_year AND NOT lower(aa.result)='won');

",2018-08-30 21:34:44.004907+10,11,0,185,noninterpretable
8284,"select production_year,count(production_year) from movie  group by production_year having production_year>=1991 and production_year<=1993;",2018-08-30 21:50:42.871847+10,2,1,16,correct
8228,"select t2.id from
(select t1.id , count(t1.id) as no_movie from
(select d.id, d.title
from director d,
	movie m
where d.title = m.title and
	d.production_year = m.production_year
union
select w.id,w.title
from writer w,
	movie m
where w.title = m.title and
	w.production_year = m.production_year) as t1
group by t1.id
order by count(t1.id) desc)  as t2
where t2.no_movie = (select max(no_movie) from (select t1.id , count(t1.id) as no_movie from
(select d.id, d.title
from director d,
	movie m
where d.title = m.title and
	d.production_year = m.production_year
union
select w.id,w.title
from writer w,
	movie m
where w.title = m.title and
	w.production_year = m.production_year) as t1
group by t1.id
order by count(t1.id) desc));",2018-08-30 21:35:00.641592+10,14,1,332,correct
8229,"select id,count(title)
from person natural join writer natural join director as gg
;",2018-08-30 21:35:14.098714+10,15,0,154,partially correct
8230,SELECT COUNTRY FROM RESTRICTION WHERE lower(title)= 'shakesphere in love' AND description = 'M';,2018-08-30 21:35:17.014378+10,6,0,408,partially correct
8231,"select first_name, last_name, title, production_year, description
from person, role
where person.id= role.id
and role.id=(select id from (select id ,max(num) from (select id, count(*) as num from role
group by id)));",2018-08-30 21:35:31.191038+10,15,1,197,correct
8232,"SELECT D.id, DA.award_name, DA.year_of_award, DA.category FROM 

DIRECTOR_AWARD DA,
DIRECTOR D

WHERE 

DA.title = D.title AND
DA.production_year = D.production_year AND
DA.result = ""nominated"" AND
DA.title != (

SELECT D.title FROM 

DIRECTOR_AWARD DA,
DIRECTOR D

WHERE 

DA.title = D.title AND
DA.production_year = D.production_year AND
DA.result = ""won""
);
",2018-08-30 21:35:33.121224+10,13,1,384,correct
8233,"SELECT id, first_name, last_name
FROM (PERSON natural join DIRECTOR natural join WRITER) as dw
group by dw.id
having count(*) >= 2;",2018-08-30 21:35:39.769593+10,4,1,423,correct
8234,"WITH id_count AS (SELECT id,COUNT(id) tot  FROM role
GROUP BY id),

max_guy AS (SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count))

SELECT first_name,last_name, title, production_year,description FROM person NATURAL JOIN roles
WHERE id = (SELECT * FROM max_guy);",2018-08-30 21:36:06.640543+10,15,0,25,noninterpretable
8235,SELECT country FROM restriction WHERE lower(title)= 'shakesphere in love' AND description = 'M';,2018-08-30 21:36:09.571387+10,6,0,408,partially correct
8236,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 21:36:12.99404+10,8,1,390,correct
8237,"SELECT id, first_name, last_name FROM person WHERE EXISTS (SELECT id FROM director d WHERE EXISTS( select * from writer w where d.id=w.id ) GROUP BY d.id HAVING count(d.id) > 2);
",2018-08-30 21:36:14.087804+10,4,0,166,partially correct
8238,"WITH id_count AS (SELECT id,COUNT(id) tot  FROM role
GROUP BY id),

max_guy AS (SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count))

SELECT first_name,last_name, title, production_year,description FROM person NATURAL JOIN roles
WHERE id = (SELECT * FROM max_guy);",2018-08-30 21:36:22.661872+10,15,0,25,noninterpretable
8239,"WITH id_count AS (SELECT id,COUNT(id) tot  FROM role
GROUP BY id),

max_guy AS (SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count))

SELECT first_name,last_name, title, production_year,description FROM person NATURAL JOIN role
WHERE id = (SELECT * FROM max_guy);",2018-08-30 21:36:45.619815+10,15,1,25,correct
8240,SELECT country FROM restriction WHERE lower(title)= 'shakespeare in love' AND description = 'M';,2018-08-30 21:37:07.509337+10,6,1,408,correct
8241,"with id_count as (SELECT id, count(id) tot
FROM ROLE
GROUP BY id),

max_guy as (SELECT id from id_count
where tot = (SELECT MAX(tot) FROM id_count))

SELECT first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
where id=(SELECT * FROM max_guy);",2018-08-30 21:37:29.950065+10,15,1,406,correct
8242,"SELECT mw.title, mw.production_year
FROM (person NATURAL JOIN movie NATURAL JOIN writer) AS mw
WHERE mw.first_name=Kevin AND mw.last_name=Williamson;
",2018-08-30 21:37:33.326456+10,5,0,233,noninterpretable
8243,"with id_count as (SELECT id, count(id) tot
FROM ROLE
GROUP BY id),

max_guy as (SELECT id from id_count
where tot = (SELECT MAX(tot) FROM id_count))

SELECT first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
where id=(SELECT * FROM max_guy);",2018-08-30 21:37:43.921094+10,15,1,406,correct
8244,"SELECT id, first_name, last_name FROM person WHERE EXISTS 
		(SELECT * FROM director d WHERE EXISTS
				( select * from writer w where d.id=w.id) GROUP BY d.id HAVING count(d.id) > 2);
",2018-08-30 21:38:01.63195+10,4,0,166,partially correct
8245,select distinct d.id from Director d Natural join Writer w group by id having count(*)>=2;,2018-08-30 21:38:16.933515+10,4,0,367,partially correct
8246,"SELECT COUNT(*)
FROM writer_award wa, writer w, person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 21:38:40.277115+10,9,1,285,correct
8247,"SELECT mw.title, mw.production_year
FROM (person NATURAL JOIN movie NATURAL JOIN writer) AS mw
WHERE mw.first_name= ""kevin"" AND mw.last_name= ""williamson"";
",2018-08-30 21:38:52.477982+10,5,0,233,partially correct
8248,"SELECT COUNT(*)
FROM MOVIE m
WHERE NOT EXISTS (SELECT title FROM MOVIE_AWARD ma WHERE ma.title=m.title AND ma.production_year=m.production_year AND NOT lower(ma.result)='won'
UNION SELECT title FROM CREW_AWARD ca WHERE ca.title=m.title AND ca.production_year=m.production_year AND NOT lower(ca.result)='won'
UNION SELECT title FROM DIRECTOR_AWARD da WHERE da.title=m.title AND da.production_year=m.production_year AND NOT lower(da.result)='won'
UNION SELECT title FROM WRITER_AWARD wa WHERE wa.title=m.title AND wa.production_year=m.production_year AND NOT lower(wa.result)='won'
UNION SELECT title FROM ACTOR_AWARD aa WHERE aa.title=m.title AND aa.production_year=m.production_year AND NOT lower(aa.result)='won');

",2018-08-30 21:39:23.498169+10,11,0,185,partially correct
8249,"WITH e1 AS 
();",2018-08-30 21:39:50.336895+10,4,0,435,noninterpretable
8250,"m;
",2018-08-30 21:40:00.796231+10,6,0,61,noninterpretable
8251,"SELECT mw.title, mw.production_year
FROM (person NATURAL JOIN movie NATURAL JOIN writer) AS mw
WHERE mw.first_name= 'kevin' AND mw.last_name= 'williamson';
",2018-08-30 21:40:09.826323+10,5,0,233,partially correct
8252,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma inner join director d inner join person p
on ma.title=d.title and ma.production_year=d.production_year and d.id=p.id
where lower(ma.award_name)=""bafta film award"" 
	and lower(ma.category) = ""best film"" 
	and lower(ma.result) = ""won"";
",2018-08-30 21:41:05.768664+10,8,1,153,correct
8253,"SELECT COUNT(*)
FROM MOVIE m
WHERE NOT EXISTS (SELECT title FROM MOVIE_AWARD ma WHERE ma.title=m.title AND ma.production_year=m.production_year AND lower(ma.result)='won'
UNION SELECT title FROM CREW_AWARD ca WHERE ca.title=m.title AND ca.production_year=m.production_year AND lower(ca.result)='won'
UNION SELECT title FROM DIRECTOR_AWARD da WHERE da.title=m.title AND da.production_year=m.production_year AND lower(da.result)='won'
UNION SELECT title FROM WRITER_AWARD wa WHERE wa.title=m.title AND wa.production_year=m.production_year AND lower(wa.result)='won'
UNION SELECT title FROM ACTOR_AWARD aa WHERE aa.title=m.title AND aa.production_year=m.production_year AND lower(aa.result)='won');

",2018-08-30 21:41:22.853264+10,11,1,185,correct
8254,"select person.id,first_name,last_name from person where person.id = (select d.id from Director d Natural join Writer w group by id having count(*)>=2);",2018-08-30 21:42:09.141949+10,4,0,367,partially correct
8746,"select country 
from restriction 
where title = 'Shakespeare in Love' and description ='M';",2018-08-30 23:58:14.552321+10,6,1,152,correct
8255,"
select count(*)
from movie
where movie.title in 
(
select title
from movie_award
where lower(result) ='won' 
union
select title
from crew_award
where lower(result) ='won'
union
select title
from director_award
where lower(result) ='won'
union
select title
from writer_award
where lower(result) ='won'
union
select title
from actor_award
where lower(result) ='won'
)
;",2018-08-30 21:42:14.661823+10,11,0,396,partially correct
8256,"with t3 as (with t2 as
(select distinct id,title,production_year from
(select id, title, production_year from director
union select id, title, production_year from writer) t1) 
select count(id) as total,id
from t2
group by id)
select id from t3
where total=(select max(total) from t3);

",2018-08-30 21:42:35.563538+10,14,1,397,correct
8257,"SELECT dout.id, dao.award_name, dao.year_of_award, dao.category
FROM director dout, director_award dao
WHERE EXISTS (
		SELECT d.id, da.*
		FROM director_award da, director d
		WHERE da.title = d.title AND da.production_year = d.production_year
			AND dout.id = d.id
	)
	AND NOT EXISTS (
		SELECT d.id, da.*
		FROM director_award da, director d
		WHERE da.title = d.title AND da.production_year = d.production_year
			AND lower(da.result) = 'won'
			AND dout.id = d.id
	)
	AND dout.title = dao.title AND dout.production_year = dao.production_year
;
",2018-08-30 21:42:40.498461+10,13,1,353,correct
8258,"
select count(*)
from movie
where movie.title not in 
(
select title
from movie_award
where lower(result) ='won' 
union
select title
from crew_award
where lower(result) ='won'
union
select title
from director_award
where lower(result) ='won'
union
select title
from writer_award
where lower(result) ='won'
union
select title
from actor_award
where lower(result) ='won'
)
;",2018-08-30 21:42:47.357818+10,11,0,396,partially correct
8259,"select person.id,first_name,last_name from person where person.id in (select d.id from Director d Natural join Writer w group by id having count(*)>=2);",2018-08-30 21:42:59.335094+10,4,1,367,correct
8260,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-30 21:43:03.775686+10,5,1,233,correct
8261,"select t1.first_name, t1.last_name, t1.title, t1.production_year, t1.description from
(select p.id, p.first_name, p.last_name, r.title, r.production_year, r.description
from person p,
	role r
where p.id = r.id
order by p.id) as t1
group by t1.id;",2018-08-30 21:43:59.673876+10,15,0,332,partially correct
8262,"select count(*)
 from person p
 where exists (select * from writer w where w.id=p.id and p.year_born=1935);
",2018-08-30 21:44:27.12533+10,1,1,293,correct
8263,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, (select count() as no
from role r1
group by r1.id) t
where p.id=r.id
and r.id = p.id
and t.no= (select max(t1.sno)
from (select count() as sno
from role r1
group by r1.id) as t1) ;",2018-08-30 21:44:54.832902+10,15,0,110,partially correct
8264,"SELECT count(*)
FROM Movie m, ( SELECT title, production_year, result
			FROM movie_award ma, crew_award ca, Director_Award da, writer_award wa, actor_award aa
			WHERE m.title = ma.title AND m.title = ca.title AND m.title = da.title AND m.title = wa.title AND m.title = aa.title AND
				m.production_year = ma.production_year AND m.production_year = ca.production_year AND m.production_year = da.production_year AND 
				m.production_year = wa.production_year AND m.production_year = aa.production_year) as tp
WHERE lower(tp.result) = 'nominated ' AND NOT EXISTS(m.title = tp.title AND m.production_year = tp.production_year);",2018-08-30 21:44:57.534888+10,11,0,54,noninterpretable
8265,"SELECT country
FROM Restriction
WHERE lower(title) = 'shakespeare in love' AND description = 'M';",2018-08-30 21:45:06.294562+10,6,1,434,correct
8266,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 21:45:20.866869+10,15,1,273,correct
8267,"SELECT dw.id, dw,first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-30 21:45:58.401488+10,4,0,435,noninterpretable
8268,"SELECT id
FROM (
SELECT id,COUNT(*) as number
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) as n
GROUP by id
ORDER BY number DESC) as n3

WHERE number=
(SELECT max(number)
FROM(
SELECT id,COUNT(*) as number
FROM (SELECT d.id, title, production_year 
FROM director d 
UNION 
SELECT w.id, title, production_year 
FROM writer w) as n
GROUP by id
ORDER BY number DESC) as n2)
;",2018-08-30 21:46:12.209625+10,14,1,132,correct
8269,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, (select id, count() as no
from role r1
group by r1.id) t
where p.id=r.id
and t.id=p.id
and t.no= (select max(t1.sno)
from (select count() as sno
from role r1
group by r1.id) as t1) ;",2018-08-30 21:46:19.093988+10,15,1,110,correct
8270,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-30 21:46:19.162825+10,4,1,435,correct
8271,"select;
",2018-08-30 21:46:22.124754+10,7,0,61,noninterpretable
8272,"select count(*) AS Total_Number_Of_Persons from Person p
WHERE NOT EXISTS ( select * from Director D WHERE D.id=P.id );",2018-08-30 21:46:40.684872+10,12,1,137,correct
8273,"select count(*)
from person p inner join writer_award wa
on p.id = wa.id
where lower(p.first_name)=""woody"" and lower(p.last_name)=""allen""
	and wa.production_year > 1990 and wa.production_year < 1996;",2018-08-30 21:46:42.849066+10,9,1,153,correct
8274,"select count(*)
from person p inner join writer_award wa
on p.id = wa.id
where lower(p.first_name)=""woody"" and lower(p.last_name)=""allen""
	and wa.production_year > 1990 and wa.production_year < 1996
	and lower(result)=""won"";",2018-08-30 21:47:32.941047+10,9,0,153,partially correct
8275,"WITH id_count AS (SELECT id, COUNT(id) a FROM appearance NATURAL JOIN role
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY id

SELECT id FROM id_count
WHERE a = 1;",2018-08-30 21:48:20.697463+10,10,0,25,noninterpretable
8276,"SELECT count(DISTINCT person.id)
FROM person,writer
WHERE writer.id=person.id AND person.year_born=1935;",2018-08-30 21:48:24.015867+10,1,1,426,correct
8277,"WITH id_count AS (SELECT id, COUNT(id) a FROM appearance NATURAL JOIN role
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY id)

SELECT id FROM id_count
WHERE a = 1;",2018-08-30 21:48:38.738591+10,10,1,25,correct
8278,"with id_count AS (SELECT id, count(id) a FROM appearance NATURAL JOIN role
WHERE lower(title)='psycho' and production_year=1960
GROUP BY id)

SELECT id FROM id_count 
WHERE a=1;",2018-08-30 21:48:55.578045+10,10,1,406,correct
8279,"select p.id
from person p
where p.year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));
",2018-08-30 21:49:03.664255+10,3,1,102,correct
8280,;,2018-08-30 21:49:12.947455+10,7,0,399,noninterpretable
8281,"SELECT id
FROM person p 
WHERE p.year_born=(SELECT MAX(p.year_born) FROM person p
WHERE p.year_born<(SELECT MAX(p.year_born) FROM person p));",2018-08-30 21:49:23.409886+10,3,1,185,correct
8282,"SELECT ms.title, ms.production_year, ps.first_name, ps.last_name from (MOVIE_AWARD natural join Movie natural join director) as ms,
(MOVIE_AWARD natural join Movie natural join director natural join person) as ps, where 
(ms.award_name = ""BAFTA Film Award"" and ms.category = ""Best Film"");",2018-08-30 21:50:14.258611+10,8,0,213,noninterpretable
8283,"select d.id,award_name,year_of_award,category 
from director_award da 
left join director d 
on (  da.title=d.title and da.production_year=d.production_year   )
where lower(da.result)!='won';",2018-08-30 21:50:41.304698+10,13,1,374,correct
8286,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 21:51:22.119828+10,11,1,396,correct
8287,"select title, production_year from Writer where id like 'Kevin Williamson';",2018-08-30 21:51:40.116344+10,5,0,367,partially correct
8288,"SELECT COUNT(*)
FROM WRITER, PERSON
WHERE WRITER.id = PERSON.id AND PERSON.year_born =1935;",2018-08-30 21:51:40.197221+10,1,0,291,partially correct
8289,"select count(*)
 from writer w
 where exists (select p.id from person p where w.id=p.id and p.year_born=1935);",2018-08-30 21:51:53.761886+10,1,0,293,partially correct
8290,"select count(*)
from person p inner join writer_award wa
on p.id = wa.id
where lower(p.first_name)=""woody"" and lower(p.last_name)=""allen""
	and wa.year_of_award > 1990 and wa.year_of_award < 1996
	and lower(wa.result)=""won"";
",2018-08-30 21:52:00.608996+10,9,1,153,correct
8291,"SELECT p.id
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM PERSON
				WHERE year_born < (SELECT MAX(year_born)
								FROM PERSON));",2018-08-30 21:52:50.779429+10,3,1,177,correct
8292,"
SELECT MAX(COUNT(*)) FROM WRITER GROUP BY id;",2018-08-30 21:53:12.707344+10,14,0,384,noninterpretable
8293,"SELECT country
FROM (restriction_category NATURAL JOIN movie NATURAL JOIN restriction) AS mr
WHERE mr.description='m' AND mr.title='shakespeare in love';",2018-08-30 21:53:15.48118+10,6,0,233,partially correct
8294,"select first_name, last_name, title, production_year, description
from person, (select role.id, count(role.id) as number
from role, person
where role.id=person.id
and number=(select  max(number) 
from (select role.id, count(role.id) as number
from role, person
where role.id=person.id
group by role.id) as h
group by role.id) as g;
",2018-08-30 21:53:51.344801+10,15,0,140,noninterpretable
8295,"SELECT DISTINCT id FROM writer natural join person
WHERE year_born =1935;",2018-08-30 21:54:08.027395+10,1,0,406,partially correct
8296,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-30 21:54:27.829555+10,6,1,233,correct
8297,"select count(*) 
from (
	select id from writer_award 
	where lower(result) = 'won' 
	) as wa,
	person as p
where wa.id = p.id
and lower(first_name) = 'woody'
;",2018-08-30 21:54:42.043383+10,9,1,390,correct
8298,"SELECT Count (DISTINCT id) FROM writer natural join person
WHERE year_born =1935;",2018-08-30 21:54:43.196212+10,1,1,406,correct
8299,"select m1.titles, m1.production_year
from MOVIE m1
where m1.titles IN (
	select dp.titles
	from (DIRECTOR natural join PERSON) as dp
	where dp.first_name = 'Kevin' and dp.last_name = 'Williamson');",2018-08-30 21:54:44.631157+10,5,0,423,noninterpretable
8300,"select a.id
from (select d.id
from director d natural join movie) as a 
where select d.id
from (select d.id from director d natural join movie) UNION (select w.id
from writer w natural join movie);",2018-08-30 21:55:10.302868+10,14,0,307,noninterpretable
8301,"SELECT id, first_name, last_name FROM (
SELECT *, MIN(year_born) FROM Person);",2018-08-30 21:55:16.291053+10,7,0,434,partially correct
8302,"SELECT movie.production_year,count(*)
FROM movie
WHERE movie.production_year = 1991 
OR movie.production_year = 1992
OR movie.production_year = 1993
GROUP BY movie.production_year;",2018-08-30 21:55:32.253045+10,2,1,426,correct
8303,"WITH born AS (SELECT * FROM person NATURAL JOIN writer
WHERE year_born = 1935),

ids AS (SELECT DISTINCT id FROM born)

SELECT COUNT(*) FROM ids;",2018-08-30 21:55:40.512757+10,1,1,25,correct
8304,"select t1.id
from (select t.id, count(*) as no
from (select d.id, d.title, d.production_year
from director d
union
select w.id, w.title, w.production_year
from writer w) t
group by t.id) t1
where t1.no= (select max(t4.sno)
from (select t3.id, count(*) as sno
from (select d.id, d.title, d.production_year
from director d
union
select w.id, w.title, w.production_year
from writer w) t3
group by t3.id) t4);",2018-08-30 21:56:05.173974+10,14,1,110,correct
8305,"select count(*)
from person,writer
where person.id = writer.id and person.year_born = '1935';",2018-08-30 21:56:54.223361+10,1,0,440,partially correct
8306,"SELECT r.id
FROM scene s, role r, appearance a
WHERE s.production_year=r.production_year
AND s.title=r.title
AND s.scene_no=a.scene_no
AND r.description=a.description
AND r.title='Psycho'
AND r.prodction_year='1960'
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-30 21:57:27.767873+10,10,0,424,noninterpretable
8307,"SELECT DISTINCT COUNT(PERSON.year_born)
FROM PERSON INNER JOIN WRITER ON PERSON.id=WRITER.id AND PERSON.year_born=1935;



",2018-08-30 21:57:33.492159+10,1,0,193,partially correct
8308,"SELECT id, first_name, last_name FROM (
SELECT *, MAX(year_born) FROM Person);",2018-08-30 21:57:48.732883+10,7,1,434,correct
8309,"select id,p1.year_born
from person p1
where p1.year_born not in 
(
select p2.year_born
from person p2
order by p2.year_born desc
limit 1
)
order by p1.year_born desc
limit 1



;",2018-08-30 21:58:07.711403+10,3,0,396,partially correct
8310,"SELECT production_year, count(production_year) FROM movie 
WHERE production_year>1990 and production_year<1994
GROUP BY production_year;",2018-08-30 21:58:20.766901+10,2,1,406,correct
8311,"WITH nmov AS (
	WITH wrdir AS (
		SELECT d.id, d.title, d.production_year
		FROM director d
		UNION
		SELECT w.id, w.title, w.production_year
		FROM writer w
	)
	SELECT DISTINCT p.id, COUNT(w.title) AS no_mov
	FROM person p, wrdir w
	WHERE p.id = w.id
	GROUP BY p.id
	ORDER BY no_mov DESC
)
SELECT nmo.id
FROM nmov nmo
WHERE nmo.no_mov IN (
	SELECT MAX(nm.no_mov)
	FROM nmov nm
)
;
",2018-08-30 21:58:25.568063+10,14,1,353,correct
8312,"select id
from person p1
where p1.year_born not in 
(
select p2.year_born
from person p2
order by p2.year_born desc
limit 1
)
order by p1.year_born desc
limit 1



;",2018-08-30 21:58:25.914206+10,3,1,396,correct
8313,"SELECT production_year, COUNT(production_year) FROM movie
WHERE production_year >= 1991 AND production_year <= 1993
GROUP BY production_year;",2018-08-30 21:58:48.319632+10,2,1,25,correct
8314,"select production_year, count(*)
from movie 
where production_year>1990 and production_year<1994
group by Production_year;
",2018-08-30 21:58:52.359462+10,2,1,158,correct
8315,"select wp.title, wp.production_year
from (WRITER natural join PERSON) as wp
where wp.first_name = 'Kevin' and wp.last_name = 'Williamson';",2018-08-30 21:58:53.205615+10,5,1,423,correct
8316,"select count(distinct person.id)
from person,writer
where person.id = writer.id and person.year_born = '1935';",2018-08-30 21:59:03.417212+10,1,1,440,correct
8317,"SELECT production_year,COUNT(*)
FROM movie
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-30 21:59:09.639947+10,2,1,439,correct
8318,"SELECT DISTINCT COUNT(PERSON.year_born)
FROM PERSON INNER JOIN WRITER ON PERSON.year_born=1935;



",2018-08-30 21:59:19.330971+10,1,0,193,partially correct
8319,"SELECT *
FROM scene s,
	role r
WHERE
	s.scene_no = 1
	AND lower(s.title) = lower('Psycho')
	AND s.production_year = 1960
	AND lower(r.title) = lower('Psycho')
	AND r.production_year = 1960
	AND lower(r.description) = lower(s.description);",2018-08-30 21:59:31.061603+10,10,0,285,partially correct
8320,"SELECT id, first_name, last_name
FROM person
GROUP BY year_born
HAVING MIN (year_born);",2018-08-30 21:59:36.885422+10,7,0,233,partially correct
8321,"select count(*)
from person 
where not exists (select * from director where director.id=person.id);",2018-08-30 21:59:51.495104+10,12,1,158,correct
8322,"select id,first_name,last_name from person where year_born= (select max(year_born) from person);",2018-08-30 22:00:03.79445+10,7,1,200,correct
8747,"select id, first_name, last_name from person order by person.year_born desc limit 1;",2018-08-30 23:58:39.238276+10,7,1,31,correct
8324,"with t1 as (select id,total from 
(select id,count(*) as total from role group by id) t)

select first_name,last_name,title,production_year
from person p,role r,t1
where p.id=r.id
and r.id=t1.id
and t1.total=(select max(total) from t1);",2018-08-30 22:00:19.594238+10,15,0,397,partially correct
8325,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)FROM 
(SELECT id,year_born 
FROM person 
WHERE person.year_born < (SELECT MAX(year_born)FROM person)
));",2018-08-30 22:00:28.448772+10,3,1,132,correct
8326,"select p.id,p.first_name,p.last_name
from person as p, director as d, writer as w
where p.id=d.id
and w.id=p.id
and d.title=w.title
and d.production_year=w.production_year
group by p.id
having count(*)>1;",2018-08-30 22:00:30.309829+10,4,1,158,correct
8327,"select id,first_name,last_name from person order by year_born desc limit 1;",2018-08-30 22:00:42.807249+10,7,1,200,correct
8328,"SELECT id, first_name, last_name
FROM person
GROUP BY year_born
HAVING MAX (year_born);",2018-08-30 22:00:45.791892+10,7,0,233,partially correct
8329,"with t1 as (select id,total from 
(select id,count(*) as total from role group by id) t)

select first_name,last_name,title,production_year,description
from person p,role r,t1
where p.id=r.id
and r.id=t1.id
and t1.total=(select max(total) from t1);",2018-08-30 22:00:50.801598+10,15,1,397,correct
8330,Select * From Person Order By year_born DESC Limit 1 Offset 1;,2018-08-30 22:00:50.99569+10,3,0,36,partially correct
8331,"select p.id, da.award_name, da.year_of_award, da.category 
from person p, director d, director_award da
where p.id = d.id
  and d.title = da.title
  and d.production_year = da.production_year
  and lower(RESULT) <> 'won';",2018-08-30 22:00:56.522246+10,13,1,102,correct
8332,"select title, production_year from movie_award where award_name = 'BAFTA Film Award' and category like '%Best Film%' or '%best film%';",2018-08-30 22:01:14.411041+10,8,0,399,partially correct
8333,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-30 22:01:20.378081+10,7,1,233,correct
8334,Select * From Person Order By year_born DESC Limit 1 Offset1;,2018-08-30 22:01:25.762489+10,3,0,36,noninterpretable
8335,"SELECT r.id
FROM scene s, role r, appearance a
WHERE s.production_year=a.production_year
AND s.title=a.title
AND s.production_year=r.production_year
AND s.title=r.title
AND s.scene_no=a.scene_no
AND r.description=a.description
AND lower(a.title)='psycho'
AND a.production_year='1960'
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-30 22:01:26.534747+10,10,1,424,correct
8336,"select title, production_year from movie_award where award_name = 'BAFTA Film Award' and category like '%Best Film%';",2018-08-30 22:01:30.621335+10,8,0,399,partially correct
8337,"select title, production_year
from writer, person
where writer.id=person.id
and lower(person.first_name)='kevin'
and lower(person.last_name)='williamson';",2018-08-30 22:01:54.094856+10,5,1,158,correct
8338,"SELECT r.id
FROM scene s, role r, appearance a
WHERE s.production_year=a.production_year
AND s.title=a.title
AND s.production_year=r.production_year
AND s.title=r.title
AND s.scene_no=a.scene_no
AND r.description=a.description
AND lower(r.title)='psycho'
AND r.production_year='1960'
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-30 22:01:58.638244+10,10,1,424,correct
8339,"select Writer.title, Writer.production_year from Writer where Writer.id in(
select Person.id from Person where first_name like 'Kevin' and last_name like 'Williamson');",2018-08-30 22:02:02.09728+10,5,1,367,correct
8340,"SELECT id FROM person
WHERE id NOT IN (SELECT * FROM director);",2018-08-30 22:02:06.253446+10,12,0,25,noninterpretable
8341,"select gg.id
from (select a.id,count(a.id) cot
from (select d.id
from director d natural join movie) as a, (select w.id
from writer w natural join movie) as b
where a.id = (select d.id from director d natural join movie UNION select w.id
from writer w natural join movie)
or b.id = (select d.id from director d natural join movie UNION select w.id
from writer w natural join movie)) as gg
group by gg.id
HAVING cot = max(cot);",2018-08-30 22:02:36.298242+10,14,0,307,partially correct
8342,"SELECT COUNT(*)
FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE NOT EXISTS (m.title=ma.title
OR m.title=ca.title
OR m.title=da.title
OR m.title=wa.title
OR m.title=aa.title);",2018-08-30 22:03:23.529769+10,11,0,424,noninterpretable
8343,"select id, first_name, last_name
from person
where year_born=(select max(year_born) from person);",2018-08-30 22:04:04.035989+10,7,1,158,correct
8344,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 22:04:06.705406+10,11,1,54,correct
8345,"WITH no_d AS (SELECT id FROM person
WHERE id NOT IN (SELECT id FROM director)

SELECT COUNT(*) FROM no_d;",2018-08-30 22:04:20.09106+10,12,0,25,noninterpretable
8346,"select m.title, m.production_year, p.first_name,p.last_name
from movie_award as m,director as d,person as p
where p.id=d.id
and lower(m.award_name)= 'bafta film award'
and lower(m.category)='best film'
and lower(m.result)='won'
and m.title=d.title
and m.production_year=d.production_year;",2018-08-30 22:04:43.68759+10,8,1,158,correct
8347,"

select p.id,p.first_name,p.last_name
from
(select id,count(*) as num
from (select distinct r.id, d.description
from role r,restriction d
where r.title =d.title and r.production_year=d.production_year and lower(d.country)='usa'
order by r.id)
group by id) as b,person p
where p.id =b.id and b.num=4;",2018-08-30 22:04:53.483981+10,1,0,64,partially correct
8348,"WITH no_d AS (SELECT id FROM person
WHERE id NOT IN (SELECT id FROM director))

SELECT COUNT(*) FROM no_d;",2018-08-30 22:04:59.278787+10,12,1,25,correct
8349,"with no_id as (SELECT id from person WHERE id not in (SELECT id from director))

SELECT count (*) from no_id;",2018-08-30 22:05:15.506887+10,12,1,406,correct
8350,"select id from role 
where lower(title) = 'psycho' 
and production_year = 1960 
group by id 
having count(id) = 1;",2018-08-30 22:05:27.513647+10,10,0,390,partially correct
8351,"select m.title, m.production_year, p.first_name,p.last_name
from movie_award as m,director as d,person as p
where p.id=d.id
and lower(m.award_name)= 'bafta film award'
and lower(m.category)='best film'
and lower(m.result)='won'
and m.title=d.title
and m.production_year=d.production_year;",2018-08-30 22:05:48.800656+10,8,1,158,correct
8352,"Select d.id, da.award_name, da.year_of_award, da.category From Director d, Director_Award da Where d.title = da.title AND d.result = 'nominated';",2018-08-30 22:05:59.482673+10,13,0,36,noninterpretable
8353,"select id from
person p left join director d on p.id=d.id  left join writer w on w.id=p.id;
",2018-08-30 22:06:03.828104+10,14,0,374,noninterpretable
8417,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma, director d,person p
where award_name = 'BAFTA Film Award' and category='best film' and ma.title = d.title and p.id=d.id and ma.production_year= d.production_year;",2018-08-30 22:21:26.608323+10,8,0,200,partially correct
8354,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 22:06:48.373931+10,14,1,203,correct
8355,"Select d.id, da.award_name, da.year_of_award, da.category From Director d, Director_Award da Where d.title = da.title AND da.result = 'nominated';",2018-08-30 22:06:55.811967+10,13,1,36,correct
8356,"SELECT id, award_name, year_of_award, category
FROM (person p NATURAL JOIN DIRECTOR d) AS h, DIRECTOR_AWARD da
WHERE h.production_year=da.production_year AND h.title=da.title
AND lower(da.result)='nominated' AND NOT lower(da.result)='won';",2018-08-30 22:07:01.550115+10,13,1,185,correct
8357,"SELECT title, production_year, first_name, last_name
FROM (
	SELECT title, production_year
	FROM Movie_Award
	WHERE lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND lower(result) = ""won"")
NATURAL JOIN Director NATURAL JOIN Person;",2018-08-30 22:07:38.537405+10,8,1,434,correct
8358,"SELECT e.title,e.production_year 
FROM MOVIE m INNER JOIN WRITER w AS e
ON m.title = w.title
AND m.production_year = w.production_year
WHERE e.id IN (
SELECT p.id 
FROM PERSON p 
WHERE p.first_name = 'Kevin'
AND p.last_name = 'Williamson');",2018-08-30 22:07:53.26768+10,5,0,435,noninterpretable
8359,"SELECT DISTINCT MOVIE.*
FROM MOVIE
WHERE MOVIE.production_year>1990 AND MOVIE.production_year<1994;
",2018-08-30 22:08:06.3214+10,2,0,193,partially correct
8360,"select id
from role r natural join appearance a
where lower(title) =""psycho"" and production_year=1960 
group by id
having count(*) =1;",2018-08-30 22:08:25.221637+10,10,1,153,correct
8361,"SELECT id from person
WHERE year_born <= ALL(SELECT year_born FROM person);",2018-08-30 22:08:45.738748+10,3,0,320,noninterpretable
8362,"SELECT m.title,m.production_year 
FROM MOVIE m INNER JOIN WRITER w
ON m.title = w.title
AND m.production_year = w.production_year
WHERE id IN (
SELECT p.id 
FROM PERSON p 
WHERE p.first_name = 'Kevin'
AND p.last_name = 'Williamson');",2018-08-30 22:08:52.240531+10,5,1,435,correct
8363,"select count(*)
from person as p, writer_award as w
where p.id=w.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and w.year_of_award>1991
and w.year_of_award<1996;",2018-08-30 22:09:15.940922+10,9,1,158,correct
8364,"SELECT * FROM writer w,person p WHERE w.id = p.id AND p.year_born = 1935;",2018-08-30 22:09:22.800804+10,1,0,440,partially correct
8365,"select distinct title,production_year from movie_award where award_name = 'BAFTA Film Award' and category='best film';",2018-08-30 22:09:35.12364+10,8,0,200,partially correct
8366,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN (SELECT pn.id
FROM person pn, director d
WHERE pn.id=d.id);",2018-08-30 22:09:42.029223+10,12,1,439,correct
8367,"WITH rol AS (
	SELECT rin.id, COUNT(*) AS rolen
	FROM role rin
	GROUP BY rin.id
	ORDER BY rolen DESC
)
SELECT p.first_name, p.last_name, ro.title, ro.production_year, ro.description
FROM rol rolo, role ro, person p
WHERE rolo.rolen IN(
		SELECT MAX(rol.rolen)
		FROM rol
	) AND rolo.id = ro.id AND rolo.id = p.id
;
",2018-08-30 22:10:10.357864+10,15,1,353,correct
8368,"SELECT pw.title,pw.production_year
FROM (SELECT p.id, p.first_name,p.last_name,w.title,w.production_year 
FROM person p,writer w 
WHERE p.id=w.id) AS pw
WHERE lower(pw.first_name)='kevin'
AND lower(pw.last_name)='williamson';",2018-08-30 22:10:12.467506+10,5,1,204,correct
8369,"select title,production_year from movie_award where award_name = 'BAFTA Film Award' and category='best film';",2018-08-30 22:10:21.908872+10,8,0,200,partially correct
8370,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;",2018-08-30 22:11:11.245582+10,2,1,193,correct
8371,"WITH id_count AS (SELECT id,COUNT(id) tot FROM director NATURAL JOIN writer NATURAL JOIN person
GROUP BY id)


SELECT id, first_name, last_name FROM id_count
WHERE tot >= 2;",2018-08-30 22:11:14.623957+10,4,0,25,noninterpretable
8372,"with id_count as (SELECT id, count(id) a from director natural join writer 
group by id)

SELECT id, first_name, last_name
FROM id_count natural join person
WHERE a>1;",2018-08-30 22:11:46.656975+10,4,1,406,correct
8373,"

select p.id,p.first_name,p.last_name
from
(select id,count(*) as num
from (select distinct r.id, d.description
from role r,restriction d
where r.title =d.title and r.production_year=d.production_year and lower(d.country)='usa'
order by r.id)
group by id) as b,person p
where p.id =b.id and b.num=(select count(distinct description)
from restriction
where lower(country)='usa');",2018-08-30 22:11:53.36832+10,1,0,64,partially correct
8374,"select d.id,da.award_name,da.year_of_award,da.category 
from director d, director_award da
where
da.title = d.title
and da.production_year = d.production_year
and lower(da.result) = 'nominated'
group by d.id
having count(*)>=1;",2018-08-30 22:11:58.675205+10,13,1,130,correct
8375,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (SELECT title,production_year FROM movie_award ma WHERE lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
UNION SELECT title, production_year FROM crew_award ca WHERE lower(ca.result)='won'and ca.title=m.title and ca.production_year=m.production_year 
UNION SELECT title, production_year FROM director_award da WHERE lower(da.result)='won' and da.title=m.title and da.production_year=m.production_year
UNION SELECT title, production_year FROM writer_award wa WHERE lower(wa.result)='won' and wa.title=m.title and wa.production_year=m.production_year
UNION SELECT title, production_year FROM actor_award aa WHERE lower(aa.result)='won' and aa.title=m.title and aa.production_year=m.production_year
);",2018-08-30 22:12:04.767484+10,11,1,424,correct
8376,"select r.id 
from role as r, appearance as a,scene as s
where r.title=a.title
and lower(a.title)='psycho'
and r.production_year=a.production_year
and a.production_year=1960
and s.scene.no=a.scene.no
and a.description=r.description
and a.title=s.title
and a.production_year=r.production_year
group by r.id
count(*)=1
;",2018-08-30 22:12:28.496213+10,10,0,158,noninterpretable
8377,"SELECT COUNT(*)
FROM person,writer
WHERE person.id = writer.id
AND person.year_born = 1935;",2018-08-30 22:12:28.610169+10,1,0,307,partially correct
8378,"SELECT COUNT(*)
FROM Writer_Award NATURAL JOIN Person
WHERE lower(first_name) = ""woody"" AND lower(last_name) = ""allen"" AND year_of_award > 1990 AND year_of_award < 1996;",2018-08-30 22:12:32.634501+10,9,0,434,partially correct
8379,"SELECT ma.title, ma.production_year, p.first_name, p.last_name from (SELECT title, production_year FROM movie_award WHERE
award_name = 'BAFTA Film Award' and category = 'Best Film' and lower(result) = 'won') as ma, director as d, person as p
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;",2018-08-30 22:12:35.420757+10,8,0,213,partially correct
8380,"select production_year,count(*)
from movie
group by production_year
having production_year = 1991 or production_year= 1992 or production_year =1993;",2018-08-30 22:12:36.925861+10,2,1,275,correct
8381,"SELECT ;
",2018-08-30 22:12:41.543317+10,8,0,61,noninterpretable
8382,"SELECT count(*) FROM
	(SELECT id from PERSON WHERE PERSON.id not in
		(SELECT id FROM DIRECTOR)) as t1 ;",2018-08-30 22:12:59.618897+10,12,1,16,correct
8383,;,2018-08-30 22:13:10.164075+10,14,0,96,noninterpretable
8418,"SELECT p.id, da.award_name, da.year_of_award, da.category
FROM person p, director_award da
WHERE EXISTS (SELECT * FROM director d WHERE d.title=da.title AND d.production_year=da.production_year AND NOT lower(da.result)='won');",2018-08-30 22:21:44.738828+10,13,0,424,partially correct
8384,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(SELECT title,production_year
                 FROM movie_award
		      WHERE movie.title=movie_award.title
			      AND movie.production_year=movie_award.production_year
				 AND lower(movie_award.result)='won'
		      UNION
			 SELECT title,production_year 
                 FROM crew_award
		      WHERE movie.title=crew_award.title
			      AND movie.production_year=crew_award.production_year
				 AND lower(crew_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM director_award
		      WHERE movie.title=director_award.title
			      AND movie.production_year=director_award.production_year
				 AND lower(director_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM writer_award
		      WHERE movie.title=writer_award.title
			      AND movie.production_year=writer_award.production_year
				 AND lower(writer_award.result)='won'
		      UNION
			SELECT title,production_year
                 FROM actor_award
		      WHERE movie.title=actor_award.title
			      AND movie.production_year=actor_award.production_year
				 AND lower(actor_award.result)='won');",2018-08-30 22:13:23.034855+10,11,1,369,correct
8385,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    role r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 22:13:25.827881+10,10,1,158,correct
8386,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 22:13:38.185827+10,10,1,390,correct
8387,"WITH id_count AS (SELECT id,COUNT(id) tot FROM director NATURAL JOIN writer NATURAL JOIN person
GROUP BY id)


SELECT id, first_name, last_name FROM id_count NATURAL JOIN person
WHERE tot >= 2;
",2018-08-30 22:13:42.837137+10,4,1,25,correct
8388,"select country
from RESTRICTION
where lower(title) = ""shakespeare in love"" and lower(description) = 'm';",2018-08-30 22:13:50.261375+10,6,1,423,correct
8389,"SELECT COUNT(*)
FROM Writer_Award NATURAL JOIN Person
WHERE lower(first_name) = ""woody""
	AND lower(last_name) = ""allen""
	AND year_of_award > 1990
	AND year_of_award < 1996
	AND lower(result) = ""won"";",2018-08-30 22:14:12.270259+10,9,1,434,correct
8390,"select country
from RESTRICTION
where title = ""Shakespeare in Love"" and description = 'M';",2018-08-30 22:14:16.394214+10,6,1,423,correct
8391,"select country
from RESTRICTION
where lower(title) = ""shakespeare in love"" and lower(description) = 'm';",2018-08-30 22:14:45.910319+10,6,1,423,correct
8392,"SELECT SUM(PERSON)
FROM person, director
WHERE person.id!=director.id;",2018-08-30 22:14:56.712184+10,12,0,193,noninterpretable
8393,"select p.first_name,p.last_name,ma.title,ma.production_year 
from movie_award ma, director d,person p
where award_name = 'BAFTA Film Award' and category='best film' and ma.title = d.title and p.id=d.id;",2018-08-30 22:15:36.537676+10,8,0,200,partially correct
8394,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * 
FROM director d
WHERE p.id = d.id);",2018-08-30 22:16:04.022079+10,12,1,193,correct
8395,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma, director d,person p
where award_name = 'BAFTA Film Award' and category='best film' and ma.title = d.title and p.id=d.id;",2018-08-30 22:16:04.059683+10,8,0,200,partially correct
8396,select country from restriction where title like 'Shakespeare in Love' and description = 'M';,2018-08-30 22:16:21.337401+10,6,1,367,correct
8397,"select id 
from person as p
where p.year_born=(select max(year_born) 
from person
where year_born<(select max(year_born)
from person));",2018-08-30 22:16:23.623759+10,3,1,158,correct
8398,select country from restriction where title like 'Shakespeare in Love' and description = 'M';,2018-08-30 22:16:25.503046+10,6,1,367,correct
8399,"SELECT ws.title, ws.production_year from (person Natural join writer Natural join movie) as ws where (lower(ws.first_name) = 'kevin' 
and lower(ws.last_name) = 'williamson');",2018-08-30 22:16:46.426934+10,5,1,213,correct
8400,"with
b AS (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ),
a as (SELECT
            max(number_of_roles)
        FROM b  )
select
p.first_name,
p.last_name,
r.title,
r.production_year,
r.description
FROM
person p,
ROLE r,
b
where
r.id = p.id and
p.id = b.id
and b.number_of_roles in a;",2018-08-30 22:17:38.751073+10,15,1,332,correct
8401,"SELECT p.*
FROM person p
WHERE EXISTS(SELECT * 
FROM ;",2018-08-30 22:17:43.872668+10,4,0,193,noninterpretable
8402,;,2018-08-30 22:17:44.339668+10,13,0,396,noninterpretable
8403,"Select count(distinct writer.id)
From writer
where writer.id in (Select id
                    From person
                    Where person.year_born='1935');
",2018-08-30 22:17:49.349016+10,1,1,83,correct
8404,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 22:17:55.099313+10,13,1,396,correct
8405,"select id, award_name, year_of_award, category
from director as d1, director_award as d2
where lower(result)='nominated'
and d1.title=d2.title
and d1.production_year=d2.production_year;",2018-08-30 22:17:55.7606+10,13,1,158,correct
8406,"SELECT DISTINCT title,production_year FROM writer NATURAL JOIN person
WHERE lower(first_name) = 'kevin'
AND lower(last_name) = 'williamson'
;",2018-08-30 22:17:58.602016+10,5,1,25,correct
8407,"SELECT title, production_year FROM writer natural join person
WHERE lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-30 22:18:05.004999+10,5,1,406,correct
8408,"SELECT count(person.id)
FROM person
WHERE person.id NOT IN (SELECT director.id FROM DIRECTOR);",2018-08-30 22:18:19.723977+10,12,1,426,correct
8409,"select id,first_name,last_name from person where year_born = max (year_born);",2018-08-30 22:18:22.252109+10,7,0,367,noninterpretable
8410,"select w.title ,w.production_year from  writer w, person p where   w.id=p.id 
and lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-30 22:18:33.477706+10,5,1,306,correct
8411,"select id,first_name,last_name from person where year_born in max (year_born);",2018-08-30 22:19:00.206086+10,7,0,367,noninterpretable
8412,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM DIRECTOR d,
	DIRECTOR_AWARD da
WHERE d.title = da.title
	AND d.production_year = da.production_year
	
	AND NOT EXISTS (SELECT *
				FROM DIRECTOR d1,
					DIRECTOR_AWARD da2
				WHERE d1.title = da1.title
					AND d1.production_year = da1.production_year;",2018-08-30 22:19:01.93115+10,13,0,177,noninterpretable
8413,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-30 22:19:37.092854+10,7,1,25,correct
8414,"SELECT id, first_name, last_name from person
where year_born = (SELECT MAX(year_born) from person);",2018-08-30 22:20:05.618321+10,7,1,406,correct
8415,"select title, production_year, first_name, last_name
from movie_award natural join director natural join person
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-30 22:20:31.987327+10,8,1,87,correct
8416,"SELECT ma.title, ma.production_year, p.first_name, p.last_name 
from (
SELECT title, production_year FROM movie_award WHERE
lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won') as ma, 
director as d, 
person as p
where 
ma.title = d.title 
and ma.production_year = d.production_year 
and d.id = p.id;",2018-08-30 22:20:36.144202+10,8,1,213,correct
8419,"WITH SLIST AS (
SELECT * 
FROM RESTRICTION
WHERE title = 'Shakespeare in Love')
SELECT country 
FROM SLIST 
WHERE SLIST.description = 'M';",2018-08-30 22:22:09.569889+10,6,1,435,correct
8420,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.id IN (SELECT e.id FROM
(SELECT *
FROM  writer w
GROUP BY w.id HAVING COUNT(*)>=2)
NATURAL JOIN 
(SELECT *
FROM  director d
GROUP BY d.id HAVING COUNT(*)>=2) e);",2018-08-30 22:22:16.717465+10,4,1,439,correct
8421,"select count(*)
from writer_award natural join person
where lower(first_name) = 'woody' and lower(last_name) = 'allen' and year_of_award >= 1991 and year_of_award <=1995 and lower(result) = 'won';",2018-08-30 22:22:16.919115+10,9,1,87,correct
8422,"SELECT id
from role
where lower(title)='psycho' and production_year=1960;",2018-08-30 22:22:56.032377+10,10,0,359,partially correct
8423,"with
a as (select id from director)
select count(*)
from person 
where person.id not in a;",2018-08-30 22:23:08.497063+10,12,1,332,correct
8424,"Select  production_year, count(*)
From movie m
Where m.production_year=1993 or m.production_year=1992 or m.production_year=1991
group by production_year;
",2018-08-30 22:23:24.281616+10,2,1,83,correct
8425,"select id
from role natural join appearance
where lower(title) = 'psycho' and production_year = 1960
group by id
having count(*)=1;",2018-08-30 22:23:30.65628+10,10,1,87,correct
8426,"SELECT COUNT(*) 
FROM person, writer
WHERE person.id = writer.id
AND person.year_born = 1935;",2018-08-30 22:23:44.530888+10,1,0,327,partially correct
8427,"SELECT id
FROM Appearance NATURAL JOIN Role
WHERE lower(title) = ""psycho"" AND production_year = ""1960""
GROUP BY description
HAVING COUNT(*) = 1;",2018-08-30 22:24:01.051979+10,10,1,434,correct
8428,"select count(*)
from person p,
	writer w
where p.year_born = 1935;
",2018-08-30 22:24:42.153179+10,1,0,332,partially correct
8429,"select *
from PERSON p1
where p1.year_born = (
	select MAX(p2.year_born)
	from PERSON p2);",2018-08-30 22:24:50.657396+10,7,0,423,partially correct
8430,"select count(*)
from person p,
	writer w
where p.year_born = 1935 and
	p.id = w.id;
",2018-08-30 22:25:06.427038+10,1,0,332,partially correct
8431,"select x2.id 
from (select x1.id, count(*) as totalno from
(select id , title, production_year from director
union
select id , title, production_year from writer) as x1
group by x1.id) as x2

where x2.totalno = 

(select max(x4.totalno) from 

(select x3.id ,count(*) as totalno from
(select id , title, production_year from director
union
select id , title, production_year from writer) as x3
group by x3.id) as x4


);





",2018-08-30 22:25:29.485478+10,14,1,374,correct
8432,"SELECT
	r.id
FROM
	appearance a,
	role r
WHERE
	a.title=r.title
	AND a.production_year = r.production_year
	AND a.description = r.description
	AND lower(a.title) = 'psycho'
	AND a.production_year = 1960
GROUP BY
	r.id
HAVING
	count(*) = 1;",2018-08-30 22:25:32.759225+10,10,1,285,correct
8433,select count(*) from movie;,2018-08-30 22:25:44.735393+10,11,0,390,partially correct
8434,"select count(*)
from person p,
	writer w
where p.year_born = 1935 and
	p.id = w.id
group by p.id;
",2018-08-30 22:26:07.121951+10,1,0,332,partially correct
8435,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 22:26:13.143871+10,13,1,424,correct
8436,"SELECT title,production_year,first_name,last_name FROM movie_award NATURAL JOIN person NATURAL JOIN director
WHERE lower(result) = 'won'
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film'

;",2018-08-30 22:26:26.991721+10,8,1,25,correct
8437,"select id,first_name,last_name from person where year_born = (select max(year_born)from person);",2018-08-30 22:26:33.262049+10,7,1,367,correct
8438,"SELECT DISTINCT(title), production_year FROM movie_award natural join movie natural join person
WHERE lower(award_name)='bafta film award' and lower(category)='best film' and lower (result)='won';",2018-08-30 22:26:49.784978+10,8,0,406,partially correct
8439,"SELECT person.id,first_name,last_name
FROM person
WHERE person.id IN (SELECT writer.id FROM writer)
AND (SELECT count(director.id) FROM director GROUP BY director.id)>=2;",2018-08-30 22:27:57.562539+10,4,0,426,partially correct
8440,"select id
from
(select id, title, production_year
from writer w
union
select *
from director d
)
group by id
having count(*)=(
select count(*)
from
(select id, title, production_year
from writer w
union
select *
from director d
)
group by id
order by count(*) desc
limit 1
)
;",2018-08-30 22:28:11.286694+10,14,1,396,correct
8441,"select id, first_name, last_name
from PERSON p
where p.year_born = (
	select MAX(year_born)
	from PERSON);",2018-08-30 22:28:19.04855+10,7,1,423,correct
8442,"SELECT title, production_year, first_name, last_name FROM movie_award natural join director natural join person
WHERE lower(award_name)='bafta film award' and lower(category)='best film' and lower (result)='won';",2018-08-30 22:28:25.796202+10,8,1,406,correct
8443,"Select count(person.id)
From person
Where person.id not in (Select director.id
                        From director);",2018-08-30 22:28:26.513817+10,12,1,83,correct
8444,"SELECT w.title,w.production_year
FROM writer w, person p
WHERE w.id=p.id AND p.first_name='Kevin' AND p.last_name='Williamson';",2018-08-30 22:28:30.200067+10,5,1,439,correct
8445,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p,role r
WHERE p.id=r.id 
AND p.id IN 
(SELECT re2.id FROM (SELECT r.id, COUNT(r.description) AS total 
FROM role r
GROUP BY r.id) AS re2
WHERE re2.total IN
(SELECT MAX(re.total) FROM 
(SELECT r.id, COUNT(r.description) AS total 
FROM role r
GROUP BY r.id) AS re));",2018-08-30 22:28:42.673705+10,15,1,95,correct
8446,SELECT COUNT(*) FROM person p WHERE p.id IN (SELECT id FROM writer) AND p.year_born = 1935;,2018-08-30 22:28:44.584797+10,1,1,427,correct
8447,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 22:28:50.723181+10,11,1,390,correct
8448,"select count(*) from movie m
where not exists(select title, production_year from movie_award ma where m.title = ma.title and m.production_year = ma.production_year and lower(result) = 'won'
 union select title, production_year from crew_award ma where m.title = ma.title and m.production_year = ma.production_year and lower(result) = 'won'
 union select title, production_year from director_award ma where m.title = ma.title and m.production_year = ma.production_year and lower(result) = 'won'
 union select title, production_year from writer_award ma where m.title = ma.title and m.production_year = ma.production_year and lower(result) = 'won'
 union select title, production_year from actor_award ma where m.title = ma.title and m.production_year = ma.production_year and lower(result) = 'won');",2018-08-30 22:29:19.179923+10,11,1,87,correct
8449,"SELECT p.id,p.first_name,p.last_name
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born) FROM PERSON);",2018-08-30 22:29:49.16091+10,7,1,435,correct
8450,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma, director d,person p
where award_name = 'BAFTA Film Award' and category='best film' and ma.title = d.title and p.id=d.id and 
ma.production_year= d.production_year and result='won';",2018-08-30 22:30:12.986492+10,8,1,200,correct
8451,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma, director d,person p
where award_name = 'BAFTA Film Award' and category='best film' and ma.title = d.title and p.id=d.id and 
ma.production_year= d.production_year and result='won';",2018-08-30 22:30:27.178007+10,8,1,200,correct
8452,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM DIRECTOR d,
	DIRECTOR_AWARD da
WHERE d.title = da.title
	AND d.production_year = da.production_year
	AND lower(da.result) = 'nominated'
	
	AND d.id NOT IN (
		SELECT id
		FROM DIRECTOR d,
			DIRECTOR_AWARD da
		WHERE d.title = da.title
			AND d.production_year = da.production_year
			AND lower(da.result) = 'won');",2018-08-30 22:30:28.872275+10,13,1,177,correct
8453,"select id
from person
where year_born = (select max(year_born) from (select year_born from person where year_born < (select max(year_born) from person)));",2018-08-30 22:30:53.79539+10,3,1,87,correct
8454,"SELECT country
FROM restriction 
WHERE title='Shakespeare in Love' AND description='M';",2018-08-30 22:30:57.985593+10,6,1,439,correct
8455,"select ma.title, ma.production_year,
	p.first_name, p.last_name
from  movie_award as ma,
	director as d,
	person as p
where ma.title = d.title
	and ma.production_year = d.production_year
	and d.id = p.id
	and lower(ma.category) = 'best film'
	and lower(ma.award_name) = 'bafta film ward'
	and lower(ma.result) = 'won';",2018-08-30 22:31:04.610047+10,8,0,136,partially correct
8456,SELECT count(*)from (writer_award natural join writer natural join person) as ws;,2018-08-30 22:31:50.663163+10,9,0,213,partially correct
8457,"select count(distinct(writer.id))

from writer join person on writer.id = person.id

where person.year_born = '1935';
",2018-08-30 22:32:06.078107+10,1,1,235,correct
8458,"select r.country from restriction r where lower(r.title)='shakespeare in love' and lower(r.description)='m';
",2018-08-30 22:32:31.307749+10,6,1,306,correct
8459,"SELECT count(*) from writer_award natural join person
Where year_of_award > 1990 and year_of_award<1996 and lower(first_name)='woody' and lower(result)='won';",2018-08-30 22:32:33.839246+10,9,1,406,correct
8460,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE year_of_award >= 1991 AND year_of_award <= 1995
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
;",2018-08-30 22:32:36.89332+10,9,0,25,partially correct
8461,"Select p.id,p.first_name, p.last_name
From person p natural join director natural join writer
group by director.id
having count(director.id)>1;

",2018-08-30 22:32:47.166499+10,4,1,83,correct
8462,"select id, award_name, year_of_award, category
from director_award natural join director
where lower(result) = 'nominated' and id not in (select id from director_award natural join director where lower(result) = 'won');",2018-08-30 22:32:54.622451+10,13,1,87,correct
8463,"select ma.title, ma.production_year,
	p.first_name, p.last_name
from  movie_award as ma,
	director as d,
	person as p
where ma.title = d.title
	and ma.production_year = d.production_year
	and d.id = p.id
	and lower(ma.category) = 'best film'
	and lower(ma.award_name) = 'bafta film award'
	and lower(ma.result) = 'won';",2018-08-30 22:32:59.598099+10,8,1,136,correct
8464,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love'
AND description='M';",2018-08-30 22:33:00.39372+10,6,1,204,correct
8465,"SELECT production_year, COUNT(*) FROM movie WHERE production_year<=1993 AND production_year>=1991 GROUP BY production_year;",2018-08-30 22:33:02.276042+10,2,1,427,correct
8466,"select id, first_name, last_name from person 
WHERE
( select count(*) from director WHERE Person.id=Director.id
Group By id
Having count(*) >2);",2018-08-30 22:33:04.228756+10,4,0,137,partially correct
8467,"SELECT COUNT(writer.id)
FROM writer LEFT JOIN person ON writer.id=person.id 
WHERE year_born=1935;",2018-08-30 22:33:10.12527+10,1,0,422,partially correct
8468,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE year_of_award >= 1991 AND year_of_award <= 1995
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen'
AND lower(result) = 'won'
;",2018-08-30 22:33:19.561123+10,9,1,25,correct
8469,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT id 
FROM director d WHERE d.id=p.id);",2018-08-30 22:33:57.410639+10,12,1,307,correct
8470,"SELECT j.id, j.first_name, j.last_name
FROM(director NATURAL JOIN writer NATURAL JOIN person) AS j
GROUP BY j.id
HAVING count(*) >=2;
",2018-08-30 22:35:22.810085+10,4,1,426,correct
8471,"SELECT r.id
from role r, appearance a, scene s
where lower(s.title)='psycho' and s.production_year=1960
 and a.title=r.title 
 and r.title=s.title
 and a.production_year=r.production_year
 and r.production_year=s.production_year
 and r.description=a.description
 and a.scene_no=s.scene_no
group by r.id
having count(*)=1;
   ",2018-08-30 22:35:37.718455+10,10,1,359,correct
8472,"SELECT dw.id, dw.first_name,dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer)AS dw
GROUP BY dw.id
HAVING count(*)>1;
",2018-08-30 22:36:43.247744+10,4,1,193,correct
8473,SELECT COUNT(*) FROM PERSON p WHERE p.id NOT IN (SELECT id FROM director);,2018-08-30 22:36:47.072965+10,12,1,427,correct
8474,"WITH worked_on AS (
SELECT d.id, d.title, d.production_year
FROM director d
UNION
SELECT w.id, w.title, w.production_year
FROM writer w)
SELECT a.id
FROM (SELECT a1.id, COUNT(*) AS number
FROM worked_on a1
GROUP BY id) a
WHERE a.number=(SELECT MAX(number)
FROM (SELECT a2.id, COUNT(*) AS number
FROM worked_on a2
GROUP BY id));",2018-08-30 22:37:29.617364+10,14,1,96,correct
8475,"SELECT id,first_name,last_name from PERSON WHERE PERSON.id in (
	SELECT id FROM (DIRECTOR NATURAL JOIN WRITER) GROUP BY (id) having count(id)>=2) ;",2018-08-30 22:38:12.163869+10,4,1,16,correct
8476,"select id from person
where year_born = (
	select max(year_born) from(
		select * from person
		where year_born < (
			select max(year_born) from person 
			group by year_born having count(*) = 1)))
	group by year_born having count(*) = 1
;",2018-08-30 22:38:17.332602+10,3,0,390,partially correct
8477,"select production_year, count(production_year)

from movie 

where movie.production_year in (1993,1992,1991)

group by production_year;
",2018-08-30 22:38:51.70021+10,2,1,235,correct
8478,"SELECT dw.first_name, dw.last_name, m.title, m.production_year
From (MOvies m NATURAL JOIN DIRECTOR d NATURAL JOIN MOVIE_AWARD) As dw
GROUP BY dw.id
AWARD(award_name) ='BAFTA FILM AWARD' 
AND category = BEST FILM;",2018-08-30 22:39:12.336855+10,8,0,352,noninterpretable
8479,"select production_year, count (*) as numbers
from movie
where production_year <= 1993 and production_year >= 1991
group by production_year;",2018-08-30 22:39:33.223283+10,2,1,276,correct
8480,"select person.first_name,person.last_name, from 
select director.id from director where exists(
select title, production_year from movie_award 
where award_name = 'BAFTA Film Award' and category = Best Film)as x1;",2018-08-30 22:39:51.675517+10,8,0,367,noninterpretable
8481,"select first_name,last_name ,title, production_year, description 
from person,role
where person.id=role.id
and role.id= (
select  r1.id from (select r.id,count(*) as noofroles from role  r group by  r.id) as r1
where r1.noofroles =(
    select max(noofroles) from (select r.id,count(*) as noofroles from role  r group by  r.id)as r2
    )

);




",2018-08-30 22:40:01.264698+10,15,1,374,correct
8482,"SELECT p.id,first_name,last_name
from person p,director d,writer w
where d.title=w.title 
AND d.production_year=w.production_year
AND p.id=d.id
GROUP BY p.id
HAVING COUNT(*)>1;",2018-08-30 22:40:15.346837+10,4,0,307,partially correct
8483,"select id
from role
group by id
having count(*) =(

select count(*)
from role
group by id
order by count(*) DESC
limit 1
)
;",2018-08-30 22:40:44.277673+10,15,0,396,partially correct
8484,"SELECT id,first_name,last_name
FROM person
WHERE  year_born>= ANY year_born;",2018-08-30 22:41:02.069193+10,7,0,439,noninterpretable
8485,"Select title,production_year
From writer
Where writer.id in (Select id 
                    From person
                    Where person.first_name ='Kevin' 
                      AND person.last_name='Williamson'
                      AND person.id=writer.id);",2018-08-30 22:41:26.155677+10,5,1,83,correct
8520,"select distinct w.id,w.title,w.production_year
from writer_award w,person p,writer ww
where (year_of_award between 1991 and 1995) and 
p.id=ww.id and p.first_name='Woody' and p.last_name='Allen';",2018-08-30 22:52:06.587111+10,9,0,200,partially correct
8486,"SELECT count(*) as number_of from writer_award wa, writer w, person p
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id
and w.id = p.id and lower(first_name) = 'woody' and lower(last_name)= 'allen' and wa.year_of_award >= 1991 and year_of_award <=1995;",2018-08-30 22:41:43.326072+10,9,0,213,partially correct
8487,"SELECT id,first_name,last_name
FROM person
WHERE  year_born=(SELECT MAX(p.year_born)FROM person p);",2018-08-30 22:42:31.999963+10,7,1,439,correct
8488,"SELECT p.id,first_name,last_name
from person p,(director d NATURAL JOIN writer w) as h
where p.id=h.id
GROUP BY p.id
HAVING COUNT(*)>1;",2018-08-30 22:42:45.2684+10,4,1,307,correct
8489,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) FROM person);",2018-08-30 22:42:53.770851+10,7,1,204,correct
8490,"
select id from crew inner join 
(
	select title,production_year,count() from Movie_Award m where lower(result)='won' group by title, production_year having count() =(
		select max(r1) as R from (
			select count(*) as r1 from Movie_Award where lower(result)='won'  group by title, production_year
		) a
	)
) op on crew.title=op.title and crew.production_year=op.production_year;
",2018-08-30 22:43:01.273133+10,11,0,71,partially correct
8491,"SELECT count(*) as number_of from writer_award wa, writer w, person p
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id
and w.id = p.id and lower(first_name) = 'woody' and lower(result) = 'won' and lower(last_name)= 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <=1995;",2018-08-30 22:43:05.461939+10,9,1,213,correct
8492,"Select country
From restriction
Where lower(title)='shakespeare in love' AND description='M';",2018-08-30 22:43:16.685994+10,6,1,83,correct
8493,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
From (SELECT title, production_year
FROM MOVIE_AWARD
WHERE award_name = ""BAFTA Film Award"" AND lower(category) = ""best film"" AND result = ""won"") AS ma,

DIRECTOR as d,
PERSON as p
WHERE d.id = p.id AND d.title = ma.title
;",2018-08-30 22:43:17.769392+10,8,1,50,correct
8494,"SELECT COUNT(*)
FROM Movie AS m
WHERE NOT EXISTS(
	SELECT * FROM (
		SELECT title, production_year FROM Movie_Award WHERE lower(result) = ""won""
		UNION
		SELECT title, production_year FROM Crew_Award WHERE lower(result) = ""won""
		UNION
		SELECT title, production_year FROM Director_Award WHERE lower(result) = ""won""
		UNION
		SELECT title, production_year FROM Writer_Award WHERE lower(result) = ""won""
		UNION
		SELECT title, production_year FROM Actor_Award WHERE lower(result) = ""won"") AS a
	WHERE a.title = m.title AND a.production_year = m.production_year);",2018-08-30 22:43:25.041435+10,11,1,434,correct
8495,SELECT p.id;,2018-08-30 22:43:40.608921+10,14,0,177,noninterpretable
8496,select count(*) from (person natural join writer_award) AS a where a.first_name = 'Woody' and a.last_name = 'Allen' and a.year_of_award > 1990 and a.year_of_award < 1996 group by a.id;,2018-08-30 22:43:54.899798+10,9,0,399,partially correct
8497,"select count(*)
from person p
where p.id in (select distinct w.id from writer w where p.year_born=1935);",2018-08-30 22:44:23.3918+10,1,1,293,correct
8498,"SELECT COUNT(*)
FROM 
	movie m
WHERE NOT EXISTS(
	SELECT *
	FROM (movie_award NATURAL JOIN crew_award NATURAL JOIN director_award NATURAL JOIN writer_award NATURAL JOIN actor_award) AS a
	WHERE
		lower(m.title) = lower(a.title)
		AND lower(m.production_year) = lower(a.production_year)
	);",2018-08-30 22:44:27.547756+10,11,0,285,partially correct
8499,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 22:45:12.046789+10,8,1,352,correct
8500,"select id, first_name, last_name from 
(person NATURAL JOIN Director NATURAL JOIN WRITER)

Group By id
Having count(*) >1;",2018-08-30 22:46:20.934153+10,4,1,137,correct
8501,"select id, first_name, last_name from person p where p.year_born=(select max(year_born) from person);",2018-08-30 22:46:32.706134+10,7,1,306,correct
8502,"Select person.id, person.first_name, person.last_name
From person
group by person.year_born
having max(person.year_born);",2018-08-30 22:46:39.242333+10,7,0,83,partially correct
8503,"select count(*) from person p
Where EXISTS(Select *
 from writer w where w.id=p.id AND p.year_born=1935);",2018-08-30 22:46:42.599232+10,1,1,308,correct
8504,"select first_name, last_name, title, production_year, description
from role natural join person
where id =(
select id
from role
group by id
having count(*) =
(
select count(*)
from role r
group by r.id
order by count(*) DESC
limit 1
)
)
;",2018-08-30 22:47:44.880314+10,15,1,396,correct
8505,"select id,first_name,last_name
from person
where person.year_born = (select MAX(year_born) from person);",2018-08-30 22:48:30.606364+10,7,1,307,correct
8506,"SELECT *
FROM person p
WHERE p.last_name ='Williamson' AND p.first_name = 'Kevin';",2018-08-30 22:48:42.564496+10,5,0,193,partially correct
8507,"SELECT title,production_year FROM writer WHERE writer.id IN
	(SELECT id FROM Person WHERE lower(first_name)='kevin' and lower(last_name)='williamson');",2018-08-30 22:48:42.975756+10,5,1,16,correct
8508,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 22:48:48.740936+10,3,1,390,correct
8509,"SELECT ma.title,ma.production_year, p.first_name,p.last_name
FROM movie_award ma,person p, director d
WHERE p.id=d.id AND d.title= ma.title AND d.production_year=ma.production_year AND ma.award_name='BAFTA Film Award' AND ma.category='Best Film';",2018-08-30 22:49:06.077822+10,8,0,439,partially correct
8510,SELECT count(*) from movie;,2018-08-30 22:49:06.533461+10,10,0,213,partially correct
8511,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 22:49:11.838039+10,9,1,399,correct
8512,"select m.production_year,count (*) as No_OF_MOVIES
from MOVIE m WHERE m.production_year<=1993 AND m.production_year>=1991
GROUP BY m.production_year;
",2018-08-30 22:50:17.292406+10,2,1,308,correct
8513,"with 
	t1 as (select id, title, production_year
	from writer ),
	t2 as (select id, title, production_year
	from director ),
	t3 as (select  id, title , production_year from t1 union select * from t2),
	t4 as (select id, count(id) as no_movie from t3 group by id order by no_movie desc)
select id from t4
where no_movie = (select max(no_movie) from t4);",2018-08-30 22:50:32.194824+10,14,1,332,correct
8514,"select first_name, last_name, title, production_year, description
from role natural join person
where id in (
select id
from role
group by id
having count(*) =
(
select count(*)
from role r
group by r.id
order by count(*) DESC
limit 1
)
)
;",2018-08-30 22:50:38.226129+10,15,1,396,correct
8515,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id
	AND lower(first_name) = 'kevin'
	AND lower(last_name) = 'williamson';",2018-08-30 22:51:02.964057+10,5,1,193,correct
8516,"select p.id,p.first_name,p.last_name from person as p where p.id in (select w.id from writer as w , director as d where w.id=d.id AND d.title = w.title AND d.production_year = w.production_year GROUP BY w.id 
HAVING COUNT(*)>=2);",2018-08-30 22:51:04.962767+10,4,1,31,correct
8517,"SELECT count(*),production_year
FROM movie
GROUP BY production_year
HAVING 1990<movie.production_year<1994;",2018-08-30 22:51:25.602376+10,2,0,422,partially correct
8518,"SELECT h.id
FROM (SELECT id,year_born
      FROM person
	WHERE year_born!=MAX(person.year_born) AS h
WHERE year_born=(SELECT MAX(year_born)
                 FROM h);",2018-08-30 22:51:51.699694+10,3,0,369,noninterpretable
8519,"SELECT j.title,j.production_year
FROM (writer NATURAL JOIN movie NATURAL JOIN person) AS j
WHERE j.first_name = 'Kevin' AND j.last_name = 'Williamson';",2018-08-30 22:52:00.814502+10,5,1,426,correct
8521,"SELECT a.id, a.first_name, a.last_name from (person natural JOIN director natural JOIN writer) as a group by a.id having count(*) > 1;",2018-08-30 22:52:10.595461+10,4,1,166,correct
8522,"SELECT ma.title,ma.production_year, p.first_name,p.last_name
FROM movie_award ma,person p, director d
WHERE p.id=d.id AND d.title= ma.title AND d.production_year=ma.production_year 
AND lower(ma.award_name)='BAFTA Film Award' AND lower(ma.category)='Best Film' AND lower(ma.result)='won';",2018-08-30 22:52:16.860344+10,8,0,439,partially correct
8523,"SELECT id FROM PERSON WHERE year_born = (
	SELECT MAX(year_born) FROM (
		SELECT * FROM Person
		EXCEPT
		SELECT * FROM Person WHERE year_born = (
			SELECT MAX(year_born) FROM Person)));",2018-08-30 22:52:18.563904+10,3,1,434,correct
8524,"select movie.production_year,count(movie.production_year)
from movie
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by movie.production_year;",2018-08-30 22:52:54.785206+10,2,1,440,correct
8525,SELECT COUNT(ID) FROM PERSON GROUP BY ID;,2018-08-30 22:52:57.123594+10,1,0,441,partially correct
8526,SELECT country FROM RESTRICTION WHERE lower(title)='shakespeare in love' and lower(description)='m';,2018-08-30 22:53:13.051557+10,6,1,16,correct
8527,"select count(*)
from person p
where p.id in (select w.id from writer w where p.year_born=1935);",2018-08-30 22:53:44.204887+10,1,1,293,correct
8528,"SELECT first_name, last_name FROM person p WHERE EXISTS (SELECT d.id FROM director d INNER JOIN writer w ON d.id=w.id WHERE p.id=d.id GROUP BY d.id HAVING count(*)>1);",2018-08-30 22:53:55.882138+10,4,0,427,partially correct
8529,"select count(*) as TOTAL from person p
where NOT EXISTS 
(Select * from DIRECTOR d where p.id=d.id);
",2018-08-30 22:54:19.233247+10,12,1,308,correct
8530,"SELECT r.country
FROM restriction r
WHERE r.title='Shakespear in Love'
	AND r.description = 'M';",2018-08-30 22:54:45.189248+10,6,0,193,partially correct
8531,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT title,production_year
	FROM movie_award ma
	WHERE
		lower(m.title) = lower(ma.title)
		AND lower(m.production_year) = lower(ma.production_year)
		AND lower(ma.result) = 'won'
	UNION
	SELECT title,production_year
	FROM crew_award ca
	WHERE
		lower(m.title) = lower(ca.title)
		AND lower(m.production_year) = lower(ca.production_year)
		AND lower(ca.result) = 'won'
	UNION
	SELECT title,production_year
	FROM crew_award ca
	WHERE
		lower(m.title) = lower(ca.title)
		AND lower(m.production_year) = lower(ca.production_year)
		AND lower(ca.result) = 'won'
	UNION
	SELECT title,production_year
	FROM director_award da
	WHERE
		lower(m.title) = lower(da.title)
		AND lower(m.production_year) = lower(da.production_year)
		AND lower(da.result) = 'won'
	UNION
	SELECT title,production_year
	FROM writer_award wa
	WHERE
		lower(m.title) = lower(wa.title)
		AND lower(m.production_year) = lower(wa.production_year)
		AND lower(wa.result) = 'won'
	UNION
	SELECT title,production_year
	FROM actor_award aa
	WHERE
		lower(m.title) = lower(aa.title)
		AND lower(m.production_year) = lower(aa.production_year)
		AND lower(aa.result) = 'won'	
	);",2018-08-30 22:54:48.078601+10,11,0,285,partially correct
8532,"Select person.id, person.first_name, person.last_name
From person
order by year_born desc limit 1;",2018-08-30 22:55:17.304928+10,7,1,83,correct
8533,"SELECT COUNT(*) FROM (SELECT DISTINCT writer.id FROM writer JOIN person ON writer.id=person.id
WHERE year_born=1935
GROUP BY person.id);",2018-08-30 22:55:24.416222+10,1,1,320,correct
8534,"SELECT r.country
FROM restriction AS r
WHERE r.title = 'Shakespeare in Love' and r.description = 'M'
;",2018-08-30 22:56:05.759603+10,6,1,426,correct
8535,"SELECT COUNT(*)
FROM writer w
WHERE EXISTS (SELECT * FROM person p WHERE p.id = w.id and p.year_born=1935)

;",2018-08-30 22:56:53.80795+10,1,0,132,partially correct
8536,"select id, first_name, last_name from person
NATURAL JOIN director NATURAL JOIN writer
Group by id
having count(*)>1;
",2018-08-30 22:56:57.379766+10,4,1,308,correct
8537,"select title,production_year from movie 
EXCEPT select title,production_year from movie_award where lower(result)=""won""
EXCEPT select title,production_year from crew_award where lower(result)=""won""
EXCEPT select title,production_year from director_award where lower(result)=""won""
EXCEPT select title,production_year from writer_award where lower(result)=""won""
EXCEPT select title,production_year from actor_award where lower(result)=""won"";

",2018-08-30 22:57:14.639803+10,11,0,153,partially correct
8538,"SELECT p.first_name,p.last_name,p.title,p.production_year
FROM (person NATURAL JOIN director)AS p
WHERE EXISTS (SELECT ma.title,ma.production_year
FROM movie_award ma WHERE lower(ma.award_name)='bafta film award' AND lower(ma.category)='best film');",2018-08-30 22:57:34.341962+10,8,0,307,partially correct
8539,"SELECT country
FROM restriction 
WHERE lower(title)='shakespear in love' AND description = 'M';",2018-08-30 22:57:56.814042+10,6,0,193,partially correct
8540,"SELECT ma.title,ma.production_year,pd.first_name,pd.last_name
FROM (SELECT p.first_name,p.last_name,d.title,d.production_year 
FROM person p,director d WHERE p.id=d.id) AS pd,
movie_award AS ma
WHERE pd.title=ma.title
AND pd.production_year=ma.production_year
AND lower(ma.category)='best film'
AND lower(ma.award_name)='bafta film award'
AND lower(ma.result)='won';",2018-08-30 22:58:00.74899+10,8,1,204,correct
8541,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM movie_award ma,person p,director d
WHERE  p.id=d.id AND ma.title=d.title AND ma.production_year=d.production_year AND 
lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won';",2018-08-30 22:58:10.070624+10,8,1,439,correct
8542,"select count(person.id)
from person
where not exists (select director.id from director where person.id = director.id);",2018-08-30 22:58:13.459146+10,12,1,440,correct
8543,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-30 22:58:25.128896+10,6,1,193,correct
8544,"SELECT production_year, COUNT(*)
FROM movie m
WHERE m.production_year<1994 and m.production_year>1990
GROUP BY m.production_year
;",2018-08-30 22:58:26.372277+10,2,1,132,correct
8545,"SELECT id, first_name, last_name 
FROM person p NATURAL JOIN movie NATURAL join WRITER
GROUP BY p.id
HAVING COUNT(*) > 1;",2018-08-30 22:58:30.8339+10,4,0,427,partially correct
8546,"SELECT id, first_name, last_name 
FROM (person NATURAL JOIN movie NATURAL join WRITER) AS t
GROUP BY t.id
HAVING COUNT(*) > 1;",2018-08-30 22:59:05.414448+10,4,0,427,partially correct
8547,;,2018-08-30 22:59:13.409915+10,12,0,422,noninterpretable
8548,"select count(person.id)
from person
where person.id not in (select director.id from director where person.id = director.id);",2018-08-30 22:59:14.570478+10,12,1,440,correct
8549,"select count(*)
from (select title,production_year from movie 
EXCEPT select title,production_year from movie_award where lower(result)=""won""
EXCEPT select title,production_year from crew_award where lower(result)=""won""
EXCEPT select title,production_year from director_award where lower(result)=""won""
EXCEPT select title,production_year from writer_award where lower(result)=""won""
EXCEPT select title,production_year from actor_award where lower(result)=""won"");

",2018-08-30 22:59:17.384971+10,11,1,153,correct
8550,"SELECT role.id from appearance a, scene s, movie m, role r 
where (a.title = s.title and a.production_year = s.production_year and
a.scene_no = s.scene_no and a.title = r.title and a.production_year = r.production_year and m.production_year = '1961'
and lower(m.title) = 'psycho')  having count(*) >=1;",2018-08-30 22:59:17.926675+10,10,0,213,noninterpretable
8551,"SELECT id, award_name, year_of_award, category
FROM (Director_Award NATURAL JOIN Director) AS d
WHERE lower(result) = ""nominated"" AND NOT EXISTS (
	SELECT id
	FROM (Director_Award NATURAL JOIN Director) AS c
	WHERE lower(result) = ""won"" AND d.id = c.id
	);",2018-08-30 22:59:40.265966+10,13,1,434,correct
8552,"SELECT COUNT(*)
FROM person p 
WHERE p.id not in (SELECT id FROM director)
;",2018-08-30 22:59:46.929687+10,12,1,132,correct
8553,"SELECT id, first_name, last_name 
FROM (person NATURAL JOIN director NATURAL join writer) AS t
GROUP BY t.id
HAVING COUNT(*) > 1;",2018-08-30 22:59:54.991391+10,4,1,427,correct
8591,"SELECT r.id
FROM role r, scene s
WHERE s.title=r.title AND s.production_year=r.production_year AND s.scene_no=1 AND lower(s.title)='psycho' AND s.production_year=1960;",2018-08-30 23:09:13.838738+10,10,0,439,partially correct
8554,"select distinct count(w.id) as ""number of result""
from writer_award w,person p,writer ww
where (year_of_award between 1991 and 1995) 
and w.id=ww.id 
and w.title = ww.title 
and p.id=ww.id 
and p.first_name='Woody' 
and p.last_name='Allen'
and result='won';",2018-08-30 23:00:01.938282+10,9,1,200,correct
8555,"SELECT id,first_name,last_name,min(year_born) from PERSON ;",2018-08-30 23:00:03.515723+10,7,0,16,partially correct
8556,"select m.title, m.production_year from Movie m,
person p NATURAL JOIN writer w
where p.first_name='kevin' AND p.last_name =""Williamson"" AND p.id=w.id
GROUP BY  m.production_year;",2018-08-30 23:00:38.815105+10,5,0,308,partially correct
8557,"select count(distinct p.id) from person p inner join writer w 
on w.id = p.id
where p.year_born = 1935;",2018-08-30 23:00:59.064228+10,1,1,203,correct
8558,"SELECT id, first_name, last_name
FROM person
WHERE year_born = MAX(year_born);",2018-08-30 23:01:14.257958+10,7,0,193,noninterpretable
8559,"Select ma.title, ma.production_year,p.first_name, p.last_name
From movie_award ma, director d, person p
Where ma.title=d.title
AND d.id=p.id
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film';",2018-08-30 23:01:17.057447+10,8,0,83,partially correct
8560,"
select title, production_year from writer_award
 union SELECT title,production_year from movie_award
 union SELECT title,production_year from crew_award
 union SELECT title,production_year from director_award
 union SELECT title,production_year from actor_award 
;",2018-08-30 23:01:43.084036+10,11,0,359,partially correct
8561,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 23:01:52.018765+10,8,1,367,correct
8562,"select p.id, da.award_name, da.year_of_award, da.category 
from director_award as da,person as p,director as d
where da.title = d.title
and da.production_year = d.production_year
and d.id = p.id
and lower(da.result) != 'won';",2018-08-30 23:01:55.010257+10,13,1,390,correct
8563,"Select ma.title, ma.production_year,p.first_name, p.last_name
From movie_award ma, director d, person p
Where ma.title=d.title
AND d.id=p.id
AND lower(ma.award_name)='bafta film award'
AND lower(ma.category)='best film'
AND lower(ma.result)='won';",2018-08-30 23:01:57.735544+10,8,1,83,correct
8564,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT MAX(year_born)
FROM person);",2018-08-30 23:02:02.334849+10,7,1,193,correct
8565,"SELECT id, award_name, year_of_award, category
FROM (Director_Award NATURAL JOIN Director)
WHERE lower(result) = ""nominated"" AND id NOT IN (
	SELECT id
	FROM (Director_Award NATURAL JOIN Director)
	WHERE lower(result) = ""won""
	);",2018-08-30 23:02:07.065124+10,13,1,434,correct
8566,"SELECT p.first_name,p.last_name,p.title,p.production_year
FROM (person NATURAL JOIN director)AS p,(SELECT ma.title,ma.production_year
FROM movie_award ma WHERE lower(ma.award_name)='bafta film award' 
AND lower(ma.category)='best film'
AND lower(ma.result)='won')AS m
WHERE p.title=m.title
AND p.production_year=m.production_year;",2018-08-30 23:02:32.42193+10,8,1,307,correct
8567,"select production_year, count(*)as amount
from movie
where production_year>=1991 and production_year<=1993
group by production_year;",2018-08-30 23:02:32.537594+10,2,1,293,correct
8568,"select m.title, m.production_year from Movie m,
person p NATURAL JOIN writer w
where p.first_name='kevin' AND p.last_name =""Williamson"" AND p.id=w.id
GROUP BY  m.production_year;",2018-08-30 23:03:16.535443+10,5,0,308,partially correct
8569,"SELECT p.title,p.production_year,p.first_name,p.last_name
FROM (person NATURAL JOIN director)AS p,(SELECT ma.title,ma.production_year
FROM movie_award ma WHERE lower(ma.award_name)='bafta film award' 
AND lower(ma.category)='best film'
AND lower(ma.result)='won')AS m
WHERE p.title=m.title
AND p.production_year=m.production_year;",2018-08-30 23:03:40.311024+10,8,1,307,correct
8570,"select count(*) from person p
where id not in (select id from director);",2018-08-30 23:03:47.543527+10,12,1,203,correct
8571,;,2018-08-30 23:03:55.145556+10,10,0,399,noninterpretable
8572,;,2018-08-30 23:04:04.983888+10,4,0,422,noninterpretable
8573,"SELECT COUNT(*)
FROM writer_award wa, person p
WHERE wa.id=p.id AND lower(wa.result)='won' AND p.first_name='Woody' AND p.last_name='Allen' 
AND wa.year_of_award>=1991 AND wa.year_of_award<=1995;",2018-08-30 23:04:11.590782+10,9,1,439,correct
8574,"SELECT title, production_year 
FROM (movie NATURAL JOIN director NATURAL JOIN person) AS t
WHERE t.first_name='Kevin' AND t.last_name='Williamson';",2018-08-30 23:04:20.07357+10,5,0,427,partially correct
8575,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 23:04:21.997678+10,1,1,327,correct
8576,"SELECT p.id,p.first_name,p.last_name
FROM person p,writer w,director d
WHERE p.id=w.id
	and p.id=d.id
	and w.title=d.title
	and w.production_year=d.production_year
GROUP BY p.id
HAVING COUNT(*)>1
;",2018-08-30 23:04:48.350585+10,4,1,132,correct
8577,"select country from restriction 
where lower(title) = 'shakespeare in love' AND description='M';
",2018-08-30 23:05:09.929834+10,6,1,308,correct
8578,"SELECT id
FROM person
WHERE year_born=(SELECT MAX(year_born)
                 FROM person
		      WHERE year_born < (SELECT MAX(year_born)
			                  FROM person));",2018-08-30 23:05:18.02337+10,3,1,369,correct
8579,"Select count(*)
From writer_award wa , writer w , person p
Where wa.id= w.id
AND wa.title=w.title
AND wa.production_year=w.production_year
AND w.id=p.id
AND p.first_name='Woody'
AND P.last_name='Allen'
AND lower(wa.result)='won';",2018-08-30 23:05:38.245073+10,9,1,83,correct
8580,"select count(*) as neverDirectedAnyMovies
from person p
where not exists (select d.id from director d where p.id=d.id);",2018-08-30 23:05:57.616931+10,12,1,293,correct
8581,"SELECT title, production_year 
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS t
WHERE t.first_name='Kevin' AND t.last_name='Williamson';",2018-08-30 23:05:58.91756+10,5,1,427,correct
8582,"SELECT id from appearance a, scene s, movie m, role r 
where (a.title = s.title and a.production_year = s.production_year and
a.scene_no = s.scene_no and a.title = r.title and a.production_year = r.production_year and m.production_year = '1960'
and lower(m.title) = 'psycho')  group by id having count(*) >=1;",2018-08-30 23:06:24.048207+10,10,0,213,partially correct
8583,"SELECT id,first_name,last_name from 
	(SELECT id,first_name,last_name,min(year_born) from PERSON) as t1 ;",2018-08-30 23:06:37.748124+10,7,0,16,partially correct
8584,"select count(*) as neverDirectedAnyMovies
from person p
where p.id not in (select d.id from director d );",2018-08-30 23:06:38.559963+10,12,1,293,correct
8585,"select p.id,p.first_name,p.last_name from director d 
inner join writer w on w.id = d.id
inner join person p on p.id = w.id
group by d.id
having count(*)>2;",2018-08-30 23:06:50.998837+10,4,1,203,correct
8586,"SELECT p.first_name, p.last_name, a.title, a.production_year, a.description
FROM person p, (SELECT id, title, production_year, description, count(*) AS nor
FROM role
GROUP BY id) a
WHERE p.id=a.id
AND a.nor = (SELECT MAX(a1.nor)
FROM (SELECT COUNT(*) AS nor
FROM role
GROUP BY id) a1);",2018-08-30 23:07:01.257775+10,15,0,96,partially correct
8587,"SELECT m.title,m.production_year
FROM movie m,writer d,person p
WHERE p.id=d.id
	and lower(p.first_name)='kevin'
	and lower(p.last_name)='williamson'
	and m.title = d.title
	and m.production_year = d.production_year
;
",2018-08-30 23:07:36.642328+10,5,1,132,correct
8588,"Select title, production_year from writer where id = (Select id from person where first_name = ""Kevin"" AND last_name=""Williamson"");",2018-08-30 23:07:41.075538+10,5,1,166,correct
8589,"select distinct r.id
from Role r,Appearance a
where r.title = r.title
and a.production_year = r.production_year
and a.description=r.description 
and a.title ='Psycho'
and a.production_year = 1960;",2018-08-30 23:08:32.851924+10,10,0,200,partially correct
8590,"SELECT id FROM(
SELECT id, MAX(c) FROM (
SELECT id, COUNT(*) AS c FROM
(SELECT * FROM Director
UNION
SELECT * FROM (
	SELECT id, title, production_year FROM Writer
	EXCEPT
	SELECT * FROM Director))
GROUP BY id));",2018-08-30 23:08:54.603946+10,14,0,434,partially correct
8592,"select m.title,m.production_yera,p.first_name,p.last_name
from MOvie_award m, person p NATURAL JOIN director d
where p.id=d.id AND
lower(award_name)=""bfata film award'
AND lower(category)=""best film"" AND lower(result)=""won"";
",2018-08-30 23:09:15.926023+10,7,0,308,noninterpretable
8593,"SELECT country
From restriction r
where lower(r.title)='shakespeare in love'
	and lower(r.description)='m'
	;",2018-08-30 23:09:36.509658+10,6,1,132,correct
8594,"select count (id) from person
where ;
",2018-08-30 23:09:37.044324+10,12,0,276,noninterpretable
8595,"Select id
From role r, appearance a, scene s
Where r.title= a.title
AND r.production_year=a.production_year
AND r.description=a.description
AND a.title = s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND lower(a.title)='psycho'
AND a.production_year=1960;


  
  
",2018-08-30 23:10:18.887818+10,10,0,83,partially correct
8596,"select r.id
from Role r,Appearance a
where r.title = r.title
and a.production_year = r.production_year
and a.description=r.description 
and a.title ='Psycho'
and a.production_year = 1960
and a.scene_no =1;",2018-08-30 23:10:54.958011+10,10,0,200,partially correct
8597,select country from restriction where title='Shakespeare in Love' AND description='M';,2018-08-30 23:11:16.174671+10,6,1,166,correct
8598,"

select count(*)
from movie m
where not exists (

select title, production_year from writer_award
where result='won'
 union 
 SELECT title,production_year from movie_award
 where result='won'
 union 
 SELECT title,production_year from crew_award
  where result='won'
 union 
 SELECT title,production_year from director_award
  where result='won'
 union 
 SELECT title,production_year from actor_award 
  where result='won')
;",2018-08-30 23:11:29.556182+10,11,0,359,partially correct
8599,"SELECT id,first_name,last_name
FROM person p
where p.year_born = (
SELECT MAX(year_born) FROM person);
",2018-08-30 23:11:37.616324+10,7,1,132,correct
8600,"select count (*) 
from person p
where not exists (select *
		from director d
		where p.id = d.id);
",2018-08-30 23:11:45.226751+10,12,1,276,correct
8601,"SELECT id, first_name, last_name
FROM person
WHERE year_born =(SELECT MIN(year_born) FROM person);",2018-08-30 23:11:59.062783+10,7,0,426,partially correct
8602,"

select person.id, person.first_name, person.last_name, count(*) as c

from person
inner join writer on person.id=writer.id
inner join director on person.id=director.id
where director.title=writer.title
group by person.id
order by c DESC;",2018-08-30 23:12:07.936434+10,4,0,221,partially correct
8603,"Select r.id
From role r, appearance a, scene s
Where r.title= a.title
AND r.production_year=a.production_year
AND r.description=a.description
AND a.title = s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND lower(a.title)='psycho'
AND a.production_year=1960
group by r.id
having count(*)=1;

  
  
",2018-08-30 23:12:17.711044+10,10,1,83,correct
8604,"SELECT id,first_name,last_name from 
	(SELECT id,first_name,last_name,max(year_born) from PERSON) as t1 ;",2018-08-30 23:12:22.017882+10,7,1,16,correct
8605,"select id, first_name,last_name
from person p,movie m
where (select count(d.id) from director d,writer w where d.title = w.title and d.production_year = w.production_year group by d.id) >1
group by id;",2018-08-30 23:13:40.341479+10,4,0,440,partially correct
8606,"SELECT COUNT(*)
FROM (writer_award NATURAL JOIN writer) AS w,person p
WHERE w.id=p.id
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND w.year_of_award > 1990 AND w.year_of_award < 1996;",2018-08-30 23:14:17.665412+10,9,0,307,partially correct
8607,"SELECT r.id from appearance a, scene s, role r 
where (a.title = s.title and a.production_year = s.production_year and
a.scene_no = s.scene_no and s.title = r.title and s.production_year = r.production_year and a.description = r.description and 
a.production_year = '1960'
and lower(r.title) = 'psycho')  group by id having count(*) =1;",2018-08-30 23:14:20.297924+10,10,1,213,correct
8608,"select r.id
from role r,
	scene s,
	appearance a
where a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and a.title = 'Psycho'
	and a.production_year = 1960;",2018-08-30 23:14:29.501482+10,10,0,136,partially correct
8609,"SELECT COUNT(*)
FROM WRITER_AWARD wa NATURAL JOIN PERSON p
WHERE p.first_name = 'Woody' AND p.last_name = 'Allen' AND wa.production_year > 1990 AND wa.production_year < 1996;",2018-08-30 23:14:59.392645+10,9,1,50,correct
8610,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT max(year_born) FROM person);",2018-08-30 23:15:00.488593+10,7,1,426,correct
8611,"select first_name, last_name from person order by year_born limit 1;",2018-08-30 23:15:01.004293+10,7,0,166,partially correct
8612,"select w.title,w.production_year from writer as w, person as p where p.id=w.id AND lower(p.first_name)=""kevin"" AND lower(p.last_name)=""williamson"";",2018-08-30 23:15:06.172637+10,5,1,31,correct
8613,"select first_name, last_name from person order by year_born desc limit 1;",2018-08-30 23:15:21.46866+10,7,0,166,partially correct
8614,"Select;
",2018-08-30 23:15:50.315366+10,9,0,61,noninterpretable
8615,"select d.id,
da.award_name,
da.year_of_award,
da.category
FROM
    director_award da,
    director d

where 
   d.title = da.title
   and d.production_year  = da.production_year 
   and lower(da.result) = 'nominated'

and d.id not in (select id from director d ,director_award da
where d.title = da.title
and d.production_year = da.production_year
and lower(da.result) = 'won');

",2018-08-30 23:15:52.653879+10,13,1,265,correct
8616,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r, (SELECT id, count(*) AS nor
FROM role
GROUP BY id) a
WHERE p.id=a.id AND r.id=p.id
AND a.nor = (SELECT MAX(a1.nor)
FROM (SELECT COUNT(*) AS nor
FROM role
GROUP BY id) a1);",2018-08-30 23:15:52.942567+10,15,1,96,correct
8617,"SELECT COUNT(*)
FROM (writer_award NATURAL JOIN writer) AS w,person p
WHERE w.id=p.id
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND lower(w.result)='won'
AND w.year_of_award > 1990 AND w.year_of_award < 1996;",2018-08-30 23:15:57.819354+10,9,1,307,correct
8618,"WITH l AS (
SELECT id, COUNT(*) AS c
FROM (
	SELECT *
	FROM Director
	UNION
	SELECT *
	FROM (
		SELECT id, title, production_year FROM Writer
		EXCEPT
		SELECT * FROM Director))
GROUP BY id)
SELECT id
FROM l
WHERE c = (SELECT MAX(c) FROM l);",2018-08-30 23:15:58.840034+10,14,1,434,correct
8619,"SELECT d.id, award_name, year_of_award, category
FROM director d, director_award da
WHERE d.title=da.title AND d.production_year=da.production_year AND NOT EXISTS(
SELECT d.id, result
FROM director d, director da
WHERE LOWER(result)=""won"") AND d.title=da.title AND d.production_year=da.production_year;",2018-08-30 23:16:11.16793+10,13,1,312,correct
8620,"SELECT d.title,d.production_year,first_name,last_name
FROM person p,director d, movie_award ma
WHERE lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won'
	and ma.title=d.title
	and ma.production_year=d.production_year
	and d.id=p.id
;",2018-08-30 23:16:21.662018+10,8,1,132,correct
8621,"SELECT count(*)
FROM (SELECT id,production_year FROM writer_award
WHERE year_of_award>1990
AND year_of_award<1996
AND lower(result)='won') AS wa,
person AS p
WHERE wa.id=p.id
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen';",2018-08-30 23:16:50.185748+10,9,1,204,correct
8622,;,2018-08-30 23:17:08.183498+10,14,0,390,noninterpretable
8623,"SELECT m.title, m.production_year
FROM movie_award m, director d, person p
WHERE m.category = 'Best Film' AND m.award_name = 'BAFTA Film Award';",2018-08-30 23:17:10.940236+10,8,0,193,partially correct
8624,"SELECT COUNT(*) FROM
(SELECT * FROM writer
INNER JOIN person
ON writer.id = person.id
WHERE person.year_born = 1935) AS oldies;",2018-08-30 23:17:16.094314+10,1,0,444,partially correct
8625,"select a.title, a.production_year, p.first_name, p.last_name 
from Movie_Award a, Director d, Person p where 
a.award_name='BAFTA Film Award'AND a.category ='best film' AND
d.title = a.title AND d.production_year = a.production_year AND
p.id = d.id;
",2018-08-30 23:17:37.621378+10,8,0,137,partially correct
8653,"select id from person 
where year_born = (select max(year_born) from person p
where p.year_born <(select max(year_born) from person )) ;",2018-08-30 23:23:22.992413+10,3,1,265,correct
8626,"select r.id
from role r,
	scene s,
	appearance a
where a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by 
	r.id
having 
	count(*) = 1;",2018-08-30 23:18:00.433429+10,10,1,136,correct
8627,"select first_name, last_name from person order by year_born desc limit 1;",2018-08-30 23:18:08.016097+10,7,0,166,partially correct
8628,"




select person.id, person.first_name, person.last_name 

from person inner join (director join writer on director.id = writer.id and writer.title = director.title) on person.id = director.id 

Group by person.id, person.first_name, person.last_name 

having count(*) > 1 ;",2018-08-30 23:18:28.617486+10,4,1,235,correct
8629,"SELECT COUNT(oldies.id) FROM
(SELECT DISTINCT person.id FROM writer
INNER JOIN person
ON writer.id = person.id
WHERE person.year_born = 1935) AS oldies;",2018-08-30 23:18:41.541636+10,1,1,444,correct
8630,;,2018-08-30 23:18:55.9819+10,9,0,367,noninterpretable
8631,"select id, first_name, last_name from person order by year_born desc limit 1;",2018-08-30 23:18:56.653607+10,7,1,166,correct
8632,"



select person.id, person.first_name, person.last_name 

from person inner join (director join writer on director.id = writer.id and writer.title = director.title) on person.id = director.id 

Group by person.id, person.first_name, person.last_name 

having count(*) > 1 ;",2018-08-30 23:19:05.116254+10,4,1,235,correct
8633,"




select person.id, person.first_name, person.last_name 

from person inner join (director join writer on director.id = writer.id and writer.title = director.title) on person.id = director.id 

Group by person.id, person.first_name, person.last_name 

having count(*) > 1 ;",2018-08-30 23:19:13.909799+10,4,1,235,correct
8634,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-30 23:19:53.585935+10,8,1,193,correct
8635,"SELECT COUNT(*)
FROM writer_award wa,writer w,person p
WHERE wa.production_year<1996
	and wa.production_year>1990
	and wa.id=w.id
	and wa.id =p.id
	and p.first_name='Woody'
	and p.last_name='Allen'
;",2018-08-30 23:19:55.757374+10,9,0,132,partially correct
8636,"select id
from person
where year_born = (select max(year_born)
				from person p
				where year_born  != (select max(year_born) from person));",2018-08-30 23:19:56.132924+10,3,1,153,correct
8637,"select a.title, a.production_year, p.first_name, p.last_name 
FROM
Movie_Award a, Director d, Person p 
WHERE
lower(a.award_name)='bafta film award'
AND 
lower(a.category) ='best film' 
AND
d.title = a.title 
AND 
d.production_year = a.production_year 
AND
p.id = d.id;
",2018-08-30 23:20:10.340097+10,8,0,137,partially correct
8638,"select m.title, m.production_year,p.first_name,p.last_name from person p ,movie_award m, director d 
where d.title=m.title and d.id=p.id and lower(m.award_name)='bafta film award' and lower(
m.category)='best film';",2018-08-30 23:20:13.603646+10,8,0,306,partially correct
8639,;,2018-08-30 23:20:25.609864+10,9,0,193,noninterpretable
8640,SELECT;,2018-08-30 23:20:32.729625+10,9,0,352,noninterpretable
8641,SELECT  count(production_year) from movie WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 Group by production_year;,2018-08-30 23:20:49.803698+10,2,0,213,partially correct
8642,"SELECT COUNT(*)
FROM writer_award wa,writer w,person p
WHERE wa.production_year<1996
	and wa.production_year>1990
	and wa.id=w.id
	and wa.title=w.title
	and wa.production_year=w.production_year
	and wa.id =p.id
	and p.first_name='Woody'
	and p.last_name='Allen'
;",2018-08-30 23:21:00.398366+10,9,1,132,correct
8643,"SELECT  production_year, count(production_year) from movie WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 Group by production_year;",2018-08-30 23:21:13.598683+10,2,1,213,correct
8644,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 23:21:17.736432+10,9,1,193,correct
8645,"SELECT title, production_year, first_name, last_name
FROM(person NATURAL JOIN director NATURAL JOIN movie_award NATURAL JOIN movie)
WHERE award_name = 'BAFTA Film Award';",2018-08-30 23:21:27.430487+10,8,0,426,partially correct
8646,"select a.title, a.production_year, p.first_name, p.last_name 
FROM
Movie_Award a, Director d, Person p 
WHERE
lower(a.award_name)='bafta film award'
AND 
lower(a.category) ='best film' 
AND
d.title = a.title 
AND 
d.production_year = a.production_year 
AND
p.id = d.id
AND
lower (result)='won';
",2018-08-30 23:21:29.065093+10,8,1,137,correct
8647,"select country from restriction as r where lower(r.title)=""shakespeare in love"" AND lower(description)=""m"";",2018-08-30 23:21:37.179453+10,6,1,31,correct
8648,"with
tw as
(select title, production_year from writer_award
where result='won'
 union 
 SELECT title,production_year from movie_award
 where result='won'
 union 
 SELECT title,production_year from crew_award
  where result='won'
 union 
 SELECT title,production_year from director_award
  where result='won'
 union 
 SELECT title,production_year from actor_award 
  where result='won' 
)
 
select count(*)
from movie m, tw t
where m.title not in (select t.title
                     from tw t)
and m.production_year not in 
                     (select t.production_year
					 from tw t);",2018-08-30 23:21:51.615413+10,11,0,359,partially correct
8649,"select r.id
from Role r,Appearance a,scene s
where 
	r.title = r.title
	and a.production_year = s.production_year
	and a.title = s.title
	and a.production_year=s.production_year
	and a.scene_no= s.scene_no
	and a.description=r.description 
	and lower(a.title) ='psycho'
	and a.production_year = 1960
	group by r.id
	having count(*)=1;",2018-08-30 23:21:57.436215+10,10,0,200,partially correct
8650,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 23:22:48.899943+10,9,1,367,correct
8651,"SELECT id, year_born
FROM PERSON,
(SELECT MIN(rest.year_born) AS SecondMinYearBorn
FROM
(SELECT p1.id, p1.year_born
FROM PERSON p1
EXCEPT
SELECT p2.id, p2.year_born
FROM PERSON p2,
(SELECT MIN(p3.year_born) AS MinYearBorn
FROM PERSON p3) min
WHERE p2.year_born = min.MinYearBorn) rest) p
WHERE year_born = p.SecondMinYearBorn;",2018-08-30 23:23:04.025714+10,3,0,285,partially correct
8652,"WITH l AS (
	SELECT id, COUNT(*) AS c
	FROM (
		SELECT id, title, production_year FROM Director
		UNION
		SELECT id, title, production_year FROM Writer)
	GROUP BY id)
SELECT id
FROM l
WHERE c = (SELECT MAX(c) FROM l);",2018-08-30 23:23:09.602072+10,14,1,434,correct
8742,select count(distinct(w.id)) from person p natural join writer w where p.year_born=1935;,2018-08-30 23:56:40.670252+10,1,1,270,correct
8654,"SELECT id, year_born
FROM PERSON,
(SELECT MAX(rest.year_born) AS SecondMinYearBorn
FROM
(SELECT p1.id, p1.year_born
FROM PERSON p1
EXCEPT
SELECT p2.id, p2.year_born
FROM PERSON p2,
(SELECT MAX(p3.year_born) AS MinYearBorn
FROM PERSON p3) min
WHERE p2.year_born = min.MinYearBorn) rest) p
WHERE year_born = p.SecondMinYearBorn;",2018-08-30 23:23:28.243576+10,3,0,285,partially correct
8655,"select id, first_name, last_name
from person
where exists (select *
		from director d, writer w
		where d.id = w.id
		group by d.id
		having count(*) >= 2);",2018-08-30 23:23:38.669187+10,4,0,276,partially correct
8656,"select a.id

from (select a1.id,count(*) as count
      from (select title,id,production_year from writer
            union
	      select title,id,production_year from director) as a1
		 group by a1.id) as a
		 
where a.count=(select max(a2.count)
               from (select a1.id,count(*) as count
			   from (select title,id,production_year from writer
                          union
	                    select title,id,production_year from director) as a1
			         group by a1.id)a2);
              ",2018-08-30 23:24:33.335464+10,14,1,223,correct
8657,"with temp as 
(
select id,count(*) as c
from
(select id, title, production_year from writer UNION select id,title,production_year from director)
group by id
)

select person.id
from person,temp,(select temp.id,max(c) as mc from temp)as temp2
where person.id=temp.id
and temp.c=temp2.mc;",2018-08-30 23:25:07.596779+10,14,1,85,correct
8658,"select m.title, m.production_year,p.first_name,p.last_name from person p ,movie_award m, director d 
where d.title=m.title and d.id=p.id and lower(m.award_name)='bafta film award' and lower(result)='won'and lower(
m.category)='best film';",2018-08-30 23:25:17.279756+10,8,1,306,correct
8659,"SELECT r.id
FROM appearance a,role r,scene s
WHERE a.title=s.title
	and a.production_year=s.production_year
	and a.scene_no=s.scene_no
	and a.description=r.description
	and a.title=r.title
	and a.production_year=r.production_year
	and a.production_year=1960
	and lower(a.title)='psycho'
GROUP by r.id
having count(*)=1;",2018-08-30 23:25:20.740199+10,10,1,132,correct
8660,"SELECT title, production_year, first_name, last_name,award_name
FROM(person NATURAL JOIN director NATURAL JOIN movie_award NATURAL JOIN movie)
WHERE award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won';",2018-08-30 23:25:44.852683+10,8,0,426,partially correct
8661,"SELECT title,production_year from movie_award where lower(award_name)='bafta film award' and lower(category)='best film';",2018-08-30 23:25:52.31739+10,8,0,16,partially correct
8662,"SELECT title, production_year, first_name, last_name
FROM(person NATURAL JOIN director NATURAL JOIN movie_award NATURAL JOIN movie)
WHERE award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won';",2018-08-30 23:25:59.842786+10,8,1,426,correct
8663,"select x.id,x.first_name,x.last_name
from (person natural join writer natural join director)as x
group by x.id
having count(*)>=2;",2018-08-30 23:26:45.861716+10,4,1,293,correct
8664,;,2018-08-30 23:27:51.927833+10,14,0,312,noninterpretable
8665,"select;

",2018-08-30 23:27:55.10993+10,10,0,61,noninterpretable
8666,"



select country

from restriction 

where lower(title)='shakespeare in love' and description ='M';",2018-08-30 23:28:14.172421+10,6,1,235,correct
8667,"



select country

from restriction 

where lower(title)='shakespeare in love' and description ='M';",2018-08-30 23:28:42.341703+10,6,1,235,correct
8668,"

select person.id, person.first_name, person.last_name

from person
inner join writer on person.id=writer.id
inner join director on person.id=director.id
where director.title=writer.title
group by person.id
HAVING count(*)>1;",2018-08-30 23:29:04.077307+10,4,1,221,correct
8669,"select p.id,p.first_name,p.last_name
from Person p
where p.year_born=(select max(year_born) from person);",2018-08-30 23:30:07.972252+10,7,1,300,correct
8670,"WITH x AS (
	SELECT id, COUNT(*) AS c
	FROM Role NATURAL JOIN Person
	GROUP BY id)
SELECT first_name, last_name, title, production_year, description
FROM Role NATURAL JOIN Person
WHERE id = (
	SELECT id
	FROM x
	WHERE c = (SELECT MAX(c) FROM x));",2018-08-30 23:30:10.438564+10,15,1,434,correct
8671,"SELECT count(*)
FROM (writer_award NATURAL JOIN person) AS p
WHERE p.last_name = 'Allen' and p.first_name = 'Woody' AND p.year_of_award>=1991 AND p.year_of_award<= 1995;",2018-08-30 23:30:44.926937+10,9,0,426,partially correct
8672,;,2018-08-30 23:31:13.714584+10,10,0,193,noninterpretable
8673,"WITH x AS (
	SELECT id, COUNT(*) AS c
	FROM Role
	GROUP BY id)
SELECT first_name, last_name, title, production_year, description
FROM Role NATURAL JOIN Person
WHERE id = (
	SELECT id
	FROM x
	WHERE c = (SELECT MAX(c) FROM x));",2018-08-30 23:31:51.053747+10,15,1,434,correct
8674,"select;
",2018-08-30 23:31:51.299251+10,11,0,61,noninterpretable
8675,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 23:31:58.655106+10,10,1,193,correct
8676,"Select count(year_born) from Person
Where year_born >= 1935;",2018-08-30 23:32:15.738259+10,1,0,45,partially correct
8677,"SELECT count(*)
FROM (writer_award NATURAL JOIN person) AS p
WHERE p.last_name = 'Allen' 
AND p.first_name = 'Woody' 
AND p.year_of_award>=1991 
AND p.year_of_award<= 1995
AND result = 'won';",2018-08-30 23:32:32.677713+10,9,1,426,correct
8678,"select w.title, w.production_year
from writer w
where exists (select * from person p where p.id=w.id and lower(p.first_name)='kevin'and lower(p.last_name)='williamson');",2018-08-30 23:33:23.65496+10,5,1,293,correct
8679,"select a.id,a.award_name,a.year_of_award,a.category
from (director natural join director_award) as a
where a.id not in (select id 
				from(director natural join director_award) as a
				where lower(result) =""won"");
",2018-08-30 23:34:09.583523+10,13,1,153,correct
8680,"select r.id
from (scene NATURAL JOIN appearance) s, role r
WHERE s.title='Psycho' and s.production_year=1960 AND s.title=r.title AND s.production_year=r.production_year
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-30 23:34:12.346279+10,10,0,307,partially correct
8681,SELECT count(*) WHERE NOT EXIST (SELECT * from );,2018-08-30 23:34:50.472668+10,11,0,213,noninterpretable
8682,"



select id, first_name, last_name

from person 

where person.year_born in ( select max(year_born) from person);",2018-08-30 23:35:05.42783+10,7,1,235,correct
8683,"SELECT COUNT(p.id)
FROM person p, writer w
WHERE p.id = w.id AND p.year_born = 1935;",2018-08-30 23:35:10.69957+10,1,0,251,partially correct
8684,;,2018-08-30 23:35:30.814611+10,3,0,54,noninterpretable
8685,"select h.id 
from(
select foo.id,count(*) as c 
from (select * from director union select id,title,production_year from writer) as foo 
group by foo.id
) as h
where h.c in(select max(c) from 
(
select foo.id,count(*) as c 
from (select * from director union select id,title,production_year from writer) as foo 
group by foo.id
) as h
);",2018-08-30 23:35:33.370328+10,14,1,172,correct
8743,"select p.id,p.first_name,p.last_name
from(select id from writer w
	where exists (select * from director d where w.id = d.id)) mm,person p
where mm.id = p.id
group by mm.id
having count(mm.id) > 1;",2018-08-30 23:57:20.541352+10,4,1,440,correct
8748,"SELECT COUNT(*), production_year
FROM movie
WHERE production_year IN (1993, 1992, 1991)
GROUP BY (production_year);",2018-08-30 23:58:55.537412+10,2,1,327,correct
8751,"select d.id , d.title , d.production_year, p.first_name, p.last_name, m.title 
from director d natural join person p natural join movie_award m 
where m.award_name='BAFTA Film Award' AND m.category='best film';",2018-08-30 23:59:44.26832+10,8,0,166,partially correct
8962,"select count(*)
from writer w
WHERE exists (select * from person p where w.id = p.id and p.year_born = 1935);",2018-08-31 00:58:28.487209+10,1,0,418,partially correct
8686,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-30 23:35:56.942061+10,11,1,61,correct
8687,;,2018-08-30 23:36:11.1595+10,1,0,287,noninterpretable
8688,"SELECT COUNT(distinct p.id)
FROM person p, writer w
WHERE p.id = w.id AND p.year_born = 1935;",2018-08-30 23:36:27.828299+10,1,1,251,correct
8689,"select distinct id from
(select p1.id from person p1, director d1 where p1.id = d1.id
union
select p2.id from person p2, writer w1 where p2.id = w1.id
union 
select p3.id from person p3, writer w2, director d2 where p3.id = w2.id and p3.id = d2.id) as tmp
where id in 
(select count(*) from
(select id from director d2, movie m1 where d2.title = m1.title and d2.production_year = m1.production_year
union
select id from writer w3, movie m2 where w3.title = m2.title and w3.production_year = m2.production_year group by id));

",2018-08-30 23:36:30.427408+10,14,0,102,partially correct
8690,"SELECT COUNT(year_born)
FROM PERSON
WHERE year_born = '1935';",2018-08-30 23:36:44.98668+10,1,0,446,partially correct
8691,"select;
",2018-08-30 23:36:53.240181+10,3,0,61,noninterpretable
8692,"select ma.title,ma.production_year,p.first_name,p.last_name
from person p, movie_award ma, movie m,director d
where lower(ma.award_name)='bafta film award' and
lower(ma.category)='best film' and
ma.title=m.title and
ma.production_year=m.production_year and
m.title=d.title and
m.production_year=d.production_year and
d.id=p.id;",2018-08-30 23:37:01.986942+10,8,0,300,partially correct
8693,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-30 23:37:48.612935+10,3,1,61,correct
8694,"select id,first_name,last_name
from person
where year_born=(select max(year_born)from person);",2018-08-30 23:38:23.407155+10,7,1,293,correct
8695,"
;",2018-08-30 23:38:30.284752+10,8,0,435,noninterpretable
8696,"select r.id
from Role r,Appearance a,scene s
where 
	r.title = r.title
	and a.production_year = s.production_year
	and a.title = s.title
	and a.production_year=s.production_year
	and a.scene_no= s.scene_no
	and a.description=r.description 
	and lower(a.title) ='psycho'
	and a.production_year = 1960
	group by r.id
	having count(*)=1;",2018-08-30 23:38:39.467019+10,10,0,200,partially correct
8697,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND r.title = a.title
    AND r.production_year = a.production_year
    AND r.description  =a.description 

    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-30 23:39:55.651596+10,10,1,364,correct
8698,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 23:39:59.539358+10,9,1,306,correct
8699,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 23:40:15.357044+10,14,1,102,correct
8700,;,2018-08-30 23:40:19.194054+10,13,0,61,noninterpretable
8701,"SELECT title,production_year,id from movie_award where lower(award_name)='bafta film award' and lower(category)='best film' 
	WHERE id in
		SELECT id,first_name,last_name FROM PERSON;",2018-08-30 23:40:28.04709+10,8,0,16,noninterpretable
8702,"select id from role 
natural join appearance 
group by id, title, production_year
having count(id) = 1
and lower(title) = 'psycho'
and production_year = 1960;

",2018-08-30 23:40:46.648651+10,10,1,93,correct
8703,"SELECT p1.id
FROM (SELECT q.id, COUNT(*) AS number
	FROM (SELECT d.id, d.title, d.production_year
		FROM DIRECTOR d
		UNION
		SELECT w.id, w.title, w.production_year
		FROM WRITER w) AS q
	GROUP BY q.id) AS p1
WHERE p1.number = (SELECT MAX(p2.number)
				FROM (SELECT p1.id, COUNT(*) AS number
					FROM (SELECT d.id, d.title, d.production_year
						FROM DIRECTOR d
						UNION
						SELECT w.id, w.title, w.production_year
						FROM WRITER w) AS q
					GROUP BY q.id) AS p2);",2018-08-30 23:41:56.061703+10,14,1,177,correct
8704,"select r.id
from Role r,Appearance a,scene s
where 
	r.title = r.title
	and a.title = s.title
	and a.production_year = s.production_year
	and a.production_year=s.production_year
	
	and a.scene_no= s.scene_no
	and a.description=r.description 
	and lower(a.title) ='psycho'
	and a.production_year = 1960
	group by r.id
	
	having count(*)=1;",2018-08-30 23:42:04.119126+10,10,0,200,partially correct
8705,"SELECT id
FROM person
WHERE person.year_born =
  (SELECT MAX(year_born)
  FROM person
  WHERE person.year_born < (
	  SELECT MAX(year_born)
	  FROM person
	  )
	);",2018-08-30 23:42:09.766063+10,3,1,285,correct
8706,"select production_year,count(production_year) from movie where production_year>1990 and production_year<1994 group by production_year;",2018-08-30 23:42:24.558933+10,2,1,101,correct
8707,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-30 23:44:31.711465+10,13,1,61,correct
8708,"SELECT a.id,b.award_name,b.year_of_award,b.category
FROM director a,director_award b
WHERE a.title=b.title AND b.result!='won';
",2018-08-30 23:44:58.960827+10,13,1,372,correct
8709,;,2018-08-30 23:45:25.606751+10,14,0,61,noninterpretable
8710,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-30 23:45:46.511366+10,1,1,446,correct
8711,"SELECT id
FROM (role NATURAL JOIN appearance) AS A
WHERE title = 'Psycho' AND production_year = 1960
GROUP BY id
HAVING count(*) = 1;",2018-08-30 23:45:49.030969+10,10,1,426,correct
8712,select count(*) from person as p where not exists (select * from director as d where p.id=d.id );,2018-08-30 23:47:09.874559+10,12,1,101,correct
8744,"select count (*)
from (select p.id
      from person p, writer w
	  where p.id=w.id
	  and p.year_born=1935);",2018-08-30 23:57:30.09419+10,1,0,237,partially correct
8749,"select count (*)
from (select p.id
      from person p, writer w
	  where p.id=w.id
	  and p.year_born=1935);",2018-08-30 23:59:19.554548+10,1,0,237,partially correct
8752,"select d.id,da.award_name,da.year_of_award,da.category from(director d join director_award da on d.title=da.title and d.production_year=da.production_year) where result='nominated'group by result having count(*)=1 or count(*)>1;",2018-08-30 23:59:54.259042+10,13,1,317,correct
8958,"select
	p.first_name, 
	p.last_name,
	r.title,
	r.production_year,
	r.description
from
	role r,
	person p
where p.id=r.id and p.id=(
	select id from role 
	where (
		select max(count(id))
		from role))
;
",2018-08-31 00:57:37.659788+10,15,0,48,noninterpretable
8713,"SELECT count(*) FROM movie m WHERE EXISTS (SELECT title, production_year 
from movie_award ma
where lower(ma.result) != 'won' and ma.title != m.title and ma.production_year != m.production_year
UNION 
SELECT title, production_year
FROM crew_award ca
WHERE lower(ca.result) != 'won' and ca.title != m.title and ca.production_year != m.production_year
union 
select title, production_year
from director_award da
where lower(da.result) != 'won' and da.title != m.title and da.production_year != m.production_year
union
select title, production_year
from actor_award aa
where lower(aa.result) != 'won' and aa.title != m.title and aa.production_year != m.production_year
union
select title, production_year 
from writer_award wa
where lower(wa.result) != 'won' and wa.title != m.title and wa.production_year = m.production_year

);",2018-08-30 23:48:02.479945+10,11,0,213,partially correct
8714,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-30 23:48:06.957368+10,14,1,61,correct
8715,"SELECT *
FROM director d, director_award da
WHERE
	lower(d.title) = lower(da.title)
	AND lower(d.production_year) = lower(da.production_year)
	AND lower(da.result) = 'nominated';",2018-08-30 23:49:05.912765+10,13,0,285,partially correct
8716,"SELECT COUNT(*)
FROM WRITER e NATURAL JOIN PERSON
WHERE year_born=1935
GROUP BY e.id;",2018-08-30 23:50:14.587255+10,1,0,302,partially correct
8717,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);
",2018-08-30 23:50:17.185235+10,11,1,204,correct
8718,"SELECT count(*) FROM movie m WHERE NOT EXISTS (SELECT title, production_year 
from movie_award ma
where lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION 
SELECT title, production_year
FROM crew_award ca
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
union 
select title, production_year
from director_award da
where lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
union
select title, production_year
from actor_award aa
where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
union
select title, production_year 
from writer_award wa
where lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year

);",2018-08-30 23:50:23.166029+10,11,1,213,correct
8719,"SELECT COUNT(*)
FROM WRITER e NATURAL JOIN PERSON
WHERE year_born=1935
GROUP BY e.id;",2018-08-30 23:50:35.0044+10,1,0,302,partially correct
8720,"SELECT title,production_year,first_name,last_name from (movie_award natural join Director natural join person)
	where lower(award_name)='bafta film award' and lower(category)='best film';",2018-08-30 23:51:05.10186+10,8,0,16,partially correct
8721,"select id
from (select id,max(total)
	from (select id,count(*) as total
		from director d natural join writer w
		group by d.id));",2018-08-30 23:51:42.736606+10,14,0,153,partially correct
8722,"SELECT 
d.id, da.award_name, da.year_of_award, da.category, da.result
FROM
director_award da NATURAL JOIN director d
WHERE da.result='nominated';
",2018-08-30 23:51:55.873794+10,13,0,403,partially correct
8723,"SELECT 
d.id, da.award_name, da.year_of_award, da.category
FROM
director_award da NATURAL JOIN director d
WHERE da.result='nominated';
",2018-08-30 23:52:18.703707+10,13,1,403,correct
8724,select;,2018-08-30 23:52:22.062511+10,15,0,61,noninterpretable
8725,"select count(*) from MOVIE
where production_year in (1991,1992,1993);",2018-08-30 23:52:49.813335+10,2,0,430,partially correct
8726,"SELECT id
FROM person 
WHERE year_born = (SELECT max(year_born)
			FROM person
			WHERE year_born < (SELECT max(year_born)
			FROM person));",2018-08-30 23:53:02.02947+10,3,1,54,correct
8727,;,2018-08-30 23:53:47.181338+10,3,0,213,noninterpretable
8728,"
SELECT a.id,b.award_name,b.year_of_award,b.category
FROM director a,director_award b
WHERE a.title=b.title AND b.result!='won';",2018-08-30 23:54:02.042396+10,14,0,372,partially correct
8729,"select title, production_year
from director d
where (select * from person p
where p.id=d.id and p.first_name=""Kevin"" and p.last_name=""Williamson"");",2018-08-30 23:54:24.218441+10,5,0,152,noninterpretable
8730,"select title, production_year, count(*)
from movie m, director d
where m.title = d.title and m.production_year = d.production_year;
",2018-08-30 23:54:39.297557+10,12,0,275,noninterpretable
8731,select count(*) from person p natural join writer w where p.year_born=1935;,2018-08-30 23:54:52.433584+10,1,0,270,partially correct
8732,"SELECT title,production_year,first_name,last_name from (movie_award natural join Director natural join person)
	where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';",2018-08-30 23:55:26.473107+10,8,1,16,correct
8733,"select production_year, count(*) from MOVIE
where production_year in (1991,1992,1993)
group by production_year;",2018-08-30 23:55:32.209147+10,2,1,430,correct
8734,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-30 23:55:35.791028+10,9,1,352,correct
8735,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-30 23:55:44.081424+10,15,1,61,correct
8736,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d, director_award da
WHERE
	lower(d.title) = lower(da.title)
	AND d.production_year = da.production_year
	AND lower(da.result) = 'nominated'
EXCEPT
SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director d, director_award da
WHERE
	lower(d.title) = lower(da.title)
	AND d.production_year = da.production_year
	AND lower(da.result) = 'won';",2018-08-30 23:55:44.458752+10,13,1,285,correct
8737,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description;",2018-08-30 23:55:55.930092+10,15,0,177,noninterpretable
8738,"SELECT p.id from person p where p.year_born = (SELECT max(year_born) from person where year_born < (select max(year_born) 
from person));
",2018-08-30 23:55:56.662157+10,3,1,213,correct
8739,"select title, production_year
from writer 
inner join person on writer.id = person.id
where person.first_nmae = 'Kevin' and person.last_name = 'Williamson';
",2018-08-30 23:56:01.297325+10,5,0,225,noninterpretable
8740,";
",2018-08-30 23:56:21.614555+10,13,0,213,noninterpretable
8741,"select title, production_year
from writer w, person p
where p.id=w.id and p.first_name=""Kevin"" and p.last_name=""Williamson"";",2018-08-30 23:56:23.700768+10,5,1,152,correct
8753,"select count(*) from movie m where not exists(
select title, production_year from movie_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
union
select title, production_year from crew_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
union
select title, production_year from director_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
union
select title, production_year from writer_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
union
select title, production_year from actor_award ma where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
);
",2018-08-31 00:00:03.489249+10,11,1,194,correct
8754,"with
tw as
(select title, production_year from writer_award
where lower(result)='won'
 union 
 SELECT title,production_year from movie_award
 where lower(result)='won'
 union 
 SELECT title,production_year from crew_award
  where lower(result)='won'
 union 
 SELECT title,production_year from director_award
  where lower(result)='won'
 union 
 SELECT title,production_year from actor_award 
  where lower(result)='won'
)
 
select count(*)
from movie m left join tw t
on m.title=t.title and m.production_year=t.production_year
where t.title is null
;",2018-08-31 00:00:04.998763+10,11,1,359,correct
8755,"SELECT  production_year, COUNT(*)
FROM movie
WHERE production_year IN (1991, 1992, 1993)
GROUP BY (production_year);",2018-08-31 00:00:23.848408+10,2,1,327,correct
8756,"select count (distinct p.id)
from person p inner join writer w on p.id=w.id
where p.year_born=1935;",2018-08-31 00:00:56.074189+10,1,1,237,correct
8757,"select count(*) from PERSON, DIRECTOR
where PERSON.id != DIRECTOR.id;",2018-08-31 00:01:04.301535+10,12,0,430,partially correct
8758,"select r.id from role r ,scene s, appearance a where s.title=a.title and s.production_year=a.production_year and s.scene_no=a.scene_no and s.description=a.description 
and r.title=a.title group by r.id having count(*) =1;",2018-08-31 00:01:52.854606+10,10,0,306,partially correct
8759,"SELECT COUNT(year_born)
FROM person
WHERE(SELECT id
FROM writer 
WHERE person.id=writer.id AND person.year_born='1935');
",2018-08-31 00:01:58.080393+10,1,1,372,correct
8760,"select p2.id
from person p2
where p2.year_born =
	(
	select Max(p.year_born)
	from person p
	where not exists(
			select *
			from person p1
			where p1.id = p.id and p1.year_born = (select Max(year_born)
										from person)
			)
			);
",2018-08-31 00:02:17.353252+10,3,1,136,correct
8761,"select p.id,p.first_name,p.last_name
from(select id from director d
	where exists (select * from writer w where w.id = d.id)) mm,person p
where mm.id = p.id
group by mm.id
having count(mm.id) > 1;",2018-08-31 00:02:20.639872+10,4,0,440,partially correct
8762,"select movie.title, movie.production_year
from movie
inner join writer on movie.title=writer.title
inner join person on person.id=writer.id
where person.first_name='Kevin' and person.last_name='Willianmson';",2018-08-31 00:02:23.143819+10,5,0,221,partially correct
8763,"select count (*)
from person p
where exists (select *
              from writer w 
			  where p.id = w.id)
and p.year_born = 1935;",2018-08-31 00:02:24.009679+10,1,1,237,correct
8764,"


select Movie_Award.title, Movie_Award.production_year, person.first_name, person.last_name
from Movie_Award join Director on Movie_Award.title = Director.title join Person on Person.id = Director.id
where lower(movie_award.award_name)='bafta film award' and lower(movie_award.category)='best film';",2018-08-31 00:02:38.46433+10,8,0,235,partially correct
8765,"select country
from Restriction
where title = 'Shakespeare in Love and description = 'M';
",2018-08-31 00:02:54.801733+10,6,0,225,noninterpretable
8766,"select count(*) from PERSON
where not exists (select * from DIRECTOR where PERSON.id = DIRECTOR.id);",2018-08-31 00:03:27.548988+10,12,1,430,correct
8767,"select id
from (select id,count(*) as total
	from(select id,title,production_year from director 
		UNION select id,title,production_year from writer)
		group by id)
where total =(select max(total)
			from(select id,count(*) as total
				from(select id,title,production_year from director 
					UNION select id,title,production_year from writer)
				group by id));",2018-08-31 00:03:30.629504+10,14,1,153,correct
8768,vfdg;,2018-08-31 00:04:46.96185+10,1,0,267,noninterpretable
8769,"select d.id, da.award_name, da.year_of_award,da.category from
director_award da, director d
where da.title = d.title
and da.production_year = d.production_year
and lower(da.result) = 'nominated'
and d.id not in (
select id from
director_award da,
director d

where da.title = d.title 
and da.production_year = d.production_year
and lower(da.result) = 'won'
);",2018-08-31 00:05:06.373264+10,13,1,213,correct
8770,"With NewTable AS 
(SELECT t1.id, count(*) AS noOfMovie 
FROM (SELECT w.id, w.title, w.production_year
FROM Writer w
UNION
SELECT d.id, d.title,d.production_year FROM
Director d, Movie m1
) AS t1
 Group By t1.id)
 SELECT n.id
 FROM NewTable n
 WHERE n.noOfMovie = (SELECT
 MAX(n2.noOfMovie) FROM
 NewTable n2);

",2018-08-31 00:05:26.03473+10,14,1,218,correct
8771,"select movie.title, movie.production_year
from movie
inner join writer on movie.title=writer.title
inner join person on person.id=writer.id
where person.first_name='Kevin' and person.last_name='Williamson';",2018-08-31 00:05:37.475282+10,5,1,221,correct
8772,";
",2018-08-31 00:05:41.15213+10,14,0,213,noninterpretable
8773,"select id, first_name, last_name
from person 
order by year_born DESC
limit 1;",2018-08-31 00:06:21.258927+10,7,1,225,correct
8774,"SELECT id, first_name, last_name FROM person p GROUP BY id HAVING p.year_born=MIN(year_born);",2018-08-31 00:07:24.904612+10,7,0,427,partially correct
8775,"select id, first_name, last_name
from person p
where exists (select count(*) from director d where p.id = d.id group by title, production_year having count(*)>2 );",2018-08-31 00:07:42.667329+10,4,0,275,partially correct
8776,"SELECT count(person.id)
From person
WHERE person.year_born = 1935;",2018-08-31 00:07:47.925753+10,1,0,59,partially correct
8777,"select movie.title, movie.production_year
from movie
inner join writer on movie.title=writer.title
where writer.id=(select person.id from person where person.first_name='Kevin' and person.last_name='Williamson');",2018-08-31 00:07:57.183059+10,5,1,221,correct
8778,"SELECT d.id,da.award_name, da.year_of_award,da.category
FROM director d, award a, (SELECT title, production_year, award_name, year_of_award, category
					FROM Director_Award t
					WHERE lower(t.result) = 'nominated ' AND );",2018-08-31 00:08:36.055424+10,13,0,54,noninterpretable
8779,"select m.production_year, count(*) from movie m group by m.production_year having m.production_year>=1991 and m.production_year<=1993;",2018-08-31 00:08:52.376073+10,2,1,270,correct
8780,"SELECT id, first_name, last_name FROM person p WHERE p.year_born = (SELECT MAX(year_born) FROM person);",2018-08-31 00:08:53.784074+10,7,1,427,correct
8781,"select first_name, last_name from person
where exists (select * from writer, director where director.id = writer.id);",2018-08-31 00:09:12.460626+10,4,0,430,partially correct
8782,"SELECT r.id, p.first_name, p.last_name, r.title, r.production_year, r.description 
FROM role r NATURAL JOIN person p
WHERE r.id IN (SELECT count(id) FROM role GROUP BY id ORDER BY id DESC);",2018-08-31 00:09:36.409788+10,15,0,403,partially correct
8817,"select max(count(id)) from
(
select id, title, production_year from director union 
select id, title, production_year from writer union 
select id, title, production_year from crew
) as q1
group by id, title, production_year;",2018-08-31 00:19:06.545508+10,14,0,194,noninterpretable
9028,"select count(*)
from person inner join writer_award on person.id = writer_award.id;",2018-08-31 01:16:50.135521+10,9,0,225,partially correct
8783,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 00:10:05.207987+10,13,1,54,correct
8784,"select dw.id, dw.first_name, dw.last_name
from (person natural join director natural join writer) as dw
group by dw.id
having count(*) >= 2;",2018-08-31 00:10:08.334381+10,4,1,276,correct
8785,"select p.id, p.last_name, p.first_name, r.title, r.production_year, r.description
from person p, role r
where p.id = r.id
group by r.title
having max(r.title);",2018-08-31 00:10:08.706504+10,15,0,102,partially correct
8786,"select id from person where year_born =
(select max(year_born) from person where year_born < 
(select max(year_born) from person) limit 1); ",2018-08-31 00:10:17.835508+10,3,1,194,correct
8787,"SELECT count(*)
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id = person.id AND person.year_born = 1935);",2018-08-31 00:11:22.60964+10,1,1,59,correct
8788,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 00:11:24.463312+10,4,1,430,correct
8789,select count(*) from person p where not exists (select * from director d where d.id=p.id);,2018-08-31 00:11:51.555807+10,12,1,270,correct
8790,"select w.title,w.production_year from writer as w inner join person as p on p.id=w.id where lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-31 00:12:19.73306+10,5,1,101,correct
8791,;,2018-08-31 00:12:26.331857+10,14,0,54,noninterpretable
8792,"SELECT count(*) 
FROM movie m 
WHERE title NOT IN (
	SELECT title
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 00:12:57.411794+10,11,1,93,correct
8793,"select title, production_year from movie
where (select title);",2018-08-31 00:13:40.513235+10,5,0,430,partially correct
8794,"select production_year,count (*)
from movie
where production_year in (1991, 1992, 1993)
group by production_year;",2018-08-31 00:14:03.261613+10,2,1,237,correct
8795,"select id
from person
where year_born< (
 select max(year_born)
 from person)
order by year_born desc
limit 1;",2018-08-31 00:14:30.202742+10,3,1,359,correct
8796,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 00:14:41.398483+10,9,1,137,correct
8797,"SELECT w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 00:14:45.838373+10,5,1,430,correct
8798,"SELECT m.title, m.production_year, dp.first_name, dp.last_name 
FROM movie_award m, (director NATURAL JOIN person) AS dp
WHERE 
    lower(m.award_name)='bafta film award' 
	AND lower(m.category)='best film'
	AND m.title=dp.title
	AND m.production_year=dp.production_year;",2018-08-31 00:14:57.895485+10,8,0,427,partially correct
8799,"select production_year, count(*)
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-31 00:14:58.496031+10,2,1,286,correct
8800,fhgh;,2018-08-31 00:15:13.016171+10,2,0,267,noninterpretable
8801,"select id, first_name, last_name
from person
where max(year_born);",2018-08-31 00:15:32.207705+10,7,0,152,noninterpretable
8802,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-31 00:16:00.857431+10,2,1,59,correct
8803,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 00:16:02.820169+10,14,1,54,correct
8804,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
and a.title=r.title
and a.production_year=r.production_year
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 00:16:33.79982+10,10,1,306,correct
8805,"select id, first_name, last_name
from person
where year_born = (select max(year_born)
from person);",2018-08-31 00:16:33.943972+10,7,1,152,correct
8806,"select tile, production_year
from (director natural join person) as dp
where dp.first_name = Kevin and dp.last_name = Williamson;",2018-08-31 00:16:43.77197+10,5,0,276,noninterpretable
8807,"SELECT m.title, m.production_year, dp.first_name, dp.last_name 
FROM movie_award m, (director NATURAL JOIN person) AS dp
WHERE 
    lower(m.award_name)='bafta film award' 
	AND lower(m.category)='best film'
	AND lower(m.result)='won'
	AND m.title=dp.title
	AND m.production_year=dp.production_year;",2018-08-31 00:16:48.067431+10,8,1,427,correct
8808,;,2018-08-31 00:17:00.801256+10,15,0,54,noninterpretable
8809,"select count (*)
from person p
where not exists 
(select * 
from director d
where p.id=d.id);",2018-08-31 00:17:36.935825+10,12,1,237,correct
8810,"SELECT id,award_name,year_of_award,category
FROM director NATURAL JOIN director_award
GROUP BY id,title,production_year
HAVING director.title=director_award.title
      AND director.production_year=director_award.production_year
	AND COUNT(id)>1
	AND lower(result)!='won';",2018-08-31 00:18:02.39533+10,13,0,369,partially correct
8811,SELECT count(*) from writer where exists (SELECT * from person where writer.id = person.id and person.year_born = '1935');,2018-08-31 00:18:03.255661+10,1,0,213,partially correct
8812,select;,2018-08-31 00:18:29.386067+10,8,0,233,noninterpretable
8813,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r
where p.id = r.id and r.id =(select id
					from(select id,max(total)
						from(select id,count(*) as total
							from role
						group by id)));",2018-08-31 00:18:37.672807+10,15,1,153,correct
8814,"SELECT count(*)
FROM writer NATURAL JOIN person
WHERE person.year_born='1935';
",2018-08-31 00:18:47.222127+10,1,0,403,partially correct
8815,SELECT count(*) from person where exists (SELECT * from writer where writer.id = person.id and person.year_born = '1935');,2018-08-31 00:18:52.705607+10,1,1,213,correct
8816,"select count(distinct movie.title) 
from movie 
where movie.title not in 
(select movie_award.title 
from movie_award,crew_award,director_award,writer_award
where (movie.title=movie_award.title
	and movie.production_year= movie_award.production_year)
	or (movie_award.title=crew_award.title
	and movie_award.production_year= crew_award.production_year)
	or (movie_award.title=director_award.title
	and movie_award.production_year= director_award.production_year)
	or(movie_award.title=writer_award.title
	and movie_award.production_year= writer_award.production_year));",2018-08-31 00:18:58.918243+10,11,0,200,partially correct
8820,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 00:19:17.935639+10,15,1,54,correct
8821,"SELECT COUNT(*)
FROM person p 
WHERE EXISTS (SELECT* 
		FROM writer w
		WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 00:19:32.875729+10,1,1,287,correct
8822,"select country from Restriction
where lower(title) = 'shakespeare in love'  and description = 'M';",2018-08-31 00:19:50.727657+10,6,1,430,correct
8823,"
SELECT count(id) from writer_award where id in
	
		(SELECT id from PERSON WHERE 
		lower(first_name)='woody' and lower(last_name)='allen'and 
		PERSON.id)
;",2018-08-31 00:19:53.737041+10,9,0,16,partially correct
8824,"select d.id, a.award_name, a.year_of_award, a.category
from director_award a, director d
where lower(a.result)='nominated'
and a.title=d.title and a.production_year=d.production_year;",2018-08-31 00:20:21.097457+10,13,1,359,correct
8825,;,2018-08-31 00:20:29.911962+10,7,0,430,noninterpretable
8826,"


select person.id, count(writer_award.award_name) 

from person join writer on person.id = writer.id join writer_award on writer.title = writer_award.title and writer.production_year = writer_award.production_year

where lower(writer.result) = 'won' and lower(writer.year_of_award) = between '1991' and '1995' 
      and lower(person.first_name) = 'woody' and lower(person.last_name) = 'allen';",2018-08-31 00:20:33.697429+10,9,0,235,noninterpretable
8827,select r.country from restriction as r where r.title='Shakespeare in Love' and lower(r.description)='m';,2018-08-31 00:20:37.807343+10,6,1,101,correct
8828,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma, director as d, person as p
where ma.award_name = 'BAFTA Film Award' and ma.category = 'Best Film' ;",2018-08-31 00:20:56.287844+10,8,0,225,partially correct
8829,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma, director as d, person as p
where ma.award_name = 'BAFTA Film Award' and ma.category = 'Best Film' ;",2018-08-31 00:20:58.421029+10,8,0,225,partially correct
8830,"SELECT count(*)
FROM writer_award w
WHERE w.id = (SELECT p.id FROM person p WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen') AND lower(w.result) = 'won';",2018-08-31 00:21:01.560087+10,9,1,373,correct
8831,"select count(*)
from person p
where not exists (select d.id from director d where d.id = p.id);
",2018-08-31 00:21:32.606342+10,12,1,286,correct
8832,"
SELECT count(id) from writer_award where  year_of_award>=1992 and year_of_award<=1995 and id in
	
		(SELECT id from PERSON WHERE 
		lower(first_name)='woody' and lower(last_name)='allen'and 
		PERSON.id)
;",2018-08-31 00:21:35.929836+10,9,1,16,correct
8833,"SELECT person.year_born,count(person.id) From person join writer on person.id = writer.id
where person.year_born = '1935';",2018-08-31 00:21:37.115462+10,1,0,447,partially correct
8834,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 00:22:05.406153+10,5,1,276,correct
8835,"
select r.title, r.production_year,r.description
from role r
where exists(
              select r.id,r.title,count(*) as number
              from role r
              group by r.id );",2018-08-31 00:22:24.955855+10,15,0,298,partially correct
8836,"select p.id, p.first_name, p.last_name
from person p,
(select d.id, count(*)
from director d, writer w 
where d.id=w.id and d.title=w.title 
and d.production_year=w.production_year 
group by d.id having count(*)>=2) u
where p.id=u.id;",2018-08-31 00:22:30.661602+10,4,1,270,correct
8837,SELECT * from person where exists (SELECT * from writer where writer.id = person.id and person.year_born = '1935');,2018-08-31 00:22:48.577785+10,1,0,213,partially correct
8838,"SELECT production_year,count(*)
FROM MOVIE
WHERE production_year = 1993 OR
production_year = 1992 OR
production_year = 1991;
",2018-08-31 00:23:08.849733+10,2,0,287,partially correct
8839,SELECT count(*) from person where exists (SELECT * from writer where writer.id = person.id and person.year_born = '1935');,2018-08-31 00:23:13.589435+10,1,1,213,correct
8840,"SELECT COUNT(*)
FROM (writer_award NATURAL JOIN person) AS wap
WHERE 
	lower(wap.result)='won'
	AND lower(wap.first_name)='woody'
	AND lower(wap.last_name)='allen'
	AND wap.year_of_award >= 1991
	AND wap.year_of_award <= 1995;",2018-08-31 00:23:22.262126+10,9,1,427,correct
8841,gthrth;,2018-08-31 00:23:28.215939+10,12,0,267,noninterpretable
8842,"select d.title, d.production_year, p.first_name, p.last_name from  person as p, director as d, movie_award as ma
where lower(ma.award_name)=""bafata film award""
AND lower(ma.category)=""best film""
AND lower(ma.result)=""won""
AND ma.title = d.title
AND ma.production_year=d.production_year
AND d.id=p.id;",2018-08-31 00:23:37.068848+10,8,0,31,partially correct
8843,"select id, first_name, last_name from person
where year_born = (select max(year_born) from person);",2018-08-31 00:23:39.581069+10,7,1,430,correct
8844,"select d.title, d.production_year, p.first_name, p.last_name from  person as p, director as d, movie_award as ma
where lower(ma.award_name)=""bafta film award""
AND lower(ma.category)=""best film""
AND lower(ma.result)=""won""
AND ma.title = d.title
AND ma.production_year=d.production_year
AND d.id=p.id;",2018-08-31 00:24:04.55824+10,8,1,31,correct
8845,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);",2018-08-31 00:24:15.759702+10,12,1,59,correct
8846,;,2018-08-31 00:25:13.656878+10,8,0,430,noninterpretable
8847,"SELECT person.year_born,count(distinct(person.id)) From person join writer on person.id = writer.id
where person.year_born = '1935';",2018-08-31 00:26:04.987215+10,1,0,447,partially correct
8848,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 00:26:16.127887+10,8,1,233,correct
8849,"SELECT production_year,count(*)
FROM MOVIE
WHERE production_year >=1991 AND
production_year <=1993 
GROUP By production_year;

",2018-08-31 00:26:20.071321+10,2,1,287,correct
8850,"select p.id,p.first_name,p.last_name from (select max(year_born) as yb from person)as f,person as p where p.year_born=f.yb;",2018-08-31 00:26:24.025297+10,7,1,101,correct
8851,"SELECT person.year_born,count(distinct(person.id)) From person join writer on person.id = writer.id
where person.year_born = '1935';",2018-08-31 00:26:33.296261+10,1,0,447,partially correct
8852,"SELECT count(distinct(person.id)) From person join writer on person.id = writer.id
where person.year_born = '1935';",2018-08-31 00:26:48.191904+10,1,1,447,correct
8853,"select title, production_year
from movie_award 
where category='Best Film' and award_name='BAFTA Film Award'
;",2018-08-31 00:27:17.0612+10,8,0,152,partially correct
8854,"SELECT production_year, count(production_year) from movie where production_year = 1993 or 1992 or 1991 group by production_year;",2018-08-31 00:27:35.564244+10,2,0,213,partially correct
8954,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person as p,
     role as r,
     (select id,count(*)as rcount from role group by id) as rc
where rc.rcount=(select max(rc1.rcount) from (select id,count(*)as rcount from role group by id)as rc1)
 and r.id=p.id
 and p.id=rc.id;",2018-08-31 00:55:40.811468+10,15,1,223,correct
8855,"SELECT id,award_name,year_of_award,category
FROM director,director_award
WHERE director.title=director_award.title
      AND director.production_year=director_award.production_year
	AND lower(director_award.result)='nominated'
	AND director.id NOT IN (
	       SELECT id
		 FROM director_award,director
		 WHERE director.title=director_award.title
                  AND director.production_year=director_award.production_year
		       AND lower(director_award.result)='won');",2018-08-31 00:27:41.260896+10,13,1,369,correct
8856,htfth;,2018-08-31 00:28:01.583988+10,4,0,267,noninterpretable
8857,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 00:28:01.928423+10,14,1,390,correct
8858,"SELECT production_year, count(production_year) from movie where production_year = 1993 or production_year = 
1992 or production_year = 1991 group by production_year;",2018-08-31 00:28:17.975145+10,2,1,213,correct
8859,"select Writer.title, Writer.production_year from Writer where Writer.id in(
select Person.id from Person where first_name = 'Kevin' and last_name = 'Williamson');",2018-08-31 00:28:37.280619+10,5,1,367,correct
8860,"select n.title, n.production_year from (person p natural join writer w natural join movie) n where lower(n.first_name)='kevin' and lower(n.last_name)='williamson';
",2018-08-31 00:29:35.01718+10,5,1,270,correct
8861,"select production_year, count(*)
from MOVIE 
where production_year=1993
group by production_year
union
select production_year, count(*)
from MOVIE 
where production_year=1994
group by production_year
union
select production_year, count(*)
from MOVIE 
where production_year=1995
group by production_year
;",2018-08-31 00:30:02.14564+10,2,0,302,partially correct
8862,"select production_year, count(*)
from MOVIE 
where production_year=1991
group by production_year
union
select production_year, count(*)
from MOVIE 
where production_year=1992
group by production_year
union
select production_year, count(*)
from MOVIE 
where production_year=1993
group by production_year
;",2018-08-31 00:30:46.944362+10,2,1,302,correct
8863,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON
FROM (SELECT d.id, title, production_year
FROM director d
UNION
SELECT w.id, title, production_year
FROM writer w) x1
GROUP BY x1.id) x
WHERE x.NoOfWorkedON=
(SELECT MAX(x2.NoOfWorkedON)
FROM (SELECT x1.id, count(*) AS NoOfWorkedON
FROM (SELECT d.id, title, production_year
FROM director d
UNION
SELECT w.id, title, production_year
FROM writer w) x1
GROUP BY x1.id) x2);",2018-08-31 00:31:07.924256+10,14,1,285,correct
8864,"select count(writer.id) from writer , person
where writer.id = person.id and person.year_born = 1935;",2018-08-31 00:31:44.633571+10,1,0,73,partially correct
8865,SELECT count(*) FROM person WHERE NOT EXISTS(SELECT * from director WHERE person.id = director.id) ;,2018-08-31 00:31:44.965588+10,12,1,213,correct
8866,"SELECT count(*)
FROM person as p
WHERE EXISTS(SELECT*
FROM Director AS d
WHERE d.id != p.id);",2018-08-31 00:31:48.69743+10,12,0,287,partially correct
8867,"SELECT count(*)
FROM person as p
WHERE NOT EXISTS(SELECT*
FROM Director AS d
WHERE d.id = p.id);",2018-08-31 00:32:30.27475+10,12,1,287,correct
8868,"select country
from restriction as r1
where r1.title='Shakespeare in Love' and r1.description='M'
;",2018-08-31 00:32:54.168362+10,6,1,221,correct
8869,"SELECT PERSON.id,first_name,last_name
From PERSON, DIRECTOR,WRITER
WHERE PERSON.id= DIRECTOR.id AND DIRECTOR.id= WRITER.id;",2018-08-31 00:33:25.388827+10,4,0,428,partially correct
8870,"SELECT PERSON.id,first_name,last_name
From PERSON, DIRECTOR,WRITER
WHERE PERSON.id= DIRECTOR.id AND DIRECTOR.id= WRITER.id;",2018-08-31 00:33:25.435829+10,4,0,428,partially correct
8871,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 00:33:31.62092+10,1,1,73,correct
8872,"select country
from restriction
where title = 'Shakespeare in Love'
and description = 'M';",2018-08-31 00:33:47.527133+10,6,1,276,correct
8873,;,2018-08-31 00:34:05.566349+10,15,0,390,noninterpretable
8874,"select production_year,count(production_year) from movie where production_year in
(1991,1992,1993);",2018-08-31 00:34:12.10671+10,2,0,73,partially correct
8875,"select count(*) as numofm from award where not exists(select title from movie_award ma where lower(ma.result)='won'
union select title from crew_award ca where lower(ca.result)='won'
union select title from director_award da where lower(da.result)='won'
union select title from writer_award wa where lower(wa.result)='won'
union select title from actor_award aa where lower(aa.result)='won')





;",2018-08-31 00:34:23.43354+10,11,0,306,partially correct
8876,"select w.title, w.production_year
from writer w, person p
where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Wlliamson';",2018-08-31 00:34:36.061548+10,5,0,286,partially correct
8877,"SELECT PERSON.id,first_name,last_name
From PERSON, DIRECTOR,WRITER
WHERE PERSON.id= DIRECTOR.id AND DIRECTOR.id= WRITER.id
GROUP BY PERSON.id
HAVING COUNT(*)>1;",2018-08-31 00:34:55.891769+10,4,0,428,partially correct
8878,"SELECT PERSON.id,first_name,last_name
From PERSON, DIRECTOR,WRITER
WHERE PERSON.id= DIRECTOR.id AND DIRECTOR.id= WRITER.id
GROUP BY PERSON.id
HAVING COUNT(*)>1;",2018-08-31 00:34:55.976044+10,4,0,428,partially correct
8879,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 00:34:58.497141+10,2,1,73,correct
8880,"SELECT PERSON.id,first_name,last_name
From PERSON, DIRECTOR,WRITER
WHERE PERSON.id= DIRECTOR.id AND DIRECTOR.id= WRITER.id
GROUP BY PERSON.id
HAVING COUNT(*)>1;",2018-08-31 00:35:05.253586+10,4,0,428,partially correct
8881,"select ma.title, ma.production_year, first_name, last_name
from (select * from movie_award 
	where category='Best Film' 
	and award_name='BAFTA Film Award' 
	and result='Won') as ma, 
person p, director d
where p.id = d.id 
	and d.title = ma.title
	and ma.production_year = d.production_year
;",2018-08-31 00:35:26.018888+10,8,0,152,partially correct
8882,select distinct id from person order by year_born desc limit ;,2018-08-31 00:35:34.909195+10,3,0,200,noninterpretable
8883,"select id, first_name, last_name
from person
order by year_born DESC
LIMIT 1;",2018-08-31 00:35:51.448007+10,7,1,221,correct
8884,;,2018-08-31 00:36:06.22897+10,10,0,367,noninterpretable
8885,"select * from writer as w,writer_award as wa,person as p 
where w.id=wa.id
AND w.title=wa.title
AND w.production_year = wa.production_year
AND lower(wa.result)=""won""
AND w.id=p.id
AND wa.production_year>=1991
AND wa.production_year<=1995
AND p.first_name=""Woody""
AND p.last_name=""Allen"";",2018-08-31 00:36:14.812861+10,9,0,31,partially correct
8886,"select id, first_name, last_name
from person
group by year_born
having min(year_born);",2018-08-31 00:36:30.415949+10,7,0,276,partially correct
8887,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 00:36:32.167577+10,15,1,390,correct
8888,"select count(*)
from person
where person.id not in (select distinct(id) from director)
;",2018-08-31 00:36:43.423207+10,12,1,291,correct
8956,"select person.id,person.first_name,person.last_name from person 
join director on directir.id = person.id 
join movie on movie.title = director.title

where count(director.title) >= 2;",2018-08-31 00:57:03.479927+10,4,0,447,noninterpretable
8959,"select distinct movie.title, movie.production_year
from ( movie natural join writer natural join person)
where first_name = ""Kevin"" and last_name = ""Williamson"";
",2018-08-31 00:57:38.778863+10,5,1,337,correct
8889,"


select count(writer_award.award_name) 

from person join writer on person.id = writer.id join writer_award on writer.title = writer_award.title and writer.production_year = writer_award.production_year

where lower(writer_award.result) = 'won' and Writer_Award.year_of_award between '1991' and '1995' 
      and lower(person.first_name) = 'woody' and lower(person.last_name) = 'allen';",2018-08-31 00:36:51.337656+10,9,1,235,correct
8890,"SELECT COUNT(ID)
FROM WRITER
WHERE (SELECT ID FROM PERSON
       WHERE PERSON.YEAR_BORN=1935);
",2018-08-31 00:36:53.939979+10,1,0,328,partially correct
8891,"select * from writer as w,writer_award as wa,person as p 
where w.id=wa.id
AND w.title=wa.title
AND w.production_year = wa.production_year
AND lower(wa.result)=""won""
AND w.id=p.id
AND wa.production_year>=1991
AND wa.production_year<=1995
AND p.first_name=""Woody""
AND p.last_name=""Allen"";",2018-08-31 00:36:54.387279+10,9,0,31,partially correct
8892,"select title production year
from move
where;",2018-08-31 00:37:03.72205+10,5,0,267,noninterpretable
8893,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 00:37:04.061626+10,4,1,428,correct
8894,"select movie.production_year,count(movie.title) from movie
where movie.production_year = '1993'
union
select movie.production_year,count(movie.title) from movie
where movie.production_year = '1992'
union
select movie.production_year,count(movie.title) from movie
where movie.production_year = '1991';",2018-08-31 00:37:21.801653+10,2,1,447,correct
8895,"SELECT id,year_born
FROM person
ORDER BY year_born;
",2018-08-31 00:37:24.23806+10,3,0,372,partially correct
8896,"select p.first_name, p.id, p.last_name from person p where p.year_born=(select max(p.year_born) from person p);",2018-08-31 00:38:31.503369+10,7,1,270,correct
8897,"select count(*) from writer as w,writer_award as wa,person as p 
where w.id=wa.id
AND w.title=wa.title
AND w.production_year = wa.production_year
AND lower(wa.result)=""won""
AND w.id=p.id
AND wa.year_of_award>=1991
AND wa.year_of_award<=1995
AND p.first_name=""Woody""
AND p.last_name=""Allen"";",2018-08-31 00:38:42.462438+10,9,1,31,correct
8898,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year in (1991,1992,1993) 
GROUP BY production_year;",2018-08-31 00:39:00.148353+10,2,1,447,correct
8899,"select q2.id from (
select id, count(*) as j from
(
select id, title, production_year from director union 
select id, title, production_year from writer
) as q1
group by q1.id) as q2

where q2.j = 
(select max(q3.j) from (
select id, count(*) as j from(
select id, title, production_year from director union 
select id, title, production_year from writer
) as q1
group by q1.id) as q3);",2018-08-31 00:39:06.990759+10,14,1,194,correct
8900,"select p.id, p.first_name, p.last_name from person p where p.year_born=(select max(p.year_born) from person p);",2018-08-31 00:39:08.482879+10,7,1,270,correct
8901,"SELECT COUNT(*)
FROM WRITER
WHERE (SELECT ID FROM PERSON
       WHERE WRITER.ID=PERSON.ID
	  AND  PERSON.YEAR_BORN=1935);
",2018-08-31 00:39:11.661707+10,1,0,328,partially correct
8902,"select w.title, w.production_year
from writer w, person p
where w.id = p.id and p.first_name = ""Kevin"" and p.last_name = ""Williamson"";",2018-08-31 00:39:27.592911+10,5,1,286,correct
8903,"select count(*)
from(
select count(*)
from PERSON p
where p.id not in (select id from DIRECTOR)
group by p.id);",2018-08-31 00:39:35.309589+10,12,1,302,correct
8904,"select ma.title, ma.production_year, first_name, last_name
from (select * 
	from movie_award 
	where lower(category)='best film' 
	and lower(award_name)='bafta film award' 
	and lower(result)='won') as ma, 
person p, director d
where p.id = d.id 
	and d.title = ma.title
	
;",2018-08-31 00:39:38.582573+10,8,1,152,correct
8905,"select w.title, w.production_year
from writer w, person p
where w.id = p.id and p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-31 00:40:06.660348+10,5,1,286,correct
8906,"
select id from 
	(select id, count(title) as counts from
		(select id, title from director
		union 
		select id, title from writer) t1
	group by t1.id
	order by counts desc) t2
where counts = 
	(select max(counts) from 
		(select id, count(title) as counts from
			(select id, title from director
			union 
			select id, title from writer) t1
		group by t1.id
		order by counts desc) t2
	)



;",2018-08-31 00:40:16.909188+10,14,1,93,correct
8907,"select count(*) as numofm from movie m where not exists(select title from 
movie_award ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
union select title from crew_award c where c.title=m.title and c.production_year=m.production_year and lower(c.result)='won'
union select title from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
union select title from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
union select title from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won')





;",2018-08-31 00:40:20.100215+10,11,1,306,correct
8908,"SELECT COUNT(*)
FROM PERSON
WHERE (SELECT ID FROM WRITER
       WHERE WRITER.ID=PERSON.ID
	  AND  PERSON.YEAR_BORN=1935);
",2018-08-31 00:40:25.650149+10,1,1,328,correct
8909,"select id, first_name, last_name
from person p
where p.year_born = (select max(year_born) from person);",2018-08-31 00:40:44.128854+10,7,1,276,correct
8910,hgdfh;,2018-08-31 00:40:47.58118+10,6,0,267,noninterpretable
8911,"


select count(writer_award.title) 

from person join writer on person.id = writer.id join writer_award on writer.title = writer_award.title and writer.production_year = writer_award.production_year

where lower(writer_award.result) = 'won' and Writer_Award.year_of_award between '1991' and '1995' 
      and lower(person.first_name) = 'woody' and lower(person.last_name) = 'allen';",2018-08-31 00:41:00.437658+10,9,1,235,correct
8912,"with al 
as (
select id,title,production_year
from writer
union
select id,title,production_year
from director
)

select count(*) As num
from al 
group by id

;
",2018-08-31 00:42:05.322704+10,14,0,359,partially correct
8913,"select title, production_year
from movie_award
where award_name='BAFTA Film Award' and category='best film' and result='won';",2018-08-31 00:42:13.201162+10,8,0,221,partially correct
8914,"SELECT id,award_name,year_of_award,category
FROM director,director_award
WHERE director.title=director_award.title
      AND director.production_year=director_award.production_year
	AND lower(director_award.result)='nominated'
	AND director.id NOT IN (
	       SELECT id
		 FROM director_award,director
		 WHERE director.title=director_award.title
                  AND director.production_year=director_award.production_year
		       AND lower(director_award.result)='won');",2018-08-31 00:43:31.139005+10,13,1,369,correct
8915,"select id,first_name,last_name
from(select * from person p natural join writer w natural join director d)
group by id
having count(id)>1;",2018-08-31 00:43:45.37836+10,4,1,440,correct
8957,"SELECT ws.id, ws.first_name, ws.last_name from (director natural join writer natural join person) as ws group by ws.id having 
count(*) > 1;
",2018-08-31 00:57:35.803328+10,4,1,213,correct
8960,"select p.id, p.first_name,p.last_name
from person as p
where p.id in(select director.id from writer, director 
              where writer.title=director.title
              and writer.id = director.id
		   GROUP BY writer.id
		   having(count(*))>=2);",2018-08-31 00:57:56.037108+10,4,1,291,correct
8916,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 00:44:18.74914+10,15,1,102,correct
8917,"SELECT *
FROM (role r NATURAL JOIN appearance a) AS ra
WHERE lower(ra.title) = 'psycho' AND ra.production_year = 1960
GROUP BY ra.scene_no
HAVING count(*)=1;",2018-08-31 00:44:19.714752+10,10,0,373,partially correct
8918,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE EXISTS(SELECT count(*) FROM director d, writer w 
		WHERE d.id = p.id AND d.id == w.id AND d.title = w.title
		GROUP BY w.id
		HAVING count(*) >= 2)
GROUP BY p.id;",2018-08-31 00:44:47.50988+10,4,0,59,noninterpretable
8919,"SELECT
    r.id
FROM
    
    appearance a,
    ROLE r
WHERE
    r.title = a.title
    AND r.production_year = a.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-31 00:45:18.450194+10,10,1,329,correct
8920,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id=p.id);",2018-08-31 00:45:19.131596+10,12,1,403,correct
8921,"SELECT first_name, last_name
FROM person
WHERE YEAR_BORN='1935';",2018-08-31 00:45:33.299254+10,1,0,445,partially correct
8922,"select country
from Restriction
where lower(title) = 'shakespeare in love' and lower(description) = 'm';",2018-08-31 00:45:40.341146+10,6,1,286,correct
8923,"select u.title, u.production_year, u.first_name, u.last_name from (person p natural join director d natural join movie_award ma) u where lower(u.award_name)='befta film award' and lower(u.result)='won' and lower(u.category)='best film';",2018-08-31 00:45:45.578922+10,8,0,270,partially correct
8924,select country from restriction where lower(title) = 'Shakespeare in love' and description = 'M' ;,2018-08-31 00:45:46.817433+10,6,0,400,partially correct
8925,gyig;,2018-08-31 00:45:47.102985+10,7,0,267,noninterpretable
8926,"select u.title, u.production_year, u.first_name, u.last_name from (person p natural join director d natural join movie_award ma) u where lower(u.award_name)='bafta film award' and lower(u.result)='won' and lower(u.category)='best film';",2018-08-31 00:46:11.581951+10,8,1,270,correct
8927,"SELECT production_year, count(*)
FROM movie
WHERE movie.production_year=1991 or movie.production_year=1992 or movie.production_year=1993
GROUP BY production_year; ",2018-08-31 00:47:16.625634+10,2,1,328,correct
8928,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma
inner join director di on ma.title=di.title
inner join person p on di.id=p.id
where award_name='BAFTA Film Award' and category='best film' and result='won';",2018-08-31 00:47:56.808001+10,8,1,221,correct
8929,"SELECT production_year, Count(*)
FROM Movie 
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;
",2018-08-31 00:48:02.481568+10,2,1,142,correct
8930,"SELECT
    id,
    first_name,
    last_name
FROM
    person 
WHERE
    year_born = (
        SELECT
            min(year_born)
        FROM
            person );",2018-08-31 00:48:17.048401+10,7,0,267,partially correct
8931,"select person.id,count(person.id) From person
where select director.id from director
where person.id not in director.id;",2018-08-31 00:48:19.138275+10,12,0,447,noninterpretable
8932,"SELECT p.id, p.first_name, p.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS p
GROUP BY p.id
HAVING count(*) > 1;",2018-08-31 00:48:43.985673+10,4,1,59,correct
8933,;,2018-08-31 00:48:57.111113+10,11,0,367,noninterpretable
8934,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 00:48:58.554445+10,6,1,400,correct
8935,"with al 
as (
select id,title,production_year
from writer
union
select id,title,production_year
from director
),
nux
as
(
select count(*) As num
from al 
group by id
order by num desc)

select id
from al
group by id
having count(*)>=2


;
",2018-08-31 00:50:00.291575+10,14,0,359,partially correct
8936,"select count(person.id) From person
where not exists(
select * from director
where director.id = person.id);",2018-08-31 00:50:02.470573+10,12,1,447,correct
8937,"SELECT first_name, last_name
FROM person
WHERE YEAR_BORN='1935';",2018-08-31 00:50:11.992693+10,1,0,445,partially correct
8938,"select person.id,first_name,last_name
from(select id from director d where exists (select * from writer w where w.id = d.id and w.title = d.title and w.production_year = d.production_year)) as mm,person
where mm.id = person.id
group by person.id
having count(person.id)>1;",2018-08-31 00:50:22.309062+10,4,1,440,correct
8939,"select r.id from role as r, appearance as a 
where r.title=a.title
AND r.production_year = a.production_year
AND r.description = a.description
AND lower(a.title)=""psycho""
AND a.production_year=1960
Group by a.scene_no
HAVING count(*)=1;",2018-08-31 00:50:38.750042+10,10,0,31,partially correct
8940,"SELECT COUNT(*)
FROM person as p
WHERE( SELECT ID FROM director as d
        WHERE p.id!=d.id)
		;",2018-08-31 00:50:50.751611+10,12,0,328,partially correct
8941,"select * from role where id in (
select q1.id from (
select id, count(*) as c from role group by id) as q1
where q1.c = 
(select max(q1.c) from (select id, count(*) as c from role group by id) as q1));",2018-08-31 00:50:56.518957+10,15,0,194,partially correct
8942,"with al 
as (
select id,title,production_year
from writer
union
select id,title,production_year
from director
),
nux
as
(
select count(*) As num
from al 
group by id
order by num desc)

select id
from al
group by id
having count(*)>=(select max(num) from nux)


;
",2018-08-31 00:50:59.508646+10,14,1,359,correct
8943,select count(*) from person p natural join writer_award wa where lower(p.first_name)='woody' and lower(p.last_name)='allen' and wa.year_of_award>=1991 and wa.year_of_award<=1995;,2018-08-31 00:51:18.795869+10,9,0,270,partially correct
8944,;,2018-08-31 00:52:18.740338+10,3,0,367,noninterpretable
8945,"
WHERE writer.w from person.p(w = p and year_born = 1935);",2018-08-31 00:52:35.360263+10,1,0,418,noninterpretable
8946,"SELECT count(*) FROM person, (SELECT DISTINCT person.id AS a FROM person, writer WHERE person.id =writer.id AND year_born='1935') AS b GROUP BY person.id HAVING person.id=a;",2018-08-31 00:52:56.47698+10,1,1,210,correct
8947,select count(*) from person p natural join writer_award wa where lower(p.first_name)='woody' and lower(p.last_name)='allen' and wa.year_of_award>=1991 and wa.year_of_award<=1995 and lower(result)='won';,2018-08-31 00:53:03.742315+10,9,1,270,correct
8948,"select r.id from role as r, appearance as a 
where r.title=a.title
AND r.production_year = a.production_year
AND r.description = a.description
AND lower(a.title)=""psycho""
AND a.production_year=1960
Group by r.id
HAVING count(*)=1;",2018-08-31 00:53:08.514529+10,10,1,31,correct
8949,"select p.first_name, p.last_name, r.title, r.production_year, r.description from role r inner join person p on r.id = p.id
where r.id in (
select q1.id from (
select id, count(*) as c from role group by id) as q1
where q1.c = 
(select max(q1.c) from (select id, count(*) as c from role group by id) as q1));",2018-08-31 00:53:35.445375+10,15,1,194,correct
8950,;,2018-08-31 00:53:56.916081+10,13,0,367,noninterpretable
8951,"select count(*)
from writer_award join person as wp
where lower(first_name)='woody'
	and lower(last_name)='allen'
	and year_of_award <= 1995
	and year_of_award >= 1991
	and lower(result)='won'
;",2018-08-31 00:55:21.050216+10,9,0,152,partially correct
8952,"select p1.id, p1.first_name, p1.last_name
from person p1
where p1.year_born = (select min(p2.year_born) from person p2);",2018-08-31 00:55:35.402468+10,7,0,286,partially correct
8953,"SELECT COUNT(*)
FROM person as p
WHERE NOT EXISTS( SELECT * 
       FROM director AS d
        WHERE p.id =d.id);",2018-08-31 00:55:39.400962+10,12,1,328,correct
8955,"select m.title m.production_year  p.first name p.last name
from 
movie m,
people p;
",2018-08-31 00:56:54.485353+10,8,0,267,noninterpretable
8961,"select p1.id, p1.first_name, p1.last_name
from person p1
where p1.year_born = (select max(p2.year_born) from person p2);",2018-08-31 00:57:58.955629+10,7,1,286,correct
8963,"SELECT id
FROM (SELECT id,year_born
      FROM person
	 WHERE year_born < (SELECT MAX(year_born)
	                    FROM person))
WHERE year_born=(SELECT MAX(year_born)
                 FROM (SELECT id,year_born
                      FROM person
	                 WHERE year_born < (SELECT MAX(year_born)
	                    FROM person)));",2018-08-31 00:58:59.579894+10,3,1,369,correct
8964,"SELECT m.title,m.production_year
FROM movie m INNER JOIN writer w on m.title = w.title AND m.production_year = w.production_year
WHERE EXISTS (SELECT * FROM person p WHERE p.id = w.id AND p.first_name = ""Kevin"" AND p.last_name = ""Williamson"");",2018-08-31 00:59:17.456657+10,5,1,59,correct
8965,select id from person p where p.year_born=(select  max(p.year_born) from person p where year_born<(select  max(year_born) from person));,2018-08-31 00:59:23.717759+10,3,1,306,correct
8966,"select count(*)
from writer_award wa 
inner join writer w on wa.title=w.title
inner join person p on w.id=p.id
where year_of_award between 1991 and 1995 and result='won' and p.first_name='Woody' and p.last_name='Allen';",2018-08-31 00:59:29.882735+10,9,1,221,correct
8967,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
				id) as a);",2018-08-31 00:59:38.166118+10,15,1,48,correct
8968,"select count(*)
from writer_award wa, person p
where 
	wa.id = p.id
	and lower(first_name)='woody'
	and lower(last_name)='allen'
	and year_of_award <= 1995
	and year_of_award >= 1991
	and lower(result)='won'
;",2018-08-31 00:59:38.611026+10,9,1,152,correct
8969,"select count(*) from (writer_award natural join writer natural join person) as wa 

where wa.first_name = 'Woody' And wa.last_name = 'Allen' AND wa.year_of_award between '1991' AND '1995';

",2018-08-31 00:59:50.105753+10,9,0,65,partially correct
8970,"select count(*)
from person p
WHERE exists (select * from writer w where w.id = p.id and p.year_born = 1935);",2018-08-31 00:59:52.997993+10,1,1,418,correct
8971,"select title,production_year
from (person natural join movie natural join writer) as m
where m.first_name = 'Kevin' and m.last_name = 'Williamson';",2018-08-31 01:00:26.974393+10,5,1,440,correct
8972,"

Having count(Appearance.scene_no) = 1;",2018-08-31 01:00:41.625828+10,10,0,235,noninterpretable
8973,"select count(*)
from person p
WHERE exists (select * from writer w where w.id = p.id and p.year_born = 1935);",2018-08-31 01:00:56.907194+10,1,1,418,correct
8974,"select distinct country
from movie natural join restriction_category
where description = ""M"";",2018-08-31 01:01:09.217505+10,6,1,337,correct
8975,"select person.id,person.first_name,person.last_name from person 
join director on director.id = person.id 
join movie on movie.title = director.title

group by person.id
having count(*) >=2;",2018-08-31 01:01:41.22623+10,4,0,447,partially correct
8976,select r.id from (role r natural join appearance a) u where lower(u.title)='psycho' and u.production_year=1960 group by u.id having count(id)=1;,2018-08-31 01:02:07.716323+10,10,1,270,correct
8977,"select
	count(*)
from 
	person p,
	writer w
where 
	p.id=w.id and p.year_born=1935;",2018-08-31 01:02:34.30857+10,1,0,48,partially correct
8978,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (SELECT * FROM movie_award ma WHERE m.title = ma.title AND m.production_year = ma.production_year) 
AND NOT EXISTS (SELECT * FROM crew_award ca WHERE m.title = ca.title AND m.production_year = ca.production_year);",2018-08-31 01:02:53.376287+10,11,0,373,partially correct
8979,"SELECT id
FROM (SELECT id,year_born
      FROM person AS P
	 WHERE year_born < (SELECT MAX(year_born)
	                    FROM person))
WHERE year_born=(SELECT MAX(year_born)
                 FROM (SELECT id,year_born
      FROM person AS P
	 WHERE year_born < (SELECT MAX(year_born)
	                    FROM person)));",2018-08-31 01:03:14.736395+10,3,1,369,correct
8980,"SELECT id, first_name, last_name
FROM person as p
WHERE(SELECT count(*)
       FROM director as d, writer as w
       WHERE d.title=w.title
	   AND d.id=p.id)>1;",2018-08-31 01:04:19.763906+10,4,0,328,partially correct
8981,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS(SELECT(*)
		FROM Director d
		WHERE EXISTS(SELECT(*)
		FROM WRITER w
		WHERE d.id = w.id
		Group By Writer
		Having count(*)>1);",2018-08-31 01:04:28.163318+10,4,0,287,noninterpretable
8982,"select country
from restriction
where title = ""Shakespeare in Love""
	and description = ""M"";",2018-08-31 01:04:33.249823+10,6,1,337,correct
8983,"SELECT r.country
FROM Restriction r
WHERE r.title =  'Shakespeare in Love' AND r.description = 'M';",2018-08-31 01:05:44.995327+10,6,1,59,correct
8984,"SELECT production_year, count(*)
FROM movie 
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 01:06:07.23884+10,2,1,380,correct
8985,"SELECT count(*) FROM person WHERE NOT EXISTS(SELECT * from director WHERE person.id = director.id) ;
",2018-08-31 01:06:42.414812+10,12,1,213,correct
8986,"with ti
as (
select count(*) as num
from role
group by id)

select num
from ti;",2018-08-31 01:06:42.868111+10,15,0,359,partially correct
8987,"SELECT ma.title, p
FROM
(Appearance A AND SCENE S AND MOVIE M) AS ma
WHERE 
lower(scene) = psycho;",2018-08-31 01:06:44.474311+10,10,0,352,noninterpretable
8988,"select count(*) as number_of_award from (writer_award natural join writer natural join person) as wa 

where wa.first_name = 'Woody' And wa.last_name = 'Allen' AND  lower(RESULT)= 'won' AND wa.year_of_award between '1991' AND '1995';

",2018-08-31 01:06:48.813654+10,9,1,65,correct
8989,";
",2018-08-31 01:07:04.892916+10,15,0,213,noninterpretable
8990,"SELECT ;
",2018-08-31 01:07:54.099157+10,12,0,380,noninterpretable
8991,"select writer.title, writer.production_year
from writer, person
where person.first_name =""Kevin"" and person.last_name =""Williamson""
      and person.id = writer.id;",2018-08-31 01:07:54.827602+10,5,1,291,correct
8992,"select id
from role r, appearance a
where a.production_year = 1960
	and a.title = r.title
	and lower(a.title) = 'psycho'
group by id
;",2018-08-31 01:07:57.957432+10,10,0,152,partially correct
8993,"select *
from appearance ap
inner join person p on ap.description=p.first_name || ' ' || p.last_name
where ap.scene_no=1 and ap.title='Psycho' and ap.production_year=1960;",2018-08-31 01:08:41.397722+10,10,0,221,partially correct
8994,"with ti
as (
select count(*) as num
from role
group by id)



select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r, (select id 
from role
group by id
having count(id)>=
(select max(num)
from ti)) as rp
where rp.id=r.id and r.id=p.id;",2018-08-31 01:09:05.985101+10,15,1,359,correct
8995,"Select p.id, first_name, last_name from person p,  director d, writer w
Where (select count(*) from person where
p.id = d.id
and p.id = w.id
and d.title = w.title
and d.production_year = w.production_year ) >= 2 ;
",2018-08-31 01:09:18.807749+10,4,0,400,partially correct
12601,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id=d.id);",2018-08-31 16:57:35.124521+10,12,1,441,correct
8996,"select id, first_name, last_name
from ( 
	select id, first_name, last_name, max(year_born)
	from person
	);",2018-08-31 01:09:36.228367+10,7,1,337,correct
8997,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person natural join director natural join writer)as dw
group by dw.id
HAVING count(*)>1;
",2018-08-31 01:09:39.433751+10,4,1,328,correct
8998,"select p.id,first_name,last_name
from PERSON p
where p.id in(select d.id 
              from DIRECTOR d inner join WRITER w 
		   ON d.id=w.id
	         where d.title=w.title
		   group by d.id
		   Having count(*)>=2
                        );",2018-08-31 01:09:58.429739+10,4,1,302,correct
8999,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS ( SELECT * FROM director AS d
where p.id = d.id)
;",2018-08-31 01:10:01.55596+10,12,1,380,correct
9000,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p, role r
WHERE p.id = r.id
	and p.id =(SELECT y.id
			FROM (SELECT x.id,MAX(x.NoOfRoles)
				FROM
					(SELECT r1.id, count(*) AS NoOfRoles
					FROM role r1
					GROUP BY r1.id) x )y);",2018-08-31 01:10:14.042183+10,15,1,285,correct
9001,"Select p.id, first_name, last_name from person p,  director d, writer w
Where (select count(*) from person where
p.id = d.id
and d.id = w.id
and d.title = w.title
and d.production_year = w.production_year ) >= 2 ;
",2018-08-31 01:10:17.718297+10,4,0,400,partially correct
9002,"select t.first_name,t.last_name,r.title,r.production_year,r.description from
(select p.first_name as first_name,p.last_name as last_name,p.id as id
from person p,role r where p.id=r.id 
group by p.id
order by count(distinct r.title) desc limit 1) t,role r
where t.id=r.id;",2018-08-31 01:10:26.299536+10,15,1,363,correct
9003,"select country
from restriction r
where lower(r.title) = 'shakespeare in love' and r.description = 'M';",2018-08-31 01:10:26.616037+10,6,1,440,correct
9004,"SELECT MAX(year_born),id,first_name,last_name
FROM person;",2018-08-31 01:10:42.824534+10,7,0,59,partially correct
9005," select production_year
 from movie m
 where 1990<m.production_year<1994;",2018-08-31 01:10:47.376382+10,2,0,418,partially correct
9006,"select
	count(*)
from 
	person p
where exists(
	select * from writer w where
	p.id=w.id and p.year_born=1935)
	
	;",2018-08-31 01:10:50.946437+10,1,1,48,correct
9007,"select ma.title, ma.production_year, dp.first_name, dp.last_name
from (select title, production_year from Movie_Award where lower(award_name) = 'bafta film award' and lower(category) = 'best film'and lower(result)= 'won') as ma, (director NATURAL JOIN person) as dp
where dp.title = ma.title;",2018-08-31 01:11:37.821724+10,8,1,286,correct
9008,"select person.id,person.first_name,person.last_name from person 
join director on director.id = person.id
join writer on writer.id = person.id and director.title = writer.title

group by person.id
having count(*) >1;",2018-08-31 01:11:59.354831+10,4,1,447,correct
9009,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 01:12:20.579675+10,10,1,352,correct
9010,"SELECT id,first_name,last_name
FROM person
WHERE person.year_born = (SELECT MAX(year_born) FROM person);",2018-08-31 01:12:21.716762+10,7,1,59,correct
9011,"select dw.id, dw.first_name, dw.last_name from
(person natural join director natural join writer )as dw
Group by dw.id
Having count(*) >1 ;
",2018-08-31 01:12:29.929007+10,4,1,400,correct
9012,"select count(*) from movie m where not exists 
(select ma.title, ma.production_year 
from movie_award ma 
where lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
union
select ca.title, ca.production_year 
from crew_award ca 
where lower(ca.result)='won' and ca.title=m.title and ca.production_year=m.production_year
union
select da.title, da.production_year 
from director_award da 
where lower(da.result)='won' and da.title=m.title and da.production_year=m.production_year
union
select wa.title, wa.production_year 
from writer_award wa 
where lower(wa.result)='won' and wa.title=m.title and wa.production_year=m.production_year
union
select aa.title, aa.production_year
from actor_award aa
where lower(result)='won' and aa.title=m.title and aa.production_year=m.production_year
);",2018-08-31 01:12:52.881679+10,11,1,270,correct
9013,select;,2018-08-31 01:13:05.649428+10,11,0,352,noninterpretable
9014,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS (
SELECT ma.title, ma.production_year FROM movie_award ma WHERE m.title = ma.title AND m.production_year = ma.production_year AND lower(ma.result) = 'won'
UNION
SELECT da.title, da.production_year FROM director_award da WHERE m.title = da.title AND m.production_year = da.production_year AND lower(da.result) = 'won'
UNION
SELECT wa.title, wa.production_year FROM writer_award wa WHERE m.title = wa.title AND m.production_year = wa.production_year AND lower(wa.result) = 'won'
UNION
SELECT aa.title, aa.production_year FROM actor_award aa WHERE m.title = aa.title AND m.production_year = aa.production_year AND lower(aa.result) = 'won'
UNION
SELECT ca.title, ca.production_year FROM crew_award ca WHERE m.title = ca.title AND m.production_year = ca.production_year AND lower(ca.result) = 'won'
);",2018-08-31 01:13:13.081381+10,11,1,373,correct
9015," select production_year,count (*)
 from movie
 where production_year<1994 and production_year<1990
 group by production_year;",2018-08-31 01:13:24.442088+10,2,0,418,partially correct
9016," select production_year,count (*)
 from movie
 where production_year<1994 and production_year>1990
 group by production_year;",2018-08-31 01:13:51.085683+10,2,1,418,correct
9017,"select count(p)
from
writer w,
(
        SELECT
            title,
            production_year
        FROM
            writer_award
        WHERE
            lower(award_name)= 'woody allend'
            AND production_year>=1991
		AND production_year<=1995)as wa,
people p
where
p.id=w.id and;
            ",2018-08-31 01:14:09.214552+10,9,0,267,noninterpretable
9018,"select p.first_name, p.last_name, r.title ,r.production_year, r.description

from person p, role r,(select id, count(*) as number_of_roles from role group by id) as b

where r.id = p.id and p.id = b.id and b.number_of_roles in (select max(number_of_roles) from (select id, count 

(*) as number_of_roles from role group by id) as a);
",2018-08-31 01:14:15.858434+10,15,1,213,correct
9019,"SELECT first_name , last_name
FROM person 
;",2018-08-31 01:14:20.385501+10,4,0,380,partially correct
9020,"select id
from role r, appearance a
where a.production_year = 1960
	and lower(a.title) = 'psycho'
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description=r.description
group by r.id
having count(*) =1
;",2018-08-31 01:14:26.512936+10,10,1,152,correct
9021,"select r.country
from restriction as r
where r.title =""Shakespeare in Love"" and r.description = ""M"";",2018-08-31 01:14:34.659598+10,6,1,291,correct
9022,"SELECT pdw.id, pdw.first_name, pdw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS pdw
Group By pdw.id
Having count(*)>1;",2018-08-31 01:15:25.572059+10,4,1,287,correct
9023,"Select title, production_year from writer w, person p
Where w.id = p.id,
And Lower(p.first_name) = kevin
And lower(p. last_name) = williamson ;
",2018-08-31 01:15:48.088535+10,5,0,400,noninterpretable
9024,"select d.id, da.award_name,da.year_of_award,da.category from director d,director_award da where lower(da.result)!='won' and d.title=da.title and 
d.production_year=da.production_year group by d.id having count(*)>1;",2018-08-31 01:15:48.456613+10,13,0,306,partially correct
9025,"SLECT COUNT (tile)
FROM movie m
WHERE production_year = '1991 to 1993';
",2018-08-31 01:16:11.393036+10,2,0,445,noninterpretable
9026,"Select title, production_year from writer w, person p
Where w.id = p.id,
And Lower(p.first_name) = kevin
And lower(p.last_name) = williamson ;
",2018-08-31 01:16:17.13143+10,5,0,400,noninterpretable
9027,"select movie.title,movie.production_year from movie join writer on movie.title = writer.title
join person on person.id = writer.id
where person.first_name = 'Kevin' and person.last_name = 'Williamson';",2018-08-31 01:16:33.303373+10,5,1,447,correct
9029,"



select person.id,

from person join role on person.id = role.id join appearance on role.title = Appearance.title and role.production_year = Appearance.production_year
     
where lower(appearance.title) = 'psycho' and appearance.production_year = '1960'

Group by person.id,
Having count(Appearance.scene_no) = 1;",2018-08-31 01:17:00.589413+10,10,0,235,noninterpretable
9030,"select id,first_name,last_name
from person p
where p.year_born = (select max(year_born) from person);",2018-08-31 01:17:45.438197+10,7,1,440,correct
9031,"SELECT h.title, h.production_year
FROM (movie natural join writer natural join writer) as h
GROUP BY h.production_year
HAVING  h.first_name='Kevin'
AND    h.last_name='Williamson';",2018-08-31 01:18:01.705144+10,5,0,328,noninterpretable
9032,"Select title, production_year from writer w, person p
Where w.id = p.id
And lower(p.first_name) = 'kevin'
And lower(p.last_name) = 'williamson' ;
",2018-08-31 01:18:57.222153+10,5,1,400,correct
9033,"select r.id from appearance a natural join role r 
where r.title = 'Psycho' and r.production_year = 1960
group by r.id having count(r.id) = 1;",2018-08-31 01:19:05.396628+10,10,1,194,correct
9034,"select title, production_year, first_name, last_name
from movie_award natural join director natural join person
where lower(award_name) = ""bafta film award""
	and lower(category) = ""best film"";",2018-08-31 01:19:28.411152+10,8,0,337,partially correct
9035,"SELECT production_year, count(*) FROM movie WHERE production_year='1993' GROUP BY production_year
UNION
SELECT production_year, count(*) FROM movie WHERE production_year='1992' GROUP BY production_year
UNION
SELECT production_year, count(*) FROM movie WHERE production_year='1991' GROUP BY production_year;



",2018-08-31 01:20:03.253102+10,2,1,210,correct
9036,;,2018-08-31 01:20:14.105461+10,3,0,373,noninterpretable
9037,"select title, production_year
from MOVIE
where title in(select title from WRITER
               WHERE id in(select id from PERSON 
			   	     where first_name=""Kevin""
					 and last_name=""Williamson""));",2018-08-31 01:20:46.839189+10,5,1,302,correct
9038,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 01:21:09.777266+10,3,1,373,correct
9039,"select title, production_year from 
(writer natural join person) 
group by title 
having person.first_name = 'Kevin' and person.last_name = 'Williamson' ;",2018-08-31 01:21:57.639025+10,5,1,400,correct
9040,"select m.id
from movie as m, appearance as a
where lower(m.title) = 'psycho' and m.production_year = 1960 and a.scene_no = 1;",2018-08-31 01:22:18.562719+10,10,0,225,noninterpretable
9041,"select count(*)
from person p
where not excists(from director d where d.id = p.id);",2018-08-31 01:22:19.950445+10,12,0,418,noninterpretable
9042,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 01:22:39.550921+10,4,1,380,correct
9043,"select d.id, award_name, year_of_award, category from director_award a
natural join director d
where lower(a.result) <> 'won';",2018-08-31 01:22:54.59179+10,13,1,194,correct
9044,"select title, production_year, first_name, last_name
from movie_award natural join director natural join person
where lower(award_name) = ""bafta film award""
	and lower(category) = ""best film""
	and lower(result) = ""won"";",2018-08-31 01:22:55.79962+10,8,1,337,correct
9045,;,2018-08-31 01:23:24.917184+10,1,0,417,noninterpretable
9046,"select d.id, da.award_name,da.year_of_award,da.category from director d,director_award da where lower(da.result)!='won' and d.title=da.title and 
d.production_year=da.production_year and d.id in (select id from director d,director_award da where d.title=da.title and 
d.production_year=da.production_year and lower(da.result)='nominated' group by id having count(*)>1);",2018-08-31 01:23:31.886887+10,13,0,306,partially correct
9047,"SELECT COUNT(*)
FROM person p NATURAL JOIN director d;
",2018-08-31 01:23:42.308255+10,12,0,445,partially correct
9048,"select count(*)
from person p
where not exists(select * from director d where d.id = p.id);",2018-08-31 01:23:43.559208+10,12,1,418,correct
9049,"select r.id
from scene as s,
	role as r,
	appearance as a
where 
	s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no = a.scene_no
	and s.title = r.title
	and s.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by
	r.id
having
	count(*) = 1;",2018-08-31 01:23:49.920587+10,10,1,111,correct
9050,"SELECT title, production_year
FROM Movie m
WHERE EXISTS(SELECT(title)
		FROM writer w NATURAL JOIN person p
		WHERE p.id = w.id AND p.first_name ='Kevin' AND p.last_name = 'Williamson'AND w.title= m.title);",2018-08-31 01:24:00.253716+10,5,1,287,correct
9051,"select title,production_year,first_name,last_name
from (director natural join movie_award natural join person) as m
where lower(m.award_name) = 'bafta film award' and lower(m.category) = 'best film' and lower(result) = 'won';",2018-08-31 01:24:43.254142+10,8,1,440,correct
9052,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 01:24:48.259729+10,5,1,328,correct
9053,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 01:24:48.640964+10,5,1,328,correct
9054,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 01:24:49.192636+10,5,1,328,correct
9055,"SELECT id
FROM (writer NATURAL JOIN director NATURAL JOIN movie) AS h
WHERE (SELECT MAX(COUNT(id))
       FROM h);",2018-08-31 01:25:20.961207+10,14,0,369,noninterpretable
9056,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND first_name= 'kevin'
    AND last_name= 'williamson';",2018-08-31 01:25:23.606015+10,5,0,328,partially correct
9057,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 01:25:58.679515+10,5,1,328,correct
9058,"select country
from RESTRICTION
where title=""Shakespeare in Love""
and description=""M"";",2018-08-31 01:26:04.314228+10,6,1,302,correct
9059,"select id, first_name, last_name
from person
where year_born in (select max(year_born) 
                    from person);",2018-08-31 01:26:19.977578+10,7,1,291,correct
9060,"select count(*)
from writer_award natural join writer natural join person
where first_name = ""Woody""
	and last_name = ""Allen""
	and year_of_award >= 1991
	and year_of_award <= 1995
	and lower(result) = ""won"";",2018-08-31 01:27:05.821907+10,9,1,337,correct
9061,"select d.id, da.award_name,da.year_of_award,da.category from director d,director_award da where lower(da.result)='nominated' and d.title=da.title and 
d.production_year=da.production_year and d.id in (select id from director d,director_award da where d.title=da.title and 
d.production_year=da.production_year and lower(da.result)!='won');",2018-08-31 01:28:24.788357+10,13,1,306,correct
9062,"SELECT DISTINCT count(*) FROM person, (SELECT director.id AS a FROM director GROUP BY director.id) AS b GROUP BY PERSON.id HAVING person.id != a;",2018-08-31 01:28:33.706056+10,12,0,210,partially correct
9097,"select count(*)
from (writer_award natural join writer natural join person) as m
where lower(m.first_name) = 'woody' and lower(m.last_name) = 'allen' and year_of_award > 1990 and year_of_award < 1996;",2018-08-31 01:39:36.962244+10,9,0,440,partially correct
9222,"select id, year_of_award, category
from director_award natural join director
where not lower(result) = ""won""

;",2018-08-31 02:48:54.971487+10,13,0,337,partially correct
9063,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 01:28:42.725718+10,14,1,369,correct
9064,"select id from role 
where description=
(select description
from appearance where title='Psycho' and production_year= 1960
group by title,production_year,description
having count(*)=1
);
",2018-08-31 01:28:44.107099+10,10,0,391,partially correct
9065,"select id, rst_name, last_name
from person p 
where exists (select * from director d where d.title = writer.title and d.production_year = writer.production_year);",2018-08-31 01:28:54.324953+10,4,0,418,noninterpretable
9066,"select ms.id from (scene natural join crew) as ms where 
 
lower(ms.title) = 'psycho' and ms.production_year = '1960' And ms.scene_no =1 ;",2018-08-31 01:29:12.740939+10,10,0,65,partially correct
9067,;,2018-08-31 01:29:24.029647+10,5,0,380,noninterpretable
9068,"SELECT rm.country
FROM (RESTRICTION r NATURAL JOIN Movie m) AS rm
WHERE rm.title is 'Shakespeare in Love AND rm.description is 'M';",2018-08-31 01:29:56.717313+10,6,0,287,noninterpretable
9069,"select id,first_name,last_name
from PERSON 
WHERE year_born=(select max(year_born)
			from PERSON);",2018-08-31 01:30:05.200531+10,7,1,302,correct
9070,"select count(*)
from movie m
where not exists 
	(select title
	from movie m, movie_award ma, crew_award ca, 
	director_award da, writer_award wa, actor_award aa
	where
	m.title = ma.title
	or m.title = ca.title
	or m.title = da.title
	or m.title = wa.title
	or m.title = aa.title
);",2018-08-31 01:30:06.313959+10,11,0,152,noninterpretable
9071,"



select person.id,

from person join role on person.id = role.id 
     join Appearance on role.title = Appearance.title and Role.production_year = Appearance.production_year
     
where lower(role.title) = 'psycho' and role.production_year = '1960'

Group by person.id,

Having count(Appearance.scene_no) = 1;",2018-08-31 01:30:12.696909+10,10,0,235,noninterpretable
9072,"SELECT country
FROM restriction 
WHERE title='Shakespeare in Love'
AND     description='M';
",2018-08-31 01:30:20.198+10,6,1,328,correct
9073,"SELECT dda.id, dda.award_name, dda.year_of_award, dda.category
FROM (director d NATURAL JOIN director_award da) AS dda
WHERE dda.result = 'nominated'
GROUP BY dda.id;",2018-08-31 01:30:24.289671+10,13,1,373,correct
9074,"select count(*)
from movie union movie_award union crew_award union director_award union writer_award union actor_award
where lowr(result) = 'nominated';
",2018-08-31 01:30:44.052874+10,11,0,163,noninterpretable
9075,SELECT country FROM restriction where (description = 'M' and title = 'Shakespeare in Love');,2018-08-31 01:30:48.113609+10,6,1,213,correct
9076,ygjgu;,2018-08-31 01:30:57.655278+10,10,0,267,noninterpretable
9077,"select title,production_year,first_name,last_name
  
   from (Movie_Award natural join director natural join person)as mdp 
   where lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';
",2018-08-31 01:31:19.551581+10,8,1,223,correct
9078,SELECT r;,2018-08-31 01:31:59.375824+10,6,0,380,noninterpretable
9079,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 01:32:05.847237+10,4,1,418,correct
9080,"SELECT ra.title,ra.production_year,pw.first_name,pw.last_name
FROM (Restriction INNER JOIN Award on award.country = restriction.country) AS ra ,(person INNER JOIN writer on person.id = writer.id) AS pw
WHERE lower(ra.award_name) = 'bafta film award' AND lower(ra.description) = 'best film' AND  pw.title = ra.title;",2018-08-31 01:32:45.66356+10,8,0,59,partially correct
9081,"select mdp.title, mdp.production_year, mdp.first_name, mdp.last_name
from (movie_award left join director natural join person ) as mdp
where mdp.award_name = 'BAFTA Film Award'
and mdp.category = 'Best Film'
and mdp.result = 'won';",2018-08-31 01:33:26.238532+10,8,0,276,partially correct
9082,"select id
from appearance natural join role natural join person
where lower(title) = ""psycho""
	and production_year = 1960
group by id
having count(*) = 1;",2018-08-31 01:35:39.098656+10,10,1,337,correct
9083,"SELECT DISTINCT id, first_name, last_name,MAX(year_born)
FROM person p;",2018-08-31 01:36:16.909464+10,7,0,328,partially correct
9084,"SELECT COUNT(DISTINCT person.id)
FROM person,writer
WHERE person.id = writer.id
AND person.year_born = 1935;",2018-08-31 01:36:24.481662+10,1,1,307,correct
9085,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-31 01:36:31.761629+10,11,1,352,correct
9086,"SELECT first_name,last_name
FROM person p
WHERE EXISTS (SLECT * FROM Director d WHERE writer INNER JOIN >= '2';",2018-08-31 01:37:21.01536+10,4,0,445,noninterpretable
9087,"SELECT
    country
FROM
    restriction
WHERE
   lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 01:37:27.977419+10,6,1,287,correct
9088,"SELECT DISTINCT id, first_name, last_name
FROM person p
WHERE p.year_born=(SELECT MAX(YEAR_BORN)
                   FROM PERSON);",2018-08-31 01:37:34.681295+10,7,1,328,correct
9089,"SELECT
    country
FROM
    restriction
WHERE
   lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 01:37:36.799462+10,6,1,287,correct
9090,"select count(*)

from (Writer_Award  natural join person) as p

where  p.first_name='Woody' and p.last_name='Allen' and p.year_of_award>=1991 and p.year_of_award<=1995;",2018-08-31 01:37:37.311082+10,9,0,223,partially correct
9091,SELECT;,2018-08-31 01:37:47.36113+10,3,0,352,noninterpretable
9092,"select title production_year
from movie m
where exists(select * from person p where p.id = writer.id and p.first_name = Kevin and p.last_name = Williamson);
",2018-08-31 01:38:29.522038+10,5,0,418,noninterpretable
9093,"SELECT id, first_name, last_name
FROM Person
where limit 0,1;",2018-08-31 01:38:45.399675+10,7,0,380,noninterpretable
9094,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 01:38:45.478957+10,3,1,352,correct
9095,"SELECT count(*)  from writer_award wa, writer w, person p
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id
and w.id = p.id and lower(first_name) = 'woody' and lower(result) = 'won' and lower(last_name)= 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <=1995;",2018-08-31 01:39:00.600166+10,9,1,213,correct
9096,"SELECT ra.title,ra.production_year,pw.first_name,pw.last_name
FROM Movie_Award AS ra, (person INNER JOIN writer on person.id = writer.id) AS pw
WHERE lower(ra.award_name) = 'bafta film award' AND lower(ra.category) = 'best film' AND  pw.title = ra.title;",2018-08-31 01:39:02.900529+10,8,0,59,partially correct
9223,"SELECT id, first_name, last_name
FROM person
GROUP BY id
HAVING MIN(year_born);",2018-08-31 02:49:35.897903+10,7,0,327,partially correct
9098,"select role.id from role 
join movie on movie.title = role.title and movie.production_year = role.production_year
join scene on movie.title = scene.title and movie.production_year = scene.production_year

where lower(movie.title) = 'psycho' and movie.production_year = '1960'

group by role.id
having count(scene.scene_no) = 1;",2018-08-31 01:39:59.205643+10,10,0,447,partially correct
9099,"select count(*)

from person p

where exists (select * from writer as w where p.year_born=1935);",2018-08-31 01:40:10.693488+10,1,0,223,partially correct
9100,"select count(*)

from person p

where exists (select * from writer as w where p.year_born=1935 and w.id=p.id);",2018-08-31 01:40:38.216759+10,1,1,223,correct
9101,"select count(*)
from (writer_award natural join writer natural join person) as m
where lower(m.first_name) = 'woody' and lower(m.last_name) = 'allen' and year_of_award > 1990 and year_of_award < 1996 and lower(result) = 'won';",2018-08-31 01:41:02.141588+10,9,1,440,correct
9102,"SELECT ra.title,ra.production_year,pw.first_name,pw.last_name
FROM Movie_Award AS ra, (person INNER JOIN director on person.id = director.id) AS pw
WHERE lower(ra.award_name) = 'bafta film award' AND lower(ra.category) = 'best film' AND ra.result = 'won' AND  pw.title = ra.title;",2018-08-31 01:41:09.884165+10,8,1,59,correct
9103,SELECT COUNT (person.id) FROM person WHERE NOT EXISTS (SELECT * FROM director WHERE director.id=person.id); ,2018-08-31 01:41:35.575149+10,12,1,210,correct
9104,"select role.id from role 
join movie on movie.title = role.title and movie.production_year = role.production_year
join scene on movie.title = scene.title and movie.production_year = scene.production_year
join appearance on appearance.title = scene.title and appearance.scene_no = scene.scene_no

where lower(movie.title) = 'psycho' and movie.production_year = '1960'

group by role.id
having count(*) = 1;",2018-08-31 01:41:53.05403+10,10,0,447,partially correct
9105,"select count(*)

from (Writer_Award  natural join person natural join writer) as p

where  p.first_name='Woody' and p.last_name='Allen' and p.year_of_award>=1991 and p.year_of_award<=1995;",2018-08-31 01:42:04.607634+10,9,0,223,partially correct
9106,"SELECT id,first_name,last_name
FROM person
WHERE Exists( MAX(year_born));",2018-08-31 01:42:05.322794+10,7,0,287,noninterpretable
9107,SELECT ;,2018-08-31 01:42:22.178051+10,8,0,380,noninterpretable
9108,"SLELECT;
",2018-08-31 01:42:49.066732+10,13,0,352,noninterpretable
9109,"select count(*)

from (Writer_Award  natural join person natural join writer) as p

where  p.first_name='Woody' and p.last_name='Allen' and p.year_of_award>=1991 and p.year_of_award<=1995 and lower(result)='won';",2018-08-31 01:42:51.42338+10,9,1,223,correct
9110,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born= (SELECT MAX(year_born)
					FROM person);",2018-08-31 01:43:40.439421+10,7,1,287,correct
9111,"select *
from movie;",2018-08-31 01:44:38.305976+10,11,0,225,partially correct
9112,"

SELECT count(*) from

	(select title,production_year from
		
		(Select title,production_year from movie
			except 
		
			Select title,production_year from movie_award
			union
			Select title,production_year from director_award
			union
			Select title,production_year from crew_award
			union
			Select title,production_year from writer_award
			union
			Select title,production_year from actor_award Where lower(result)='won')  as t2) as t3
		

;",2018-08-31 01:44:39.678048+10,11,0,16,partially correct
9113,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
	from movie_award
	where lower(award_name) = 'bafta film award'
	and lower(category) = 'best film'
	and lower(result) = 'won') as ma,
	director as d,
	person as p
where ma.title = d.title
	and ma.production_year = d.production_year
	and d.id = p.id;",2018-08-31 01:45:04.253345+10,8,1,276,correct
9114,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 01:45:45.364711+10,5,1,418,correct
9115,"select count(*)
from movie m
where not exists (select ma.title
from movie_award ma where lower(result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
union 
select ca.title 
from crew_award ca where lower(result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
union
select da.title
from director_award da where lower(result) = 'won' and da.title = m.title and da.production_year = m.production_year
union 
select wa.title
from writer_award wa where lower(result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
union
select aa.title
from actor_award aa where lower(result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);

",2018-08-31 01:46:22.333917+10,11,1,163,correct
9116,select country from Restriction_Category;,2018-08-31 01:46:29.193483+10,6,0,447,partially correct
9117,"SELECT COUNT(*)
FROM person
WHERE person.id NOT IN (
SELECT director.id
FROM director
);",2018-08-31 01:47:31.651482+10,12,1,327,correct
9118,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 01:47:34.301379+10,13,1,352,correct
9119,"select country from Restriction
where lower(title) = 'shakespeare in love'
and description = 'M';",2018-08-31 01:47:59.633904+10,6,1,447,correct
9120,"SELECT title, production_year, first_name, last_name
FROM (Movie_Award m NATURAL JOIN Director d NATURAL JOIN Person p) AS mdp
WHERE mdp.award_name = BAFTA Film Award AND category = 'Best Film' AND m.title = d.title AND d.id = p.id;",2018-08-31 01:49:02.409844+10,8,0,287,noninterpretable
9121,"

SELECT count(*) from

	(Select title,production_year from movie 
		Except
		
		(Select title,production_year from 
			 
		
			(Select title,production_year from movie_award Where lower(result)='won'
			union
			Select title,production_year from director_award Where lower(result)='won' 
			union
			Select title,production_year from crew_award Where lower(result)='won'
			union
			Select title,production_year from writer_award Where lower(result)='won'
			union
			Select title,production_year from actor_award Where lower(result)='won') 
		
	as t1) 
		as t2) as t3
		

;",2018-08-31 01:49:17.304606+10,11,0,16,noninterpretable
9122,"SELECT title, production_year, p.first_name, p.last_name
FROM movie, director, person as p
WHERE title=(SELECT title
             FROM movie_award ma
			 WHERE lower(ma.award_name)='bafta film award'
                  AND   lower(ma.category)='best film')
AND movie.title=director.title
AND director.id=p.id;",2018-08-31 01:50:04.702222+10,8,0,328,noninterpretable
9123,"select r.country
from restriction r
where (r.title = 'Shakespeare in Love' and r.description = 'M');",2018-08-31 01:51:17.949597+10,6,1,418,correct
9124,"select count(*),m.production_year
from movie as m
where m.production_year>=1991 and m.production_year<=1993
group by production_year;",2018-08-31 01:51:44.0861+10,2,1,223,correct
9125,"SELECT*;
",2018-08-31 01:52:23.966761+10,9,0,380,noninterpretable
9126,"select m.production_year,count(*)
from movie as m
where m.production_year>=1991 and m.production_year<=1993
group by production_year;",2018-08-31 01:52:35.236837+10,2,1,223,correct
9127,"select p.id,p.first_name,p.last_name
from person p
where p.max year_born;",2018-08-31 01:53:10.615079+10,7,0,418,noninterpretable
9128,"select person.id,person.first_name,person.last_name from person
where person.year_born;",2018-08-31 01:53:21.541997+10,7,0,447,partially correct
9129,"select id
from (role natural join appearance) as m
where lower(m.title) = 'psycho' and production_year = 1960
group by m.scene_no
having count(m.scene_no)=1;",2018-08-31 01:53:49.889158+10,10,0,440,partially correct
9130,"SELECT first_name fn 'KEVIN' AND last_name ln 'WILLIAMSON'
FROM movies m (movie m NATURAL JOIN director d) 
GROUP BY title, production_year;",2018-08-31 01:53:59.315613+10,5,0,445,noninterpretable
9224,"select id, award_name, year_of_award, category
from director_award natural join director
where not lower(result) = ""won""

;",2018-08-31 02:49:48.246008+10,13,1,337,correct
9131,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (SELECT title, production_year
             FROM movie_award 
			 WHERE lower(award_name)='bafta film award'
                  AND   lower(category)='best film'
		       AND   lower(result)='won') as ma,
	director as d,
	person as p
WHERE ma.title=d.title
AND d.id=p.id;",2018-08-31 01:54:17.592362+10,8,1,328,correct
9132,"select person.id,person.first_name,person.last_name from person
where person.year_born = (select max(person.year_born) from person);",2018-08-31 01:54:19.412134+10,7,1,447,correct
9133,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select
max(year_born)
from 
person);",2018-08-31 01:54:23.558334+10,7,1,418,correct
9134,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 01:54:34.65262+10,8,1,287,correct
9135,"


Select count(*) from
	(Select title,production_year from movie 
		Except
		
		Select title,production_year from 	 
		
			(Select title,production_year from movie_award Where lower(result)='won'
			union
			Select title,production_year from director_award Where lower(result)='won' 
			union
			Select title,production_year from crew_award Where lower(result)='won'
			union
			Select title,production_year from writer_award Where lower(result)='won'
			union
			Select title,production_year from actor_award Where lower(result)='won') 
		
		
	as t1)
as t2;",2018-08-31 01:54:34.930804+10,11,1,16,correct
9136,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 01:54:38.858783+10,14,0,352,partially correct
9137,"select count(*)
from person as p
where not exists (select * from director as d where d.id=p.id);",2018-08-31 01:55:20.133995+10,12,1,223,correct
9138,"select count(*)
from (select id
	from writer_award
	where production_year >= 1991
	and production_year <= 1995
	and lower(result) = 'won') as wa,
	person as p
where wa.id = p.id;",2018-08-31 01:55:51.92198+10,9,0,276,partially correct
9139,"SELECT COUNT(*) FROM PERSON,WRITER
WHERE year_born=1935 AND person.id=writer.id;",2018-08-31 01:56:26.453496+10,1,0,335,partially correct
9140,"select ma.title,
	ma.production_year,
	d.id,d.first_name,d.last_name
from movie_award as ma,
	(director natural join person) as d
where 
	d.title =ma.title
	and d.production_year=ma.production_year
	and lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won';",2018-08-31 01:56:26.681326+10,8,0,149,partially correct
9141,"select ma.title,
	ma.production_year,
	d.id,d.first_name,d.last_name
from movie_award as ma,
	(director natural join person) as d
where 
	d.title =ma.title
	and d.production_year=ma.production_year
	and lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won';",2018-08-31 01:56:26.852315+10,8,0,149,partially correct
9142,"Select ma.title, ma.production_year, p.first_name,p.last_name
From movie_award ma, director d, person p
Where ma.title = d.title
And ma.production_year = d.production_year
And d.id= p.id
And lower(category) = 'best film'
And lower(award_name)= 'bafta film award'
And lower(result)= 'won' ;
",2018-08-31 01:56:32.862066+10,8,1,400,correct
9143,"select count(*)

FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND p.year_born = 1935;",2018-08-31 01:56:57.188019+10,1,0,418,partially correct
9144,"select ma.title,
	ma.production_year,
	d.first_name,d.last_name
from movie_award as ma,
	(director natural join person) as d
where 
	d.title =ma.title
	and d.production_year=ma.production_year
	and lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won';",2018-08-31 01:57:11.107631+10,8,1,149,correct
9145,"select id
from (role natural join appearance) as m
where lower(m.title) = 'psycho' and production_year = 1960
group by id
having count(id) = 1;",2018-08-31 01:57:11.509605+10,10,1,440,correct
9146,select * from movie;,2018-08-31 01:57:27.53238+10,3,0,225,partially correct
9147,"select w.count(*)

FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND p.year_born = 1935;
",2018-08-31 01:57:31.063468+10,1,0,418,noninterpretable
9148,"SELECT id, first_name, last_name FROM person, (SELECT director.id AS b FROM director,writer GROUP BY director.id HAVING director.title= writer.title AND count(director.id)>1) AS a WHERE person.id=b;",2018-08-31 01:57:56.669738+10,4,0,210,partially correct
9149,select * from movie;,2018-08-31 01:58:26.392967+10,13,0,225,partially correct
9150,select * from movie;,2018-08-31 01:58:32.515019+10,13,0,225,partially correct
9151,select * from movie;,2018-08-31 01:59:29.736046+10,14,0,225,partially correct
9152,"
Select count(*) from(

	Select title,production_year from movie 
		where (title,production_year) not in
		
		(Select title,production_year from 	 
		
			(Select title,production_year from movie_award Where lower(result)='won'
			union
			Select title,production_year from director_award Where lower(result)='won' 
			union
			Select title,production_year from crew_award Where lower(result)='won'
			union
			Select title,production_year from writer_award Where lower(result)='won'
			union
			Select title,production_year from actor_award Where lower(result)='won') as t1
		)) as t2;",2018-08-31 01:59:53.874886+10,11,1,16,correct
9153,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
        wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 02:00:21.554515+10,9,0,380,partially correct
9154,select * from movie;,2018-08-31 02:00:33.623754+10,15,0,225,partially correct
9155,select * from movie;,2018-08-31 02:00:34.464827+10,15,0,225,partially correct
9156,"SELECT count(*)
FROM writer_award as wa
WHERE id=(SELECT id 
       FROM person p
	   WHERE lower(p.first_name)='woody'
	   AND   lower(p.last_name)='allen')
AND wa.year_of_award>1990
AND  wa.year_of_award<1996;",2018-08-31 02:00:54.099444+10,9,0,328,partially correct
9157,SELECT;,2018-08-31 02:01:57.18522+10,10,0,380,noninterpretable
9158,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 02:01:57.323911+10,14,1,369,correct
9159,"SELECT count(*)
FROM writer_award as wa
WHERE id=(SELECT id 
       FROM person p
	   WHERE lower(p.first_name)='woody'
	   AND   lower(p.last_name)='allen')
AND lower(wa.result)='won'
AND wa.year_of_award>1990
AND  wa.year_of_award<1996;",2018-08-31 02:02:36.861645+10,9,1,328,correct
9160,"select count(*)
from (writer_award natural join person) as p
where p.first_name='Woody' and p.last_name='Allen'
	and p.year_of_award between 1991 and 1995
group by p.id;
",2018-08-31 02:03:06.044435+10,9,0,149,partially correct
9161,"
WHERE lower(first_name)='woody' AND lower(last_name)='allen'AND w.id =p.id AND production_year>1990 AND production_year<1996);",2018-08-31 02:03:29.938027+10,9,0,287,noninterpretable
9190,"select p.id 
from person as p
where p.year_born in(select max(pp.year_born)
				from person as pp
				where pp.year_born<(
					select max(ppp.year_born)
					from person ppp)
				);",2018-08-31 02:21:46.519984+10,3,1,149,correct
9162,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 02:03:56.079654+10,14,0,352,partially correct
9163,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 02:04:22.348937+10,14,1,352,correct
9164,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 02:04:37.965424+10,9,1,287,correct
9165,SELECT;,2018-08-31 02:04:52.366753+10,15,0,352,noninterpretable
9166,"SELECT count(*) from person p, writer w where p.id = w.id and p.year_born = '1935';",2018-08-31 02:05:00.325008+10,1,0,213,partially correct
9167,"select *
from (writer_award natural join person) as p
where p.first_name='Woody' and p.last_name='Allen'
	and p.year_of_award between 1991 and 1995;",2018-08-31 02:05:20.96155+10,9,0,149,partially correct
9168,"select p.id

from (select p.id, count(*) As nooftimes
	from director d, writer w, person p, movie m
	where (p.id = d.id and m.title = d.title and m.production_year = d.production_year)
	or (p.id = w.id and m.title = w.title and m.production_year = w.production_year)
	or (d.id = w.id and d.title = w.title and d.production_year = w.production_year and d.id =p.id)
	group by p.id) p

where p.nooftimes = (select Max(p.nooftimes)
				from (select p.id, count(*) As nooftimes
	from director d, writer w, person p, movie m
	where (p.id = d.id and m.title = d.title and m.production_year = d.production_year)
	or (p.id = w.id and m.title = w.title and m.production_year = w.production_year)
	or (d.id = w.id and d.title = w.title and d.production_year = w.production_year and d.id =p.id)
	group by p.id) p1);
",2018-08-31 02:05:48.066045+10,14,0,111,noninterpretable
9169,"select count(*) as number_of_award
from (select *
	from writer_award
	where year_of_award >= 1991
	and year_of_award <= 1995
	and lower(result) = 'won') as wa,
	person as p,
	writer as w
where wa.id = w.id
AND w.id = p.id
AND wa.title = w.title
AND wa.production_year = w.production_year
AND lower(p.first_name)= 'woody'
AND lower(p.last_name)= 'allen';",2018-08-31 02:06:19.955044+10,9,1,276,correct
9170,"SELECT person.id, person.first_name, person.last_name
FROM person, director
WHERE person.id=director.id and director.id IN (
	SELECT id
	FROM writer
	WHERE COUNT(*) > 2 GROUP BY writer.id 
);",2018-08-31 02:07:17.852444+10,4,0,327,noninterpretable
9171,"select count(*)
from (writer_award natural join person) as p
where p.first_name='Woody' and p.last_name='Allen'
	and lower(result)='won'
	and p.year_of_award between 1991 and 1995
group by p.id;
",2018-08-31 02:08:05.530507+10,9,1,149,correct
9172,"select p.id,p.first_name,p.last_name
from person as p,writer as w,director as d
where p.id=w.id and w.id=d.id and w.title=d.title and w.production_year=d.production_year
group by p.id
having count(*)>1;",2018-08-31 02:08:17.318448+10,4,1,223,correct
9173,"SELECT id, first_name, last_name FROM person, (SELECT writer.id AS b FROM director NATURAL JOIN writer GROUP BY director.id  HAVING count(*)>1) AS a WHERE person.id=b;",2018-08-31 02:09:32.624922+10,4,1,210,correct
9174,"SELECT 'Shakespeare in Love'
FROM movie
HAVING RESTRICTION = 'M'
GROUP BY country;",2018-08-31 02:10:04.291416+10,6,0,445,noninterpretable
9175,"select ar.id
from (appearance natural join role)as ar
where ar.title='Psycho'
	and ar.production_year=1960
group by ar.id
having count(ar.id)=1;


",2018-08-31 02:10:10.166132+10,10,1,149,correct
9176,"select w.title,w.production_year
from person as p,writer as w
where p.first_name='Kevin' and p.last_name='Williamson' and w.id=p.id;",2018-08-31 02:11:36.059462+10,5,1,223,correct
9177,"SELECT count(*) from person p where exists (select * from writer w, writer_award wa where w.id = p.id and  w.id = wa.id and 
w.title = wa.title and w.production_year = wa.production_year and p.year_born = 1938);",2018-08-31 02:11:37.127423+10,1,0,213,partially correct
9178,"SELECT id, first_name, last_name FROM person, (SELECT writer.id AS b FROM director NATURAL JOIN writer GROUP BY director.id  HAVING count(*)>1) AS a WHERE person.id=b;",2018-08-31 02:13:22.856241+10,4,1,210,correct
9179,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 02:13:28.299849+10,15,0,369,partially correct
9180,"select p.id,p.first_name,p.last_name
from person as p
where p.year_born=(select max(year_born) from person);",2018-08-31 02:15:09.761366+10,7,1,223,correct
9181,"SELECT person.first_name,person.last_name,role.title,role.production_year,role.description
FROM person,role, (SELECT role.id,COUNT(*) AS NoOfRoles
                   FROM role
			  GROUP BY role.id) x
WHERE role.id=person.id
      AND person.id=x.id
      AND x.NoOfRoles=
         (SELECT MAX(x1.NoOfRoles)
	     FROM (SELECT role.id,COUNT(*) AS NoOfRoles
                 FROM role
			GROUP BY role.id) x1);",2018-08-31 02:16:39.79756+10,15,1,369,correct
9182,"
select role.id

from role join Appearance on role.title = Appearance.title 
     
where lower(title) = 'psycho' and production_year = '1960'

Group by role.id

Having count(*) = 1;





",2018-08-31 02:17:34.572986+10,10,0,235,noninterpretable
9183,"
select role.id

from role join Appearance on role.title = Appearance.title 
     
where lower(role.title) = 'psycho' and role.production_year = '1960'

Group by role.id

Having count(*) = 1;





",2018-08-31 02:18:17.980819+10,10,0,235,partially correct
9184,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 02:19:01.617398+10,4,1,327,correct
9185,"SELECT COUNT(*)
FROM Person
WHERE Person.year_born = 1935;",2018-08-31 02:19:46.897296+10,1,0,443,partially correct
9186,"SELECT *
FROM person 
GROUP by id,first_name, last_name 
HAVING year_born < year_born;",2018-08-31 02:20:00.589463+10,7,0,445,partially correct
9187,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 02:20:44.688779+10,15,1,136,correct
9188,"SELECT title, production_year FROM writer, person WHERE writer.id=person.id AND first_name='Kevin' AND last_name='Williamson';",2018-08-31 02:20:47.278714+10,5,1,210,correct
9189,"SELECT title, production_year FROM writer, person WHERE writer.id=person.id AND first_name='Kevin' AND last_name='Williamson';",2018-08-31 02:20:55.680204+10,5,1,210,correct
9191,"SELECT movie.title, movie.production_year
FROM movie, writer, person p
WHERE writer.id = p.id AND p.first_name=""Kevin"" AND p.last_name = ""Williamson"" AND movie.title = writer.title AND movie.production_year = writer.production_year;

",2018-08-31 02:23:16.435875+10,5,1,327,correct
9192,SELECT country FROM restriction WHERE title='Shakespeare in Love' AND description='M';,2018-08-31 02:25:17.68714+10,6,1,210,correct
9193,"select x.id,
	x.award_name,
	x.year_of_award,
	x.category
from (person natural join director natural join director_award) as x
where lower(x.result)='nominated'
	and not exists(select da.id 
				from (director_award natural join director) as da
				where da.id=x.id
				and lower(da.result)='won');",2018-08-31 02:26:35.665458+10,13,1,149,correct
9194,"SELECT id
FROM (SELECT id,year_born
      FROM person
	 WHERE year_born < (SELECT MAX(year_born)
	                    FROM person)) AS p
WHERE p.year_born=(SELECT MAX(p1.year_born)
                   FROM (SELECT id,year_born
                         FROM person AS P
	                    WHERE year_born < (SELECT MAX(year_born)
	                                     FROM person))  p1);",2018-08-31 02:27:01.66372+10,3,1,369,correct
9195,"SELECT COUNT(*)
FROM WRITER
WHERE EXISTS( SELECT * FROM PERSON P
               WHERE P.id = WRITER.id AND PERSON.year_born = 1935);",2018-08-31 02:27:49.581558+10,1,0,443,noninterpretable
9196,"SELECT COUNT(*)
FROM movie
GROUP BY production_year
HAVING production_year>=1990 AND production_year<=1993;
",2018-08-31 02:28:18.602069+10,2,0,335,partially correct
9197,"
select role.id, count(role.id)

from role join Appearance on role.title = Appearance.title 
     and role.production_year= Appearance.production_year and Role.description=Appearance.description
     
where lower(role.title) = 'psycho' and role.production_year = '1960'

Group by role.id

Having count(*) = 1;




",2018-08-31 02:28:37.905894+10,10,0,235,partially correct
9198,"
select role.id

from role join Appearance on role.title = Appearance.title 
     and role.production_year= Appearance.production_year and Role.description=Appearance.description
     
where lower(role.title) = 'psycho' and role.production_year = '1960'

Group by role.id

Having count(*) = 1;




",2018-08-31 02:28:51.401693+10,10,1,235,correct
9199,"SELECT production_year,COUNT(*)
FROM movie
GROUP BY production_year
HAVING production_year>1990 AND production_year<=1993;
",2018-08-31 02:29:08.740826+10,2,1,335,correct
9200,"SELECT COUNT(*)
FROM person,director
WHERE person.id!=director.id;",2018-08-31 02:31:38.305587+10,12,0,335,partially correct
9201,"SELECT COUNT(*)
FROM (SELECT person.id 
        FROM WRITER,PERSON
		WHERE person.id = writer.id AND PERSON.year_born = 1935);
",2018-08-31 02:32:35.698106+10,1,0,443,partially correct
9202,"SELECT title, production_year, category = 'Best Film'
FROM Movie_Award
WHERE award_name = 'BAFTA Film Award';",2018-08-31 02:32:53.789534+10,8,0,445,partially correct
9203,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS(SELECT *FROM director WHERE person.id=director.id);",2018-08-31 02:33:19.98609+10,12,1,335,correct
9204,"SELECT COUNT(*)
FROM (SELECT person.id 
        FROM PERSON
		WHERE person.id = writer.id AND PERSON.year_born = 1935);
",2018-08-31 02:34:10.343776+10,1,0,443,noninterpretable
9205,"select id
from (
select max(year_born), id
from person
where year_born < ( select max(year_born)
				from person)
				);",2018-08-31 02:34:53.877119+10,3,1,337,correct
9206,"SELECT id,first_name,last_name
FROM person;",2018-08-31 02:36:10.992184+10,4,0,335,partially correct
9207,"SELECT country
FROM restriction
WHERE title=""Shakespeare in Love"" AND description=""M"";",2018-08-31 02:37:11.242383+10,6,1,327,correct
9208,;,2018-08-31 02:37:22.251799+10,1,0,220,noninterpretable
9209,"SELECT COUNT(*)
FROM (SELECT * 
        FROM person,writer
        WHERE person.id = writer.id AND person.year_born = 1935);
",2018-08-31 02:37:55.613586+10,1,0,443,partially correct
9210,"
select id
from (
select id,count(*)as number
from(select id,title,production_year from director
	union
	select id,title,production_year from writer
)as x
group by x.id
having x.number in (select max(x3.number)
			from (select id,count(*)as number
			from(select id,title,production_year from director
			union
			select id,title,production_year from writer
			)as x2
			group by x2.id)as x3))as w;
",2018-08-31 02:38:13.293604+10,14,0,149,noninterpretable
9211,"select count(title)
from movie
where title not in(select title
from movie_award
where lower(result) = 'won'
union
select title
from crew_award
where lower(result) = 'won'
union
select title
from director_award
where lower(result) = 'won'
union
select title
from writer_award
where lower(result) = 'won'
union
select title
from actor_award
where lower(result) = 'won');",2018-08-31 02:38:33.642555+10,11,0,440,partially correct
9212,"SELECT COUNT(*)
FROM (SELECT * 
        FROM person,writer
        WHERE person.id = writer.id AND person.year_born = 1935
	  GROUP BY person.id);
",2018-08-31 02:40:11.188185+10,1,1,443,correct
9213,"SELECT co.id,
FROM(
SELECT dw.id, count(*) AS c
FROM (
SELECT d.id, d.title, d.production_year
FROM director d
UNION
SELECT w.id, w.title, w.production_year
FROM writer w
) AS dw
GROUP BY dw.id) AS co
WHERE co.c = (SELECT MAX(co.c) FROM co);",2018-08-31 02:40:54.320612+10,14,0,373,noninterpretable
9214,"SELECT id, first_name, last_name FROM person, (SELECT max(year_born) AS b FROM person) AS c WHERE person.year_born =b;
",2018-08-31 02:40:55.44555+10,7,1,210,correct
9215,"select p.id

from (select p.id, count(*) As nooftimes
	from director d, writer w, person p, movie m
	where (p.id = d.id and m.title = d.title and m.production_year = d.production_year)
	or (p.id = w.id and m.title = w.title and m.production_year = w.production_year)
	or (d.id = w.id and d.title = w.title and d.production_year = w.production_year and d.id =p.id)
	group by p.id) p

where p.nooftimes = (select Max(p1.nooftimes)
				from (select p2.id, count(*) As nooftimes
	from director d, writer w, person p2, movie m
	where (p2.id = d.id and m.title = d.title and m.production_year = d.production_year)
	or (p2.id = w.id and m.title = w.title and m.production_year = w.production_year)
	or (d.id = w.id and d.title = w.title and d.production_year = w.production_year and d.id =p2.id)
	group by p2.id) p1);",2018-08-31 02:41:24.926221+10,14,0,111,partially correct
9216,"
select x1.id
from (
select x.id,count(*)as number
from(select id,title,production_year from director
	union
	select id,title,production_year from writer
)as x
group by x.id) x1
where x1.number in (select max(x3.number)
			from (select id,count(*)as number
			from(select id,title,production_year from director
			union
			select id,title,production_year from writer
			)as x2
			group by x2.id)as x3);
",2018-08-31 02:43:04.321295+10,14,1,149,correct
9217,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE MOVIE.production_year = 1993 or
      MOVIE.production_year = 1992 or 
      MOVIE.production_year = 1991
GROUP BY MOVIE.production_year;",2018-08-31 02:43:55.158485+10,2,1,443,correct
9218,"SELECT id
FROM writer_award
WHERE lower (first_name) = 'woody'
      lower (last_name) = 'allen'
	  WHERE production_year> 1990 AND production_year<1996;",2018-08-31 02:44:46.750414+10,9,0,445,noninterpretable
9219,"select count(*)

from movie m 


where not exists(
select title, production_year from movie_award ma where lower(ma.result)='won' and m.title=ma.title and m.production_year = ma.production_year

union 
select title, production_year from crew_award ca where lower(ca.result)='won' and m.title=ca.title and m.production_year = ca.production_year

union
select title, production_year from director_award da where lower(da.result)='won' and m.title=da.title and m.production_year = da.production_year
      
union 
select title, production_year from writer_award wa where lower(wa.result)='won' and m.title=wa.title and m.production_year = wa.production_year              
union
select title, production_year from actor_award aa where lower(aa.result)='won' and m.title=aa.title and m.production_year = aa.production_year

);",2018-08-31 02:45:06.608002+10,11,1,235,correct
9220,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
		   From writer w
		   WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 02:47:21.212342+10,1,1,145,correct
9221,"select count(*)
from writer,person
where writer.id=person.id
and year_born=1935;",2018-08-31 02:47:27.842624+10,1,0,207,partially correct
9225,"SELECT title,production_year
FROM director
WHERE director.id=person.id
GROUP BY title
HAVING person.first_name=""KEVIN"" and person.last_name=""Williamson"";
",2018-08-31 02:50:13.993553+10,5,0,335,noninterpretable
9226,"select count(*)
from person as p
where exists(
select * from writer where writer.id= p.id and p.year_born=1935);",2018-08-31 02:50:28.682997+10,1,1,207,correct
9227,"SELECT title, production_year FROM movie_award where result='bafta film award' AND category='best film';",2018-08-31 02:51:26.002556+10,8,0,210,partially correct
9228,select count(*) from Person p join (select distinct id from Writer) q on p.id = q.id where p.year_born = 1935;,2018-08-31 02:51:31.046782+10,1,1,449,correct
9229,"Select count(production_year)as number_of_movies , production_year 
from movie
where production_year in (1993,1992,1991)
group by production_year;
",2018-08-31 02:52:30.674478+10,2,1,45,correct
9230,"select count(*) from person
where year_born=1935;",2018-08-31 02:52:55.59433+10,1,0,131,partially correct
9231,"Select production_year, count(production_year)as number_of_movies 
from movie
where production_year in (1993,1992,1991)
group by production_year;
",2018-08-31 02:53:43.035749+10,2,1,45,correct
9232,"SELECT country 
FROM restriction
WHERE title=lower(""Shakespeare in Love"") AND description=""M"";",2018-08-31 02:53:51.137396+10,6,0,335,partially correct
9233,"select production_year,count(*)
from movie
group by production_year;",2018-08-31 02:54:02.722975+10,2,0,207,partially correct
9234,"SELECT m.production_year, count(*)
FROM movie m
WHERE m.production_year = 1993 or m.production_year = 1992 or m.production_year = 1991
GROUP BY m.production_year;",2018-08-31 02:54:07.624179+10,2,1,145,correct
9235,"SELECT country 
FROM restriction
WHERE lower(title)=""Shakespeare in Love"" AND description=""M"";",2018-08-31 02:54:34.62176+10,6,0,335,partially correct
9236,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from (select r.id, r.title, r.production_year, r.description
	from role r inner join person p on r.id = p.id
	group by r.id;",2018-08-31 02:54:51.378599+10,15,0,111,noninterpretable
9237,"SELECT COUNT(*)
FROM person
WHERE person.id not in director;",2018-08-31 02:54:55.427861+10,12,0,443,noninterpretable
9238,"SELECT country 
FROM restriction
WHERE lower(title)='Shakespeare in Love' AND description=""M"";",2018-08-31 02:55:11.031521+10,6,0,335,partially correct
9239,"select count(*), production_year from Movie where production_year IN (1992, 1991, 1993) group by 2;",2018-08-31 02:55:43.395283+10,2,1,449,correct
9240,"

select aid,bid from
(select aid,bid,count(*) as s
from(select w1.id as aid,w2.id as bid
from writer w1,writer w2
where w1.title=w2.title and w1.production_year=w2.production_year and w1.id!=w2.id and w1.title in
(select a.title
from(select title,production_year,count(*) as num
from writer 
group by title,production_year
having num>1)as a))
group by aid,bid)as b
where b.s= (select max(s)
from (select aid,bid,count(*) as s
from(select w1.id as aid,w2.id as bid
from writer w1,writer w2
where w1.title=w2.title and w1.production_year=w2.production_year and w1.id!=w2.id and w1.title in
(select a.title
from(select title,production_year,count(*) as num
from writer 
group by title,production_year
having num>1)as a))
group by aid,bid));",2018-08-31 02:56:31.391641+10,1,0,64,partially correct
9241,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 02:56:43.024082+10,14,1,373,correct
9242,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id = d.id);",2018-08-31 02:56:49.592093+10,12,1,443,correct
9243,"select production_year, count(*) from Movie where production_year IN (1992, 1991, 1993) group by 1;",2018-08-31 02:57:30.577145+10,2,1,449,correct
9244,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT *
			 FROM director d
			 WHERE d.id = p.id);",2018-08-31 02:57:41.372244+10,12,1,145,correct
9245,"Select production_year, count(*) as noofmov,
From movie
where production year in (1993,1992,1992);",2018-08-31 02:58:05.404832+10,2,0,131,noninterpretable
9246,"select production_year ,count(*)
from movie
where production_year=1993
or production_year=1992
or production_year=1991
group by production_year
order by production_year desc;",2018-08-31 02:58:13.287533+10,2,1,207,correct
9247,"SELECT
    country
FROM
    restriction
WHERE
    title = 'Shakespeare in Love'
    AND description = 'M';",2018-08-31 02:58:42.757419+10,6,1,335,correct
9248,Select count(*) from Person p left outer join (select distinct id from Director) q on p.id = q.id where q.id is null;,2018-08-31 02:59:33.670988+10,12,1,449,correct
9249,select count(*) not exists;,2018-08-31 03:00:03.572354+10,11,0,65,noninterpretable
9250,"SELECT count(*) from person p where exists (select * from writer w where w.id = p.id and p.year_born = 1935);
",2018-08-31 03:00:13.894017+10,1,1,213,correct
9251,"SELECT id,first_name,last_name
FROM person
WHERE(year_born=MAX(year_born));",2018-08-31 03:00:33.659502+10,7,0,335,noninterpretable
9252,select *;,2018-08-31 03:01:20.864658+10,12,0,131,noninterpretable
9253,"
where person.id in
(Select director.id
from director
where director.id not in ( person.id))
;",2018-08-31 03:01:29.848631+10,12,0,45,noninterpretable
9254,select*;,2018-08-31 03:02:29.019521+10,4,0,131,noninterpretable
9255,"SELECT a.title, a.production_year, p.first_name, p.last_name FROM (SELECT title, production_year 
FROM movie_award where lower(award_name)='bafta film award' AND lower(category)='best film' AND result='won') AS a,
person AS p, director AS d WHERE a.title=d.title AND a.production_year=d.production_year AND d.id=p.id;",2018-08-31 03:03:29.509435+10,8,1,210,correct
9256,"select p.id, first_name, last_name from person p
join (select w.id from writer w join director d on w.id = d.id and w.title = d.title group by 1 having count(*) > 2)r
on r.id = p.id;",2018-08-31 03:03:53.038732+10,4,0,449,partially correct
9257,"


select p.id

from person p 

order by p.year_born desc 

limit 1 offset 1;















",2018-08-31 03:04:00.425583+10,3,1,235,correct
9258,"SELECT first_name,last_name,title,production_year
FROM movie INNER JOIN movie_award AS ij,person
WHERE description='BAFTA Film Award' and ij.;",2018-08-31 03:04:01.897503+10,8,0,335,noninterpretable
9259,"Select count(*)
from person
where person.id not in
(Select director.id
from director
where director.id = person.id);
",2018-08-31 03:05:17.478732+10,12,1,45,correct
9260,"SELECT movie_award.title, movie_award.production_year, first_name, last_name
FROM movie_award, director, person
WHERE person.id=director.id AND award_name=""BAFTA Film Award"" AND category=""Best Film"" AND director.title=movie_award.title AND director.production_year=movie_award.production_year;",2018-08-31 03:06:16.706916+10,8,0,327,partially correct
9261,"SELECT COUNT(*)
FROM person,writer
WHERE person.id=writer.id AND year_born=1935;",2018-08-31 03:06:17.600254+10,1,0,335,partially correct
9262,"SELECT id,first_name,last_name
FROM person p
WHERE EXISTS(SELECT * FROM writer w ,director d WHERE d.id = w.id
                                          AND d.title = w.title
                                          AND d.production_year = w.production_year)
GROUP BY p.id
HAVING COUNT(*)>=2;",2018-08-31 03:07:22.197949+10,4,0,443,partially correct
9263,"select p.first_name,
	 p.last_name,
	 r.title,
	 r.production_year,
	 r.description
from person as p,
	role as r,
	(select rp.id,count(*) as number
	from (person natural join role)as rp) as x

where x.id=p.id
	and r.id=p.id
	and x.number in(select max(x1.number)
				from (select rp.id,count(*) as number
					from (person natural join role)as rp) as x1
	);
",2018-08-31 03:07:30.423773+10,15,0,149,partially correct
9301,"select person.id,first_name ,last_name
from person , (select  d.id, count(*) as c from director as d,writer as w
where d.id=w.id and d.title=w.title
group by d.id) as d
where person.id=d.id and d.c>1 ;
",2018-08-31 03:26:21.082303+10,4,1,207,correct
9264,"select p.first_name,
	 p.last_name,
	 r.title,
	 r.production_year,
	 r.description
from person as p,
	role as r,
	(select rp.id,count(*) as number
	from (person natural join role)as rp) as x

where x.id=p.id
	and r.id=p.id
	and x.number in(select max(x1.number)
				from (select rp.id,count(*) as number
					from (person natural join role)as rp) as x1
	);
",2018-08-31 03:07:39.45352+10,15,0,149,partially correct
9265,"Select title, production_year
from movie, writer
where writer w. id=person p. id
and first_name=kevin, last_name=williamson;",2018-08-31 03:07:40.777772+10,5,0,131,noninterpretable
9266,"select p.first_name,p.last_name,ma.title,ma.production_year
from person p,Director d, Movie_Award ma
where p.id=d.id 
and d.title=ma.title 
and d.production_year=ma.production_year 
and lower(ma.result)='won' 
and lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award';",2018-08-31 03:07:49.553852+10,8,1,223,correct
9267,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 03:08:05.818227+10,15,1,111,correct
9268,"SELECT id_c.id
FROM
(SELECT pr.id, count(*) AS c
FROM (person p NATURAL JOIN role r) AS pr
GROUP BY pr.id) AS id_c
WHERE id_c.id = (
SELECT MAX(id_c1.c) FROM (SELECT pr.id, count(*) AS c
FROM (person p NATURAL JOIN role r) AS pr
GROUP BY pr.id) AS id_c1
);",2018-08-31 03:08:15.30699+10,15,0,373,partially correct
9269,"select count(*)
from person,director
where person.id != director.id;",2018-08-31 03:08:33.29304+10,12,0,207,partially correct
9270,"select ma.title,ma.production_year,p.first_name,p.last_name
from person p,Director d, Movie_Award ma
where p.id=d.id 
and d.title=ma.title 
and d.production_year=ma.production_year 
and lower(ma.result)='won' 
and lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award';",2018-08-31 03:09:10.677367+10,8,1,223,correct
9271,"SELECT d.id, d.first_name, d.last_name
FROM (SELECT *
	FROM person p, director d
	WHERE p.id = d.id) d
WHERE EXISTS (SELECT *
		   FROM writer w
		   WHERE w.title = d.title AND w.id = d.id
		   HAVING COUNT(*)>2);",2018-08-31 03:09:27.549131+10,4,0,145,noninterpretable
9272,select r.country;,2018-08-31 03:09:37.279544+10,6,0,131,noninterpretable
9273,select;,2018-08-31 03:10:47.561373+10,7,0,131,noninterpretable
9274,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 03:10:49.037259+10,15,1,373,correct
9275,"select p.id, first_name, last_name from person p join
 (select w.id  from writer w join director d on w.id = d.id and w.title = d.title group by 1 having count(*)>1)q
 on p.id = q.id;",2018-08-31 03:11:23.175741+10,4,1,449,correct
9276,"select count(*)
from person
where not exists (select * from director where person.id=director.id);",2018-08-31 03:11:35.13313+10,12,1,207,correct
9277,select;,2018-08-31 03:11:40.944166+10,8,0,131,noninterpretable
9278,"SELECT id,first_name,last_name
FROM (person natural join writer natural join director) as wd
group by wd.id
having count(*)>=2;
",2018-08-31 03:11:53.245982+10,4,1,443,correct
9279,;,2018-08-31 03:12:27.373454+10,9,0,131,noninterpretable
9280,;,2018-08-31 03:13:23.409606+10,10,0,131,noninterpretable
9281,"select count(*)
from person p,Writer_Award wa
where p.id=wa.id
 and lower(wa.result)='won'
 and p.first_name='Woody'
 and p.last_name='Allen'
 and year_of_award>=1991 and year_of_award<=1995;",2018-08-31 03:14:14.024389+10,9,1,223,correct
9282,;,2018-08-31 03:14:26.324666+10,3,0,131,noninterpretable
9283,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-31 03:14:38.763981+10,4,1,145,correct
9284,"select id from (

select id, max(c)

from(

select distinct person.id as id, count(title) as c

from person left join director

on person.id = director.id

group by person.id))

;",2018-08-31 03:14:57.31209+10,14,0,337,partially correct
9285,"select title, production_year from writer w join person p on p.id = w.id 
where p.first_name = 'Kevin' and last_name = 'Williamson';",2018-08-31 03:14:59.832683+10,5,1,449,correct
9286,"select count(*)
from movie m
where not exists(select title,production_year
from movie_award ma
where lower(result) = 'won' and m.title = ma.title and m.production_year = ma.production_year
union 
select title,production_year
from crew_award ca
where lower(result) = 'won' and m.title = ca.title and m.production_year = ca.production_year
union 
select title,production_year
from director_award da
where lower(result) = 'won' and m.title = da.title and m.production_year = da.production_year
union 
select title,production_year
from writer_award wa
where lower(result) = 'won' and m.title = wa.title and m.production_year = wa.production_year
union 
select title,production_year
from actor_award aa
where lower(result) = 'won' and m.title = aa.title and m.production_year = aa.production_year);",2018-08-31 03:15:07.307407+10,11,1,440,correct
9287,;,2018-08-31 03:15:53.838815+10,13,0,131,noninterpretable
9288,"SELECT title,production_year
FROM (movie natural join writer natural join person) as mwp
WHERE lower(mwp.first_name)=""kevin"" AND lower(mwp.last_name)=""williamson"";",2018-08-31 03:16:17.504632+10,5,1,443,correct
9289,;,2018-08-31 03:17:31.61499+10,14,0,131,noninterpretable
9290,"select country from Restriction where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-31 03:17:39.837738+10,6,1,449,correct
9291,;,2018-08-31 03:18:52.429209+10,15,0,131,noninterpretable
9292,"select count(*)
from (writer_award natural join person) as m
where lower(m.first_name) = 'woody' and lower(m.last_name) = 'allen' and year_of_award > 1990 and year_of_award < 1996 and lower(result) = 'won';",2018-08-31 03:19:18.235039+10,9,1,440,correct
9293,"select id, first_name, last_name from person where year_born in (select min(year_born) from person);",2018-08-31 03:19:21.987708+10,7,0,449,partially correct
9294,"SELECT country FROM restriction r
WHERE lower(r.title)='shakespeare in love' AND lower(r.description) = 'm';",2018-08-31 03:19:39.455582+10,6,1,443,correct
9295,"select id, first_name, last_name from person where year_born in (select max(year_born) from person);",2018-08-31 03:20:04.690823+10,7,1,449,correct
9296,SELECT country FROM restriction where (lower(description) = 'm' and lower(title) = 'shakespeare in love');,2018-08-31 03:23:43.306354+10,6,1,213,correct
9297,"SELECT count(*) FROM writer_award GROUP BY writer_award.id HAVING writer_award.id = (SELECT person.id  FROM person WHERE first_name='Woody' AND last_name='Allen')
 AND year_of_award >=1991 AND year_of_award <=1995;",2018-08-31 03:23:55.305144+10,9,0,210,partially correct
9298,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born = (SELECT MIN(age) FROM(SELECT year_born AS age FROM person p1));",2018-08-31 03:24:02.264781+10,7,0,443,partially correct
9299,"select r.id
from role r,appearance a,scene s
where a.title=s.title 
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.title=r.title
and a.production_year=r.production_year
and a.description=r.description 
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 03:24:12.863872+10,10,1,223,correct
9300,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born = (SELECT MAX(age) FROM(SELECT year_born AS age FROM person p1));",2018-08-31 03:24:44.085069+10,7,1,443,correct
9338,"SELECT COUNT(*) FROM WRITER WHERE id IN( SELECT id FROM PERSON WHERE year_born = 1935);
",2018-08-31 04:39:20.637696+10,1,0,231,partially correct
9302,"select m.title, m.production_year, p.first_name, p.last_name  from movie m 
join director d
on m.production_year = d.production_year and m.title = d.title
join person p
on p.id = d.id
join Movie_Award ma
on m.production_year = ma.production_year and m.title = ma.title
where   (award_name) = 'BAFTA Film Award' and category = 'best film';",2018-08-31 03:29:40.526809+10,8,0,449,partially correct
9303,"select m.title, m.production_year, p.first_name, p.last_name  from movie m 
join director d
on m.production_year = d.production_year and m.title = d.title
join person p
on p.id = d.id
join Movie_Award ma
on m.production_year = ma.production_year and m.title = ma.title
where   (award_name) = 'BAFTA Film Award' and category = ""best film"" and ma.result = ""won"";",2018-08-31 03:32:04.405006+10,8,1,449,correct
9304,"select title, production_year
from writer, (select p.id
from person as p
where p.first_name='Kevin'
and p.last_name= 'Williamson') as n
where writer.id=n.id;",2018-08-31 03:32:20.488504+10,5,1,207,correct
9305,"Select country
from restriction
where description = 'M' and title = 'Shakespeare in Love';",2018-08-31 03:33:28.743037+10,6,1,45,correct
9306,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 03:34:21.552994+10,14,1,111,correct
9307,"select country
from restriction
where description ='M'
and title= 'Shakespeare in Love';",2018-08-31 03:35:35.707691+10,6,1,207,correct
9308,"select ycount(*) from 
Writer_Award wd join person p
on p.id = wd.id
where first_name = ""Woody"" and last_name = ""Allen""
and year_of_award >= 1991 and year_of_award <= 1995
and result = ""won"";",2018-08-31 03:35:56.333648+10,9,0,449,noninterpretable
9309,"select count(*) from 
Writer_Award wd join person p
on p.id = wd.id
where first_name = ""Woody"" and last_name = ""Allen""
and year_of_award >= 1991 and year_of_award <= 1995
and result = ""won"";",2018-08-31 03:36:12.050643+10,9,1,449,correct
9310,"SELECT COUNT(*)
FROM writer_award, person
WHERE year_of_award IN (1991, 1992, 1993, 1994, 1995) AND writer_award.result=""won"" AND writer_award.id=person.id AND person.first_name=""Woody"" AND person.last_name=""Allen"";",2018-08-31 03:36:32.338304+10,9,1,327,correct
9311,"select person.id, person.first_name, person.last_name
from person
order by year_born
limit 1;",2018-08-31 03:36:35.19825+10,7,0,45,partially correct
9312,"select person.id, person.first_name, person.last_name
from person
order by year_born DESC
limit 1;",2018-08-31 03:37:54.283613+10,7,1,45,correct
9313,"select id 
from person p3
where p3.year_born = (select max(year_born) from (select *
from person p2
where p2.year_born < (select max(year_born) from person)));",2018-08-31 03:38:00.867594+10,3,1,440,correct
9314,"SELECT  count(*) FROM writer_award WHERE writer_award.id = (SELECT person.id  FROM person WHERE first_name='Woody' AND last_name='Allen')
 AND year_of_award >=1991 AND year_of_award <=1995 AND writer_award.result='won' GROUP BY writer_award.id;",2018-08-31 03:41:57.397655+10,9,1,210,correct
9315,"Select title, production_year
from movie_award
where award_name = 'BAFTA Film Award'
and category = 'best film';

",2018-08-31 03:44:00.122656+10,8,0,45,partially correct
9316,"SELECT id
FROM role
GROUP BY (id)
Having COUNT(*)=1;",2018-08-31 03:45:12.030199+10,10,0,327,partially correct
9317,;,2018-08-31 03:52:18.085296+10,10,0,210,noninterpretable
9318,"SELECT ws.id, ws.first_name, ws.last_name from (director natural join writer natural join person) as ws group by ws.id, ws.first_name, ws.last_name having 
count(*) > 1;
",2018-08-31 03:59:54.865417+10,4,1,213,correct
9319,"Select Movie_Award.title, Movie_Award.production_year
from movie_award
where
award_name = 'BAFTA Film Award'and category = 'best film' and result = 'won';



",2018-08-31 04:06:34.881978+10,8,0,45,partially correct
9320,SELECT id FROM ROLE NATURAL JOIN SCENE;,2018-08-31 04:09:32.049006+10,10,0,50,partially correct
9321,"with youngest as (select id , year_born from person group by id) 

select id from person where year_born = (select max(year_born) from youngest) as maximum 

where (

select id from person where year_born = (select max(year_born) from youngest) as second_youngest 

and second_youngest < 

with youngest as (select id , year_born from person group by id) 

select id from person where year_born = (select max(year_born) from youngest) as maximum 



select id from person where year_born = (select max(year_born) from youngest) as max_year_born;



",2018-08-31 04:10:12.876263+10,3,0,65,noninterpretable
9322,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 04:10:47.999542+10,10,1,50,correct
9323,"SELECT COUNT(*)
FROM WRITER_AWARD wa, PERSON p
WHERE p.first_name = 'Woody' AND p.last_name = 'Allen' AND wa.production_year > 1990 AND wa.production_year < 1996;",2018-08-31 04:11:24.633188+10,9,0,50,partially correct
9324,"SELECT COUNT(*)
FROM WRITER_AWARD wa NATURAL JOIN PERSON p
WHERE p.first_name = 'Woody' AND p.last_name = 'Allen' AND wa.production_year > 1990 AND wa.production_year < 1996;",2018-08-31 04:11:49.015475+10,9,1,50,correct
9325,"SELECT wm.title, wm.production_year
FROM (movie m NATURAL JOIN writer w NATURAL JOIN person p) AS wm
WHERE wm.first_name = 'Kevin' AND wm.last_name = 'Williamson';",2018-08-31 04:12:24.917663+10,5,1,145,correct
9326,"SELECT wp.title, wp.production_year
FROM (writer w NATURAL JOIN person p) AS wp
WHERE wp.first_name = 'Kevin' AND wp.last_name = 'Williamson';",2018-08-31 04:14:15.105194+10,5,1,145,correct
9327,"SELECT w.title, w.production_year from writer w, person p  where w.id = p.id and (lower(p.first_name) = 'kevin' 
and lower(p.last_name) = 'williamson');",2018-08-31 04:15:00.101206+10,5,1,213,correct
9328,"select a.id,
	 a.first_name,
	 a.last_name
from (person natural join director) as a
where a.production_year=1960;
",2018-08-31 04:15:05.732883+10,15,0,149,partially correct
9329,"SELECT w.title, w.production_year from writer w, person p  where w.id = p.id and lower(p.first_name) = 'kevin' 
and lower(p.last_name) = 'williamson';",2018-08-31 04:15:35.686354+10,5,1,213,correct
9330,"select a.id,
	 a.first_name,
	 a.last_name
from (person natural join director) as a
where a.id=1;
",2018-08-31 04:16:24.772411+10,15,0,149,partially correct
9331,"Select count(*)
from writer_award
where year_of_award in ( 1991,1992,1993,1994,1995) and 
writer_award.id in (
	select writer.id
	from writer
	where writer.id in ( 
	select person.id
	from person
	where first_name = 'Woody' and last_name = 'Allen' ));",2018-08-31 04:16:27.737393+10,9,0,45,partially correct
9332,"Select count(*)
from writer_award
where year_of_award in ( 1991,1992,1993,1994,1995) and result = 'wow' and 
writer_award.id in (
	select writer.id
	from writer
	where writer.id in ( 
	select person.id
	from person
	where first_name = 'Woody' and last_name = 'Allen' ));",2018-08-31 04:17:16.962236+10,9,0,45,partially correct
9333,"Select count(*)
from writer_award
where year_of_award in ( 1991,1992,1993,1994,1995) and result = 'won' and 
writer_award.id in (
	select writer.id
	from writer
	where writer.id in ( 
	select person.id
	from person
	where first_name = 'Woody' and last_name = 'Allen' ));",2018-08-31 04:17:29.721523+10,9,1,45,correct
9334,"SELECT r.country
FROM restriction r
WHERE r.description = 'M' AND r.title = 'Shakespeare in Love';",2018-08-31 04:17:57.051861+10,6,1,145,correct
9335,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born = (SELECT MAX(*)    
			    FROM person p1
			    GROUP BY p1.year_born) 
				
				;",2018-08-31 04:24:46.407145+10,7,0,145,noninterpretable
9336,"SELECT p.id, p.first_name, p.last_name
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)    
			    FROM person p1
			    ) ;",2018-08-31 04:25:27.727669+10,7,1,145,correct
9337,;,2018-08-31 04:38:06.427417+10,11,0,327,noninterpretable
9339,"SELECT dm.title, dm.production_year, dm.first_name, dm.last_name
FROM (movie m NATURAL JOIN director d NATURAL JOIN person p) AS dm
WHERE ma.title = dm.title AND ma.award_name = (SELECT ma.award_name
											   FROM movie_award ma
											   WHERE ma.award_name = 'BAFTA Film Award');",2018-08-31 04:39:56.195111+10,8,0,145,noninterpretable
9340,"SELECT count(*)
FROM PERSON P
WHERE EXISTS(SELECT * FROM WRITER W WHERE W.ID = P.ID AND P.YEAR_BORN = 1935);
",2018-08-31 04:46:49.512426+10,1,1,231,correct
9341,SELECT ;,2018-08-31 04:50:59.575485+10,3,0,327,noninterpretable
9342,SELECT COUNT(*) PRODUCTION_YEAR FROM MOVIE_AWARD WHERE PRODUCTION_YEAR =1993 OR 1992 OR 1991;,2018-08-31 04:51:44.40352+10,2,0,231,partially correct
9343,SELECT COUNT(*) PRODUCTION_YEAR FROM MOVIE_AWARD WHERE PRODUCTION_YEAR =1993 OR 1992 OR 1991;,2018-08-31 04:51:52.757185+10,2,0,231,partially correct
9344,"select m.id , m.title , m.production_year, m.first_name, m.last_name 
from (person natural join director natural join movie_award) m 

where m.award_name='BAFTA Film Award' AND m.category='best film' AND m.result='won';",2018-08-31 04:54:40.826472+10,8,0,166,partially correct
9345,"SELECT id, award_name, year_of_award, category
FROM director_award da, director d
WHERE da.result!=""won"" AND d.title=da.title AND d.production_year=da.production_year;",2018-08-31 04:55:14.906692+10,13,1,327,correct
9346,"select m.title , m.production_year, m.first_name, m.last_name 
from (person natural join director natural join movie_award) m 

where m.award_name='BAFTA Film Award' AND m.category='best film' AND m.result='won';",2018-08-31 04:55:16.239796+10,8,1,166,correct
9347,"SELECT
    ma.title,
    ma.production_year,
    d.first_name,
    d.last_name
FROM (
        SELECT
            *
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    (director d NATURAL JOIN person p) AS d
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year;",2018-08-31 04:56:13.653089+10,8,1,145,correct
9348,"SELECT COUNT(*), PRODUCTION_YEAR FROM MOVIE WHERE PRODUCTION_YEAR IN(1991,1992,1993)
GROUP BY PRODUCTION_YEAR;",2018-08-31 04:56:21.345621+10,2,1,231,correct
9349,"SELECT
    ma.title,
    ma.production_year,
    d.first_name,
    d.last_name
FROM (
        SELECT
            *
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    (director d NATURAL JOIN person p) AS d
WHERE
    ma.title = d.title;",2018-08-31 04:56:33.183854+10,8,1,145,correct
9350,"SELECT PRODUCTION_YEAR ,COUNT(*) FROM MOVIE WHERE PRODUCTION_YEAR >1990 AND PRODUCTION_YEAR < 1994
GROUP BY PRODUCTION_YEAR;",2018-08-31 04:59:19.775208+10,2,1,231,correct
9351,SELECT COUNT(*) FROM PERSON WHERE ID NOT IN (SELECT ID FROM DIRECTOR);,2018-08-31 05:02:33.962605+10,12,1,231,correct
9352,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 05:06:33.797594+10,4,1,260,correct
9353,"SELECT COUNT(*)
FROM (writer w NATURAL JOIN person p) AS w,
	(SELECT *
	FROM writer_award 
	WHERE 1991 <= year_of_award <= 1995) AS wa
WHERE wa.id = w.id AND w.first_name = 'Woody' AND w.last_name = 'Allen';",2018-08-31 05:08:19.860107+10,9,0,145,noninterpretable
9354,"SELECT COUNT(*)
FROM (writer w NATURAL JOIN person p) AS w,
	(SELECT *
	FROM writer_award 
	WHERE 1991 <= year_of_award AND year_of_award<= 1995) AS wa
WHERE w.title = wa.title AND wa.production_year = w.production_year AND wa.id = w.id AND w.first_name = 'Woody' AND w.last_name = 'Allen' AND lower(RESULT)= 'won';",2018-08-31 05:11:49.768242+10,9,1,145,correct
9355,"SELECT ID, FIRST_NAME, LAST_NAME FROM PERSON P WHERE ID IN(SELECT COUNT(*) FROM WRITER W WHERE ID IN (SELECT ID FROM DIRECTOR D WHERE D.NAME = W.NAME))>1;",2018-08-31 05:12:51.145118+10,4,0,231,noninterpretable
9356,"SELECT mw.title, mw.production_year
FROM movie m natural join writer w
GROUP BY w.name
WHERE EXISTS w.name = Kevin Williamson
;",2018-08-31 05:14:01.806222+10,5,0,260,noninterpretable
9357,"SELECT mw.title, mw.production_year
FROM movie m natural join writer w
GROUP BY w.name
WHERE EXISTS w.first_name = Kevin and w.last_name = Williamson
;",2018-08-31 05:15:59.31608+10,5,0,260,noninterpretable
9358,"SELECT DISTINCT id
FROM crew
GROUP BY id
HAVING COUNT(*)=(
SELECT MAX(COUNT(*)) FROM crew 
);",2018-08-31 05:16:26.71946+10,14,0,327,noninterpretable
9359,"SELECT id
FROM ;",2018-08-31 05:16:32.614515+10,10,0,145,noninterpretable
9360,"SELECT DW.ID, DW.FIRST_NAME, DW.LAST_NAME 
FROM (PERSON P NATURAL JOIN DIRECTOR NATURAL JOIN WRITER)AS DW
GROUP BY DW.ID
HAVING COUNT(*)>1;",2018-08-31 05:18:16.43352+10,4,1,231,correct
9361,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 05:18:26.904642+10,10,1,145,correct
9362,"SELECT COUNT(*)
WHERE ma.title = m.title or ca.title = m.title or da.title = m.title or wa.title = m.title or aa.title = m.title;",2018-08-31 05:27:14.041144+10,11,0,145,noninterpretable
9363,"SELECT TITLE, PRODUCTION_YEAR 
FROM WRITER W
WHERE TITLE IN(SELECT TITLE FROM WRITER WHERE ID IN(SELECT ID FROM PERSON WHERE FIRST_NAME = KEVIN AND LAST_NAME = WILLIAMSON))
GROUP BY TITLE;",2018-08-31 05:29:30.75409+10,5,0,231,noninterpretable
9364,"SELECT W.TITLE, W.PRODUCTION_YEAR
FROM WRITER W, PERSON P 
WHERE W.ID = P.ID
AND LOWER(FIRST_NAME)='kevin'
AND LOWER(LAST_NAME)='williamson';",2018-08-31 05:42:51.856275+10,5,1,231,correct
9365,"SELECT COUNTRY 
FROM RESTRICTION
WHERE TITLE = Shakespeare in Love
AND DESCRIPTION = 'M';",2018-08-31 05:47:30.715829+10,6,0,231,noninterpretable
9366,"SELECT COUNTRY 
FROM RESTRICTION
WHERE LOWER(TITLE) = 'shakespeare in love'
AND DESCRIPTION = 'M';",2018-08-31 05:49:38.905001+10,6,1,231,correct
9367,"SELECT FIRST_NAME,LAST_NAME
FROM PERSON 
WHERE YEAR_BORN = MAX(YEAR_BORN)
GROUP BY FIRST_NAME;",2018-08-31 05:53:48.25292+10,7,0,231,noninterpretable
9368,"SELECT ID,FIRST_NAME,LAST_NAME
FROM PERSON 
WHERE YEAR_BORN =(SELECT MAX(YEAR_BORN) FROM PERSON);",2018-08-31 05:55:12.0744+10,7,1,231,correct
9369,"SELECT D.TITLE,P.FIRST_NAME,P.LAST_NAME
FROM DIRECTOR D ,PERSON P
WHERE D.ID=P.ID
AND D.TITLE in(SELECT TITLE FROM WRITER_AWARD WA WHERE LOWER(AWARD_NAME) = 'bafta film award'AND LOWER(CATEGORY)='best film');",2018-08-31 06:03:10.014119+10,8,0,231,partially correct
9370,"SELECT D.TITLE,d.production_year,P.FIRST_NAME,P.LAST_NAME
FROM DIRECTOR D ,PERSON P
WHERE D.ID=P.ID
AND D.TITLE in(SELECT TITLE FROM MOVIE_AWARD WA WHERE LOWER(AWARD_NAME) = 'bafta film award'AND LOWER(CATEGORY)='best film'and lower(result)='won');",2018-08-31 06:06:25.019659+10,8,1,231,correct
9371,"SELECT D.TITLE,d.production_year,P.FIRST_NAME,P.LAST_NAME
FROM DIRECTOR D ,PERSON P
WHERE D.ID=P.ID
AND D.TITLE in(SELECT TITLE FROM MOVIE_AWARD WA WHERE LOWER(AWARD_NAME) = 'bafta film award'AND LOWER(CATEGORY)='best film'and lower(result)='won');",2018-08-31 06:10:06.235788+10,8,1,231,correct
9372,"SELECT COUNT(*)
FROM(
	SELECT ID
	FROM WRITER_AWARD
	WHERE YEAR_OF_AWARD >1990
	AND YEAR_OF_AWARD<1996) AS WA,
	PERSON P
WHERE P.ID = WA.ID
AND LOWER(P.FIRST_NAME) ='woody'
AND LOWER(P.LAST_NAME) = 'allen';",2018-08-31 06:17:19.857676+10,9,0,231,partially correct
9373,"SELECT COUNT(*)
FROM(
	SELECT ID,RESULT
	FROM WRITER_AWARD
	WHERE YEAR_OF_AWARD >1990
	AND YEAR_OF_AWARD<1996) AS WA,
	PERSON P
WHERE P.ID = WA.ID
AND LOWER(P.FIRST_NAME) ='woody'
AND LOWER(P.LAST_NAME) = 'allen'
AND LOWER(WA.RESULT) ='won' ;",2018-08-31 06:19:40.837298+10,9,1,231,correct
9374,"SELECT COUNT(*)
FROM(
	SELECT ID,RESULT
	FROM WRITER_AWARD
	WHERE YEAR_OF_AWARD >1990
	AND YEAR_OF_AWARD<1996) AS WA,
	PERSON P
WHERE P.ID = WA.ID
AND LOWER(P.FIRST_NAME) ='woody'
AND LOWER(P.LAST_NAME) = 'allen'
AND LOWER(WA.RESULT) ='won' ;",2018-08-31 06:20:13.52818+10,9,1,231,correct
9375,"SELECT FIRST_NAME, LAST_NAME
FROM ROLE R,APPEARANCE A,PERSON P
WHERE LOWER(A.TITLE)='psycho'
AND R.PRODUCTION_YEAR='1960'
AND P.ID = R.ID
GROUP BY FIRST_NAME
HAVING COUNT(*)<2;",2018-08-31 06:30:01.994668+10,10,0,231,partially correct
9376,"SELECT first_name, last_name, title, production_year, description
FROM (SELECT first_name, last_name, title, production_year, description, count(*) AS NoOfRoles
	FROM person, role
	WHERE person.id=role.id
	GROUP BY person.id) x
WHERE x.NoOfRoles=
	(SELECT MAX(x.NoOfRoles) FROM x);
",2018-08-31 06:32:26.655595+10,15,0,327,noninterpretable
9377,"select production_year, count(title)from movie where production_year=1993 OR production_year=1992 OR production_year=1991;",2018-08-31 06:33:20.966761+10,2,0,437,partially correct
9378,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 06:34:34.865031+10,10,1,231,correct
9379,;,2018-08-31 06:35:39.027826+10,11,0,231,noninterpretable
9380,"select production_year, count(title)from movie where production_year<1993 AND production_year>1991 group by production_year;",2018-08-31 06:40:31.054802+10,2,0,437,partially correct
9381,"SELECT COUNT(*)
FROM MOVIE M
WHERE NOT EXISTS(
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 06:42:04.030471+10,11,1,231,correct
9382,"select production_year, count(title)from movie where production_year<1994 AND production_year>1990 group by production_year;",2018-08-31 06:44:17.668952+10,2,1,437,correct
9383,;,2018-08-31 06:46:38.638176+10,3,0,231,noninterpretable
9384,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
		from movie_award
		where award_name = 'BAFTA Film Award'
		and category = 'best film'
		and result  = 'won') as ma,
		director as d,
		person as p
where ma.title  = d.title
and d.id = p.id
and ma.production_year = d.production_year;",2018-08-31 06:49:48.92574+10,8,1,111,correct
9385,,2018-08-31 06:58:07.651321+10,11,0,32,noninterpretable
9386,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM
	movie_award ma, person p, director d

WHERE
	ma.title=d.title 
	and ma.production_year=d.production_year
	and ma.award_name = 'BAFTA Film Award'
	and ma.category = 'best film'
	and ma.result = 'won'
	and d.id = p.id;",2018-08-31 06:58:33.822309+10,8,1,111,correct
9387,select * from movie where movie.title='psycho';,2018-08-31 06:59:00.002833+10,11,0,32,partially correct
9388,"SELECT P.ID
FROM PERSON P
ORDER BY  YEAR_BORN DESC
LIMIT 1,1;",2018-08-31 06:59:08.242225+10,3,1,231,correct
9389,select * from movie where movie.title='psycho';,2018-08-31 06:59:42.429224+10,3,0,32,partially correct
9390,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 07:00:25.457409+10,13,0,32,partially correct
9391,select * from movie where movie.title='psychi';,2018-08-31 07:01:59.394154+10,14,0,32,partially correct
9392,"select count (wa.id)
from writer_award as wa, person as p
where wa.year_of_award in (1991, 1992,1993,1994,1995)
and wa.id = p.id
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
and lower(wa.result) = 'won';",2018-08-31 07:02:54.133612+10,9,1,111,correct
9393,select * from movie where movie.title='1';,2018-08-31 07:02:58.449102+10,15,0,32,partially correct
9394,"select r.id
from scene as s,
	role as r,
	appearance as a
where 
	s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no = a.scene_no
	and s.title = r.title
	and s.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by
	r.id
having
	count(*) = 1;",2018-08-31 07:04:54.149979+10,10,1,111,correct
9395,"SELECT D.ID,DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D ,DIRECTOR_AWARD DA
WHERE D.TITLE = DA.TITLE
AND D.TITLE NOT IN(SELECT TITLE
				FROM DIRECTOR_AWARD
				WHERE LOWER(RESULT)='won');",2018-08-31 07:08:30.179749+10,13,1,231,correct
9396,"SELECT D.ID,DA.AWARD_NAME,DA.YEAR_OF_AWARD,DA.CATEGORY
FROM DIRECTOR D ,DIRECTOR_AWARD DA
WHERE D.TITLE = DA.TITLE
AND D.TITLE NOT IN(SELECT TITLE
				FROM DIRECTOR_AWARD
				WHERE LOWER(RESULT)='won');",2018-08-31 07:09:18.534231+10,13,1,231,correct
9397,Select Count(*) From Person p Where Exists (Select * From Writer w Where p.id = w.id);,2018-08-31 07:11:47.824081+10,1,0,407,partially correct
9398,Select Count(*) From Person p Where Exists (Select * From Writer w Where p.id = w.id AND p.year_born = 1935);,2018-08-31 07:13:35.533348+10,1,1,407,correct
9399,"Select production_year, Count(title)
From Movie m 
Where m.production_year = 1991 OR m.production_year = 1992 OR m.production_year = 1993 
Group By production_year;

",2018-08-31 07:15:52.343247+10,2,1,407,correct
9400,Select (id) From Person p Where Not Exist (Select * From Director d Where p.id = d.id);,2018-08-31 07:18:09.369293+10,12,0,407,noninterpretable
9401,"SELECT id from person 
where year_born=
	(SELECT MAX(year_born) from (SELECT id, year_born from person where year_born < (SELECT MAX(year_born) from person)));",2018-08-31 07:19:00.5934+10,3,1,111,correct
9402,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 07:20:14.982374+10,12,1,407,correct
9403,"Select dw.id, dw.first_name, dw.last_name From (Person p Natural Join Director Natural Join Writer) As dw Group BY dw.id Having Count(*) >1;",2018-08-31 07:20:35.83777+10,4,1,407,correct
9404,"SELECT W.ID,D.ID
FROM WRITER W, DIRECTOR D,(SELECT TITLE
					FROM APPEARANCE A
					WHERE A.DESCRIPTION = 'D')AS AP
WHERE W.TITLE = AP.TITLE
OR D.TITLE = AP.TITLE
ORDER BY COUNT(*) DESC
LIMIT 0,1;",2018-08-31 07:21:14.975446+10,14,0,231,noninterpretable
9405,"Select title, production_year From Writer w Where Exists (Select * From Person p Where p.id = w.id AND p.first_name = 'Kevin' AND p.last_name = 'Williamson');",2018-08-31 07:21:52.330775+10,5,1,407,correct
9406,"Select country From Restriction r Where r.title = 'Shakespeare in Love' AND r.description = 'M';
",2018-08-31 07:24:43.353811+10,6,1,407,correct
9407,"Select first_name, last_name, id From Person Where year_born = (Select Min(p.year_born) From Person p);",2018-08-31 07:26:41.238011+10,7,0,407,partially correct
9408,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 07:27:39.734053+10,14,1,231,correct
9409,"Select first_name, last_name, id From Person Where year_born = (Select Max(p.year_born) From Person p);",2018-08-31 07:29:34.952934+10,7,1,407,correct
9410,"Select id,first_name, last_name From Person Where year_born = (Select Max(p.year_born) From Person p);",2018-08-31 07:30:05.342827+10,7,1,407,correct
9411,"Select id,first_name, last_name From Person Where year_born = (Select Min(p.year_born) From Person p);",2018-08-31 07:30:23.075282+10,7,0,407,partially correct
9412,"Select id,first_name, last_name From Person Where year_born = (Select max(p.year_born) From Person p);",2018-08-31 07:30:42.480923+10,7,1,407,correct
9413,"Select d.title, d.production_year, p.first_name, p.last_name From Director d Natural Join Person p Natural Join Movie_Award ma Where ma.award_name = 'BAFTA Film Award' ma.category = 'best film' And ma.result ='won';

",2018-08-31 07:30:57.419076+10,8,0,407,noninterpretable
9966," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 11:28:59.443134+10,6,0,246,partially correct
9414,"WITH y AS
(SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id)

SELECT y.id from y where 
	y.NoOfWorkedON = (SELECT MAX(y.NoOfWorkedON) from y);",2018-08-31 07:32:00.653416+10,14,1,111,correct
9415,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 07:32:04.090139+10,8,1,407,correct
9416,"Select Count(*) From Writer_Award wa, Person p Where p.id = wa.id And p.first_name = 'Woody' And p.last_name = 'Allen' And wa.year_of_award > 1990 And wa.year_of_award <1995;",2018-08-31 07:34:46.223445+10,9,1,407,correct
9417,"SELECT r.id FROM scene s, appearance a,ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-31 07:38:12.853503+10,10,1,407,correct
9418,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-31 07:39:15.607391+10,11,1,407,correct
9419,"Select * From Person Order By year_born DESC Limit 1 Offset1;

",2018-08-31 07:40:03.94209+10,3,0,407,noninterpretable
9420,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 07:41:38.510077+10,3,1,407,correct
9421,;,2018-08-31 07:44:19.109128+10,15,0,231,noninterpretable
9422,"Select d.id, da.award_name, da.year_of_award, da.category From Director d, Director_Award da Where d.title = da.title And da.result = 'nominated';",2018-08-31 07:46:33.367313+10,13,1,407,correct
9423,"Select h.id From 

( Select foo.id, Count(*) As c
From (Select * From Director Union 
Select id, title, production_year From Writer) As foo 
Group By foo.id) As h

Where h.c In (Select Max(c) From 

(Select foo.id, Count(*) As c From (Select * From Director Union
Select id, title, production_year From Writer) As foo Group By foo.id) As h );
",2018-08-31 07:49:49.609296+10,14,1,407,correct
9424,"SELECT COUNT(*)
FROM(
SELECT DISTINCT person.id
FROM person, writer
WHERE person.id=writer.id AND year_born='1935')
AS ct;",2018-08-31 07:49:53.78098+10,1,1,322,correct
9425,"select count(*) from person p where not exists(select * from director d where p.id=d.id);
",2018-08-31 07:53:46.874321+10,12,1,437,correct
9426,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );
",2018-08-31 07:54:51.442439+10,15,1,407,correct
9427,"select count(*) from person p where not exists(select * from director d where p.id=d.id);
",2018-08-31 07:55:37.171925+10,12,1,437,correct
9428,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 07:58:39.684597+10,15,1,231,correct
9429,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 07:59:48.532778+10,15,1,231,correct
9430,"SELECT COUNT(*)
FROM writer INNER JOIN person ON writer.id = person.id
WHERE person.year_born = '1935';",2018-08-31 07:59:54.43128+10,1,0,450,partially correct
9431,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year='1991' OR production_year='1992' OR production_year='1993'
GROUP BY production_year
ORDER BY production_year ASC;",2018-08-31 08:00:51.509463+10,2,1,322,correct
9432,"SELECT COUNT(*)
FROM person
WHERE person.id NOT IN (SELECT director.id FROM director);",2018-08-31 08:04:38.815174+10,12,1,322,correct
9433,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma, director as d, person as p
where ma.category = ""best film"" and ma.award_name = ""BAFTA Film Award""
      and ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;",2018-08-31 08:06:51.807312+10,8,0,291,partially correct
9434,"select id, first_name, last_name
from person
where year_born in (select max(year_born) 
                    from person);",2018-08-31 08:07:23.768423+10,7,1,291,correct
9435,"select p.id,p.first_name,p.last_name from(person p natural join director d natural join writer w) where p.id=d.id AND d.id=w.id;
",2018-08-31 08:09:04.135223+10,4,0,437,partially correct
9436,"select title
from movie_award wa;",2018-08-31 08:09:12.995636+10,11,0,377,partially correct
9437,"select p.id,p.first_name,p.last_name from(person p natural join director d natural join writer w) where p.id=d.id AND d.id=w.id group by p.id having d.id>1;
",2018-08-31 08:10:31.531801+10,4,0,437,partially correct
9438,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title 
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title 
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title 
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title 
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title 
);",2018-08-31 08:12:28.986404+10,11,0,377,noninterpretable
9547,"SELECT id
FROM role r
WHERE r.title in(
	SELECT title, count(scene_no)
	FROM scene s,appearance a
	WHERE r.title = a.title and a.production_year = 1960 and r.title = 'Psycho' and s.scene_no = a.scene_no 
	HAVING count(scene_no)=1
);",2018-08-31 09:35:49.14662+10,10,0,215,noninterpretable
9439,"SELECT w.production_year, count(w.production_year)  from writer_award wa, writer w, person p
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id
and w.id = p.id and lower(first_name) = 'woody' and lower(result) = 'won' and lower(last_name)= 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <=1995;",2018-08-31 08:13:17.997644+10,9,0,213,partially correct
9440,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p 
WHERE w.id = p.id AND p.year_born = '1935');",2018-08-31 08:13:42.635557+10,1,1,450,correct
9441,"SELECT  count(*)  from writer_award wa, writer w, person p
where wa.title = w.title and wa.production_year = w.production_year and wa.id = w.id
and w.id = p.id and lower(first_name) = 'woody' and lower(result) = 'won' and lower(last_name)= 'allen' and wa.year_of_award >= 1991 and wa.year_of_award <=1995;",2018-08-31 08:13:52.909111+10,9,1,213,correct
9442,"SELECT count(*) 
FROM movie m 
WHERE not exists (
SELECT title
FROM movie_award ma 
WHERE lower(ma.result) = 'won' and ma.title = m.title 
UNION
SELECT title
FROM crew_award ca 
WHERE lower(ca.result) = 'won' and ca.title = m.title 
SELECT title 
FROM director_award da 
WHERE lower(da.result) = 'won' and da.title = m.title 
UNION
SELECT title
FROM actor_award aa 
WHERE lower(aa.result) = 'won' and aa.title = m.title 
UNION
SELECT title 
FROM writer_award wa 
WHERE lower(wa.result) = 'won' and wa.title = m.title 
);",2018-08-31 08:14:02.44387+10,11,0,377,noninterpretable
9443,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 08:14:27.390028+10,11,1,377,correct
9444,"select id
from person
where;",2018-08-31 08:16:18.200997+10,3,0,377,noninterpretable
9445,"select count(*)
from writer_award as wa, person as p
where p.first_name = ""Woody"" and p.last_name = ""Allen"" and p.id = wa.id and wa.result=""won"" and year_of_award between 1991 and 1995;",2018-08-31 08:16:26.723839+10,9,1,291,correct
9446,select count (*) from person p where not exists (select * from director d where p.id = d.id);,2018-08-31 08:16:43.448133+10,12,1,334,correct
9447,"SELECT production_year, COUNT(*)
FROM movie
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991
GROUP BY production_year;",2018-08-31 08:18:59.127548+10,2,1,450,correct
9448,"select id
from person p
where (select max(year_born) 
from person
where p.year_born<(select max(year_born)
from person));",2018-08-31 08:19:10.497346+10,3,0,377,partially correct
9449,"select id
from person p
where (select max(year_born) 
from person
where year_born<(select max(year_born)
from person));",2018-08-31 08:19:34.070607+10,3,0,377,partially correct
9450,"select id
from person p
where p.year_born=(select max(year_born) 
from person
where year_born<(select max(year_born)
from person));",2018-08-31 08:19:53.818372+10,3,1,377,correct
9451,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (select count(r.id) as cc from role r )as cr
where(
	p.id=r.id and
	cr.cc=( select max(cc)from(select count(r.id) as cc from role r )as cr));",2018-08-31 08:21:54.007528+10,15,0,238,partially correct
9452,"select p.id, p.first_name, p.last_name from person p where exists (select * from director d, writer w group by p.id having count(d.title)>=2);",2018-08-31 08:27:05.721891+10,4,0,334,noninterpretable
9453,"select p.id, p.first_name, p.last_name from person p where exists (select * from director d, writer w group by p.id having count(d.title)>=2);",2018-08-31 08:27:10.477917+10,4,0,334,noninterpretable
9454,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 2;",2018-08-31 08:29:19.263136+10,4,0,334,partially correct
9455,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 08:29:29.66019+10,4,1,334,correct
9456,"SELECT COUNT(*)
FROM person p 
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-31 08:29:49.012156+10,12,1,450,correct
9457,"select x.id from (select x1.id, count (*)as NoOfWorkedON from (select d.id, title, production_year
from director d union select w.id, title, production_year from writer w) x1 group by x1.id)x
where x.NoOfWorkedON = (select max(x2.NoOfWorkedOn) from (select x1.id, count(*) as NoOfWorkedON from 
(select d.id, title, production_year from director d union select w.id, title, production_year from writer w)x1
group by x1.id)x2);
",2018-08-31 08:29:58.937752+10,14,1,213,correct
9458,"select id,award_name,year_of_award,category
from director_award 
where (select id
from ;",2018-08-31 08:33:08.388841+10,13,0,377,noninterpretable
9459,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 08:33:44.875295+10,13,1,377,correct
9460,"select id 
from person
where ;",2018-08-31 08:33:48.22823+10,3,0,121,noninterpretable
9461,"select m.title, m.production_year from movie m where exists (select * from writer w where w.id = m.id);",2018-08-31 08:34:40.233157+10,5,0,334,noninterpretable
9462,"

SELECT id,first_name,last_name
FROM person
WHERE year_born=
(SELECT MAX(year_born)
FROM person );",2018-08-31 08:35:49.770315+10,7,1,195,correct
9463,"select w.title, w.production_year
from writer w, person p
where w.id = p.id and lower(first_name)= 'kevin' and lower(last_name)= 'williamson';",2018-08-31 08:36:37.218844+10,5,1,334,correct
9464,"select id
from person
where(select count(*)
from director, writer
where d.id=w.id);",2018-08-31 08:36:38.595718+10,14,0,377,noninterpretable
9465,;,2018-08-31 08:37:52.230169+10,15,0,377,noninterpretable
9466,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 08:38:12.954837+10,15,1,377,correct
9467,"select p.id 
from person p
where p.year_born=(select max(year_born) from person where year_born<(select max(born_year) from person)
);",2018-08-31 08:39:04.470722+10,3,0,121,noninterpretable
9468,"Select count(*)
from person,writer
where p.id=w.id and p.year_born=1935;",2018-08-31 08:39:34.136192+10,1,0,377,noninterpretable
9469,"Select count(*)
from person p,writer w
where p.id=w.id and p.year_born=1935;",2018-08-31 08:40:01.74897+10,1,0,377,partially correct
9470,"select p.id 
from person p
where p.year_born=(
select max(year_born) 
from person 
where year_born < (select max(born_year)
from person));",2018-08-31 08:40:05.879434+10,3,0,121,noninterpretable
9471,select r.country from restriction r where description = 'M' and r.title = 'Shakespeare in Love';,2018-08-31 08:40:14.020308+10,6,1,334,correct
9472,"select p.id 
from person p
where p.year_born=(
select max(year_born) 
from person 
where year_born < (select max(year_born)
from person));",2018-08-31 08:41:48.914064+10,3,1,121,correct
9473,"select r.id
from role as r,
(select a.title, a.production_year, a.description
from appearance as a
where a.title = ""Psycho"" and a.production_year=1960 
group by a.description
having count(*)=1) as b
where r.title=b.title and r.production_year=b.production_year and r.description = b.description;",2018-08-31 08:42:30.921733+10,10,1,291,correct
9474,"select production_year,count(*)
from movie m
where m.production_year=1993 
union
select production_year,count(*)
from movie m
where m.production_year=1992 
union
select production_year,count(*)
from movie m
where m.production_year=1991; ",2018-08-31 08:43:25.984924+10,2,1,377,correct
9475,"select count(*)
from person
where not exists(select id from director
where director.id=person.id);",2018-08-31 08:45:17.671965+10,12,1,377,correct
9476,"select count(*) from person p
where exists select * from writer w where w.id = p.id and p.year_born=1935;",2018-08-31 08:46:32.21594+10,1,0,367,noninterpretable
9477,"select p.id,p.first_name,p.last_name,min(p.year_born) from person p;",2018-08-31 08:46:38.435591+10,7,0,334,partially correct
9478,"select p.id,p.first_name,p.last_name 
from person p
where p.year_born = (select max(year_born) from person);",2018-08-31 08:47:58.995921+10,7,1,334,correct
9479,"
SELECT a.id 
FROM
(SELECT b.id, MAX (b.year_born)
 FROM person b
 WHERE b.year_born NOT IN
 (SELECT MAX(c.year_born)  FROM person c)) a ;
",2018-08-31 08:48:34.036154+10,3,1,382,correct
9480,"select p.id,first_name,last_name from (select id from (select distinct r.id, res.description from  (role as r join restriction as res on r.title = res.title and r.production_year = res.production_year)  where country = 'USA' ) as k group by id having count(id) in (select count (*) from (select description from restriction where country = 'USA' group by description ) as k)) as pp join person as p on p.id =  pp.id ;
",2018-08-31 08:50:03.168966+10,1,0,149,partially correct
9481,"select p.id,first_name,last_name from (select id from (select distinct r.id, res.description from  (role as r join restriction as res on r.title = res.title and r.production_year = res.production_year)  where country = 'USA' ) as k group by id having count(id) in (select count (*) from (select description from restriction where country = 'USA' group by description ) as k)) as pp join person as p on p.id =  pp.id ;
",2018-08-31 08:50:09.413329+10,1,0,149,partially correct
9482,"SELECT id, first_name, last_name
FROM person p
WHERE p.id IN ( SELECT director.id
               FROM director INNER JOIN writer ON director.id = writer.id
		    GROUP BY director.id
		    HAVING COUNT(*) > 1);",2018-08-31 08:50:35.480356+10,4,0,450,partially correct
9483,"SELECT first_name, last_name
FROM director, writer, person
WHERE director.id=writer.id AND director.title=writer.title AND director.production_year=writer.production_year AND person.id=writer.id
GROUP BY director.id, first_name, last_name
HAVING COUNT(*)>=2;",2018-08-31 08:52:41.347864+10,4,0,322,partially correct
9484,"SELECT person.id, first_name, last_name
FROM director, writer, person
WHERE director.id=writer.id AND director.title=writer.title AND director.production_year=writer.production_year AND person.id=writer.id
GROUP BY director.id, first_name, last_name
HAVING COUNT(*)>=2;",2018-08-31 08:53:34.309193+10,4,1,322,correct
9485,"select d.id, da.award_name, da.category
from director d, director_award da
where d.title=da.title
and d.production_year=da.production_year
and not exists (select * from director_award where lower(da.result)='won')
count (d.id)>1;

",2018-08-31 08:54:17.152985+10,13,0,121,noninterpretable
9486,"select count(*)
from movie as m
where not exists (select * from movie_award as ma where ma.title = m.title and ma.production_year = m.production_year and result = ""won"") 
and not exists (select * from crew_award as ca where ca.title = m.title and ca.production_year = m.production_year and result = ""won"")
and not exists (select * from director_award as da where da.title = m.title and da.production_year = m.production_year and result = ""won"")
and not exists (select * from writer_award as wa where wa.title = m.title and wa.production_year = m.production_year and result = ""won"")
and not exists (select * from actor_award as aa where aa.title = m.title and aa.production_year = m.production_year and result = ""won"");",2018-08-31 08:54:40.529199+10,11,0,291,partially correct
9487,"select r.id
from  role r,
	scene s,
	appearance a
where s.title =r.title
	and s.production_year = r.production_year
	and s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no = a.scene_no
	and s.description = a.description
	and lower(a.title) = 'psycho'
	and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 08:55:19.846026+10,10,0,134,partially correct
9488,"SELECT id, first_name, last_name
FROM person p
WHERE p.id IN ( SELECT director.id
               FROM director NATURAL JOIN writer
		    GROUP BY director.id
		    HAVING COUNT(*) > 1);",2018-08-31 08:56:48.340992+10,4,1,450,correct
9489,"select r.id
from  role r,
	scene s,
	appearance a
where s.title =r.title
	and s.production_year = r.production_year
	and s.title = a.title
	and s.production_year = a.production_year
	and s.scene_no = a.scene_no
	and r.description = a.description
	and lower(a.title) = 'psycho'
	and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 08:56:57.148981+10,10,1,134,correct
9490,"SELECT title, production_year
FROM writer, person
WHERE writer.id=person.id AND first_name='Kevin' AND last_name='Williamson';",2018-08-31 08:57:19.967395+10,5,1,322,correct
9491,select * from movie;,2018-08-31 08:57:23.247301+10,8,0,334,partially correct
9492,"SELECT c.id,c.award_name,c.year_of_award,c.category
FROM (director NATURAL JOIN director_award) c
WHERE c.id IN (SELECT a.id
FROM (director_award NATURAL JOIN director) a
WHERE result=""nominated"" AND a.id NOT IN
(SELECT b.id
FROM (director_award NATURAL JOIN director) b
WHERE result=""won""));",2018-08-31 08:58:27.576609+10,13,1,382,correct
9493,"select count(*)
from(
	select movie.title, movie.production_year
from movie

EXCEPT 
	select m.title, m.production_year
	from movie_award ma,movie m
	where m.title = ma.title and m.production_year = ma.production_year and lower(ma.result) = 'won'
	
except
	
	select m.title, m.production_year
	from director_award da,movie m
	where m.title = da.title and m.production_year = da.production_year and lower(da.result) = 'won'
	
except
	
	select m.title, m.production_year
	from writer_award wa,movie m
	where m.title = wa.title and m.production_year = wa.production_year and lower(wa.result) = 'won'
	
except
	
	select m.title, m.production_year
	from crew_award ca,movie m
	where m.title = ca.title and m.production_year = ca.production_year and lower(ca.result) = 'won'
	
except
	
	select m.title, m.production_year
	from actor_award aa,movie m
	where m.title = aa.title and m.production_year = aa.production_year and lower(aa.result) = 'won'


)



	
	
	
	


;",2018-08-31 08:58:28.76024+10,11,1,387,correct
9494,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title
and d.production_year=da.production_year
and low(category)='nominated'
and d.id not in (select * from director_award da, director d where 
da.title=d.title
and da.production_year=d.production_year
and lower(da.result)='won')
count (d.id)>1;

",2018-08-31 08:59:34.28179+10,13,0,121,noninterpretable
9495,"SELECT country
FROM restriction
WHERE title='Shakespeare in Love' AND description='M';",2018-08-31 09:00:41.468238+10,6,1,322,correct
9496,"SELECT title, production_year, first_name, last_name
FROM movie_award m, person p
WHERE p.id in(
	SELECT id
	FROM director d
	WHERE p.id = d.id and d.title = m.title and m.award_name = 'BAFTA Film Award' and m.category = 'Best Film'
);",2018-08-31 09:02:46.505336+10,8,0,215,partially correct
9519,"SELECT count(award_name)
FROM Writer_Award wa
WHERE wa.id in(
	SELECT wa.id
	FROM writer w, person p
	WHERE w.id = p.id and p.first_name = 'Woody' and p.last_name = 'Allen' 
		and year_of_award >= 1991 and year_of_award <= 1995 and wa.RESULT='won' and wa.production_year = w.production_year
);",2018-08-31 09:18:51.066443+10,9,0,215,partially correct
9585,"select id,first_name,last_name from person where year_born = (select max(year_born)from person);",2018-08-31 09:46:07.643472+10,7,1,367,correct
9497,"select count(*)
from movie as m
where not exists (select ma.title, ma.production_year from movie_award as ma where ma.title = m.title and ma.production_year = m.production_year and Lower(ma.result) = ""won"") 
and not exists (select ca.title, ca.production_year from crew_award as ca where ca.title = m.title and ca.production_year = m.production_year and Lower(ca.result) = ""won"")
and not exists (select da.title, da.production_year from director_award as da where da.title = m.title and da.production_year = m.production_year and Lower(da.result) = ""won"")
and not exists (select wa.title, wa.production_year from writer_award as wa where wa.title = m.title and wa.production_year = m.production_year and Lower(wa.result) = ""won"")
and not exists (select aa.title, aa.production_year from actor_award as aa where aa.title = m.title and aa.production_year = m.production_year and Lower(aa.result) = ""won"");",2018-08-31 09:04:20.588004+10,11,1,291,correct
9498,"select count(*)
from movie m 
where (m.title,m.production_year) not in (select title,production_year from Movie_Award ma where lower(result)='won') 
and   (m.title,m.production_year) not in (select title,production_year from Crew_Award ca where lower(result)='won')
and   (m.title,m.production_year) not in (select title,production_year from Director_Award da where lower(result)='won')
and   (m.title,m.production_year) not in (select title,production_year from Writer_Award wa where lower(result)='won')
and   (m.title,m.production_year) not in (select title,production_year from Actor_Award aa where lower(result)='won');",2018-08-31 09:05:36.00666+10,11,1,19,correct
9499,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(SELECT MAX(year_born) FROM person);",2018-08-31 09:05:40.688239+10,7,1,322,correct
9500,"select x2.id from
	(select id,count(*) as cc from((select d.id,d.title,d.production_year from director d
	union
	select w.id,w.title,w.production_year from writer w) as x) group by id)as x2

where(x2.cc= (select max(x3.cc)from(select id,count(*) as cc from((select d.id,d.title,d.production_year from director d
	union
	select w.id,w.title,w.production_year from writer w) as x) group by id)as x3)
	);",2018-08-31 09:06:55.726136+10,14,1,238,correct
9501,"select 
d.id, da.award_name, da.year_of_award, da.category
from 
director d, director_award da
where 
d.title=da.title
and d.production_year=da.production_year
and lower(category)='nominated'
and d.id not in (
select id from director_award da, director d 
where 
da.title=d.title
and da.production_year=d.production_year
and lower(da.result)='won');",2018-08-31 09:07:23.013993+10,13,0,121,partially correct
9502,"select title,production_year from (
(select ma.title, ma.production_year from movie_award ma 
inner join crew_award ca on ma.title = ca.title and ma.production_year = ca.production_year 
inner join director_award da on da.title = ca.title and da.production_year = ca.production_year
inner join writer_award wa on wa.title =da.title and wa.production_year = da.production_year
inner join actor_award aa on aa.title = wa.title and wa.production_year = aa.production_year 
where lower(ma.result) = 'won'
and lower(ca.result)='won'
and lower(da.result)='won'
and lower(wa.result)='won'
and lower(aa.result)='won') e);",2018-08-31 09:07:25.967701+10,11,0,130,partially correct
9503,"select count(*) from (
(select ma.title, ma.production_year from movie_award ma 
inner join crew_award ca on ma.title = ca.title and ma.production_year = ca.production_year 
inner join director_award da on da.title = ca.title and da.production_year = ca.production_year
inner join writer_award wa on wa.title =da.title and wa.production_year = da.production_year
inner join actor_award aa on aa.title = wa.title and wa.production_year = aa.production_year 
where lower(ma.result) = 'won'
and lower(ca.result)='won'
and lower(da.result)='won'
and lower(wa.result)='won'
and lower(aa.result)='won') e);",2018-08-31 09:08:01.449838+10,11,0,130,partially correct
9504,"SELECT dw.title, dw.production_year
FROM (SELECT *
      FROM writer INNER JOIN movie ON writer.title = movie.title) AS dw,
     (SELECT p.id
      FROM person p 
      WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson') AS p
WHERE p.id = dw.id;
",2018-08-31 09:09:31.225205+10,5,1,450,correct
9505,"select production_year,count(*) from movie m group by production_year having production>=1991 and production<=1993;",2018-08-31 09:09:57.671155+10,2,0,367,noninterpretable
9506,"select production_year,count(*) from movie m group by production_year having production_year>=1991 and production_year<=1993;",2018-08-31 09:10:32.426656+10,2,1,367,correct
9507,"SELECT director.title, director.production_year, first_name, last_name
FROM movie_award, director, person
WHERE movie_award.title=director.title AND movie_award.production_year=director.production_year AND lower(award_name)='bafta film award' AND lower(category)='best film' AND person.id=director.id;",2018-08-31 09:12:03.003075+10,8,0,322,partially correct
9508,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 09:12:28.608649+10,13,1,121,correct
9509,"select country from restriction
where(title='Shakespeare in Love' and description='M');",2018-08-31 09:12:53.547381+10,6,1,238,correct
9510,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-31 09:13:03.604676+10,6,1,450,correct
9511,"SELECT count(award_name)
FROM Writer_Award wa
WHERE wa.id in(
	SELECT wa.id
	FROM writer w, person p
	WHERE w.id = p.id and p.first_name = 'Woody' and p.last_name = 'Allen' 
		and production_year > 1991 and production_year < 1995
);",2018-08-31 09:13:54.424978+10,9,0,215,partially correct
9512,select count (*) from person p where  not exists (select * from director d where p.id = d.id); ,2018-08-31 09:14:18.332533+10,12,1,367,correct
9513,"select id from role 
where description in
(select description
from appearance where title='Psycho' and production_year= 1960
group by title,production_year,description
having count(*)=1) and title='Psycho' and production_year= 1960
;
",2018-08-31 09:15:16.53565+10,10,1,391,correct
9514,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 09:15:26.199472+10,8,1,334,correct
9515,"SELECT director.title, director.production_year, first_name, last_name
FROM movie_award, director, person
WHERE movie_award.title=director.title AND movie_award.production_year=director.production_year AND lower(award_name)='bafta film award' AND lower(category)='best film' AND lower(result)='won' AND person.id=director.id;",2018-08-31 09:16:16.476965+10,8,1,322,correct
9516,"select max(p1.year_born)
from person as p1
where p1.year_born not in(
select max(p2.year_born)
from person as p2);",2018-08-31 09:16:31.607728+10,3,0,291,partially correct
9517,"SELECT count(award_name)
FROM Writer_Award wa
WHERE wa.id in(
	SELECT wa.id
	FROM writer w, person p
	WHERE w.id = p.id and p.first_name = 'Woody' and p.last_name = 'Allen' 
		and production_year >= 1991 and production_year <= 1995 and wa.RESULT='won' and wa.production_year = w.production_year
);",2018-08-31 09:16:36.868224+10,9,1,215,correct
9518,"select person.id,
person.first_name,
person.last_name
from (person natural join director natural join writer)

group by person.id
having count(*)>1;",2018-08-31 09:18:21.995013+10,4,1,377,correct
9586,;,2018-08-31 09:46:58.553218+10,7,0,417,noninterpretable
9967,"select id
from person
order by year_born desc
limit 1
offset 1;",2018-08-31 11:29:08.418247+10,3,1,128,correct
9520,"SELECT count(award_name)
FROM Writer_Award wa
WHERE wa.id in(
	SELECT wa.id
	FROM writer w, person p
	WHERE wa.id = w.id and w.id = p.id and p.first_name = 'Woody' and p.last_name = 'Allen' 
		and year_of_award >= 1991 and year_of_award <= 1995 and wa.RESULT='won' and wa.production_year = w.production_year
);",2018-08-31 09:19:43.934779+10,9,1,215,correct
9521,"select d.title,d.production_year,first_name,last_name from movie_award ma,person p,director d
where(result = 'won' and
	award_name='BAFTA Film Award' and
	lower(category)='best film' and
	d.title=ma.title and
	d.production_year=ma.production_year and
	d.id=p.id);",2018-08-31 09:19:52.51725+10,8,1,238,correct
9522,"SELECT count(*)
FROM movie
WHERE (movie.title,movie.production_year) NOT IN (SELECT title,production_year FROM movie_award) 
OR (movie.title,movie.production_year) NOT IN (SELECT title,production_year FROM crew_award) 
OR (movie.title,movie.production_year) NOT IN (SELECT title,production_year FROM director_award)
OR (movie.title,movie.production_year) NOT IN (SELECT title,production_year FROM writer_award)
OR (movie.title,movie.production_year) NOT IN (SELECT title,production_year FROM actor_awards);",2018-08-31 09:19:59.438679+10,11,0,426,noninterpretable
9523,"select id from writer
where count;",2018-08-31 09:20:34.565122+10,1,0,452,noninterpretable
9524," select count(*) from 
 writer_award wa natural join writer as w natural join person as p 
 where lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen' 
 and wa.year_of_award >=1991 and wa.year_of_award <= 1995 and lower(result)= 'won';",2018-08-31 09:20:41.658943+10,9,1,99,correct
9525,"select max(dw.id) from (select d.id, d.title, d.production_year from director d
union
select w.id, w.title, w.production_year from writer w) as dw
group by dw.title, dw.production_year;
",2018-08-31 09:20:56.630403+10,14,0,121,partially correct
9526,"select id, title from writer_award wd where exists (select * from person p where p.id = wd.id);",2018-08-31 09:21:37.915212+10,9,0,334,partially correct
9527,"select p.id
from person p
where p.year_born in (
select max(p1.year_born)
from person as p1
where p1.year_born not in(
select max(p2.year_born)
from person as p2))
;",2018-08-31 09:21:38.801873+10,3,1,291,correct
9528,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 09:21:57.981385+10,9,1,334,correct
9529,"with works_on_num as (select id, COUNT(*) as num from
 (select id, title, production_year from director
 union
 select id, title, production_year from writer) group by id)
select id from works_on_num where num=(select MAX(num) from works_on_num);
",2018-08-31 09:23:43.499889+10,14,1,183,correct
9530,"SELECT COUNT(*)
FROM person, writer_award
WHERE person.id=writer_award.id AND lower(first_name)='woody' AND lower(last_name)='allen' AND year_of_award>='1991' AND year_of_award<='1995';",2018-08-31 09:24:18.472639+10,9,0,322,partially correct
9531,"with sub as(select id,year_born from person p where year_born <(select max(year_born) from person))
select id from person where year_born =(select max(year_born) from sub); ",2018-08-31 09:25:21.632066+10,3,1,19,correct
9532,"select title,
production_year
from writer,person
where writer.id=person.id and person.first_name='Kevin' and person.last_name='Williamson';",2018-08-31 09:27:31.878407+10,5,1,377,correct
9533,"select count(*) from writer_award wa,person p
where(p.first_name='Woody' and
	p.last_name='Allen' and
	p.id=wa.id and
	 wa.result='won' and
	wa.year_of_award between 1991 and 1995);",2018-08-31 09:27:39.967699+10,9,1,238,correct
9534,"SELECT COUNT(*)
FROM person, writer_award
WHERE person.id=writer_award.id AND lower(first_name)='woody' AND lower(last_name)='allen' AND year_of_award>='1991' AND year_of_award<='1995' AND lower(result)='won';",2018-08-31 09:28:29.289251+10,9,1,322,correct
9535,"select country
from Restriction
where title='Shakespeare in Love' and description='M';",2018-08-31 09:29:00.27244+10,6,1,377,correct
9536,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-31 09:30:14.836931+10,1,1,452,correct
9537,"SELECT COUNT(*)
FROM WRITER, PERSON
WHERE WRITER.id = PERSON.id
AND year_born = 1935;",2018-08-31 09:30:56.804684+10,1,0,325,partially correct
9538,"select 
	count(*)
from person p
where exists (
	select id from writer w
	where p.id=w.id and p.year_born=1935);",2018-08-31 09:31:50.490806+10,1,1,48,correct
9539,"select count(*)
from movie m,
where not existsselect title,production_year
			 from movie_award ma
			 where ma.title = m.title and ma.production_year = m.production_year
			 	 and lower(ma.result)='won'
			 union
			 select title,production_year
			 from crew_award ca
			 where ca.title = m.title and ca.production_year = m.production_year
			 	 and lower(ca.result)='won'
			 union
			 select title,production_year
			 from director_award da
			 where da.title = m.title and da.production_year = m.production_year
			 	 and lower(da.result)='won'
			 union
			 select title,production_year
			 from writer_award wa
			 where wa.title = m.title and wa.production_year = m.production_year
			 	 and lower(wa.result)='won'
			 union
			 select title,production_year
			 from actor_award aa
			 where aa.title = m.title and aa.production_year = m.production_year
			 	 and lower(aa.result)='won';",2018-08-31 09:32:43.387457+10,11,0,134,noninterpretable
9540,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 09:32:50.305437+10,1,1,325,correct
9541,"select r.id
from role r, scene s, appearance a
where a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.title=r.title
and a.production_year=r.production_year
and a.description=r.description
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id having count(*)=1;",2018-08-31 09:32:53.938034+10,10,1,272,correct
9542,"select id,
first_name,
last_name 
from person
where year_born=(select max(year_born)
from person);",2018-08-31 09:33:39.052172+10,7,1,377,correct
9543,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 09:33:51.285591+10,14,1,121,correct
9544,;,2018-08-31 09:34:36.296103+10,15,0,121,noninterpretable
9545,"SELECT id
FROM role, appearance
WHERE role.title=appearance.title AND role.production_year=appearance.production_year AND role.description=appearance.description AND role.title='Psycho' AND role.production_year='1960'
GROUP BY role.id
HAVING COUNT(*)=1;",2018-08-31 09:34:49.697723+10,10,1,322,correct
9546,"select count(*)
from movie m,
where not exists (select title,production_year
			 from movie_award ma
			 where ma.title = m.title and ma.production_year = m.production_year
			 	 and lower(ma.result)='won'
			 union
			 select title,production_year
			 from crew_award ca
			 where ca.title = m.title and ca.production_year = m.production_year
			 	 and lower(ca.result)='won'
			 union
			 select title,production_year
			 from director_award da
			 where da.title = m.title and da.production_year = m.production_year
			 	 and lower(da.result)='won'
			 union
			 select title,production_year
			 from writer_award wa
			 where wa.title = m.title and wa.production_year = m.production_year
			 	 and lower(wa.result)='won'
			 union
			 select title,production_year
			 from actor_award aa
			 where aa.title = m.title and aa.production_year = m.production_year
			 	 and lower(aa.result)='won');",2018-08-31 09:35:04.435006+10,11,0,134,noninterpretable
9548,"select production_year, count(production_year)
from movie
where production_year=1993
	or production_year=1992
	or production_year=1991
	group by production_year;",2018-08-31 09:36:09.768269+10,2,1,48,correct
9549,"with BAFTA_movie as
(select title, production_year, title, production_year 
from movie_award 
where award_name = 'BAFTA Film Award' and category = 'Best Film')

select bm.title, bm.production_year, p.first_name, p.last_name
from BAFTA_movie bm, person p, director d
where d.id = p.id and d.title = bm.title and d.production_year = bm.production_year;
   

",2018-08-31 09:37:24.101185+10,8,0,170,partially correct
9550,"SELECT production_year, count(*)
FROM MOVIE
WHERE production_year>1990;",2018-08-31 09:37:42.956233+10,2,0,325,partially correct
9551,"with works_on as (select id, count(*) as num from (select id, title, production_year from director
union select id, title, production_year from writer) group by id)
select id from works_on where num = (select MAX(num) from works_on);
",2018-08-31 09:38:03.255994+10,14,1,183,correct
9552,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 09:38:15.007324+10,2,1,325,correct
9553,"select count(*)
from person p
where not exists(
	select * 
	from director d
	where p.id=d.id);",2018-08-31 09:38:19.851573+10,12,1,48,correct
9554,"select title,production from writer where id = (select id from person where lower(first_name)='kevin'and lower(last_name)='williamson');",2018-08-31 09:38:38.855759+10,5,0,367,noninterpretable
9555,"select title,production_year from writer where id = (select id from person where lower(first_name)='kevin'and lower(last_name)='williamson');",2018-08-31 09:38:58.187839+10,5,1,367,correct
9556,"with sub as (select * from Director_Award da where (title,production_year) 
not in (select title,production_year from Director_award da1 where lower(result)='won'))

select id,award_name,year_of_award,category from sub 
inner join Director d 
on d.title =sub.title and d.production_year=sub.production_year ;",2018-08-31 09:39:11.113407+10,13,1,19,correct
9557,"SELECT id
FROM role r
WHERE r.title in(
	SELECT s.title
	FROM scene s,appearance a
	WHERE r.title = a.title and a.production_year = 1960 and a.title = 'Psycho' and s.scene_no = a.scene_no 
	HAVING count* = 1
);",2018-08-31 09:39:37.525675+10,10,0,215,noninterpretable
9558,"SELECT COUNT(*)
FROM movie
WHERE movie.title NOT IN (SELECT movie_award.title FROM movie_award) AND movie.title NOT IN (SELECT crew_award.title FROM crew_award) AND movie.title NOT IN (SELECT director_award.title FROM director_award) AND movie.title NOT IN (SELECT writer_award.title FROM writer_award) AND movie.title NOT IN (SELECT actor_award.title FROM actor_award);",2018-08-31 09:40:16.979355+10,11,0,322,partially correct
9559,"select count(*) as num from PERSON as p
where p.id in 
		(select w.id from WRITER as w)
		and p.year_born = '1935';",2018-08-31 09:40:19.718978+10,1,1,167,correct
9560,;,2018-08-31 09:41:29.027917+10,2,0,417,noninterpretable
9561,"SELECT DISTINCT writer.*
FROM writer INNER JOIN person ON writer.id = person.id
WHERE year_born = '1935';",2018-08-31 09:41:43.234556+10,1,0,127,partially correct
9562,"select count(year_born) from Person
where year_born=1935;",2018-08-31 09:42:33.740983+10,1,0,453,partially correct
9563,"Select p1.id
From person p1
Where p1.year_born =(Select max(p2.year_born)
                      From person p2
                      Where p2.year_born<(Select max(p3.year_born)
                                          From person p3));",2018-08-31 09:42:52.25681+10,3,1,83,correct
9564,"select count(m.title)
from movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where not exists(

m.title=ma.title and m.production_year=ma.production_year 
and m.title=ca.title and m.production_year=ca.production_year
and m.title=da.title and m.production_year=da.production_year
and m.title=wa.title and m.production_year=wa.production_year
and m.title=aa.title and m.production_year=aa.production_year);",2018-08-31 09:42:59.005785+10,11,0,389,noninterpretable
9565,"select production_year as py, count(*) from movie
where py=1991 and py=1992 and py=1993; ",2018-08-31 09:42:59.706421+10,2,0,452,partially correct
9566,;,2018-08-31 09:43:05.064375+10,12,0,417,noninterpretable
9567,"SELECT id
FROM person;",2018-08-31 09:43:06.4959+10,14,0,382,partially correct
9568,select conutry from restriction where title = Shakespeare in Love and description = 'M';,2018-08-31 09:43:21.339012+10,6,0,367,noninterpretable
9569,"select
	p.id,
	p.first_name,
	p.last_name
from 
	person p,
	director d,
	writer w
where p.id=d.id and w.id=d.id
	group by p.id
	having count(*)>1;",2018-08-31 09:43:24.43489+10,4,0,48,partially correct
9570,"select m.production_year,count(*) as num from MOVIE as m
where m.production_year = '1991' or m.production_year = '1992'
	or m.production_year = '1993'
group by m.production_year;",2018-08-31 09:43:38.988182+10,2,1,167,correct
9571,;,2018-08-31 09:43:42.173711+10,4,0,417,noninterpretable
9572,"select count (distinct w.id)
from writer w, person p
where w.id=p.id and p.year_born=1935;",2018-08-31 09:43:42.879273+10,1,1,273,correct
9573,select conutry from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-31 09:43:53.623253+10,6,0,367,noninterpretable
9574,"SELECT COUNT(*)
FROM movie
WHERE movie.title NOT IN (SELECT movie_award.title FROM movie_award WHERE lower(result)='won') AND movie.title NOT IN (SELECT crew_award.title FROM crew_award WHERE lower(result)='won') AND movie.title NOT IN (SELECT director_award.title FROM director_award WHERE lower(result)='won') AND movie.title NOT IN (SELECT writer_award.title FROM writer_award WHERE lower(result)='won') AND movie.title NOT IN (SELECT actor_award.title FROM actor_award WHERE lower(result)='won');",2018-08-31 09:44:08.623819+10,11,0,322,partially correct
9575,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-31 09:44:08.764696+10,6,1,367,correct
9576,"with BAFTA_movie as
(select title, production_year
from movie_award 
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won')

select bm.title, bm.production_year, p.first_name, p.last_name
from BAFTA_movie bm, person p, director d
where d.id = p.id and d.title = bm.title and d.production_year = bm.production_year;
   

",2018-08-31 09:44:17.297934+10,8,1,170,correct
9577,;,2018-08-31 09:44:42.396323+10,5,0,417,noninterpretable
9578,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result = 'won') ma,
person p, director d
where ma.title = d.title and d.id = p.id;
",2018-08-31 09:44:54.385836+10,8,1,430,correct
9579,;,2018-08-31 09:45:24.990987+10,6,0,417,noninterpretable
9580,"select count(*) as num from PERSON as p
where p.id not in
			(select distinct d.id from DIRECTOR as d);",2018-08-31 09:45:25.726453+10,12,1,167,correct
9581,"select count(*)
from movie m
where not exists
     ( select ma.title, ma.production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
	 union
	 select  ca.title, ca.production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won' 
	 union
	 select  da.title, da.production_year from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
	 union 
	 select  wa.title, wa.production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
	 union
	 select aa.title, aa.production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won');",2018-08-31 09:45:37.409517+10,11,1,272,correct
9582,"select production_year, count (*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-31 09:45:45.337134+10,2,1,273,correct
9583,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result = 'won') ma,
person p, director d
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;
",2018-08-31 09:45:50.249797+10,8,1,430,correct
9584,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year
from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and result = 'won') ma,
person p, director d
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;
",2018-08-31 09:45:55.707725+10,8,1,430,correct
9588,"select d.id, da.award_name, da.year_of_award, da.category
from director as d, director_award as da,
(select da1.title, da1.production_year
 from director_award as da1
 where Lower(da1.result)=""nominated""
 group by da1.title, da1.production_year
 having count(*)>=1
 EXCEPT
 select da2.title, da2.production_year
 from director_award as da2
 where Lower(da2.result)=""won""
) as na
where da.title = na.title and da.production_year=na.production_year and d.title = na.title and d.production_year=na.production_year;",2018-08-31 09:48:37.47753+10,13,1,291,correct
9589,"with sub as(select id, count(*) as total from (select id,title,production_year from Director union select id,title,production_year from Writer) group by id)
select id from sub where total =(select max(total) from sub);",2018-08-31 09:49:06.717989+10,14,1,19,correct
9590,"select p.id, p.first_name, p.last_name from PERSON as p
where p.id in
(select d.id from DIRECTOR as d, WRITER as w
where d.id = w.id and d.title = w.title and d.production_year = w.production_year
group by d.id
having count(*) >=2);",2018-08-31 09:49:07.86774+10,4,1,167,correct
9591,"select
	p.id,
	p.first_name,
	p.last_name
from 
	(person p natural join writer w  natural join director) as dw
group by dw.id
having count(*)>1;",2018-08-31 09:49:23.127254+10,4,1,48,correct
9592,"SELECT COUNT(*)
FROM PERSON, WRITER
WHERE PERSON.id = WRITER.id;",2018-08-31 09:49:58.266805+10,1,0,242,partially correct
9593,"SELECT count(*)
FROM movie m
WHERE m.title NOT IN(
	SELECT m.title
	FROM movie_award ma, crew_award ca, director_award da, writer_award wa
	WHERE ma.title = m.title and ca.title = m.title and da.title = m.title and wa.title = m.title
);",2018-08-31 09:50:03.572289+10,11,0,215,partially correct
9594,;,2018-08-31 09:50:42.624048+10,9,0,417,noninterpretable
9595,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 09:50:51.842747+10,2,1,452,correct
9596,"select w.title, w.production_year from WRITER as w
where w.id in
		(select p.id from PERSON as p
		where p.first_name = 'Kevin' and p.last_name = 'Williamson');",2018-08-31 09:51:11.746831+10,5,1,167,correct
9597,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS (SELECT * FROM movie_award WHERE lower(result)='won' AND movie_award.title=movie.title AND movie_award.production_year=movie.production_year)
AND NOT EXISTS (SELECT * FROM crew_award WHERE lower(result)='won' AND crew_award.title=movie.title AND crew_award.production_year=movie.production_year)
AND NOT EXISTS (SELECT * FROM director_award WHERE lower(result)='won' AND director_award.title=movie.title AND director_award.production_year=movie.production_year)
AND NOT EXISTS (SELECT * FROM writer_award WHERE lower(result)='won' AND writer_award.title=movie.title AND writer_award.production_year=movie.production_year)
AND NOT EXISTS (SELECT * FROM actor_award WHERE lower(result)='won' AND actor_award.title=movie.title AND actor_award.production_year=movie.production_year);",2018-08-31 09:51:20.087684+10,11,1,322,correct
9598,;,2018-08-31 09:51:33.074925+10,10,0,417,noninterpretable
9599,"select id
from(
select id, count(*) as total_num
from
(select id, title, production_year
from director

union

select id,title,production_year
from writer) as dw

group by id


) as result

where total_num = (






select count(*) as total_num
from
(select id, title, production_year
from director

union

select id,title,production_year
from writer) as dw

group by id
order by total_num desc
limit 1) 


;",2018-08-31 09:51:58.461739+10,14,1,387,correct
9600,;,2018-08-31 09:52:35.377245+10,11,0,417,noninterpretable
9601,"select count(*)
from movie m,
where not exists (select title,production_year
			 from movie_award ma
			 where ma.title = m.title and ma.production_year = m.production_year
			 	 and lower(ma.result)='won'
			 union
			 select title,production_year
			 from crew_award ca
			 where ca.title = m.title and ca.production_year = m.production_year
			 	 and lower(ca.result)='won'
			 union
			 select title,production_year
			 from director_award da
			 where da.title = m.title and da.production_year = m.production_year
			 	 and lower(da.result)='won'
			 union
			 select title,production_year
			 from writer_award wa
			 where wa.title = m.title and wa.production_year = m.production_year
			 	 and lower(wa.result)='won'
			 union
			 select title,production_year
			 from actor_award aa
			 where aa.title = m.title and aa.production_year = m.production_year
			 	 and lower(aa.result)='won');",2018-08-31 09:52:44.367625+10,11,0,134,noninterpretable
9602,"select d.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=d.id and d.id=w.id 
group by d.id
having count(*)>=2;",2018-08-31 09:52:49.740872+10,4,0,273,partially correct
9603,"select r.country from RESTRICTION as r
where lower(r.description) = 'm' and lower(r.title) = 'shakespeare in love';",2018-08-31 09:53:24.420588+10,6,1,167,correct
9604,;,2018-08-31 09:53:25.15681+10,3,0,417,noninterpretable
9605,"select d.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=d.id and d.id=w.id and d.title=w.title and d.production_year=w.production_year
group by d.id
having count(*)>=2;",2018-08-31 09:53:31.710921+10,4,1,273,correct
9606,"select m.title, m.production_year
from movie m,
	writer w,
	person p
where p.id=w.id and w.title=m.title 
	and p.first_name='Kevin' and p.last_name='Williamson';",2018-08-31 09:53:34.962753+10,5,1,48,correct
9607,"select count(*)
from MOVIE
where NOT EXISTS( SELECT TITLE, PRODUCTION_YEAR
                  FROM MOVIE_AWARD
                  WHERE lower(MOVIE_AWARD.RESULT)='won' and MOVIE_AWARD.TITLE= MOVIE.TITLE
                   and MOVIE_AWARD.PRODUCTION_YEAR=MOVIE.PRODUCTION_YEAR
                  UNION
                 SELECT TITLE, PRODUCTION_YEAR
                  FROM CREW_AWARD
                  WHERE lower(CREW_AWARD.RESULT)='won' and CREW_AWARD.TITLE= MOVIE.TITLE
                   and CREW_AWARD.PRODUCTION_YEAR=MOVIE.PRODUCTION_YEAR
                  UNION
                  SELECT TITLE, PRODUCTION_YEAR
                  FROM DIRECTOR_AWARD
                  WHERE lower(DIRECTOR_AWARD.RESULT)='won' and DIRECTOR_AWARD.TITLE= MOVIE.TITLE
                   and DIRECTOR_AWARD.PRODUCTION_YEAR=MOVIE.PRODUCTION_YEAR
                  UNION
                 SELECT TITLE, PRODUCTION_YEAR
                  FROM WRITER_AWARD
                  WHERE lower(WRITER_AWARD.RESULT)='won' and WRITER_AWARD.TITLE= MOVIE.TITLE
                   and WRITER_AWARD.PRODUCTION_YEAR=MOVIE.PRODUCTION_YEAR
                  UNION
                  SELECT TITLE, PRODUCTION_YEAR
                  FROM ACTOR_AWARD
                  WHERE lower(ACTOR_AWARD.RESULT)='won' and ACTOR_AWARD.TITLE= MOVIE.TITLE
                   and ACTOR_AWARD.PRODUCTION_YEAR=MOVIE.PRODUCTION_YEAR  );
                  
",2018-08-31 09:54:06.182182+10,11,1,139,correct
9608,;,2018-08-31 09:54:06.353492+10,13,0,417,noninterpretable
9609,"from movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where not exists(

m.title=ma.title and m.production_year=ma.production_year 
and m.title=ca.title and m.production_year=ca.production_year
and m.title=da.title and m.production_year=da.production_year
and m.title=wa.title and m.production_year=wa.production_year
and m.title=aa.title and m.production_year=aa.production_year);",2018-08-31 09:54:15.506678+10,11,0,389,noninterpretable
9610,;,2018-08-31 09:54:49.640313+10,14,0,417,noninterpretable
9611,"select count(*)
from movie m
where not exists (select title,production_year
			 from movie_award ma
			 where ma.title = m.title and ma.production_year = m.production_year
			 	 and lower(ma.result)='won'
			 union
			 select title,production_year
			 from crew_award ca
			 where ca.title = m.title and ca.production_year = m.production_year
			 	 and lower(ca.result)='won'
			 union
			 select title,production_year
			 from director_award da
			 where da.title = m.title and da.production_year = m.production_year
			 	 and lower(da.result)='won'
			 union
			 select title,production_year
			 from writer_award wa
			 where wa.title = m.title and wa.production_year = m.production_year
			 	 and lower(wa.result)='won'
			 union
			 select title,production_year
			 from actor_award aa
			 where aa.title = m.title and aa.production_year = m.production_year
			 	 and lower(aa.result)='won');",2018-08-31 09:54:51.217836+10,11,1,134,correct
9612,;,2018-08-31 09:55:26.543392+10,15,0,417,noninterpretable
9613,"select w.title, w.production_year
from person p, writer w 
where p.id=w.id and lower(first_name)='kevin' and lower(last_name)='willianmson';",2018-08-31 09:55:37.759611+10,5,0,273,partially correct
9614,"select first_name,last_name from person where id =(select id from director natural join movie_award 
where movie_award.result='won' and movie_award.award_name='BAFTA Film Award' and category = 'Best Film');",2018-08-31 09:56:32.789868+10,8,0,367,partially correct
9615,"select w.title, w.production_year
from person p, writer w 
where p.id=w.id 
and lower(first_name)='kevin' 
and lower(last_name)='williamson';",2018-08-31 09:56:45.091309+10,5,1,273,correct
9616,"Select d.id, da.award_name, da.year_of_award, da.category
From director d, director_award da
Where d.title=da.title AND d.production_year=da.production_year AND lower(da.result)='nominated' AND lower(da.result) <>'won';",2018-08-31 09:56:46.527843+10,13,1,83,correct
9617,"select country
from restriction
where title='Shakespeare in Love' and description='M';",2018-08-31 09:57:10.905226+10,6,1,48,correct
9618,"select id, first_name, last_name from PERSON
where PERSON.year_born in
				(select p.year_born from PERSON as p
				order by p.year_born DESC
				limit 1);",2018-08-31 09:57:13.499398+10,7,1,167,correct
9619,"SELECT production_year, COUNT(*)
FROM movie WHERE production_year = '1993', '1992', '1991
GROUP BY production_year;",2018-08-31 09:57:44.907951+10,2,0,127,noninterpretable
9620,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 09:58:41.298772+10,1,1,242,correct
9621,"with writer_award_1991_1995 as
(select id, title, production_year
from writer_award
where  year_of_award >1990 and year_of_award <1996 and lower(result) = 'won')

select count(*)
from writer_award_1991_1995 wa, writer w, person p
where p.id = w.id and w.id = wa.id and w.title= wa.title and w.production_year = wa.production_year 
and p.first_name = 'Woody' and p.last_name = 'Allen';
",2018-08-31 09:58:59.697631+10,9,1,170,correct
9622,"SELECT count(*)
FROM movie m
WHERE NOT EXISTS 
(SELECT title,production_year FROM movie_award as ma WHERE lower(result)='won'and m.title = ma.title and m.production_year=ma.production_year
union
SELECT title,production_year FROM crew_award as ca WHERE lower(result)='won' and m.title = ca.title and m.production_year=ca.production_year
union
SELECT  title,production_year FROM director_award as da WHERE lower(result)='won' and m.title=da.title and m.production_year=da.production_year
union
SELECT title,production_year FROM writer_award as wa WHERE lower(result)='won' and m.title=wa.title and m.production_year=wa.production_year
union
SELECT  title,production_year FROM actor_award as aa WHERE lower(result)='won' and m.title=aa.title  and m.production_year=aa.production_year);

",2018-08-31 09:59:16.765527+10,11,1,132,correct
9623,"select r.country
from restriction r
where lower(r.title)='shakespeare in love' 
and lower(r.description)='m';",2018-08-31 09:59:29.788551+10,6,1,273,correct
9624,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 09:59:34.813826+10,11,1,215,correct
9625,"select w.id , d.award_name , d.year_of_award, d.category from director_award d , writer w


where 
 
d.title = w.title And 
d.production_year = w.production_year 

group by w.id , d.award_name , d.year_of_award, d.category

having lower(d.result) = 'nominated';",2018-08-31 09:59:47.464857+10,13,1,65,correct
9626,"
with sub as(select id, count(*) as total from Role r group by id )


select first_name,last_name,title,production_year,description from sub 
inner join person p 
on p.id=sub.id
inner join Role r on r.id =p.id where total = (select max(total) from sub);
",2018-08-31 10:00:38.759713+10,15,1,19,correct
9627,"select
	id, first_name, last_name
from person
where year_born=(select
	max(year_born)
	from person);",2018-08-31 10:00:51.390245+10,7,1,48,correct
9628,"SELECT r.id
FROM role r, scene s,appearance a
WHERE a.title=r.title AND a.production_year=r.production_year 
AND a.description=r.description AND a.scene_no=1 AND a.title=s.title AND a.production_year=s.production_year 
AND a.scene_no=s.scene_no AND
lower(s.title)='psycho' AND s.production_year=1960;",2018-08-31 10:01:03.553347+10,10,0,439,partially correct
9629,"
select id
from person
where year_born =(

select max(p1.year_born)
from person p1
where p1.year_born<(
	select max(year_born)
	from person
	) 
)
;",2018-08-31 10:01:04.825368+10,3,1,387,correct
9630,"Select d.id, p.first_name, p.last_name From Director d, Person p Where Exists(Select * From Writer w Where d.title = w.title AND p.id = w.id) Group By Having Count(*) > 1;",2018-08-31 10:01:10.893834+10,4,0,36,noninterpretable
9631,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(p.year_born) from person p);",2018-08-31 10:01:18.462376+10,7,1,273,correct
9632,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM 
    movie_award AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id
    AND lower(award_name)= 'bafta film award'
    AND lower(category)= 'best film'
    AND lower(RESULT)= 'won';",2018-08-31 10:01:28.889184+10,8,1,367,correct
9633,"Select d.id, p.first_name, p.last_name From Director d, Person p Where Exists(Select * From Writer w Where d.title = w.title AND p.id = w.id) Group By d.title Having Count(*) > 1;",2018-08-31 10:02:11.900706+10,4,0,36,partially correct
9634,"select d.title, d.production_year, p.first_name, p.last_name
from MOVIE_AWARD as ma, DIRECTOR as d, PERSON as p
where p.id = d.id 
	and d.title = ma.title
	and d.production_year = ma.production_year
	and lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(ma.result)='won';",2018-08-31 10:02:24.723579+10,8,1,167,correct
9635,"Select d.id, p.first_name, p.last_name From Director d, Person p Where Exists(Select * From Writer w Where d.title = w.title AND p.id = w.id) Group By d.title Having Count(*) > 1;",2018-08-31 10:02:37.946754+10,4,0,36,partially correct
9636,"Select d.id, p.first_name, p.last_name From Director d, Person p Where Exists(Select * From Writer w Where d.title = w.title AND p.id = w.id) Group By d.title Having Count(*) > 1;",2018-08-31 10:03:09.470624+10,4,0,36,partially correct
9822,"select count(*)
from (writer_award natural join person) as wp
where wp.result='won'
	and wp.year_of_award>1990
	and wp.year_of_award<1996
	and lower(first_name)='woody'
	and lower(last_name)='allen'
group by id;",2018-08-31 10:58:46.961595+10,9,1,128,correct
9637,"SELECT m.id
FROM (SELECT COUNT(*) AS n, x.id
		FROM (SELECT w.id, w.title, w.production_year 
				FROM writer w
				UNION
				SELECT d.id,d.title,d.production_year
				FROM director d) x
		GROUP BY x.id) m
WHERE n=(SELECT MAX(x2.n)
			FROM ( SELECT COUNT(*) AS n, x.id
						FROM (SELECT w.id, w.title, w.production_year 
						FROM writer w
						UNION
						SELECT d.id,d.title,d.production_year
						FROM director d) x 
					GROUP BY x.id) x2);",2018-08-31 10:04:11.027871+10,14,1,382,correct
9638,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 10:04:19.987709+10,11,1,389,correct
9639,"SELECT id
FROM
(SELECT id,year_born FROM person p where p.year_born<
(SELECT MAX(year_born) FROM person)) as a

where a.year_born=(SELECT MAX(year_born) FROM (SELECT id,year_born FROM person p where p.year_born<
(SELECT MAX(year_born) FROM person)) )
;",2018-08-31 10:04:21.087623+10,3,1,132,correct
9640,"select count(*) from person
where director.id <> person.id; ",2018-08-31 10:04:58.885277+10,12,0,452,noninterpretable
9641,"SELECT production_year, COUNT(*)
FROM movie m
WHERE (SELECT production_year FROM movie WHERE production_year = 1993 AND production_year = 1992 AND production_year = 1991)
GROUP BY production_year;",2018-08-31 10:05:30.916153+10,2,0,242,partially correct
9642,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM 
    movie_award  ma,
    director  d,
    person  p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id
    AND lower(award_name)= 'bafta film award'
    AND lower(category)= 'best film'
    AND lower(RESULT)= 'won';",2018-08-31 10:05:40.157567+10,8,1,367,correct
9643,"select p.first_name, p.last_name, ma.title, ma.production_year
from person as p, director as d, movie_award as ma
where p.id=d.id and d.title=ma.title and d.production_year=ma.production_year and lower(award_name)='bafta film award' and lower(category)='best film' and lower(result)='won';",2018-08-31 10:05:47.147073+10,8,1,273,correct
9644,;,2018-08-31 10:06:10.161088+10,3,0,389,noninterpretable
9645,"select count(*) as num
from WRITER as w
where w.id in
		(select p.id from PERSON as p
		where p.first_name = 'Woody'
			and p.last_name ='Allen');
",2018-08-31 10:06:22.078256+10,9,0,167,partially correct
9646,"select count(*) from person p 
where exists (select * from writer w where w.id=p.id and p.year_born=1935);",2018-08-31 10:06:52.457747+10,1,1,453,correct
9647,"select id,first_name,last_name
from person,(select max(year_born) as minb from person) as y
where year_born=y.minb ;

",2018-08-31 10:08:19.899155+10,7,1,207,correct
9648,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 10:08:23.40874+10,12,1,452,correct
9649,"SELECT COUNT(*)
FROM person, (SELECT id AS d FROM director)

WHERE person.id != director.id;",2018-08-31 10:08:58.302107+10,12,0,127,noninterpretable
9650,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(s.title) = 'psycho'
    AND s.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 10:08:59.354677+10,10,1,439,correct
9651,select count(*) from person p natural join writer w where p.year_born = 1935; ,2018-08-31 10:09:06.768027+10,1,0,194,partially correct
9652,"with number as (select MAX(num), id from (select id, count(*) as num from person inner join role on person.id = role.id) as a group by id)
select p.first_name, p.last_name, r.title, r.production_year, r.description from person p inner join role r 
on p.id = r.id 
where p.id = number.id;
 
",2018-08-31 10:09:35.561694+10,15,0,183,noninterpretable
9653,"select  ma.title, ma.production_year, p.first_name, p.last_name
from person as p, director as d, movie_award as ma
where p.id=d.id and d.title=ma.title and d.production_year=ma.production_year and lower(ma.award_name)='bafta film award' and lower(ma.category)='best film' and lower(ma.result)='won';",2018-08-31 10:10:32.945686+10,8,1,273,correct
9654,"SELECT production_year, COUNT(*)
FROM movie 
WHERE  production_year = 1993 OR production_year = 1992 OR production_year = 1991
GROUP BY production_year;",2018-08-31 10:11:11.748889+10,2,1,242,correct
9655,"with scene_Psycho as
(select *
from scene
where scene_no = 1 and title = 'Psycho' and production_year = 1960)

select r.id
from role r natural join scene_Psycho sp;
",2018-08-31 10:11:55.905634+10,10,0,170,partially correct
9656,"SELECT COUNT(id)
FROM person
WHERE year_born = 1935;",2018-08-31 10:13:02.256784+10,1,0,454,partially correct
9657,select distinct count(w.id) from person p natural join writer w where p.year_born = 1935; ,2018-08-31 10:13:06.399381+10,1,0,194,partially correct
9658,"select p.id

from person p

where p.year_born = (

	select max(year_born)
	from person
	where year_born<(
		select max(year_born)
		from person));",2018-08-31 10:13:27.917265+10,3,1,389,correct
9659,select count(distinct w.id) from person p natural join writer w where p.year_born = 1935; ,2018-08-31 10:13:44.239961+10,1,1,194,correct
9660,"SELECT title
FROM movie
WHERE (SELECT scene_no COUNT (1) FROM APPEARANCE
WHERE a.Sno = s.s.no
AND lower (first_name) = 'psycho'
AND production_year = 1960;",2018-08-31 10:13:51.169721+10,10,0,445,noninterpretable
9661,"SELECT id, person,count(myear_born)
FROM person p
GROUP BY id, person asc
ORDER BY count(myear_born)
HAVING count>=2;",2018-08-31 10:14:04.80735+10,3,0,215,noninterpretable
9662,"SELECT production_year,count(production_year) FROM movie m

where m.production_year=1993 ;",2018-08-31 10:14:08.942124+10,2,0,453,partially correct
9663,"SELECT first_name,last_name,title,production_year,description
FROM ROLE NATURAL JOIN person
WHERE id=
(SELECT x2.id
FROM
(SELECT x1.id, MAX(x1.a)
FROM (SELECT id,COUNT(*) AS a
		FROM role NATURAL JOIN person
		GROUP BY id) x1) x2) ;
",2018-08-31 10:14:27.244501+10,15,1,382,correct
9664,"select count(*)
from person p
where p.id not in (select d.id from director d);
",2018-08-31 10:15:20.071914+10,12,1,128,correct
9665,"select r.id from role r, (select s.title, s.production_year, s.scene_no, a.description from scene s left join appearance a ON s.title = a.title and s.production_year = a.production_year and a.scene_no = s.scene_no where lower(s.title) = 'psycho' and s.production_year = 1960 ) AS P where P.title = r.title and P.production_year = r.production_year GROUP BY r.id HAVING COUNT(*) = 1;",2018-08-31 10:15:41.613654+10,10,0,399,partially correct
9666,"SELECT distinct count(*) FROM person WHERE NOT EXISTS(SELECT * from director WHERE person.id = director.id) ;
",2018-08-31 10:16:14.798718+10,12,1,213,correct
9667,"SELECT production_year,count(*) FROM movie m
where m.production_year=1993 OR m.production_year=1992 OR m.production_year=1991
GROUP BY production_year;",2018-08-31 10:17:49.851364+10,2,1,453,correct
9668,"SELECT id, first_name, last_name
FROM person as p
WHERE EXISTS (SELECT DISTINCT director.* AS dw FROM director, INNER JOIN writer ON director.id=writer.id)
HAVING COUNT(dw.id) > 2;",2018-08-31 10:18:02.76768+10,4,0,127,noninterpretable
9669,"SELECT count(*)
FROM CREW c
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = c.id);",2018-08-31 10:18:46.521769+10,12,0,242,partially correct
9670,"SELECT d.id,da.award_name,d.production_year,da.category
FROM director_award da,director d
WHERE da.title=d.title
	and da.production_year=d.production_year
	and lower(da.result)='nominated'
	and d.id not in(
	SELECT d.id
	FROM director d,director_award da
	WHERE d.title=da.title
		and d.production_year=da.production_year
		and lower(da.result)='won')
;",2018-08-31 10:19:13.705216+10,13,0,132,partially correct
9674,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where wa.result = 'won' and
wa.title = w.title and
w.id = p.id and
lower(p.first_name)='woody' and
lower(p.last_name)='allen' and 
wa.production_year between 1991 and 1995;
",2018-08-31 10:20:02.673887+10,9,0,430,partially correct
9675,"with scene_Psycho as
(select *
from scene
where scene_no = 1 and title = 'Psycho' and production_year = 1960)

select r.id
from role r, scene_Psycho sp, Appearance a
where r.title = sp.title and r.production_year = sp.production_year and r.description = a.description and 
a.title = sp.title and a.production_year = sp.production_year and a.scene_no = sp.scene_no;

",2018-08-31 10:20:02.930694+10,10,0,170,partially correct
9676,"select id, first_name, last_name from person
where exist(select * from director where director.title=writer.title and count(*)>=2);",2018-08-31 10:22:12.763081+10,4,0,452,noninterpretable
9677,"select dw.id, dw.first_name,dw.last_name
from (director natural join writer natural join person) as dw
group by id
having count(*)>1;",2018-08-31 10:22:14.398448+10,4,1,128,correct
9678,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-31 10:22:19.486453+10,12,1,242,correct
9679,"select 
p.first_name, 
p.last_name,
r.title, r.production_year, r.description
from person p, role r, 
(select id, count(*) as number from role group by id) as b
where r.id = p.id 
and p.id = b.id
and b.number in (select MAX(number) from (select id, count(*) as number from role group by id) as a);

",2018-08-31 10:22:20.89236+10,15,1,183,correct
9680,"select id, award_name, year_of_award, category

from  director_award natural join director

where lower(result)<>'won' and count(id)>=1;",2018-08-31 10:22:55.262479+10,13,0,389,noninterpretable
9681,"SELECT COUNT(*) FROM person p

WHERE NOT EXISTS (SELECT * FROM director d where d.id=p.id);",2018-08-31 10:23:26.094657+10,12,1,453,correct
9682,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS
(
	SELECT ma.title, ma.production_year FROM movie_award ma WHERE result=""won"" AND ma.title=m.title AND ma.production_year=m.production_year
	UNION
	SELECT ca.title, ca.production_year FROM crew_award ca WHERE result=""won"" AND ca.title=m.title AND ca.production_year=m.production_year
	UNION
	SELECT da.title, da.production_year FROM director_award da WHERE result=""won"" AND da.title=m.title AND da.production_year=m.production_year
	UNION
	SELECT wa.title, wa.production_year FROM writer_award wa WHERE result=""won"" AND wa.title=m.title AND wa.production_year=m.production_year
);",2018-08-31 10:23:26.611972+10,11,0,382,partially correct
9683,"SELECT id,MAX(year_born)
FROM
(SELECT p.id, p.year_born
FROM person p
WHERE p.year_born < (SELECT MAX(p.year_born) FROM person AS p))
WHERE year_born = (SELECT MAX(year_born) FROM (
SELECT p.id, p.year_born
FROM person p
WHERE p.year_born < (SELECT MAX(p.year_born) FROM person AS p)));",2018-08-31 10:24:02.08796+10,3,0,426,partially correct
9684,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 10:24:12.173603+10,1,1,454,correct
9685,"select r.id from role r, (select s.title, s.production_year, s.scene_no, a.description from scene s, appearance a where s.title = a.title and s.production_year = a.production_year and a.scene_no = s.scene_no and lower(s.title) = 'psycho' and s.production_year = 1960 ) AS P where P.title = r.title and P.production_year = r.production_year and r.description = P.description GROUP BY r.id HAVING COUNT(*) = 1;
",2018-08-31 10:24:13.017852+10,10,1,399,correct
9686,"select ma.title,ma.production_year,p.first_name,p.last_name from Movie_Award as ma inner join director as d inner join person as p 
on ma.title=d.title and ma.production_year=d.production_year and p.id=d.id 
where lower(ma.award_name)='bafta film award' and ma.category='best film' and lower(ma.result)='won' order by award_name;",2018-08-31 10:24:23.669104+10,8,1,101,correct
9687,"SELECT id
FROM
(SELECT p.id, p.year_born
FROM person p
WHERE p.year_born < (SELECT MAX(p.year_born) FROM person AS p))
WHERE year_born = (SELECT MAX(year_born) FROM (
SELECT p.id, p.year_born
FROM person p
WHERE p.year_born < (SELECT MAX(p.year_born) FROM person AS p)));",2018-08-31 10:24:25.006328+10,3,1,426,correct
9688,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS
(
	SELECT ma.title, ma.production_year FROM movie_award ma WHERE result=""won"" AND ma.title=m.title AND ma.production_year=m.production_year
	UNION
	SELECT ca.title, ca.production_year FROM crew_award ca WHERE result=""won"" AND ca.title=m.title AND ca.production_year=m.production_year
	UNION
	SELECT da.title, da.production_year FROM director_award da WHERE result=""won"" AND da.title=m.title AND da.production_year=m.production_year
	UNION
	SELECT wa.title, wa.production_year FROM writer_award wa WHERE result=""won"" AND wa.title=m.title AND wa.production_year=m.production_year
	UNION
	SELECT aa.title, aa.production_year FROM actor_award aa WHERE result=""won"" AND aa.title=m.title AND aa.production_year=m.production_year
);",2018-08-31 10:24:40.101559+10,11,0,382,partially correct
9689,"select count(*)
from (person natural join (select distinct id from writer)as w )as p
where p.year_born=1935;",2018-08-31 10:24:45.373498+10,1,1,149,correct
9690,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 10:25:06.20121+10,3,1,215,correct
9691," SELECT COUNT(*) FROM PERSON p, WRITER w WHERE p.id = w.id AND p.year_born = '1935';",2018-08-31 10:25:13.485853+10,1,0,404,partially correct
9692,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 10:25:32.155458+10,1,1,146,correct
9693,"SELECT title, production_year
FROM movie (;",2018-08-31 10:25:38.201129+10,5,0,127,noninterpretable
9694,"select id, max(number)
from
(select id, count(*) as number
from 
(select w.id as id,w.title as title, w.production_year as production_year
 from writer as w
 union
 select d.id as id, d.title as title, d.production_year as production_year
 from director as d)
group by id);

",2018-08-31 10:25:48.212841+10,14,0,291,partially correct
9695,;,2018-08-31 10:26:08.782429+10,3,0,322,noninterpretable
9696,"select count(*) form writer_award where id =
(select id from person where lower(first_name) = 'woody' and last_name = 'allen')
and year_of_award <=1995 and year_of_award >=1991;",2018-08-31 10:26:27.348769+10,9,0,367,noninterpretable
9697,"select wp.title, wp.production_year
from (writer natural join person) as wp
where lower(wp.first_name)='kevin' and lower(wp.last_name)='williamson';",2018-08-31 10:26:28.516623+10,5,1,128,correct
9698,"select count(*) from writer_award where id =
(select id from person where lower(first_name) = 'woody' and last_name = 'allen')
and year_of_award <=1995 and year_of_award >=1991;",2018-08-31 10:26:43.480043+10,9,0,367,partially correct
9699,"select id from role r
where r.description in (select a.description from appearance a
where a.title=""Psycho"" and a.production_year=1960
group by a.description
having count(*)=1)and r.title='Psycho'
and r.production_year=1960;
",2018-08-31 10:27:09.909767+10,10,1,323,correct
9700,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where wa.result = 'won' and
wa.id = w.id and
w.id = p.id and
wa.title = w.title and
lower(p.first_name)='woody' and
lower(p.last_name)='allen' and 
wa.production_year between 1991 and 1995;
",2018-08-31 10:28:01.561587+10,9,0,430,partially correct
9701,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where wa.result = 'won' and
wa.id = w.id and
w.id = p.id and
wa.title = w.title and
lower(p.first_name)='woody' and
lower(p.last_name)='allen' and 
wa.production_year between 1991 and 1995;
",2018-08-31 10:28:09.68612+10,9,0,430,partially correct
9702,"select title, production_year,first_name,last_name
from person , (select id,ma.title ,ma.production_year from
movie_award as ma, director as d 
where ma.title=d.title
and award_name=""BAFTA Film Award"") as x
where x.id=person.id;",2018-08-31 10:28:33.194169+10,8,0,207,partially correct
9821,"select id
from
person
where
year_born in (select max(year_born)
              from
                  (select year_born
                   from person
                   where year_born < (select max(year_born) from person)
                  ) as m);",2018-08-31 10:58:31.098903+10,3,1,271,correct
9703,"select r.id from 
role r, appearance a, scene s
where
	a.title=s.title and
	a.production_year=s.production_year and 
	a.scene_no=s.scene_no and
	r.title=a.title and
	r.production_year=a.production_year and
	r.description=a.description and
	lower(a.title)='psycho'and
	a.production_year=1960
group by r.id
having count(*)=1;
",2018-08-31 10:28:52.315889+10,10,1,32,correct
9704,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where lower(wa.result) = 'won' and
wa.id = w.id and
w.id = p.id and
wa.title = w.title and
lower(p.first_name)='woody' and
lower(p.last_name)='allen' and 
wa.production_year between 1990 and 1996;
",2018-08-31 10:29:06.396601+10,9,1,430,correct
9705,);,2018-08-31 10:29:14.47152+10,11,0,193,noninterpretable
9706,"select production_year, count(*) from movie where production_year in (1993, 1992, 1991) group by production_year;",2018-08-31 10:29:57.365582+10,2,1,194,correct
9707,"with scene_Psycho as
(select *
from scene
where  lower(title) = 'psycho' and production_year = 1960)

select r.id
from role r, scene_Psycho sp, Appearance a
where r.title = sp.title and r.production_year = sp.production_year and r.description = a.description and 
a.title = sp.title and a.production_year = sp.production_year and a.scene_no = sp.scene_no
group by r.id
having count(*) =1;

",2018-08-31 10:30:45.546389+10,10,1,170,correct
9708,"SELECT COUNT(*)-2
FROM movie m
WHERE NOT EXISTS
(
	SELECT ma.title, ma.production_year FROM movie_award ma WHERE result=""won"" AND ma.title=m.title AND ma.production_year=m.production_year
	UNION
	SELECT ca.title, ca.production_year FROM crew_award ca WHERE result=""won"" AND ca.title=m.title AND ca.production_year=m.production_year
	UNION
	SELECT da.title, da.production_year FROM director_award da WHERE result=""won"" AND da.title=m.title AND da.production_year=m.production_year
	UNION
	SELECT wa.title, wa.production_year FROM writer_award wa WHERE result=""won"" AND wa.title=m.title AND wa.production_year=m.production_year
	UNION
	SELECT aa.title, aa.production_year FROM actor_award aa WHERE result=""won"" AND aa.title=m.title AND aa.production_year=m.production_year
);",2018-08-31 10:30:47.225424+10,11,1,382,correct
9709,"SELECT id, award_name, year_of_award, category
FROM director d, director_award da
WHERE exists(
	SELECT *
	FROM director_award da
	WHERE  d.title = da.title and da.result != 'won'
);",2018-08-31 10:32:11.458632+10,13,0,215,partially correct
9710,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE da.title=d.title
	and da.production_year=d.production_year
	and lower(da.result)='nominated'
	and d.id not in(
	
	SELECT d.id
	
	FROM director d,director_award da
	
	WHERE d.title=da.title
		and d.production_year=da.production_year
		and lower(da.result)='won')
;",2018-08-31 10:32:32.580941+10,13,1,132,correct
9711,"select * from movie_award m, crew_award c, director_award d where m.title;",2018-08-31 10:32:45.375427+10,11,0,399,partially correct
9712,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d NATURAL JOIN director_award da
WHERE EXISTS (
	SELECT * FROM director_award da1 WHERE d.title = da1.title AND d.production_year = da1.production_year AND lower(da1.result) = 'nominated')
AND NOT EXISTS (
	SELECT * FROM director_award da2 WHERE d.title = da2.title AND d.production_year = da2.production_year AND lower(da2.result) = 'won');",2018-08-31 10:33:00.323236+10,13,1,219,correct
9713,"SELECT production_year, COUNT(*)
FROM MOVIE m
GROUP BY production_year HAVING production_year IN (1993,1992,1991);",2018-08-31 10:33:00.80012+10,2,1,404,correct
9714,"select person.id
from person
where exists(
select writer.id, director.id
from writer, director
where writer.id = person.id and director.id = person.id);",2018-08-31 10:33:03.387859+10,14,0,337,partially correct
9715,select count(*);,2018-08-31 10:33:05.709091+10,10,0,430,noninterpretable
9716,"Select id From Role Natural Join Appearance Group By id, title, production_year Having title = 'Psycho' AND production_year = '1960' AND Count(*) = 1;",2018-08-31 10:33:22.755669+10,10,1,36,correct
9717,"SELECT id
FROM person
WHERE year_born=(SELECT MAX(year_born) FROM person WHERE year_born<(SELECT MAX(year_born) FROM person));",2018-08-31 10:33:35.845701+10,3,1,322,correct
9718,"SELECT production_year, count(production_year)
FROM movie
GROUP BY production_year
HAVING production_year = '1993' AND production_year = '1992' AND production_year = '1991';",2018-08-31 10:33:49.616401+10,2,0,446,partially correct
9719,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
              FROM writer w
		   WHERE p.id = w.id AND
		         lower(p.year_born) = '1935');",2018-08-31 10:33:57.04415+10,1,1,144,correct
9720,"SELECT id, first_name,last_name 

FROM person p

WHERE EXISTS (SELECT * FROM writer w
		WHERE EXISTS (SELECT * FROM director d, WHERE w.id=d.id and w.id=p.id));",2018-08-31 10:34:13.09818+10,4,0,453,noninterpretable
9721,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM (SELECT title,production_year
      FROM MOVIE_AWARD
      WHERE lower(award_name) = 'bafta film award'
	AND lower (category) = 'best film'
	AND lower (result) = 'won') AS ma,
	DIRECTOR AS d,
	PERSON AS p
WHERE 
	ma.title = d.title
	AND ma.production_year = d.production_year
	AND d.id = p.id;",2018-08-31 10:34:18.067533+10,8,1,435,correct
9722,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 10:34:21.547996+10,11,1,193,correct
9723,"select id,first_name,last_name
from person
order by year_born desc
limit 1;",2018-08-31 10:34:34.232626+10,7,1,128,correct
9724,"select distinct ma.title, ma.production_year, p.first_name, p.last_name

from movie_award ma,
person p,
director d

where lower(ma.award_name)='bafta film award'
and lower(ma.category)='best film'
and lower(ma.result)='won'
and p.id=d.id
and d.production_year=ma.production_year
and d.title=ma.title;",2018-08-31 10:34:34.922693+10,8,1,377,correct
9725,"Select id,title, production_year from WRITER_AWARD WA
WHERE RESULT='won'
;",2018-08-31 10:34:35.02338+10,12,0,182,partially correct
9726,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 10:34:49.912391+10,10,1,430,correct
9727,"SELECT COUNT(mm.*)
FROM  (SELECT *  FROM movie_award m WHERE m.result='not won') ma,
(SELECT *  FROM crew_award c WHERE c.result=='not won')ca,
(SELECT *  FROM director_award d WHERE d.result='not won') da,
(SELECT *  FROM writer_award w WHERE w.result='not won')wa,
(SELECT *  FROM actor_award a WHERE  a.result='not won') aa
WHERE ma.title=ca.title AND ma.title=da.title AND ma.title=wa.title AND ma.title=aa.title 
AND ma.production_year=ca.production_year AND ma.production_year=da.production_year 
AND ma.production_year=wa.production_year AND ma.production_year=aa.production_year;
",2018-08-31 10:35:25.663473+10,11,0,439,noninterpretable
9859,"select count(*)
from person, writer
where person.id = writer.id
and person.year_born = '1935';
",2018-08-31 11:07:58.486971+10,1,0,129,partially correct
9728,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 10:35:29.754629+10,13,1,215,correct
9729,"Select id From Role Natural Join Appearance Group By id, title, production_year Having title = 'Psycho' AND production_year = '1960' AND Count(*) = 1;",2018-08-31 10:35:42.338795+10,10,1,36,correct
9730,"select id
from
(select id, count(*) as number
from 
(select w.id as id,w.title as title, w.production_year as production_year
 from writer as w
 union
 select d.id as id, d.title as title, d.production_year as production_year
 from director as d)
group by id) 
where number in (select max(number)
                from(select id, count(*) as number
                from 
 (select w.id as id,w.title as title, w.production_year as production_year
 from writer as w
 union
 select d.id as id, d.title as title, d.production_year as production_year
 from director as d)
group by id));

",2018-08-31 10:35:42.936817+10,14,1,291,correct
9731,"select d.id, da.award_name, da.year_of_award, da.category
from  director_award da, director d
where d.title=da.title
	and d.production_year = da.production_year
	and lower(da.result) = 'nominated'
	and id not in(
		select d.id
		from director d, director_award da
		where d.title = da.title
			and d.production_year = da.production_year
			and lower(da.result) = 'won');",2018-08-31 10:35:47.717547+10,13,1,389,correct
9732,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 10:36:15.498745+10,2,1,446,correct
9733,"select p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r,
(select id, count(*) as no_of_roles
	from role
	group by id) AS b
WHERE r.id=p.id
AND r.id=b.id
AND b.no_of_roles in(select max(a.no_of_roles)
				from (select count(*) as no_of_roles
					from role
					group by id) AS a);",2018-08-31 10:36:40.010709+10,15,1,121,correct
9734,"select count(*)
from
(select distinct id
from
writer
natural join
person
where year_born = 1935) as p;",2018-08-31 10:36:52.793487+10,1,1,271,correct
9735,"SELECT COUNT(*) FROM PERSON p WHERE NOT EXISTS (SELECT * FROM DIRECTOR d, PERSON p WHERE d.id = p.id);",2018-08-31 10:36:52.967088+10,12,0,404,partially correct
9736,"select production_year,count(*) as numbers from movie 
where production_year>=1991 and production_year<=1993 group by production_year;",2018-08-31 10:37:00.79655+10,2,1,341,correct
9737,"select w.count(*)

FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND year_born = 1935;
",2018-08-31 10:37:17.037101+10,1,0,418,noninterpretable
9738,"select foo.id from



(


select id,count(*) as c from role group by id
) as foo
where foo.c= (
select max(c) from(
select id,count(*) as c from role group by id
)as foo


);",2018-08-31 10:37:27.862544+10,15,0,172,partially correct
9739,"select p.id,p.first_name,p.last_name
from person p,(select distinct d.id,count(*) as num from
director d 
join writer w on d.title=w.title and d.production_year=w.production_year
group by d.id) as a
where p.id=a.id and a.num>=2;",2018-08-31 10:37:40.293546+10,4,0,230,partially correct
9740,SELECT COUNT(*) FROM PERSON p WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE d.id = p.id);,2018-08-31 10:38:03.86052+10,12,1,404,correct
9741,"select production_year, count(*)
from
movie
where
production_year>=1991
and
production_year<=1993
group by production_year;",2018-08-31 10:38:32.855929+10,2,1,271,correct
9742,select count(*) from person where id not in (select id from director);,2018-08-31 10:38:47.348064+10,12,1,333,correct
9743,"select count(*) from person where id not in(
select p.id from person p natural join director d);",2018-08-31 10:39:20.407726+10,12,1,194,correct
9744,);,2018-08-31 10:39:21.526127+10,3,0,193,noninterpretable
9745,"select count(id)
from
person
where
id not in (select id from director);",2018-08-31 10:39:27.703189+10,12,1,271,correct
9746,"SELECT production_year, COUNT(*)
FROM movie
GROUP BY production_year
HAVING production_year < 1994 AND production_year > 1990;",2018-08-31 10:39:49.735809+10,2,1,454,correct
9747,"select count(*) as num
from WRITER_AWARD as wa
where wa.id in
		(select p.id from PERSON as p
		where p.first_name = 'Woody'
			and p.last_name ='Allen')
		and wa.year_of_award between '1991'and '1995';
",2018-08-31 10:40:08.306676+10,9,0,167,partially correct
9748,"SELECT;
",2018-08-31 10:40:21.661839+10,3,0,445,noninterpretable
9749,"select count(*) as num
from WRITER_AWARD as wa
where wa.id in
		(select p.id from PERSON as p
		where p.first_name = 'Woody'
			and p.last_name ='Allen')
		and wa.year_of_award between '1991'and '1995'
		and lower(result) = 'won';
",2018-08-31 10:40:40.072237+10,9,1,167,correct
9750,"SELECT production_year,count(*) from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-31 10:40:50.555764+10,2,1,238,correct
9751,"SELECT count(*)

FROM person p
WHERE EXISTS (SELECT * FROM WRITER w WHERE w.id = p.id and p.year_born = 1935);",2018-08-31 10:41:05.72199+10,1,1,417,correct
9752,"with ms as
(select ma.title, ma.production_year
from movie_award ma natural join movie m
where lower(ma.result) = 'won')
select count(*)
from movie m, ms
where m.title !=ms.title and m.production_year != ms.production_year;
",2018-08-31 10:41:15.894176+10,11,0,170,partially correct
9753,select;,2018-08-31 10:41:16.490637+10,13,0,445,noninterpretable
9754,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
	FROM person
	WHERE year_born<(SELECT MAX(year_born)
		FROM person));",2018-08-31 10:41:44.568035+10,3,1,193,correct
9755,select;,2018-08-31 10:41:52.57703+10,14,0,445,noninterpretable
9756,"select count(*) from person p where
not exists (select * from director d where p.id = d.id); ",2018-08-31 10:42:00.34326+10,12,1,194,correct
9757,"select first_name,last_name, title, production_year,description 
from person,role
where person.id=role.id
and person.id in(
select foo.id from
(


select id,count(*) as c from role group by id
) as foo
where foo.c= (
select max(c) from(
select id,count(*) as c from role group by id
)as foo
)


);",2018-08-31 10:42:21.645048+10,15,1,172,correct
9758,select * from director;,2018-08-31 10:42:24.41653+10,15,0,250,partially correct
9759,select;,2018-08-31 10:42:29.821063+10,15,0,445,noninterpretable
9760,"with dd as (
	 select * from director d natural join director_award da
)

select dd.id from dd 
where dd.id not in
(select dd.id from dd
where dd.result='won'
group by dd.id
having count(*)>=1);",2018-08-31 10:42:33.839832+10,13,0,323,partially correct
9761,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) as dw
Group By dw.id
Having count(*)>1;",2018-08-31 10:42:35.51956+10,4,1,246,correct
9762,"SELECT id, award_name, year_of_award, category
FROM director_award, director
WHERE director_award.title=director.title AND director_award.production_year=director.production_year AND lower(result)='nominated'
EXCEPT
SELECT id, award_name, year_of_award, category
FROM director_award, director
WHERE director_award.title=director.title AND director_award.production_year=director.production_year AND lower(result)='won';",2018-08-31 10:42:39.109111+10,13,1,322,correct
9763,"select *
from person natural join role
where id =(
select id
from person natural join role
group by id
having count(*) =(
	
select count(*) as n1
from person natural join role
group by id
order by n1 desc
limit 1
)

)





;",2018-08-31 10:42:59.334697+10,15,0,387,partially correct
9764,"select count(*) from writer_award as wa inner join person as p on wa.id=p.id
where wa.year_of_award>1990 and wa.year_of_award<1996 and lower(p.first_name)='woody' and lower(p.last_name)='allen' and lower(wa.result)='won';",2018-08-31 10:43:08.095105+10,9,1,101,correct
9765,"select distinct id, first_name, last_name
from
director
natural join
writer
natural join
person
where
id in
(
select m.id from
(select id, count(id) as cc
from
director
natural join
writer
group by id) as m
where 
m.cc >=2);",2018-08-31 10:43:23.992994+10,4,1,271,correct
9766,"select first_name,last_name,title,production_year,description
from person natural join role
where id =(
select id
from person natural join role
group by id
having count(*) =(
	
select count(*) as n1
from person natural join role
group by id
order by n1 desc
limit 1
)

)





;",2018-08-31 10:43:30.759728+10,15,1,387,correct
9767,"select * from movie_award m, crew_award c, director_award d where m.title;",2018-08-31 10:43:38.337037+10,3,0,399,partially correct
9768,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS
(
	SELECT ma.title, ma.production_year FROM movie_award ma WHERE lower(ma.result)=""won"" AND ma.title=m.title AND ma.production_year=m.production_year 
	UNION
	SELECT ca.title, ca.production_year FROM crew_award ca WHERE lower(ca.result)=""won"" AND ca.title=m.title AND ca.production_year=m.production_year 
	UNION
	SELECT da.title, da.production_year FROM director_award da WHERE lower(da.result)=""won"" AND da.title=m.title AND da.production_year=m.production_year 
	UNION
	SELECT wa.title, wa.production_year FROM writer_award wa WHERE lower(wa.result)=""won"" AND wa.title=m.title AND wa.production_year=m.production_year 
	UNION
	SELECT aa.title, aa.production_year FROM actor_award aa WHERE lower(aa.result)=""won"" AND aa.title=m.title AND aa.production_year=m.production_year 
); 

",2018-08-31 10:43:46.699561+10,11,1,382,correct
9769,"with dd as (
	 select * from director d natural join director_award da
)

select dd.id,dd.award_name,dd.year_of_award,dd.category from dd 
where dd.id not in
(select dd.id from dd
where dd.result='won'
group by dd.id
having count(*)>=1);",2018-08-31 10:44:08.426612+10,13,1,323,correct
9770,"SELECT COUNT (*) 
FROM WRITER_AWARD AS wa,WRITER AS w,PERSON AS p
WHERE wa.title = w.title
AND wa.production_year > 1990
AND wa.production_year < 1996
AND wa.production_year = w.production_year
AND w.id = p.id
AND lower (p.first_name) = 'woody'
AND lower (p.last_name) = 'allen';",2018-08-31 10:44:11.408749+10,9,1,435,correct
9771,"SELECT p.id
FROM person p
WHERE MAX(year_born)
SORT BY year_born DESC;",2018-08-31 10:44:39.292443+10,3,0,439,noninterpretable
9772,"select title, production_year,first_name,last_name
from person , (select id,ma.title ,ma.production_year from
movie_award as ma, director as d 
where ma.title=d.title
and award_name=""BAFTA Film Award""
and lower(category)='best film' 
and lower(result)='won')as x
where x.id=person.id;",2018-08-31 10:44:45.593113+10,8,1,207,correct
9773,"SELECT p.id
FROM person p
WHERE MAX(year_born)
ORDER BY year_born DESC;",2018-08-31 10:44:54.011894+10,3,0,439,noninterpretable
9774,"SELECT production_year, count(title)
FROM movie
WHERE production_year = '1993' or production_year = '1992' or production_year = '1991'
GROUP BY production_year;",2018-08-31 10:44:56.636894+10,2,1,144,correct
9775,"select title, production_year
from
writer
natural join
person
where
first_name = 'Kevin'
and
last_name = 'Williamson';
",2018-08-31 10:45:04.181958+10,5,1,271,correct
9776,"SELECT person.id
FROM  (
	SELECT person.id, title 
	FROM director d, writer w
	WHERE person.id = d.id and d.production_year = w.production_year
	UNION
	SELECT person.id, title
	FROM writer w, director d
	WHERE w.id = d.id and w.production_year = d.production_year
)as un,person p
WHERE person.id in(
	SELECT 
);",2018-08-31 10:45:07.138489+10,14,0,215,noninterpretable
9777,"
	da.result = 'Won';",2018-08-31 10:46:10.828179+10,13,0,193,noninterpretable
9778,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 10:46:13.59819+10,11,1,401,correct
9779,"select country
from
restriction
where
lower(title) = 'shakespeare in love'
and
lower(description) = 'm';",2018-08-31 10:46:38.290461+10,6,1,271,correct
9780,"select id, first_name, last_name from person where id in(
select d.id from director d natural join writer w group by d.id having count(*) > 1);",2018-08-31 10:46:40.868408+10,4,1,194,correct
9781,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 10:47:10.087825+10,14,1,312,correct
9782,"SELECT id
FROM ROLE r,
	APPEARANCE a
WHERE r.title= a.title ='Psycho' AND
	r.production_year = 1960 AND
	a.scene_no= one;",2018-08-31 10:47:36.108625+10,10,0,287,noninterpretable
9783,"select id, first_name, last_name
from person
where year_born in (select max(year_born) from person);",2018-08-31 10:47:36.942582+10,7,1,271,correct
9784,"SELECT id
FROM director d, writer w
WHERE MAXCount(*)=(COUNT(SELECT title, production_year FROM movie m
                   WHERE m.title=d.title and m.production_year=d.production_year)) UNION (Count(SELECT title, production_year
				   FROM movie m WHERE m.title=w.title and m.production_year=w.production_year));",2018-08-31 10:47:46.973196+10,14,0,424,noninterpretable
9785,"select count(distinct id)
from writer 
where id in (select id 
             from person p
		  where year_born='1935');
",2018-08-31 10:48:30.597847+10,1,1,244,correct
9786,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 10:48:35.329297+10,10,1,367,correct
9787,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT *
                  FROM director d
			 WHERE p.id = d.id);",2018-08-31 10:49:26.202159+10,12,1,144,correct
9788,"select dw.id, dw.first_name, dw.last_name from
(person p natural join director d natural join writer w) as dw
group by dw.id having count(*) > 1;",2018-08-31 10:49:26.706401+10,4,1,194,correct
9789,"select r.id
from role r,
scene s,
appearance a
where s.title = a.title and
s.production_year = a.production_year and
s.scene_no = a.scene_no and
s.title = r.title and 
s.production_year = r.production_year and 
lower(s.title) = 'psycho' and
s.production_year = 1960
group by r.id
having count(*) =1;
",2018-08-31 10:49:26.904087+10,10,0,430,partially correct
9790,"SELECT COUNT(*)
FROM person,writer
WHERE person.id=writer.id
AND person.year_born=1935; ",2018-08-31 10:49:36.891546+10,1,0,402,partially correct
9791,"select dw.id, dw.first_name, dw.last_name from
(person p natural join director d natural join writer w) as dw
group by dw.id having count(*) > 1;",2018-08-31 10:49:37.794782+10,4,1,194,correct
9792,"select title, production_year, first_name, last_name
from
person
natural join
director
natural join
movie_award
where
lower(result)='won'
and
lower(award_name) = 'bafta film award'
and
lower(category) = 'best film'; ",2018-08-31 10:49:44.006866+10,8,1,271,correct
9793,"select title,production_year,first_name,last_name
from (movie_award natural join director natural join person) as mdp
where lower(mdp.award_name)='bafta film award' and lower(category)='best film';",2018-08-31 10:49:47.626907+10,8,0,128,partially correct
9860,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 11:08:33.685608+10,4,1,452,correct
9794,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 10:49:49.552686+10,13,1,193,correct
9795,"select count(*)
from writer w, person p
where w.id=p.id
and p.year_born='1935';",2018-08-31 10:50:08.878695+10,1,0,121,partially correct
9796,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person as p, role as r, (select r.id, count(*) as noofrole from role r group by r.id) as h
where p.id=r.id and r.id=h.id and h.noofrole=(select max(noofrole) from (select r.id, count(*) as noofrole from role r group by r.id) as k);",2018-08-31 10:50:17.783292+10,15,1,273,correct
9797,"SELECT COUNT(*)
FROM person AS p
WHERE EXISTS (SELECT * FROM writer w WHERE p.id=w.id
AND p.year_born=1935);",2018-08-31 10:51:22.519368+10,1,1,395,correct
9798,"SELECT first_name, last_name
FROM person NATURAL JOIN director;",2018-08-31 10:51:34.402244+10,12,0,446,partially correct
9799,"select count(*)
from
writer
natural join
writer_award
natural join
person
where
lower(result) = 'won'
and
lower(first_name) = 'woody'
and
lower(last_name) = 'allen'
and
year_of_award >=1991
and
year_of_award<=1995;",2018-08-31 10:51:48.380658+10,9,1,271,correct
9800,"select production_year, count(*)
from movie
where production_year in ('1991','1992','1993')
group by production_year;",2018-08-31 10:52:44.129317+10,2,1,244,correct
9801,"SELECT id, first_name, last_name
FROM PERSON p 
WHERE p.id = ( SELECT d2.id FROM (SELECT * FROM DIRECTOR d1, WRITER w WHERE d1.id = w.id AND d1.title = w.title AND d1.production_year = w.production_year) d2
GROUP BY d2.id HAVING COUNT(*)>=2);
",2018-08-31 10:52:49.841724+10,4,0,242,partially correct
9802,"select distinct title,production_year,first_name,last_name
from (movie_award natural join director natural join person) as mdp
where lower(mdp.award_name)='bafta film award' 
	and lower(category)='best film' 
	and lower(result)='won';",2018-08-31 10:53:11.6304+10,8,1,128,correct
9803,"select p.first_name, p.last_name
from person p
where p.id = 

(with y as
(select x1.id, count(*) As MostRoles
	from (select r.id, r.title, r.production_year, r.description
		from role as r)x1
	group by x1.id)
select y.id from y where
y.MostRoles = (select MAX(y.MostRoles)from y));",2018-08-31 10:53:18.205312+10,15,0,111,partially correct
9804,"select id
from
role
natural join
appearance
where
lower(title) = 'psycho'
and
production_year = 1960
group by id
having
count(id) = 1;",2018-08-31 10:53:30.93445+10,10,1,271,correct
9805,"SELECT COUNT(id)
FROM person p
WHERE NOT EXISTS (SELECT d.id
			 FROM director d
			 WHERE p.id = d.id);",2018-08-31 10:53:44.061033+10,12,1,454,correct
9806,"select * from
movie m left join
movie_award ma on m.title=ma.title and m.production_year=ma.production_year
left join crew_award ca on m.title=ca.title and m.production_year=ca.production_year
left join director_award da on m.title=da.title and m.production_year=da.production_year
left join writer_award wa on m.title=wa.title and m.production_year=wa.production_year
left join actor_award aa on m.title=aa.title and m.production_year=aa.production_year
;",2018-08-31 10:54:03.30167+10,11,0,391,partially correct
9807,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM 
            movie_award as ma,
       
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id
AND
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ;",2018-08-31 10:54:57.003172+10,8,1,22,correct
9808,"select p.first_name, p.last_name, r.title, r.production_year, r.description 
from person as p, role as r 
where p.id = r.id 
and r.id in (select d.id from (select c.id, max(a) from (select id, count(r.id) as a from role as r group by r.id) as c) as d);",2018-08-31 10:55:07.816613+10,15,1,99,correct
9809,"select count(*)
from
(select award_name, year_of_award
from writer_award as wa, (
select p.id from person as p
where first_name='Woody' and last_name='Allen' ) as x
where wa.id=x.id
and lower(result)='won'
and year_of_award>1990
and year_of_award<1996) as t1 ;
",2018-08-31 10:56:04.407318+10,9,1,207,correct
9810,"SELECT d.id, d.award_name, d.year_of_award, d.category
FROM (director NATURAL JOIN director_award ) d
WHERE NOT EXISTS (SELECT da.* FROM director_award da WHERE lower(da.result)='won');",2018-08-31 10:56:16.375887+10,13,0,439,partially correct
9811,"select count(*)
from
movie m
where
title not in (select title from movie_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from crew_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from director_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from writer_award where lower(result) = 'won' and production_year = m.production_year)
and
title not in (select title from actor_award where lower(result) = 'won' and production_year = m.production_year);",2018-08-31 10:56:30.919073+10,11,1,271,correct
9812,"SELECT id
FROM
(SELECT id, MAX(c)
FROM
(SELECT id, count(*) AS c
FROM(
SELECT id, title,production_year FROM writer
UNION 
SELECT id, title,production_year FROM director)
GROUP BY id) AS t)
;",2018-08-31 10:56:45.051606+10,14,0,426,partially correct
9813,"select count(*)
from person p
where exists (select * from writer w
		where w.id=p.id
		and p.year_born='1935');",2018-08-31 10:56:47.105599+10,1,1,121,correct
9814,"SELECT p.id
FROM person p, writer w, director d
WHERE (p.id=w.id OR p.id=d.id)
	AND w.title=m.title
	AND w.production_year=m.production_year
	AND d.title=m.title
	AND d.production_year=m.production_year;",2018-08-31 10:57:01.773442+10,14,0,193,noninterpretable
9815,"select id,first_name, last_name from Person where id in ( select d.id from director d, writer w where d.id = w.id
and w.title = d.title and w.production_year = d.production_year
group by d.id having count(d.id) > 1);

",2018-08-31 10:57:16.517657+10,4,1,333,correct
9816,"select w.title, w.production_year from person p natural join writer w
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-31 10:57:23.323225+10,5,1,194,correct
9817,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 10:57:48.251491+10,4,1,242,correct
9818,"SELECT id
FROM (SELECT id,COUNT(*) as time
FROM(
SELECT id,production_year,title
FROM director
UNION 
SELECT id,production_year,title
FROM writer) as a
GROUP by a.id)
WHERE time=(
SELECT MAX(time)
FROM
(SELECT id,COUNT(*) as time
FROM(
SELECT id,production_year,title
FROM director
UNION 
SELECT id,production_year,title
FROM writer) as a
GROUP by a.id))
;",2018-08-31 10:58:01.255246+10,14,1,132,correct
9819,"SELECT id FROM role, scene, appearance WHERE
role.title=('Psycho') AND
role.title=scene.title AND
role.title=appearance.title AND
role.production_year=1960 AND
role.production_year=scene.production_year AND
role.production_year=appearance.production_year AND
role.description=appearance.description AND
scene.scene_no=appearance.scene_no
GROUP BY id HAVING count(*)=1;",2018-08-31 10:58:12.456241+10,10,1,210,correct
9820,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 10:58:14.7178+10,14,1,193,correct
9891,"SELECT
title,production_year
FROM WRITER,PERSON
WHERE WRITER.id= PERSON.id and last_name='Williamson' and first_name='Kevin';",2018-08-31 11:12:56.943207+10,5,1,428,correct
9823,"SELECT r.id
FROM ROLE AS r, APPEARANCE AS a
WHERE lower(a.title) = 'psycho'
AND lower(a.production_year) = 1960
AND a.title = r.title
AND a.production_year = r.production_year
AND a.description = r.description
GROUP BY id
HAVING COUNT(*) = 1;",2018-08-31 10:58:56.475974+10,10,0,435,partially correct
9824,select;,2018-08-31 10:58:57.57141+10,6,0,398,noninterpretable
9825,"select r.id from scene as s inner join appearance as a inner join role as r 
on a.title=s.title and a.production_year=s.production_year and a.scene_no=s.scene_no and a.title=r.title and a.production_year=r.production_year
and a.description=r.description
where lower(s.title)='psycho' and s.production_year=1960 group by r.id having count(r.id)=1;",2018-08-31 10:59:19.822282+10,10,1,101,correct
9826,"

with y as
(select x1.id, count(*) As MostRoles
	from (select r.id, r.title, r.production_year, r.description
		from role as r)x1
	group by x1.id)
	
select y.id,p.first_name,p.last_name,r.title,r.production_year,r.description 
from y,person p,role r 
where
	y.MostRoles = (select MAX(y.MostRoles)from y)
	and y.id=p.id 
	and p.id = r.id;",2018-08-31 10:59:23.685348+10,15,0,111,partially correct
9827,"SELECT id
FROM
(SELECT id, count(*) AS c
FROM(
SELECT id, title,production_year FROM writer
UNION 
SELECT id, title,production_year FROM director)
GROUP BY id)

WHERE c = (SELECT max(c) FROM (SELECT id, count(*) AS c
FROM(
SELECT id, title,production_year FROM writer
UNION 
SELECT id, title,production_year FROM director)
GROUP BY id)
)
;",2018-08-31 10:59:57.284083+10,14,1,426,correct
9828,"SELECT COUNT(*)
FROM writer w, person p
WHERE w.id=p.id 
	AND p.year_born=1935;

",2018-08-31 11:00:03.064365+10,1,0,193,partially correct
9829,"

with y as
(select x1.id, count(*) As MostRoles
	from (select r.id, r.title, r.production_year, r.description
		from role as r)x1
	group by x1.id)
	
select p.first_name,p.last_name,r.title,r.production_year,r.description 
from y,person p,role r 
where
	y.MostRoles = (select MAX(y.MostRoles)from y)
	and y.id=p.id 
	and p.id = r.id;",2018-08-31 11:00:04.371945+10,15,1,111,correct
9830,"select production_year, count(*)
from movie
where production_year > 1990
and production_year < 1994
group by production_year;",2018-08-31 11:00:15.520314+10,2,1,121,correct
9831,"SELECT r.id
FROM ROLE r,
	APPEARANCE a,
	SCENE S
WHERE r.title= a.title  AND
	a.title = s.title AND
	lower(a.title)='psycho' AND
	r.production_year = a.production_year AND
	r.production_year = s.production_year AND
	a.production_year =1960 AND
	 s.scene_no = a.scene_no AND
	 a.description = r.description
GROUP BY r.id
Having COUNT(*)=1;",2018-08-31 11:01:09.030684+10,10,1,287,correct
9832,select count(p.id) from person p inner join writer w on p.id=w.id where year_born=1935;,2018-08-31 11:01:11.506969+10,1,0,456,partially correct
9833,s;,2018-08-31 11:01:13.698947+10,7,0,398,noninterpretable
9834,"select id, award_name, year_of_award, category
from
director_award
natural join
director
where
lower(result) = 'nominated'
and
id not in (select id from director_award natural join director where lower(result) = 'won')
group by id,award_name, year_of_award, category
having count(id) > 0;",2018-08-31 11:01:16.249504+10,13,1,271,correct
9835,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 11:02:26.073496+10,10,1,435,correct
9836,"SELECT UNIQUE country
FROM restriction
WHERE title = 'Shakespeare in Love'
AND description = 'M"";",2018-08-31 11:02:36.726683+10,6,0,127,noninterpretable
9837,"

with y as
(select x1.id, count(*) As MostRoles
	from (select r.id, r.title, r.production_year, r.description
		from role as r)x1
	group by x1.id)
	
select p.first_name,p.last_name,r.title,r.production_year,r.description 
from y natural join person as p natural join role as r
where
	y.MostRoles = (select MAX(y.MostRoles)from y);",2018-08-31 11:02:37.036139+10,15,1,111,correct
9838,"SELECT first_name,last_name,title,production_year,description
FROM person p,role r,(
SELECT id,MAX(time)
FROM(
SELECT p.id,count(*) as time
FROM person p,role r
WHERE p.id=r.id
GROUP BY p.id))as t
WHERE t.id=p.id
	and t.id=r.id
	
;",2018-08-31 11:02:46.549944+10,15,1,132,correct
9839,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-31 11:02:58.824892+10,12,1,446,correct
9840,"select distinct id
from (appearance natural join role) as ar
where lower(title)='psycho'
	and production_year=1960;",2018-08-31 11:03:10.453247+10,10,0,128,partially correct
9841,"with NoOfWorkedOn as (select x1.id,count(*) as NoOfWorkedOn from(
select d.id,title,production_year from director d 
union 
select w.id,title,production_year from writer w) x1 group by x1.id)
select x.id from NoOfWorkedOn x
where x.NoOfWorkedOn=(select max(x2.NoOfWorkedOn) from NoOfWorkedOn x2);",2018-08-31 11:03:54.732003+10,14,1,341,correct
9842,"select count(*)
from person p
where not exists (select*from director d
			where p.id=d.id);",2018-08-31 11:03:56.951419+10,12,1,121,correct
9843,"select count(*)
from person p 
where id not in (select id
from director d 
where  p.id=d.id);",2018-08-31 11:03:59.312869+10,12,1,244,correct
9844,"select production_year,count(*)
from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-31 11:04:19.733655+10,2,1,149,correct
9845,"select id
from (appearance natural join role) as ar
where lower(title)='psycho'
	and production_year=1960
group by id
having count(*)=1;",2018-08-31 11:04:45.407599+10,10,1,128,correct
9846,;,2018-08-31 11:05:15.612779+10,11,0,435,noninterpretable
9847,;,2018-08-31 11:05:18.014414+10,14,0,322,noninterpretable
9848,select count(*) from person p where EXISTS (select * from writer w where w.id=p.id and year_born=1935);,2018-08-31 11:05:18.273734+10,1,1,456,correct
9849,"SELECT dw.id, dw.first_name, dw.last_name
FROM(person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*) > 1; 
",2018-08-31 11:05:19.734299+10,4,1,144,correct
9850,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 11:05:24.391046+10,4,1,453,correct
9851,"select p.first_name, p.last_name, r.title, r.production_year from person p,role r where p.id = r.id and p.id = (select r2.id from (select r.id, count(*) as c from role r group by r.id having c = (select max(r1.c) from ( select count(*) as c from role r group by r.id) r1))r2);",2018-08-31 11:05:51.774728+10,15,0,172,partially correct
9852,Select count(award_name) from writer_award where year_of_award>1990 AND year_of_award<1996;,2018-08-31 11:06:04.598062+10,9,0,166,partially correct
9853,"select id from person 
where year_born = (select max(year_born) 
from person where year_born < (select max(year_born) from person));",2018-08-31 11:06:14.466659+10,3,1,367,correct
9854,"SELECT f.id, f.first_name, f.last_name
FROM (SELECT * FROM writer NATURAL JOIN director) as f;",2018-08-31 11:06:53.782304+10,4,0,446,noninterpretable
9855,"SELECT wm.first_name,wm.last_name,wm.id,wm.title, wm.production_year
FROM (Writer NATURAL JOIN movie NATURAL JOIN  person) AS wm
Group by wm.first_name
Having wm.last_ name like Williamson AND wm.first_ name like'Kevin'; ",2018-08-31 11:07:33.925958+10,5,0,246,noninterpretable
9856,"with numbers as (select id, count(*) as number from role group by id)
select p.first_name,p.last_name,r.title,r.production_year,r.description from
person p,role r,numbers b
where
r.id =p.id
and p.id=b.id
and b.number = (select max(a.number) from numbers a);",2018-08-31 11:07:38.104695+10,15,1,341,correct
9857,"select id
from crew c,scene s
where c.title = s.title
and s.production_year = c.production_year
and s.production_year = '1960'
and s.scene_no = '1'
and lower(s.title) = 'psycho';",2018-08-31 11:07:49.171563+10,10,0,276,partially correct
9858,"select r.id
from role r,
scene s,
appearance a
where s.title = a.title and
s.production_year = a.production_year and
s.scene_no = a.scene_no and
s.title = r.title and
a.description = r.description and
s.production_year = r.production_year and 
lower(s.title) = 'psycho' and
s.production_year = 1960
group by r.id
having count(*) =1;
",2018-08-31 11:07:51.785767+10,10,1,430,correct
9861,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:08:38.1078+10,11,1,435,correct
9862,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 11:08:41.588417+10,1,1,162,correct
9863,"
GROUP BY f.id
HAVING count(*) > 1;",2018-08-31 11:08:41.933299+10,4,0,446,noninterpretable
9864,"SELECT count(*) FROM
(SELECT movie.title FROM movie
EXCEPT
SELECT movie_award.title FROM movie_award WHERE movie_award.result='won'
EXCEPT
SELECT crew_award.title FROM crew_award WHERE crew_award.result='won'
EXCEPT
SELECT director_award.title FROM director_award WHERE director_award.result='won'
EXCEPT
SELECT writer_award.title FROM writer_award WHERE writer_award.result='won'
EXCEPT
SELECT actor_award.title FROM actor_award WHERE actor_award.result='won') AS a;",2018-08-31 11:08:42.645671+10,11,0,210,partially correct
9865,"select p.id from  ( select d.id from director d union select w.id from writer 


select count (*) form (select d.id form director d union select id.writer from writer w ;



",2018-08-31 11:08:44.500733+10,14,0,65,noninterpretable
9866,"SELECT title, production_year FROM writer w

WHERE EXISTS (SELECT * FROM person p where p.id =w.id and p.first_name='Kevin' and p.last_name='Williamson');",2018-08-31 11:09:04.765379+10,5,1,453,correct
9867,;,2018-08-31 11:09:11.498965+10,2,0,162,noninterpretable
9868,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS (SELECT d.id
		   FROM director d INNER JOIN writer w ON d.id = w.id
		   WHERE p.id = d.id
		   GROUP BY d.id
		   HAVING COUNT(*) > 2);",2018-08-31 11:09:15.637629+10,4,1,454,correct
9869,SELECT TABLE TIME;,2018-08-31 11:09:15.789784+10,12,0,355,noninterpretable
9870,"select count(*)
from person as p
where not exists (select distinct id 
			 from director as d
			 where d.id=p.id);
",2018-08-31 11:09:21.096899+10,12,1,149,correct
9871,"select count(*)

from (writer_award natural join person )as wp

where lower(wp.first_name)='woody'
and lower(wp.last_name)='allen'
and wp.year_of_award>=1991 and wp.year_of_award<=1995;",2018-08-31 11:09:28.637663+10,9,0,377,partially correct
9872,"SELECT production_year,count(*)
FROM movie m
WHERE m.production_year = 1993
OR  m.production_year = 1992
OR m.production_year = 1991


;",2018-08-31 11:09:38.426293+10,2,0,402,partially correct
9873,;,2018-08-31 11:09:50.227131+10,11,0,430,noninterpretable
9874,"select h.id
from (select a.id, count(*) as no
      from (select d.id, d.title, d.production_year from director d 
            union
	      select w.id, w.title, w.production_year from writer w) as a
	      group by a.id) as h
where h.no = (select max(h.no)
              from (select a.id, count(*) as no
                    from (select d.id, d.title, d.production_year from director d 
                          union
	                    select w.id, w.title, w.production_year from writer w) as a
	                    group by a.id) as h );",2018-08-31 11:09:51.721394+10,14,1,272,correct
9875,"SELECT f.id, f.first_name, f.last_name 
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS f 
GROUP BY f.id 
HAVING count(*) > 1;",2018-08-31 11:09:58.138452+10,4,1,446,correct
9876,"select count(*)
from movie m
where not exists (
select ma.title, ma.production_year from movie_award ma where lower(ma.result) = 'won' and m.title = ma.title and m.production_year = ma.production_year
union 
select ca.title, ca.production_year from crew_award ca where lower(ca.result) = 'won' and m.title = ca.title and m.production_year = ca.production_year
union 
select da.title, da.production_year from director_award da where lower(da.result) = 'won' and m.title = da.title and m.production_year = da.production_year
union 
select wa.title, wa.production_year from writer_award wa where lower(wa.result) = 'won' and m.title = wa.title and m.production_year = wa.production_year
union 
select aa.title, aa.production_year from actor_award aa where lower(aa.result) = 'won' and m.title = aa.title and m.production_year = aa.production_year);",2018-08-31 11:09:58.913181+10,11,1,170,correct
9877,ss;,2018-08-31 11:10:00.616338+10,8,0,398,noninterpretable
9878,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:10:24.075928+10,11,1,430,correct
9879,"SELECT f_name, l_name, r.title, r.production_year, r.description
FROM role r, person p
WHERE MAX(Noofroles)=COUNT(SELECT title, production_year, description FROM appearance a WHERE r.title=a.title AND r.production_year=a.production_year
AND r.description=a.description) AS Noofroles);",2018-08-31 11:10:37.757133+10,15,0,424,noninterpretable
9880,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994;",2018-08-31 11:10:47.14485+10,2,0,162,partially correct
9881,"
GROUP BY production_year;",2018-08-31 11:10:57.804662+10,2,0,162,noninterpretable
9882,"select count(*)

from (writer_award natural join person )as wp

where lower(wp.first_name)='woody'
and lower(wp.last_name)='allen'
and lower(result)='won'
and wp.year_of_award>=1991 and wp.year_of_award<=1995;",2018-08-31 11:11:03.004715+10,9,1,377,correct
9883,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 11:11:20.561439+10,2,1,162,correct
9884,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994;",2018-08-31 11:11:36.343799+10,2,0,162,partially correct
9885,"SELECT id, first_name, last_name 
FROM person
HAVING MAX(year_born);
",2018-08-31 11:11:41.828938+10,7,0,127,noninterpretable
9886,"select id
from
(select id, title, production_year from writer
union
select id, title, production_year from director) as m
group by id
having
count(id) = (
select max(cc) 
            from (select id,count(id) as cc from (select id, title,     production_year from writer
union
select id, title, production_year from director) as m
group by id) as m1)
;",2018-08-31 11:11:45.531051+10,14,1,271,correct
9887,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 11:11:45.913318+10,2,1,162,correct
9888,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 11:11:52.785476+10,2,1,162,correct
9889,"SELECT wp.title, wp.production_year
FROM (writer w NATURAL JOIN person p) AS wp
WHERE lower(first_name) = 'kevin' AND lower(last_name) = 'williamson';",2018-08-31 11:11:58.716731+10,5,1,144,correct
9890,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 11:11:59.033609+10,2,1,162,correct
9892,"SELECT c.id, c.first_name, c.last_name FROM
((SELECT * FROM Restriction r, Crew c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'PG-13' AND r.country = 'USA') AS c1,
(SELECT * FROM Restriction r, Crew c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'PG' AND r.country = 'USA') AS c2,
(SELECT * FROM Restriction r, Crew c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'G' AND r.country = 'USA') AS c3,
(SELECT * FROM Restriction r, Crew c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'R' AND r.country = 'USA') AS c4) AS c
WHERE c1.id = c2.id
AND c2.id = c3.id
AND c3.id = c4.id;",2018-08-31 11:13:07.285169+10,14,0,218,partially correct
9893,"select count(*)
from person as p
where exists(select * from writer where p.year_born = 1935);",2018-08-31 11:13:08.045818+10,1,0,225,partially correct
9894,"SELECT r.country FROM restriction r

WHERE 
lower(title)='shakespeare in love'
AND description = 'M';",2018-08-31 11:13:33.728882+10,6,1,453,correct
9895,;,2018-08-31 11:13:34.82204+10,12,0,402,noninterpretable
9896,"select count(*) from movie m
where not exists (select title, production_year from movie_award ma where Lower(ma.result = 'won') and 
ma.title = m.title and m.production_year = ma.production_year
union
select title, production_year from crew_award ca where Lower(ca.result = 'won') and 
ca.title = m.title and m.production_year = ca.production_year
union
select title, production_year from director_award da where Lower(da.result = 'won') and 
da.title = m.title and m.production_year = da.production_year
union
select title, production_year from writer_award wa where Lower(wa.result = 'won') and 
wa.title = m.title and m.production_year = wa.production_year
union
select title, production_year from actor_award aa where Lower(aa.result = 'won') and 
aa.title = m.title and m.production_year = aa.production_year
);

",2018-08-31 11:14:23.403238+10,11,0,130,partially correct
9897,dsda;,2018-08-31 11:14:28.157433+10,9,0,398,noninterpretable
9898,"SELECT title, production_year
FROM WRITER ;",2018-08-31 11:15:06.319796+10,5,0,242,partially correct
9899,"

select ma.title, ma.production_year,d.id,p.last_name,p.first_name from
director d,person p,( select title, production_year from movie_award 
where lower(award_name) = 'bafta film award'
  and lower(category) = 'best film'
  and lower(result) = 'won' ) as ma
where d.id = p.id
  and d.title = ma.title
  and d.production_year = ma.production_year
;",2018-08-31 11:15:17.288803+10,8,0,333,partially correct
9900,"SELECT country
FROM restriction
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-31 11:15:28.320902+10,6,1,144,correct
9901,"select h.id from (select e.id, max(d) from (select a.id, count(*) as d from (select d.id, d.title, d.production_year from director as d union select w.id, w.title, w.production_year from writer as w)  as a group by a.id) as e) as h;",2018-08-31 11:15:33.719241+10,14,0,99,partially correct
9902,"

select ma.title, ma.production_year,p.first_name,p.last_name from
director d,person p,( select title, production_year from movie_award 
where lower(award_name) = 'bafta film award'
  and lower(category) = 'best film'
  and lower(result) = 'won' ) as ma
where d.id = p.id
  and d.title = ma.title
  and d.production_year = ma.production_year
;",2018-08-31 11:15:54.239073+10,8,1,333,correct
9903,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:16:09.709845+10,11,1,391,correct
9904,;,2018-08-31 11:16:14.355398+10,14,0,389,noninterpretable
9905,"select production_year,count(production_year) from movie where production_year=1993 or production_year=1992 or production_year=1991;",2018-08-31 11:16:23.515811+10,2,0,456,partially correct
9906,;,2018-08-31 11:16:44.174237+10,3,0,435,noninterpretable
9907,"select title, production_year as py from 
writer natural join person as wp
where wp.first_name=""Kevin"" and wp.last_name=""Williamson"";",2018-08-31 11:16:52.275029+10,5,1,452,correct
9908,"SELECT country
FROM RESTRICTION
WHERE title=""Shakespeare in love"" and description=""M"";",2018-08-31 11:16:58.021143+10,6,0,428,partially correct
9909,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 11:17:18.350592+10,5,1,246,correct
9910,"

select count(distinct person.id) 
from person, writer
where person.id = writer.id
and person.year_born = 1935;",2018-08-31 11:17:42.224979+10,1,1,129,correct
9911,"select first_name, last_name, title, production_year, description
from
role
natural join
person
group by first_name, last_name, title, production_year, description
having id in (select id 
              from 
                   (select id, count(id) as count
                         from
                         role
                         natural join
                         person
                         group by id) as m
              where count =
                   (select max(count)
                   from (select id, count(id) as count
                         from
                         role
                         natural join
                         person
                         group by id) as m)
                  );",2018-08-31 11:18:19.718568+10,15,1,271,correct
9912,"

SELECT p.id, p.first_name,p.last_name 
FROM person p
WHERE EXISTS (SELECT MIN(year_born) from person);",2018-08-31 11:18:37.893001+10,7,0,453,partially correct
9913,"select production_year,count(*) from movie where production_year>1990 and production_year<1994 group by production_year;",2018-08-31 11:18:48.550843+10,2,1,456,correct
9914,"

SELECT p.id, p.first_name,p.last_name 
FROM person p
WHERE year_born=(SELECT MIN(year_born) from person);",2018-08-31 11:19:22.421164+10,7,0,453,partially correct
9915,"with dw as(
	select * from (director d natural join writer w)
) , a as(select dw.id, count(id) c from dw
group by id)

select id from a
where a.c=
(select max(c) from a );",2018-08-31 11:19:36.164948+10,14,0,323,partially correct
9916,";
",2018-08-31 11:19:43.627933+10,4,0,402,noninterpretable
9917,"select d.id, da.award_name, da.year_of_award, da.category from director d natural join director_award da where lower(da.result) = 'nominated' and not exists (select * from director q natural join director_award p where lower(p.result) = 'won');",2018-08-31 11:19:50.664563+10,13,0,399,partially correct
9918,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT max(year_born)
                   FROM person);",2018-08-31 11:21:11.528974+10,7,1,144,correct
9919,"select count(*)

from movie m

where (m.title, m.production_year) not in
(
select title, production_year
from movie_award
where lower(result)='won'
union
select title, production_year
from writer_award
where lower(result)='won'
union
select title, production_year
from director_award
where lower(result)='won'
union
select title, production_year
from actor_award
where lower(result)='won'
union
select title, production_year
from crew_award
where lower(result)='won'
);
",2018-08-31 11:21:15.130649+10,11,1,128,correct
9920,select count(distinct id) from person where id in (select id from writer) and year_born=1935; ,2018-08-31 11:21:17.045876+10,1,1,190,correct
9921,"

SELECT p.id, p.first_name,p.last_name 
FROM person p
WHERE year_born=(SELECT MAX(year_born) from person);",2018-08-31 11:21:45.326473+10,7,1,453,correct
9922,"

SELECT dt.id
FROM dt
WHERE mv=
 (SELECT MAX(mv)
FROM (SELECT COUNT(*)AS mv
FROM dt
GROUP BY dt.id);",2018-08-31 11:21:49.905093+10,14,0,439,noninterpretable
9923," SELECT country
 FROM  Restriction 
 WHERE lower(title)='Shakespeare in Love as M';",2018-08-31 11:22:04.674787+10,6,0,246,partially correct
9924,"select count(*)
from person as p
where exists(select * from writer as w where p.id = w.id and p.year_born = 1935);",2018-08-31 11:22:14.309081+10,1,1,225,correct
9925,"SELECT
    w.title, w.production_year
FROM
    writer w, person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 11:22:16.103548+10,5,1,242,correct
9926,;,2018-08-31 11:22:44.486988+10,15,0,181,noninterpretable
9927,;,2018-08-31 11:23:14.484371+10,1,0,386,noninterpretable
9928,"select pw.title,pw.production_year
from (select *
      from person p, writer w
	  where p.id=w.id
	  and lower(p.first_name)='kevin'
	  and lower(p.last_name)='williamson') as pw;",2018-08-31 11:23:41.091118+10,5,1,237,correct
9929,"Select count(w.award_name) 
from writer_award w INNER JOIN person p
where w.id=p.id
AND w.year_of_award>1990 
AND w.year_of_award<1996 
AND p.first_name='Woody' 
AND p.last_name='Allen'
AND w.result='won';",2018-08-31 11:23:50.579259+10,9,1,166,correct
9930,select count(*) from person p where NOT EXISTS (select * from director d where d.id=p.id);,2018-08-31 11:24:03.719204+10,12,1,456,correct
9931,"select r.id from ROLE as r
where r.description in
			(select a.description from APPEARANCE as a
			where lower(a.title) = 'psycho' 
				and a.production_year = '1960'
			group by a.description
			having count(*) = 1)
			and lower(r.title) = 'psycho' 
				and r.production_year = '1960';",2018-08-31 11:24:08.547231+10,10,1,167,correct
9932,"with list as
(select title, production_year 
from movie
where production_year >= 1991
and production_year <= 1993)
select count(*) from list;",2018-08-31 11:24:27.236713+10,2,0,129,partially correct
9933,;,2018-08-31 11:24:36.541155+10,5,0,402,noninterpretable
9934,"SELECT * 
FROM person;
",2018-08-31 11:24:55.250453+10,12,0,162,partially correct
9935,"SELECT title, production_year, first_name, last_name
FROM (movie_award ma NATURAL JOIN director d NATURAL JOIN person p) AS mad
WHERE lower(award_name) LIKE 'bafta%' AND
      lower(category) LIKE 'best film%' AND
      lower(result) LIKE 'won%';",2018-08-31 11:24:58.938415+10,8,0,144,partially correct
9936,;,2018-08-31 11:25:10.865292+10,3,0,430,noninterpretable
9937,ssss;,2018-08-31 11:26:07.099746+10,10,0,398,noninterpretable
9938,"SELECT title, production_year
FROM movie
WHERE EXISTS (SELECT title
		   FROM person p NATURAL JOIN writer w
		   WHERE first_name = 'Kevin' AND last_name = 'Williamson');",2018-08-31 11:26:09.87973+10,5,0,454,partially correct
9939,"select id
from role,(
select description ,count(*) from Appearance
where title= 'Psycho'
and production_year=1960
group by description
having count(*)=1) as x
where role.description=x.description
and title= 'Psycho'
and production_year=1960
;
",2018-08-31 11:26:26.264867+10,10,1,207,correct
9940,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 11:26:29.071693+10,14,1,389,correct
9941,"select country
from restriction 
where lower(title)='shakespeare in love'
and lower(description='m');",2018-08-31 11:26:31.877983+10,6,0,237,partially correct
9942,"SELECT country
FROM RESTRICTION
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-31 11:26:54.948848+10,6,1,242,correct
9943,; ,2018-08-31 11:27:00.914498+10,6,0,402,noninterpretable
9944,"select *
from movie m, (select * from person p inner join writer w on p.id = w.id) as pw
where pw.first_name = ""Kevin "" and pw.last_name = ""Williamson ""
and m.title = pw.title;",2018-08-31 11:27:04.833986+10,5,0,275,partially correct
9945,"
select production_year, count(*)
from movie
where production_year >= 1991
and production_year <= 1993
group by production_year;",2018-08-31 11:27:23.648674+10,2,1,129,correct
9946,"select country
from restriction 
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-31 11:27:32.293885+10,6,1,237,correct
9947,"select production_year,count(*) from movie where production_year in (1991,1992,1993) group by production_year;",2018-08-31 11:27:37.005386+10,2,1,190,correct
9948,"select d.id,da.award_name,da.year_of_award,da.category from director d, director_award da
where d.title = da.title 
and d.production_year = da.production_year
and lower(result) = 'nominated'
;
",2018-08-31 11:27:38.999532+10,13,1,367,correct
9949,;,2018-08-31 11:27:51.829103+10,15,0,389,noninterpretable
9950,"
select count(distinct person.id) 
from person, writer
where person.id = writer.id
and person.year_born = 1935;",2018-08-31 11:27:52.168137+10,1,1,129,correct
9951,"
WHERE NOT EXISTS (SELECT *
FROM director d
WHERE d.id = p.id);",2018-08-31 11:27:52.962909+10,12,0,162,noninterpretable
9952,"select count(*)
from (
select title, production_year, result
from (
select title, production_year, result from movie_award
union
select title, production_year, result from crew_award
union
select title, production_year, result from director_award
union
select title, production_year, result from writer_award
union
select title, production_year, result from actor_award
) as all_award
)
where lower(result) != ""won"";",2018-08-31 11:27:55.015678+10,11,0,337,partially correct
9953,"
WHERE NOT EXISTS (SELECT *
FROM director d
WHERE p.id = d.id);",2018-08-31 11:28:05.780111+10,12,0,162,noninterpretable
9954,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:28:07.132644+10,11,1,152,correct
9955,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 11:28:16.798232+10,3,1,430,correct
9956,"

select distinct p.id,p.first_name,p.last_name
from person p natural join director d natural join writer w
where p.id=d.id and d.id=w.id 
group by d.id 
having count(title)>=2;",2018-08-31 11:28:20.842679+10,4,1,244,correct
9957,; ,2018-08-31 11:28:24.387109+10,7,0,402,noninterpretable
9958,"
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);",2018-08-31 11:28:24.396923+10,12,0,162,noninterpretable
9959," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 11:28:24.522017+10,6,0,246,partially correct
9960," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 11:28:29.01775+10,6,0,246,partially correct
9961," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 11:28:38.853294+10,6,0,246,partially correct
9962,select count(distinct id) from person where id not in (select id from director);,2018-08-31 11:28:40.165954+10,12,1,190,correct
9963,"select country from 
scene natural join restriction_category as sr
group by sr. title = ""Shakespeare in Love""
having sr. description = ""M"";",2018-08-31 11:28:44.058406+10,6,0,452,noninterpretable
9964,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d WHERE d.id = p.id);",2018-08-31 11:28:44.0914+10,12,1,162,correct
9965,"select count(*) as no_of_writers
from person p, writer w
where p.id=w.id
and p.year_born='1935';",2018-08-31 11:28:55.67108+10,1,0,349,partially correct
9968,;,2018-08-31 11:29:08.752791+10,13,0,430,noninterpretable
9969,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM person p
INNER JOIN director d ON p.id = d.id
INNER JOIN movie_award ma ON d.title = ma.title
WHERE lower(award_name) = 'bafta film award' AND
      lower(category) = 'best film' AND
      lower(result) = 'won';",2018-08-31 11:29:10.156998+10,8,1,144,correct
9970,"
select id
from person
where year_born = (select year_born from person not exists (select max(year_born) 
from person); 
",2018-08-31 11:29:14.750504+10,3,0,170,noninterpretable
9971,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person WHERE year_born<(SELECT MAX(year_born) FROM person));",2018-08-31 11:29:17.64674+10,3,1,435,correct
9972,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 11:29:42.900675+10,13,1,430,correct
9973,"SELECT first_name, last_name, title,production_year,description
FROM (person NATURAL JOIN role)
GROUP by id
HAVING count(*) 
= (SELECT max(times)
FROM(
SELECT id,count(*) AS times
FROM (person NATURAL JOIN role) AS j
GROUP by j.id))
;",2018-08-31 11:29:51.766124+10,15,0,426,partially correct
9974,"select p.id,first_name,last_name from person p where id=(select d.id from director d inner join writer w on w.id=d.id group by d.id having count(w.id)>=2);",2018-08-31 11:30:05.120216+10,4,0,456,partially correct
9975,"select count(distinct id)
from person p natural join writer w
where p.year_born = 1935;",2018-08-31 11:30:11.864776+10,1,1,250,correct
9976,"SELECT count(*)
	FROM writer w LEFT JOIN person p
	On w.id = p.id
	Where year_born = 1935;",2018-08-31 11:30:26.931316+10,1,0,457,partially correct
9977,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 11:30:31.430312+10,6,1,428,correct
9978,"select p.id, p.first_name, p.last_name
from (person NATURAL JOIN writer NATURAL JOIN director) AS p
group by p.id
having count(p.id)>1;",2018-08-31 11:30:47.43948+10,4,1,121,correct
9979,"select count(*)
from 
	(select *
	from person p, writer w
	where p.id=w.id
	and p.year_born='1935');",2018-08-31 11:30:49.407249+10,1,0,349,partially correct
9980,"select count(*)
from 
	(select *
	from person p, writer w
	where p.id=w.id
	and p.year_born='1935');",2018-08-31 11:30:54.737298+10,1,0,349,partially correct
9981,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born = (SELECT max(year_born) FROM person );",2018-08-31 11:30:57.590128+10,7,1,402,correct
9982,"SELECT first_name, last_name, title,production_year,description
FROM(person NATURAL JOIN role)
WHERE id = (
SELECT id
FROM (person NATURAL JOIN role)
GROUP by id
HAVING count(*) 
= (SELECT max(times)
FROM(
SELECT id,count(*) AS times
FROM (person NATURAL JOIN role) AS j
GROUP by j.id))
)
;",2018-08-31 11:31:13.59025+10,15,1,426,correct
9983,"select distinct id,first_name,last_name from person where id in (select w.id from writer w inner join director d on w.title=d.title and w.production_year=d.production_year group by w.id having count(*)>=2);",2018-08-31 11:31:36.896292+10,4,0,190,partially correct
9984,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id=p.id AND p.year_born=1935);
",2018-08-31 11:31:44.861447+10,1,1,193,correct
9985,"
select id
from person
where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person)); 
",2018-08-31 11:31:47.033951+10,3,1,170,correct
9986,"select production_year, count(*)
from movie 
where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-31 11:32:27.686005+10,2,1,225,correct
9987,"SELECT count(*)
FROM person 
WHERE year_born=1935;",2018-08-31 11:32:40.853741+10,1,0,253,partially correct
9988,"SELECT *
FROM;",2018-08-31 11:32:46.325663+10,4,0,162,noninterpretable
9989,"select *
from(

select w1.id as tid, w2.id as oid, w1.title, w1.production_year
from writer w1, writer w2
where w1.title=w2.title and w1.production_year=w2.production_year) as x
;",2018-08-31 11:32:49.922405+10,14,0,338,partially correct
9990,"select dw.title, dw.production_year   
from (writer natural join person)as dw
where exists (lower(dw.first_name)= 'kevin'
    AND lower(dw.last_name)= 'williamson');",2018-08-31 11:32:50.069055+10,5,0,181,noninterpretable
9991,;,2018-08-31 11:33:11.929754+10,8,0,402,noninterpretable
9992,"SELECT title, production_year, first_name, last_name
FROM movie, person AS mp
WHERE EXISTS (SELECT title, award_name, category AS tc FROM movie_award, WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' 
AND tc.title = mp.title);",2018-08-31 11:33:22.842333+10,8,0,127,noninterpretable
9993,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 11:33:26.521007+10,6,1,452,correct
9994,"SELECT ma.title, ma.production_year, first_name, last_name
FROM (SELECT title, production_year
      FROM movie_award
      WHERE lower(award_name) = 'bafta film award' AND
            lower(category) = 'best film' AND
            lower(result) = 'won') ma, director d, person p
WHERE d.id = p.id AND ma.title = d.title AND ma.production_year = d.production_year;
",2018-08-31 11:33:40.181031+10,8,1,144,correct
9995,"SELECT production_year,count(*)
FROM movie 
WHERE production_year<1994 and production_year>1990
GROUP BY production_year;
",2018-08-31 11:33:46.047104+10,2,1,195,correct
9996,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p, role r
WHERE p.id=r.id
GROUP BY r.id HAVING COUNT(*)=
(SELECT MAX(x.n)
FROM (SELECT COUNT(*) AS n
FROM role ro
GROUP BY ro.id) x);",2018-08-31 11:33:55.533688+10,15,0,439,partially correct
9997,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 11:34:08.96207+10,4,1,456,correct
9998,"select dw.title, dw.production_year   
from (writer natural join person)as dw
where (lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson');",2018-08-31 11:34:19.983909+10,5,1,181,correct
9999,"SELECT p.id, first_name, last_name FROM PERSON p WHERE id IN 
	(SELECT id FROM DIRECTOR NATURAL JOIN WRITER GROUP BY id HAVING COUNT(*)>1);",2018-08-31 11:34:20.639142+10,4,1,26,correct
10000,"select ma.title, ma.production_year
from person p inner join director d on p.id=d.id inner join movie_award ma 
on  d.title = ma.title and d.production_year = ma.production_year
where ma.result = 'won' and ma.award_name = 'BAFTA Film Award' and ma.category = 'Best Film';",2018-08-31 11:35:16.152597+10,8,0,125,partially correct
10001,"

select count(person.id) from person
where not exists (select director.id from director
where director.id = person.id);",2018-08-31 11:35:17.526472+10,12,1,129,correct
10002,"SELECT title, production_year
FROM person p INNER JOIN writer w ON p.id = w.id
WHERE first_name = 'Kevin' AND last_name = 'Williamson';",2018-08-31 11:35:26.623354+10,5,1,454,correct
10003,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 11:35:34.769587+10,1,1,457,correct
10004,"select count(*) from MOVIE as m
where not exists(
select ma.title, ma.production_year from MOVIE_AWARD as ma
where lower(ma.result) = 'won' and m.title = ma.title
	and m.production_year = ma.production_year
UNION
select ca.title, ca.production_year from CREW_AWARD as ca
where lower(ca.result) = 'won' and m.title = ca.title
	and m.production_year = ca.production_year
UNION
select da.title, da.production_year from DIRECTOR_AWARD as da
where lower(da.result) = 'won' and m.title = da.title
	and m.production_year = da.production_year
UNION
select wa.title, wa.production_year from WRITER_AWARD as wa
where lower(wa.result) = 'won' and m.title = wa.title
	and m.production_year = wa.production_year
UNION
select aa.title, aa.production_year from ACTOR_AWARD as aa
where lower(aa.result) = 'won' and m.title = aa.title
	and m.production_year = aa.production_year);",2018-08-31 11:35:36.848345+10,11,1,167,correct
10045,"SELECT id,first_name, last_name 
FROM person natural join director natural join writer 
GROUP BY id 
HAVING count(*)>1;",2018-08-31 11:41:40.205112+10,4,1,195,correct
10005,"SELECT d.id, da.award_name, da.year_of_award,da.category 
FROM DIRECTOR d, DIRECTOR_AWARD da
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower (da.result) = 'nominated';",2018-08-31 11:35:42.247731+10,13,1,435,correct
10006,"SELECT COUNT(*)
FROM (writer_award wa NATURAL JOIN person p)
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND
      lower(result) = 'won';",2018-08-31 11:35:46.319189+10,9,1,144,correct
10007,"select count(*)
from writer inner join person on writer.id=person.id
where person.year_born=1935;",2018-08-31 11:36:06.066255+10,1,0,253,partially correct
10008,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-31 11:36:10.320434+10,4,1,162,correct
10009,"select count(*) from writer_award wa, person p 
 where p.id = wa.id
   and lower(p.first_name) = 'woody'
   and lower(p.last_name) = 'allen'
   and wa.year_of_award in (1991,1992,1993,1994,1995)
   and wa.result = 'won'
;",2018-08-31 11:36:17.683468+10,9,1,333,correct
10010,"SELECT count(*)
FROM person p
WHERE NOT EXISTS 
(SELECT * 
FROM director d
WHERE d.id=p.id);
",2018-08-31 11:36:21.333593+10,12,1,195,correct
10011,"SELECT md.title, md.production_year, md.first_name, md.last_name
FROM  (movie_award ma NATURAL JOIN director d NATURAL JOIN person) AS md
WHERE lower(ma.category)='best film'
AND	lower(ma.award_name)='bafta film award';",2018-08-31 11:36:37.744254+10,8,0,453,partially correct
10012,"select count(*)
from person p 
where not exists ( select * from director d where p.id = d.id );",2018-08-31 11:36:42.704671+10,12,1,225,correct
10013,"select id, first_name, last_name from person
where person.year_born;",2018-08-31 11:36:44.302666+10,7,0,452,partially correct
10014,"SELECT  id, first_name, last_name
FROM PERSON p;",2018-08-31 11:36:45.714921+10,7,0,242,partially correct
10015,"SELECT COUNT(*)
FROM (writer_award wa NATURAL JOIN person p)
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen' AND
      lower(result) = 'won' AND year_of_award > 1990 AND year_of_award < 1996;",2018-08-31 11:36:48.047201+10,9,1,144,correct
10016,"SELECT title, production_year
FROM(writer NATURAL JOIN movie NATURAL JOIN person)
GROUP BY title
HAVING id = '0000402';",2018-08-31 11:36:59.740302+10,5,0,446,cheating
10017,"SELECT count(*)
FROM person p
WHERE p.id NOT IN
(SELECT d.id 
FROM director d
WHERE d.id=p.id);
",2018-08-31 11:37:36.543204+10,12,1,195,correct
10018,"select m.title,m.production_year from (movie m NATURAL JOIN person p NATURAL JOIN writer w) as d where d.first_name=""Kevin"" and d.last_name=""Williamson"";",2018-08-31 11:37:46.857385+10,5,1,456,correct
10019,"select m.title, m.production_year
from movie m, writer w, person p
where w.id=p.id
and lower(first_name)='kevin'
and lower(last_name)='williamson'
and m.title=w.title
and m.production_year=w.production_year;",2018-08-31 11:38:03.517186+10,5,1,121,correct
10020,"select id from (select p.id,year_born from person as p order by year_born desc limit 2) order by year_born limit 1;
",2018-08-31 11:38:05.135222+10,3,1,31,correct
10021,"select id from  
(select id, count(*)as c from
(select id,title,production_year from writer 
union 
select * from director) as x
group by id)as x1
where c = (select max(c)from (select id, count(*)as c from
(select id,title,production_year from writer 
union 
select * from director) as x
group by id));",2018-08-31 11:38:05.591831+10,14,1,367,correct
10022,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-31 11:38:13.761572+10,6,1,454,correct
10023,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p,role r,(select id,count(*)as number_of_roles from role group by id) as b
where r.id=p.id
and p.id=b.id
and b.number_of_roles in(select max(number_of_roles)from (select id,count(*)as number_of_roles from role group by id)as a);",2018-08-31 11:38:19.769236+10,15,1,22,correct
10024,"select id from PERSON
where PERSON.year_born in
		(select p.year_born from PERSON as p
		order by p.year_born DESC
		limit 1,1);",2018-08-31 11:38:27.853225+10,3,1,167,correct
10025,"SELECT x.id,x.first_name,x.last_name
from(
    select p.id, p.first_name,p.last_name,count(distinct rt1.description)as number
    from
	((select id, production_year,title
	   from role)as natural join
	   (select title,production_year,description
	    from restriction as rr
		where rr.country='USA'))as rt1,
		person as p
	where p.id=rt1.id
	group by p.id
	having number in(select count(*)
	                 from(select title, production_year,description
					from restriction as rr
					where rr.country='USA'
					group by description)as r))
					as x;",2018-08-31 11:38:29.027049+10,4,0,280,partially correct
10026,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p,role r,(select id,count(*)as number_of_roles from role group by id) as b
where r.id=p.id
and p.id=b.id
and b.number_of_roles =(select max(number_of_roles)from (select id,count(*)as number_of_roles from role group by id)as a);",2018-08-31 11:38:40.840025+10,15,1,22,correct
10027,"SELECT id, rst name, last name 
FROM person
Where exists (SELECT MIN(year_born)
              FROM person);",2018-08-31 11:38:53.429596+10,7,0,246,noninterpretable
10028,"SELECT md.title, md.production_year, md.first_name, md.last_name
FROM  (movie_award ma NATURAL JOIN director d NATURAL JOIN person) AS md
WHERE lower(ma.category)='best film'
AND	lower(ma.award_name)='bafta film award'
AND	lower(ma.result)='won';",2018-08-31 11:39:01.493103+10,8,1,453,correct
10029,"select title,production_year from writer where id in (select id from person where first_name='Kevin' and last_name='Williamson');",2018-08-31 11:39:04.790803+10,5,1,190,correct
10030,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );
",2018-08-31 11:39:23.512011+10,7,1,242,correct
10031,;,2018-08-31 11:39:48.741375+10,14,0,430,noninterpretable
10032,"select w.title, w.production_year
from writer w, person p
where p.first_name='Kevin' and p.last_name='Williamson'
and p.id=w.id;
",2018-08-31 11:40:15.225504+10,5,1,244,correct
10033,"SELECT w.title, w.production_year
FROM writer w,person p
WHERE w.id = p.id AND lower(last_name)= 'williamson';",2018-08-31 11:40:19.622451+10,5,1,446,correct
10034,"SELECT id, rst_name, last_name 
FROM person
Where  p.year_born=(SELECT Max(year_born)
              FROM person);",2018-08-31 11:40:21.006614+10,7,0,246,noninterpretable
10035,"select count(*)
from person p
where not exists (select d.id
                    from  director d
                   where p.id=d.id); 
",2018-08-31 11:40:22.875412+10,12,1,79,correct
10036,"SELECT id, rst_name, last_name 
FROM person
Where  p.year_born=(SELECT Max(year_born)
              FROM person);",2018-08-31 11:40:26.078158+10,7,0,246,noninterpretable
10037,;,2018-08-31 11:40:29.215436+10,15,0,312,noninterpretable
10038,"SELECT *
FROM writer;
",2018-08-31 11:40:32.71319+10,5,0,162,partially correct
10039,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 11:40:32.742693+10,14,1,430,correct
10040,"with nda as
(select *
from director_award
where lower(result) = 'nominated')

select d.id, nda.award_name, nda.year_of_award, nda.category
from director d, nda
where nda.title = d.title and nda.production_year = d.production_year;

",2018-08-31 11:40:50.1983+10,13,1,170,correct
10041,"select id, first_name, last_name from person
where person.year_born = (select(max(person.year_born)) from person);",2018-08-31 11:40:54.138389+10,7,1,452,correct
10042,"select md.title, md.production_year, pmd.first_name, pmd.last_name
from (MOVIE natural join DIRECTOR) as md, (PERSON natural join DIRECTOR) as pmd
where md.title = (
	select title
	from MOVIE_AWARD as ma
	where award_name = ""BAFTA Film Award"" AND category = ""Best Film"");",2018-08-31 11:41:14.956493+10,8,0,423,partially correct
10043,"select country
from restriction
where lower(title)='Shakespeare in love'
and description='M';",2018-08-31 11:41:15.874101+10,6,0,121,partially correct
10044,"SELECT production_year, count(*)
From movie 
Group by production_year;",2018-08-31 11:41:16.529609+10,2,0,457,partially correct
10046,"SELECT *
FROM crew c, scene s
WHERE 
	c.title=s.title
	AND c.production_year=s.production_year
	AND lower(c.title)='psycho'
	AND c.production_year=1960
;",2018-08-31 11:41:40.23389+10,10,0,427,partially correct
10047,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT MIN(year_born)
			  FROM person);",2018-08-31 11:41:44.566269+10,7,0,454,partially correct
10048,"select country
from restriction
where lower(title)='Shakespeare in love'
and description ='M';",2018-08-31 11:41:47.45439+10,6,0,121,partially correct
10049,;,2018-08-31 11:42:00.405211+10,9,0,402,noninterpretable
10050,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT MAX(year_born)
			  FROM person);",2018-08-31 11:42:00.540162+10,7,1,454,correct
10051,"select production_year, count(production_year) as Number_of_movies
from movie
where production_year >1990 and production_year <1994
group by production_year;",2018-08-31 11:42:04.227135+10,2,1,250,correct
10052,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN Writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;",2018-08-31 11:42:09.166501+10,4,1,195,correct
10053,;,2018-08-31 11:42:23.960768+10,15,0,430,noninterpretable
10054,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 11:42:38.160426+10,15,1,430,correct
10055,"select r.id
from role r, scene s, appearance a
where s.title = a.title
and s.production_year = a.production_year
and s.scene_no = a.scene_no
and a.title = r.title
and a.production_year = r.production_year
and a.description = r.description
and a.production_year = 1960
and lower(a.title) = 'psycho'
group by r.id
having count(*)=1;",2018-08-31 11:43:03.245518+10,10,1,276,correct
10056,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:43:04.407873+10,11,1,426,correct
10057,"select country
from restriction
where title='Shakespeare in Love' and description='M';",2018-08-31 11:43:08.555844+10,6,1,244,correct
10058,"SELECT country 
FROM restriction
WHERE LOWER(title) = 'shakespeare in love' AND LOWER(description) = 'm';",2018-08-31 11:43:18.394492+10,6,1,446,correct
10059,"select country
from restriction
where lower(title) = 'shakespeare in love'
and description = 'M';",2018-08-31 11:43:46.862789+10,6,1,121,correct
10060,"SELECT r.id from appearance a, scene s, role r 
where (a.title = s.title and a.production_year = s.production_year and
a.scene_no = s.scene_no and s.title = r.title and s.production_year = r.production_year and a.description = r.description and 
a.production_year = '1960'
and lower(r.title) = 'psycho')  group by r.id having count(*) =1;",2018-08-31 11:43:49.32917+10,10,1,213,correct
10061,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 11:43:55.054968+10,15,1,389,correct
10062,"SELECT p.id, p.first_name, p.last_name FROM Person p, DIRECTOR d WHERE (SELECT COUNT(*) FROM WRITER w WHERE w.id=d.id) > 1 AND p.id=d.id;",2018-08-31 11:44:11.316978+10,4,0,404,partially correct
10063,"select country from restriction r where title=""Shakespeare in Love"" and description=""M"";",2018-08-31 11:44:35.250611+10,6,1,456,correct
10064,;,2018-08-31 11:44:39.87977+10,15,0,337,noninterpretable
10065,"SELECT
	w.title, w.production_year
FROM
	writer w,
	person p
WHERE
	w.id = p.id
	AND lower(first_name) = 'kevin'
	AND lower(last_name) = 'williamson';",2018-08-31 11:44:41.527692+10,5,1,162,correct
10066,"select dw.id, dw.first_name, dw.last_name
from ( person p natural join director d natural join writer ) as dw
group by dw.id
having count(*) > 1;",2018-08-31 11:44:47.545724+10,4,1,225,correct
10067,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 11:44:59.773284+10,1,1,430,correct
10068,"SELECT m.title, m.production_year
FROM movie m, writer w, person p
WHERE m.title=w.title AND m.production_year=w.production_year AND w.id =p.id AND lower(p.first_name)='kevin' AND lower(p.last_name)='williamson';",2018-08-31 11:45:03.362081+10,5,1,195,correct
10069,;,2018-08-31 11:45:05.363588+10,15,0,337,noninterpretable
10070,"SELECT
    m.title,
FROM
    movie_award da,
    movie m
WHERE
    da.title = m.title
    AND da.production_year = m.production_year
    AND lower(da.result)= 'nominated'
    AND m.title NOT IN (
        SELECT
            title
        FROM
            movie_award da,
            movie m
        WHERE
            da.title = m.title
            AND da.production_year = m.production_year
            AND lower(da.result)= 'won' );",2018-08-31 11:45:18.449633+10,11,0,337,noninterpretable
10071,"select d.id, da.award_name, da.year_of_award, da.category 
from DIRECTOR as d, DIRECTOR_AWARD as da
where d.title = da.title
	and d.production_year = da.production_year
	and lower(result) = 'nominated'
	and d.id not in
			(select d.id from DIRECTOR as d, DIRECTOR_AWARD as da
			where d.title = da.title
				and d.production_year = da.production_year
				and lower(result) = 'won');",2018-08-31 11:45:24.169005+10,13,1,167,correct
10072,; ,2018-08-31 11:45:31.290327+10,10,0,402,noninterpretable
10073,"SELECT production_year, count(*)
From movie 
Where production_year  = 1991 OR production_year  = 1992 OR  production_year  = 1993
Group by production_year;",2018-08-31 11:45:40.701564+10,2,1,457,correct
10074,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND first_name= 'Kevin'
    AND last_name= 'Williamson';",2018-08-31 11:45:43.693936+10,5,1,195,correct
10075,"select p.id,
	p.first_name,
	p.last_name
from person as p,
	(select wd.id
	from (writer natural join director)as wd
	group by wd.id
	having count(wd.id)>=2
	)as x
where p.id=x.id;",2018-08-31 11:45:48.205302+10,4,1,149,correct
10076,"select id,first_name,last_name
from person
where year_born= (select max(year_born) from person);",2018-08-31 11:45:52.571835+10,7,1,244,correct
10077,sss;,2018-08-31 11:46:12.329251+10,11,0,398,noninterpretable
10078,"select ma.title, ma.production_year,p.first_name,p.last_name
from movie_award ma,
     director d,
     person p
where lower(ma.award_name)='bafta film award'
and   lower(ma.category)='best film'
and   lower(ma.result)='won'
and   ma.title=d.title
and   ma.production_year=d.production_year
and   d.id=p.id;",2018-08-31 11:46:19.511889+10,8,1,237,correct
10137,"select title, production_year as py, first_name, last_name from 
movie_award natural join director natural join person as mdp
where lower(category) = 'best film' and lower (award_name) = 'bafta film award';

",2018-08-31 11:54:59.821138+10,8,0,452,partially correct
10170,"SELECT title, production_year FROM PERSON p, WRITER w WHERE p.id=w.id AND p.first_name='Kevin' AND p.last_name = 'Williamson';",2018-08-31 12:02:15.363924+10,5,1,404,correct
10079,"SELECT m.title
FROM MOVIE m,
	
WHERE NOT EXISTS(
	SELECT(*)
	FROM CREW c,
	DIRECTOR d,
	Writer w,
	Role r,
	Movie Award ma,
	Crew Award ca,
	Director Award da,
	Writer Award wa,
	Actor Award aa
	WHERE ma.title = m.title AND
	lower(ma.result)='won' AND
	ca.title = c.title AND
	c.title = m.title AND
	lower(ca.result)='won' AND
	da.title =d.title AND
	d.title = m.title AND
	lower(da.result)='won' AND
	wa.title = w.title AND
	w.title = m.title AND 
	lower(wa.result)='won' AND
	aa.title = r.title AND
	a.title = m.title AND
	lower(aa.result)='won'

);",2018-08-31 11:46:19.985018+10,11,0,287,noninterpretable
10080,"select country from restriction r where title=""Shakespeare in Love"" and description=""M"";",2018-08-31 11:46:20.458573+10,6,1,456,correct
10081,select country from restriction where lower(title)=lower('Shakespeare in Love') and description=('M'); ,2018-08-31 11:46:28.137092+10,6,1,190,correct
10082,"SELECT COUNT(*) 
FROM (SELECT DISTINCT p.id
FROM person p, writer w
WHERE p.id=w.id AND p.year_born = 1935);",2018-08-31 11:47:12.834524+10,1,1,193,correct
10083,"select id, first_name, last_name
from person
where year_born = (select max(year_born)
	from person);",2018-08-31 11:47:16.596558+10,7,1,121,correct
10084,"select mw.title, mw.production_year, pd.first_name, pd.last_name
from (
	select title, production_year
	from MOVIE_AWARD
	where lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND lower(result) = ""won"") as mw,
	(PERSON natural join DIRECTOR) as pd
where mw.title = pd.title and mw.production_year = pd.production_year;",2018-08-31 11:47:19.615893+10,8,1,423,correct
10085,"SELECT country
FROM restriction AS r
WHERE r.title = 'Shakespeare in Love'
		AND r.description = 'M';",2018-08-31 11:47:36.496699+10,6,1,162,correct
10086,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 11:47:40.502565+10,4,1,22,correct
10087,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:47:45.756322+10,11,1,287,correct
10088,"select title, production_year
from movie
where exists(select * from writer where lower(first_name) = 'kevin' and lower(last_name) = 'williamson');",2018-08-31 11:47:54.063378+10,5,0,225,noninterpretable
10089,"Select id,first_name,last_name
From
person p
Where
p.year_born=(
Select 
 max(year_born)
FROM 
 person );",2018-08-31 11:47:58.626927+10,7,1,246,correct
10090,"select p.id from person as p 
where p.year_born = (select max(year_born)from person where p.id =person.id);",2018-08-31 11:48:00.975229+10,3,0,401,partially correct
10091,;,2018-08-31 11:48:01.34306+10,3,0,287,noninterpretable
10092,"Select id,first_name,last_name
From
person p
Where
p.year_born=(
Select 
 max(year_born)
FROM 
 person );",2018-08-31 11:48:01.91136+10,7,1,246,correct
10093,"select r.id

from scene s,
role r,
appearance a

where
s.title=r.title
and s.title=a.title

and s.production_year=r.production_year
and s.production_year=a.production_year

and s.scene_no=a.scene_no
and r.description=a.description


and lower(a.title)='psycho'
and a.production_year=1960

group by r.id
having count(*)=1;
",2018-08-31 11:48:11.743377+10,10,1,377,correct
10094,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-31 11:48:15.475356+10,7,1,190,correct
10095,"select person.id
from person
where exists(
select writer.id, director.id
from writer, director
where writer.id = person.id and director.id = person.id);",2018-08-31 11:48:37.289036+10,14,0,337,partially correct
10096,;,2018-08-31 11:48:44.818299+10,14,0,435,noninterpretable
10097,"select title, production_year
from writer
where exists(select * from person where lower(first_name) = 'kevin' and lower(last_name) = 'williamson');",2018-08-31 11:48:51.016628+10,5,0,225,partially correct
10098,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 11:48:52.306726+10,3,1,401,correct
10099,"SELECT id,award_name,year_of_award,category
FROM (director NATURAL JOIN director_award)
WHERE lower(result) = 'nominated';",2018-08-31 11:49:07.37097+10,13,1,426,correct
10100,"select p.first_name,p.last_name, r.title, r.production_year, r.description
from person p ,role r
where 
r.id=p.id
and p.id =

(select id 
from (select id,count(*) as c from role
group by id) 
where c= (select max(c) 
from (select id,count(*) as c from role
group by id)));





",2018-08-31 11:49:17.634359+10,15,1,367,correct
10101,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 11:49:22.400225+10,15,1,312,correct
10102,;,2018-08-31 11:49:34.848236+10,11,0,402,noninterpretable
10103,"SELECT id
FROM appearance a, scene s, role r
WHERE 
	a.title=s.title
	AND a.production_year=s.production_year
	AND a.scene_no=s.scene_NO
	AND a.title=r.title
	AND a.production_year=r.production_year
	AND r.description = a.description
	AND lower(a.title)='psycho'
	AND a.production_year=1960
GROUP BY id
HAVING COUNT(id)=1
;",2018-08-31 11:49:37.349483+10,10,1,427,correct
10104,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 11:49:42.0383+10,6,1,181,correct
10105,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 11:49:49.721898+10,14,1,435,correct
10106,"SELECT ma.title, ma.production_year, ma.first_name, ma.last_name
FROM (PERSON p NATURAL JOIN MOVIE_AWARD NATURAL JOIN DIRECTOR) AS ma
WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film' ;",2018-08-31 11:49:59.144059+10,8,0,242,partially correct
10107,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;



",2018-08-31 11:50:09.193327+10,9,1,22,correct
10108,"select count(*)
from person p
where p.id in (select id from writer w where w.id=p.id and p.year_born='1935');",2018-08-31 11:50:17.941823+10,1,1,349,correct
10138,"SELECT r.id
FROM (role r NATURAL JOIN appearance a NATURAL JOIN scene s);",2018-08-31 11:55:00.041238+10,10,0,144,partially correct
10171,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT *
			From director d 
			WHERE p.id = d.id);",2018-08-31 12:02:18.554222+10,12,1,457,correct
10347,"select w.title, w.production_year
from writer as w, person as p
where p.id = w.id and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson;",2018-08-31 12:38:06.90557+10,5,0,225,noninterpretable
10109,"SELECT count(*) 
FROM movie m 
WHERE not exists (
SELECT title, production_year FROM movie_award ma WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT title, production_year FROM crew_award ca WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year FROM director_award da WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION SELECT title, production_year FROM actor_award aa WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
UNION
SELECT title, production_year FROM writer_award wa WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:50:27.965015+10,11,1,210,correct
10110,"

select o.tid, o.oid, max(o.num)
from (
select x.tid, x.oid, count(*) as num
from(
select w1.id as tid, w2.id as oid, w1.title, w1.production_year
from writer w1, writer w2
where w1.title=w2.title and w1.production_year=w2.production_year) as x
where not exists ( select *
from
(select w1.id as tid, w2.id as oid
from writer w1, writer w2
where w1.id=w2.id and w1.title=w2.title and w1.production_year=w2.production_year) as x1
where x1.tid=x.tid and x1.oid=x.oid)
group by x.tid, x.oid
) as o
;",2018-08-31 11:50:39.712036+10,14,0,338,partially correct
10111,"select id
from person
where year_born in (select distinct year_born from person order by year_born desc limit 1 offset 1);",2018-08-31 11:51:03.967615+10,3,1,344,correct
10112,"select *
from APPEARANCE;",2018-08-31 11:51:04.318946+10,10,0,189,partially correct
10113,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 11:51:16.600625+10,3,1,287,correct
10114,;,2018-08-31 11:51:48.251317+10,13,0,287,noninterpretable
10115,"SELECT p.id, p.first_name, p.last_name
FROM person AS p
WHERE
	p.year_born = MIN(p.year_born);",2018-08-31 11:51:52.938214+10,7,0,162,noninterpretable
10116,"SELECT ma.title, ma.production_year, ma.first_name, ma.last_name
FROM (PERSON p NATURAL JOIN MOVIE_AWARD NATURAL JOIN DIRECTOR) AS ma
WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film' AND lower(RESULT)= 'won';",2018-08-31 11:51:55.339975+10,8,1,242,correct
10117,"with newtable as(
select *
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title and d.production_year=ma.production_year
)
select title, production_year, first_name, last_name
from newtable
where  result = 'won' and Lower(award_name)= 'batfa film award' and lower(category)  = 'best';",2018-08-31 11:51:55.942145+10,8,0,125,partially correct
10118,"
SELECT COUNT(wa.id) FROM writer_award wa

WHERE wa.id=(
		SELECT id FROM person
		WHERE lower(first_name)='woody'
		AND lower(last_name)='allen')
AND lower(wa.result)='won';


",2018-08-31 11:52:02.9758+10,9,1,453,correct
10119,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 11:52:17.872595+10,10,1,22,correct
10120,;,2018-08-31 11:52:26.287348+10,14,0,287,noninterpretable
10121,"SELECT id,award_name,year_of_award,category
FROM (director NATURAL JOIN director_award)
WHERE lower(result) = 'nominated' 
AND id not in (SELECT id 
		    FROM (director NATURAL JOIN director_award)
		    WHERE lower(result) = 'won');",2018-08-31 11:52:51.874949+10,13,1,426,correct
10122,"SELECT COUNT(id) as NumberOfAwards
FROM (PERSON NATURAL JOIN WRITER_AWARD) as pa
WHERE lower(pa.first_name) = ""woody"" and lower(pa.last_name) = ""allen"" and pa.year_of_award >= 1991 and pa.year_of_award <= 1995;",2018-08-31 11:52:52.260307+10,9,0,423,partially correct
10123,"select w.title, w.production_year
from writer as w, person as p
where lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson;",2018-08-31 11:52:58.367694+10,5,0,225,noninterpretable
10124,;,2018-08-31 11:53:09.982228+10,14,0,287,noninterpretable
10125,"SELECT COUNT(id) as NumberOfAwards
FROM (PERSON NATURAL JOIN WRITER_AWARD) as pa
WHERE lower(pa.first_name) = ""woody"" and lower(pa.last_name) = ""allen"" and pa.year_of_award >= 1991 and pa.year_of_award <= 1995 and lower(result) = ""won"";",2018-08-31 11:53:22.164926+10,9,1,423,correct
10126,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 11:53:28.215611+10,14,1,287,correct
10127,"select p1.id from person p1 where year_born in (select max(year_born) from person p where 
year_born< (select max(year_born) from person));",2018-08-31 11:53:35.429682+10,3,1,130,correct
10128,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
			From person p1 left join director d on  p1.id = d.id);",2018-08-31 11:53:50.544271+10,12,0,457,partially correct
10129,"with newtable as(
select *
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title and d.production_year=ma.production_year
)
select title, production_year, first_name, last_name
from newtable
where  result = 'won' and Lower(award_name)= 'bafta film award' and lower(category)  = 'best film';",2018-08-31 11:53:55.553475+10,8,1,125,correct
10130,"select title,production_year,first_name,last_name from person natural join (select * from director natural join (select title,production_year  from movie_award where lower(award_name)=lower('BAFTA Film Award') and lower(category)=lower('Best Film') and lower(result)='won'));",2018-08-31 11:54:08.114661+10,8,1,190,correct
10131,;,2018-08-31 11:54:11.631762+10,15,0,287,noninterpretable
10132,"select title, production_year, first_name, last_name as py from 
movie_award natural join director natural join person as mdp
where lower(category) = 'best film' and lower (award_name) = 'bafta film award';

",2018-08-31 11:54:14.226815+10,8,0,452,partially correct
10133,"SELECT id
FROM(
SELECT
	id, COUNT(*) AS ct
FROM
	role
GROUP BY
	id) AS a
WHERE a.ct=(

SELECT MAX(ct)
FROM(
SELECT
	id, COUNT(*) AS ct
FROM
	role
GROUP BY
	id) AS b);",2018-08-31 11:54:19.968111+10,15,0,322,partially correct
10134,"SELECT id, first_name, last_name
FROM person p
WHERE
	p.year_born = (
			SELECT MAX(year_born)
			FROM person);",2018-08-31 11:54:24.943311+10,7,1,162,correct
10135,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 11:54:28.965225+10,15,1,287,correct
10136,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 11:54:51.563667+10,11,1,22,correct
10139,"(select mr.first_name , mr.last_name , mr.title, mr.production_year , mr.description 


from (select * from  movie m natural join  role r natural join 
 
person p as mr ) as x1 group by x1.title, x1.production_year , x1.description) 


where numberofroles = (select max(x2.numberofroles) from 

(select count (*) as numberofroles,  mr.first_name , mr.last_name , mr.title, mr.production_year , mr.description 


from (select * from  movie m natural join  role r natural join 
 
person p as mr ) as x group by x.title, x.production_year , x.description ) x2);
",2018-08-31 11:55:09.600313+10,15,0,65,noninterpretable
10140,"select title, production_year as py, first_name, last_name from 
movie_award natural join director natural join person as mdp
where lower(category) = 'best film' and lower (award_name) = 'bafta film award';

",2018-08-31 11:55:29.706941+10,8,0,452,partially correct
10141,"SELECT COUNT(*) 
FROM writer_award
SELECT id FROM ;",2018-08-31 11:55:35.183052+10,9,0,127,noninterpretable
10142,;,2018-08-31 11:55:45.380258+10,15,0,435,noninterpretable
10143,"SELECT m.title,d.production_year,first_name,last_name
from movie_award m,director d
where award_name = 'BAFTA Film Award'
      AND category ='Best Film';",2018-08-31 11:55:46.426891+10,8,0,246,noninterpretable
10144,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 11:56:01.652504+10,3,1,22,correct
10145,; ,2018-08-31 11:56:25.60894+10,3,0,402,noninterpretable
10146,"SELECT ma.title, ma.production_year, ma.first_name, ma.last_name
FROM (PERSON p NATURAL JOIN MOVIE_AWARD NATURAL JOIN DIRECTOR) AS ma
WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film' AND lower(ma.result)= 'won';",2018-08-31 11:56:52.331598+10,8,1,242,correct
10147,"select d.id, da.award_name, da.year_of_award, da.category
from director as d,director_award as da
where d.title =da.title and
	da.result !='won'
group by d.id
having count(*)>0;
",2018-08-31 11:57:03.309138+10,13,1,401,correct
10148,"select distinct id,first_name,last_name from person group by id,first_name,last_name having min(year_born);",2018-08-31 11:57:24.432128+10,7,0,456,partially correct
10149,"SELECT count(*)
FROM (SELECT w.id, year_born
FROM person p, writer w
WHERE p.id=w.id AND year_born=1935) pw
GROUP BY pw.id;

",2018-08-31 11:57:27.793145+10,1,0,312,partially correct
10150,"select count(*)
from person p 
where exists (SELECT * FROM writer w 
               WHERE  w.id=p.id and p.year_born=1935);",2018-08-31 11:57:32.674626+10,1,1,253,correct
10151,"select l.id from
(select d.id, count(*) as num from DIRECTOR as d, WRITER as w
where d.id = w.id and d.title = w.title and d.production_year = w.production_year
group by d.id) as l
where l.num in
(select MAX(num) from (select d.id, count(*) as num from DIRECTOR as d, WRITER as w
where d.id = w.id and d.title = w.title and d.production_year = w.production_year
group by d.id) as j);
",2018-08-31 11:57:40.878197+10,14,0,167,partially correct
10152,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 11:57:50.977306+10,14,1,22,correct
10153,"select p.first_name, p.last_name, r.*
from person p, 
(
	select *, count(*) as no_of_roles
	from role 
	group by id, title, production_year, description
	order by count(*) desc
) r
where p.id=r.id
limit 1;",2018-08-31 11:57:51.591152+10,15,0,349,partially correct
10154,"select count(*) from writer_award where id in (select id from person where lower(first_name)='woody' and lower(last_name)='allen') and year_of_award in(1991,1992,1993,1994,1995) and lower(result)='won';",2018-08-31 11:58:05.058781+10,9,1,190,correct
10155,"select m.title, m.production_year, p.first_name, p.last_name
from (select * 
	from movie m, movie_award ma
	where m.title=ma.title
	and m.production_year=ma.production_year
	and lower(award_name)='bafta film award'
	and lower(category)='best film'
	and lower(result)='won') as m,
	director d,
	person p
where d.id=p.id
and m.title=d.title
and m.production_year=d.production_year;",2018-08-31 11:58:05.431923+10,8,1,121,correct
10156,"SELECT title, production_year
FROM 
	movie_award ma, 
	crew_award ca,
	director_award da,
	writer_award wa,
	actor_award aa
WHERE
	ma.title = ca.title
	AND ca.title = da.title
	AND da.title = wa.title
	AND wa.title = aa.title
	AND ma.production_year = ca.production_year
	AND ca.production_year = da.production_year
	AND da.production_year = wa.production_year
	AND wa.production_year = aa.production_year
	AND lower(ma.result)='lose'
	AND lower(ca.result)='lose'
	AND lower(da.result)='lose'
	AND lower(wa.result)='lose'
	AND lower(aa.result)='lose'
;",2018-08-31 11:58:08.17701+10,11,0,427,noninterpretable
10157,"select dw.title,dw.production_year,dw.first_name,dw.last_name
from(movie_award natural join director natural join person)as dw
where(lower(dw.award_name)='bafta film award' and lower(dw.category)='best film'and lower(dw.result)='won');",2018-08-31 11:58:29.232785+10,8,1,181,correct
10158,"select id,award_name,year_of_award,category
from director_award,director
where director_award.title = director.title
and director_award.production_year = director.production_year
and lower(result)='nominated'
and id not in (select id
from director_award,director
where director_award.title = director.title
and director_award.production_year = director.production_year
and lower(result)='won');",2018-08-31 11:58:59.501145+10,13,1,344,correct
10159,"SELECT count(*)
FROM (SELECT DISTINCT p.id, year_born
FROM person p, writer w
WHERE p.id=w.id AND year_born=1935) pw
GROUP BY pw.id;

",2018-08-31 11:59:15.509153+10,1,1,312,correct
10160,"SELECT title, production_year
FROM restriction r
    WHERE r.description = 'Best Film';",2018-08-31 11:59:39.271702+10,8,0,162,partially correct
10161,"SELECT country
FROM restriction
WHERE title ='Shakespeare in Love' AND description = 'M';",2018-08-31 12:00:01.678162+10,6,1,195,correct
10162," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 12:00:04.140566+10,6,0,246,partially correct
10163,"select count(person.id)
from person
where person.id not in (select h.id from (person, director) as h
where person.id = director.id);
",2018-08-31 12:00:19.811085+10,12,1,250,correct
10164,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 12:00:36.942719+10,10,1,137,correct
10165,"select count(*)
from writer_award aw inner join person p on aw.id=p.id 
where lower(result)='won'
and year_of_award >= 1991
and year_of_award <= 1995
and lower(first_name)='woody'
and lower(last_name)='allen';
",2018-08-31 12:00:58.819942+10,9,1,237,correct
10166,; ,2018-08-31 12:01:00.985635+10,13,0,402,noninterpretable
10167,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-31 12:01:36.102616+10,6,1,194,correct
10168,"with writer2 as
(select id from writer
group by id
having count(id)>1),
director2 as 
(select id from director
group by id
having count(id)>1),
l as(
select writer2.id
from director2, writer2
where director2.id = writer2.id)
select person.id, first_name, last_name
from person, l 
where person.id = l.id;

",2018-08-31 12:01:53.670942+10,4,1,129,correct
10169,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 12:01:57.328361+10,10,1,221,correct
10172,select id from role where description in (select description from appearance where lower(title)=lower('Psycho')  and production_year=1960 group by description having count(*)=1) and lower(title)=lower('Psycho')  and production_year=1960;,2018-08-31 12:02:24.35755+10,10,1,190,correct
10173,"select id,first_name,last_name from person where year_born=(select max(year_born) from person);",2018-08-31 12:02:50.086523+10,7,1,456,correct
10174,"select id, first_name, last_name from person where year_born =
(select min(year_born) from person);",2018-08-31 12:02:50.659244+10,7,0,194,partially correct
10175,"select * from Appearance;
",2018-08-31 12:02:52.310137+10,10,0,127,partially correct
10176,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person as p, role as r
where p.id =(select p2.id
		  from (select p1.id, max(number)
			  from (select p0.id, count(*)number
				  from role as p0
				  group by p0.id) as p1 ) as p2 )
	and
	r.id=(select p2.id
from (select p1.id, max(number)
	from (select p0.id, count(*)number
		from role as p0
		group by p0.id) as p1 ) as p2 );

",2018-08-31 12:03:08.673556+10,15,1,291,correct
10177,"select count(*)
from writer_award wa
where wa.id =(select p.id from person p
			where p.id=wa.id
			and lower(first_name)='woody'
			and lower(last_name)='allen')
and 1991<= year_of_award <=1995;",2018-08-31 12:03:15.00479+10,9,0,121,noninterpretable
10178,"select id, first_name, last_name from person where year_born =
(select max(year_born) from person);",2018-08-31 12:03:33.249733+10,7,1,194,correct
10179,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person as p, role as r
where p.id =(select p2.id
		  from (select p1.id, max(number)
			  from (select p0.id, count(*)number
				  from role as p0
				  group by p0.id) as p1 ) as p2 )
	and
	r.id=(select p2.id
		  from (select p1.id, max(number)
			  from (select p0.id, count(*)number
				  from role as p0
				  group by p0.id) as p1 ) as p2 );

",2018-08-31 12:03:43.027489+10,15,1,291,correct
10180,"SELECT count(*)
FROM (SELECT DISTINCT p.id, year_born
FROM person p, writer w
WHERE p.id=w.id AND year_born=1935) pw
GROUP BY pw.id;

",2018-08-31 12:03:50.959158+10,1,1,312,correct
10181,"select h.id, h.first_name, h.last_name
from (person natural join director natural join writer) as h
group by h.id
having count(id) >1;",2018-08-31 12:04:40.634665+10,4,1,250,correct
10182,"SELECT id
FROM person
WHERE year_born = (SELECT max(year_born)
                   FROM person
                   WHERE year_born < (SELECT max(year_born)
                                      FROM person));",2018-08-31 12:04:57.959406+10,3,1,144,correct
10183,;,2018-08-31 12:05:26.993289+10,8,0,454,noninterpretable
10184,"select max(year_born)
from person
where year_born<(
select max(year_born) from person ); ",2018-08-31 12:05:48.079292+10,3,0,152,partially correct
10185,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award as ma, director as d, person as p
where Lower(ma.result)=""won"" and Lower(ma.category) = ""best film"" and ma.award_name = ""BAFTA Film Award""
      and ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;",2018-08-31 12:05:53.382704+10,8,1,291,correct
10186,"select count(*) from 
(select title,production_year from movie
except
select title,production_year from movie_award
except
select title,production_year from director_award
except
select title,production_year from writer_award
except
select title,production_year from actor_award);",2018-08-31 12:06:01.347288+10,11,0,190,partially correct
10187,SELECT country FROM RESTRICTION WHERE title='Shakespeare in Love' AND description='M';,2018-08-31 12:06:02.013959+10,6,1,404,correct
10188,"with list as(
select *
from director natural join writer natural join person)
select id, first_name, last_name from list
group by id, first_name, last_name
having count(*) > 1;
",2018-08-31 12:06:22.413115+10,4,1,129,correct
10189,"select count(*) from 
(select title,production_year from movie
except
select title,production_year from movie_award where lower(result)='won'
except
select title,production_year from director_award where lower(result)='won'
except
select title,production_year from writer_award where lower(result)='won'
except
select title,production_year from actor_award where lower(result)='won');",2018-08-31 12:06:43.60716+10,11,0,190,partially correct
10190,"select id 
from person 
where person.year_born =
(select max(year_born)
from person
where year_born<(
select max(year_born) from person)); ",2018-08-31 12:07:22.9367+10,3,1,152,correct
10191,"select count(*) from 
(select title,production_year from movie
except
select title,production_year from movie_award where lower(result)='won'
except
select title,production_year from director_award where lower(result)='won'
except
select title,production_year from writer_award where lower(result)='won'
except
select title,production_year from actor_award where lower(result)='won'
except
select title,production_year from crew_award where lower(result)='won');",2018-08-31 12:07:34.189361+10,11,1,190,correct
10192,"select m.id
from
(scene natural join role) as m
group by m.id
having count(*)=1;",2018-08-31 12:08:08.31201+10,10,0,181,partially correct
10193,"SELECT id
FROM (
	SELECT id, scene_no
	FROM (ROLE NATURAL JOIN SCENE) as rs
	WHERE lower(rs.title) = ""psycho"" and rs.production_year = 1960) as rs2
WHERE COUNT(rs2.scene_no) = 1;",2018-08-31 12:08:14.78961+10,10,0,423,noninterpretable
10194,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p,role r,
(SELECT r.id
FROM role r
GROUP BY r.id
HAVING count(*) =
(SELECT max(num)
FROM
(SELECT count(*) as num
FROM role r
GROUP BY r.id) as e)) as c
WHERE c.id = p.id
AND c.id = r.id;",2018-08-31 12:08:22.43785+10,15,1,344,correct
10195,"SELECT id FROM (SELECT * FROM person p2 WHERE p2.year_born != (SELECT max(p1.year_born)  FROM  person p1)) AS p3 
WHERE p3.year_born=( SELECT max (p4.year_born)  FROM (SELECT * FROM person p2 WHERE p2.year_born != (SELECT max(p1.year_born)  FROM  person p1)) AS p4);",2018-08-31 12:08:54.078884+10,3,1,210,correct
10196,"SELECT COUNT(*)
FROM (SELECT * FROM PERSON p, WRITER_AWARD wa WHERE p.id = wa.id and lower(wa.result) = 'won') AS n
WHERE lower(n.first_name) = 'woody' AND lower(n.last_name) = 'allen';",2018-08-31 12:08:55.068947+10,9,1,242,correct
10197,"SELECT count(*), production_year
FROM movie 
WHERE production_year = 1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;",2018-08-31 12:09:01.792217+10,2,1,312,correct
10198,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d
INNER JOIN director_award da ON d.title = da.title
WHERE lower(result) != 'won' AND lower(result) = 'nominated';",2018-08-31 12:09:14.403168+10,13,1,144,correct
10199,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 12:09:17.3449+10,8,1,454,correct
10200,"select ma.title,ma.production_year,ma.first_name,ma.last_name from (movie_award m NATURAL JOIN person p NATURAL JOIN director d) as ma where ma.award_name=""BAFTA Film Award"" and ma.category=""Best Film"";",2018-08-31 12:09:24.873824+10,8,0,456,partially correct
10201,"select count(*)
from
(select distinct id
from
writer
natural join
person
where year_born = 1935) as p;",2018-08-31 12:09:25.071443+10,1,1,271,correct
10263,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';
",2018-08-31 12:21:45.117938+10,6,0,275,partially correct
10348,"select p.id
from person p
where p.year_born <(select max(p2.year_born)
                    from person p2
)
limit 1;",2018-08-31 12:38:09.113371+10,3,0,237,partially correct
10202,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:09:28.471908+10,11,1,427,correct
10203,"select MAX(C) from (select w.id, count(*) AS C from director d, writer w where d.title = w.title and d.production_year = w.production_year GROUP BY w.id) AS p GROUP BY p.id;
",2018-08-31 12:09:31.647354+10,14,0,399,partially correct
10204,"select r.id
from role r,
     scene s,
     appearance a
where a.scene_no=s.scene_no
and   a.title=s.title
and   a.production_year=s.production_year
and   a.description=r.description
and   lower(s.title)='psycho'
and   s.production_year=1960
group by r.id
having count(*)=1;
",2018-08-31 12:09:32.370611+10,10,0,237,partially correct
10205,"SELECT  production_year,count(*)
FROM movie 
WHERE production_year = 1991 OR production_year=1992 OR production_year=1993
GROUP BY production_year;",2018-08-31 12:09:59.059788+10,2,1,312,correct
10206,"select r.id 
from role r, scene s, appearance a
where a.title = s.title and a.production_year = s.production_year and a.scene_no  =s.scene_no
and a.title = r.title and a.production_year = r.production_year and a.description = r.description
and a.production_year = 1960 and a.title = 'Psycho'
group by r.id having count(*)=1;",2018-08-31 12:10:01.11134+10,10,1,125,correct
10207,select id from person where year_born=(select max(year_born) from person where year_born<(select max(year_born) from person));,2018-08-31 12:10:06.315586+10,3,1,190,correct
10208,"SELECT count(*)
FROM writer w INNER JOIN person p ON w.id=p.id
WHERE p.year_born=1935;",2018-08-31 12:10:11.625432+10,1,0,249,partially correct
10209,"SELECT id
FROM role
WHERE description=(SELECT description 
                 FROM scene d
				 WHERE lower(d.title)='psycho'
				 AND d.production_year=1960
				 AND d.scene_no=1);",2018-08-31 12:10:19.86775+10,10,0,328,partially correct
10210,"select y.id
from (
select x.id, count(*) as num
from ((select d.id, d.title, d.production_year from director d)
     union
     (select w.id, w.title, w.production_year from writer w))
	 as x
group by x.id) as y
where y.num = (
select max(y1.num)
from (select x.id, count(*) as num
from 
((select d.id, d.title, d.production_year from director d)
union
(select w.id, w.title, w.production_year from writer w)) as x
group by x.id) as y1);",2018-08-31 12:10:38.738106+10,14,0,338,noninterpretable
10211,"SELECT COUNT(*)
FROM (SELECT * FROM PERSON p, WRITER_AWARD wa WHERE p.id = wa.id and lower(wa.result) = 'won') AS n
WHERE lower(n.first_name) = 'woody' AND lower(n.last_name) = 'allen'AND n.year_of_award >= 1991
    AND n.year_of_award <= 1995;",2018-08-31 12:10:41.12313+10,9,1,242,correct
10212,; ,2018-08-31 12:10:42.179862+10,14,0,402,noninterpretable
10213,"SELECT title, production_year
FROM writer natural join movie natural join person
where first_name=Kevin and last_name=Williamson;",2018-08-31 12:11:16.187951+10,5,0,432,noninterpretable
10214,"SELECT COUNT(*)
FROM movies
WHERE NOT EXISTS 
(SELECT title, production_year FROM movie m, movies_award ma, crew award ca, director_award da, writer_award wa, actor_award aa 
WHERE title.m = title.ma 
AND production.m = production_year, ma);",2018-08-31 12:11:21.572326+10,11,0,127,noninterpretable
10215,"select ma.title, ma.production_year, p.first_name, p.last_name from movie_award ma natural join director d natural join person p
where ma.award_name = 'BAFTA Film Award' and lower(ma.result) = 'won' and lower(ma.category) = 'best film';",2018-08-31 12:11:36.057426+10,8,1,194,correct
10216,"SELECT id,first_name,last_name
FROM person 
WHERE year_born =
(SELECT max(year_born)
FROM person);",2018-08-31 12:11:52.082937+10,7,1,195,correct
10217,"select r.id
from role r,
     scene s,
     appearance a
where a.scene_no=s.scene_no
and   a.title=s.title
and   a.production_year=s.production_year
and   r.production_year=a.production_year
and   r.title=a.title
and   a.description=r.description
and   lower(s.title)='psycho'
and   s.production_year=1960
group by r.id
having count(*)=1;
",2018-08-31 12:11:59.692643+10,10,1,237,correct
10218,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from PERSON as p, ROLE as r
where p.id = r.id
	and r.id in
			(select r2.id from ROLE as r2
			group by r2.id
			having count(*) in
						(select MAX(num) from
						(select count(*)as num from ROLE as r1
						group by r1.id) as l));",2018-08-31 12:12:45.938112+10,15,1,167,correct
10219,"select p.first_name, p.last_name, r.id, r.title, r.production_year, r.description
from person p, role r,
(
	select id, count(*) as no_of_roles
	from role
	group by id
) b
where p.id=r.id
and p.id=b.id
and b.no_of_roles in 
(
	select  max(no_of_roles)
	from (
		select id, count(*) as no_of_roles
		from role
		group by id) as a
);",2018-08-31 12:12:51.342399+10,15,0,349,partially correct
10220,"select p.first_name, p.last_name, r.id, r.title, r.production_year, r.description
from person p, role r,
(
	select id, count(*) as no_of_roles
	from role
	group by id
) b
where p.id=r.id
and p.id=b.id
and b.no_of_roles in 
(
	select  max(no_of_roles)
	from (
		select id, count(*) as no_of_roles
		from role
		group by id) as a
);",2018-08-31 12:12:56.022032+10,15,0,349,partially correct
10221,"select p.id from person as p,director as d, writer as w
where p.id =d.id or p.id=w.id or (p.id=d.id and p.id = w.id)
group by p.id
having count(*)=max(*);",2018-08-31 12:13:04.884015+10,14,0,401,noninterpretable
10222,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(
	select id, count(*) as no_of_roles
	from role
	group by id
) b
where p.id=r.id
and p.id=b.id
and b.no_of_roles in 
(
	select  max(no_of_roles)
	from (
		select id, count(*) as no_of_roles
		from role
		group by id) as a
);",2018-08-31 12:13:33.90233+10,15,1,349,correct
10223,"SELECT count(*)
FROM person p
WHERE NOT EXISTs(
SELECT id
FROM person INNER JOIN director ON id);",2018-08-31 12:14:11.711989+10,12,0,312,noninterpretable
10224,"SELECT COUNT(*)
FROM (person p INNER JOIN writer_award wa ON p.id = wa.id) AS pwa
WHERE pwa.first_name = 'Woody' AND pwa.last_name = 'Allen' AND pwa.year_of_award >= 1991 AND pwa.year_of_award <= 1995;",2018-08-31 12:14:26.842727+10,9,0,454,partially correct
10225,"with dw as
((select * from director )
union
(select id, title, production_year from writer))

select id
from (select id, count(*) as NoOfMovies
from dw
group by id)
where NoOfMovies = (select max(NoOfMovies) from (select id, count(*) as NoOfMovies
from (select id, distinct(title, production_year)
from dw)
group by id));",2018-08-31 12:14:41.789409+10,14,0,170,noninterpretable
10226,"select d.id, award_name, year_of_award, category
from director d, director_award da
where 
	d.title = da.title
	and d.production_year = da.production_year
	and lower(result) != 'won'
;",2018-08-31 12:14:43.627357+10,13,1,152,correct
10227,ss;,2018-08-31 12:14:55.370166+10,3,0,398,noninterpretable
10228,"SELECT COUNT(*)
FROM (person p INNER JOIN writer_award wa ON p.id = wa.id) AS pwa
WHERE pwa.first_name = 'Woody' AND pwa.last_name = 'Allen' AND pwa.year_of_award > 1991 AND pwa.year_of_award <= 1995;",2018-08-31 12:14:57.15842+10,9,1,454,correct
10229,;,2018-08-31 12:15:31.786794+10,15,0,435,noninterpretable
10288,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;
",2018-08-31 12:26:51.852167+10,8,1,456,correct
10230,"select count(*)
from movie m, crew c, director d, writer w, role r, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where not exists(m.title = ma.title
		and m.production_year = ma.production_year
		and c.title = ca.title
		and c.id = ca.id
		and c.production_year = ca.production_year
		and d.title = da.title
		and d.production_year = da.production_year
		and w.title = wa.title
		and w.id = wa.id
		and w.production_year = wa.production_year
		and r.title = aa.title
		and r.production_year = aa.production_year
		and r.description = aa.description);",2018-08-31 12:15:35.83784+10,11,0,276,noninterpretable
10231,"select count(*)
from writer_award wa
where wa.id =(select p.id from person p, writer w
			where p.id=w.id
			and w.id=wa.id
			and lower(first_name)='woody'
			and lower(last_name)='allen')
and lower(result)='won'
and 1991<= year_of_award <=1995;",2018-08-31 12:15:36.94044+10,9,0,121,noninterpretable
10232,"SELECT COUNT(*)
FROM (person p INNER JOIN writer_award wa ON p.id = wa.id) AS pwa
WHERE pwa.first_name = 'Woody' AND pwa.last_name = 'Allen' AND pwa.result = 'won' AND pwa.year_of_award >= 1991 AND pwa.year_of_award <= 1995;",2018-08-31 12:15:38.883789+10,9,1,454,correct
10233,;,2018-08-31 12:15:40.835688+10,11,0,181,noninterpretable
10234,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (
	SELECT
		title,
		production_year
	FROM
		movie_award
	WHERE
		lower(award_name) = 'bafta film award'
		AND lower(category) = 'best film'
		AND lower(RESULT) = 'won' ) AS ma,
	director AS d,
	person AS p
	WHERE
		ma.title = d.title
		AND ma.production_year = d.production_year
		AND d.id = p.id;",2018-08-31 12:15:48.617498+10,8,1,162,correct
10235,"SELECT count(*)
FROM person p
WHERE NOT EXISTs(
SELECT p.id
FROM person p, director d
WHERE p.id=d.id);",2018-08-31 12:15:55.576348+10,12,0,312,partially correct
10236,"select COUNT(*) FROM person p WHERE NOT EXISTS ( SELECT * FROM director d WHERE p.id=d.id);

",2018-08-31 12:16:10.087492+10,12,1,61,correct
10237,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
 ",2018-08-31 12:16:26.687964+10,14,1,402,correct
10238,"with person2 as
(select id from person 
where last_name = 'Williamson'
and first_name = 'Kevin')
select id, title, production_year from writer
where id in(select * from person2 )
order by production_year;",2018-08-31 12:16:29.82009+10,5,0,129,partially correct
10239,"with person2 as
(select id from person 
where last_name = 'Williamson'
and first_name = 'Kevin')
select title, production_year from writer
where id in(select * from person2 )
order by production_year;",2018-08-31 12:16:54.391254+10,5,1,129,correct
10240,;,2018-08-31 12:17:11.660974+10,15,0,402,noninterpretable
10241,"select count(*)
from movie m
where not exists (
select title,production_year
from movie_award ma where ma.title = m.title and ma.production_year = m.production_year
union
select title,production_year
from crew_award ca where ca.title = m.title and ca.production_year = m.production_year
union
select title,production_year
from director_award da where da.title = m.title and da.production_year = m.production_year
union
select title,production_year
from writer_award wa where wa.title = m.title and wa.production_year = m.production_year
union
select title,production_year
from actor_award aa where aa.title = m.title and aa.production_year = m.production_year
);",2018-08-31 12:17:22.59154+10,11,0,125,partially correct
10242,"select id from person 
where year_born= (select max(year_born) from person)-1 ;",2018-08-31 12:18:04.768179+10,3,0,391,partially correct
10243,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT min(year_born) FROM person);",2018-08-31 12:18:06.3936+10,7,0,446,partially correct
10244,"select id, award_name, year_of_award, category
from (director natural join director_award) as dd
where 
dd.id
in (select id from director natural join director_award where lower(result)='nominated')
and
dd.id
not in (select id from director natural join director_award where lower(result)='won');",2018-08-31 12:18:48.017727+10,13,1,128,correct
10245,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT max(year_born) FROM person);",2018-08-31 12:18:49.408312+10,7,1,446,correct
10246,"select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(
	select id, count(*) as no_of_roles
	from role
	group by id
)b
where p.id=r.id
and p.id=b.id
and b.no_of_roles in
	(select max (no_of_roles)
		from (
			select id, count(*) as no_of_roles
			from role
			group by id) a
	);",2018-08-31 12:18:52.469789+10,15,1,349,correct
10247,"select a.title, a.production_year
from (movie m, (writer w natural join person p) as h) as l
where h.title = m.title
and h.production_year = m.production_year
and h.first_name = 'Kevin'
and h.last_name = 'Williamson';",2018-08-31 12:18:54.079754+10,5,0,250,noninterpretable
10248,"SELECT id, award_name,year_of_award, category FROM director, director_award 
WHERE director.title = director_award.title AND director.production_year=director_award.production_year AND lower(result)='nominated';",2018-08-31 12:19:03.394526+10,13,1,210,correct
10249,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 12:19:17.281047+10,5,1,432,correct
10250,"SELECT count(*)
FROM person p
WHERE NOT EXISTs(
SELECT *
FROM person p, director d
WHERE p.id=d.id);
",2018-08-31 12:19:30.097647+10,12,0,312,partially correct
10251,"select k.id from
(select d.id, d.title, d.production_year from DIRECTOR as d
UNION
select w.id, w.title, w.production_year from WRITER as W) as k
group by k.id
having count(*) in
(select MAX(num) from 
(select count(*)as num from
(select d.id, d.title, d.production_year from DIRECTOR as d
UNION
select w.id, w.title, w.production_year from WRITER as W) as l
group by l.id)as j);",2018-08-31 12:19:31.54217+10,14,1,167,correct
10252,"SELECT id FROM appearance NATURAL JOIN role
WHERE title = 'Psycho' AND production_year = 1960
GROUP BY id
HAVING COUNT(*) = 1;",2018-08-31 12:19:58.256044+10,10,1,320,correct
10253,"select id,award_name,year_of_award,category from director natural join (select title,production_year,award_name,year_of_award,category from director_award where lower(result)='nominated' group by title,production_year having count(*)>0
except
select title,production_year,award_name,year_of_award,category from director_award where lower(result)='won');",2018-08-31 12:20:02.667626+10,13,1,190,correct
10254,"SELECT count(*)
FROM person p
WHERE NOT EXISTs(
SELECT *
FROM director d
WHERE p.id=d.id);

",2018-08-31 12:20:09.332263+10,12,1,312,correct
10255,"SELECT *
FROM APPEARANCE app
WHERE lower(app.title) = 'psycho' AND app.production_year = 1960;",2018-08-31 12:20:24.205932+10,10,0,242,partially correct
10256,"select id from person p 
where p.year_born=(select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-31 12:20:26.498508+10,3,1,391,correct
10257,"select count (*)
from person p
where p.id not in
(
	select id
	from director d
	where p.id=d.id
);",2018-08-31 12:20:32.375997+10,12,1,349,correct
10258,"select a.title, a.production_year
from (movie m, writer w, person p) as a
where w.title = m.title
and w.production_year = m.production_year
and w.id = p.id
and p.first_name = 'Kevin'
and p.last_name = 'Williamson';",2018-08-31 12:20:34.969564+10,5,1,250,correct
10259,"SELECT m.production_year, count(*)
FROM movie m
WHERE m.production_year>=1991 AND m.production_year<=1993
GROUP BY m.production_year;

",2018-08-31 12:20:55.756515+10,2,1,249,correct
10260,"SELECT id,award_name,year_of_award,category from director as d natural join director_award as a group by result having lower(result)='nominated';",2018-08-31 12:21:17.749456+10,13,1,16,correct
10261,fsdf;,2018-08-31 12:21:21.891799+10,13,0,398,noninterpretable
10262,dsad;,2018-08-31 12:21:36.086387+10,6,0,275,noninterpretable
10349,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 AND production_year <1994;",2018-08-31 12:38:12.386798+10,2,0,441,partially correct
10264,"select count(*)
from movie m
where not exists (
select title,production_year
from movie_award ma where ma.title = m.title and ma.production_year = m.production_year and ma.result='won'
union
select title,production_year
from crew_award ca where ca.title = m.title and ca.production_year = m.production_year and ca.result='won'
union
select title,production_year
from director_award da where da.title = m.title and da.production_year = m.production_year and da.result='won'
union
select title,production_year
from writer_award wa where wa.title = m.title and wa.production_year = m.production_year and wa.result='won'
union
select title,production_year
from actor_award aa where aa.title = m.title and aa.production_year = m.production_year and aa.result='won'
);",2018-08-31 12:22:06.988356+10,11,0,125,partially correct
10265,"The sample code is:
SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 12:22:22.552035+10,7,0,275,noninterpretable
10266,"SELECT year_of_award
FROM WRITER_AWARD wa, PERSON p
WHERE
	p.id = wa.id
	AND lower(p.first_name) = 'woody'
	AND lower(p.last_name) = 'allen'
	AND wa.year_of_award > 1991 AND wa.year_of_award <= 1995
GROUP BY year_of_award;",2018-08-31 12:22:56.300816+10,9,0,162,partially correct
10267,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );
",2018-08-31 12:23:09.601284+10,8,0,275,partially correct
10268,"select pdw.id, pdw.first_name, pdw.last_name
from (person p natural join director natural join writer) pdw
group by id
having count(*)>2;",2018-08-31 12:23:15.539954+10,4,0,349,partially correct
10269,"SELECT country
from restriction
where title=""Shakespeare in love"" and description=""M"";",2018-08-31 12:23:20.487609+10,6,0,432,partially correct
10270,"select  id
from director d, writer w
where 
	d.id = w.id
	d.title = w.title
	d.production_year=w.production_year
having count(*) = max
;",2018-08-31 12:23:23.822029+10,14,0,152,noninterpretable
10271,"SELECT country
from restriction
where title=""Shakespeare in love"" and description=""M"";",2018-08-31 12:23:38.633572+10,6,0,432,partially correct
10272,"select pdw.id, pdw.first_name, pdw.last_name
from (person p natural join director natural join writer) pdw
group by id
having count(*)>=2;",2018-08-31 12:23:49.599992+10,4,1,349,correct
10273,"
SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;
",2018-08-31 12:23:51.673145+10,9,0,275,partially correct
10274,"SELECT count(*)
FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE NOT EXISTS m.title= ma.title
OR m.title= ca.title
OR m.title=da.title
OR m.title=wa.title
OR m.title=aa.title;",2018-08-31 12:23:53.830203+10,11,0,328,noninterpretable
10275,"The sample code is:
SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 12:24:15.427482+10,10,0,275,noninterpretable
10276,"SELECT country
from restriction
where lower(title)=""shakespeare in love"" and description=""M"";",2018-08-31 12:24:19.833161+10,6,1,432,correct
10277,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:24:32.045663+10,11,1,328,correct
10278,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM movie m, director d, person p, movie_award
WHERE m.title = d.title AND p.id = d.id AND LOWER(category) = 'bafta film award'AND LOWER(result) = 'won';",2018-08-31 12:24:45.436982+10,8,0,446,partially correct
10279,"The sample code is:
SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 12:24:55.193424+10,11,0,275,noninterpretable
10280,"SELECT count(*)
FROM  person p
WHERE NOT EXISTS(
SELECT *
FROM writer w
WHERE w.id=p.id);",2018-08-31 12:25:00.861635+10,12,0,312,partially correct
10281,SELECT COUNT(ID) FROM PERSON GROUP BY ID;,2018-08-31 12:25:26.602945+10,1,0,441,partially correct
10282,"The sample code is:
SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:25:29.545579+10,3,0,275,noninterpretable
10283,"select country from restriction
where title = 'Shakespeare in Love' 
and description = 'M';",2018-08-31 12:25:42.563214+10,6,1,129,correct
10284,"The sample code is:
SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 12:25:57.379502+10,13,0,275,noninterpretable
10285,"SELECT id
FROM ROLE r
WHERE r.title = (SELECT title FROM SCENE s WHERE lower(s.title) = 'psycho' AND s.production_year = 1960 AND s.scene_no = 1);",2018-08-31 12:26:18.284791+10,10,0,242,partially correct
10286,"The sample code is:
SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 12:26:24.937436+10,14,0,275,noninterpretable
10287,"SELECT count(*)
FROM  person p
WHERE NOT EXISTS(
SELECT *
FROM director d
WHERE d.id=p.id);
",2018-08-31 12:26:34.540958+10,12,1,312,correct
10344,"SELECT count(*)
FROM (SELECT id
FROM writer_award 
WHERE LOWER(result) = 'won' AND year_of_award <= 1995 AND year_of_award >= 1991)AS wa, 
person AS p
WHERE p.id = wa.id
AND lower(first_name) = 'woody'
AND lower(last_name) = 'allen';",2018-08-31 12:37:40.582064+10,9,1,446,correct
10350,"select first_name,last_name,title,production_year,description from person natural join role natural join (select max(a),id from(select count(id) a,id from role group by id))as b;",2018-08-31 12:38:23.805448+10,15,1,190,correct
10289,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
",2018-08-31 12:27:08.51466+10,15,0,275,partially correct
10290,"select y.id
from (
select x.id, count(*) as num
from (select d.id, d.title, d.production_year from director d
     union
     select w.id, w.title, w.production_year from writer w)
	 as x
group by x.id) as y
where y.num = (
select max(y1.num)
from (select x.id, count(*) as num
from 
(select d.id, d.title, d.production_year from director d
union
select w.id, w.title, w.production_year from writer w) as x
group by x.id) as y1);",2018-08-31 12:27:10.581609+10,14,1,338,correct
10291,"select id, first_name,last_name
from person ,person as p
where  person.year_born>any p.year_born;",2018-08-31 12:27:22.887935+10,7,0,432,noninterpretable
10292,"SELECT rs2.id
FROM (
	SELECT id, scene_no
	FROM (ROLE NATURAL JOIN APPEARANCE	) as ra
	WHERE lower(ra.title) = ""psycho"" and ra.production_year = 1960) as rs2
GROUP BY rs2.id
HAVING COUNT(*) = 1;",2018-08-31 12:27:35.513767+10,10,1,423,correct
10293,"select count(*)
from movie m
where not exists (
select title,production_year
from movie_award ma where ma.result='won' and ma.title = m.title and ma.production_year = m.production_year 
union
select title,production_year
from crew_award ca where ca.result='won' and ca.title = m.title and ca.production_year = m.production_year 
union
select title,production_year
from director_award da where da.result='won' and da.title = m.title and da.production_year = m.production_year 
union
select title,production_year
from writer_award wa where wa.result='won' and wa.title = m.title and wa.production_year = m.production_year
union
select title,production_year
from actor_award aa where aa.result='won' and aa.title = m.title and aa.production_year = m.production_year 
);",2018-08-31 12:27:37.326513+10,11,0,125,partially correct
10294,"select id, award_name, year_of_award ,category
from director d natural join director_award da
where exists (select * from director_award da where da.title=d.title and da.production_year=d.production_year) 
and not exists (select * from director_award da where 
da.title=d.title and da.production_year=d.production_year and lower(da.result)='won');",2018-08-31 12:28:27.398055+10,13,1,391,correct
10295,"select id, first_name,last_name
from person
where  year_born=(select max(year_born)
			from	person p);",2018-08-31 12:29:05.772677+10,7,1,432,correct
10296,"SELECT COUNT(*)
FROM person p, writer w
WHERE p.id=w.id AND p.year_born=1935;",2018-08-31 12:29:07.41167+10,1,0,439,partially correct
10297,"SELECT *
FROM person p
WHERE p.year_born=(SELECT MIN(pp.year_born) FROM person pp GROUP BY pp.year_born ORDER BY pp.year_born DESC)
;",2018-08-31 12:29:14.154202+10,3,0,427,partially correct
10298,"select count(*)
from movie m
where not exists (
select title,production_year
from movie_award ma where lower(ma.result)='won' and ma.title = m.title and ma.production_year = m.production_year 
union
select title,production_year
from crew_award ca where lower(ca.result)='won' and ca.title = m.title and ca.production_year = m.production_year 
union
select title,production_year
from director_award da where lower(da.result)='won' and da.title = m.title and da.production_year = m.production_year 
union
select title,production_year
from writer_award wa where lower(wa.result)='won' and wa.title = m.title and wa.production_year = m.production_year
union
select title,production_year
from actor_award aa where lower(aa.result)='won' and aa.title = m.title and aa.production_year = m.production_year 
);",2018-08-31 12:29:21.832896+10,11,1,125,correct
10299,"select m.title, m.production_year
from movie m, writer w, person p
where m.title=w.title
and m.production_year=w.production_year
and p.id=w.id
and p.first_name='Kevin'
and p.last_name='Williamson';",2018-08-31 12:29:32.619012+10,5,1,349,correct
10300,"SELECT count(*)
FROM 
(SELECT * 
FROM writer_award wa, person p
WHERE wa.id=p.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND wa.year_of_award<1996 AND wa.year_of_award>1990);",2018-08-31 12:29:33.862357+10,9,0,195,partially correct
10301,"SELECT id,award_name,year_of_award,category from director as d natural join director_award as a group by result having lower(result)='nominated';",2018-08-31 12:29:40.638481+10,13,1,16,correct
10302,"SELECT year_of_award, count(*)
FROM WRITER_AWARD wa, person p
WHERE
       year_of_award > 1991 AND year_of_award <= 1995
	wa.id = p.id
	AND p.first_name = 'Woody'
	AND p.last_name = 'Allen'
GROUP BY year_of_award;
",2018-08-31 12:29:55.35819+10,9,0,162,noninterpretable
10303,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 12:29:57.300162+10,8,1,446,correct
10304,"SELECT COUNT(*)
FROM person p NATURAL JOIN writer w
WHERE  p.year_born=1935;",2018-08-31 12:30:05.964724+10,1,0,439,partially correct
10305,"select id from (
select count(id) b,id from (select id,title,production_year from director union select id,title,production_year from writer) group by id) where b=(select max(a) from (select count(*) as a,id from (select id,title,production_year from director union select id,title,production_year from writer) group by id));",2018-08-31 12:30:17.935368+10,14,1,190,correct
10306,"SELECT COUNT(*) FROM (
	SELECT * FROM movie AS m
		WHERE NOT EXISTS (SELECT title FROM director_award AS da WHERE
								m.title = da.title AND m.production_year=da.production_year AND UPPER(result) = 'WON')
		AND  NOT EXISTS (SELECT title FROM writer_award AS wa WHERE
								m.title = wa.title AND m.production_year=wa.production_year AND UPPER(result) = 'WON')
		AND  NOT EXISTS (SELECT title FROM actor_award AS aa WHERE
								m.title = aa.title AND m.production_year=aa.production_year AND UPPER(result) = 'WON')
		AND  NOT EXISTS (SELECT title FROM crew_award AS ca WHERE
								m.title = ca.title AND m.production_year=ca.production_year AND UPPER(result) = 'WON')
		AND  NOT EXISTS (SELECT title FROM movie_award AS ma WHERE
								m.title = ma.title AND m.production_year=ma.production_year AND UPPER(result) = 'WON')
								);",2018-08-31 12:30:22.324165+10,11,1,320,correct
10307,"select wp.title,
	wp.production_year
from (person natural join writer)as wp
where  wp.first_name='Kevin'
	and wp.last_name='Williamson';
",2018-08-31 12:30:33.390611+10,5,1,149,correct
10308,"select c.id from (select c.id, COUNT(*) as count2 from (select id, title, production_year from director UNION select id, title, production_year from writer) as c GROUP BY c.id where count2 =
(select MAX(b.count) from (select a.id, COUNT(*) as count from (select id, title, production_year from director UNION select id, title, production_year from writer) as a GROUP BY a.id) AS b);",2018-08-31 12:31:14.970028+10,14,0,399,noninterpretable
10309,"select count(id) from Person
where exists(select Writer.id from Writer
       where Writer.id=Person.id and Person.year_born=1935);
     ",2018-08-31 12:31:17.133935+10,1,1,336,correct
10346,"SELECT
 p.first_name,p.last_name,r.title, r.production_year,r.description
FROM
    person p, ROLE r,( SELECT
            id,count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id AND p.id = b.id AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM ( SELECT
                    id,count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 12:37:54.07411+10,15,1,181,correct
10310,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:31:20.869861+10,11,1,377,correct
10312,"SELECT id, award_name, year_of_award, category
FROM director d
INNER JOIN director_award da ON d.title = da.title
WHERE result != 'won' and result = 'nominated';",2018-08-31 12:31:29.856723+10,13,1,144,correct
10313,"select rs.country
from restriction rs
where rs.title='Shakespeare in Love'
and rs.description='M';",2018-08-31 12:31:45.061198+10,6,1,349,correct
10314,"SELECT count(*)
FROM 
(SELECT * 
FROM writer_award wa, person p
WHERE wa.id=p.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen' AND wa.year_of_award<1996 AND wa.year_of_award>1990 AND lower(result)='won');",2018-08-31 12:32:03.63037+10,9,1,195,correct
10315,"select count(*)
from (Writer_Award NATURAL JOIN person) as wap
where wap.year_of_award > 1991 and wap.year_of_award <= 1995 and wap.first_name = 'Woody' and wap.last_name = 'Allen';
",2018-08-31 12:32:33.749513+10,9,1,286,correct
10316,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 12:32:34.053751+10,14,1,170,correct
10317,"SELECT title,production_year
FROM movie NATURAL JOIN movie_award AS ma
WHERE lower(ma.award_name) = 'bafta film award';",2018-08-31 12:32:39.84041+10,8,0,443,partially correct
10318,"select id, first_name, last_name
from person
order by year_born desc
limit 1;",2018-08-31 12:32:44.03262+10,7,1,349,correct
10319,"with newtable as(
select *
from person p, director d, movie_award ma
where p.id = d.id and d.title = ma.title and d.production_year=ma.production_year
)
select title, production_year, first_name, last_name
from newtable
where   lower(result) = 'won' and Lower(award_name)= 'bafta film award' and lower(category)  = 'best film';",2018-08-31 12:32:44.586284+10,8,1,125,correct
10320,"select country 
from Restriction
where restriction.title='Shakespeare in Love'
	and description='M';",2018-08-31 12:33:08.853962+10,6,1,149,correct
10321,"SELECT p.id
FROM person p 
WHERE p.year_born = (
	SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (
		SELECT MAX(year_born) 
		FROM person));",2018-08-31 12:33:15.822786+10,3,1,427,correct
10322,"SELECT title,production_year
FROM movie NATURAL JOIN movie_award AS ma
WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film';",2018-08-31 12:33:37.035708+10,8,0,443,partially correct
10323,"select d.id,da.award_name,da.year_of_award, da.category from director as d, director_award as da 
where d.title=da.title 
AND d.production_year= da.production_year
AND lower(da.result)=""nominated""
Group by d.id
HAVING count(*)>=1;",2018-08-31 12:34:05.015838+10,13,1,31,correct
10324,"select count(*)
from person 
where id not in(
	select id 
	from director);",2018-08-31 12:34:10.137992+10,12,1,109,correct
10325,"select h.title,h.production_year,p.first_name,p.last_name
from PERSON p,(select m.title,m.production_year,d.id
from MOVIE as m inner join DIRECTOR as d on m.title=d.title
where m.title in(select title from MOVIE_AWARD 
			WHERE award_name=""BAFTA Film Award""
			and category=""Best Film"")
) as h
where p.id=h.id;",2018-08-31 12:34:18.521853+10,8,0,302,partially correct
10326,"select count(*)
from (Writer_Award NATURAL JOIN person) as wap
where wap.year_of_award >= 1991 and wap.year_of_award <= 1995 and result = 'won' and wap.first_name = 'Woody' and wap.last_name = 'Allen';

",2018-08-31 12:34:22.271108+10,9,1,286,correct
10327,"SELECT count(*)
FROM (SELECT id
FROM writer_award 
WHERE LOWER(result) = 'won')AS wa, 
person AS p
WHERE p.id = wa.id;",2018-08-31 12:34:51.763457+10,9,0,446,partially correct
10328," SELECT id, first_name, last_name FROM PERSON p WHERE year_born = (SELECT MIN(year_born) FROM PERSON w); ",2018-08-31 12:34:54.754199+10,7,0,404,partially correct
10329,"select id, first_name, last_name, year_born
from person
where year_born = (
select max(e.year) from (
select max(year_born) as year 
from person group by id) as e);",2018-08-31 12:35:08.68362+10,7,0,129,partially correct
10330," SELECT id, first_name, last_name FROM PERSON p WHERE year_born = (SELECT MAX(year_born) FROM PERSON w); ",2018-08-31 12:35:15.737152+10,7,1,404,correct
10331,"SELECT r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
",2018-08-31 12:35:19.945951+10,10,1,242,correct
10332,"select id, first_name, last_name
from person
where year_born = (
select max(e.year) from (
select max(year_born) as year 
from person group by id) as e);",2018-08-31 12:35:26.93279+10,7,1,129,correct
10333,asds;,2018-08-31 12:35:33.309699+10,14,0,398,noninterpretable
10334,"SELECT count(*)
FROM (SELECT id
FROM writer_award 
WHERE LOWER(result) = 'won' AND year_of_award <= 1995 AND year_of_award >= 1991)AS wa, 
person AS p
WHERE p.id = wa.id;",2018-08-31 12:35:40.469617+10,9,0,446,partially correct
10335,"select d.id,fname,lname FROM (Person P NATURAL JOIN WRITER NATURAL JOIN DIRECTOR)as dw GROUPBY dw.idv HAVING COUNT(*) > 1;

",2018-08-31 12:35:50.508863+10,4,0,61,noninterpretable
10336,"SELECT id, year_born
FROM person
GROUP BY id
HAVING year_born = 1935;",2018-08-31 12:36:02.76996+10,1,0,420,partially correct
10337,"SELECT id FROM person
WHERE (SELECT MAX(year_born) FROM person AS yb, WHERE;",2018-08-31 12:36:11.807354+10,3,0,127,noninterpretable
10338,"select title, production_year,first_name,last_name
from movie_award left join director on movie_award.title=director.title
where lower(award_name)='bafta film award' and lower(category)='best film';
",2018-08-31 12:36:17.086421+10,8,0,432,noninterpretable
10339,"SELECT title production_year,COUNT(*) FROM MOVIE
GROUP BY production_year;
",2018-08-31 12:36:20.048932+10,2,0,441,partially correct
10340,"select x2.id 
from
	(select x1.id, count(*) as num 
	from (select d.id,d.title from director as d UNION select w.id, w.title  from writer as w) x1
	group by x1.id) x2
where x2.num =(select max(x3.num) 
	from (select x1.id, count(*) as num 
		from (select d.id,d.title from director as d UNION select w.id, w.title  from writer as w) x1
		group by x1.id) x3);
",2018-08-31 12:36:59.826081+10,14,1,401,correct
10341,"SELECT COUNT(title) AS NumberOfMovies
FROM (MOVIE_AWARD NATURAL JOIN CREW_AWARD NATURAL JOIN DIRECTOR_AWARD NATURAL JOIN WRITER_AWARD NATURAL JOIN ACTOR_AWARD) as a
WHERE lower(a.result) = ""nominated"";",2018-08-31 12:37:18.035896+10,11,0,423,partially correct
10342,"select p.id,
	p.first_name,
	p.last_name
from person as p
where p.year_born in (select max(year_born) from person);",2018-08-31 12:37:26.265127+10,7,1,149,correct
10343,"SELECT COUNT(*)
FROM (SELECT DISTINCT w.id
FROM writer w,(SELECT * FROM person WHERE  year_born=1935) p
WHERE w.id=p.id);",2018-08-31 12:37:39.16678+10,1,1,439,correct
10345,"select production_year,count(*)
from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-31 12:37:49.903805+10,2,1,348,correct
10351,"select ma.title, ma.production_year,p.first_name,p.last_name
from movie_award ma, director d, person p
where ma.title=d.title and ma.production_year=d.production_year and d.id=p.id
and lower(ma.award_name)= 'bafta film award'
            AND lower(ma.category)= 'best film'
            AND lower(ma.RESULT)= 'won';",2018-08-31 12:38:25.40961+10,8,1,244,correct
10352,"Select first_name,last_name,title,production_year,description from Person
	natural join

	(SELECT max(most),id,title,production_year,description from 
		(SELECT id,title,production_year,description,count(id) as most from Role group by id)) as t
;",2018-08-31 12:38:50.989968+10,15,0,16,partially correct
10353,"SELECT COUNT(*) AS number_of_award
FROM WRITER_AWARD wa, WRITER w, person p
WHERE
	wa.title = w.title AND wa.production_year = w.production_year AND wa.id = w.id
	AND wa.id = p.id
	AND lower(RESULT) ='won'
	AND first_name = 'Woody'
	AND last_name = 'Allen'
	AND year_of_award > 1991 AND year_of_award <= 1995;
",2018-08-31 12:39:11.86202+10,9,0,162,partially correct
10354,"select p.id
from person p
where p.year_born <(select max(p2.year_born)
                    from person p2
)
order by p.year_born desc
limit 1;",2018-08-31 12:39:13.668975+10,3,1,237,correct
10355,"SELECT COUNT(*) AS number_of_award
FROM WRITER_AWARD wa, WRITER w, person p
WHERE
	wa.title = w.title AND wa.production_year = w.production_year AND wa.id = w.id
	AND wa.id = p.id
	AND lower(RESULT) ='won'
	AND first_name = 'Woody'
	AND last_name = 'Allen'
	AND year_of_award > 1991 AND year_of_award <= 1995;",2018-08-31 12:39:35.550044+10,9,0,162,partially correct
10356,"
WHERE  (SELECT MIN(year_born) FROM PERSON);",2018-08-31 12:39:38.325012+10,7,0,428,noninterpretable
10357,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 and production_year<1994
GROUP BY production_year;",2018-08-31 12:39:49.369398+10,2,1,441,correct
10358,"SELECT production_year, count(*)
FROM movie
where production_year='1993'

UNION
select production_year, count(*)
FROM movie
where production_year='1992'

UNION
select production_year, count(*)
FROM movie
where production_year='1991';",2018-08-31 12:39:52.920562+10,2,1,253,correct
10359,"select title, production_year
from movie_award 
where award_name = 'BAFTA Film Award'
and category = 'best film' and result = 'won';",2018-08-31 12:39:54.347464+10,8,0,129,partially correct
10360,"select id
from person p
where p.year_born = (
select max(year_born) from person
where year_born < (select max(year_born) from person)
);",2018-08-31 12:39:58.173241+10,3,1,125,correct
10361,"SELECT COUNT(*) AS number_of_award
FROM WRITER_AWARD wa, WRITER w, person p
WHERE
	wa.title = w.title 
	AND wa.production_year = w.production_year 
	AND wa.id = w.id
	AND w.id = p.id
	AND lower(RESULT) ='won'
	AND first_name = 'Woody'
	AND last_name = 'Allen'
	AND year_of_award > 1991 AND year_of_award <= 1995;",2018-08-31 12:40:22.474267+10,9,0,162,partially correct
10362,"select count(*)
from movie m
where (m.title,m.production_year) not in(
	select title, production_year
	from movie_award natural join movie
	where lower(result) = 'won' 
	union
	select title, production_year
	from actor_award aa natural join movie
	where lower(aa.result) = 'won'
	union
	select title, production_year
	from director_award natural join movie wa
	where lower(result) = 'won'
	union
	select title, production_year
	from crew_award natural join movie
	where lower(result) = 'won'
	union
	select title, production_year
	from writer_award natural join movie
	where lower(result) = 'won'
);",2018-08-31 12:40:31.121336+10,11,1,109,correct
10363,"select ar.id
from (appearance NATURAL JOIN role) as ar
where ar.title = 'Psycho'
group by ar.id
HAVING count(ar.scene_no) = 1;",2018-08-31 12:40:34.34025+10,10,0,286,partially correct
10364,"SELECT m.production_year,COUNT(*)
FROM movie m
WHERE m.production_year BETWEEN 1991 AND 1993 
GROUP BY m.production_year;",2018-08-31 12:40:35.235339+10,2,1,439,correct
10365,"select count(*)
from writer w, person p
where w.id = p.id and p.year_born = 1935;",2018-08-31 12:40:36.963522+10,1,0,430,partially correct
10366,"select w.title, w.production_year
from writer as w, person as p
where w.id = p.id and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson;",2018-08-31 12:40:52.325594+10,5,0,225,noninterpretable
10367,"SELECT COUNT(*) AS number_of_award
FROM 
	WRITER_AWARD wa, 
	WRITER w, 
	person p
WHERE
	wa.title = w.title 
	AND wa.production_year = w.production_year 
	AND wa.id = w.id
	AND w.id = p.id
	AND lower(RESULT) ='won'
	AND lower(first_name) = 'woody'
	AND lower(last_name) = 'allen'
	AND year_of_award >= 1991
	AND year_of_award <= 1995;",2018-08-31 12:41:32.401624+10,9,1,162,correct
10368,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 12:41:51.345143+10,8,1,432,correct
10369,dfdsfsdfsd;,2018-08-31 12:42:03.390669+10,15,0,398,noninterpretable
10370,"SELECT id, award_name, year_award, category
FROM director_award
WHERE lower(result) = 'nominated'
AND lower(result) != 'won';",2018-08-31 12:42:06.361754+10,13,0,127,noninterpretable
10371,"select id
from
	(select  id, count(*) as noof
	from (select title, production_year, id
		from director d
		union
		select title, production_year, id
		from writer w) x1
		group by x1.id) x

where x.noof =(
		select max(x2.noof)
		from (select id, count(*) as noof
			from (select title, production_year, id
			from director d
			union
			select title, production_year, id
			from writer w) x1
			group by x1.id) x2)

;",2018-08-31 12:42:17.741932+10,14,1,152,correct
10372,"SELECT COUNT(*)
FROM MOVIE m 
WHERE NOT EXISTS (SELECT *
                                FROM movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
                                WHERE m.title = ma.title AND m.title = ca.title AND m.title = da.title AND m.title = wa.title AND m.title = aa.title);",2018-08-31 12:42:21.762396+10,11,0,242,partially correct
10373,"select country
from restriction
where lower(title) = 'shakespeare in love'
and lower(description) = 'm';",2018-08-31 12:42:33.80529+10,6,1,250,correct
10374,"SELECT COUNT(DISTINCT YEAR_BORN)
FROM person p inner JOIN writer w ON p.id=w.id
WHERE year_born='1935';",2018-08-31 12:42:39.561551+10,1,1,351,correct
10375,"select w.title, w.production_year
from writer as w, person as p
where w.id = p.id and lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-31 12:42:45.229579+10,5,1,225,correct
10376,"select count(*)
from movie m
where not exists (
		select title, production_year
		from movie_award ma
		where lower(ma.result) = 'won'
		and m.title = ma.title
		and m.production_year = ma.production_year
		union
		select title, production_year
		from crew_award ca
		where lower(ca.result) = 'won'
		and m.title = ca.title
		and m.production_year = ca.production_year
		union
		select title, production_year
		from director_award da
		where lower(da.result) = 'won'
		and m.title = da.title
		and m.production_year = da.production_year
		union
		select title, production_year
		from writer_award wa
		where lower(wa.result) = 'won'
		and m.title = wa.title
		and m.production_year = wa.production_year
		union
		select title, production_year
		from actor_award aa
		where lower(aa.result) = 'won'
		and m.title = aa.title
		and m.production_year = aa.production_year);",2018-08-31 12:42:52.059189+10,11,1,276,correct
10377,"select x.title,x.production_year,p.first_name,p.last_name
from (
select title,production_year 
from movie_award 
where lower(award_name)='bafta film award'
and lower(result)='won'and 
lower(category)='best film')as x,person p,director d
where x.title=d.title and x.production_year=d.production_year and p.id=d.id;",2018-08-31 12:43:16.413505+10,8,1,293,correct
10440,"SELECT c.id
FROM scene s, crew c, person p
WHERE
	s.title = 'Psycho'
	AND s.production_year = 1960
	AND scene_no = 1
	AND s.title = c.title
	AND s.production_year = c.production_year
	AND c.id = p.id;",2018-08-31 12:54:25.379468+10,10,0,162,partially correct
10378,"SELECT d.id, award_name, year_of_award, category
FROM director_award da, director d, person p
WHERE
	da.title=d.title
	AND da.production_year=d.production_year
	AND d.id=p.id
	AND lower(da.result)='nominated'
	AND d.id NOT IN (
		SELECT d2.id 
		FROM director_award da2, director d2 
		WHERE 
			da2.title=d2.title
			AND da2.production_year=d2.production_year
			AND da2.result='won')
;",2018-08-31 12:43:35.575848+10,13,1,427,correct
10379,"select  title, production_year, result
from crew_award 
where lower(result )= 'won'

group by title;",2018-08-31 12:43:53.778331+10,11,0,207,partially correct
10380,"select *
from (MOVIE_AWARD m INNER JOIN CREW_AWARD c INNER JOIN DIRECTOR_AWARD d 
		INNER JOIN WRITER_AWARD w INNER JOIN ACTOR_AWARD a 
			ON (m.title = c.title = d.title = w.title = a.title
				AND m.production_year = c.production_year = d.production_year = w.production_year = a.production_year)) as aa;",2018-08-31 12:43:55.215619+10,11,0,423,noninterpretable
10381,"SELECT id
FROM person
WHERE year_born=(SELECT max(year_born)
       FROM person 
	   where year_born<(select max(year_born) 
	                    FROM person ));
",2018-08-31 12:43:56.817341+10,3,1,328,correct
10382,"with temp as (
select distinct id,title, production_year
from writer
union
select id,title, production_year 
from director),

a as(select id,count(*) as num
from temp
group by id)

select id
from a
where num=(select max(num) from a);



",2018-08-31 12:44:13.00154+10,14,1,128,correct
10383,"select count(*)
from movie m
where m.title not in(
select movie.title
from movie,movie_award
where movie.title = movie_award.title
);
",2018-08-31 12:44:14.818307+10,11,0,261,partially correct
10384,"SELECT COUNT(*)
FROM (SELECT p.id
FROM person p
WHERE NOT EXISTS (SELECT d.id FROM director d WHERE d.id=p.id));",2018-08-31 12:44:21.329463+10,12,1,439,correct
10385,"select count(*)
from person p
where exists (select * from writer w where p.id = w.id and p.year_born=1935);",2018-08-31 12:44:32.02461+10,1,1,430,correct
10386,"select ar.id
from (appearance NATURAL JOIN role) as ar
where ar.title = 'Psycho' and ar.production_year = 1960
group by ar.id
HAVING count(ar.scene_no) = 1;",2018-08-31 12:45:22.019595+10,10,1,286,correct
10387,"select title, production_year
from movie_award
where award_name = 'BAFTA Film Award';",2018-08-31 12:45:47.065042+10,8,0,211,partially correct
10388,select count(*) from person natural join writer where person.year_born='1935';,2018-08-31 12:45:58.450417+10,1,0,255,partially correct
10389,"select p.id
from person p
where p.year_born=(select max(year_born)
from person
where year_born<(select max(year_born)
from person));",2018-08-31 12:46:29.095028+10,3,1,377,correct
10390,"select Max(id), first_name, last_name, production_year, description from
Person P,
Role R,
Movie M

WHERE 

R.id=P.id
AND
R.production_year= M.production_year
AND
R.title=M.title;",2018-08-31 12:46:29.608307+10,15,0,137,noninterpretable
10391,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born=1935);",2018-08-31 12:46:35.592289+10,1,1,217,correct
10392,"select p.id
from person p
where year_born=(select max(year_born)
from person
where year_born<(select max(year_born)
from person));",2018-08-31 12:46:43.106251+10,3,1,377,correct
10393,"select production_year, count(*)
from movie where production_year in (1991,1992,1993)
group by production_year;",2018-08-31 12:46:45.574881+10,2,1,430,correct
10394,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:46:50.013232+10,11,1,207,correct
10395,"SELECT DISTINCT id
FROM crew AS c, scene AS s
WHERE scene_no = 1
AND s.production_year = 1960;
",2018-08-31 12:46:55.691506+10,10,0,446,partially correct
10396,"select d.id,ma.award_name,ma.year_of_award,ma.category 
from director d, 
     movie_award ma
where lower(ma.result)='nominated'
and   lower(ma.result)!='won'
and   ma.title=d.title
and   ma.production_year=d.production_year;",2018-08-31 12:46:56.696204+10,13,0,237,partially correct
10397,"
SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 12:47:05.76464+10,4,1,312,correct
10398,"select id,count(*) from (select id,title,production_year from director as d
union
select id,title,production_year from writer as w) Group by id order by count(*) desc limit 1;",2018-08-31 12:47:11.568797+10,14,0,31,partially correct
10399,"select id from (select id,title,production_year from director as d
union
select id,title,production_year from writer as w) Group by id order by count(*) desc limit 1;",2018-08-31 12:47:31.151746+10,14,0,31,partially correct
10400,"
SELECT dw.id, dw.first_name, dw.last_name
FROM (person p INNER JOIN director INNER JOIN writerAS dw
GROUP BY dw.id
HAVING count(*) > 1;
",2018-08-31 12:47:41.883994+10,4,0,312,noninterpretable
10401,"
SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writerAS dw
GROUP BY dw.id
HAVING count(*) > 1;
",2018-08-31 12:48:14.362766+10,4,0,312,noninterpretable
10402,"select d.id,ma.award_name,ma.year_of_award,ma.category 
from director d, 
     director_award ma
where lower(ma.result)='nominated'
and   lower(ma.result)!='won'
and   ma.title=d.title
and   ma.production_year=d.production_year;",2018-08-31 12:48:25.389225+10,13,1,237,correct
10403,"
WHERE  (SELECT MIN(year_born) FROM PERSON);",2018-08-31 12:48:25.981895+10,7,0,428,noninterpretable
10404,;,2018-08-31 12:48:30.535278+10,2,0,217,noninterpretable
10405,"select x.first_name,x.last_name, x.title, x.production_year,x.description
from (select p.first_name,p.last_name, r.title, r.production_year,r.description,count(*) as num
	from role as r, person as p where r.id = p.id
) x
where x.num =(select max(x2.num)from(select p.first_name,p.last_name, r.title, r.production_year,r.description,count(*) as num
	from role as r, person as p where r.id = p.id
) x2);",2018-08-31 12:48:41.641271+10,15,0,401,partially correct
10406,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 12:48:41.7469+10,4,1,312,correct
10407,"select count(*)
from WRITER_AWARD as e
WHERE lower(result)=""won""
and year_of_award>=1991
and year_of_award<=1995
and id in(select id from PERSON
where first_name=""Woody""
and last_name=""Allen"")
group by e.id;",2018-08-31 12:48:50.513143+10,9,1,302,correct
10408,"SELECT count(*)
FROM writer_award AS wa
WHERE year_of_award>1990 AND year_of_award<1996 AND (SELECT id
                                                     FROM person AS p
									  WHERE lower(first_name)='woody' AND lower(last_name)='allen' AND p.id=wa.id)
GROUP BY year_of_award;


",2018-08-31 12:48:50.925576+10,9,0,233,noninterpretable
10409,"SELECT id 
FROM role r, appearance a 
WHERE r.title=a.title AND lower(r.title)='psycho' AND r.production_year=a.production_year AND r.production_year=1960 AND a.description=r.description
GROUP BY r.id
HAVING COUNT(*)=1;",2018-08-31 12:48:54.252933+10,10,1,195,correct
10410,"SELECT wd.title, wd.production_year, wd.first_name, wd.last_name FROM (PERSON p NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE NATURAL JOIN MOVIE_AWARD) AS wd WHERE lower(wd.award_name)='bafta film award' AND lower(wd.category)='best film';",2018-08-31 12:49:00.342119+10,8,0,404,partially correct
10441,;,2018-08-31 12:54:35.003438+10,2,0,429,noninterpretable
10480,"select production_year,count(*) from movie where production_year in (1991,1992,1993) group by production_year;",2018-08-31 12:59:35.099598+10,2,1,255,correct
10665,"select id
from scene natural join role natural join movie 
where lower(title)='psycho' and production_year='1960'and count(scene_no)=1
group by id;
",2018-08-31 13:23:10.758467+10,10,0,432,noninterpretable
10411,"SELECT COUNT(*) AS NumberOfMovies
FROM (
	SELECT title
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) = ""nominated""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) = ""nominated""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) = ""nominated""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) = ""nominated""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) = ""nominated""
	);",2018-08-31 12:49:02.304678+10,11,0,423,partially correct
10412,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN writer NATURAL JOIN director) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 12:49:07.878699+10,4,1,312,correct
10413,"select count(*) from person p
where not exists (select * from director d where d.id=p.id);",2018-08-31 12:49:24.785969+10,12,1,430,correct
10414,"SELECT id,first_name,last_name
FROM PERSON
WHERE year_born=(SELECT MAX(year_born) FROM PERSON);",2018-08-31 12:49:34.868091+10,7,1,428,correct
10415,"SELECT COUNT(*) AS NumberOfMovies
FROM (
	SELECT title
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) != ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) != ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) != ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) != ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) != ""won""
	);",2018-08-31 12:49:37.070203+10,11,0,423,partially correct
10416,"with l as (select d.id, title, production_year 
		from director d 
		union 
		select w.id, title, production_year 
		from writer w
		)

select id
from (select id, count(*) as num
	from l
	group by id) nj
where nj.num = (
	(select max(num)
		from (select id, count(*) as num
			from l
			group by id) as i
		)
	);
",2018-08-31 12:49:37.441475+10,14,1,109,correct
10417,"select count(*) as writerAwards
from writer_award wa, person p, writer w
where lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.result='won'
and wa.id=w.id
and w.id = p.id;",2018-08-31 12:49:49.483243+10,9,0,293,partially correct
10418,"SELECT id, first_name, last_name
FROM (SELECT *, max(p.year_born) FROM person p);",2018-08-31 12:49:56.734017+10,7,1,450,correct
10419,"select id
from person
where year_born=1988;",2018-08-31 12:50:14.057258+10,3,0,207,cheating
10420,"SELECT id, award_name, year_of_award, category from director_award natural join director natural join person
			WHERE NOT EXISTS (SELECT * FROM director_award natural join director dd
			                  WHERE lower(result) = 'won' AND dd.id = director.id);",2018-08-31 12:50:20.89002+10,13,1,320,correct
10421,"with x1 as
(select r.id, count(*) as NoOfRoles
from role r
group by r.id)

select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, (select x1.id
from x1
where NoOfRoles = (select max(NoOfRoles) from x1)) x2, role r
where p.id = x2.id and r.id = x2.id ;
",2018-08-31 12:50:30.480378+10,15,1,170,correct
10422,"SELECT production_year, count(*)
FROM movie
where production_year >1990 and production_year<1994
GROUP BY production_year;",2018-08-31 12:51:16.736203+10,2,1,217,correct
10423,"select title, production_year
from person p, writer w 
where p.id=w.id and lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-31 12:51:24.698344+10,5,1,351,correct
10424,"select title, production_year as py, first_name, last_name from 
movie_award natural join director natural join person as mdp
where lower(category) = 'best film' and lower (award_name) = 'bafta film award' and lower(result) = 'won';

",2018-08-31 12:51:49.241344+10,8,1,452,correct
10425,"select id from(
select id, count(title)
from(
select distinct id, title, production_year
from writer
union
select id, title, production_year
from director)
group by id
having count(title) =
(
select max(con)
from
(select id, count(title) as con
from(
select distinct id, title, production_year
from writer
union
select id, title, production_year
from director)
group by id)
));",2018-08-31 12:52:00.294176+10,14,1,337,correct
10426,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'nominated'
and d.id not in (
select d.id, da.award_name, da.year_of_award, da.category 
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'won'
);",2018-08-31 12:52:07.844238+10,13,0,125,noninterpretable
10427,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'nominated'
and d.id not in (
select d.id, da.award_name, da.year_of_award, da.category 
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'won'
);",2018-08-31 12:52:13.893996+10,13,0,125,noninterpretable
10428,"SELECT wd.title, wd.production_year, wd.first_name, wd.last_name FROM (PERSON p NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE NATURAL JOIN MOVIE_AWARD) AS wd WHERE lower(wd.award_name)='bafta film award' AND lower(wd.category)='best film' AND lower('RESULT')='won';",2018-08-31 12:52:35.737592+10,8,0,404,partially correct
10429,"select d.id, dr.id, wr.id
from person, director, writer
where d.id = dr.id
OR d.id = wr.id
HAVING coun;
",2018-08-31 12:52:37.394792+10,14,0,127,noninterpretable
10430,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;



",2018-08-31 12:52:43.813002+10,9,1,233,correct
10431,"select first_name, last_name, title, production_year, description
from ((select first_name,last_name, title, production_year, description, count(*) as NoOfRole
	from role, person
	where person.id=role.id) x1
	group by x1.id) x

where x.NoOfRole = (max(
		select first_name,last_name, title, production_year, description, count(*) as NoOfRole
		from role, person
		where person.id=role.id) x1
		group by x1.id)) x2
;",2018-08-31 12:52:53.134969+10,15,0,152,noninterpretable
10432,"SELECT wd.title, wd.production_year, wd.first_name, wd.last_name FROM (PERSON p NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE NATURAL JOIN MOVIE_AWARD) AS wd WHERE lower(wd.award_name)='bafta film award' AND lower(wd.category)='best film' AND lower(wd.RESULT)='won';",2018-08-31 12:53:03.407622+10,8,1,404,correct
10433,"SELECT id
FROM scene s, crew c, person p
WHERE
	s.title = 'Psycho'
	AND s.production_year = 1960
	AND scene_no = 1
	AND s.title = c.title
	AND s.production_year = c.production_year
	AND c.id = p.id;",2018-08-31 12:53:04.88129+10,10,0,162,noninterpretable
10434,"select count(person.id)
from person inner join writer on person.id = writer.id
where person.year_born = '1935';",2018-08-31 12:53:12.188279+10,1,0,41,partially correct
10435,;,2018-08-31 12:53:29.019742+10,1,0,429,noninterpretable
10436,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE (d.title=da.title
AND   d.production_year=da.production_year)
AND   LOWER(da.result)<>'won'
GROUP BY d.id;",2018-08-31 12:53:41.758895+10,13,1,328,correct
10437,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'nominated'
and d.id not in (
select d.id
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'won'
);",2018-08-31 12:53:49.530535+10,13,1,125,correct
10438,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 12:54:00.129219+10,1,1,429,correct
10439,"SELECT d.id, p.first_name,p.last_name
FROM director d,person p,writer w
WHERE d.id=p.id AND w.id=d.id AND w.id=p.id
GROUP BY d.id HAVING COUNT(*)>1;
",2018-08-31 12:54:05.24822+10,4,0,439,partially correct
10442,"
select count(*)
from (select title,production_year from movie 
except
select title,production_year from movie_award
where lower(result) = 'won'
except
select title,production_year from crew_award
where lower(result) = 'won'
except
select title,production_year from director_award
where lower(result) = 'won'
except
select title,production_year from writer_award
where lower(result) = 'won'
except
select title,production_year from actor_award
where lower(result) = 'won') movie_never_won;",2018-08-31 12:54:35.345778+10,11,1,348,correct
10443,"SELECT title, production_year
FROM director d, person p
WHERE d.id=p.id
AND lower(p.first_name)=""kevin""
AND lower(p.last_name)=""williamson"";",2018-08-31 12:54:38.85607+10,5,0,312,partially correct
10444,"SELECT count(distinct p.id)
FROM PERSON p INNER JOIN WRITER w 
ON p.id =w.id
WHERE p.year_born=1935;
",2018-08-31 12:54:39.605586+10,1,1,173,correct
10445,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 12:54:50.466746+10,2,1,429,correct
10446,"SELECT count(*)
FROM WRITER w, PERSON p
WHERE (w.id = p.id AND p.year_born = 1935);",2018-08-31 12:54:58.285859+10,1,0,23,partially correct
10447,;,2018-08-31 12:55:00.341438+10,15,0,127,noninterpretable
10448,;,2018-08-31 12:55:15.292822+10,12,0,429,noninterpretable
10449,Select count(DISTINCT PERSON.id) from PERSON join WRITER on PERSON.id = WRITER.id where person.year_born = 1935;,2018-08-31 12:55:28.223411+10,1,1,305,correct
10450,"select id,
award_name,
year_of_award,
category

from director_award da,
director d

where d.title=da.title and
d.production_year=da.production_year
and lower(da.result)='nominated'
and d.id not in(select id
from director,
director_award
where director.title=director_award.title and
director.production_year=director_award.production_year
and lower(director_award.result)='won');

",2018-08-31 12:55:34.804438+10,13,1,377,correct
10451,"SELECT title, production_year
FROM writer d, person p
WHERE d.id=p.id
AND lower(first_name)=""kevin""
AND lower(last_name)=""williamson"";",2018-08-31 12:55:47.254454+10,5,1,312,correct
10452,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 12:55:48.733517+10,12,1,429,correct
10453,"SELECT title, production_year
FROM movie
WHERE country = ""Australia"";",2018-08-31 12:55:53.958132+10,1,0,382,partially correct
10454,"select production_year, COUNT(*) as numbers_of_movies
from Movie 
WHERE production_year=1993 or production_year=1992 or production_year=1991
GROUP BY production_year;",2018-08-31 12:56:00.946459+10,2,1,173,correct
10455,"select count(*) from writer w inner join person p on w.id=p.id where p.first_name=""Woody"" and p.last_name=""Allen"" and between(1991,1995);",2018-08-31 12:56:22.177463+10,9,0,456,noninterpretable
10456,"WITH np AS
(SELECT 
SELECT COUNT(*) 
FROM np;",2018-08-31 12:56:28.111651+10,12,0,441,noninterpretable
10457,"select count(*)
from writer_award
where production_year >= 1991 and production_year <= 1995 and id = (
	select id 
	from person
	where first_name = 'Woody' and last_name = 'Allen')
;",2018-08-31 12:56:50.78409+10,9,1,211,correct
10458,"select count(*) from (select distinct last_name from writer w,person p where w.id=p.id and p.year_born=1935)a;",2018-08-31 12:57:01.658967+10,1,1,317,correct
10459,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 12:57:06.297597+10,11,1,242,correct
10460,;,2018-08-31 12:57:10.069503+10,11,0,131,noninterpretable
10461,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
SELECT title,production_year
FROM movie_award ma
WHERE ma.title=m.title AND ma.production_year = m.production_year AND lower(result)='won'
UNION
SELECT title,production_year
FROM crew_award ca
WHERE ca.title=m.title AND ca.production_year = m.production_year AND lower(result)='won'
UNION
SELECT title,production_year
FROM director_award da
WHERE da.title=m.title AND da.production_year = m.production_year AND lower(result)='won'
UNION
SELECT title,production_year
FROM writer_award wa
WHERE wa.title=m.title AND wa.production_year = m.production_year AND lower(result)='won'
UNION
SELECT title,production_year
FROM actor_award aa
WHERE aa.title=m.title AND aa.production_year = m.production_year AND lower(result)='won'
);",2018-08-31 12:57:15.015316+10,11,1,195,correct
10462,;,2018-08-31 12:57:22.329125+10,4,0,429,noninterpretable
10463,"select pwd.id, pwd.first_name, pwd.last_name from (person p natural join writer natural join director) as pwd
group by pwd.id
having count(*) >= 2;",2018-08-31 12:57:29.383902+10,4,1,430,correct
10464,"SELECT p.id, p.first_name,p.last_name
FROM (SELECT d.* FROM director d,writer w WHERE w.id=d.id) dd, person p
WHERE dd.id=p.id 
GROUP BY p.id HAVING COUNT(*)>1;
",2018-08-31 12:57:37.46625+10,4,0,439,partially correct
10465,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 12:58:00.412383+10,4,1,429,correct
10466,;,2018-08-31 12:58:11.318774+10,5,0,429,noninterpretable
10467,"WITH w AS (SELECT title,production_year FROM movie_award ma
      WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film' AND lower(ma.result)='won')
SELECT title,production_year,first_name,last_name
FROM person p ,director p ,w
WHERE w.title = d.title AND w.production_year = d.production_year AND p.id = d.id;",2018-08-31 12:58:23.306965+10,8,0,443,noninterpretable
10468,"select id
from ROLE r,
	APPEARANCE a
where r.title=""Psycho""
and a.title=""Psycho""
and a.description=r.description
and r.production_year=1960
and a.production_year=1960
and a.scene_no=1;",2018-08-31 12:58:36.657796+10,10,0,302,partially correct
10469,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 12:58:46.280202+10,5,1,429,correct
10470,;,2018-08-31 12:58:52.586592+10,12,0,217,noninterpretable
10471,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR.d WHERE d.id=p.id);",2018-08-31 12:58:58.901314+10,12,0,441,noninterpretable
10472,"select production_year, count(title) from MOVIE where production_year = 1991 ;",2018-08-31 12:58:59.99067+10,2,0,305,partially correct
10473,;,2018-08-31 12:59:01.39716+10,6,0,429,noninterpretable
10474,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 12:59:17.158475+10,6,1,429,correct
10475,"select count(distinct w.id) from writer w inner join person p on p.id= w.id
where p.year_born =1935;",2018-08-31 12:59:17.541612+10,1,1,313,correct
10476,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) );",2018-08-31 12:59:24.051218+10,15,1,152,correct
10477,"SELECT p.id, p.first_name,p.last_name
FROM (SELECT d.* FROM director d,writer w WHERE w.id=d.id AND w.title=d.title AND w.production_year=d.production_year) dd, person p
WHERE dd.id=p.id 
GROUP BY p.id HAVING COUNT(*)>1;
",2018-08-31 12:59:26.257479+10,4,1,439,correct
10478,;,2018-08-31 12:59:27.404282+10,7,0,429,noninterpretable
10479,"SELECT COUNT*
FROM PERSON, WRITER
GROUP BY PERSON.id
WHERE PERSON.id=WRITER.id
AND PERSON.year_born='1935';",2018-08-31 12:59:28.32505+10,1,0,278,noninterpretable
10481,"WITH w AS (SELECT title,production_year FROM movie_award ma
      WHERE lower(ma.award_name) = 'bafta film award' AND lower(ma.category) = 'best film' AND lower(ma.result)='won')
SELECT d.title,d.production_year,p.first_name,p.last_name
FROM person p ,director d ,w
WHERE w.title = d.title AND w.production_year = d.production_year AND p.id = d.id;",2018-08-31 12:59:57.191315+10,8,1,443,correct
10482,SELECT COUNT(DISTINCT id) FROM person WHERE year_born=1935;,2018-08-31 13:00:00.489894+10,1,0,388,partially correct
10483,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-31 13:00:07.477283+10,7,1,429,correct
10484,;,2018-08-31 13:00:16.811056+10,8,0,429,noninterpretable
10485,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, person p, director d
where lower(ma.award_name)='bafta film award'
and lower(ma.category)='best film'
and lower(ma.result)='won'
and d.title=ma.title
and d.production_year=ma.production_year
and d.id=p.id;
",2018-08-31 13:00:17.32117+10,8,1,349,correct
10486,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 13:00:28.719286+10,8,1,429,correct
10487,"select d.id,award_name, year_of_award, category
from director d,director_award da
where lower(result) = 'nominated' and d.title = da.title and d.production_year = da.production_year
and d.id not in (select id
			from director d2,(select title,production_year
				from director_award
				where lower(result) = 'won') movie_won
			where d2.title = movie_won.title and d2.production_year = movie_won.production_year);

",2018-08-31 13:00:36.547031+10,13,1,348,correct
10488,"SELECT COUNT(*) AS NumberOfMovies
FROM MOVIE m
WHERE m.title NOT IN 
 (
	SELECT title
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) = ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) = ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) = ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) = ""won""
	UNION
	SELECT title
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) = ""won""
	);",2018-08-31 13:00:37.949772+10,11,0,423,partially correct
10489,SELECT COUNT(DISTINCT id) FROM person NATURAL JOIN writer WHERE year_born=1935;,2018-08-31 13:00:48.00408+10,1,1,388,correct
10490,"SELECT country
FROM restriction
WHERE lower(title)=""shakespeare in love""
AND lower(description)=""m"";",2018-08-31 13:00:48.911652+10,6,1,312,correct
10491,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT *
FROM director d
WHERE d.id=p.id);",2018-08-31 13:00:49.786399+10,12,1,217,correct
10492,"select workon.id from
(select id,count(*) as num from (select id,title,production_year from director as d
union
select id,title,production_year from writer as w) Group by id order by count(*) desc) as workon

where workon.num=
( select max(num) from (select id,count(*) as num from (select id,title,production_year from director as d
union
select id,title,production_year from writer as w) Group by id order by count(*) desc));
",2018-08-31 13:00:50.342433+10,14,1,31,correct
10493,"select production_year, count(title) from MOVIE where production_year > 1990 and production_year <1994 group by production_year;",2018-08-31 13:01:02.866198+10,2,1,305,correct
10494,"select country
from restriction 
where lower(title) = 'shakespeare in love' and lower(description) = 'm';
",2018-08-31 13:01:03.119201+10,6,1,225,correct
10495,"SELECT id
FROM person 
WHERE year_born=
(SELECT MAX(year_born) FROM 
(SELECT * FROM person WHERE year_born<(SELECT max (year_born) FROM person)));",2018-08-31 13:01:10.058652+10,3,1,195,correct
10496,;,2018-08-31 13:01:11.510056+10,9,0,429,noninterpretable
10497,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM DIRECTOR d WHERE p.id=d.id);",2018-08-31 13:01:18.667681+10,12,1,441,correct
10498,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 13:01:22.223474+10,9,1,429,correct
10499,"with wm as (
select title, production_year
from movie_award 
where award_name = 'BAFTA Film Award'
and category = 'best film' and result = 'won')
select wm.title, wm.production_year, first_name, last_name
from wm, person, director
where wm.title = director.title
and wm.production_year = director.production_year
and director.id = person.id;",2018-08-31 13:01:28.867724+10,8,1,129,correct
10500,"

SELECT COUNT(id)
FROM person
WHERE id NOT IN
(
SELECT distinct id
FROM director
)
;",2018-08-31 13:01:29.396303+10,12,1,173,correct
10501,"SELECT count(*)
FROM person p LEFT JOIN director d ON p.id=d.id
WHERE d.id=NULL;",2018-08-31 13:01:31.888732+10,12,0,253,partially correct
10502,"select x1.id
from ((select p1.id 
      from person p1,director d1
	  where d1.id=p1.id) as x2
	natural join
	(select p2.id
	from person p2, director d2
	where p2.id=d2.id)as x3) as x1
group by x1.id
order by x1.id desc
limit 1;",2018-08-31 13:01:34.87586+10,14,0,237,partially correct
10503,;,2018-08-31 13:01:39.304836+10,10,0,429,noninterpretable
10504,select id from scene natural join role;,2018-08-31 13:01:41.135866+10,10,0,126,partially correct
10505,;,2018-08-31 13:01:43.846774+10,4,0,217,noninterpretable
10506,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:01:49.360954+10,10,1,429,correct
10507,"SELECT id
FROM person
WHERE MAX(COUNT(*))(SELECT id
                    FROM writer w, director d
					WHERE NOT (w.id=d.id));
",2018-08-31 13:01:54.365726+10,14,0,328,noninterpretable
10508,;,2018-08-31 13:02:04.618612+10,11,0,429,noninterpretable
10509,"SELECT production_year, COUNT(*) FROM movie WHERE production_year in (1993,1992,1991) GROUP BY production_year;",2018-08-31 13:02:12.914446+10,2,1,388,correct
10510,select count(*) from person p where not exists(select * from director d where p.id=d.id);,2018-08-31 13:02:13.977906+10,12,1,255,correct
10511,"select count(*)
from person p
where exists (select * from writer w where p.id = w.id and p.year_born = 1935);",2018-08-31 13:02:16.748001+10,1,1,41,correct
10512,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:02:18.151284+10,11,1,429,correct
10513,"SELECT title,production_year
FROM writer w, person p
WHERE p.first_name='Kevin' AND p.last_name='Williamson';",2018-08-31 13:02:22.393944+10,5,0,439,partially correct
10514,;,2018-08-31 13:02:37.576023+10,3,0,429,noninterpretable
10515,"select count(distinct p.id) as ""1935""
from person p inner join writer w on p.id=w.id
where p.year_born=1935;",2018-08-31 13:02:38.781245+10,1,1,386,correct
10516,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:02:48.078951+10,14,1,328,correct
10517,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 13:02:48.608347+10,3,1,429,correct
10518,"SELECT title,production_year
FROM writer w, person p
WHERE p.first_name='Kevin' AND p.last_name='Williamson' AND w.id=p.id;",2018-08-31 13:02:56.47288+10,5,1,439,correct
10519,;,2018-08-31 13:03:01.741636+10,13,0,429,noninterpretable
10520,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 13:03:13.887361+10,13,1,429,correct
10521,;,2018-08-31 13:03:33.595692+10,14,0,429,noninterpretable
10522,"SELECT id 
FROM person
WHERE person.year_born=(

SELECT MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(year_born)
			 FROM person )
);",2018-08-31 13:03:36.661542+10,3,1,195,correct
10523,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:03:44.810952+10,14,1,429,correct
10524,;,2018-08-31 13:03:58.722019+10,15,0,429,noninterpretable
10525,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 13:04:10.032425+10,15,1,429,correct
10526,"SELECT id
FROM PERSON;
                   
",2018-08-31 13:04:23.425572+10,3,0,242,partially correct
10527,"SELECT COUNT(*)
FROM writer_award wa,person p
WHERE wa.year_of_award>=1991 AND wa.year_of_award<=1995 AND wa.id = p.id
      AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen';",2018-08-31 13:04:25.811098+10,9,0,443,partially correct
10528,"SELECT
    r.id
FROM
    scene s natural join 
    appearance a natural join
    ROLE r
WHERE
     lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:04:34.902022+10,10,0,244,partially correct
10529,"SELECT country
FROM restriction
WHERE lower(title)='shakespeare in love' AND description='M';",2018-08-31 13:04:36.085486+10,6,1,439,correct
10530,SELECT COUNT(*) FROM person p WHERE NOT EXISTS (SELECT id FROM director d WHERE p.id=d.id);,2018-08-31 13:04:39.05394+10,12,1,388,correct
10531,"select count(*) from 
writer_award natural join writer natural join person as wwp
where production_year >1990 and production_year <1996 and 
lower(first_name)='woody' and lower(last_name)= 'Allen';",2018-08-31 13:04:50.476932+10,9,0,452,partially correct
10532,"SELECT COUNT(*) AS NumberOfMovies
FROM MOVIE m
WHERE (m.title, m.production_year) NOT IN 
 (
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) = ""won""
	);",2018-08-31 13:04:51.133377+10,11,1,423,correct
10533,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:04:56.37377+10,10,1,244,correct
10534,"select  id,d.award_name,d.year_of_award , d.category
from director, Director_Award as d
group by d.title
having (lower(result) != 'won');",2018-08-31 13:05:08.534323+10,13,0,207,partially correct
10535,"SELECT p.first_name,p.last_name, r.title, r.production_year, r.description
   FROM
    person p,
    ROLE r,
    ( SELECT id, count(*) AS number_of_roles FROM ROLE GROUP BY id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (SELECT max(number_of_roles) FROM ( SELECT id, count ( * ) AS number_of_roles FROM ROLE
GROUP BY id ) AS a );",2018-08-31 13:05:12.072781+10,15,1,137,correct
10536,"with sub as (
select count(*) as num
from(
select id, title, production_year
from director d
union
select id, title, production_year 
from writer w
)
group by id
)

select count(*) from sub
where 

group by id
having max(num);
",2018-08-31 13:05:18.751496+10,14,0,125,noninterpretable
10537,"SELECT first_name, last_name, title, production_year, description
FROM person p, role r
WHERE p.id IN (
	SELECT id FROM (SELECT id, MAX(count_num) FROM (SELECT id, COUNT(*) AS count_num FROM role GROUP BY id)))
	AND r.id=p.id
;",2018-08-31 13:05:19.72613+10,15,1,427,correct
10538,"select pw.title, pw.production_year from (select * from person p, writer w
	where p.id = w.id and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson') as pw;",2018-08-31 13:05:56.910398+10,5,1,430,correct
10539,"SELECT title, production_year, first_name, last_name
FROM (person NATURAL JOIN director NATURAL JOIN movie NATURAL JOIN movie_award)
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film';",2018-08-31 13:06:04.063757+10,8,0,450,partially correct
10540,"select production_year, count(*) as numbers
from movie
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-31 13:06:19.746747+10,2,1,41,correct
10541,"SELECT d.title, d.production_year, first_name, last_name
FROM director d, person p, movie_award ma
WHERE d.id=p.id
AND d.title=ma.title
AND d.production_year=ma.production_year
AND lower(ma.year_of_award)=""bafta film award""
AND lower(ma.result)=""won"";",2018-08-31 13:06:30.046344+10,8,0,312,partially correct
10542,st_name)='woody' AND lower(p.last_name)='allen') AS pw WHERE wa.year_of_award >= 1991 AND wa.year_of_award <= 1995;,2018-08-31 13:06:30.252895+10,9,0,404,noninterpretable
10543," SELECT COUNT(*) FROM WRITER_AWARD wa, (SELECT * FROM WRITER w, PERSON p WHERE p.id=w.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen') AS pw WHERE wa.year_of_award >= 1991 AND wa.year_of_award <= 1995;",2018-08-31 13:06:50.061567+10,9,0,404,partially correct
10544,"SELECT count(*) 
FROM person, director
where person.id=director.id;",2018-08-31 13:06:53.855568+10,12,0,325,partially correct
10545,"select count(*) from movie 
where (title,production_year) not in 
(select title, production_year from movie_award where lower(result) = 'won'
union select title, production_year from crew_award where lower(result) = 'won'
union select title, production_year from director_award where lower(result) = 'won'
union select title, production_year from writer_award where lower(result) = 'won'
union select title, production_year from actor_award where lower(result) = 'won');",2018-08-31 13:06:54.870939+10,11,1,313,correct
10546,"SELECT p.id,p.first_name,p.last_name
FROM person p
WHERE p.year_born= (SELECT MAX(year_born) FROM person);",2018-08-31 13:06:59.520972+10,7,1,439,correct
10547,"SELECT d.title, d.production_year, first_name, last_name
FROM director d, person p, movie_award ma
WHERE d.id=p.id
AND d.title=ma.title
AND d.production_year=ma.production_year
AND lower(ma.award_name)=""bafta film award""
AND lower(ma.result)=""won"";",2018-08-31 13:07:00.115189+10,8,0,312,partially correct
10548,"select year_born from Person
where year_born = '1935';",2018-08-31 13:07:11.326925+10,1,0,438,partially correct
10549,"select r.id 
from role r, appearance a
where 
 a.title = r.title and a.production_year = r.production_year and a.description = r.description
and a.production_year = 1960 and a.title = 'Psycho'
group by r.id having count(*)=1;",2018-08-31 13:07:13.267882+10,10,1,125,correct
10550,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:07:21.911722+10,10,1,126,correct
10551,"SELECT title, production_year, first_name, last_name
FROM (person NATURAL JOIN director NATURAL JOIN movie NATURAL JOIN movie_award)
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND lower(result) = 'won';",2018-08-31 13:07:33.990849+10,8,1,450,correct
10552,"select count(*)
from movie m
where m.title not in(
select movie.title
from movie,movie_award
where movie.title = movie_award.title
);
",2018-08-31 13:07:37.451317+10,11,0,261,partially correct
10553,"SELECT id, first_name, last_name
FROM person p
WHERE EXISTS( SELECT * FROM director d INNER JOIN writer w
ON d.id=w.id );

",2018-08-31 13:07:37.669177+10,4,0,441,partially correct
10554,"select production_year, count(*)
from movie
group by production_year
having production_year in (1991, 1992, 1993);",2018-08-31 13:07:53.854265+10,2,1,386,correct
10555,"select count(*)
from movie m
where m.title != (select ma.title from movie_award ma where ma.result = 'won')
	and m.title != (select da.title from director_award da where da.result = 'won')
	and m.title != (select wa.title from Writer_Award wa where wa.result = 'won')
	and m.title != (select ca.title from Crew_Award ca where ca.result = 'won')
	and m.title != (select aa.title from Actor_Award aa where aa.result = 'won')
;",2018-08-31 13:07:58.297187+10,11,0,286,partially correct
10556,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * FROM director d WHERE p.id = d.id);",2018-08-31 13:08:03.092782+10,12,1,325,correct
10557,"
SELECT
	r.id
FROM
	scene s,
	appearance a,
	ROLE r
WHERE
	s.title = a.title
	AND s.production_year = a.production_year
	AND s.scene_no = a.scene_no
	AND s.title = r.title
	AND s.production_year = r.production_year
	AND a.description = r.description
	AND lower(a.title) = 'psycho'
	AND a.production_year = 1960
GROUP BY
	r.id
HAVING
	count(*) = 1;",2018-08-31 13:08:07.230391+10,10,1,162,correct
10558,"SELECT COUNT(*)
FROM writer_award wa,person p
WHERE wa.year_of_award>=1991 AND wa.year_of_award<=1995 AND wa.id = p.id
      AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen' AND lower(wa.result) = 'won';",2018-08-31 13:08:26.318109+10,9,1,443,correct
10559,"select count(person.id) from person where person.id not in (select director.id from director);
",2018-08-31 13:08:26.672523+10,12,1,305,correct
10560,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));
                   
",2018-08-31 13:08:33.417736+10,3,1,242,correct
10561,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 13:08:59.77281+10,9,1,456,correct
10562,"SELECT production_year, count(title) FROM MOVIE WHERE production_year = 1993 or production_year = 1992 or production_year = 1991 GROUP BY production_year;",2018-08-31 13:09:06.337082+10,2,1,161,correct
10563,"select p.id,p.first_name,p.last_name,r.title,r.production_year ,r.description from person as p , role as r
where r.id=p.id
AND p.id in (
select id from role as r 
Group by id 
order by count(*) desc limit 1);",2018-08-31 13:09:07.205275+10,15,0,31,partially correct
10564,"select production_year, count(*)
from movie
where production_year in (1991, 1992, 1993)
group by production_year;
",2018-08-31 13:09:14.985413+10,2,1,386,correct
10565,"SELECT dw.id, dw.first_name, dw.last_name
FROM(person  NATURAL JOIN director NATURAL JOIN writer )AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 13:09:15.675002+10,4,1,217,correct
10566,"select p.first_name,p.last_name,r.title,r.production_year ,r.description from person as p , role as r
where r.id=p.id
AND p.id in (
select id from role as r 
Group by id 
order by count(*) desc limit 1);",2018-08-31 13:09:17.772807+10,15,1,31,correct
10567,"select count(*) 
from 
writer_award wa, 
person p, 
writer w
where 
   wa.title=w.title
   AND wa.production_year=w.production_year
   AND wa.id=w.id
   AND w.id = p.id
   AND lower(result)='won'
   AND lower(first_name)='woody'
   AND lower(last_name)='allen'
   AND year_of_award >= 1991
   AND year_of_award <= 1995;
",2018-08-31 13:09:17.923583+10,9,1,293,correct
10568, ;,2018-08-31 13:09:39.540388+10,11,0,425,noninterpretable
10569,"SELECT dw.id, dw.first_name, dw.last_name
FROM(person p  NATURAL JOIN director d NATURAL JOIN writer w)AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 13:09:41.527358+10,4,1,217,correct
10570,"select count(*) from 
writer_award natural join writer natural join person as wwp
where exists(select * from writer_award natural join writer natural join person as wwp 
where production_year >1990 and production_year <1996 and 
lower(first_name)='woody' and lower(last_name)= 'Allen');",2018-08-31 13:09:43.58025+10,9,0,452,partially correct
10571,"select count (*) from person  p  where not exists ( select * from          director  d where d.id = p.id)
;
",2018-08-31 13:10:11.098525+10,12,1,65,correct
10572,"SELECT id,first_name,last_name
FROM person
WHERE id in(
SELECT d.id
FROM director d INNER JOIN writer w
on d.id = w.id AND d.title = w.title AND d.production_year=w.production_year
GROUP BY d.id
HAVING COUNT(*)>=2
);",2018-08-31 13:10:24.74961+10,4,1,173,correct
10573,select* ;,2018-08-31 13:10:30.802661+10,14,0,317,noninterpretable
10574,SELECT;,2018-08-31 13:10:54.747413+10,11,0,162,noninterpretable
10575,"SELECT production_year,COUNT(*)
FROM MOVIE m
GROUP BY production_year
HAVING production_year = 1991;",2018-08-31 13:11:01.745239+10,2,0,23,partially correct
10576,;,2018-08-31 13:11:07.850854+10,5,0,217,noninterpretable
10577,"select count(*)
from writer_award left join person on writer_award.id=person.id
where year_of_award<1996 and year_of_award>1990 and lower(first_name)=""woody"" and lower(last_name)=""allen"";",2018-08-31 13:11:10.986789+10,9,0,432,partially correct
10578,"select count(*)
from person p
where not exists (select * from director d where p.id=d.id);",2018-08-31 13:11:14.432029+10,12,1,41,correct
10579,"select  id,d.award_name,d.year_of_award , d.category
from director, Director_Award as d
where director.title=d.title
group by d.title
having (lower(result) != 'won');",2018-08-31 13:11:17.418845+10,13,1,207,correct
10580,"
with m
as (select id, count(*) as  c
from(
select d.id,d.title,d.production_year from director d
union 
select w.id,w.title,w.production_year  from writer w
)
group by id)


;",2018-08-31 13:11:30.744181+10,14,0,391,noninterpretable
10581,123;,2018-08-31 13:11:35.809705+10,15,0,317,noninterpretable
10582,"select count(*) from
(select count(*)
from MOVIE m
where title not in (select title from MOVIE_AWARD
					where lower(result)=""won"")
and title not in (select title from CREW_AWARD
					where lower(result)=""won"")
and title not in (select title from DIRECTOR_AWARD
					where lower(result)=""won"")
and title not in (select title from WRITER_AWARD
					where lower(result)=""won"")
and title not in (select title from ACTOR_AWARD
					where lower(result)=""won"")
GROUP BY m.title);",2018-08-31 13:11:35.876063+10,11,0,302,partially correct
10583,"select first_name, last_name, title, production_year, description, credits
from person natural join role
where exists ( 


select id, count(description)
from role
where role.id = person.id
group by id
having count(description) = 
( select max(number) from (
					select id, count(description) as number
					from role
					group by id)
)
)
;",2018-08-31 13:11:54.112034+10,15,0,337,partially correct
10584,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:12:03.794351+10,14,1,377,correct
10585,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM movie_award ma NATURAL JOIN person p NATURAL JOIN director d
WHERE lower(ma.award_name)='bafta film award'AND lower(ma.category)='best film';",2018-08-31 13:12:21.264575+10,8,0,439,partially correct
10586,"select count(*)
from writer_award left join person on writer_award.id=person.id
where year_of_award<1996 and year_of_award>1990 and lower(first_name)=""woody"" and lower(last_name)=""allen"" AND lower(RESULT)= 'won';",2018-08-31 13:12:27.38538+10,9,1,432,correct
10587,"select first_name, last_name, title, production_year, description
from person natural join role
where exists ( 


select id, count(description)
from role
where role.id = person.id
group by id
having count(description) = 
( select max(number) from (
					select id, count(description) as number
					from role
					group by id)
)
)
;",2018-08-31 13:12:29.478785+10,15,1,337,correct
10588,"select count(*) from person
where exists(select * from writer where writer.id = person.id and person.year_born = 1935);
",2018-08-31 13:12:30.679389+10,1,1,438,correct
10589,"select count(*)
from movie m
where not exists( select title from movie_award ma where lower(ma.result)='won' and m.title=ma.title and m.production_year=ma.production_year
union select title from crew_award ca where lower(ca.result)='won' and m.title=ca.title and m.production_year=ca.production_year union 
select title from director_award da where lower(da.result)='won' and m.title=da.title and m.production_year=da.production_year union
select title from writer_award wa where lower(wa.result)='won' and m.title=wa.title and m.production_year=wa.production_year
union select title from actor_award aa where lower(aa.result)='won' and m.title=aa.title and m.production_year=aa.production_year);",2018-08-31 13:12:34.103936+10,11,1,244,correct
10590,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:12:39.024233+10,11,1,425,correct
10591,"selcet count(p.id)
from person p, director d
where p.id != d.id;",2018-08-31 13:13:17.144443+10,12,0,386,noninterpretable
10592,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM movie_award ma , person p , director d
WHERE ma.title=d.title AND ma.production_year=d.production_year AND d.id=p.id AND lower(ma.award_name)='bafta film award'AND lower(ma.category)='best film';",2018-08-31 13:13:43.725398+10,8,0,439,partially correct
10593,"SELECT COUNT(*)
FROM person 
WHERE EXISTS (SELECT * FROM writer
              WHERE person.id = writer.id
              AND person.year_born = 1935);
",2018-08-31 13:13:48.128378+10,1,1,169,correct
10594,"select p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r
WHERE p.id=r.id
AND  r.id=(SELECT MAX(c)
           FROM (SELECT COUNT(ID) AS c
		   FROM role
		   GROUP BY ID)
		   GROUP BY c);",2018-08-31 13:13:51.21802+10,15,0,328,partially correct
10595,;,2018-08-31 13:13:52.547182+10,8,0,428,noninterpretable
10596,"select dp.first_name,dp.last_name,ma.title, ma.production_year
from (select p.first_name, p.last_name from person as p, director as d where p.id = d.id) as dp, movie_award as ma
where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-31 13:14:13.104773+10,8,0,225,partially correct
10597,"SELECT id 
FROM scene s,
     role r,
     appearance ap
WHERE lower(s.title=r.title=ap.title)='psycho' AND s.production_year=r.production_year=ap.production_year=1960 AND lower(s.scene_no=ap.scene_no)='one' AND 
lower(ap.description)='exactly';
     ",2018-08-31 13:14:18.879481+10,10,0,233,partially correct
10598,"SELECT COUNT(*)
FROM person
WHERE NOT EXIST (SELECT * FROM DIRECTOR
                 WHERE person.id=DIRECTOR.id);
",2018-08-31 13:14:23.814815+10,12,0,278,noninterpretable
10599,"select id from person
where year_born=
(select max(year_born) from person
where year_born < (select max(year_born) from person ));
",2018-08-31 13:14:31.161778+10,3,1,313,correct
10600,"with compo as(
select title from writer, person
where writer.id = person.id
and production_year > 1990
and production_year < 1996
and first_name = 'Woody' and last_name = 'Allen')
select count(award_name)
from writer_award, compo
where writer_award.title = compo.title;",2018-08-31 13:14:32.609612+10,9,1,129,correct
10601,"select first_name,last_name from(
select p.first_name,p.last_name,count(first_name) cou
from person p,movie m ,role r
	where p.id = r.id 
	and r.title = m.title
	and r.production_year = m.production_year
	group by first_name order by count(first_name)) limit 1;",2018-08-31 13:14:34.277101+10,15,0,200,partially correct
10602,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 13:14:43.087551+10,15,1,328,correct
10603,SELECT count(*) from person where exists(select * from writer where writer.id = person.id and person.year_born = 1935);,2018-08-31 13:14:50.955041+10,1,1,213,correct
10604,"SELECT count(p.id) 
FROM person p 
WHERE NOT EXISTS 
(SELECT * 
FROM director d 
WHERE p.id = d.id);
",2018-08-31 13:14:58.940128+10,12,1,386,correct
10605,"SELECT count(*) 
FROM person p 
WHERE EXISTS (
	SELECT * 
	FROM writer w 
	WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 13:15:01.390728+10,1,1,425,correct
10634,"select production_year, count(*) from movie m
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-31 13:19:13.837952+10,2,1,438,correct
10926,"select count(*) from person
where exists (select * from writer where writer.id = person.id and person.year_born = 1935);",2018-08-31 13:56:31.648047+10,1,1,318,correct
10606,"select count(*) from movie where title not in (select title from movie_award where lower(result) = 'won' union
select title from crew_award where lower(result) = 'won' union
select title from director_award where lower(result) = 'won' union
select title from actor_award where lower(result) = 'won' union
select title from writer_award where lower(result) = 'won');",2018-08-31 13:15:09.777658+10,11,0,126,partially correct
10607,"
with m 
as (select id, count(*) as  c
from(
select d.id,d.title,d.production_year from director d
union 
select w.id,w.title,w.production_year  from writer w
)
group by id
)

select id from m
where m.c= (select max(c) from m) 

;",2018-08-31 13:15:32.153334+10,14,1,391,correct
10608,"select count(*) from 
writer_award 
where exists(select * from writer_award  
where year_of_award >1990 and year_of_award <1996 and 
lower(award_name)='woody allen' and
lower(result)='won');",2018-08-31 13:15:35.019966+10,9,0,452,partially correct
10609,"select count(*) from
(select count(*)
from MOVIE m
where title not in (select title from MOVIE_AWARD ma
					where lower(result)=""won""
					and ma.production_year=m.production_year)
and title not in (select title from CREW_AWARD ca
					where lower(result)=""won""
					and ca.production_year=m.production_year)
and title not in (select title from DIRECTOR_AWARD da
					where lower(result)=""won""
					and da.production_year=m.production_year)
and title not in (select title from WRITER_AWARD wa
					where lower(result)=""won""
					and wa.production_year=m.production_year)
and title not in (select title from ACTOR_AWARD aa
					where lower(result)=""won""
					and aa.production_year=m.production_year)
GROUP BY m.title);",2018-08-31 13:15:49.321253+10,11,1,302,correct
10610,"SELECT COUNT(id)
FROM PERSON
WHERE year_born=1935;",2018-08-31 13:15:57.75749+10,1,0,90,partially correct
10611,"SELECT a.id FROM (
SELECT id, title, production_year FROM director
UNION
SELECT id, title, production_year FROM writer) AS a GROUP BY a.id 
HAVING count(*)= (SELECT MAX(b) FROM (SELECT count(*) AS b FROM (
SELECT id, title, production_year FROM director
UNION
SELECT id, title, production_year FROM writer) AS a GROUP BY a.id)) ;",2018-08-31 13:16:01.933682+10,14,1,210,correct
10612,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM movie_award ma , person p , director d
WHERE ma.title=d.title AND ma.production_year=d.production_year AND d.id=p.id 
AND lower(ma.award_name)='bafta film award'AND lower(ma.category)='best film'AND lower(ma.result)='won';",2018-08-31 13:16:03.266137+10,8,1,439,correct
10613," SELECT COUNT(*) FROM WRITER_AWARD wa, (SELECT DISTINCT w.id FROM WRITER w, PERSON p WHERE p.id=w.id AND lower(p.first_name)='woody' AND lower(p.last_name)='allen') AS pw WHERE wa.id = pw.id AND wa.year_of_award > 1991 AND wa.year_of_award <= 1995;",2018-08-31 13:16:05.385604+10,9,1,404,correct
10614,"SELECT * FROM scene
WHERE lower(title)='psycho';",2018-08-31 13:16:10.299317+10,10,0,453,partially correct
10615,"select ma.title , ma.production_year, p.first_name, p.last_name
from (select title, production_year
from movie_award 
where lower(award_name) = 'bafta film award'
and  lower(category) = 'best film'
and lower(result) = 'won') as ma, person p, director d
where  ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 13:16:26.035332+10,8,1,123,correct
10616,"SELECT ma.title, ma.production_year, p.first_name,p.last_name
FROM movie_award ma NATURAL JOIN person p NATURAL JOIN director d
WHERE lower(ma.award_name)='bafta film award'AND lower(ma.category)='best film'AND lower(ma.result)='won';",2018-08-31 13:16:32.957741+10,8,1,439,correct
10617,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:16:48.658675+10,11,1,126,correct
10618,"select production_year, count(*) 
from movie 
where movie.production_year = 1993 or movie.production_year = 1992 or movie.production_year = 1991
group by production_year;
",2018-08-31 13:16:50.531404+10,2,1,425,correct
10619,"select distinct p.id, p.first_name, p.last_name
from person p inner join director d on p.id=d.id
                     inner join writer w on p.id = w.id
where d.title = w.title and d.production_year = w.production_year;",2018-08-31 13:17:17.156386+10,4,0,41,partially correct
10620,"SELECT id
FROM PERSON
WHERE year_born  = (
	SELECT MAX(p2.year_born)
	FROM (
		SELECT year_born
		FROM PERSON p1
		WHERE p1.year_born < 1992
		) p2
	);",2018-08-31 13:17:17.417505+10,3,1,423,correct
10621,"select count (*)
from writer_award wa,writer w, person p
where wa.id= w.id
and wa.title=w.title
and wa.production_year=w.production_year
and p.id=w.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award<='1995'
and wa.year_of_award>='1991';",2018-08-31 13:17:19.259823+10,9,0,349,partially correct
10622,"select id, first_name, last_name from person
where person.id in (select director.id from director join writer on director.id = writer.id where director.title = writer.title and director.production_year = writer.production_year);",2018-08-31 13:17:23.569353+10,4,0,305,partially correct
10623,"SELECT m.title,m.production_year
FROM movie m INNER JOIN writer w
ON m.title=w.title AND m.production_year=w.production_year
WHERE w.id=(
SELECT id
FROM person
WHERE lower(first_name)='kevin' AND lower(last_name)='williamson'
);",2018-08-31 13:17:36.401535+10,5,1,173,correct
10624,"SELECT title, production_year
FROM writer w
WHERE EXISTS (SELECT * FROM person p 
WHERE first_name='Kevin' AND last_name='Williamson' AND w.id=p.id);",2018-08-31 13:17:40.933704+10,5,1,441,correct
10625,"SELECT SUM(*)
FROM person p, director d, movie m
WHERE EXISTS (

SELECT DIRECTOR

);",2018-08-31 13:17:50.759731+10,12,0,23,noninterpretable
10626,"SELECT production_year, COUNT(*)
FROM movie
WHERE movie.production_year >= 1991
AND movie.production_year <= 1993
GROUP BY movie.production_year;",2018-08-31 13:18:01.610008+10,2,1,169,correct
10627,"SELECT ma.title, ma.production_year, first_name, last_name
FROM director d, person p, movie_award ma
WHERE d.id=p.id
AND d.title=ma.title
AND d.production_year=ma.production_year
AND lower(ma.award_name)=""bafta film award""
AND lower(category)=""best film""
AND lower(ma.result)=""won"";

",2018-08-31 13:18:08.090395+10,8,1,312,correct
10628,"select count(*)
from person p
where not exists (
select * from director d where d.id = p.id);",2018-08-31 13:18:11.137742+10,12,1,425,correct
10629,"select production_year, count(*) from movie m
where production_year = 1993 or production_year = 1992 or production_year = 1991;",2018-08-31 13:18:18.669656+10,2,0,438,partially correct
10630,"SELECT x1.id 
FROM 

(SELECT id, COUNT(*) AS Noofwork
FROM 
(SELECT d.id,d.production_year,d.title 
FROM director d 
UNION 
SELECT w.id,w.production_year,w.title
FROM writer w) x
GROUP BY x.id) x1
WHERE x1.Noofwork=
(SELECT MAX(x2.Noofwork)
FROM
(SELECT x.id,count(*) as Noofwork
FROM 
(SELECT d.id,d.production_year,d.title 
FROM director d 
UNION 
SELECT w.id,w.production_year,w.title
FROM writer w) x
GROUP BY x.id) x2);
",2018-08-31 13:18:27.998941+10,14,1,195,correct
10631,"select first_name,last_name
from person as p, (SELECT * FROM director,person where director.id=person.id) as a
where p.id=a.id
and a.p_count>1;",2018-08-31 13:18:29.294858+10,4,0,325,noninterpretable
10632,"SELECT count(distinct person.id) from person, writer
WHERE person.id = writer.id
AND person.year_born = '1935';",2018-08-31 13:18:42.26998+10,1,1,459,correct
10633,"select dw.id, dw.first_name, dw.last_name
from (person natural join writer natural join director) as dw
group by dw.id
having count(*) > 1;",2018-08-31 13:19:06.36867+10,4,1,425,correct
10635,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:19:18.366616+10,11,1,162,correct
10636,"SELECT COUNT(DISTINCT id) FROM writer NATURAL JOIN person
WHERE year_born = 1935;",2018-08-31 13:19:19.825608+10,1,1,25,correct
10637,"select id, first_name, last_name
from person natural join writer natural join director
group by id 
having count(*)>1;

",2018-08-31 13:19:22.378081+10,4,1,154,correct
10638,SELECT;,2018-08-31 13:19:31.133321+10,4,0,23,noninterpretable
10639,"SELECT production_year, count(*) from movie where production_year > 1990 and production_year < 1994;",2018-08-31 13:19:32.398204+10,2,0,213,partially correct
10640,"SELECT title,production_year
FROM writer 
WHERE id IN (
SELECT id
FROM person
WHERE lower(first_name)='kevin' AND lower(last_name)='williamson'
);",2018-08-31 13:19:34.550485+10,5,1,173,correct
10641,"select p.first_name,p.last_name from person p,(select id,count(*) from director natural join writer group by id having count(*)>=2) as dw where p.id=dw.id;",2018-08-31 13:19:42.870066+10,4,0,255,partially correct
10642,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 13:19:48.906595+10,4,1,325,correct
10643,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT *
                 FROM director d
			WHERE d.id=p.id);",2018-08-31 13:19:58.764701+10,12,1,253,correct
10644,"select id, first_name, last_name from person where person.id in
(select director.id from director join writer on director.id = writer.id where director.title = writer.title and director.production_year = writer.production_year group by director.id having count(*) >1);",2018-08-31 13:20:10.289761+10,4,1,305,correct
10645,"select count(*) from 
writer_award natural join person
where exists(select * from writer_award natural join person as wp  
where year_of_award >1990 and year_of_award <1996 and 
lower(first_name)='woody' and lower(last_name)='allen' and
lower(result)='won');",2018-08-31 13:20:12.26947+10,9,0,452,partially correct
10646,"SELECT production_year, count(production_year) from movie where production_year > 1990 and production_year < 1994 group by production_year;",2018-08-31 13:20:24.326744+10,2,1,213,correct
10647,"select id from movie where title=""Psycho"" and production_year=1960;",2018-08-31 13:20:31.538262+10,10,0,456,noninterpretable
10648,"select count(*)
from movie m
where not exists (select ma.title, ma.production_year from movie_award ma where lower(ma.result) = 'won' and m.title = ma.title and m.production_year = ma.production_year
    union select da.title, da.production_year from director_award da where lower(da.result) = 'won' and m.title = da.title and m.production_year = da.production_year
    union select wa.title, wa.production_year from Writer_Award wa where lower(wa.result) = 'won' and m.title = wa.title and m.production_year = wa.production_year
    union select ca.title, ca.production_year from Crew_Award ca where lower(ca.result) = 'won' and m.title = ca.title and m.production_year = ca.production_year
    union select aa.title, aa.production_year from Actor_Award aa where lower(aa.result) = 'won' and m.title = aa.title and m.production_year = aa.production_year
);",2018-08-31 13:20:36.207893+10,11,1,286,correct
10649,SELECT;,2018-08-31 13:20:38.67428+10,5,0,23,noninterpretable
10650,"select count(*) 
from movie
where not exists(
select title, production_year from movie_award
where movie_award.title = movie.title and movie_award.production_year = movie.production_year and lower(movie_award.result) = ""won""
union
select title, production_year from crew_award
where crew_award.title = movie.title and crew_award.production_year = movie.production_year and lower(crew_award.result) = ""won""
union
select title, production_year from director_award
where director_award.title = movie.title and director_award.production_year = movie.production_year and lower(director_award.result) = ""won""
union
select title, production_year from writer_award
where writer_award.title = movie.title and writer_award.production_year = movie.production_year and lower(writer_award.result) = ""won""
union
select title, production_year from actor_award
where actor_award.title = movie.title and actor_award.production_year = movie.production_year and lower(actor_award.result) = ""won""
);",2018-08-31 13:20:58.638648+10,11,1,337,correct
10651,"select count(*) from 
writer_award natural join person
where exists(select * from writer_award natural join person as wp  
where year_of_award >1990 and year_of_award <1996 and 
lower(first_name)='woody' and lower(last_name)='allen' and
lower(result)='won');",2018-08-31 13:21:07.448178+10,9,0,452,partially correct
10652,"SELECT COUNT(*)
FROM MOVIE
WHERE production_year=1991 OR production_year=1992 OR production_year=1993;",2018-08-31 13:21:10.895809+10,2,0,90,partially correct
10653,"with sub as (
select id,count(*) as num
from(
select id, title, production_year
from director d
union
select id, title, production_year 
from writer w
)
group by id
)

select id from sub where num =( select max(num) from sub) ;
",2018-08-31 13:21:15.597758+10,14,1,125,correct
10654,"select mp.title,mp.production_year,mp.first_name,mp.last_name
	from (person natural join director natural join movie_award)as mp
where lower(mp.result)='won'
	and lower(mp.category)='best film'
	and lower(mp.award_name)='bafta film award';",2018-08-31 13:21:39.943937+10,8,1,149,correct
10655,"SELECT COUNT(*)
FROM person p
WHERE
	p.id IN (SELECT wid FROM (
		SELECT w.id as wid, d.id as did
		FROM writer w, director d
		WHERE 
		w.title=d.title
		AND w.production_year=d.production_year
		GROUP BY w.title, w.production_year
	))
	OR p.id IN (SELECT did FROM (
		SELECT w.id as wid, d.id as did
		FROM writer w, director d
		WHERE 
		w.title=d.title
		AND w.production_year=d.production_year
		GROUP BY w.title, w.production_year
	))

SELECT w.id as wid, d.id as did
FROM writer w, director d
WHERE 
	w.title=d.title
	AND w.production_year=d.production_year
GROUP BY w.title, w.production_year
;",2018-08-31 13:21:51.665664+10,14,0,427,noninterpretable
10656,"SELECT production_year,COUNT(production_year) FROM movie
WHERE production_year >= 1991 AND production_year <= 1993
GROUP BY production_year;",2018-08-31 13:21:52.989072+10,2,1,25,correct
10657,SELECT;,2018-08-31 13:21:56.04254+10,6,0,23,noninterpretable
10658,"SELECT COUNT(*)
FROM writer_award wa, person p
WHERE wa.id=p.id AND wa.year_of_award BETWEEN 1991 AND 1995 AND p.first_name='Woody' AND p.last_name='Allen'AND lower(wa.result)='won';",2018-08-31 13:22:07.009376+10,9,1,439,correct
10659,"SELECT id
FROM PERSON
WHERE year_born = (
	SELECT MAX(year_born)
	FROM PERSON
	WHERE year_born < (
		SELECT MAX(year_born)
		FROM PERSON
		)
	);",2018-08-31 13:22:14.516144+10,3,1,423,correct
10660,"select count(*) from 
writer_award natural join person natural join writer
where exists(select * from writer_award natural join person natural join writer as wpw  
where year_of_award >1990 and year_of_award <1996 and 
lower(first_name)='woody' and lower(last_name)='allen' and
lower(result)='won');",2018-08-31 13:22:20.876175+10,9,0,452,partially correct
10661,"SELECT count(*)
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id = person.id AND person.year_born = 1935);",2018-08-31 13:22:34.081448+10,1,1,420,correct
10662,"SELECT w.title, w.production_year
FROM writer w, 
     person p
WHERE w.id=p.id
      AND p.first_name='kevin'
      AND p.last_name='williamson';",2018-08-31 13:22:40.171732+10,5,0,217,partially correct
10663,SELECT;,2018-08-31 13:22:40.283144+10,3,0,162,noninterpretable
10664,"SELECT COUNT(id) FROM person
WHERE id NOT IN (SELECT id FROM director);",2018-08-31 13:22:48.134988+10,12,1,25,correct
10666,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
person p, role r, (select id,count(*)as n_of_r
from role r
group by id
) as b
where r.id=p.id
and p.id=b.id
and b.n_of_r in (select max(n_of_r)
from(select id,count(*)as n_of_r
from role
group by id)as a);",2018-08-31 13:23:13.538627+10,15,1,377,correct
10667,;,2018-08-31 13:23:15.578818+10,12,0,90,noninterpretable
10668,"select dw.id, dw.first_name, dw.last_name
from (person p natural join director
                     natural join writer ) as dw
group by dw.id
having count(*)>1;",2018-08-31 13:23:15.79434+10,4,1,41,correct
10669,SELECT;,2018-08-31 13:23:16.979386+10,7,0,23,noninterpretable
10670,SELECT count(p.id) FROM PERSON AS p WHERE EXISTS (SELECT id FROM DIRECTOR);,2018-08-31 13:23:32.903891+10,12,0,161,partially correct
10671,"select count (*)
from writer_award wa,writer w, person p
where wa.id= w.id
and wa.title=w.title
and wa.production_year=w.production_year
and p.id=w.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award<='1995'
and wa.year_of_award>='1991'
and lower(wa.result)='won';",2018-08-31 13:23:39.988973+10,9,1,349,correct
10672,select id from person where year_born = (select year_born from person order by year_born desc limit 1 offset 1);,2018-08-31 13:24:01.046058+10,3,1,126,correct
10673,"SELECT country 
FROM restriction
WHERE lower(title)='shakespeare in love'
AND lower(description)='m';",2018-08-31 13:24:14.84212+10,6,1,173,correct
10674,SELECT;,2018-08-31 13:24:19.29115+10,8,0,23,noninterpretable
10675,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;
     ",2018-08-31 13:24:23.535116+10,10,1,233,correct
10676,"with actName as(
select description
from appearance 
where title = 'Psycho' and production_year = 1960
group by description
having count(description) = 1)
select id from person where id in(
select id from role, actName
where role.description = actName.description);",2018-08-31 13:24:25.450756+10,10,0,129,partially correct
10677,"select count(*) from person
where exists(select * from director where director.id = person.id);",2018-08-31 13:24:30.620806+10,12,0,438,partially correct
10678,"select v.id, v.firstname ,v.lastname form (person p natural join writer w natural join 


director d ) as v
group by v.id 

having count(*) >1;",2018-08-31 13:24:35.969095+10,4,0,65,noninterpretable
10679,"SELECT count(*)
FROM (person NATURAL JOIN writer_award)
WHERE lower(first_name) = ""woody"" AND lower(last_name) = ""allen"" 
AND lower(result) = 'won' AND year_of_award > 1990 AND year_of_award < 1996;",2018-08-31 13:24:40.375867+10,9,1,450,correct
10680,SELECT count(p.id) FROM PERSON AS p WHERE NOT EXISTS (SELECT id FROM DIRECTOR AS d WHERE p.id=d.id);,2018-08-31 13:25:03.201827+10,12,1,161,correct
10681,"SELECT id, first_name, last_name, MIN(year_born)
FROM PERSON;
",2018-08-31 13:25:04.534879+10,7,0,249,partially correct
10682,"SELECT id, first_name, last_name
FROM person 
WHERE year_born=(
SELECT max(year_born)
FROM person);",2018-08-31 13:25:05.603356+10,7,1,312,correct
10683,"SELECT COUNT(*)
FROM person p, writer w
WHERE p.id=w.id
AND p.year_born=1935;",2018-08-31 13:25:08.505546+10,1,0,328,partially correct
10684,"select count(*) from person
where not exists(select * from director where director.id = person.id);",2018-08-31 13:25:09.507035+10,12,1,438,correct
10685,"select production_year, count(*)
from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-31 13:25:38.293992+10,2,1,291,correct
10686,"SELECT title,production_year,id
FROM (movie NATURAL JOIN writer NATURAL JOIN person) as m
where m.first_name=Kevin
GROUP BY title;",2018-08-31 13:25:41.091768+10,5,0,325,noninterpretable
10687,"SELECT id, first_name, last_name
FROM person
WHERE year_born =
(
SELECT MAX(year_born)
FROM person);",2018-08-31 13:26:23.519928+10,7,1,173,correct
10688,"select p.id, p.first_name, p.last_name
from (person p 
inner join director d
on p.id=d.id
inner join writer w
on d.id=w.id) as j
where exist 
(select count(p.id)>=2;",2018-08-31 13:26:37.793633+10,4,0,386,noninterpretable
10689,SELECT id FROM ROLE r WHERE (SELECT COUNT(*) FROM APPEARANCE a WHERE a.title='Psycho' AND a.description = r.description) = 1;,2018-08-31 13:26:40.537549+10,10,0,404,partially correct
10690,"SELECT;
",2018-08-31 13:26:46.715825+10,9,0,23,noninterpretable
10691,"SELECT country
FROM RESTRICTION r
WHERE EXISTS (SELECT * FROM RESTRICTION_CATEGORY rc WHERE r.description=rc.description='M');",2018-08-31 13:26:52.859781+10,6,0,441,partially correct
10692,"SELECT p.id
FROM person p
WHERE p.year_ born = (
		SELECT MAX(year_born)
		FROM person
		WHERE year_born < (
							SELECT MAX(year_born
							FROM person));",2018-08-31 13:27:00.682216+10,3,0,162,noninterpretable
10693,"SELECT title,production_year,id
FROM (movie NATURAL JOIN writer NATURAL JOIN person) as m
where lower(first_name)='kevin' and lower(last_name)= 'williamson'
GROUP BY title;",2018-08-31 13:27:16.502683+10,5,0,325,partially correct
10694,select country from Restriction where lower(title) = 'shakespeare in love' and lower(description) = 'm';,2018-08-31 13:27:33.677901+10,6,1,430,correct
10695,"SELECT p.id
FROM person p
WHERE p.year_ born = (
		SELECT MAX(year_born)
		FROM person
		WHERE year_born < (
							SELECT MAX(year_born
							FROM person));",2018-08-31 13:27:37.013375+10,3,0,162,noninterpretable
10696,SELECT;,2018-08-31 13:27:38.087956+10,10,0,23,noninterpretable
10697,"SELECT w.title, w.production_year
FROM writer w, 
     person p
WHERE w.id=p.id
      AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 13:27:40.042187+10,5,1,217,correct
10698,"SELECT MOVIE_AWARD.title,MOVIE_AWARD.production_year,PERSON.first_name,PERSON.last_name
FROM (SELECT title,production_year FROM MOVIE_AWARD WHERE award_name='BAFTA Film Award' AND category='Best Film' AND lower(result)='won') AS MOVIE_AWARD,PERSON,DIRECTOR
WHERE MOVIE_AWARD.title = DIRECTOR.title AND MOVIE_AWARD.production_year = DIRECTOR.production_year AND DIRECTOR.id=PERSON.id;",2018-08-31 13:27:42.98877+10,8,0,428,partially correct
10699,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, (SELECT *
                          FROM director_award
                          EXCEPT 
			     SELECT *
			     FROM director_award da1
			     WHERE lower(da1.result) = 'won') AS da
WHERE d.title = da.title;",2018-08-31 13:28:01.883871+10,13,1,242,correct
10700,"select w.title, w.production_year
from person p, writer w
where p.id = w.id and p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-31 13:28:11.336315+10,5,1,425,correct
10701,"SELECT p.id
FROM person p
WHERE p.year_ born = (SELECT MAX(year_born) 
		FROM person
		WHERE year_born < (SELECT MAX(year_born
				FROM person));",2018-08-31 13:28:16.135042+10,3,0,162,noninterpretable
10702,"select d.id, da.award_name, da.year_of_award, da.category ,result
from director d inner join director_award da on d.title = da.title and d.production_year = da.production_year
group by d.id
having lower(da.result) ='nominated' and lower(da.result) not in ('won') ;",2018-08-31 13:28:19.308161+10,13,0,313,partially correct
10703,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) 
		FROM person
		WHERE year_born < (SELECT MAX(year_born
				FROM person));",2018-08-31 13:28:30.451387+10,3,0,162,noninterpretable
10704,"select country
from restriction
where lower(title) = 'shakespeare in love' and description = 'M';",2018-08-31 13:28:32.403632+10,6,1,425,correct
10705,"select j.id, j.first_name, j.last_name
from (person p 
inner join director d
on p.id=d.id
inner join writer w
on d.id=w.id) as j
group by j.id
having count(j.id)>=2;",2018-08-31 13:28:35.690866+10,4,0,386,partially correct
10706,SELECT;,2018-08-31 13:28:37.991759+10,11,0,380,noninterpretable
10707,"select w.title, w.production_year
from person p natural join writer w
where p.first_name = 'Kevin' and p.last_name = 'Williamson';",2018-08-31 13:28:46.617929+10,5,1,41,correct
10708,"select id
from scene natural join appearance left join role on title=title
where lower(title)='psycho' and production_year=1960
having count(*)=1
group by id;
",2018-08-31 13:28:47.035009+10,10,0,432,noninterpretable
10709,SELECT;,2018-08-31 13:28:49.941273+10,11,0,23,noninterpretable
10742,"select count(*)
from movie, movie_award;",2018-08-31 13:32:27.119463+10,11,0,432,partially correct
11028,"select count(*)

FROM
    person p
WHERE exists(select * from writer w where w.id = p.id and year_born = 1935);
   
",2018-08-31 14:07:19.669334+10,1,1,418,correct
10710,"select r.id
from role r, appearance a, scene s
where r.title=s.title
and s.production_year=r.production_year
and a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.description=r.description
group by r.id
having count(*)=1;",2018-08-31 13:28:50.186988+10,10,0,349,partially correct
10711,"SELECT MOVIE_AWARD.title,MOVIE_AWARD.production_year,PERSON.first_name,PERSON.last_name
FROM (SELECT title,production_year FROM MOVIE_AWARD WHERE lower(award_name)='bafta film award' AND category='best film' AND lower(result)='won') AS MOVIE_AWARD,PERSON,DIRECTOR
WHERE MOVIE_AWARD.title = DIRECTOR.title AND MOVIE_AWARD.production_year = DIRECTOR.production_year AND DIRECTOR.id=PERSON.id;",2018-08-31 13:28:55.466293+10,8,1,428,correct
10712,"SELECT production_year, count(title)
FROM movie
WHERE production_year>1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 13:29:03.506702+10,2,1,420,correct
10713,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 13:29:04.53312+10,9,1,452,correct
10714,"SELECT country 
FROM RESTRICTION
WHERE title='Shakespeare in Love' AND description='M';
",2018-08-31 13:29:07.345564+10,6,1,441,correct
10715,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:29:10.622258+10,10,1,432,correct
10716,"select country
from restriction
where lower(title) = 'shakespeare in love' and description = 'M';",2018-08-31 13:29:11.980098+10,6,1,425,correct
10717,"select d.id, da.award_name, da.year_of_award, da.category
from director d inner join director_award da on d.title = da.title and d.production_year = da.production_year
group by d.id
having lower(da.result) ='nominated' and lower(da.result) not in ('won') ;",2018-08-31 13:29:25.579526+10,13,1,313,correct
10718,"select r.id
from role r, appearance a, scene s
where r.title=s.title
and s.production_year=r.production_year
and a.title=s.title
and a.production_year=s.production_year
and a.scene_no=s.scene_no
and a.description=r.description
AND lower(a.title) = 'psycho'
AND a.production_year = 1960
group by r.id
having count(*)=1;",2018-08-31 13:29:44.919168+10,10,1,349,correct
10719,"select m.id, m.first_name, m.last_name
from (select max(year_born), id, first_name, last_name from person) as m;
",2018-08-31 13:29:47.967184+10,7,1,425,correct
10720,"SELECT;
",2018-08-31 13:30:00.958776+10,3,0,23,noninterpretable
10721,"select id, first_name, last_name from person
where exists(select count(*)>2 from director where );",2018-08-31 13:30:01.047438+10,4,0,438,noninterpretable
10722,"select m.title, m.production_year,p.first_name, p.last_name
from director d, (select *
from movie_award
where lower(award_name) = ""bafta film award"" and lower(category) = ""best film"" and result = ""won"" ) as m,
person p
where m.title = d.title and p.id = d.id;
",2018-08-31 13:30:15.73676+10,8,1,425,correct
10723,"SELECT id 
FROM (
	SELECT id, count(*) AS no_work_on 
	FROM (
		SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w
	) GROUP BY id) x1
WHERE x1.no_work_on=(
	SELECT MAX(no_work_on)
	FROM (
		SELECT id, count(*) AS no_work_on 
		FROM (
			SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w
		) GROUP BY id) x2);",2018-08-31 13:30:18.613812+10,14,1,427,correct
10724,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 13:30:25.829562+10,5,1,325,correct
10725,"select j.id, j.first_name, j.last_name
from (person p NATURAL JOIN director NATURAL JOIN writer) as j
group by j.id
having count(*)>=2;",2018-08-31 13:30:32.926788+10,4,1,386,correct
10726,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 13:30:34.935943+10,3,1,162,correct
10727,"with an as(
select *
from appearance 
where title = 'Psycho' and production_year = 1960
group by description
having count(description) = 1)
select id from person where id in(
select id from role, an
where role.title = an.title
and role.production_year = an.production_year
and role.description = an.description);",2018-08-31 13:30:40.997496+10,10,1,129,correct
10728,"select COUNT(*) AS number_of_award
from person p, writer w, (select *
from writer_award
where year_of_award <1996 and year_of_award > 1990 and lower(result) = ""won"" ) as wa
where w.title = wa.title and p.id = w.id
group by p.first_name
having p.first_name = ""Woody"" and p.last_name = ""Allen"";

",2018-08-31 13:30:49.045071+10,9,1,425,correct
10729,"SELECT;
",2018-08-31 13:30:49.966199+10,13,0,23,noninterpretable
10730,SELECT;,2018-08-31 13:31:05.649676+10,11,0,233,noninterpretable
10731,"select p1.id
from person p1
where p1.year_born = (
    select max(p2.year_born) 
    from person p2 
    where p2.year_born != (
        select max(p3.year_born) 
        from person p3));",2018-08-31 13:31:09.702839+10,3,1,286,correct
10732,"select count(*)
from writer w,
person p
where p.id=w.id
p.year_born=1935;",2018-08-31 13:31:19.78957+10,1,0,377,noninterpretable
10733,"select p.id
from person p,
role r
(select x.title from (scene natural join appearance)as x where lower(x.title)='psycho')as xx
where 
xx.title=r.title;",2018-08-31 13:31:24.125909+10,10,0,293,noninterpretable
10734,"select id, award_name, year_of_award,category from Director natural join director_award where id in (select id from Director natural join director_award where lower(result) <> 'won');",2018-08-31 13:31:29.44646+10,13,1,126,correct
10735,"select r.id
from scene s, appearance a, role r
where s.title = a.title and s.production_year = a.production_year and s.scene_no = a.scene_no
and s.title = r.title AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-31 13:31:30.32855+10,10,1,425,correct
10736,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);
",2018-08-31 13:31:30.941496+10,7,1,250,correct
10737,"SELECT id 
FROM appearance a, role r, scene s
WHERE lower(a.title)='psycho' and a.production_year = 1960 and a.title=r.title and a.production_year = r.production_year
      and s.scene_no = a.scene_no and a.title = s.title and a.production_year = s.production_year
GROUP BY r.id
having count(*)=1;",2018-08-31 13:31:37.61719+10,10,0,443,partially correct
10738,"select count(*)
from writer w,
person p
where p.id=w.id and
p.year_born=1935;",2018-08-31 13:31:54.728661+10,1,0,377,partially correct
10739,select count(distinct id) from person where not exists(select id from director where director.id = person.id);,2018-08-31 13:32:10.784142+10,12,1,213,correct
10740,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:32:13.424266+10,11,1,233,correct
10741,"select id, first_name, last_name from person order by year_born DESC limit 1;
",2018-08-31 13:32:21.543439+10,7,1,430,correct
10743,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:32:30.037429+10,10,1,456,correct
10744,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-31 13:32:59.047094+10,6,1,41,correct
10745,;,2018-08-31 13:33:00.27198+10,6,0,217,noninterpretable
10746,"SELECT;
",2018-08-31 13:33:04.723991+10,14,0,23,noninterpretable
10747,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);
",2018-08-31 13:33:14.249823+10,7,1,430,correct
10748,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, (SELECT *
                          FROM director_award
                          EXCEPT 
			     SELECT *
			     FROM director_award da1
			     WHERE lower(da1.result) = 'won') AS da
WHERE d.title = da.title AND d.production_year = da.production_year;",2018-08-31 13:33:17.526006+10,13,1,242,correct
10749,"select  d.id,
    da.award_name,
    da.year_of_award,
    da.category
from director_award da natural join director d 
where lower(da.result)= 'nominated' and d.id not in ( SELECT
            id
        FROM
            director_award da natural join director d
        WHERE
            lower(da.result)= 'won' );",2018-08-31 13:33:21.060601+10,13,1,244,correct
10750,SELECT movies;,2018-08-31 13:33:25.336839+10,2,0,115,noninterpretable
10751,"select count(*)
from movie m
where m.production_year=1991
union
select count(*)
from movie m
where m.production_year=1992
union
select count(*)
from movie m
where m.production_year=1993;",2018-08-31 13:33:28.725249+10,2,0,377,partially correct
10752,"WITH a AS 
(SELECT x.id, COUNT(*) as Noofwork
FROM 
(SELECT w.id, w.title, w.production_year
FROM writer w
UNION 
SELECT d.id,d.title,d.production_year
FROM director d ) x 
GROUP BY x.id)

SELECT id 
FROM a
WHERE Noofwork = 
(SELECT MAX(Noofwork) from a);",2018-08-31 13:33:34.745604+10,14,1,195,correct
10753,"select title, production_year
from writer
where ;",2018-08-31 13:33:44.333788+10,5,0,386,noninterpretable
10754,"



select director.id, Director_Award.award_name, director_award.year_of_award, director_award.category

from director natural join director_award

where lower(director_award.result) = 'nominated';",2018-08-31 13:33:52.058887+10,13,1,235,correct
10755,"SELECT;
",2018-08-31 13:34:07.089837+10,15,0,23,noninterpretable
10756,"select production_year,count(*)
from movie m
where m.production_year=1991
union
select production_year,count(*)
from movie m
where m.production_year=1992
union
select production_year,count(*)
from movie m
where m.production_year=1993;",2018-08-31 13:34:23.605658+10,2,1,377,correct
10757,"SELECT title,production_year FROM person NATURAL JOIN writer
WHERE lower(first_name) = 'kevin'
AND lower (last_name) = 'williamson';",2018-08-31 13:34:44.708567+10,5,1,25,correct
10758,"SELECT COUNT(*)
FROM person
WHERE NOT EXISTS (SELECT * FROM director
                  WHERE person.id = director.id);",2018-08-31 13:35:00.202146+10,12,1,169,correct
10759,"select d.id, d.first_name, d.last_name from (director natural join writer natural join person) as d
group by d.id
having count(*)>1;",2018-08-31 13:35:26.721796+10,4,1,438,correct
10760,"select count(*)
from (person p natural join writer w) as pw
where pw.year_born = 1935;",2018-08-31 13:35:31.341301+10,1,0,357,partially correct
10761,"select pw.title,pw.production_year from (person natural join writer) as pw where pw.first_name='Kevin' and pw.last_name='Williamson';",2018-08-31 13:35:40.285558+10,5,1,255,correct
10762,"SELECT count(*)
FROM (
SELECT wa.id
FROM writer_award wa, person p
WHERE wa.id=p.id
AND Lower(first_name)=""woody""
AND lower(last_name)=""allen""
AND LOWER(result)=""won""
AND year_of_award>1990
AND year_of_award<1996);",2018-08-31 13:35:43.187397+10,9,1,312,correct
10763,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 13:35:49.386388+10,5,1,386,correct
10764,"SELECT id 
FROM appearance a, role r, scene s
WHERE lower(a.title)='psycho' and a.production_year = 1960 and a.title=r.title and a.production_year = r.production_year
      and s.scene_no = a.scene_no and a.title = s.title and a.production_year = s.production_year and a.description = r.description
GROUP BY r.id
having count(*)=1;",2018-08-31 13:36:10.040003+10,10,1,443,correct
10765,"select id
from person
where (count(*)>;",2018-08-31 13:36:15.18807+10,3,0,432,noninterpretable
10766,"SELECT year_born, COUNT() AS writer
FROM writer, person
GROUP BY year_born
HAVING person.year_born = 1935;",2018-08-31 13:36:15.4632+10,1,0,251,partially correct
10767,"SELECT country FROM restriction 
WHERE lower(description) = 'm'
AND lower(title) = 'shakespeare in love';",2018-08-31 13:36:23.749802+10,6,1,25,correct
10768,"SELECT r.id FROM role r

WHERE r.title=(
			SELECT s.title FROM scene s
			WHERE s.production_year=1960
			AND s.scene_no=1
			AND s.title='psycho');",2018-08-31 13:36:47.218599+10,10,0,453,partially correct
10769,"SELECT aw_m.title, aw_m.production_year, p.first_name, p.last_name
FROM director d INNER JOIN(
	SELECT title, production_year
	FROM movie_award
	WHERE lower(category)='best film' AND lower(award_name)='bafta film award' AND lower(result)='won') AS aw_m
	INNER JOIN person p
ON d.title=aw_m.title AND d.production_year=aw_m.production_year AND p.id = d.id
;",2018-08-31 13:36:55.307768+10,8,1,173,correct
10770,SELECT;,2018-08-31 13:36:56.795606+10,3,0,380,noninterpretable
10771,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM movie_award ma, (person NATURAL JOIN director) AS p
WHERE ma.title = p.title AND ma.production_year = p.production_year AND lower(ma.award_name)='bafta film award' 
AND lower(ma.category)='best film' AND lower (ma.result)='won';
",2018-08-31 13:37:01.613257+10,8,1,343,correct
10772,"select id from scene, crew
where lower(scene.title)='psycho' and  scene.production_year= 1960 and scene.scene_no = 1
and scene.production_year= crew.production_year;",2018-08-31 13:37:05.101249+10,10,0,452,partially correct
10773,"select count(*)
from person
where not exists(select id
from director
where person.id=director.id);",2018-08-31 13:37:42.469588+10,12,1,377,correct
10774,"SELECT id,first_name,last_name FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-31 13:37:42.820348+10,7,1,25,correct
10775,"SELECT count(*), production_year
FROM movie
WHERE production_year in ('1991','1992','1993')
GROUP BY production_year;",2018-08-31 13:37:46.157577+10,2,1,459,correct
10776,"SELECT id, award_name, year_of_award, category
FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dd
WHERE EXISTS (
	SELECT id, COUNT(result)
	FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dad
	WHERE dad.result = (
		
		)
	);",2018-08-31 13:37:53.801428+10,13,0,423,noninterpretable
10777,"SELECT id,first_name,last_name
FROM person p
WHERE p.id=(SELECT d.id
            FROM director d INNER JOIN writer w on d.id=w.id);",2018-08-31 13:37:53.958755+10,4,0,253,partially correct
10778,"select id from person
where year_born in(
select max(year_born)
from PERSON
where year_born not in(select max(year_born)
				from PERSON) );",2018-08-31 13:38:13.773693+10,3,1,302,correct
10779,"select id from scene, crew
where lower(scene.title)='psycho' and  scene.production_year= 1960 and scene.scene_no = 1
and scene.production_year= crew.production_year and scene.title=crew.title;",2018-08-31 13:38:13.85344+10,10,0,452,partially correct
10780,"SELECT production_year, count(*)
FROM movie
WHERE production_year in ('1991','1992','1993')
GROUP BY production_year;",2018-08-31 13:38:25.86947+10,2,1,459,correct
10781,"WITH b AS (SELECT id, COUNT(*) AS a FROM role GROUP BY id)
SELECT first_name, last_name,description FROM person NATURAL JOIN role 
WHERE id=(SELECT c.id FROM b AS c WHERE c.a =(SELECT MAX(e.a) FROM b AS e));",2018-08-31 13:38:29.670589+10,15,0,210,partially correct
10825, ;,2018-08-31 13:43:43.336118+10,10,0,206,noninterpretable
10782,"
SELECT x.id 
FROM (SELECT x1.id, count(*) AS c
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.c= 
	(SELECT MAX(x2.c) 
	FROM (SELECT x1.id, count(*) AS c 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:38:38.742704+10,14,1,244,correct
10783,"select id from scene, crew
where lower(scene.title)='psycho' and  scene.production_year= 1960 and scene.scene_no = 1
and scene.production_year= crew.production_year and scene.title=crew.title;",2018-08-31 13:38:39.10647+10,10,0,452,partially correct
10784,"ss;
",2018-08-31 13:38:41.851644+10,15,0,206,noninterpretable
10785,"SELECT * 
From person p
Where exists (select id 
			from
				(SELECT d.id , count(*) as num
				From director d, writer w
				Where d.id = w.id and d.title = w.title 
				GROUP by d.id)
			Where num >1);",2018-08-31 13:38:45.157482+10,4,0,457,partially correct
10786,"SELECT id, first_name, last_name
FROM person
WHERE year_born=MAX(year_born);",2018-08-31 13:39:17.106943+10,7,0,441,noninterpretable
10787,"select country
from restriction
where lower(title)='shakespeare in love'
and description='M';",2018-08-31 13:39:20.410169+10,6,1,386,correct
10788,"select id, first_name, last_name from person where person.id in
(select director.id from director natural join writer group by director.id having count(*) >1);",2018-08-31 13:39:25.197853+10,4,1,305,correct
10789,"WITH b AS (SELECT id, COUNT(*) AS a FROM role GROUP BY id)
SELECT first_name, last_name,title, production_year,description FROM person NATURAL JOIN role 
WHERE id=(SELECT c.id FROM b AS c WHERE c.a =(SELECT MAX(e.a) FROM b AS e));",2018-08-31 13:39:31.338636+10,15,1,210,correct
10790,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 13:39:33.781584+10,4,1,457,correct
10791,"select id, max(year_born)
from person
except
	select id, max(year_born)
	from person;",2018-08-31 13:39:34.677388+10,3,0,276,partially correct
10792,select country from restriction where title='Shakespeare in Love' and description='M';,2018-08-31 13:39:37.209656+10,6,1,255,correct
10793,"with sub as (
select p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) as num
from person p, role r
where p.id = r. id
group by p.id
)

select first_name, last_name, title, production_year, description
from sub 
where num = (select max(num) from sub);

",2018-08-31 13:39:39.495143+10,15,0,125,partially correct
10794,"SELECT *
FROM appearance;",2018-08-31 13:40:03.847124+10,10,0,450,partially correct
10795,;,2018-08-31 13:40:21.936406+10,14,0,313,noninterpretable
10796,"select ds.id, ds.writer_name, ds.last_name from (director natural join writer natural join movie) as ds group by ds.id, ds.writer_name,
ds.last_name having count(*) >= 2;
",2018-08-31 13:40:22.524264+10,4,0,213,noninterpretable
10797,"with sub as (
select p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) as num
from person p, role r
where p.id = r. id
group by r.id
)

select first_name, last_name, title, production_year, description
from sub 
where num = (select max(num) from sub);

",2018-08-31 13:40:23.917849+10,15,0,125,partially correct
10798,SELECT ID;,2018-08-31 13:40:30.169257+10,13,0,380,noninterpretable
10799, SELECT COUNT(*) FROM MOVIE m WHERE NOT EXISTS (SELECT * FROM MOVIE_AWARD ma WHERE ma.title = m.title);   ,2018-08-31 13:40:34.021618+10,11,0,404,partially correct
10800,"with a as
(select count(*) b,id from (select id,title,production_year from writer union select id,title,production_year from director) group by id)
select id from a where b=(select max(b) from a);
",2018-08-31 13:40:44.09339+10,14,1,190,correct
10801,"SELECT year_born, COUNT(person.id) AS writer
FROM writer, person
WHERE person.id = writer.id AND person.year_born = 1935
GROUP BY year_born;",2018-08-31 13:40:53.03496+10,1,0,251,partially correct
10802,"select x.id
from (scene natural join role natural join appearance)as x
where lower(x.title)='psycho'
and x.production_year=1960
group by x.id
having count(*)=1;",2018-08-31 13:40:59.53402+10,10,0,293,partially correct
10803,"SELECT title,production_year,first_name,last_name FROM movie_award NATURAL JOIN director NATURAL JOIN person
WHERE lower(category) = 'best film'
AND lower(result) = 'won'
AND lower(award_name) = 'bafta film award';",2018-08-31 13:41:09.745028+10,8,1,25,correct
10804,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:41:11.480748+10,10,1,452,correct
10805,;,2018-08-31 13:41:13.060081+10,14,0,206,noninterpretable
10806,"select ds.id, ds.first_name, ds.last_name from (director natural join writer natural join person) as ds group by ds.id, ds.first_name,
ds.last_name having count(*) >= 2;
",2018-08-31 13:41:18.486672+10,4,1,213,correct
10807,"select id,first_name,last_name from person order by year_born desc limit 1;",2018-08-31 13:41:19.517157+10,7,1,255,correct
10808,"SELECT year_born, COUNT(DISTINCT person.id) AS writer
FROM writer, person
WHERE person.id = writer.id AND person.year_born = 1935
GROUP BY year_born;",2018-08-31 13:41:21.709503+10,1,0,251,partially correct
10809,"SELECT p.id, p.first_name, p.last_name FROM PERSON p WHERE EXISTS 
(SELECT d.id FROM DIRECTOR d WHERE p.id = d.id  GROUP BY d.id HAVING SUM(d.id)>2);",2018-08-31 13:41:24.481123+10,4,0,161,partially correct
10810,"SELECT count(*)
FROM person LEFT JOIN director ON person.id = director.id;",2018-08-31 13:41:41.163114+10,12,0,420,partially correct
10811,"SELECT id, award_name, year_of_award_category
FROM director_award dw, director d, movie m, person p
WHERE
	lower(dw.result) = 'lose' > 1
	AND lower(dw.result) = 'won' = 0
	AND da.title = d.title
	AND da.production_year = d.production_year;",2018-08-31 13:41:44.815215+10,13,0,162,noninterpretable
10812,"select id
from person 
where year_born in(
select max(year_born)
from person 
where year_born not in (select max(year_born)
                        from person));",2018-08-31 13:41:58.166055+10,3,1,233,correct
10813,;,2018-08-31 13:42:07.541857+10,13,0,206,noninterpretable
10814,"select id, first_name, last_name
from person
order by year_born
limit 1;",2018-08-31 13:42:07.630037+10,7,0,386,partially correct
10815,"
SELECT p.id
FROM person p
WHERE p.year_born IN (SELECT MAX(year_born) FROM person
				WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-31 13:42:25.748426+10,3,1,120,correct
10816,"select p.id
from person p
where p.year_born = (select max(year_born)
		from person
		where year_born<(select max(year_born)
		from person));",2018-08-31 13:42:31.595097+10,3,1,276,correct
10817,"SELECT COUNT(DISTINCT person.id) AS WriterBornIn1935
FROM writer, person
WHERE person.id = writer.id AND person.year_born = 1935
GROUP BY year_born;",2018-08-31 13:42:47.81107+10,1,1,251,correct
10818,"select person.id,
person.first_name,
person.last_name
from (person natural join director natural join writer) as pd

group by pd.id
having count(*)>1;",2018-08-31 13:43:14.588611+10,4,1,377,correct
10819,"SELECT id, first_name, last_name
FROM person
WHERE year_born=(SELECT MAX(year_born) FROM person);",2018-08-31 13:43:16.590009+10,7,1,441,correct
10820,"SELECT COUNT(*) FROM MOVIE m WHERE NOT EXISTS (SELECT * FROM MOVIE_AWARD ma, MOVIE m WHERE ma.title = m.title AND ma.production_year = m.production_year);",2018-08-31 13:43:17.010552+10,11,0,404,partially correct
10821,select count(*) from movie where NOT EXISTS( select * from (movie_award ma NATURAL JOIN crew_award ca NATURAL JOIN director_award da NATURAL JOIN writer_award wa NATURAL JOIN actor_award aa) as a) ;,2018-08-31 13:43:19.96425+10,11,0,456,partially correct
10822,"SELECT COUNT(*)
FROM writer_award, person
WHERE writer_award.id=person.id
AND writer_award.year_of_award>1990
AND writer_award.year_of_award<1996
AND person.first_name='Woody'
AND person.last_name='Allen';",2018-08-31 13:43:24.506953+10,9,0,278,partially correct
10823,"select id, first_name, last_name
from person
order by year_born desc
limit 1;",2018-08-31 13:43:28.372399+10,7,1,386,correct
10824,"with sub as (
select p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) as num
from person p, role r
where p.id = r. id
group by r.id
)

select first_name, last_name, title, production_year, description
from sub 
where num = (select max(num) from sub);

",2018-08-31 13:43:38.360053+10,15,0,125,partially correct
10826,"SELECT COUNT(*) FROM writer_award NATURAL JOIN person
WHERE lower(first_name) = 'woody' AND lower(last_name) = 'allen'
AND year_of_award >=1991 AND year_of_award <= 1995
AND lower(result) = 'won';",2018-08-31 13:43:43.929535+10,9,1,25,correct
10827,"SELECT id, award_name, year_of_award, category
FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dd
WHERE 
	lower(dd.result) = ""nominated"" 
	AND 
	dd.id NOT IN (
		SELECT id
		FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dd
		WHERE lower(dd.result) = ""won"")
;",2018-08-31 13:43:57.076022+10,13,1,423,correct
10828,"select count(distinct p.id)
from person p, writer w
where p.id = w.id and p.year_born = 1935;",2018-08-31 13:43:57.937052+10,1,1,340,correct
10829,;,2018-08-31 13:44:00.584336+10,3,0,206,noninterpretable
10830,;,2018-08-31 13:44:17.291991+10,11,0,206,noninterpretable
10831,"select id from person 
where year_born = (
select max(year_born) from person where (year_born)<(
select max(year_born) from person )) ;",2018-08-31 13:44:23.468279+10,3,1,200,correct
10832,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 13:44:33.137081+10,9,1,278,correct
10833,"Select first_name,last_name,title,production_year,description from Person natural join


	(select id,title,production_year,description from ROLE where id in
		(SELECT id from (SELECT max(most),id from 
			(SELECT id,title,production_year,description,count(id) as most from Role group by id)
		) )
	 )
	as t1
;",2018-08-31 13:44:37.712317+10,15,1,16,correct
10834," SELECT 
     country
 FROM  
     Restriction 
 WHERE 
     lower(title)='Shakespeare in Love' 
	AND description= 'M';",2018-08-31 13:44:42.490002+10,6,0,246,partially correct
10835,"SELECT COUNT(*)
FROM (person NATURAL JOIN writer_award) AS wa
WHERE lower(wa.first_name) ='woody' AND lower(wa.last_name)='allen' AND lower(wa.result)='won' AND wa.year_of_award>1990
AND wa.year_of_award<1996;
",2018-08-31 13:45:01.509896+10,9,1,343,correct
10836,SELECT FROM person p;,2018-08-31 13:45:04.117507+10,12,0,115,noninterpretable
10837,"SELECT country
FROM restriction
WHERE description='M'
      AND lower(title)='Shakespeare in Love';",2018-08-31 13:45:08.728582+10,6,0,217,partially correct
10838,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 13:45:11.887254+10,4,1,161,correct
10839,SELECT FROM person p;,2018-08-31 13:45:19.128364+10,12,0,115,noninterpretable
10840,"select m.title, m.production_year, pd.first_name, pd.last_name from movie m, 
	(select p.first_name, p.last_name, d.title, d.production_year from person p, director d where p.id=d.id) as pd,
	movie_award ma
	where m.title = pd.title and m.production_year=pd.production_year and m.title = ma.title and m.production_year=ma.production_year
	and lower(ma.award_name)='bafta film award' and lower(ma.category) = 'best film';",2018-08-31 13:45:22.499987+10,8,0,430,partially correct
10841,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 13:45:22.950878+10,15,1,244,correct
10842,"SELECT d.id, da.award_name, da.year_of_award,da.category
FROM director_award da, director d
WHERE 
  	d.title = da.title AND
	lower(da.result)='nominated'
	AND d.id NOT IN(
	SELECT id
	FROM director_award da,
            director d
	WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );

",2018-08-31 13:45:30.04925+10,13,1,287,correct
10843,"select w.title, w.production_year from writer w, person p, movie m where w.title = m.title and w.production_year = m.production_year
and w.id = p.id group by w.title, w.production_year;",2018-08-31 13:45:45.856122+10,5,0,213,partially correct
10844,"select title,
production_year
from writer w, person p
where lower(p.first_name)='kevin' and
lower(p.last_name)='williamson' and
p.id=w.id;
",2018-08-31 13:45:47.540552+10,5,1,377,correct
10845,"select x.first_name,x.last_name, x.title, x.production_year,x.description
from (select p.first_name,p.last_name, r.title, r.production_year,r.description,rr.num 
	from role as r, person as p, (select id,count(*)as num from role group by id) as rr 
	where p.id =r.id and rr.id =p.id
) x
where x.num = (select max(rr.num)from (select id, count(*)as num from role group by id) as rr);",2018-08-31 13:45:52.335817+10,15,1,401,correct
10846,"select title,production_year from writer join person on writer.id = person.id where person.first_name = 'Kevin' and person.last_name = 'Williamson';

",2018-08-31 13:46:04.499673+10,5,1,305,correct
10847,"SELECT country
FROM restriction
WHERE description='M'
      AND lower(title)='shakespeare in love';",2018-08-31 13:46:04.775511+10,6,1,217,correct
10848,"SELECT mv.title, mv.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) as mv
Where mv.first_name = 'Kevin' and mv.last_name = 'Williamson';",2018-08-31 13:46:08.162199+10,5,1,457,correct
10849,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:46:56.411571+10,10,1,453,correct
10850,"select id, award_name, year_of_award,category
from director_award natural join director
where (select count(*)
	from director_award natural join director
	where lower(result)='won')=0;",2018-08-31 13:47:01.121942+10,13,0,432,partially correct
10851,"select country
from Restriction r
where r.title='Shakespeare in Love'
and r.description='M';",2018-08-31 13:47:01.39462+10,6,1,377,correct
10852,"select w.title, w.production_year from writer w, person p, movie m where w.title = m.title and w.production_year = m.production_year
and w.id = p.id and lower(p.first_name) = 'kevin' and lower(p.last_name) = 'williamson'group by w.title, w.production_year;",2018-08-31 13:47:06.486117+10,5,1,213,correct
10853,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:47:11.626577+10,10,1,446,correct
10854,;,2018-08-31 13:47:29.880001+10,1,0,206,noninterpretable
10855,;,2018-08-31 13:47:34.637554+10,2,0,206,noninterpretable
10856,"WITH scene_count AS (SELECT id,COUNT(id) FROM role NATURAL JOIN appearance
WHERE lower(title) = 'psycho'
AND production_year = 1960
GROUP BY id
HAVING COUNT(id) = 1)

SELECT id FROM scene_count;",2018-08-31 13:47:41.561946+10,10,1,25,correct
10857,;,2018-08-31 13:47:42.299936+10,12,0,206,noninterpretable
10858,;,2018-08-31 13:47:47.785434+10,4,0,206,noninterpretable
10859,SELECT FROM person p;,2018-08-31 13:47:52.546231+10,4,0,115,noninterpretable
10860,;,2018-08-31 13:47:53.592179+10,5,0,206,noninterpretable
10861,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 13:48:00.526278+10,13,1,162,correct
10862,SNEJJA JNCKJ V;,2018-08-31 13:48:06.488099+10,1,0,355,noninterpretable
10863,"with l as (select id, count(*) as num
from role
group by id)

select first_name, last_name, title, production_year, description
from role natural join person
where id in ( 
(select id 
from l
where l.num = (select max(num) 
from l
)));
",2018-08-31 13:48:11.925524+10,15,1,109,correct
10864,"SELECT count(*)
FROM ( SELECT Person.id FROM Person Natural join Writer WHERE year_born = 1935 GROUP BY Person.id );",2018-08-31 13:48:15.726575+10,1,1,220,correct
10865,"SELECT
COUNT(*)
FROM
MOVIE m;",2018-08-31 13:48:19.331565+10,11,0,50,partially correct
10866,"SELECT dw.id, dw.first_name,dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 13:48:46.000287+10,4,1,253,correct
10867,"select id from (
select id ,count(*) as c
from director
group by id 
order by c desc)
where c=3;",2018-08-31 13:48:47.576438+10,14,1,207,correct
10868,"SELECT count(*) 
FROM movie m 
WHERE not exists (
SELECT title, production_year 
FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:48:49.169448+10,11,1,456,correct
10869,"select country
from restriction
where lower(title)='shakespeare in love'
and description='M';",2018-08-31 13:48:49.929745+10,6,1,325,correct
10870,DSHJBJDAD;,2018-08-31 13:49:41.281756+10,2,0,355,noninterpretable
10871,"SELECT id
FROM ROLE
WHERE (COUNT(*) FROM ROLE WHERE title='Psycho'
AND production_year='1960) = 1;",2018-08-31 13:49:46.112117+10,10,0,278,noninterpretable
10872,"select id, award_name, year_of_award, category
from director_award dw, director d
where lower(dw.result) = 'nominated'
and dw.title = d.title
and dw.production_year = d.production_year;",2018-08-31 13:50:07.838766+10,13,1,276,correct
10873,"select d.titles, d.prodution_year from (movie natural join person natural join writer) as d
where d.first_name = 'Kevin' and d.last_name = 'Williamson';",2018-08-31 13:50:11.917634+10,5,0,438,noninterpretable
10874,"with m 
as (select p.id ,count(*) as t
from person p,role r
where p.id=r.id
group by p.id)

select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r
where p.id=r.id and p.id=
(select id from m where t= (select max(t) from m));


",2018-08-31 13:50:25.369369+10,15,1,391,correct
10875,"select id, first_name, last_name
from person
where year_born = (select max(year_born) from person);
",2018-08-31 13:50:27.885897+10,7,1,41,correct
10876,"SELECT production_year, COUNT(*) AS NumberOfMovie
FROM movie
WHERE production_year = 1991 OR production_year = 1992 OR production_year = 1993
GROUP BY production_year;",2018-08-31 13:51:09.563131+10,2,1,251,correct
10877,"SELECT a.id, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) as a
GROUP BY a.id
HAVING COUNT(*) > 1;",2018-08-31 13:51:10.585832+10,4,1,169,correct
10878,"Select country 
from restriction
Where description = ""M"" and title = ""Shakespeare in Love""
Group by country;",2018-08-31 13:51:12.201539+10,6,1,457,correct
10879,"SELECT count(*) FROM
(SELECT person.id AS ad, director.id AS bd
FROM person LEFT JOIN director ON person.id=director.id) AS A
WHERE bd IS NULL;",2018-08-31 13:51:25.090522+10,12,1,459,correct
10880,"SELECT MAX(dw.id)
FROM MOVIE m, (SELECT d.id, d.title, d.production_year FROM DIRECTOR d UNION SELECT w.id, w.title, w.production_year FROM WRITER w) AS dw
WHERE m.title = dw.title AND m.production_year = dw.production_year 
GROUP BY m.title;",2018-08-31 13:51:29.2823+10,14,0,242,partially correct
10881,"select count(w.id)
from writer w, person p
where w.id=p.id and p.year_born=1935;",2018-08-31 13:51:30.541319+10,1,0,359,partially correct
10882,JKBDKJN;,2018-08-31 13:51:38.113808+10,4,0,355,noninterpretable
10883,"SELECT production_year, COUNT() AS NumberOfMovie
FROM movie
WHERE production_year = 1991 OR production_year = 1992 OR production_year = 1993
GROUP BY production_year;",2018-08-31 13:51:40.58934+10,2,1,251,correct
10884,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 13:51:43.203678+10,10,1,278,correct
10885,"select count(*) from 
(select distinct id from  writer) as ww, person p
where ww.id=p.id
and p.year_born=1935;



",2018-08-31 13:51:43.708531+10,1,1,374,correct
10886,"select first_name, last_name, title, production_year, description from person, role where person.id = role.id and person.id in
(select id from role, (select t.id as max_id, max(t.c) as largest from (select id, count(*) as c from role group by id) as t) as t2 where role.id = t2.max_id);",2018-08-31 13:51:49.399348+10,15,1,70,correct
10887,select count(writer.id) from writer inner join person on writer.id = person.id where person.year_born = 1935;,2018-08-31 13:52:04.919924+10,1,0,318,partially correct
10888,"SELECT first_name, last_name, title, production_year, description
FROM person, role
WHERE person.id=role.id AND role.id=(

SELECT id
FROM(
SELECT
	id, COUNT(*) AS ct
FROM
	role
GROUP BY
	id) AS a
WHERE a.ct=(

SELECT MAX(ct)
FROM(
SELECT
	id, COUNT(*) AS ct
FROM
	role
GROUP BY
	id) AS b)
	);",2018-08-31 13:52:05.116318+10,15,1,322,correct
10889,"SELECT production_year, title FROM (MOVIE m NATURAL JOIN WRITER w NATURAL JOIN PERSON) e WHERE e.last_name='Williamson' AND e.first_name='Kevin';",2018-08-31 13:52:17.754665+10,5,1,161,correct
10890,"with sub as (
select *, count(*) as num
from person p, role r
where p.id = r. id
group by p.id
)

select first_name, last_name, title, production_year, description
from sub 
where num = (select max(num) from sub);

",2018-08-31 13:52:19.107149+10,15,0,125,partially correct
10891,"select id
from director,writer
where ;",2018-08-31 13:52:22.823168+10,14,0,432,noninterpretable
10892,"select h.title, h.production_year, first_name, last_name
from (select title, production_year
from movie_award
where lower(award_name) = 'bafta film award'
and lower(category) = 'best film'
and lower(result) = 'won') as h,
director d,
person p
where h.title = d.title
and h.production_year = d.production_year
and d.id = p.id;

",2018-08-31 13:52:45.894849+10,8,1,250,correct
10893,";
",2018-08-31 13:52:48.932016+10,2,0,220,noninterpretable
10894,"WITH not_winners AS (SELECT title,production_year FROM movie
WHERE (title,production_year) NOT IN
(

SELECT title,production_year FROM movie_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM crew_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM director_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM writer_award
WHERE lower(result) = 'won'

UNION

SELECT title,production_year FROM actor_award
WHERE lower(result) = 'won'))

SELECT COUNT(*) FROM not_winners;
",2018-08-31 13:52:51.157174+10,11,1,25,correct
10895,"SELECT title, production_year  FROM (MOVIE m NATURAL JOIN WRITER w NATURAL JOIN PERSON) e WHERE e.last_name='Williamson' AND e.first_name='Kevin';",2018-08-31 13:52:54.377622+10,5,1,161,correct
10896,"select ma.title, ma.production_year, p.last_name, p.last_name
from ( select title, production_year from movie_award where lower(award_name)= 'bafta film award' and lower(category)= 'best film' and lower(RESULT)= 'won' ) AS ma,director AS d,person AS p
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;
",2018-08-31 13:52:55.109947+10,8,0,225,partially correct
10925,"SELECT id, first_name, last_name
FROM person
Order By year_born desc
limit 1;",2018-08-31 13:56:24.411413+10,7,1,457,correct
11029,"select count(*)
from person
where id not in ( select id
                 from director);",2018-08-31 14:07:22.272784+10,12,1,359,correct
10897,"select d.id,da1.award_name,da1.year_of_award,da1.category
from DIRECTOR d,DIRECTOR_AWARD da1
where d.title=da1.title
and d.production_year=da1.production_year
and d.title not in(select title from DIRECTOR_AWARD da2
				where lower(result)=""won"")
group by d.id
having count(*)>=1;",2018-08-31 13:52:58.325049+10,13,1,302,correct
10898,"SELECT a.id
FROM (role NATURAL JOIN appearance) AS a
WHERE lower(a.title)='psycho' AND a.production_year = 1960
GROUP by a.id
HAVING COUNT(*)=1;",2018-08-31 13:53:00.222412+10,10,1,343,correct
10899,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year);",2018-08-31 13:53:24.121652+10,11,1,145,correct
10900,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where lower(da.result) = 'nominated'
and da.title = d.title
and da.production_year = d.production_year
and d.id not in(
		select d.id
		from director_award da, director d
		where da.title = d.title
		and da.production_year = d.production_year
		and lower(da.result) = 'won');",2018-08-31 13:53:25.973893+10,13,1,276,correct
10901,"select count(*)
from person p
where exists
	(select *
	from writer w
	where w.id = p.id
		and p.year_born = 1935);",2018-08-31 13:53:35.034955+10,1,1,340,correct
10902,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:53:50.073356+10,11,1,50,correct
10903,SELECT count(year_born) from person WHERE year_born=1935;,2018-08-31 13:53:50.371129+10,1,0,297,partially correct
10904,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 13:53:54.442914+10,5,1,438,correct
10905,"Select count(*)
From Writer_Award wa
Where 
    wa.first_name='Woody'
    AND wa.last_name='Allen'
    AND 1990<wa.year_of_award<1996
Group by wa.year_of_award;",2018-08-31 13:54:06.328313+10,9,0,246,noninterpretable
10906,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );
",2018-08-31 13:54:13.243546+10,15,1,235,correct
10907,"select id, first_name, last_name from person natural join writer natural join director  group by id, first_name, last_name having count(*)> 1;",2018-08-31 13:54:21.736203+10,4,1,399,correct
10908,"SELECT mw.title
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS mw
where mw.first_name='Kevin' and mw.last_name='Williamson';",2018-08-31 13:54:35.051109+10,5,0,253,partially correct
10909,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:54:38.023938+10,14,1,235,correct
10910,"SELECT count(distinct p.id)
FROM person p, writer w 
where p.id=w.id and p.year_born=1935;",2018-08-31 13:54:38.824064+10,1,1,359,correct
10911,SELECT ;,2018-08-31 13:55:09.681071+10,14,0,380,noninterpretable
10912,"select r.id
from role r,
appearance a,
scene s
where a.title=s.title 
and a.production_year=s.production_year
and a.title=r.title
and a.production_year=r.production_year
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 13:55:10.099814+10,10,0,293,partially correct
10913,"select p.id, p.first_name,p.last_name
from person p,director d, writer w
where d.id=p.id and w.title=d.title and p.id=w.id and w.id=d.id
group by p.id
having count(*)>1;",2018-08-31 13:55:32.685325+10,4,1,298,correct
10914,"select count(*) from 
movie_award as ma,
crew_award as ca,
director_award as da,
writer_award as wa,
actor_award as aa,
movie as m
where not exists (select * from 
movie_award as ma,
crew_award as ca,
director_award as da,
writer_award as wa,
actor_award as aa,
movie as m
where m.title= ma.title 
and m.title=ca.title
and m.title=da.title
and m.title=wa.title
and m.title=aa.title
and lower(ma.result)='won'
and lower(ca.result)='won'
and lower(da.result)='won'
and lower(wa.result)='won'
and lower(aa.result)='won');",2018-08-31 13:55:35.580094+10,11,0,452,partially correct
10915,select * from movie;,2018-08-31 13:55:35.930435+10,11,0,129,partially correct
10916,;,2018-08-31 13:55:37.36369+10,7,0,217,noninterpretable
10917,"SELECT mw.title,mw.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS mw
where mw.first_name='Kevin' and mw.last_name='Williamson';",2018-08-31 13:55:42.00155+10,5,1,253,correct
10918,"select year_of_award, award_name, category, id
from director_award da, director d
where lower(da.result)='nominated'
and da.title not in (select title
from director_award da2
where lower(da2.result)='won')
and d.title=da.title
and d.production_year=da.production_year
GROUP BY result
HAVING count(*)>=1;",2018-08-31 13:55:42.10589+10,13,1,233,correct
10919,"select id, award_name, year_of_award, category
from (director NATURAL JOIN director_award) as dda
where lower(dda.result) = 'nominated';",2018-08-31 13:55:47.964749+10,13,1,286,correct
10920,"select r.id
from role r,
appearance a,
scene s
where a.title=s.title 
and a.production_year=s.production_year
and s.title=r.title
and s.production_year=r.production_year
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 13:55:51.896771+10,10,0,293,partially correct
10921,"select first_name, last_name, title, production_year, description from person, role where person.id = role.id and person.id in
(select id from role, (select id as max_id from role group by id order by count(*) desc limit 1) as t where role.id = t.max_id);",2018-08-31 13:55:57.16522+10,15,1,70,correct
10922,select id from person p where year_born=(select max(year_born) from person where year_born NOT (select max(year_born) from person));,2018-08-31 13:56:17.237133+10,3,0,456,noninterpretable
10923,"select country from restriction
where description = 'M' and title = 'Shakespeare in Love';
",2018-08-31 13:56:19.66157+10,6,1,438,correct
10924,"select production_year, count(*)
from movie m
where m.production_year in (1991,1992,1993)
group by m.production_year;",2018-08-31 13:56:22.682211+10,2,1,340,correct
10927,"WITH without_youngest AS (SELECT year_born FROM person
WHERE year_born NOT IN (SELECT MAX(year_born) FROM person)),

second_youngest AS (SELECT MAX(year_born) FROM without_youngest)

SELECT id FROM person
WHERE year_born = (SELECT * FROM second_youngest);",2018-08-31 13:56:31.746941+10,3,1,25,correct
10928,"SELECT count(*)
FROM person 
WHERE NOT EXISTS (
SELECT *
FROM director
WHERE person.id = director.id
);",2018-08-31 13:56:32.196566+10,12,1,420,correct
10929,SELECT;,2018-08-31 13:56:41.501685+10,15,0,380,noninterpretable
10930,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 13:56:43.298514+10,14,1,432,correct
10931,"select year_of_award, award_name, category, id
from director_award da, director d
where lower(da.result)='nominated'
and da.title not in (select title
from director_award da2
where lower(da2.result)='won')
and d.title=da.title
and d.production_year=da.production_year
GROUP BY d.title
HAVING count(*)>=1;",2018-08-31 13:56:45.038458+10,13,1,233,correct
10932,"select id, first_name, last_name
from person
where person.year_born=(select MAX(year_born) from person);",2018-08-31 13:56:58.569226+10,7,1,325,correct
10933,select id from person p where year_born=(select max(year_born) from person where year_born < (select max(year_born) from person));,2018-08-31 13:57:01.836959+10,3,1,456,correct
10934,select country from restriction r where lower(a.title = 'shakesperare') and lower(a.description = 'm');,2018-08-31 13:57:07.104879+10,6,0,213,noninterpretable
10935,select country from restriction r where lower(r.title = 'shakesperare') and lower(r.description = 'm');,2018-08-31 13:57:32.808605+10,6,0,213,partially correct
10936,"select year_of_award, award_name, category, id
from director_award da, director d
where lower(da.result)='nominated'
and da.title not in (select title
from director_award da2
where lower(da2.result)='won')
and d.title=da.title
and d.production_year=da.production_year
GROUP BY d.id
HAVING count(*)>=1;",2018-08-31 13:57:34.801262+10,13,1,233,correct
10937,SELECT FROM person p;,2018-08-31 13:57:47.521703+10,5,0,115,noninterpretable
10938,SELECT country FROM RESTRICTION WHERE title='Shakespeare in Love' AND description='M';,2018-08-31 13:57:47.883947+10,6,1,161,correct
10939,"SELECT id,first_name,last_name
FROM person p
WHERE p.year_born=(SELECT MAX(year_born)
FROM person);",2018-08-31 13:57:49.947071+10,7,1,217,correct
10940,select country from restriction r where lower(r.title = 'shakespeare') and lower(r.description = 'm');,2018-08-31 13:57:50.172989+10,6,0,213,partially correct
10941,select country from restriction r where lower(r.title = 'shakespeare in love') and lower(r.description = 'm');,2018-08-31 13:58:30.733578+10,6,0,213,partially correct
10942,"SELECT r.id
FROM  role r, appearance a, scene s
WHERE r.title=a.title
AND r.production_year=a.production_year
AND r.description=a.description
AND a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND r.production_year=1960
AND lower(r.title)=psycho
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 13:58:32.781161+10,10,0,312,noninterpretable
10943,"SELECT count(*) 
FROM movie m
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 13:58:37.31743+10,11,1,452,correct
10944,"SELECT r.id
FROM scene s,
appearance a,
role r
WHERE a.title = s.title
AND a.production_year = s.production_year
AND a.scene_no = s.scene_no
AND s.title = r.title
AND s.production_year = r.production_year
AND a.description = r.description
AND lower(a.title) = 'psycho'
AND a.production_year = 1960
GROUP BY r.id
HAVING count(*) = 1;

",2018-08-31 13:58:49.982277+10,10,1,450,correct
10945,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person natural jon writer natural join director) as dw

 GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 13:59:01.277006+10,4,0,328,noninterpretable
10946,"WITH (SELECT id, COUNT(*) as counter FROM 
		SELECT id, title, production_year FROM director
		UNION
		SELECT id, title, production_year FROM writer
		GROUP BY id) AS counted
SELECT id FROM counted;",2018-08-31 13:59:02.973892+10,14,0,320,noninterpretable
10947,"select m.title, m.production_year from writer m where exists(select * from person p where p.first_name= 'kelvin' AND p.last_name='Williamson' AND p.id=m.id);",2018-08-31 13:59:13.603612+10,5,0,437,partially correct
10948,"select id,first_name, last_name from person
where year_born = (select max(year_born) from person);",2018-08-31 13:59:18.406616+10,7,1,438,correct
10949,"select count(*) from person
where person.id not in (  select d.id from director d   );",2018-08-31 13:59:23.020353+10,12,1,374,correct
10950,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person natural join writer natural join director) as dw

 GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 13:59:23.693994+10,4,1,328,correct
10951,"select r.id
from role r,
appearance a,
scene s
where 
a.title=s.title 
and a.production_year=s.production_year
and a.description=r.description
and s.scene_no=a.scene_no
and a.title=r.title
and a.production_year=r.production_year
and lower(a.title)='psycho'
and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 13:59:39.236022+10,10,1,293,correct
10952,"select count(*)
from person p
where p.id not in (select d.id
				from director d
				where d.id = p.id);",2018-08-31 13:59:52.594844+10,12,1,340,correct
10953,"select m.title,m.production_year,p.first_name,p.last_name from person p,director d,movie_award m where p.id=d.id and d.title=m.title
and m.award_name='BAFTA Film Award'and m.category='best film';",2018-08-31 13:59:53.415022+10,8,0,255,partially correct
10954,"SELECT COUNT(DISTINCT person.id) AS SumOfPersonWhoNeverDirected
FROM person, director
WHERE person.id != director.id;",2018-08-31 13:59:54.04969+10,12,0,251,partially correct
10955,;,2018-08-31 13:59:56.418873+10,8,0,217,noninterpretable
10956,"select * from role r inner join person p on r.id = p.id
group by r.id
having count(r.id) = max((select count(id) from role));",2018-08-31 14:00:02.68923+10,15,0,313,partially correct
10957,"select d.id,da.award_name,da.year_of_award,da.category
from director_award as da, director as d
where da.title = d.title and da.result='nominated';",2018-08-31 14:00:07.043965+10,13,1,200,correct
10958,select country from restriction r  where lower(r.title) = 'shakespeare in love' and lower(r.description) = 'm';,2018-08-31 14:00:08.394413+10,6,1,213,correct
10959,"select m.title, m.production_year from writer m where exists(select * from person p where p.first_name= 'kevin' AND p.last_name='Williamson' AND p.id=m.id);",2018-08-31 14:00:18.578645+10,5,0,437,partially correct
10960,"select id,award_name, year_of_award,category
from director_award da, director d
where lower(da.result)='nominated'
and da.title not in (select title
from director_award da2
where lower(da2.result)='won')
and d.title=da.title
and d.production_year=da.production_year
GROUP BY d.id
HAVING count(*)>=1;",2018-08-31 14:00:38.767882+10,13,1,233,correct
10961,"select count(*)
from person 
where exists ( select* from writer where writer.id=person.id and person.year_born=1935);
",2018-08-31 14:00:38.87402+10,1,1,158,correct
10962,"SELECT r.id
FROM role r NATURAL JOIN scene s NATURAL JOIN appearance a
WHERE  a.description=1 AND lower(r.title)='psycho' AND r.production_year=1960;",2018-08-31 14:00:49.482154+10,10,0,439,partially correct
10963,"SELECT MAX(year_born)
FROM person p
WHERE p.year_born != (SELECT MAX(year_born)
		  		FROM person p1
		  		);",2018-08-31 14:00:56.71746+10,3,0,145,partially correct
10964,"select id, award_name, year_of_award, category
from (director NATURAL JOIN director_award) as dda
where lower(dda.result) = 'nominated' and dda.id not in (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:00:59.643419+10,13,1,286,correct
10965,"select id, first_name, last_name from person where year_born = (select max(year_born) from person);",2018-08-31 14:01:20.431193+10,7,1,213,correct
10966,"SELECT count(*)

FROM person p
WHERE NOT EXISTS (
	SELECT * 
	FROM director d 
	WHERE d.id = p.id 
	);",2018-08-31 14:01:22.440409+10,12,1,417,correct
10967,"SELECT id,award_name,year_of_award,category FROM director_award NATURAL JOIN director NATURAL JOIN person
WHERE id NOT IN (SELECT ID FROM director_award NATURAL JOIN director
				WHERE lower(result) = 'won');",2018-08-31 14:01:31.743741+10,13,1,25,correct
10968,"SELECT COUNT(*)
FROM person p, writer w
WHERE 
	p.id=w.id
	AND p.year_born=1935
;",2018-08-31 14:01:33.859376+10,1,0,427,partially correct
10969,SELECT  count(*) from person p WHERE EXISTS(SELECT * FROm writer w WHERE w.id=p.id AND p.year_born=1935);,2018-08-31 14:01:43.487835+10,1,1,297,correct
10970,"SELECT count(*) FROM movie m

WHERE m.title<>(
					SELECT title FROM movie_award ma
					WHERE lower(ma.result)='won')
			OR (SELECT title FROM crew_award ca
					WHERE lower(ca.result)='won')
			OR (SELECT title FROM director_award da
					WHERE lower(da.result)='won')
			OR (SELECT title FROM writer_award wa
					WHERE lower(wa.result)='won')
			OR (SELECT title FROM actor_award aa
					WHERE lower(aa.result)='won');",2018-08-31 14:01:59.681975+10,11,0,453,partially correct
10971,"SELECT count(*)

FROM person p
WHERE EXISTS (
	SELECT * 
	FROM WRITER w 
	WHERE w.id = p.id and p.year_born = 1935
	);",2018-08-31 14:02:01.450671+10,1,1,417,correct
10972,"select count(*)
from movie m
where m.title ;",2018-08-31 14:02:05.063319+10,11,0,293,partially correct
10973,"select m.title, m.production_year from writer m, person p where p.first_name= 'kevin' AND p.last_name='Williamson' AND p.id=m.id;",2018-08-31 14:02:17.053571+10,5,0,437,partially correct
10974,"
SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id=p.id
AND
    lower(p.first_name)='kevin'
AND 
    lower(p.last_name)='williamson';
",2018-08-31 14:02:25.342912+10,5,1,328,correct
10975,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:02:26.63735+10,10,1,312,correct
10976,"select d.id,da.award_name,da.year_of_award,da.category
from director_award as da, director as d
where da.title = d.title and da.result='nominated' and d.title not in (select da.title from director_award as da where da.result = 'win');",2018-08-31 14:03:00.150313+10,13,1,200,correct
10977,"SELECT id 
FROM person;",2018-08-31 14:03:04.502463+10,3,0,278,partially correct
10978,SELECT FROM person p;,2018-08-31 14:03:04.850369+10,6,0,115,noninterpretable
10979,"select count(*)
from (person natural join writer natural join writer_award)as pa
where pa.first_name='Woody'
	and pa.last_name='Allen'
	and lower(pa.result)='won'
	and pa.year_of_award>=1991 and pa.year_of_award<=1995;",2018-08-31 14:03:05.26816+10,9,1,149,correct
10980,;,2018-08-31 14:03:12.29415+10,9,0,206,noninterpretable
10981,;,2018-08-31 14:03:25.101347+10,8,0,206,noninterpretable
10982,;,2018-08-31 14:03:28.809019+10,7,0,206,noninterpretable
10983,"select p.id,award_name,year_of_award,category from director_award da inner join director d inner join person p
where da.title=d.title and da.production_year=d.production_year and d.id=p.id and result='nominated'and p.id not in(
select p.id from director_award da inner join director d inner join person p 
where da.title=d.title and da.production_year=d.production_year and d.id=p.id and result='won');",2018-08-31 14:03:30.829734+10,13,1,101,correct
10984,;,2018-08-31 14:03:32.525572+10,6,0,206,noninterpretable
10985,select * from movie;,2018-08-31 14:03:37.940684+10,10,0,334,partially correct
10986,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:03:45.65095+10,14,1,242,correct
10987,"select production_year,count(*)
from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-31 14:03:48.578438+10,2,1,359,correct
10988,"SELECT id
FROM (SELECT id, MAX(year_born)
	FROM person p1
	WHERE p1.year_born != (SELECT MAX(year_born)
		  			FROM person p2
		  			))  ;
",2018-08-31 14:03:53.831435+10,3,1,145,correct
10989,"SELECT production_year, count(*)

FROM movie m
WHERE m.production_year < 1994 AND m.production_year > 1990
GROUP BY production_year;",2018-08-31 14:03:55.393157+10,2,1,417,correct
10990,"with dwm as (select d.id, count(*)
			from director d, writer w
			where d.id = w.id 
				and d.title = w.title 
				and d.production_year = w.production_year
				group by d.id
				having count(*)>1)
select p.id, p.first_name,p.last_name
from person p, dwm dw
where p.id = dw.id;",2018-08-31 14:03:58.974521+10,4,1,340,correct
10991,"SELECT id FROM person
WHERE year_born = (
SELECT MAX(year_born) FROM (
	SELECT year_born FROM person
	WHERE year_born != (SELECT max(year_born) FROM person)) AS second);
",2018-08-31 14:04:05.530438+10,3,1,320,correct
10992,"select m.title, m.production_year from writer m, person p where p.id=m.id AND p.first_name= 'kevin' AND p.last_name='Williamson';",2018-08-31 14:04:19.128079+10,5,0,437,partially correct
10993,"select p.first_name,p.last_name,r.title,r.prodution_year,r.description
from role r,
	person p
where not exists count(id)<(select count(*)
					from role, person
					where role.id=person.id
					group by id);",2018-08-31 14:04:19.291959+10,15,0,432,noninterpretable
10994,"SELECT COUNT(*)
FROM person p
WHERE 
	p.id IN (SELECT id FROM writer)
	AND p.year_born=1935
;",2018-08-31 14:04:21.348803+10,1,1,427,correct
10995,"select country
from restriction
where title='Shakespeare in Love' and description ='M';",2018-08-31 14:04:28.047027+10,6,1,253,correct
10996,"select  p.id,p.first_name,p.last_name

from person p natural join writer w natural join director d
group by p.id
having count(*)>1 ;",2018-08-31 14:04:34.777001+10,4,1,374,correct
10997,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 14:04:35.766713+10,3,1,278,correct
10998,"SELECT id FROM PERSON WHERE year_born = (
SELECT max(year_born) FROM PERSON WHERE year_born != (SELECT max(year_born) FROM PERSON));",2018-08-31 14:04:39.929308+10,3,1,50,correct
10999,"SELECT SUM(CASE WHEN production_year=1991 THEN 1 ELSE 0 END) AS ""1991"",SUM(CASE WHEN production_year=1992 THEN 1 ELSE 0 END) AS ""1992"",SUM(CASE WHEN production_year=1993 THEN 1 ELSE 0 END) AS ""1993"" FROM movie;",2018-08-31 14:04:41.782705+10,2,0,318,partially correct
11000,"select m.title,m.production_year
from movie NATURAL JOIN movie_award as m
where lower(award_name)='bafta film award';",2018-08-31 14:04:46.181657+10,8,0,325,partially correct
11001,"select m.title, m.production_year from writer m, person p where p.id=m.id AND p.first_name= 'Kevin' AND p.last_name='Williamson';",2018-08-31 14:04:51.690751+10,5,1,437,correct
11002,"select d.id,d.award_name,d.year_of_award,d.category from (person p NATURAL JOIN director_award da) as d where lower(d.result)<>'won' group by d.id having count(*)>0;",2018-08-31 14:04:56.934245+10,13,0,456,partially correct
11030,"SELECT production_year,count(production_year) FROM Movie WHERE production_year>1990 AND production_year<1994 GROUP BY production_year;",2018-08-31 14:07:30.296059+10,2,1,297,correct
11003,"SELECT
    r.id
FROM
    scene s ,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:05:00.618132+10,10,1,439,correct
11004,"select production_year,count(*)
from movie m
where m.production_year >1990 and m.production_year <1994
group by m.production_year;",2018-08-31 14:05:05.235776+10,2,1,401,correct
11005,"with specific_award AS 
(SELECT * FROM movie_award WHERE award_name='BAFTA Film Award'AND category='Best Film')
with 
SELECT a.title, a.production_year, p.first_name, p.last_name
FROM award a, person p
WHERE EXSITS (SELECT * FROM specific_award INNER JOIN director ON title;",2018-08-31 14:05:07.661621+10,8,0,441,noninterpretable
11006,"SELECT director.id, first_name, last_name, count(*)
FROM director, person, movie
WHERE director.id = person.id AND director.title = movie.title
GROUP BY director.id
HAVING count(*)>2;",2018-08-31 14:05:12.633451+10,4,0,420,partially correct
11007,"SELECT production_year,count(production_year) FROM Movie m WHERE EXISTS(SELECT production_year FROM Movie WHERE production_year=1993 
OR production_year=1992 OR production_year=1991 );",2018-08-31 14:05:18.432764+10,2,0,297,partially correct
11008,"SELECT w.title, w.production_year
FROM writer w
WHERE EXISTS (SELECT * FROM person p
WHERE p.id = w.id
AND lower(p.first_name) = 'kevin'
AND lower(p.last_name) = 'williamson');

",2018-08-31 14:05:23.270476+10,5,1,169,correct
11009,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:05:28.823891+10,10,1,334,correct
11010,"SELECT count(*)
FROM movie
WHERE NOT EXISTS (SELECT title FROM movie_award WHERE lower(result) = 'won'
UNION SELECT title FROM crew_award WHERE lower(result) = 'won'
UNION SELECT title FROM director_award WHERE lower(result) = 'won'
UNION SELECT title FROM writer_award WHERE lower(result) = 'won'
UNION SELECT title FROM actor_award WHERE lower(result) = 'won');",2018-08-31 14:05:30.402206+10,11,0,450,partially correct
11011,"SELECT md.title, md.production_year, md.first_name,md.last_name
from (movie  NATURAL JOIN director NATURAL JOIN person) as md
Where exists (Select * 
			From movie_award
			Where category = ""best film"" 
				and  award_name = ""BAFTA Film Award""
				and  result = ""won"");",2018-08-31 14:05:33.400113+10,8,0,457,partially correct
11012,select * from movie;,2018-08-31 14:05:53.886697+10,11,0,334,partially correct
11013,"with w_d AS (SELECT id,title,production_year FROM writer
UNION
SELECT id,title,production_year FROM writer),

id_count AS (SELECT id,COUNT(id) tot FROM w_d
GROUP BY id)

SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count);
",2018-08-31 14:06:05.163995+10,14,0,25,partially correct
11014,"select m.title, m.production_year, p.first_name, p.last_name from movie m, person p, movie_award ma, director d
where p.id = d.id and d.title = m.title and ma.title=m.title and ma.category = 'Best Film' and ma.award_name = 'BAFTA Film Award';",2018-08-31 14:06:21.755777+10,8,0,438,partially correct
11015,"select id from person p
where p.year_born= (select ;",2018-08-31 14:06:23.79511+10,3,0,452,noninterpretable
11016,"select count(*) from person p, writer_award w where p.first_name='Woody' and p.last_name='Allen' and p.id=w.id and w.result='won' and w.year_of_award in (1991,1992,1993,1994,1995) group by p.id;",2018-08-31 14:06:26.818891+10,9,1,255,correct
11017,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 14:06:29.267227+10,15,1,432,correct
11018,"select count(*)

FROM
    person p
WHERE in(select * from writer w where w.id = p.id and born_year = 1935);
   
",2018-08-31 14:06:33.978142+10,1,0,418,noninterpretable
11019,"select count(*)

FROM
    person p
WHERE exists(select * from writer w where w.id = p.id and born_year = 1935);
   
",2018-08-31 14:06:44.153196+10,1,0,418,noninterpretable
11020,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 14:06:46.325195+10,2,1,318,correct
11021,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:06:51.342114+10,11,1,334,correct
11022,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:06:55.603433+10,15,0,242,partially correct
11023,"SELECT count(production_year),production_year FROM Movie WHERE production_year>1990 AND production_year<1994 GROUP BY production_year;",2018-08-31 14:07:07.005342+10,2,1,297,correct
11024,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:07:09.032149+10,3,0,334,partially correct
11025,"select count(*)

FROM
    person p
WHERE exists(select * from writer w where w.id = p.id and uear_born = 1935);
   
",2018-08-31 14:07:10.390152+10,1,0,418,noninterpretable
11026,"select ma.title,
ma.production_year,
p.first_name,
p.last_name

from person p,
director d,
movie_award ma

where lower(ma.award_name)='bafta film award'
and lower(ma.category)='best film'
and lower(ma.result)='won'
and p.id=d.id
and d.title=ma.title
and d.production_year=ma.production_year;",2018-08-31 14:07:10.953169+10,8,1,377,correct
11027,"select count(*)
from person p
where not exists (select * from director d where d.id = p.id);",2018-08-31 14:07:13.781654+10,12,1,401,correct
11031,"select count(*)

FROM
    person p
WHERE in(select * from writer w where w.id = p.id and year_born = 1935);
   
",2018-08-31 14:07:32.061799+10,1,0,418,noninterpretable
11032,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 14:07:40.160274+10,3,1,334,correct
11033,SELECT FROM person p;,2018-08-31 14:07:43.976982+10,7,0,115,noninterpretable
11034,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:07:44.87336+10,14,1,384,correct
11035,"select t.id from 
(select d.id, title, production_year from director d UNION select w.id, title, production_year from writer w) t group by t.id order by count(*) desc limit 1;",2018-08-31 14:07:50.190331+10,14,0,70,partially correct
11036,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 14:07:55.48705+10,14,0,334,partially correct
11037,"select count(*) as number_of_award
from (select * from writer_award
where year_of_award >=1991
and year_of_award <=1995
group by id) as h natural join person p
where lower(first_name) = 'woody'
and lower(last_name) = 'allen';",2018-08-31 14:08:08.993104+10,9,1,250,correct
11038,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:08:26.761804+10,14,1,334,correct
11039,"select count(*)
from writer_award wa, writer w, person p
where wa.title = w.title
      and wa.production_year = w.production_year
	 and wa.id = w.id
	 and lower(result) = 'won'
	 and lower(first_name) = 'woody'
	 and lower(last_name) = 'allen'
	 and year_of_award in (1991,1992,1993,1994,1995);",2018-08-31 14:08:28.089742+10,9,0,225,partially correct
11040,;,2018-08-31 14:08:31.388203+10,10,0,264,noninterpretable
11041,"select rp.id
from (role natural join appearance)as rp
where lower(rp.title)='psycho'
	and rp.production_year=1960
group by rp.id
having count(rp.id)=1;
",2018-08-31 14:08:43.469674+10,10,1,149,correct
11042,"SELECT distinct id, first_name, last_name
FROM person
WHERE id in
 (SELECT id 
FROM movie m, writer w
WHERE m.title = w.title and id in (SELECT id FROM director));",2018-08-31 14:08:58.883162+10,4,0,459,partially correct
11043,"select m.title, m.production_year
from movie m, writer w, person p
where m.title = w.title 
	and m.production_year = w.production_year
	and w.id = p.id
	and lower(p.first_name) = 'kevin'
	and lower(p.last_name) = 'williamson';",2018-08-31 14:09:09.674054+10,5,1,340,correct
11044,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:09:11.075619+10,13,1,334,correct
11045,"WITH specific_award AS 
(SELECT * FROM movie_award WHERE award_name='BAFTA Film Award'AND category='Best Film')
WITH specific_award_director AS
(SELECT * FROM specific_award INNER JOIN director ON title)
SELECT a.title, a.production_year, p.first_name, p.last_name
FROM award a, person p
WHERE EXSITS (SELECT * FROM specific_award_director INNER JOIN p ON id;",2018-08-31 14:09:16.68102+10,8,0,441,noninterpretable
11046,"SELECT id, first_name, last_name FROM (SELECT id, first_name, last_name, max(year_born) FROM PERSON);",2018-08-31 14:09:22.630993+10,7,1,161,correct
11047,"SELECT count(*)
FROM writer,person
where writer.id=person.id and person.year_born=1935;",2018-08-31 14:09:24.622728+10,1,0,432,partially correct
11048,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:09:26.700128+10,15,0,334,partially correct
11049,"with sub as (
select r.id, p.first_name, p.last_name, r.title, r.production_year, r.description, count(*) as num
from person p, role r
where p.id = r. id
group by r.id
)

select first_name, last_name, title, production_year, description
from sub 
where num = (select max(num) from sub);

",2018-08-31 14:09:41.304099+10,15,0,125,partially correct
11050,"with w_d AS (SELECT id,title,production_year FROM writer 
UNION
SELECT id,title,production_year FROM director),

id_count AS (SELECT id,COUNT(id) tot FROM w_d
GROUP BY id)

SELECT id FROM id_count
WHERE tot = (SELECT MAX(tot) FROM id_count);
",2018-08-31 14:09:50.8896+10,14,1,25,correct
11051,"select m.title, m.production_year
from writer w, person p
where w.id = p.id
	and lower(p.first_name) = 'kevin'
	and lower(p.last_name) = 'williamson';",2018-08-31 14:09:51.365604+10,5,0,340,noninterpretable
11052,"SELECT id
FROM (DIRECTOR NATURAL JOIN WRITER) as info
GROUP BY id
HAVING COUNT(id) = (
	SELECT MAX(Num)
	FROM (
	  SELECT id, COUNT(*) as Num
	  FROM (DIRECTOR NATURAL JOIN WRITER) as info
	  GROUP BY id
	)
)
;",2018-08-31 14:09:54.673874+10,14,0,423,partially correct
11053,"Select e.year_born,
FROM PERSON,
COUNT (Writer),
Where e.year_born = 1935;
",2018-08-31 14:10:07.405636+10,1,0,460,noninterpretable
11054,"select w.title, w.production_year
from writer w, person p
where w.id = p.id
	and lower(p.first_name) = 'kevin'
	and lower(p.last_name) = 'williamson';",2018-08-31 14:10:11.713534+10,5,1,340,correct
11055,"select m.title, m.production_year, p.first_name, p.last_name from movie m, person p, movie_award ma, director d
where p.id = d.id and d.title = m.title and ma.title=m.title and lower(ma.category) = 'best film' and lower(ma.award_name) = 'bafta film award' and lower(ma.result) = 'won';",2018-08-31 14:10:24.076762+10,8,1,438,correct
11056,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 14:10:28.916581+10,15,1,334,correct
11057,"select p.id,p.first_name,p.last_name
from person p, director d, writer w
where p.id =d.id and w.id=p.id and
	d.title=w.title
group by p.id
having count(*)>1;",2018-08-31 14:10:31.876302+10,4,1,401,correct
11058,"select count(*) as number_of_award
from writer_award wa, writer w, person p
where wa.title = w.title
      and wa.production_year = w.production_year
	 and wa.id = w.id and w.id = p.id
	 and lower(result) = 'won'
	 and lower(first_name) = 'woody'
	 and lower(last_name) = 'allen'
	 and year_of_award >= 1991 and  year_of_award <= 1995;",2018-08-31 14:10:36.913201+10,9,1,225,correct
11059,"select title ,production_year from 
writer w left join person p on w.id=p.id
where lower(p.first_name) = kevin
and lower (p.last_name)=williamson;
",2018-08-31 14:10:37.161227+10,5,0,374,noninterpretable
11060,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 14:10:48.393053+10,2,1,334,correct
11061,"SELECT id, award_name, year_of_award, category
FROM director, director_award
WHERE director.title=director_award.title
AND director_award.result='no';",2018-08-31 14:10:49.576132+10,13,0,278,partially correct
11062,"select title ,production_year from 
writer w left join person p on w.id=p.id
where lower(p.first_name) = kevin
and lower (p.last_name)=williamson;
",2018-08-31 14:10:50.101233+10,5,0,374,noninterpretable
11063,"SELECT count(*) 
FROM person p,writer w
WHERE w.id = p.id AND p.year_born = 1935;",2018-08-31 14:11:08.077336+10,1,0,370,partially correct
11064,"select title ,production_year from 
writer w left join person p on w.id=p.id
where lower(p.first_name) = 'kevin'
and lower (p.last_name)='williamson';
",2018-08-31 14:11:25.031563+10,5,1,374,correct
11065,"SELECT COUNT(*)
FROM (SELECT title,production_year
FROM movie
WHERE NOT EXISTS (SELECT title, production_year FROM movie_award ma WHERE lower(ma.result)='won'
UNION
SELECT title, production_year FROM crew_award ca WHERE lower(ca.result)='won'
UNION
SELECT title, production_year FROM director_award da WHERE lower(da.result)='won'
UNION
SELECT title, production_year FROM writer_award wa WHERE lower(wa.result)='won'
UNION
SELECT title, production_year FROM actor_award aa WHERE lower(aa.result)='won'));",2018-08-31 14:11:35.619176+10,11,0,439,partially correct
11066,"SELECT ma.title, ma.production_year,p.first_name,p.last_name
FROM(SELECT title, production_year
            FROM movie_award
                 WHERE lower(award_name)='bafta film award'
			AND lower(category)='best film'
			AND lower(result)='won')AS ma,
	person AS p,
	director AS d
	WHERE ma.title=d.title
	AND ma.production_year=d.production_year
	AND d.id=p.id;",2018-08-31 14:11:36.528133+10,8,1,217,correct
11067,select country from Restriction where lower(title) = 'shakespeare in love' and description = 'M';,2018-08-31 14:11:40.323788+10,6,1,437,correct
11068,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:11:47.084768+10,13,1,456,correct
11069,"select count(*)
from person p
where exists (select *
from writer w
where  w.id=p.id)
and p.year_born=1935;",2018-08-31 14:12:08.867713+10,1,1,391,correct
11070,"SELECT count(distinct(p.id)) 
FROM person p,writer w
WHERE w.id = p.id AND p.year_born = 1935;",2018-08-31 14:12:09.438479+10,1,1,370,correct
11071,"select dw.id, dw.first_name, dw.last_name
from (person p natural join director natural join writer) as dw
group by dw.id
having count(*) > 1;",2018-08-31 14:12:13.507122+10,4,1,417,correct
11072,"SELECT id, award_name, year_of_award, category
FROM DIRECTOR NATURAL JOIN DIRECTOR_AWARD
WHERE result = 'nominated';",2018-08-31 14:12:17.677471+10,13,1,50,correct
11073,"SELECT count(distinct w.id)
FROM person p
INNER JOIN writer w ON p.id = w.id
WHERE year_born = 1935;",2018-08-31 14:12:22.080325+10,1,1,144,correct
11074,"select rs.country
from restriction rs
where lower(rs.title) = 'shakespeare in love'
	and rs.description = 'M';",2018-08-31 14:12:24.262191+10,6,1,340,correct
11075,"select * from (select id, count(*) as aa from 
(select id,title,production_year from director union select id,title,production_year from writer) 
group by id
order by aa desc);
",2018-08-31 14:12:40.378038+10,14,0,126,partially correct
11076,"select count(*)

FROM
    person p
WHERE in(select * from writer w where w.id = p.id and year_born = 1935);
   
",2018-08-31 14:12:40.968053+10,1,0,418,noninterpretable
11077,;,2018-08-31 14:12:47.299884+10,9,0,217,noninterpretable
11078,"select count(*)

FROM
    person p
WHERE exists(select * from writer w where w.id = p.id and year_born = 1935);
   
",2018-08-31 14:13:00.042015+10,1,1,418,correct
11079,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:13:09.529691+10,13,1,278,correct
11080,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 14:13:13.069005+10,3,1,452,correct
11081,SELECt count((SELECT count(*) FROM Person)-(SELECT count(*) FROM Director));,2018-08-31 14:13:16.10163+10,12,0,297,partially correct
11082,;,2018-08-31 14:13:17.523355+10,15,0,370,noninterpretable
11083,SELECT FROM person p;,2018-08-31 14:13:17.652778+10,8,0,115,noninterpretable
11084,"SELECT r.id
FROM (role r NATURAL JOIN appearance a) AS ra
WHERE title = 'Psycho' AND production_year = '1960'
GROUP BY id
HAVING COUNT(*) = 1;",2018-08-31 14:13:20.239675+10,10,1,454,correct
11085,"SELECT count(*)
FROM movie_award;",2018-08-31 14:13:35.509835+10,11,0,446,partially correct
11086,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT *
			 FROM director d
			 WHERE p.id = d.id);",2018-08-31 14:13:35.545793+10,12,1,144,correct
11087,"SELECT md.title, md.production_year, md.first_name,md.last_name
from (movie  NATURAL JOIN director NATURAL JOIN person) as md,
(SELECT     title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won') as ma
Where  ma.title = md. title 
	and ma.production_year = md.production_year;",2018-08-31 14:13:45.019252+10,8,1,457,correct
11088,select r.id from role r natural join scene s where s.scene_no=1;,2018-08-31 14:13:45.354574+10,10,0,255,partially correct
11089,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 14:13:46.862199+10,4,1,459,correct
11090,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (SELECT title, production_year FROM movie_award ma WHERE lower(ma.result)='won'AND ma.title=m.title AND ma.production_year=m.production_year
UNION
SELECT title, production_year FROM crew_award ca WHERE lower(ca.result)='won'AND ca.title=m.title AND ca.production_year=m.production_year
UNION
SELECT title, production_year FROM director_award da WHERE lower(da.result)='won'AND da.title=m.title AND da.production_year=m.production_year
UNION
SELECT title, production_year FROM writer_award wa WHERE lower(wa.result)='won'AND wa.title=m.title AND wa.production_year=m.production_year
UNION
SELECT title, production_year FROM actor_award aa WHERE lower(aa.result)='won' AND aa.title=m.title AND aa.production_year=m.production_year);",2018-08-31 14:13:50.239971+10,11,1,439,correct
11091,"select m.title,m.production_year
from movie m,writer w,person p
where w.title =m.title and
	w.id = p.id and
	lower(p.first_name) = 'kevin'and lower(p.last_name) = 'williamson';",2018-08-31 14:14:00.441611+10,5,1,401,correct
11092,"Select e.year_born,Select e.year_born;



",2018-08-31 14:14:07.400259+10,2,0,460,noninterpretable
11147,"with newtable as(
select title,production_year, first_name, last_name
from person p natural join  director d
where p.id = d.id 
)
select title, production_year, first_name, last_name
from newtable natural join movie_award ma
where  newtable.title = ma.title and newtable.production_year = ma.production_year and  
ma.result = 'won' and Lower(award_name)= 'bafta film award' and lower(category)  = 'best film';",2018-08-31 14:21:18.449661+10,8,1,125,correct
11151,"SELECT distinct id
FROM (SELECT MAX(id) FROM writer OUTTER JOIN director ON writer.id=director.id
      GROUP BY id);
",2018-08-31 14:21:49.566154+10,14,0,278,noninterpretable
11154,"SELECT count(*)
FROM (writer_award NATURAL JOIN writer NATURAL JOIN person) as ap
WHERE ap.first_name = ""Woody"" and ap.last_name = ""Allen"" and lower(RESULT) = ""won""
	and ap.year_of_award >1990 and ap.year_of_award<1996;",2018-08-31 14:22:08.221645+10,9,1,457,correct
11093,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);
",2018-08-31 14:14:15.463843+10,11,1,450,correct
11094,"Select e.year_born,Select e.year_born;



",2018-08-31 14:14:19.649631+10,2,0,460,noninterpretable
11095,"select count(*)
from movie m
where not exists  
	(select title, production_year FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:14:22.010242+10,11,1,293,correct
11096,"SELECT
    COUNT(*) 
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 14:14:37.940591+10,9,1,217,correct
11097,"select id from (select id, count(*) as aa from 
(select id,title,production_year from director union select id,title,production_year from writer) 
group by id
order by aa desc)
where aa=(select count(*) as aa from 
(select id,title,production_year from director union select id,title,production_year from writer) 
group by id
order by aa desc limit 1);
",2018-08-31 14:14:39.614563+10,14,1,126,correct
11098,"select title, production_year from person natural join writer where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-31 14:14:56.006274+10,5,1,399,correct
11099,SELECT count(*) FROM person p WHERE NOT EXISTS(SELECT * FROM director d WHERE p.id=d.id);,2018-08-31 14:15:00.977254+10,12,1,297,correct
11100,"select count(*) from writer_award w
where exists(select id from person p where w.id = p.id and lower(p.first_name) = 'woody' and lower(p.last_name)='allen' and w.year_of_award>=1991 and w.year_of_award<=1995);",2018-08-31 14:15:03.586759+10,9,0,438,partially correct
11101,"WITH role_count AS (SELECT id,COUNT(description) tot FROM role NATURAL JOIN person
GROUP BY id)

SELECT first_name,last_name,title,production_year,description FROM role NATURAL JOIN person
WHERE id IN (SELECT id FROM role_count
			WHERE tot = (SELECT MAX(tot) FROM role_count));",2018-08-31 14:15:06.972269+10,15,1,25,correct
11102,"SELECT x.title, x.production_year, x.first_name, x.last_name FROM 
(MOVIE NATURAL JOIN DIRECTOR NATURAL JOIN PERSON NATURAL JOIN MOVIE_AWARD) x  
WHERE x.category = 'Best Film' AND x.award_name = 'BAFTA Film Award';",2018-08-31 14:15:19.255174+10,8,0,161,partially correct
11103,"select p.id,p.first_name,p.last_name
from person p natural join writer w natural join director d
group by p.id
having count(*)>1;",2018-08-31 14:15:33.323404+10,4,1,359,correct
11104,"select p.id
from person;",2018-08-31 14:16:00.046124+10,3,0,293,noninterpretable
11105,;,2018-08-31 14:16:05.400235+10,11,0,264,noninterpretable
11106,"select count(*)

from writer_award wa,
writer w,
person p

where lower(wa.result)='won'
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and wa.year_of_award>=1991
and wa.year_of_award<=1995
and p.id=w.id
and w.id=wa.id
and w.title=wa.title
and w.production_year=wa.production_year;",2018-08-31 14:16:27.497521+10,9,1,377,correct
11107,"SELECT p1.id
FROM person p1
WHERE year_born=(SELECT MAX(p2.year_born)
FROM person p2
WHERE p2.year_born<(SELECT MAX(p3.year_born)
FROM person p3));",2018-08-31 14:16:32.637053+10,3,1,439,correct
11108,"select mpd.title, mpd.production_year, mpd.first_name, mpd.last_name
from (movie natural join person natural join director) as mpd;",2018-08-31 14:16:43.289328+10,8,0,41,partially correct
11109,"SELECT d.id, d.year_of_award, d.category
FROM  (director_award da NATURAL JOIN director) d
WHERE NOT EXISTS(SELECT d1.title, d1.production_year
			FROM (director_award da NATURAL JOIN director) d1
			WHERE lower(d1.result) = 'won');",2018-08-31 14:16:51.95362+10,13,0,145,partially correct
11110,"select p.id, p.first_name, p.last_name from person p where p.year_born=(select max(year_born)from person);",2018-08-31 14:17:04.921563+10,7,1,437,correct
11111,"Select movie.title, movie.production_year 
FROM Movie Natural Join Writer Natural Join Person
WHERE Person.first_name = 'Kevin' 
and Person.Last_name = 'Williamson';

",2018-08-31 14:17:16.574801+10,5,1,77,correct
11112,"SELECT id,first_name,last_name,year_born
FROM   person
WHERE year_born=(SELECT MAX(year_born)
                 From person);",2018-08-31 14:17:27.795846+10,7,0,253,partially correct
11113,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    (director NATURAL JOIN person) AS p
WHERE
    ma.title = p.title
    AND ma.production_year = p.production_year;",2018-08-31 14:17:36.910438+10,8,1,325,correct
11114,"select id
from (select id,count(title) c from(select id,title from director
union
select id,title from writer) as a
group by id ) as b
where b.c= (select max(c) from (select id,count(title) c from(select id,title from director
union
select id,title from writer) as a
group by id ) as b);",2018-08-31 14:17:50.642818+10,14,1,216,correct
11115,"select r.country from restriction r
where lower(r.title)='shakespeara in love' and r.description ='M'; ",2018-08-31 14:18:04.161327+10,6,0,401,partially correct
11116,"SELECT foo.id,p.first_name,p.last_name FROM Person p INNER JOIN (
SELECT d.id FROM Director d INNER JOIN Writer w ON d.id=w.id
)as foo ON p.id=foo.id;",2018-08-31 14:18:06.545592+10,4,0,297,partially correct
11117,"SELECT id,first_name,last_name
FROM   person
WHERE year_born=(SELECT MAX(year_born)
                 From person);",2018-08-31 14:18:09.248716+10,7,1,253,correct
11118,"select p.id,p.first_name,p.last_name  from

(select * from person pp
order by year_born desc) as p
limit 1;
",2018-08-31 14:18:24.806625+10,7,1,374,correct
11119,"select id
from movie m, director d
where m.title = d.title
and m.production_year = d.production_year
union 
select id
from movie m, writer w
where m.title = w.title
and m.production_year = w.production_year;",2018-08-31 14:18:34.997784+10,14,0,276,partially correct
11150,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select max(year_born)from person);",2018-08-31 14:21:39.851434+10,7,1,401,correct
11152,"with a as(
select id,count(id) c from role
group by id
)
select p.first_name,p.last_name,r.title,r.production_year,r.description from 
person p,role r
where p.id=(select id from a
where a.c=(select max(c) from a)) and
p.id = r.id;",2018-08-31 14:22:00.337776+10,15,1,323,correct
11153,"SELECT count(*)
FROM writer_award AS wa,
	person AS p,
	writer AS w
WHERE wa.id=w.id
AND wa.title=w.title
AND wa.production_year=w.production_year
AND w.id=p.id
AND lower(result)='won'
AND lower(first_name)='woody'
AND lower(last_name)='allen'
AND year_of_award>1990
AND year_of_award<1996;",2018-08-31 14:22:04.708214+10,9,1,217,correct
11120,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:18:35.840008+10,11,1,446,correct
11121,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-31 14:18:36.406377+10,4,1,420,correct
11122,"select count(*)
from movie as m
where not exists(select title,production_year,result
			from movie_award as ma
			where m.title=ma.title
				and m.production_year=ma.production_year
				and lower(ma.result)='won'
			union 
			(select title,production_year,result
			from crew_award as ca
			where m.title=ca.title
				and m.production_year=ca.production_year
				and lower(ca.result)='won')as x2
			union
			(select title,production_year,result
			from director_award as ma
			where m.title=da.title
				and m.production_year=da.production_year
				and lower(da.result)='won')as x3
			union
			(select title,production_year,result
			from writer_award as wa
			where m.title=wa.title
				and m.production_year=wa.production_year
				and lower(wa.result)='won')as x4
			union
			(select title,production_year,result
			from actor_award as aa
			where m.title=aa.title
				and m.production_year=aa.production_year
				and lower(aa.result)='won')as x5
			)as x;
",2018-08-31 14:18:37.418+10,11,0,149,noninterpretable
11123,"SELECT foo.id,p.first_name,p.last_name FROM Person p INNER JOIN (
SELECT DISTINCT d.id FROM Director d INNER JOIN Writer w ON d.id=w.id
)as foo ON p.id=foo.id;",2018-08-31 14:18:42.859601+10,4,0,297,partially correct
11124,"select count(*) as number_of_cost from writer_award w
where exists(select id from person p where w.id = p.id and lower(p.first_name) = 'woody' and lower(p.last_name)='allen' and w.year_of_award>=1991 and w.year_of_award<=1995 and lower(w.result) = 'won');",2018-08-31 14:18:48.361837+10,9,1,438,correct
11125,"Select e.year_born,

Select e.year_born,

;",2018-08-31 14:18:55.305441+10,12,0,460,noninterpretable
11126,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:19:02.661591+10,11,1,129,correct
11127,;,2018-08-31 14:19:10.229589+10,12,0,318,noninterpretable
11128,"SELECT mwp.title, mwp.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS mwp
WHERE mwp.first_name = 'Kevin' and mwp.last_name = 'Williamson';",2018-08-31 14:19:10.290671+10,5,1,459,correct
11129,"SELECT COUNT() AS SumOfPersonWhoNeverDirected
FROM person
WHERE NOT EXISTS (select *
FROM director
WHERE person.id = director.id);",2018-08-31 14:19:16.56358+10,12,1,251,correct
11130,"select r.country from restriction r
where lower(r.title)='shakespeare in love' and lower(r.description) ='m'; ",2018-08-31 14:19:28.93802+10,6,1,401,correct
11131,select * from writer;,2018-08-31 14:19:34.305279+10,6,0,196,partially correct
11132,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' 
AND description = 'M';
",2018-08-31 14:19:34.521538+10,6,1,169,correct
11133,"SELECT first_name, last_name, r.title, r.production_year,r.description
FROM role r, person p, (SELECT id, count(*) AS NOOFROLE FROM role GROUP BY id) x
WHERE r.id=p.id AND x.id=r.id AND x.NOOFROLE IN (SELECT MAX(x2.NOOFROLE) FROM (SELECT id, count(*) AS NOOFROLE FROM role GROUP BY id) x2);",2018-08-31 14:19:45.384682+10,15,1,195,correct
11134,select country from restriction where lower(title) = 'shakespeare in love' and lower(description) = 'm';,2018-08-31 14:19:46.646913+10,6,1,399,correct
11135,selvet;,2018-08-31 14:19:50.885026+10,14,0,233,noninterpretable
11136,"select production_year,count(*)
from movie
where production_year>1990 and production_year<1994;",2018-08-31 14:19:55.03718+10,2,0,432,partially correct
11137,"select p.id
from person p
where p.year_born=(select max(year_born)from person where year_born<(select max(year_born)from person));",2018-08-31 14:20:01.668536+10,3,1,293,correct
11138,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 14:20:10.05624+10,12,1,318,correct
11139,"SELECT count(*)
FROM writer_award as wa
WHERE wa.id=(SELECT id
             FROM person p
			 WHERE lower(p.first_name)='woody'
			 AND lower(last_name)='allen')
AND year_of_award>1990
AND year_of_award<1996;",2018-08-31 14:20:10.575545+10,9,0,328,partially correct
11140,"select mp.title,mp.production_year
from movie_award natural join person as mp
where award_name = BAFTA Film Award;",2018-08-31 14:20:13.953931+10,8,0,418,noninterpretable
11141,"select distinct w.title, w.production_year
from writer w, person p
where p.id=w.id and lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-31 14:20:24.957789+10,5,1,359,correct
11142,"select production_year,count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-31 14:20:31.51218+10,2,1,432,correct
11143,"select count(*)
from movie as m
where not exists(select title,production_year,result
			from movie_award as ma
			where m.title=ma.title
				and m.production_year=ma.production_year
				and lower(ma.result)='won'
			union 
			select title,production_year,result
			from crew_award as ca
			where m.title=ca.title
				and m.production_year=ca.production_year
				and lower(ca.result)='won'
			union
			select title,production_year,result
			from director_award as da
			where m.title=da.title
				and m.production_year=da.production_year
				and lower(da.result)='won'
			union
			select title,production_year,result
			from writer_award as wa
			where m.title=wa.title
				and m.production_year=wa.production_year
				and lower(wa.result)='won'
			union
			select title,production_year,result
			from actor_award as aa
			where m.title=aa.title
				and m.production_year=aa.production_year
				and lower(aa.result)='won'
			);
",2018-08-31 14:20:51.946417+10,11,1,149,correct
11144,"SELECT COUNT(*)
FROM person p
WHERE EXISTS(SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 14:20:59.341572+10,1,1,23,correct
11145,"SELECT count(*)
FROM (writer_award NATURAL JOIN writer NATURAL JOIN person) as ap
WHERE ap.first_name = ""Woody"" and ap.last_name = ""Allen""
	and ap.year_of_award >1990 and ap.year_of_award<1996;",2018-08-31 14:21:07.534035+10,9,0,457,partially correct
11146,"SELECT count(*)
FROM writer_award as wa
WHERE wa.id=(SELECT id
             FROM person p
			 WHERE lower(p.first_name)='woody'
			 AND lower(last_name)='allen')
AND year_of_award>1990
AND year_of_award<1996
AND lower(wa.result)='won';",2018-08-31 14:21:15.730558+10,9,1,328,correct
11148,"SELECT COUNT(*)
FROM WRITER w INNER JOIN PERSON p ON p.id=w.id
WHERE p.year_born='1935';",2018-08-31 14:21:28.977737+10,1,0,442,partially correct
11149,"SELECT COUNT(*) FROM
(SELECT DISTINCT writer.id, person.id, person.year_born FROM writer, person 
WHERE person.id=writer.id AND person.year_born='1935');",2018-08-31 14:21:35.053485+10,1,1,393,correct
11155,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:22:09.399027+10,14,1,233,correct
11156,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS (SELECT DISTINCT title
			 FROM movie_award NATURAL JOIN crew_award NATURAL JOIN director_award NATURAL JOIN writer_award NATURAL JOIN actor_award);",2018-08-31 14:22:11.985832+10,11,0,454,partially correct
11157,"select description from appearance a
where lower(a.title)='psycho'
group by description
having count(*)=1;",2018-08-31 14:22:15.859613+10,10,0,438,partially correct
11158,;,2018-08-31 14:22:23.355698+10,4,0,460,noninterpretable
11159,"select d.id, ma.award_name, ma.year_of_award, ma.category
where;",2018-08-31 14:22:48.262551+10,13,0,293,noninterpretable
11160,"select ma.title, ma.production_year, p.first_name, p.last_name from (select title, production_year from movie_award where 
lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won') as ma,
director as d, person as p where p.id = d.id and ma.production_year = d.production_year and ma.title = d.title;",2018-08-31 14:22:50.714291+10,8,1,213,correct
11161,"SELECT count(*) FROM WRITER Where PERSON.id == WRITER.id AND  year_born = 1935;
",2018-08-31 14:22:51.496264+10,1,0,268,noninterpretable
11162,SELECT FROM person p;,2018-08-31 14:22:58.444023+10,9,0,115,noninterpretable
11163,"SELECT id, first_name, last_name
FROM person
WHERE person.year_born = (SELECT MAX(year_born ) FROM person);",2018-08-31 14:23:01.111394+10,7,1,169,correct
11164,"SELECT 
	w.title, w.production_year
FROM 
	writer w, person p
WHERE
	w.id = p.id
	AND lower(first_name) = 'kevin'
	AND lower(last_name) = 'williamson';",2018-08-31 14:23:14.230425+10,5,1,417,correct
11165,"SELECT p.id,da.award_name,p.first_name,p.last_name,da.category
FROM person p NATURAL JOIN director d NATURAL JOIN director_award da
WHERE lower(da.result)='nominated' AND 
NOT EXISTS (SELECT * FROM director_award da1 WHERE da1.title=d.title AND da1.production_year=d.production_year AND lower(da1.result)='won');",2018-08-31 14:23:18.009746+10,13,0,439,partially correct
11166,"select r.country
from restriction r
where lower(r.description)='m' and lower(r.title)='shakespeace in love';",2018-08-31 14:23:28.342777+10,6,0,359,partially correct
11167,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:23:36.536077+10,14,1,278,correct
11168,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 14:23:47.079717+10,8,1,418,correct
11169,"select r.country
from restriction r
where lower(r.description)='m' and lower(r.title)='shakespeare in love';",2018-08-31 14:23:47.420608+10,6,1,359,correct
11170,"select count(*)
from person p
where id not in (select id
		from director);",2018-08-31 14:23:49.093308+10,12,1,432,correct
11171,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p)
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 14:23:58.375351+10,8,0,418,noninterpretable
11172,"SELECT count(*) FROM movie m

WHERE NOT EXISTS(
			SELECT title,production_year 
			FROM movie_award ma
			WHERE lower(ma.result)='won' AND ma.title = m.title AND ma.production_year=m.production_year
			UNION 
			SELECT title , production_year 
			FROM crew_award ca
			WHERE lower(ca.result)='won' AND ca.title = m.title AND ca.production_year=m.production_year
			UNION 
			SELECT title ,production_year 
			FROM director_award da
			WHERE lower(da.result)='won' AND da.title = m.title AND da.production_year=m.production_year
			UNION 
			SELECT title ,production_year 
			FROM writer_award wa
			WHERE lower(wa.result)='won' AND wa.title = m.title AND wa.production_year=m.production_year
			UNION
			SELECT title ,production_year 
			FROM actor_award aa
			WHERE lower(aa.result)='won' AND aa.title = m.title AND aa.production_year=m.production_year);",2018-08-31 14:24:20.549371+10,11,1,453,correct
11173,"select id, first_name, last_name 
from person as p
where EXISTS (SELECT count(*)>1
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 14:24:21.497687+10,4,0,318,partially correct
11174,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,)
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 14:24:22.077941+10,8,0,418,noninterpretable
11175,"SELECT country
FROM restriction r
WHERE title = 'Shakespeare in Love' and description = 'M';",2018-08-31 14:24:22.71358+10,6,1,459,correct
11176,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:24:37.793452+10,10,1,438,correct
11177,"select * from person
order by year_born desc;
",2018-08-31 14:24:44.496725+10,3,0,425,partially correct
11178,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
			FROM writer w
			WHERE w.id = p.id AND p.year_born = 1935);
",2018-08-31 14:24:50.599994+10,1,1,268,correct
11179,"select count(*)
from (writer NATURAL JOIN person)AS w(
        SELECT id,title,production_year
        FROM
            writer_award
        WHERE year_of_award> 1990 AND year_of_award<1996 AND lower(RESULT)= 'won' ) AS m
where lower(w.first_name)='woody'
and w.id=m.id;",2018-08-31 14:25:09.757228+10,9,0,325,noninterpretable
11180,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 14:25:15.022062+10,8,1,418,correct
11181,"SELECT w.title, w.production_year, p.first_name, p.last_name 
	FROM (SELECT title, production_year FROM MOVIE_AWARD 
		WHERE lower(award_name)='bafta film award' AND category='best film' AND lower(result)='won') w, 
		DIRECTOR d, Person p
	WHERE w.title = d.title AND w.production_year = d.production_year AND d.id = p.id;",2018-08-31 14:25:20.838317+10,8,1,161,correct
11182,"select id, first_name, last_name
from person
where year_born>=(select MAX(year_born)
                  from person);",2018-08-31 14:25:21.224722+10,7,1,359,correct
11183,"Select id
From movie m,title t,
WHere m.title='Psycho'
AND production_year=1960
AND m.title=s.title
AND ;",2018-08-31 14:25:22.910883+10,10,0,246,noninterpretable
11184,;,2018-08-31 14:25:48.324613+10,10,0,217,noninterpretable
11185,;,2018-08-31 14:26:03.007646+10,3,0,264,noninterpretable
11186,"with sub as (
select id,count(*) as num
from(
select id, title, production_year
from director d
union
select id, title, production_year 
from writer w
) as foo
group by id
)
select id from sub where num =( select max(num) from sub) ;
",2018-08-31 14:26:08.303772+10,14,1,125,correct
11187,;,2018-08-31 14:26:31.972554+10,5,0,460,noninterpretable
11188,"select ma.title,
       ma.production_year,
       p.first_name,
       p.last_name
from (select * 
       from movie_award  
       where lower(result)='won' 
       and lower(award_name)='bafta film award' 
       and lower(category)='best film') as ma,
       person p, 
       director d
where p.id=d.id 
      and d.title=ma.title 
      and d.production_year=ma.production_year;",2018-08-31 14:26:46.094263+10,8,1,298,correct
11189,"select count(*)
from person p
where exists (select *
			from writer w
			where w.id =p.id
				and p.year_born = 1935
			group by w.id);
",2018-08-31 14:26:46.685778+10,1,1,134,correct
11190,"SELECT COUNT(*) FROM
(SELECT person.id,director.id FROM person NATURAL JOIN director
WHERE director.id is NULL);
",2018-08-31 14:26:47.288177+10,12,0,393,partially correct
11191,"select  title, production_year, first_name , last_name from 
movie_award ma natural join director d natural join person p
where  lower(award_name )='bafta film award'
and lower(category )='best film'
and lower(result)='won';
",2018-08-31 14:27:01.585259+10,8,1,374,correct
11192,"select p.id 
from person p
where p.year_born = (
select max(year_born) 
from person
where year_born < (select max(year_born) from person));",2018-08-31 14:27:07.666127+10,3,1,425,correct
11193,";
",2018-08-31 14:27:10.463377+10,12,0,220,noninterpretable
11194,"select count(*)
from (select count(*)
from writer
where id in(select id
            from person
		where year_born=1935)
group by id);
",2018-08-31 14:27:13.221606+10,1,1,233,correct
11195,"select ma.title, ma.production_year, p.first_name, p.last_name
from (select title, production_year from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won') as ma, 
person as p, director as d
where ma.title = d.title and ma.production_year = d.production_year and p.id=d.id;",2018-08-31 14:27:14.953673+10,8,1,41,correct
11196,"SELECT id
FROM (SELECT max(year_born), id FROM person) p;",2018-08-31 14:27:15.343928+10,3,0,446,partially correct
11197,"SELECT p.COUNT(*)
FROM person p, writer_award wa
WHERE EXISTS (SELECT * FROM wa,p
WHERE aw.year_of_award>1990 AND aw.year_of_award<1996 AND p.id=wa.id AND p.first_name='Woody' AND p.last_name='Allen');",2018-08-31 14:27:18.042732+10,9,0,441,noninterpretable
11198,"SELECT
	id
FROM
	DIRECTOR d NATURAL JOIN WRITER w
WHERE id = max(
	SELECT
		id,
		COUNT(*)
	FROM
		DIRECTOR d NATURAL JOIN WRITER w));",2018-08-31 14:27:18.55195+10,14,0,50,noninterpretable
11199,"SELect count(*) as numeber_of_noneawardmovies
From;",2018-08-31 14:27:19.567279+10,11,0,246,noninterpretable
11200,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:27:20.606719+10,11,1,312,correct
11201,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM  (director_award da NATURAL JOIN director d) AS dda
WHERE lower(dda.result) = 'nominated' AND d.id NOT IN (SELECT d1.id
									  FROM (director_award da1 NATURAL JOIN director d1) AS dda1
								        WHERE lower(dda1.result) = 'won');",2018-08-31 14:27:22.516311+10,13,1,145,correct
11202,select id from person p;,2018-08-31 14:27:28.856269+10,14,0,456,partially correct
11203,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    (writer NATURAL JOIN person) AS w
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND lower(wa.RESULT)= 'won'
    AND lower(w.first_name)= 'woody'
    AND lower(w.last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 14:27:29.077391+10,9,1,325,correct
11204,"select ma.title, ma.production_year, p.first_name,p.last_name
from movie_award ma,person p, director d
where lower(ma.award_name)='bafta film award' and 
	lower(ma.category)='best film' and
	lower(ma.result)='won' and
	d.title =ma.title and
	d.id = p.id;",2018-08-31 14:27:32.618754+10,8,1,401,correct
11205,"with youngest as (
select * from person
where year_born = (
select max(year_born) from person)),
other as (
select * from person p 
where not exists(select id from youngest y
where p.id = y.id))
select id from other
where year_born = (
select max(year_born) from other);
",2018-08-31 14:27:52.136352+10,3,1,129,correct
11206,"SELECT COUNT(*) FROM
(SELECT person.id,director.id FROM person LEFT JOIN director ON person.id=director.id
WHERE director.id is NULL);
",2018-08-31 14:28:09.355968+10,12,1,393,correct
11207,"select p.id,p.first_name,p.last_name
from person p
where p.year_born = (select max(year_born)
				from person);",2018-08-31 14:28:09.399138+10,7,1,340,correct
11208,"select r.id
from scene s, appearance a,role r
where s.title = a.title
      and s.production_year = a.production_year
	 and s.scene_no = a.scene_no
	 and s.title = r.title
	 and s.production_year = r.production_year
	 and a.description = r.description
	 and lower(a.title) = 'psycho'
	 and a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-31 14:28:26.423868+10,10,1,225,correct
11209,"SELECT kwm.title, kwm.production_year
FROM (person NATURAL JOIN writer NATURAL JOIN movie) AS kwm
WHERE person.first_name = 'Kevin' AND person.last_name  = 'Williamson';",2018-08-31 14:28:28.288639+10,5,1,420,correct
11210,"SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year > 1990 AND production_year < 1994
GROUP BY production_year;",2018-08-31 14:28:28.864212+10,2,1,23,correct
11211,"select * from role natural join person where 
id = (
select id from role
group by id order by count(*) desc limit 1);",2018-08-31 14:28:30.505304+10,15,0,126,partially correct
11212,"SELECT foo.id,foo.first_name,foo.last_name FROM(person p Natural JOIN Writer w Natural JOIN Director d) as foo
GROUP BY foo.id  HAVING count(*)>1;",2018-08-31 14:28:34.370641+10,4,1,297,correct
11213,;,2018-08-31 14:28:35.621994+10,13,0,264,noninterpretable
11214,"SELECT id
FROM(
	SELECT id, COUNT(DISTINCT title) AS ct
	FROM(
		SELECT * FROM director
		UNION
		SELECT id, title, production_year FROM writer
		)
		AS a
	GROUP BY a.id
	)
	AS b
WHERE
	b.ct=(
		SELECT
			MAX(ct)
		FROM
			(
			SELECT id, COUNT(DISTINCT title) AS ct
			FROM(
				SELECT * FROM director
				UNION
				SELECT id, title, production_year FROM writer
				)
				AS c
			GROUP BY c.id
			)
			AS d
		);",2018-08-31 14:28:42.012083+10,14,1,322,correct
11215,"SELECT COUNT(*) from movie m

where not exists

(SELECT title, production_year from movie_award ma
Where lower(result)='won' and ma.title = m. title and ma.production_year = m. production_year
Union
SELECT title, production_year from crew_award ca
Where lower(result)='won' and ca.title = m. title and ca.production_year = m. production_year
Union
SELECT title, production_year from director_award da
Where lower(result)='won' and da.title = m. title and da.production_year = m. production_year
UNION
SELECT title, production_year from writer_award wa
Where lower(result)='won' and wa.title = m. title and wa.production_year = m. production_year
UNION
SELECT title, production_year from actor_award aa
Where lower(result)='won' and aa.title = m. title and aa.production_year = m. production_year);",2018-08-31 14:28:52.475716+10,11,1,198,correct
11216,"SELECT production_year, count(production_year)
FROM movie m
WHERE m.production_year = 1993 AND m.production_year = 1992 AND m.production_year = 1991;
",2018-08-31 14:29:10.414654+10,2,0,268,partially correct
11217,";
",2018-08-31 14:29:27.354945+10,6,0,460,noninterpretable
11218,"select first_name, last_name,title,production_year,description from role natural join person where 
id = (
select id from role
group by id order by count(*) desc limit 1);",2018-08-31 14:29:35.066764+10,15,1,126,correct
11219,"SELECT
	country
FROM
	restriction
WHERE
	lower(title) = 'shakespeare in love'
	AND description = 'M';",2018-08-31 14:29:40.35837+10,6,1,417,correct
11220,"SELECT d.id,da.award_name,p.first_name,p.last_name,da.category
FROM person p , director d ,(SELECT da2.* FROM director_award da2 WHERE NOT EXISTS (SELECT da1.* FROM director_award da1 WHERE lower(da1.result)='won')) da
WHERE p.id=d.id AND d.title=da.title AND d.production_year=da.production_year AND lower(da.result)='nominated';",2018-08-31 14:29:40.753819+10,13,0,439,partially correct
11221,"select id
from person
Where (select ;",2018-08-31 14:29:53.293141+10,3,0,246,noninterpretable
11222,"SELECT x.id FROM (SELECT x1.id, count(*) AS NoOfWorkedON FROM (SELECT d.id, title, production_year FROM director d UNION SELECT w.id, title, production_year FROM writer w) x1 GROUP BY x1.id) x WHERE x.NoOfWorkedON= (SELECT MAX(x2.NoOfWorkedON) FROM (SELECT x1.id, count(*) AS NoOfWorkedON FROM (SELECT d.id, title, production_year FROM director d UNION SELECT w.id, title, production_year FROM writer w) x1 GROUP BY x1.id) x2);",2018-08-31 14:30:05.94527+10,14,1,50,correct
11223,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:30:23.468606+10,11,1,454,correct
11224,"SELECT production_year, count(*)
FROM movie
WHERE production_year = 1993 AND production_year = 1992 AND production_year = 1991
GROUP BY production_year;",2018-08-31 14:30:25.740362+10,2,0,268,partially correct
11225,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 14:30:27.016652+10,4,1,318,correct
11226,;,2018-08-31 14:30:34.141031+10,15,0,50,noninterpretable
11227,;,2018-08-31 14:30:34.511298+10,7,0,460,noninterpretable
11228,;,2018-08-31 14:30:43.541872+10,13,0,246,noninterpretable
11229,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 14:30:44.006463+10,4,1,432,correct
11230,;,2018-08-31 14:30:48.886129+10,7,0,460,noninterpretable
11231,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da,director d
where 
d.title=da.title
and d.production_year=da.production_year
and lower(da.result)='nominated'
and d.id not in (select d.id
from director_award da,director d
where da.title=d.title
and d.production_year=da.production_year
and lower(da.result)='won');",2018-08-31 14:31:01.498724+10,13,1,293,correct
11232,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p,ROLE r,
    (SELECT id, count(*) AS number_of_roles
        FROM ROLE
        GROUP BY id ) AS b
WHERE r.id = p.id AND p.id = b.id
    AND b.number_of_roles IN (SELECT max(number_of_roles)
        FROM (SELECT id, count ( * ) AS number_of_roles
                FROM ROLE
                GROUP BY id ) AS a );
",2018-08-31 14:31:04.402352+10,15,1,402,correct
11233,"SELECT production_year, count(*)
FROM movie
WHERE production_year = 1993 OR production_year = 1992 OR production_year = 1991
GROUP BY production_year;",2018-08-31 14:31:08.635297+10,2,1,268,correct
11234,"select t1.id from (select t.id, count(*) as c from (select d.id, title, production_year from director d UNION select w.id, title, production_year from writer w) t group by t.id) t1 where t1.c in (select count(*) from (select d.id, title, production_year from director d UNION select w.id, title, production_year from writer w) t group by t.id order by count(*) desc limit 1);",2018-08-31 14:31:14.44256+10,14,1,70,correct
11235,;,2018-08-31 14:31:18.511262+10,14,0,246,noninterpretable
11236,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da,director d
where 
d.title=da.title
and d.production_year=da.production_year

and d.id not in (select d.id
from director_award da,director d
where da.title=d.title
and d.production_year=da.production_year
and lower(da.result)='won');",2018-08-31 14:31:26.031467+10,13,1,293,correct
11237,"SELECT id
FROM (
	SELECT id, COUNT(*) as count
	FROM (
		SELECT id, title, production_year
		FROM DIRECTOR NATURAL JOIN WRITER
		UNION

		SELECT id, title, production_year
		FROM DIRECTOR
		UNION

		SELECT id, title, production_year
		FROM WRITER
	) 
	GROUP BY id
	) AS info
GROUP BY id
HAVING info.count = (
	SELECT MAX(count)
	FROM (
		SELECT count
		FROM (
			SELECT id, COUNT(*) as count
			FROM (
				SELECT id, title, production_year
				FROM DIRECTOR NATURAL JOIN WRITER
				UNION

				SELECT id, title, production_year
				FROM DIRECTOR
				UNION

				SELECT id, title, production_year
				FROM WRITER
			) 
			GROUP BY id
			)
		)
	)
;",2018-08-31 14:31:28.309788+10,14,1,423,correct
11238,"SELECT COUNT (*)
FROM person p 
WHERE EXISTS (
		SELECT * 
		FROM writer w
		WHERE p.id = w.id
		AND p.year_born = 1935);
",2018-08-31 14:31:29.158165+10,1,1,435,correct
11239,"select ffff.ddd from
(select ff.id as ddd,max(c) from
(select f.id,count(*) as c from 
(select d.id,d.title,d.production_year from director as d
union
select w.id,w.title,w.production_year from writer as w) as f group by f.id) as ff) as ffff;",2018-08-31 14:31:32.073452+10,14,0,101,partially correct
11240,"select id, award_name, year_of_award, category from director_award as da, director as d
where da.title=d.title and da.production_year=d.production_year
and lower(result='nominated'
and ;
",2018-08-31 14:31:33.302198+10,13,0,452,noninterpretable
11241,"SELECT count(award_name) FROM WRITER_AWARD 
WHERE year_of_award >=1991 AND year_of_award <=1995;",2018-08-31 14:31:40.619712+10,9,0,161,partially correct
11242,;,2018-08-31 14:31:44.41878+10,15,0,246,noninterpretable
11243,"select count(*)
from writer_award wa, person p
where wa.id=p.id and 
	wa.year_of_award>1990 and
	wa.year_of_award<1996 and 
	lower(p.first_name)='woody'
	and lower(p.last_name)='allen';",2018-08-31 14:31:52.556331+10,9,0,401,partially correct
11244,;,2018-08-31 14:31:57.577537+10,8,0,460,noninterpretable
11245,"select count(role.title), person.id
from role
;",2018-08-31 14:31:59.40526+10,15,0,123,noninterpretable
11246,SELECT FROM person p;,2018-08-31 14:32:00.756436+10,10,0,115,noninterpretable
11247,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:32:02.381609+10,11,1,278,correct
11582,"select writer.title, writer.production_year
from writer join person on writer.id = person.id  
where person.first_name = ""Kevin"" and person.last_name= ""Williamson"" 
group by writer.title;",2018-08-31 15:09:28.049916+10,5,1,235,correct
11248,"select ma.title, ma.production_year, p.first_name,p.last_name
from movie_award ma, person p, director d
where ma.title = d.title 
	and ma.production_year = d.production_year
	and d.id = p.id
	and lower(ma.result) = 'won' and lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film';",2018-08-31 14:32:03.299044+10,8,1,340,correct
11249,"select count(*)
from (person natural join writer_award) as pw
where lower(pw.first_name) = 'woody'
and lower(pw.last_name) = 'allen'
and pw.year_of_award <= 1995 and pw.year_of_award >= 1991
and lower(pw.result) = 'won';",2018-08-31 14:32:09.875758+10,9,1,41,correct
11250,"select count(*) from person p
where exists select * from writer w where p.id = w.id and p.year_born = 1935; ",2018-08-31 14:32:11.616876+10,1,0,367,noninterpretable
11251,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:32:14.519427+10,13,1,452,correct
11252,"SELECT r.id
FROM role r, scene s, appearance a
WHERE s.title=a.title
AND   s.production_year=a.production_year
AND   s.scene_no=a.scene_no
AND   s.title=r.title
AND   s.production_year=r.production_year
AND   a.description=r.description
AND   lower(s.title)='psycho'
AND   s.production_year=1960

GROUP BY r.id
HAVING count(*)=1;",2018-08-31 14:32:19.375799+10,10,1,328,correct
11253,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from (select *,count(title) c from person p,role r where p.id=r.id group by id) as a
where a.c= (select max(c) from 
(select b.id,b.count(title) c from person p,role r where p.id=r.id group by b.id) as b);",2018-08-31 14:32:26.237336+10,15,0,216,noninterpretable
11254,"select count(*) from person p
where exists (select * from writer w where p.id = w.id and p.year_born = 1935); ",2018-08-31 14:32:29.530191+10,1,1,367,correct
11255,"SELECT COUNT(*) 
FROM WRITER w INNER JOIN PERSON p ON w.id = p.id
WHERE p. year_born = 1935;",2018-08-31 14:32:29.892086+10,1,0,455,partially correct
11256,"SELECT m.title,m.production_year FROM Movie m INNER JOIN (
SELECT * FROM Person p INNER JOIN Writer w ON p.id=w.id WHERE p.first_name='Kevin' AND p.last_name='Williamson'

) as foo ON foo.title=m.title AND foo.production_year=m.production_year;",2018-08-31 14:32:35.347724+10,5,1,297,correct
11257,;,2018-08-31 14:32:36.025686+10,14,0,264,noninterpretable
11258,"select m.title,m.production_year,p.first_name,p.last_name
from movie_award m, director d, person p
where m.title=d.title and m.production_year=d.production_year and d.id=p.id
     and lower(m.award_name)='befta film award' and lower(m.category)='best flim';",2018-08-31 14:32:45.310207+10,8,0,359,partially correct
11259,"select id 
from PERSON
where PERSON.year_born IN (select MAX(year_born)
                           from PERSON
                           where year_born < ( SELECT MAX(year_born)
                                                from PERSON));",2018-08-31 14:32:47.099869+10,3,1,139,correct
11260,"select *
from director_award;",2018-08-31 14:32:50.918151+10,13,0,425,partially correct
11261,;,2018-08-31 14:32:53.697335+10,9,0,460,noninterpretable
11262,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * FROM director d
WHERE p.id = d.id);",2018-08-31 14:33:07.514386+10,12,1,23,correct
11263,"select count(distinct writer.id) from writer where exists (select * from writer w,person p where w.id=p.id and p.year_born = 1935);",2018-08-31 14:33:41.147623+10,1,0,200,partially correct
11264,"select m.title,m.production_year,p.first_name,p.last_name
from movie_award m, director d, person p
where m.title=d.title and m.production_year=d.production_year and d.id=p.id
     and lower(m.award_name)='befta film award' and lower(m.category)='best film';",2018-08-31 14:33:42.473006+10,8,0,359,partially correct
11265,"select production_year,count(*)
from movie as m
where production_year=1991 or production_year=1992 or production_year=1993
group by production_year;
",2018-08-31 14:33:42.72525+10,2,1,134,correct
11266,"SELECT id, first_name, last_name 
FROM person
WHERE year_born in( SELECT MAX(year_born) FROM person);",2018-08-31 14:33:46.442974+10,7,1,459,correct
11267,"select count(*)
from writer_award wa, person p
where wa.id=p.id and 
	wa.year_of_award>1990 and
	wa.year_of_award<1996 and 
	lower(p.first_name)='woody' and
	lower(p.last_name)='allen' and 
	lower(wa.result)='won';",2018-08-31 14:33:51.218259+10,9,1,401,correct
11268,"select count(*) from person p
where p.id in (select w.id from writer w where p.id = w.id and p.year_born = 1935); ",2018-08-31 14:33:51.69905+10,1,1,367,correct
11269,"SELECT ERWR
FROM sf;",2018-08-31 14:34:06.110169+10,13,0,259,noninterpretable
11270,"select p.id
from ;",2018-08-31 14:34:13.865632+10,14,0,293,noninterpretable
11271,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:34:17.679716+10,13,1,425,correct
11272,"select m.title,m.production_year,p.first_name,p.last_name
from movie_award m, director d, person p
where m.title=d.title and m.production_year=d.production_year and d.id=p.id
     and lower(m.award_name)='bafta film award' and lower(m.category)='best film';",2018-08-31 14:34:18.807964+10,8,0,359,partially correct
11273,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 14:34:19.481339+10,13,1,259,correct
11274,;,2018-08-31 14:34:23.513668+10,10,0,460,noninterpretable
11275,"SELECT count(*)
FROM PERSON
WHERE NOT EXISTS (person.id == writer.id);",2018-08-31 14:34:25.529816+10,12,0,268,noninterpretable
11276,hrhrhrhter;,2018-08-31 14:34:35.852524+10,14,0,259,noninterpretable
11277,"SELECT ID,YEAR_BORN FROM PERSON
ORDER BY YEAR_BORN DESC
;",2018-08-31 14:34:37.758227+10,3,0,198,partially correct
11278,"select count(*)
from
(select count(*)
from person p
where p.id not in (select id
                   from director)
group by p.id);",2018-08-31 14:34:39.96366+10,12,1,233,correct
11279,"select title,production_year
from writer natural join person
where lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-31 14:34:43.99205+10,5,1,432,correct
11280,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:34:48.558425+10,14,1,259,correct
11281,"select count(*) from writer_award wa, writer w, person p where lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'
wa.title = w.title and wa.production_year = w.production_year and wa.production_year >= 1991 and wa.production_year <= 1995 and
w.id = p.id;",2018-08-31 14:34:52.897608+10,9,0,213,noninterpretable
11282,"select count(*) from
(writer_award natural  join person ) as wp
where lower( wp.first_name) ='woody'
and lower( wp.last_name) ='allen'
and wp.year_of_award>=1991
and  wp.year_of_award<=1995
and lower(wp.result)='won';",2018-08-31 14:34:56.186263+10,9,1,374,correct
11283,SELECT country FROM Restriction WHERE lower(title)='Shakespeare in Love';,2018-08-31 14:34:56.321056+10,6,0,297,partially correct
11284,rgegrthrh;,2018-08-31 14:34:59.89815+10,15,0,259,noninterpretable
11285,;,2018-08-31 14:35:19.372287+10,11,0,460,noninterpretable
11286,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 14:35:19.528855+10,15,1,259,correct
11287,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT *
			FROM director d
			WHERE p.id = d.id);",2018-08-31 14:35:20.335359+10,12,1,268,correct
11288,"SELECT p.id
FROM (person p UNION director d UNION writer w) AS wom
WHERE EXISTS (SELECT MAX(title, production_year)
		   FROM wom);",2018-08-31 14:35:20.579885+10,14,0,145,noninterpretable
11289,"SELECT *
FROM person
Where exists (select  * 
			from (scene natural join role natural join appearance) as mix
			Where lower(mix.title) = ""psycho"" and mix.production_year = 1960
			Group by id 
			Having count(*) = 1);",2018-08-31 14:35:21.455284+10,10,0,457,partially correct
11290,"select count(*) from writer_award wa, writer w, person p where lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen'and 
wa.title = w.title and wa.production_year = w.production_year and wa.production_year >= 1991 and wa.production_year <= 1995 and
w.id = p.id;",2018-08-31 14:35:26.39188+10,9,1,213,correct
11291,SELECT country FROM Restriction WHERE lower(title)='shakespeare in love';,2018-08-31 14:35:38.32831+10,6,0,297,partially correct
11292,"SELECT id
FROM person 
WHERE year_born=(
SELECT max(year_born)
FROM person
WHERE year_born<(
SELECT max(year_born)
FROM person));",2018-08-31 14:35:45.242361+10,3,1,312,correct
11293,select count(*) from person p where exists (select p.id from writer w where w.id=p.id and p.year_born = 1935);,2018-08-31 14:35:50.060343+10,1,1,200,correct
11294,"select production_year,count(*) from movie 
group by production_year
having production_year<=1991 and production_year<=1993;",2018-08-31 14:35:51.041133+10,2,0,367,partially correct
11295,SELECT country FROM Restriction WHERE lower(title)='shakespeare in love' AND lower(description)='m';,2018-08-31 14:35:51.866194+10,6,1,297,correct
11296,;,2018-08-31 14:35:54.905945+10,3,0,460,noninterpretable
11297,"select count(wa.*)
from writer_award wa, person p
where wa.id = p.id
	and lower(p.first_name) = 'woody'
	and lower(p.last_name) = 'allen'
	and wa.year_of_award between 1991 and 1995
	and lower(wa.result) = 'won';",2018-08-31 14:36:02.742209+10,9,0,340,noninterpretable
11298,"SELECT COUNT(*)
FROM person p 
WHERE EXISTS(SELECT * FROM writer 
WHERE p.id =writer.id AND p.year_born=1935);
",2018-08-31 14:36:04.593957+10,1,1,372,correct
11299,"select production_year,count(*) from movie 
group by production_year
having production_year>=1991 and production_year<=1993;",2018-08-31 14:36:10.149937+10,2,1,367,correct
11300,;,2018-08-31 14:36:10.611128+10,7,0,196,noninterpretable
11301,"SELECT id
FROM (
	SELECT id, COUNT(*) as count
	FROM (
		SELECT id, title, production_year
		FROM DIRECTOR
		UNION
		SELECT id, title, production_year
		FROM WRITER
	) 
	GROUP BY id
	) AS info
GROUP BY id
HAVING info.count = (
	SELECT MAX(count)
	FROM (
		SELECT count
		FROM (
			SELECT id, COUNT(*) as count
			FROM (
				SELECT id, title, production_year
				FROM DIRECTOR
				UNION
				SELECT id, title, production_year
				FROM WRITER
			) 
			GROUP BY id
			)
		)
	)
;",2018-08-31 14:36:22.452703+10,14,1,423,correct
11302,"select id
from person
where year_born in (select max(year_born)
				from person  
				where year_born<(select max(year_born)
							from person));",2018-08-31 14:36:25.558065+10,3,1,149,correct
11303,;,2018-08-31 14:36:28.563073+10,3,0,460,noninterpretable
11304,"SELECT count(DISTINCT w.id)
FROM WRITER w INNER JOIN PERSON p ON w.id = p.id
WHERE p.year_born = 1935;",2018-08-31 14:36:56.438213+10,1,1,455,correct
11305,"select count(wa.*)
from writer_award wa, person p
where wa.id = p.id
	and lower(p.first_name) = 'woody'
	and lower(p.last_name) = 'allen'
	and wa.year_of_award between 1991 and 1995
	and lower(wa.result) = 'won';",2018-08-31 14:37:04.78461+10,9,0,340,noninterpretable
11306,"SELECT YEAR_BORN, COUNT(*) AS NUMOFWRI
FROM PERSON
WHERE YEAR_BORN = '1935'
GROUP BY YEAR_BORN;",2018-08-31 14:37:08.165707+10,1,0,356,partially correct
11307,"select m.title,m.production_year,p.first_name,p.last_name
from movie_award m, director d, person p
where m.title=d.title and m.production_year=d.production_year and d.id=p.id
     and lower(m.award_name)='bafta film award' and lower(m.category)='best film' and lower(m.result)='won';",2018-08-31 14:37:09.450175+10,8,1,359,correct
11308,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:37:13.033213+10,10,1,457,correct
11309,"select count(*)
from writer_award wa
where exists(select award_name from (writer_award wa1 natural join person p) as wp
where wa1.year_of_award>1990 and wa1.year_of_award<1996 
and wa.id= p.id
and p.first_name = Woody
and p.last_name = Allen;",2018-08-31 14:37:14.247981+10,9,0,418,noninterpretable
11310,;,2018-08-31 14:37:35.699732+10,13,0,460,noninterpretable
11311,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT max(year_born) FROM person);",2018-08-31 14:37:38.430697+10,3,0,450,partially correct
11312,;,2018-08-31 14:37:42.484513+10,15,0,278,noninterpretable
11313,"SELECT COUNT(*)
FROM WRITER w, PERSON p
WHERE p.year_born = 1935 AND p.id = w.id
GROUP BY w.id;",2018-08-31 14:37:42.941931+10,1,0,451,partially correct
11314,"SELECT ID,YEAR_BORN FROM PERSON
ORDER BY YEAR_BORN DESC
Limit 1 offset 1;
",2018-08-31 14:37:46.156408+10,3,0,198,partially correct
11315,;,2018-08-31 14:37:46.518309+10,15,0,264,noninterpretable
11316,"SELECT p.id
FROM (person p RIGHT JOIN director d RIGHT JOIN writer w) AS wom
WHERE EXISTS (SELECT MAX(title, production_year)
		   FROM wom);",2018-08-31 14:37:56.636227+10,14,0,145,noninterpretable
11317,"select p.id, p.first_name, p.last_name from person p where p.year_born=(select max(p.year_born) from person p );",2018-08-31 14:37:57.702607+10,7,1,196,correct
11318,"select country
from restriction
where lower(title) = ""shakespeare in love"" and lower(description) = 'm';",2018-08-31 14:37:58.15588+10,6,1,136,correct
11319,"SELECT ID FROM PERSON
ORDER BY YEAR_BORN DESC
Limit 1 offset 1;
",2018-08-31 14:38:02.333613+10,3,1,198,correct
11320,"select DISTINCT id
from role,scene
where lower(scene.title)='psycho'
and scene_no=1;",2018-08-31 14:38:12.902036+10,10,0,325,partially correct
11321,"SELECT id,first_name,last_name FROM person ORDER BY year_born Limit 1;",2018-08-31 14:38:21.005429+10,7,0,297,partially correct
11322,"select count(*)
from writer_award wa, person p
where wa.id = p.id
	and lower(p.first_name) = 'woody'
	and lower(p.last_name) = 'allen'
	and wa.year_of_award>1990
	and wa.year_of_award<1996
	and lower(wa.result) = 'won';",2018-08-31 14:38:22.03627+10,9,1,340,correct
11323,"select count(*) from person p 
where no exists (select * from director d where p.id= d.id );",2018-08-31 14:38:24.872978+10,12,0,367,noninterpretable
11324,"select nid.id, person.first_name, person.last_name, role.title, role.production_year, role.description
from (SELECT
            id
            
        FROM
            ROLE
        GROUP BY
            id
			order by count(*) desc limit 1 ) as NID, person, role
where nid.id = person.id
and person.id = role.id;",2018-08-31 14:38:27.525991+10,15,0,123,partially correct
11325,"select p.id, p.first_name, p.last_name
from person p
where p.id in
(select distinct id from director d natural join writer w
group by id
having count(*)> 1)
;",2018-08-31 14:38:32.105368+10,4,1,391,correct
11326,"select id,award_name,year_of_award,category
from (select *
from (director natural join director_award)
where lower(result) = 'nominated'
group by lower(result)
having count(lower(result)) > 0) as mm;",2018-08-31 14:38:32.313214+10,13,1,440,correct
11327,"SELECT id,first_name,last_name FROM person ORDER BY year_born desc Limit 1;",2018-08-31 14:38:36.587944+10,7,1,297,correct
11328,;,2018-08-31 14:38:38.049911+10,14,0,460,noninterpretable
11329,"select count(*) from person p 
where not exists (select * from director d where p.id= d.id );",2018-08-31 14:38:39.19023+10,12,1,367,correct
11330,"select count(*)
from writer_award wa
where exists(select award_name from (writer_award wa1 natural join person p) as wp
where wa1.year_of_award>1990 and wa1.year_of_award<1996 
and w.id= p.id
and wp.first_name = Woody
and wp.last_name = Allen
and wp.result = won;",2018-08-31 14:38:44.947115+10,9,0,418,noninterpretable
11331,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT max(year_born) FROM person WHERE 
year_born < (SELECT MAX(year_born) FROM person));",2018-08-31 14:38:47.273732+10,3,1,450,correct
11332,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw
GROUP BY dw.id
HAVING COUNT(*)>1;
",2018-08-31 14:38:53.523486+10,4,1,23,correct
11333,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM  director d ,director_award da  
WHERE  d.title=da.title AND d.production_year=da.production_year AND lower(da.result)='nominated'
AND d.id NOT IN (SELECT d2.id FROM director_award da1,director d2 
WHERE d2.title=da1.title AND da1.production_year=d2.production_year AND lower(da1.result)='won');",2018-08-31 14:38:54.503448+10,13,1,439,correct
11334,"select person.first_name, person.last_name, role.title, role.production_year, role.description
from (SELECT
            id
            
        FROM
            ROLE
        GROUP BY
            id
			order by count(*) desc limit 1 ) as NID, person, role
where nid.id = person.id
and person.id = role.id;",2018-08-31 14:38:55.935052+10,15,1,123,correct
11335,"SELECT production_year, COUNT(*)
FROM movie 
WHERE production_year=1993
OR production_year=1992
OR production_year=1991
GROUP BY production_year;
",2018-08-31 14:39:00.782387+10,2,1,372,correct
11336,;,2018-08-31 14:39:19.305973+10,15,0,460,noninterpretable
11337,"SELECT id, first_name, last_name
FROM director d, writer w
WHERE EXISTS (d.id = w.id);",2018-08-31 14:39:20.805007+10,4,0,268,noninterpretable
11338,"
select count(*)
from movie m
where m.title not in 
(select ma.title from movie_award ma
union
select ca.title from crew_award ca
union 
select da.title from director_award da
union 
select wa.title from writer_award wa
union 
select aa.title from actor_award aa)
and m.production_year not in
(select ma.production_year from movie_award ma 
union 
select ca.production_year from crew_award ca
union 
select da.production_year from director_award da
union 
select wa.production_year from writer_award wa
union 
select aa.production_year from actor_award aa);

",2018-08-31 14:39:35.370229+10,11,0,170,partially correct
11339,"select country
from  restriction
where lower(title)='shakespeare in love' and lower(description)='m';",2018-08-31 14:39:36.716525+10,6,1,432,correct
11340,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:39:38.915231+10,10,1,325,correct
11341,"select p.id, p.first_name, p.last_name
from person p
where p.id = (select Max(p1.id)
			from person p1);",2018-08-31 14:39:39.703132+10,7,0,136,partially correct
11342,"SELECT id,first_name,last_name From Person p WHERE p.year_born=(SELECT max(year_born) FROm person );",2018-08-31 14:39:47.195156+10,7,1,297,correct
11343,"select person.id,person.first_name,person.last_name
from director,person,writer
where director.id = person.id
and  writer.id = person.id
group by person.id
having count(*)>1;",2018-08-31 14:39:52.866283+10,4,0,364,partially correct
11344,SELECT FROM person p;,2018-08-31 14:40:01.996035+10,11,0,115,noninterpretable
11345,"SELECT c.id, c.first_name, c.last_name FROM
((SELECT * FROM Restriction r, role c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'PG-13' AND r.country = 'USA') AS c1,
(SELECT * FROM Restriction r, role c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'PG' AND r.country = 'USA') AS c2,
(SELECT * FROM Restriction r, role c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'G' AND r.country = 'USA') AS c3,
(SELECT * FROM Restriction r, role c,Person p
WHERE r.title = c.title
AND r.production_year = c.production_year AND c.id = p.id
AND r.description = 'R' AND r.country = 'USA') AS c4)AS c
WHERE c1.id = c2.id
AND c2.id = c3.id
AND c3.id = c4.id;",2018-08-31 14:40:04.27532+10,14,0,218,partially correct
11346,"with temp1 as
(
select id,count(*) as c from role group by id
)
select pr.first_name,pr.last_name,pr.title,pr.production_year,pr.description
from (person natural join role) as pr,(select max(c) as m from temp1)as t,temp1
where pr.id=temp1.id and temp1.c=t.m 
;",2018-08-31 14:40:12.607482+10,15,1,85,correct
11347,"SELECT r.id
FROM role AS r,
scene AS s,
appearance AS a
WHERE s.title=a.title
AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(s.title) = 'psycho'
    AND s.production_year = 1960
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 14:40:17.681456+10,10,1,217,correct
11348,;,2018-08-31 14:40:32.159064+10,11,0,217,noninterpretable
11349,"select p.id, p.first_name, p.last_name
from person p
where p.year_born = (select Max(p1.year_born)
			from person p1);",2018-08-31 14:40:32.988001+10,7,1,136,correct
11350,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 14:40:54.569613+10,1,1,451,correct
11351,"select ar.id from
(appearance natural join role ) as ar
where lower(ar.title)='psycho'
and ar.production_year=1960
group by ar.id
having count(*)=1;",2018-08-31 14:41:01.739099+10,10,1,374,correct
11352,"SELECT id
FROM (
	SELECT id, COUNT(*) as count
	FROM (
		SELECT id, title, production_year
		FROM DIRECTOR
		UNION
		SELECT id, title, production_year
		FROM WRITER) 
	GROUP BY id
	) AS info
GROUP BY id
HAVING info.count = (
	SELECT MAX(info2.count)
	FROM (
		SELECT id, COUNT(*) as count
		FROM (
			SELECT id, title, production_year
			FROM DIRECTOR
			UNION
			SELECT id, title, production_year
			FROM WRITER) 
		GROUP BY id) as info2
)
;",2018-08-31 14:41:04.521914+10,14,1,423,correct
11353,"SELECT dwp.title, dwp.production_year, dwp.first_name, dwp.last_name
FROM
(SELECT *
FROM director natural join movie_award natural join person) AS dwp
WHERE dwp.award_name = 'BAFTA Film Award' and dwp.category = 'best film';",2018-08-31 14:41:11.634736+10,8,0,459,partially correct
11354,"SELECT dw.id, dw.first_name, dw.last_name
FROM (person p NATURAL JOIN director Natural JOIN writer) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 14:41:14.171699+10,4,1,268,correct
11355,"select production_year, count(*)
from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-31 14:41:24.634326+10,2,1,158,correct
11356,"SELECT COUNT(*)
FROM MOVIE;",2018-08-31 14:41:41.330997+10,11,0,325,partially correct
11357,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born)
			  FROM (SELECT *
			  	  FROM person
				  WHERE NOT EXISTS (SELECT MAX(year_born)
			  				   FROM person)));",2018-08-31 14:41:53.825326+10,3,0,454,partially correct
11358,;,2018-08-31 14:41:54.382093+10,15,0,423,noninterpretable
11359,"select id from director d, writer w
where d.id= w.id
and d.production_year=w.production_year
and d.title=w.title
and (select count(from ;",2018-08-31 14:42:17.576712+10,14,0,452,noninterpretable
11387,"with appinfo as(select r.id, count(*)
from role r, appearance ap
where r.title = ap.title
	and r.production_year = ap.production_year
	and lower(r.title) = 'psycho'
	and r.production_year = 1960
     and r.description = ap.description
group by r.id
having count(*) = 1 )
select appinfo.id
from appinfo;",2018-08-31 14:45:54.355051+10,10,1,340,correct
11442,"SELECT ma.title,ma.production_year,p.first_name,p.last_name FROM(
SELECT title,production_year FROM movie_award WHERE lower(award_name)='bafta film award' AND lower(category)='best film' AND
lower(result)='won'
)as ma, director d,person p WHERE ma.title=d.title AND ma.production_year=d.production_year AND d.id=p.id;",2018-08-31 14:53:50.943301+10,8,1,297,correct
11697,"select count(p.id) 
from person p
where exists(
	select w.id 
	from writer w
	where w.id = p.id
) and year_born = 1935;",2018-08-31 15:21:35.057489+10,1,1,66,correct
11360,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:42:43.410333+10,11,1,325,correct
11361,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:42:45.86164+10,14,1,452,correct
11362,"SELECT ID FROM PERSON 
Where year_born = (SELECT max(year_born) from person where year_born<(SELECT max(year_born) from person));
",2018-08-31 14:42:58.464664+10,3,1,198,correct
11363,"
select count(*)
from movie m
where m.title not in 
(select ma.title from movie_award ma where lower(ma.result) = 'won'
union
select ca.title from crew_award ca where lower(ca.result) = 'won'
union 
select da.title from director_award da where lower(da.result) = 'won'
union 
select wa.title from writer_award wa where lower(wa.result) = 'won'
union 
select aa.title from actor_award aa where lower(aa.result) = 'won') 
and m.production_year not in
(select ma.production_year from movie_award ma where lower(ma.result) = 'won' 
union 
select ca.production_year from crew_award ca where lower(ca.result) = 'won'
union 
select da.production_year from director_award da where lower(da.result) = 'won'
union 
select wa.production_year from writer_award wa where lower(wa.result) = 'won'
union 
select aa.production_year from actor_award aa where lower(aa.result) = 'won') ;

",2018-08-31 14:42:58.892126+10,11,0,170,partially correct
11364,;,2018-08-31 14:43:02.441012+10,15,0,452,noninterpretable
11365,"select count(*)
from writer_award w, person p
where w.id=p.id and lower(p.first_name)='woody' and lower(p.last_name)='allen' and lower(w.result)='won';",2018-08-31 14:43:03.421577+10,9,1,359,correct
11366,"
select max()
from writer w, director d, person p
where w.id = p.id and d.id = p.id
group by p.id
having max(p.id);",2018-08-31 14:43:06.898454+10,14,0,425,noninterpretable
11367,"select count(*)
from person
where not exists (select * from director where person.id= director.id);",2018-08-31 14:43:15.738757+10,12,1,158,correct
11368,"SELECT id, award_name, year_of_award, category
FROM director_award NATURAL JOIN director
WHERE lower(result) = 'nominated';
",2018-08-31 14:43:23.367643+10,13,1,450,correct
11369,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 14:43:29.476543+10,15,1,452,correct
11370,"select count(*) from movie m where not exists(
select * from movie_award ma, crew_award c,director_award d,writer_award w,actor_award a
where ma.title=c.title and c.title=d.title and d.title=w.title and w.title=a.title and
ma.production_year=c.production_year and c.production_year=d.production_year and d.production_year=w.production_year and w.production_year=a.production_year and m.title=ma.title and m.production_year=ma.production_year);",2018-08-31 14:43:39.071312+10,11,0,255,partially correct
11371,"SELECT dwp.title, dwp.production_year, dwp.first_name, dwp.last_name
FROM
(SELECT *
FROM director natural join movie_award natural join person) AS dwp
WHERE dwp.award_name = 'BAFTA Film Award' and dwp.category = 'best film' and dwp.result = 'won';",2018-08-31 14:43:47.046167+10,8,1,459,correct
11372,select count(p.id) from person p where exists (select w.id from writer w where w.id=p.id and p.year_born = 1935);,2018-08-31 14:43:47.269828+10,1,1,200,correct
11373,"SELECT dw.title, dw.production_year, p.first_name, p.last_name
FROM (SELECT * 
      FROM director d,movie_award m
      WHERE d.title = m.title
      AND d.production_year = m.production_year)AS dw, person p
WHERE dw.id = p.id
AND lower (dw.award_name) = 'bafta film award'
AND lower (dw.category) = 'best film'
AND lower (dw.RESULT) = 'won';",2018-08-31 14:43:47.305659+10,8,1,169,correct
11374,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 14:43:59.398251+10,15,1,278,correct
11375,"SELECT
    COUNT(award_name) 
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND RESULT = 'won'
    AND first_name= 'Woody'
    AND last_name= 'Allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 14:44:13.49155+10,9,1,161,correct
11376,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born)
			  FROM person
			  WHERE year_born < (SELECT MAX(year_born)
			  			    FROM person));",2018-08-31 14:44:16.941312+10,3,1,454,correct
11377,"SELECT person.id, first_name, last_name
FROM person, (SELECT director.id
FROM director, writer
WHERE director.id = writer.id) AS a
WHERE person.id = a.id
GROUP BY person.id;",2018-08-31 14:44:35.174318+10,4,0,251,partially correct
11378,"select id,first_name,last_name
from person
where year_born=(select max(year_born)
			from person);",2018-08-31 14:44:54.704994+10,7,1,432,correct
11379,"select id
from;",2018-08-31 14:44:55.608565+10,14,0,123,noninterpretable
11380,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year between 1991 AND 1993 
GROUP BY production_year;",2018-08-31 14:45:00.734089+10,2,1,318,correct
11381,"SELECT id from person

WHERE year_born =(SELECT MAX(year_born) from person);",2018-08-31 14:45:15.417022+10,3,0,453,partially correct
11382,select;,2018-08-31 14:45:17.399495+10,11,0,438,noninterpretable
11383,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id
AND lower (first_name) = 'Kevin'
AND lower (last_name) = 'Williamson';",2018-08-31 14:45:32.837978+10,5,0,23,partially correct
11384,"SELECT p.id, first_name, last_name, award_name, year_of_award, category
FROM person p, director d, director_award da
where p.id=d.id
AND d.title=da.title
AND d.production_year=da.production_year
AND NOT EXISTS(
SELECT *
FROM director_award da
WHERE lower(result)=""won""
AND d.title=da.title
AND d.production_year=da.production_year
);

",2018-08-31 14:45:48.734138+10,13,0,312,partially correct
11385,"SELECT COUNT(*)
FROM person p 
WHERE NOT EXISTS(
SELECT*FROM director d 
WHERE p.id=d.id);
",2018-08-31 14:45:49.847393+10,12,1,372,correct
11386,"select id
from person
where person.year_born=(select max(year_born) from person);",2018-08-31 14:45:52.323057+10,3,0,325,partially correct
11388,"SELECT distinct x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x);",2018-08-31 14:46:03.361616+10,14,1,293,correct
11389,"select TOP count(id)
from role
order by desc;",2018-08-31 14:46:29.456975+10,15,0,211,noninterpretable
11390,"select r.id
from role r, appearance ap
where r.title = ap.title
	and r.production_year = ap.production_year
	and lower(r.title) = 'psycho'
	and r.production_year = 1960
     and r.description = ap.description
group by r.id
having count(*) = 1;
",2018-08-31 14:46:39.179291+10,10,1,340,correct
11391,"SELECT m.production_year, count(*)
FROM MOVIE m
WHERE m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991
GROUP BY m.production_year;",2018-08-31 14:46:45.332938+10,2,1,455,correct
11392,"select r.id
from role r, appearance a
where lower(r.title)='psycho' and r.description=a.description
group by r.id
having count(*)=1;
   ",2018-08-31 14:46:47.583903+10,10,0,359,partially correct
11393,"with wond as(
select id, award_name, year_of_award, result
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and result = 'won'),
nomd as (
select id, award_name, year_of_award, result
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and result = 'nominated')
select id, award_name, year_of_award
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and id not in(select id from wond)
and id in( select id from nomd);",2018-08-31 14:46:57.066414+10,13,0,129,partially correct
11394,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:47:01.493258+10,14,1,425,correct
11395,"SELECT title, production-year
FROM (movie.title NATURAL JOIN director.title)
WHERE (SELECT );",2018-08-31 14:47:02.32499+10,5,0,268,noninterpretable
11396,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) FROM person WHERE year_born < (SELECT MAX(year_born)FROM person));",2018-08-31 14:47:07.440606+10,3,1,325,correct
11397,"SELECT p.id, award_name, year_of_award, category
FROM person p, director d, director_award da
where p.id=d.id
AND d.title=da.title
AND d.production_year=da.production_year
AND NOT EXISTS(
SELECT *
FROM director_award da
WHERE lower(result)=""won""
AND d.title=da.title
AND d.production_year=da.production_year
);

",2018-08-31 14:47:12.006123+10,13,1,312,correct
11398,"SELECT id from person

WHERE year_born =(SELECT MAX(year_born) FROM person
			WHERE year_born<(
				SELECT MAX(year_born) FROM person));",2018-08-31 14:47:20.395102+10,3,1,453,correct
11399,"with wond as(
select id, award_name, year_of_award, result
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and result = 'won'),
nomd as (
select id, award_name, year_of_award, result
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and result = 'nominated')
select id, award_name, year_of_award, category
from director, director_award
where director.title = director_award.title
and director.production_year = director_award.production_year
and id not in(select id from wond)
and id in( select id from nomd);",2018-08-31 14:47:28.907133+10,13,1,129,correct
11400,"select count(*)
from writer_award wa, writer w, person p
where wa.id=w.id and wa.title=w.title and wa.production_year=w.production_year
and p.id=wa.id and w.id=p.id
and p.first_name='Woody' and p.last_name='Allen'
and wa.year_of_award>=1991 and wa.year_of_award<=1995;",2018-08-31 14:47:45.126429+10,9,0,354,partially correct
11401,"select ra.id
from (role natrual join appearance) as ra
where lower(ra.title) = 'psycho'
and ra.production_year = 1960;",2018-08-31 14:47:45.703321+10,10,0,41,partially correct
11402,"select id,first_name,last_name
from person p
where exists (select *
		   from director natural join writer as dw
		   where p.id = dw.id
		   group by id
		   having count(*)>=2);",2018-08-31 14:48:06.860118+10,4,1,134,correct
11403,"select * 
from person;",2018-08-31 14:48:25.825663+10,15,0,425,partially correct
11404,"SELECT mw.title,mw.production_year FROM Movie_Award mw INNER JOIN (
SELECT * FROM Movie m INNER JOIN( SELECT * FROM Director d INNER JOIN Person p ON d.id=p.id )as bar ON 
bar.title=m.title AND bar.production_year=m.production_year



)as foo ON foo.title=mw.title AND foo.production_year
=mw.production_year WHERE lower(mw.title)='bafta film award' AND lower(mw.category)='best film';",2018-08-31 14:48:27.400558+10,8,0,297,partially correct
11405,"SELECT count(*) 
FROM
writer_award NATURAL JOIN person
WHERE year_of_award IN ('1991','1992','1993','1994','1995')
AND first_name = 'Woody' AND last_name = 'Allen';",2018-08-31 14:48:34.017422+10,9,0,459,partially correct
11406,select;,2018-08-31 14:49:01.781422+10,11,0,438,noninterpretable
11407,"with st as(
	select x1.id, count(*) as NoOfWorkedOn
	  from(
	  select *
	  from director
	  union
	  select w.id, w.title, w.production_year
	  from writer w) x1
	  group by x1.id)

select x.id
from st x
where x.NoOfWorkedOn = ( 
	select max(x2.NoOfWorkedOn)
	 from st x2);
",2018-08-31 14:49:04.037377+10,14,1,276,correct
11408,"SELECT PRODUCTION_YEAR, COUNT(*) AS NUMOFMOV
FROM MOVIE
WHERE PRODUCTION_YEAR = 1993
GROUP BY PRODUCRION_YEAR;",2018-08-31 14:49:12.043425+10,2,0,356,noninterpretable
11409,"SELECT count(*)
FROM movie AS m
WHERE NOT EXISTS(SELECT title,production_year
FROM movie_award AS ma
WHERE lower(ma.result)='won'AND ma.title=m.title AND m.production_year=ma.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:49:15.439805+10,11,1,217,correct
11410,"SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year=1993
UNION
SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year=1992
UNION
SELECT production_year,COUNT(*)
FROM MOVIE
WHERE production_year=1991;

",2018-08-31 14:49:17.536754+10,2,1,442,correct
11411,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id 
	AND lower(first_name) = 'kiven' 
	AND lower(last_name) = 'williamson';",2018-08-31 14:49:20.314817+10,5,0,268,partially correct
11412,"select count(*)
from writer_award wa, writer w, person p
where wa.id=w.id and wa.title=w.title and wa.production_year=w.production_year
and p.id=wa.id and w.id=p.id
and p.first_name='Woody' and p.last_name='Allen'
and wa.year_of_award>=1991 and wa.year_of_award<=1995
and wa.result='won';",2018-08-31 14:49:22.87101+10,9,1,354,correct
11413,"SELECT count(*) 
FROM
writer_award NATURAL JOIN person
WHERE year_of_award IN ('1991','1992','1993','1994','1995')
AND result = 'won' AND first_name = 'Woody' AND last_name = 'Allen';
",2018-08-31 14:49:28.71164+10,9,1,459,correct
11855,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE p.year_born >= (SELECT max(year_born)
					FROM PERSON);",2018-08-31 15:35:58.681545+10,7,1,455,correct
11414,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:49:29.182636+10,11,1,438,correct
11415,"SELECT DISTINCT id, first_name, last_name FROM
(SELECT person.*,movie.*,writer.*,director.* FROM person, movie, writer, director
WHERE writer.id=person.id AND movie.title=director.title AND director.production_year=movie.production_year AND
writer.id=director.id);
",2018-08-31 14:49:50.102351+10,4,0,393,partially correct
11416,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 14:49:53.899201+10,10,1,41,correct
11417,"select title, production_year,first_name,last_name
from  movie_award natural join director natural join person
where lower(award_name)='bafta film award' and lower(category)='best film';",2018-08-31 14:50:04.483893+10,8,0,432,partially correct
11418,"select r.id
from role r, appearance a
where lower(r.title)='psycho' and r.description=a.description and r.production_year=a.production_year and a.title=r.title and r.production_year=1960
group by r.id
having count(*)=1;
   ",2018-08-31 14:50:13.906677+10,10,1,359,correct
11419,"select count(*)
from movie
where title not in (
	select title
	from (movie_award outer join crew_award outer join director_award outer join writer_award outer join actor_award)
;",2018-08-31 14:50:18.266706+10,11,0,211,noninterpretable
11420,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id 
	AND lower(first_name) = 'kevin' 
	AND lower(last_name) = 'williamson';",2018-08-31 14:50:21.495552+10,5,1,268,correct
11421,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, director d, person p
where p.id = d.id
	and lower(ma.award_name) = 'bafta film award'
	and lower(ma.category) = 'best film'
	and lower(ma.result) = 'won'
	and ma.title = d.title
	and ma.production_year = d.production_year;",2018-08-31 14:50:34.389486+10,8,1,136,correct
11422,"SELECT p.id,p.first_name,p.last_name
FROM person p, writer NATURAL JOIN director AS dw 
WHERE p.id=dw.id
GROUP BY p.id 
HAVING COUNT(*)>1;
",2018-08-31 14:50:37.923626+10,4,0,372,partially correct
11423,;,2018-08-31 14:50:42.964611+10,11,0,457,noninterpretable
11424,"SELECT person.id, first_name, last_name
FROM person, (SELECT director.id
FROM director, writer
WHERE director.id = writer.id) AS a
WHERE person.id = a.id
GROUP BY person.id
HAVING COUNT() > 1;",2018-08-31 14:50:57.566177+10,4,0,251,partially correct
11425,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, ROLE r,
(SELECT id, count(*) AS number_of_roles
 FROM ROLE
 GROUP BY id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT max(number_of_roles)
        FROM ( 
		SELECT id, count ( * ) AS number_of_roles
           FROM ROLE
           GROUP BY id) AS a );",2018-08-31 14:51:00.463861+10,15,1,425,correct
11426,"SELECT m.production_year, COUNT(*)
FROM MOVIE m
WHERE m.production_year =1993 OR m.production_year =1992 OR m.production_year =1991
GROUP BY m.production_year;",2018-08-31 14:51:14.261361+10,2,1,451,correct
11427,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id = p.id
AND lower (first_name) = 'kevin'
AND lower (last_name) = 'williamson';",2018-08-31 14:51:16.305445+10,5,1,23,correct
11428,"SELECT count(*)
FROM PERSON p
WHERE NOT EXISTS (SELECT d.*
                               FROM DIRECTOR d
					WHERE p.id = d.id);",2018-08-31 14:51:27.53741+10,12,1,455,correct
11429,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r,(select p.id,count(title) c from person p,role r where p.id=r.id group by p.id) as a
where p.id=r.id and r.id=a.id
and a.c= (select max(c) from (select p.id,count(title) c from person p,role r where p.id=r.id group by p.id) as a);",2018-08-31 14:51:41.464673+10,15,1,216,correct
11430,"select p.id
from person p
where p.year_born = (select max(p1.year_born)
				from person p1
				where p1.year_born < (select max(p2.year_born)
									from person p2));",2018-08-31 14:51:44.478319+10,3,1,340,correct
11431," select person.id, first_name, last_name
from person, (select writer.id from director, writer 
where director.id=writer.id
and director.title=writer.title
and director.production_year=writer.production_year
group by writer.id
having count(writer.id)>1) as h
where person.id=h.id;",2018-08-31 14:51:53.353121+10,4,1,140,correct
11432,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS (SELECT *
FROM DIRECTOR
WHERE DIRECTOR.id = person.id);",2018-08-31 14:52:02.629988+10,12,1,356,correct
11433,"SELECT p.id,p.first_name,p.last_name
FROM (person p NATURAL JOIN writer NATURAL JOIN director) AS dw 
WHERE p.id=dw.id
GROUP BY p.id 
HAVING COUNT(*)>1;
",2018-08-31 14:52:12.80551+10,4,1,372,correct
11434,"with x as
(select *
from person 
where year_born <(select max(year_born) from person))


select id
from person
where year_born = (select max(year_born) from x);
",2018-08-31 14:52:16.235699+10,3,1,170,correct
11435,"select md.title, md.production_year,first_name,last_name
from  (movie_award left join director on movie_award.title=director.title left join person on person.id=director.id) as md
where lower(award_name)='bafta film award' and lower(category)='best film';",2018-08-31 14:52:30.91858+10,8,0,432,partially correct
11436,"select ma.title, ma.production_year, p.first_name, p.last_name from
(select title, production_year from movie_award ma where lower(award_name)='bafta film award'
and lower(category)='best film' and lower(result)='won') as ma, director d, person p where ma.title=d.title and ma.production_year=d.production_year and p.id=d.id;",2018-08-31 14:52:37.212629+10,8,1,430,correct
11437,;,2018-08-31 14:52:47.7493+10,3,0,211,noninterpretable
11438,"
select id , scene_no from
role r join Appearance  a on
a.title = r.title
and a.production_year =r.production_year
and a.description = r.description
where a.title = 'Psycho'
group by id, scene_no
having count(*) = 1;




",2018-08-31 14:53:22.045766+10,10,0,449,partially correct
11439,SELECT FROM person p;,2018-08-31 14:53:30.728047+10,3,0,115,noninterpretable
11440,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:53:34.325117+10,11,1,457,correct
11441,"SELECT ID, award_name, year_of_award, category from director d, director_award da
where d.title=da.title and d.production_year=da.production_year
AND lower(result)='nominated'
AND Lower(result)<>'won';",2018-08-31 14:53:47.649706+10,13,1,198,correct
11856,"SELECT COUNT(*)
FROM movie;",2018-08-31 15:36:06.686008+10,11,0,169,partially correct
11443,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 14:53:52.451747+10,14,1,456,correct
11444,"SELECT *
FROM PERSON;",2018-08-31 14:53:53.477554+10,4,0,356,partially correct
11445,"select p.id,p.first_name,p.last_name
from person as p, director as d, writer as w
where p.id=d.id
and d.id=w.id
and d.title=w.title
and d.production_year=w.production_year
group by p.id
having count(*)>1;",2018-08-31 14:54:06.014568+10,4,1,158,correct
11446,"SELECT country
FROM restriction r
WHERE lower(r.title) = 'M';",2018-08-31 14:54:19.819781+10,6,0,268,partially correct
11447,"select id,award_name, year_of_award, category
from director_award NATURAL JOIN director
where lower(result)='nominated';",2018-08-31 14:54:19.975422+10,13,1,325,correct
11448,"select id, year_born from person
where year_born = select min(year_born and yeara_born<1992) from person);",2018-08-31 14:54:22.334593+10,3,0,438,noninterpretable
11449,"SELECT country
FROM restriction
WHERE lower(title) = 'shakespeare in love' AND description = 'M';",2018-08-31 14:54:22.845588+10,6,1,23,correct
11450,"
SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:54:46.302277+10,11,1,377,correct
11451,"SELECT DISTINCT m.id
FROM ((SELECT id FROM movie NATURAL JOIN director)
UNION (SELECT id FROM movie NATURAL JOIN writer)) m;",2018-08-31 14:55:13.80316+10,14,0,450,noninterpretable
11452,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE EXISTS (SELECT *
				FROM WRITER w INNER JOIN DIRECTOR d
				WHERE w.id = d.id AND w.title = d.title);",2018-08-31 14:55:23.309556+10,4,0,455,partially correct
11453,"SELECT country
FROM restriction r
WHERE lower(r.title) = 'M' AND lower(r.title) = 'shakespeare in love';",2018-08-31 14:55:26.677915+10,6,0,268,partially correct
11454,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE EXISTS (SELECT *
				FROM WRITER w INNER JOIN DIRECTOR d
				WHERE w.id = d.id AND w.title = d.title);",2018-08-31 14:55:30.821209+10,4,0,455,partially correct
11455,"select count (*) from ( select title , production_year from movie m where  m.production_year ='1993' or  m.production_year ='1992' or  m.production_year ='1991' ) as value; ",2018-08-31 14:55:31.160194+10,2,0,412,partially correct
11456,"with sub as (
select id, count(*) as num
from  role 
group by id
)

select first_name, last_name, title, production_year, description
from sub natural join person p natural join role r
where sub.id = p.id and p.id = r.id and 
num = (select max(num) from sub);

",2018-08-31 14:55:31.839509+10,15,1,125,correct
11457,"with temp as 
(
select id,count(*) as c
from
(select id, title, production_year from writer UNION select id,title,production_year from director) as wd
group by id
)

select person.id
from person,temp,(select temp.id,max(c) as mc from temp group by temp.id order by mc desc limit 1)as temp2
where person.id=temp.id
and temp.c=temp2.mc;",2018-08-31 14:55:35.742351+10,14,1,85,correct
11458,"SELECT COUNT(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT * FROM DIRECTOR d WHERE d.id = p.id);",2018-08-31 14:56:04.716612+10,12,1,451,correct
11459,"SELECT ID, award_name, year_of_award, category from director d, director_award da
where d.title=da.title and d.production_year=da.production_year
AND lower(result)='nominated'
AND ID not in (SELECT ID from director d, director_award da
where d.title=da.title and d.production_year=da.production_year
AND lower(result)='won');",2018-08-31 14:56:08.256923+10,13,1,198,correct
11460,"SELECT country
FROM restriction r
WHERE lower(r.description) = 'm' AND lower(r.title) = 'shakespeare in love';",2018-08-31 14:56:13.093001+10,6,1,268,correct
11461,"select md.title, md.production_year,first_name,last_name
from  (movie_award left join director on movie_award.title=director.title and movie_award.production_year=director.production_year left join person on person.id=director.id) as md
where lower(award_name)='bafta film award' and lower(category)='best film';",2018-08-31 14:56:13.139095+10,8,0,432,partially correct
11462,"SELECT COUNT(*)
FROM writer_award wa
WHERE EXISTS (SELECT * 
              FROM person p
              WHERE p.id = wa.id
              AND lower(p.first_name) = 'woody'
              AND lower(p.last_name) = 'allen'
              AND wa.year_of_award <= 1995
              AND wa.year_of_award >= 1991);",2018-08-31 14:56:13.625801+10,9,0,169,partially correct
11463,"SELECT DIRECTOR.id, DIRECTOR_AWARD.award_name, DIRECTOR_AWARD.year_of_award, DIRECTOR_AWARD.category
FROM DIRECTOR_AWARD LEFT JOIN DIRECTOR ON DIRECTOR_AWARD.title=DIRECTOR.title 
and DIRECTOR_AWARD.production_year=DIRECTOR.production_year
where DIRECTOR.id NOT IN ( SELECT DIRECTOR.id 
                           from DIRECTOR_AWARD LEFT JOIN DIRECTOR ON DIRECTOR_AWARD.title=DIRECTOR.title 
                           and DIRECTOR_AWARD.production_year=DIRECTOR.production_year
                           WHERE lower(DIRECTOR_AWARD.result)=""won"");",2018-08-31 14:56:14.700314+10,13,1,139,correct
11464,"select p.first_name,p.last_name,r.title,r.production_year and r.description
from person p,role r,
(select r.id,count(*)as number from role r group by r.id)as x
where x.number = (select max(x2.number)from (select r.id,count(*)as number from role r group by r.id)as x2)
and p.id=r.id;
",2018-08-31 14:56:16.529744+10,15,0,293,partially correct
11465,"SELECT DISTINCT id, first_name, last_name FROM
(SELECT person.*,movie.*,writer.*,director.* FROM person, movie, writer, director
WHERE writer.id=person.id AND movie.title=director.title AND director.production_year=movie.production_year AND
writer.id=director.id) AS dw
GROUP BY dw.id
HAVING COUNT(dw.id)>=2;
",2018-08-31 14:56:17.923454+10,4,0,393,partially correct
11466,"SELECT a.id, a.first_name, a.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS a
GROUP BY a.id
HAVING COUNT()>1;",2018-08-31 14:56:37.023526+10,4,1,251,correct
11467,;,2018-08-31 14:56:40.39412+10,3,0,217,noninterpretable
11468,"SELECT DISTINCT id, first_name, last_name FROM
(SELECT person.*,movie.*,writer.*,director.* FROM person, movie, writer, director
WHERE writer.id=person.id AND movie.title=director.title AND director.production_year=movie.production_year AND
writer.id=director.id) AS dw
GROUP BY dw.id
HAVING COUNT(dw.id)>=2;
",2018-08-31 14:56:40.419614+10,4,0,393,partially correct
11469,"select count(*)
from writer_award wa, writer w, person p
where wa.id = w.id
	and wa.title = w.title
	and wa.production_year = w.production_year
	and w.id = p.id
	and lower(p.first_name) = 'woody'
	and lower(p.last_name) = 'allen'
	and wa.production_year >= 1991 and wa.production_year <= 1995;",2018-08-31 14:56:47.318305+10,9,1,136,correct
11470,"select count (*)
from PERSON 
where exists (select * from WRITER where  PERSON.id = WRITER.id and PERSON.year_born =1935  );",2018-08-31 14:56:52.419608+10,1,1,189,correct
11471,"select ma.title, ma.production_year, p.first_name, p.last_name
from director d natural join person p natural join movie_award ma
on d.id=p.id and d.title=ma.title
where ma.award_name = ""BAFTA Film Award"" and ma.category=""Best Film"";",2018-08-31 14:57:02.457977+10,8,0,196,noninterpretable
11472,"SELECT d.id, award_name, year_of_award, category
FROM director d INNER JOIN director_award da ON d.title = da.title
WHERE result = 'nominated';",2018-08-31 14:57:15.379637+10,13,1,454,correct
11473,;,2018-08-31 14:57:20.959054+10,3,0,457,noninterpretable
11474,"select rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description
from (role natural join person) as rp
where rp.id = ( select id from(
    select max(r.rolenumbers), r.id
    from (
        select count(*) as rolenumbers, id
        from role
        group by id
        ) as r)
);",2018-08-31 14:57:34.526573+10,15,1,286,correct
11475,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));
",2018-08-31 14:57:42.641848+10,3,1,438,correct
11476,"select p.first_name,p.last_name,r.title,r.production_year and r.description
from person p,role r,
(select r.id,count(*)as number from role r group by r.id)as x
where x.number = (select max(x2.number)from (select r.id,count(*)as number from role r group by r.id)as x2)
and p.id=r.id and p.id=x.id;
",2018-08-31 14:57:49.538508+10,15,0,293,partially correct
11477,"select * 
from movie mov,
 movie_award ma,
 crew_award ca,
 director_award da,
 writer_award wa,
 actor_award aa
where mov.title = ma.title
and mov.title = ca.title
and mov.title = da.title
and mov.title = wa.title
and mov.title = aa.title
and ma.result != 'won'
and ca.result != 'won'
and da.result != 'won'
and wa.result != 'won'
and aa.result != 'won';",2018-08-31 14:57:52.929743+10,11,0,358,partially correct
11478,"WITH dt AS
(SELECT d.id, d.title, d.production_year FROM director d UNION SELECT w.id, w.title, w.production_year FROM writer w)

SELECT p.id
FROM person p, dt
WHERE p.id=dt.id
GROUP BY p.id HAVING COUNT(*)=(SELECT MAX(number)
FROM (SELECT p.id, COUNT(*) AS number
FROM person p,  dt
WHERE p.id=dt.id
GROUP BY p.id));",2018-08-31 14:58:03.058615+10,14,1,439,correct
11479,"select count(*)
from movie
where not exists (select title, production_year from movie_award where lower(result) = 'won') ;",2018-08-31 14:58:05.150002+10,11,0,41,partially correct
11480,"SELECT DISTINCT id, first_name, last_name FROM
(SELECT person.*,movie.*,writer.*,director.* FROM person, movie, writer, director
WHERE writer.id=person.id AND movie.title=director.title AND director.production_year=movie.production_year AND
writer.id=director.id) AS dw
GROUP BY dw.id
HAVING COUNT(dw.id)>1;
",2018-08-31 14:58:05.628257+10,4,0,393,partially correct
11481,"SELECT TITLE, PRODUCTION_YEAR
FROM WRITER
WHERE EXISTS (SELECT *
FROM PERSON
WHERE PEROSON.ID = WRITER.ID
AND FIRST_NAME = 'KEVIN'
AND LAST_NAME = 'WILLIAMSON');",2018-08-31 14:58:05.987271+10,5,0,356,noninterpretable
11482,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );
",2018-08-31 14:58:06.589451+10,13,1,454,correct
11483,"
select id from
role r join Appearance  a on
a.title = r.title
and a.production_year =r.production_year
and a.description = r.description
where a.title = 'Psycho'
and r.production_year = ""1960""
group by id 
having count(*) = 1;






",2018-08-31 14:58:11.202768+10,10,1,449,correct
11484,"SELECT p.id FROM APPEARANCE a, PERSON p WHERE
title = 'Psycho' AND scene_no = 1 AND production_year = 1960
AND a.descritpion = p.last_name;",2018-08-31 14:58:16.687996+10,10,0,161,noninterpretable
11485,"select title, production_year
from writer as w, person as p
where p.id= w.id
and lower(p.first_name)='kevin'
and lower(p.last_name)='williamson'
;",2018-08-31 14:58:24.08481+10,5,1,158,correct
11486,"SELECT id,first_name,last_name
FROM person p
WHERE  MAX(p.year_born);",2018-08-31 14:58:27.084603+10,7,0,268,noninterpretable
11487,"select id,award_name,year_of_award,category
from director natural join director_award
where result!='won';",2018-08-31 14:58:37.882728+10,13,1,85,correct
11488,"select *
from role;",2018-08-31 14:58:45.877839+10,15,0,276,partially correct
11489,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 14:58:56.782093+10,11,1,41,correct
11490,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 14:58:57.31043+10,3,1,457,correct
11491,;,2018-08-31 14:58:58.041503+10,14,0,286,noninterpretable
11492,SELECT FROM person p;,2018-08-31 14:58:58.329511+10,13,0,115,noninterpretable
11493,"SELECT id FROM (SELECT p.id,p.year_born FROM PERSON p GROUP BY p.id HAVING p.year_born > (SELECT MIN(year_born) FROM PERSON)) AS w; ",2018-08-31 14:59:02.119322+10,3,0,404,partially correct
11494,"select count (*)
from movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
where not exists(select title from ma where result = 'won'
                 union
			  select title from ca where result = 'won' 
			  union
			  select title from da where result = 'won'
			  union
			  select title from wa where result = 'won'
			  union
			  select title from aa where result = 'won'); ",2018-08-31 14:59:09.285473+10,11,0,225,noninterpretable
11495,"select p.first_name,p.last_name,r.title,r.production_year and r.description
from person p,role r,
(select r.id,count(*)as number from role r group by r.id)as x
where x.number in (select max(x2.number)from (select r.id,count(*)as number from role r group by r.id)as x2)
and p.id=r.id and p.id=x.id;
",2018-08-31 14:59:14.721316+10,15,0,293,partially correct
11496,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM person p
INNER JOIN director d ON p.id = d.id
INNER JOIN movie_award ma ON d.title = ma.title
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film' AND
      lower(result) = 'won';",2018-08-31 14:59:26.183527+10,8,1,144,correct
11497,"SELECT id,first_name,last_name
FROM person p
WHERE  p.year_born = (SELECT max(year_born)
				FROM person);",2018-08-31 14:59:28.199059+10,7,1,268,correct
11498,"SELECT COUNT(*)
FROM         (SELECT * 
              FROM writer w, writer_award wa
              WHERE w.id = wa.id
              AND wa.year_of_award <= 1995
              AND wa.year_of_award >= 1991)AS wwa, person p
WHERE p.id = wwa.id
AND lower(p.first_name) = 'woody'
AND lower(p.last_name) = 'allen';",2018-08-31 14:59:37.349188+10,9,0,169,partially correct
11499,"SELECT DISTINCT id, first_name, last_name FROM
(person NATURAL JOIN writer NATURAL JOIN director) AS dw
GROUP BY dw.id
HAVING COUNT(dw.id)>1;
",2018-08-31 14:59:49.944711+10,4,1,393,correct
11500,"select count(*) from PERSON
where year_born = 1935;",2018-08-31 14:59:51.598515+10,1,0,245,partially correct
11501,"SELECT id, award_name, year_of_award, category
FROM director d
INNER JOIN director_award da ON d.title = da.title
WHERE result != 'won' and result = 'nominated';",2018-08-31 14:59:51.890933+10,13,1,144,correct
11502,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person);
",2018-08-31 15:00:01.535583+10,7,1,23,correct
11503,"select p.first_name,p.last_name,r.title,r.production_year, r.description
from person p,role r,
(select r.id,count(*)as number from role r group by r.id)as x
where x.number in (select max(x2.number)from (select r.id,count(*)as number from role r group by r.id)as x2)
and p.id=r.id and p.id=x.id;
",2018-08-31 15:00:04.93244+10,15,1,293,correct
11580,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p, role r
WHERE p.id=r.id
GROUP BY r.id HAVING COUNT(*)=(SELECT MAX(number)FROM (SELECT r.id, COUNT(*) AS number FROM role r GROUP BY r.id ));",2018-08-31 15:09:21.704359+10,15,0,439,partially correct
11504,"SELECT first_name, last_name, title, production_year, description
FROM (PERSON p INNER JOIN ROLE r ON p.id = r.id) as pr,
	(SELECT id, COUNT(*) AS NumberOfRoles
	FROM ROLE
	GROUP BY id) as a
WHERE pr.id = a.id AND
	a.NumberOfRoles = (
	SELECT MAX(b.NumberOfRoles)
	FROM (
		SELECT id, COUNT(*) as NumberOfRoles
		FROM ROLE
		GROUP BY id) as b
	)
;",2018-08-31 15:00:21.045718+10,15,1,423,correct
11505,"select p.id
from person p
where p.year_born = (
	select max(year_born)
	from person
	where year_born < (
		select max(year_born)
		from person
		)
	)
;",2018-08-31 15:00:25.969307+10,3,1,211,correct
11506,"SELECT id FROM (SELECT p.id,MIN(p.year_born) FROM PERSON p GROUP BY p.id HAVING p.year_born > (SELECT MIN(year_born) FROM PERSON)) AS w; ",2018-08-31 15:00:31.213539+10,3,0,404,partially correct
11507,"select p.id,da.award_name,da.year_of_award,da.category
from person p, director d, director_award da 
where da.title = d.title
and da.production_year = d.production_year
and da.result = 'nominated'
group by da.title
having count(*) > 1;",2018-08-31 15:00:32.833582+10,13,0,130,partially correct
11508,"SELECT count(*) FROM
(SELECT p.id FROM person p,writer w WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen')as foo,writer_award as wa
WHERE wa.year_of_award>='1991' AND wa.year_of_award<'1996' AND foo.id=wa.id
;",2018-08-31 15:00:37.269493+10,9,0,297,partially correct
11509,"with plist as (
select * from director
union
select id, title, production_year from writer order by id )

select id from plist
group by id
having count(id) = (
select max(tid) from (
select count(id) as tid from plist 
group by id));",2018-08-31 15:00:37.457781+10,14,1,129,correct
11510,SELECT;,2018-08-31 15:00:48.095765+10,11,0,224,noninterpretable
11511,"select count(*)
from writer_award left join person on writer_award.id=person.id
where year_of_award<1996 and year_of_award>1990 and lower(first_name)=""woody"" and lower(last_name)=""allen"" AND lower(RESULT)= 'won';",2018-08-31 15:01:06.905868+10,9,1,432,correct
11512,"select p.id
from person p,director d,writer w
where p.id=d.id
and p.id=w.id;",2018-08-31 15:01:07.212097+10,14,0,325,partially correct
11513,"SELECT COUNTRY
FROM RESTRICTION
WHERE TITLT = 'SHAKESPACE OF LOVE'
AND DESCRIPTION = 'M';",2018-08-31 15:01:10.596406+10,6,0,356,noninterpretable
11514,"SELECT count(*) FROM
(SELECT * FROM person p,writer w WHERE lower(p.first_name)='woody' AND lower(p.last_name)='allen')as foo,writer_award as wa
WHERE wa.year_of_award>='1991' AND wa.year_of_award<'1996' AND lower(p.first_name)='woody' AND lower(p.last_name)='allen'
;",2018-08-31 15:01:12.599841+10,9,0,297,noninterpretable
11515,"select country 
from restriction
where lower(title)='shakespeare in love'
and lower(description)='m';",2018-08-31 15:01:16.495958+10,6,1,158,correct
11516,"select id from person order by year_born desc limit 1,1;",2018-08-31 15:01:16.939077+10,3,1,255,correct
11517,"select count(*) from person p
where p.id=
(SELECT w.id FROM  writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 15:01:35.35257+10,1,1,18,correct
11518,"SELECT id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(year_born)
FROM person));",2018-08-31 15:01:43.637243+10,3,1,217,correct
11519,"select d.id, da.award_name, da.year_of_award, da.category from director d, director_award da
where d.title=da.title and da.result='nominated';",2018-08-31 15:01:47.223318+10,13,1,438,correct
11520,"select da.id,da.award_name,da.year_of_award, da.category
from (director inner join director_award using(title, production_year)) as da
where lower(da.result) = 'nominated'
and da.id not in (select id
				from director inner join director_award using(title, production_year)
				where lower(result)= 'won');",2018-08-31 15:01:56.64568+10,13,1,340,correct
11521,"select p.id,da.award_name,da.year_of_award,da.category
from person p, director d, director_award da 
where da.title = d.title
and da.production_year = d.production_year
and d.id = p.id
and da.result = 'nominated'
group by p.id
having count(*)>=1;",2018-08-31 15:02:11.859656+10,13,1,130,correct
11522,"SELECT p.id, p.first_name, p.last_name 
FROM person p ,director d, writer w
where p.id=d.id
and d.id=w.id
and p.id=w.id
and d.title=w.title
and d.production_year=w.production_year
GROUP BY d.id 
HAVING count(*) > 1;",2018-08-31 15:02:26.299362+10,4,1,452,correct
11523,"SELECT id FROM (SELECT p.id,MAX(p.year_born) FROM PERSON p GROUP BY p.id HAVING p.year_born < (SELECT MAX(year_born) FROM PERSON)) AS w;",2018-08-31 15:02:28.250104+10,3,0,404,partially correct
11524,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:02:33.23942+10,11,1,224,correct
11525,"select da.id,da.award_name,da.year_of_award,da.category
from (director natural join director_award)as da
where lower(da.result)='nominated'
	and da.id not in(select d.id
				from(director natural join director_award)as d
				where lower(d.result)='won');",2018-08-31 15:03:00.015166+10,13,1,149,correct
11526,"select x.id 
from
(select x1.id ,count(*) as abc
from
(select d.id, title, production_year from director d
union 
select w.id , title ,production_year from writer w)  x1
group by x1.id) x
where x.abc = (select max(x.abc) 
from
(select x1.id ,count(*) as abc
from
(select d.id, title, production_year from director d
union 
select w.id , title ,production_year from writer w)  x1
group by x1.id) x);",2018-08-31 15:03:02.914312+10,14,1,229,correct
11527,"SELECT ra.id
FROM (role r NATURAL JOIN appearance a) AS ra
WHERE lower(ra.title) = 'psycho' AND ra.production_year = 1960
GROUP BY ra.id
HAVING count(*)=1;",2018-08-31 15:03:03.405867+10,10,1,373,correct
11528,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 15:03:04.870019+10,4,1,260,correct
11529,"select production_year, count (*)
from MOVIE 
where (production_year >= 1991 and production_year<=1993)
group by production_year;",2018-08-31 15:03:11.775229+10,2,1,189,correct
11530,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YEAR_BORN)
FROM PERSON;",2018-08-31 15:03:17.33494+10,7,0,356,partially correct
11531,"SELECT count(*)
FROM writer_award
WHERE year_of_award >= 1991 
AND year_of_award<=1995
AND lower(result)= 'won'
AND id =
(
	SELECT id FROM person
	WHERE lower(first_name) = 'woody' AND lower(last_name)='allen'
)
GROUP BY ID;",2018-08-31 15:03:22.457533+10,9,1,173,correct
11532,"select r.id
from appearance a, scene s, role r
where a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-31 15:03:28.983726+10,10,1,136,correct
11533,"SELECT w.id,w.title 
FROM writer w , person p
WHERE w.id=p.id
AND p.first_name='Kevin'
AND p.last_name='Williamson';
",2018-08-31 15:03:40.684211+10,5,0,372,partially correct
11534,;,2018-08-31 15:03:43.517621+10,13,0,217,noninterpretable
11535,"SELECT COUNT(id)
FROM PERSON
WHERE NOT EXISTS (SELECT p.id FROM PERSON p INNER JOIN DIRECTOR d ON p.id=d.id);",2018-08-31 15:03:45.51061+10,12,0,442,partially correct
11536,"Select title, production_year, first_name, last_name
From movie_award ma natural join person natural join director
Where lower(ma.category)= 'best film'
And lower(ma.result)= 'won'
And lower(ma.award_name)= 'bafta film award';

",2018-08-31 15:03:54.742234+10,8,1,77,correct
11537,;,2018-08-31 15:04:26.056252+10,11,0,443,noninterpretable
11538,"SELECT w.title,w.production_year
FROM writer w , person p
WHERE w.id=p.id
AND p.first_name='Kevin'
AND p.last_name='Williamson';
",2018-08-31 15:04:26.810244+10,5,1,372,correct
11539,"select id
from role r,
scene s,
appearance a
where lower(r.title)='psycho'
and r.production_year=1960
and a.title=s.title
and a.title=r.title

and r.production_year=a.production_year
and r.production_year=s.production_year


and r.description=a.description
and s.scene_no=a.scene_no

group by id
having count(*)=1;",2018-08-31 15:04:31.991138+10,10,1,377,correct
11540,"select p.id,p.first_name,p.last_name from person p 
where p.id = (
select w.id from writer w inner join director group by w.id having count(*) >=2); ",2018-08-31 15:04:41.608266+10,4,0,367,partially correct
11541,"SELECT mw.title, mw.production_year FROM
(person NATURAL JOIN writer NATURAL JOIN movie) AS mw
WHERE mw.first_name='Kevin' AND mw.last_name='Williamson';",2018-08-31 15:04:58.902847+10,5,1,393,correct
11542,"select role.id
from role natural join (select count(*), title, production_year, description 
from appearance
where title='Psycho' and production_year='1960'
group by title, production_year, description
having count(*)=1) as h;
",2018-08-31 15:05:12.697669+10,10,1,354,correct
11543,"SELECT title, production_year
FROM movie m
WHERE (SELECT title
	FROM movie_award ma
	WHERE lower(ma.award_name) = 'bafit film award'
		AND ma.result = 'yes' );",2018-08-31 15:05:37.235554+10,8,0,268,partially correct
11544,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:05:40.76376+10,14,1,325,correct
11545,SELECT FROM person p;,2018-08-31 15:05:56.258267+10,14,0,115,noninterpretable
11546,"SELECT id
FROM
(person natural join role natural join appearance) AS pra
WHERE title = 'Psycho' AND production_year = '1960'
ORDER BY scene_no;",2018-08-31 15:05:57.353621+10,10,0,459,partially correct
11547,"SELECT DISTINCT d.id, p.first_name, p.last_name
FROM DIRECTOR d INNER JOIN PERSON p ON d.id = p.id
WHERE EXISTS(SELECT COUNT(*) FROM WRITER w WHERE w.id = d.id GROUP BY w.id HAVING COUNT(*) > 1);",2018-08-31 15:06:02.479229+10,4,1,451,correct
11548,"SELECT r.id
FROM role r,
(SELECT a.title='Psycho', a.production_year=1960 FROM appearance a, WHERE a.title='Psycho' a.AND production_year=1960 AND a.scene_no=1) AS scene_no1
WHERE r.title=scene_no1.title AND r.production_year=scene_no1.production_year;",2018-08-31 15:06:03.885338+10,10,0,441,noninterpretable
11549,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p
      WHERE w.id = p.id
      AND lower(p.first_name) = 'woody'
      AND lower(p.last_name) = 'allen')AS wp, writer_award wa
WHERE wa.id = wp.id
AND wa.year_of_award <= 1995
AND wa.year_of_award >= 1991;",2018-08-31 15:06:04.177796+10,9,0,169,partially correct
11550,"SELECT count(*) FROM writer w,writer_award wa,person p
WHERE 
wa.title=w.title AND
wa.production_year=w.production_year AND
wa.id=w.id AND
w.id=p.id AND
lower(p.first_name)='woody' 
AND lower(p.last_name)='allen' AND
lower(result)='won' AND
wa.year_of_award>='1991' AND wa.year_of_award<'1996';
",2018-08-31 15:06:06.236114+10,9,1,297,correct
11551,SELECT FROM person p;,2018-08-31 15:06:06.483638+10,14,0,115,noninterpretable
11552,;,2018-08-31 15:06:15.312562+10,4,0,90,noninterpretable
11553,gchfgh;,2018-08-31 15:06:16.934667+10,11,0,267,noninterpretable
11554,dfgdh;,2018-08-31 15:06:32.76866+10,3,0,267,noninterpretable
11555,"select id
from role r,
scene s,
appearance a
where lower(r.title)='psycho'
and r.production_year=1960
and a.title=s.title
and a.title=r.title

and r.production_year=a.production_year
and r.production_year=s.production_year


and r.description=a.description
and s.scene_no=a.scene_no

group by id
having count(*)=1;",2018-08-31 15:06:33.763519+10,10,1,377,correct
11556,yuikyu;,2018-08-31 15:06:37.989573+10,13,0,267,noninterpretable
11557,yoyuo;,2018-08-31 15:06:43.765924+10,14,0,267,noninterpretable
11558,ulil;,2018-08-31 15:06:49.371936+10,15,0,267,noninterpretable
11559,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:06:57.097395+10,10,0,432,partially correct
11560,"select d.id,da.award_name,da.year_of_award,da.category from director d,director_award as da where lower(da.result)='nominated' and d.title=da.title and d.production_year=da.production_year;",2018-08-31 15:07:10.862636+10,13,1,255,correct
11561,"select count(*) 
from writer,person
where writer.id=person.id and person.year_born =1935;",2018-08-31 15:07:23.126324+10,1,0,192,partially correct
11562,SELECT;,2018-08-31 15:07:24.291115+10,3,0,224,noninterpretable
11563,"SELECT TITLE, PRO_YEAR FIRST_NAME, LAST_NAME
FROM MOVIE_AWARD, PERSON
WHERE AWARD_NAME = 'BAFTA FILM AWARD'
AND EXISTS (SELECT * 
FROM DIRECTOR);",2018-08-31 15:07:28.97774+10,8,0,356,noninterpretable
11564,"select r.id
from role r,
     appearance a,
     scene s
where lower(r.title)='psycho' 
       and r.production_year=1960
       and a.title=r.title 
       and r.title=s.title 
       and r.production_year=a.production_year 
       and r.production_year=s.production_year
       and s.scene_no=a.scene_no
       and a.description = r.description
group by r.id
having count(*)=1;",2018-08-31 15:07:32.862549+10,10,1,298,correct
11565,"with dwm as (select id, title, production_year
			from director
			union
			select id, title, production_year
			from writer),
	dwcount as (select id, count(*) as count
			from dwm
			group by id)
select id
from dwcount dc
where dc.count = (select max(count)
				from dwcount);",2018-08-31 15:07:39.061918+10,14,1,340,correct
11566,;,2018-08-31 15:07:45.810898+10,5,0,90,noninterpretable
11567,"SELECT title, production_year
FROM WRITER, PERSON WHERE PERSON.first_name = ""Kevin"" AND PERSON.last_name = ""Williamson"";",2018-08-31 15:07:47.250167+10,5,0,50,partially correct
11568,"select id
from person
where year_born < (select max(year_born) as max from person)
order by year_born
limit 1;",2018-08-31 15:07:53.351317+10,3,0,41,partially correct
11569,"select id, first_name, last_name
from person
where year_born=(select max(year_born) from person);",2018-08-31 15:08:06.182364+10,7,1,158,correct
11570,"SELECT country
FROM restriction
WHERE EXISTS title = Shakespeare in Love ande description = M
;",2018-08-31 15:08:09.174315+10,6,0,260,noninterpretable
11571,"select id, count(*) from person p
where select() ;",2018-08-31 15:08:14.640859+10,14,0,438,noninterpretable
11572,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:08:25.146332+10,3,1,224,correct
11573,;,2018-08-31 15:08:26.590199+10,6,0,90,noninterpretable
11574,"select count(*) 
from movie m 
left outer join
(select * from movie_award where lower(result) = ""won"") ma on
m.title = ma.title
and m.production_year = ma.production_year
left outer join
(select * from crew_award where lower(result) = ""won"") ca on
m.title = ca.title
and m.production_year =ca.production_year
left outer join

(select * from writer_award where lower(result) = ""won"") wa on
m.title = wa.title
and m.production_year = wa.production_year
left outer join

(select * from director_award where lower(result) = ""won"") da on
m.title = da.title
and m.production_year = da.production_year

left outer join

(select * from actor_award where lower(result) = ""won"") aa on
m.title = aa.title
and m.production_year = aa.production_year
where ma.title is null
and ca.title is null
and wa.title is null
and da.title is null
and aa.title is null
;


",2018-08-31 15:08:45.333609+10,11,1,449,correct
11575,;,2018-08-31 15:08:51.503069+10,7,0,90,noninterpretable
11576,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p
      WHERE w.id = p.id
      AND lower(p.first_name) = 'woody'
      AND lower(p.last_name) = 'allen')AS wp, writer_award wa
WHERE wa.id = wp.id
AND wa.year_of_award <= 1995
AND wa.year_of_award >= 1991
AND lower(RESULT) = 'won';",2018-08-31 15:08:54.171056+10,9,1,169,correct
11577,"SELECT title, production_year
FROM WRITER w, PERSON p WHERE p.first_name = ""Kevin"" AND p.last_name = ""Williamson"" AND p.id = w.id;",2018-08-31 15:08:59.935129+10,5,1,50,correct
11578,SELECT;,2018-08-31 15:09:17.161461+10,13,0,224,noninterpretable
11579,;,2018-08-31 15:09:18.52558+10,8,0,386,noninterpretable
11581,;,2018-08-31 15:09:25.683016+10,8,0,90,noninterpretable
11583,"SELECT count(*)
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:09:29.173865+10,11,1,358,correct
11584,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (
SELECT title, production_year FROM movie_award
WHERE lower(award_name) = 'bafta film award'
AND lower(category) = 'best film'
AND lower(RESULT) = 'won') AS ma,
director AS d,
person AS p
WHERE
ma.title = d.title
AND ma.production_year = d.production_year
AND d.id = p.id;",2018-08-31 15:09:33.675545+10,8,1,23,correct
11585,"select count (*)
from movie m
where not exists(
         
		 select title, production_year 
		 from movie_award ma
		 where lower(ma.result)  = 'won' and ma.title = m.title and ma.production_year = m.production_year 
		 union
		 select title, production_year 
		 from crew_award ca
		 where lower(ca.result)  = 'won' and ca.title = m.title and ca.production_year = m.production_year
		 union
		 select title, production_year 
		 from director_award da
		 where lower(da.result)  = 'won' and da.title = m.title and da.production_year = m.production_year
		 union
           select title, production_year 
		 from writer_award wa
		 where lower(wa.result)  = 'won' and wa.title = m.title and wa.production_year = m.production_year
		 union
		 select title, production_year 
		 from actor_award aa
		 where lower(aa.result)  = 'won' and aa.title = m.title and aa.production_year = m.production_year
		 );",2018-08-31 15:09:36.573392+10,11,1,225,correct
11586,;,2018-08-31 15:09:52.22547+10,9,0,90,noninterpretable
11587,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:10:10.667779+10,3,1,41,correct
11588,"select count(*) 
from writer ;",2018-08-31 15:10:10.934172+10,1,0,463,partially correct
11589,"SELECT p.id FROM crew c,person p,appearance a
WHERE lower(a.title)='psycho' AND lower(a.production_year)='1960' AND 
a.title=a.title AND c.production_year=a.production_year AND 
c.id=p.id AND a.scene_no=1;",2018-08-31 15:10:15.385591+10,10,0,297,partially correct
11590,;,2018-08-31 15:10:16.387332+10,10,0,90,noninterpretable
11591,"select first_name,last_name
from person,(
select id,max(r.c)
from
(
select id,count(*) as c
from role
group by id
order by count(*) desc) as r) as m_c
where person.id = m_c.id

;",2018-08-31 15:10:25.238202+10,15,0,207,partially correct
11592,"select p2.id
from person p2
where p2.year_born in
	(select Max(p.year_born)
		from person p
		where p.year_born < (select Max(p1.year_born)
					from person p1
				)) ;
",2018-08-31 15:10:26.995039+10,3,1,136,correct
11593,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:10:45.719559+10,13,1,224,correct
11594," SELECT d.id, p.award_name, p.year_of_award, p.category FROM DIRECTOR d,(SELECT * FROM DIRECTOR_AWARD WHERE result='nominated') AS p WHERE d.title = p.title;",2018-08-31 15:10:53.271877+10,13,1,404,correct
11595,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:10:53.896606+10,13,1,224,correct
11596,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:10:57.320163+10,8,1,268,correct
11597,"with brole as(
select id, count(*) from role
group by id having count(*) = (
select max(nrole) from(
select count(*) as nrole from role
group by id)))
select first_name, last_name, title, production_year, description
from person, role
where person.id = role.id
and person.id in(select id from brole);",2018-08-31 15:10:59.111277+10,15,1,129,correct
11598,"select d.id, n.award_name, n.year_of_award, n.category
from director_award n, director d
where n.title = d.title and n.production_year = d.production_year and lower(n.result) = 'nominated' and n.title not in(
	select title
	from director_award
	where lower(result) = 'won'
	) and n.production_year not in(
	select production_year
	from director_award
	where lower(result) = 'won'
	)
;",2018-08-31 15:11:07.284606+10,13,1,211,correct
11599,"select id
from person 
where year_born=(select max(year_born)
from person 
where year_born<(select max(year_born)
from person ));",2018-08-31 15:11:12.07624+10,3,1,377,correct
11600,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:11:12.464171+10,14,1,438,correct
11601,;,2018-08-31 15:11:16.763078+10,11,0,90,noninterpretable
11602,"SELECT ID from (SELECT ID, COUNT(*) AS No_Workon from Writer
group by id
Union
SElECT ID, COUNT(*) AS No_Workon FROM director
Group by ID)
Where No_Workon =2;",2018-08-31 15:11:23.800276+10,14,0,198,partially correct
11603,"select r.id 
from role r, appearance a, scene s
where r.title=a.title and r.title =s.title
	and r.production_year = s.production_year and r.production_year = a.production_year
	and a.scene_no = s.scene_no and r.description = a.description and
	r.title ='Psycho' and r.production_year =1960
group by r.id
having count(*)=1;",2018-08-31 15:11:27.666838+10,10,1,401,correct
11604,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p
      WHERE w.id = p.id
      AND lower(p.first_name) = 'woody'
      AND lower(p.last_name) = 'allen')AS wp, writer_award wa
WHERE wa.id = wp.id
AND wa.year_of_award <= 1995
AND wa.year_of_award >= 1991
AND lower(wa.RESULT) = 'won';",2018-08-31 15:11:31.410776+10,9,1,169,correct
11605,;,2018-08-31 15:11:32.467799+10,14,0,224,noninterpretable
11606,"SELECT country 
FROM restriction 
WHERE title='Shakespeare in Love'
AND description='M';
",2018-08-31 15:11:41.6239+10,6,1,372,correct
11607,;,2018-08-31 15:11:51.295594+10,3,0,90,noninterpretable
11608,;,2018-08-31 15:12:11.498448+10,14,0,139,noninterpretable
11609,;,2018-08-31 15:12:12.743272+10,13,0,90,noninterpretable
11610,"SELECT DISTINCT id
FROM person
WHERe id IN (SELECT id FROM writer
		  UNION
		  SELECT id FROM director);",2018-08-31 15:12:15.817557+10,14,0,454,partially correct
11996,"SELECT production_year, COUNT (title)
FROM movie
WHERE production_year =1991 or 1992 or 1993
GROUP BY production_year;",2018-08-31 15:47:05.563267+10,2,0,160,partially correct
11611,"SELECT id FROM (SELECT id,title,production_year FROM writer UNION SELECT id,title,production_year FROM director ) AS foo GROUP BY id ORDER BY COUNT(*) DESC LIMIT 1;",2018-08-31 15:12:27.232131+10,14,0,408,partially correct
11612,"SELECT x.id
FROM (SELECT x1.id, count(*) AS Noofworkedon
      FROM (SELECT d.id, title, production_year
	      From director d
		  UNION
		  SELECT w.id, title, production_year
		  FROM writer w) x1
	GROUP BY x1.id) x
WHERE x.Noofworkedon = (SELECT max(x2.Noofworkedon)
				 FROM (SELECT x1.id, count(*) AS Noofworkedon
				 	 FROM (SELECT d.id, title, production_year
	      			  	   From director d
		  		             UNION
		  		             SELECT w.id, title, production_year
				            FROM writer w) x1
				      GROUP BY x1.id) x2);",2018-08-31 15:12:34.563081+10,14,1,450,correct
11613,;,2018-08-31 15:12:37.895288+10,14,0,90,noninterpretable
11614,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(SELECT title,production_year
                 FROM movie_award ma
                 WHERE ma.title = m.title AND ma.production_year = m.production_year
                 UNION
                 SELECT title,production_year
                 FROM crew_award ca
                 WHERE ca.title = m.title AND ca.production_year = m.production_year
                 UNION 
                 SELECT title,production_year
                 FROM director_award da
                 WHERE da.title = m.title AND da.production_year = m.production_year
                 UNION
                 SELECT title,production_year
                 FROM writer_award wa
                 WHERE wa.title = m.title AND wa.production_year = m.production_year
                 UNION
                 SELECT title,production_year
                 FROM actor_award ma
                 WHERE aa.title = m.title AND aa.production_year = m.production_year
                 UNION);",2018-08-31 15:12:48.157733+10,11,0,443,noninterpretable
11615,"select count(*) from person p
where p.id not in (select id from director);",2018-08-31 15:12:52.082404+10,12,1,203,correct
11616,"SELECT id FROM (SELECT id,title,production_year FROM writer UNION SELECT id,title,production_year FROM director ) AS foo GROUP BY id ORDER BY COUNT(*) DESC LIMIT 3;",2018-08-31 15:13:00.420184+10,14,1,408,correct
11617,"select count (pr.id) as person_notdirected 
from person As pr , Director as Dr
where pr.ID <>Dr.id;",2018-08-31 15:13:04.23056+10,12,0,412,partially correct
11618,;,2018-08-31 15:13:05.575869+10,15,0,90,noninterpretable
11619,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:13:06.179917+10,14,1,224,correct
11620,"select x4.id  from(select w.id, w.title, w.production_year from writer w 
union select d.id, d.title, d.production_year from director d
union select x1.id, x1.title, x1.production_year from (writer natural join person natural join director) as x1) as x4
group by x4.id
having count(*)=(
select max(x3.total) from (select x2.id, count(*) as total from(select w.id, w.title, w.production_year from writer w 
union select d.id, d.title, d.production_year from director d
union select x1.id, x1.title, x1.production_year from (writer natural join person natural join director) as x1) as x2
group by x2.id) as x3);",2018-08-31 15:13:08.555723+10,14,1,66,correct
11621,"select count(*) from (
select distinct p.id from writer w, person p
where w.id = p.id and p.year_born = 1935);",2018-08-31 15:13:18.558112+10,1,1,156,correct
11622,"select di.id, di.award_name
from (person natural join director_award natural join director) as di,
	(select * 
from (select dir.title, dir.production_year
	from (director_award natural join director) as dir
	group by dir.title, dir.production_year
	having count(*)>0)
Where not exists
(select dir2.title, dir2.production_year
	from (director_award natural join director) as dir2
	where lower(dir2.result) = ""won"")) as de
Where di.title = de.title, di.production_year = de.production_year;

",2018-08-31 15:13:26.857748+10,13,0,457,noninterpretable
11623,"SELECT COUNT(*) 
FROM WRITER_AWARD
WHERE YEAR_OF_AWARD BETWEEN 1991 AND 1995
AND EXISTS (SELECT *
FROM PERSON
WHERE PERSON.ID = WRITER_AWARD.ID
AND FIRST_NAME = 'WOODY'
AND LAST_NAME = 'ALLEN');",2018-08-31 15:13:37.530114+10,9,0,356,partially correct
11624,"select first_name,last_name, role.title,production_year,description
from person, role,(
select id,max(r.c)
from
(
select id,count(*) as c
from role
group by id
order by count(*) desc) as r) as m_c
where person.id = m_c.id
and person.id=role.id

;",2018-08-31 15:13:47.63534+10,15,1,207,correct
11625,"SELECT r.id
FROM role r, scene s, appearance a
WHERE a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description 
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:13:51.762095+10,10,0,227,partially correct
11626,"SELECT r.id
FROM role r, scene s, appearance a
WHERE a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description 
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:13:57.60633+10,10,0,227,partially correct
11627,"
with cou as (
	select id, count(*) as numberofrole
		from role
		group by id)
select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, cou b
where r.id = p.id
and p.id = b.id
and b.numberofrole in (
	select max(a.numberofrole)
	from cou a);",2018-08-31 15:14:05.219515+10,15,1,276,correct
11628,"Select count(*) as NumberOfAwards
From writer w natural join Person p natural join writer_award wa
Where lower(p.first_name)='woody'
And lower(p.last_name)= 'allen'
And wa.year_of_award<1996
And wa.year_of_award>1990
and lower(wa.result)='won';",2018-08-31 15:14:16.347276+10,9,1,77,correct
11629,"SELECT country FROM restriction r
WHERE r.title=lower('Shakespeare in Love')
AND r.description='M'; ",2018-08-31 15:14:21.046749+10,6,0,393,partially correct
11630,"SELECT country
FROM restriction
WHERE
lower(title) ='shakespeare in love' 
AND description = 'M'
;",2018-08-31 15:14:23.818362+10,6,1,260,correct
11631,"select id from person where year_born in ( 
select max(year_born) from person where year_born not in (select max(year_born) from person)); 



",2018-08-31 15:14:29.160614+10,3,1,449,correct
11632,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE EXISTS (SELECT *
				FROM WRITER w INNER JOIN DIRECTOR d ON w.id = d.id  AND w.title = d.title AND w.production_year = d.production_year
				WHERE w.id = p.id
				GROUP BY w.id
				HAVING count(*) > 1);
",2018-08-31 15:14:30.297642+10,4,1,455,correct
11633,;,2018-08-31 15:14:32.230774+10,15,0,224,noninterpretable
11634,"SELECT id,first_name,last_name
FROM person 
WHERE person.year_born=(SELECT MAX(year_born) 
FROM person);
",2018-08-31 15:14:35.67638+10,7,1,372,correct
11635,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:14:44.989294+10,13,1,457,correct
11636,"SELECT r.id
FROM role r, scene s, appearance a
WHERE a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description 
AND lower(a.title)='psycho'
AND a.production_year=1960
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:14:48.12414+10,10,1,227,correct
11637,"SELECT production_year,COUNT(production_year)
FROM MOVIE
WHERE production_year between 1991 and 1993
GROUP BY production_year;",2018-08-31 15:14:53.125426+10,2,1,216,correct
11638,"SELECT r.id
FROM role r, scene s, appearance a
WHERE a.title=s.title
AND a.production_year=s.production_year
AND a.scene_no=s.scene_no
AND a.title=r.title
AND a.production_year=r.production_year
AND a.description=r.description 
AND lower(a.title)='psycho'
AND a.production_year=1960
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:14:53.795975+10,10,1,227,correct
11639,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-31 15:14:59.41434+10,6,1,420,correct
11640,"SELECT
    r.id
FROM
    appearance a,
    ROLE r
WHERE
    r.production_year = a.production_year
    AND a.title = r.title
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(id) = 1;",2018-08-31 15:15:01.123265+10,10,1,161,correct
11641,"Select * from Director as Dr, writer as Wr
Group by Dr.id= Wr.id
having count(Dr.id)>= 2;",2018-08-31 15:15:02.542057+10,4,0,412,partially correct
11642,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 15:15:29.373198+10,15,1,224,correct
11643,"SELECT DISTINCT m.title, m.production_year
FROM (MOVIE m INNER JOIN WRITER w ON m.title = w.title) x
WHERE EXISTS(SELECT * FROM PERSON p WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson' AND w.id = p.id);",2018-08-31 15:15:43.792044+10,5,1,451,correct
11644,"select count(*)
from person p, writer w
where p.id = w.id
and p.year_born = 1935;",2018-08-31 15:15:47.873311+10,1,0,276,partially correct
11645,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(SELECT title,production_year
                 FROM movie_award ma
                 WHERE ma.title = m.title AND ma.production_year = m.production_year AND lower(ma.result)='won'
                 UNION
                 SELECT title,production_year
                 FROM crew_award ca
                 WHERE ca.title = m.title AND ca.production_year = m.production_year AND lower(ca.result)='won'
                 UNION 
                 SELECT title,production_year
                 FROM director_award da
                 WHERE da.title = m.title AND da.production_year = m.production_year AND lowEr(da.result)='won'
                 UNION
                 SELECT title,production_year
                 FROM writer_award wa
                 WHERE wa.title = m.title AND wa.production_year = m.production_year AND lower(wa.result)='won'
                 UNION
                 SELECT title,production_year
                 FROM actor_award aa
                 WHERE aa.title = m.title AND aa.production_year = m.production_year AND lower(aa.result)='won');",2018-08-31 15:15:52.452333+10,11,1,443,correct
11646,"SELECT country FROM restriction r
WHERE r.title='Shakespeare in Love'
AND r.description='M'; ",2018-08-31 15:15:58.009252+10,6,1,393,correct
11647,"select dw.id 
from (select id,title,production_year
	from
	director
	union
	select id,title,production_year
	from writer)as dw
group by dw.id
having count(dw.id) =(select max(d3.number)
				from (select dw.id,count(*)
					from (director 
						union
						select id,title,production_year
						from writer)as d2
					group by d2.id)as d3);
",2018-08-31 15:16:00.324254+10,14,0,149,noninterpretable
11648,"select production_year, count(*) from movie
where production_year = 1991
or production_year = 1992
or production_year = 1993
group by production_year;",2018-08-31 15:16:00.37731+10,2,1,156,correct
11649,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award  da
where d.title = da.title
and d.production_year = da.production_year
and lower(da.result) = 'nominated';",2018-08-31 15:16:07.171197+10,13,1,41,correct
11650,"select count(*)
from movie as m
where not exists(
select title,production_year from movie_award as ma
where lower(ma.result)='won' and ma.title=m.title and ma.production_year=m.production_year
union
SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year)
	;",2018-08-31 15:16:39.75772+10,11,1,85,correct
11651,"select production_year,count(*)
from movie
where production_year>1990 and production_year<1994
group by production_year;",2018-08-31 15:16:57.53166+10,2,1,192,correct
11652,"SELECT dw.id, dw.first_name, dw.last_name
FROM (PERSON p NATURAL JOIN WRITER NATURAL JOIN DIRECTOR) AS dw
GROUP BY dw.id
HAVING count(*) > 1;
",2018-08-31 15:17:08.665386+10,4,1,455,correct
11653,"select d.title, d.production_year, p.first_name, p.last_name
from movie_award as m, director as d, person as p
where m.title=d.title
and p.id=d.id
and m.production_year=d.production_year
and lower(m.award_name)='bafta file award'
and lower (m.category)='best film';",2018-08-31 15:17:12.530731+10,8,0,158,partially correct
11654,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.id in (select id from (director d natural join director_award da) u
where lower(u.result)= 'nominated')
and d.id not in (select id from (director d natural join director_award da) v
where lower(v.result) = 'won' ) ;",2018-08-31 15:17:14.871117+10,13,0,400,partially correct
11655,"select count(*)
from person as p
where exists
(select * from writer as w
where w.id=p.id and p.year_born=1935);
",2018-08-31 15:17:17.557661+10,1,1,462,correct
11656,"

select p2.id from (
select p.id,p.year_born, rank() over(order by year_born desc) as rank 
from person p) as p2
where p2.rank =2;",2018-08-31 15:17:20.26843+10,3,1,374,correct
11657,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:17:23.31769+10,8,1,386,correct
11658,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:17:27.48281+10,10,1,459,correct
11659,"SELECT id, first_name, last_name ,year_born order by column asc
FROM person
WHERE 
;",2018-08-31 15:17:39.91016+10,7,0,260,noninterpretable
11660,"SELECT id
FROM PERSON
WHERE NOT EXISTS (SELECT DISTINCT p.id FROM PERSON p INNER JOIN DIRECTOR d ON p.id=d.id);",2018-08-31 15:17:40.41771+10,12,0,442,partially correct
11661,"SELECT production_year,count(*)
From MOVIE
WHERE production_year BETWEEN 1991 AND 1993
GROUP BY production_year;",2018-08-31 15:17:44.594473+10,2,1,47,correct
11696,"SELECT id, first_name, last_name
FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING COUNT(*) >= 2;",2018-08-31 15:21:31.788584+10,4,1,423,correct
11662,"select dw.id 
from (select id,title,production_year
	from
	director d
	union
	select id,title,production_year
	from writer w)as dw
group by dw.id
having count(dw.id) =(select max(d3.number)
				from (select d2.id,count(*)as number
					from (select id,title,production_year
						from
						director d
						union
						select id,title,production_year
						from writer as w)as d2
					group by d2.id)as d3);
",2018-08-31 15:17:46.013771+10,14,1,149,correct
11663,"select * from director_award where result = ""nominated"";",2018-08-31 15:17:48.623619+10,13,0,449,partially correct
11664,"SELECT ID FROM CREW
WHERE EXISTS (SELECT * FROM SCENE 
WHERE SCENE_NO = 1);",2018-08-31 15:18:00.834644+10,10,0,356,partially correct
11665,"SELECT COUNT(*) as NumberOfWriters
FROM PERSON p
WHERE EXISTS (
	SELECT * 
	FROM WRITER w
	WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 15:18:00.924648+10,1,1,465,correct
11666,SELECT * FROM ROLE WHERE id = (SELECT id FROM ROLE GROUP BY id ORDER BY COUNT(*) DESC LIMIT 1);,2018-08-31 15:18:04.210992+10,15,0,384,partially correct
11667,"SELECT count(w.award)
FROM (SELECT * 
	FROM person);
",2018-08-31 15:18:19.200327+10,9,0,268,noninterpretable
11668,"with play as (select id, count(*) as count
from role
group by id)
select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r, play
where p.id = r.id and p.id = play.id
and play.count = (select max(count)
from play);",2018-08-31 15:18:28.681691+10,15,1,340,correct
11669,"SELECT r.id
FROM scene s INNER JOIN appearance a INNER JOIN role r
ON s.title = r.title AND s.production_year = r.production_year
AND s.title = a.title AND s.production_year = a.production_year
AND s.scene_no = a.scene_no AND r.description = a.description
WHERE lower(s.title)='psycho' AND s.production_year=1960
GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:18:45.746538+10,10,1,173,correct
11670,"select count(*)
from person p
where p.year_born=1935
and p.id in (select w.id from writer w);",2018-08-31 15:18:51.860038+10,1,1,293,correct
11671,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:19:16.085667+10,13,1,449,correct
11672,"SELECT id, first_name, last_name
FROM person p
WHERE  p.year_born =(
SELECT max(year_born)
FROM person
)
;
",2018-08-31 15:19:22.300409+10,7,1,260,correct
11673,"select count(*) 
from person p
where exists
(select * 
from writer w
where w.id = p.id
and p.year_born = 1935);
",2018-08-31 15:19:25.979196+10,1,1,245,correct
11674,;,2018-08-31 15:19:26.854768+10,9,0,386,noninterpretable
11675,"select count(*) from person
where id not in ( select id from director);
",2018-08-31 15:19:33.866938+10,12,1,156,correct
11676,"select  p.first_name, p.last_name , r.title, r.production_year,r.description 
from person p, (select id,count(description) as abc,title, production_year,description  from role r group by id) as a, role r
where a.id = p.id
	and r.id = a.id and  a.abc in ( select max(a.abc) from (select id,count(description) as abc from role r group by id) as a)
;",2018-08-31 15:19:41.339709+10,15,1,229,correct
11677,"SELECT P.first_name, P.last_name, R.title, R.production_year, R.description FROM 

PERSON P, ROLE R 


WHERE 

R.id = P.id AND

R.id = (SELECT id FROM ROLE GROUP BY id ORDER BY COUNT(*) DESC LIMIT 1);",2018-08-31 15:19:46.261891+10,15,1,384,correct
11678,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM PERSON p,ROLE r
WHERE;",2018-08-31 15:19:47.106449+10,15,0,329,noninterpretable
11679,"select d.id, da.award_name, da.year_of_award, da.category
from (director d natural join director_award da) u
where lower(u.result)= 'nominated'
and d.id not in (select id from (director d natural join director_award da) v
where lower(v.result) = 'won' ) ;",2018-08-31 15:19:49.965586+10,13,1,400,correct
11680,"SELECT m.production_year as ProductionYear, COUNT(*) as NumberOfMovies
FROM MOVIE m
GROUP BY m.production_year
HAVING m.production_year = 1993 OR m.production_year = 1992 OR m.production_year = 1991;",2018-08-31 15:19:56.480915+10,2,1,465,correct
11681,"select count (*)
from person 
where exsits (select*from writer where writer.id = person.id and person.year_born =1935);",2018-08-31 15:20:03.53771+10,1,0,463,noninterpretable
11682,"SELECT r.id
FROM scene s, appearance a, role r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:20:15.157907+10,10,1,169,correct
11683,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 15:20:21.410333+10,2,1,462,correct
11684,"SELECT COUNT(*)
FROM movie m,

WHERE ;",2018-08-31 15:20:24.209662+10,11,0,441,noninterpretable
11685,"SELECT COUNT(*) 
FROM PERSON p
WHERE NOT EXISTS (
	SELECT * 
	FROM DIRECTOR d
	WHERE p.id = d.id);",2018-08-31 15:20:27.929641+10,12,1,465,correct
11686,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:20:37.943529+10,14,1,145,correct
11687,"select p.id,p.first_name,p.last_name from writer w
inner join director d on d.id = w.id and d.title = w.title
inner join person p on p.id = d.id
group by p.id
having count(*)>=2;",2018-08-31 15:20:48.647231+10,4,1,203,correct
11688,"SELECT DISTINCT r1.country
FROM RESTRICTION r1
WHERE r1.description = 'M' AND r1.title = 'Shakespeare in Love';",2018-08-31 15:20:59.599836+10,6,1,451,correct
11689,"SELECT p.id FROM person p

WHERE p.id=(SELECT id FROM (SELECT id FROM director d
	WHERE d.title=(SELECT title FROM director_award da
	WHERE lower(da.result)='won' AND da.production_year=d.production_year)))
WHERE NOT EXISTS ( SELECT title from movie_award ma WHERE lower(ma.result)!='won' AND ma.title=d.title AND ma.production_year= d.production_year
				UNION 
				 SELECT title from crew_award ca WHERE lower(ca.result)!='won' AND ca.title=d.title AND ma.production_year= d.production_year
				UNION 
				 SELECT title from writor_award wa WHERE lower(wa.result)!='won' AND wa.title=d.title AND ma.production_year= d.production_year
				UNION 
				 SELECT title from actor_award aa WHERE lower(aa.result)!='won' AND aa.title=d.title AND ma.production_year= d.production_year
);",2018-08-31 15:21:01.797165+10,13,0,453,noninterpretable
11690,"SELECT r.id
FROm scene s,
appearance a,
role r
WHERe
s.title=a.title AND
s.production_year=a.production_year AND
s.scene_no=a.scene_no AND

a.description=r.description AND
s.title=r.title AND
s.production_year=r.production_year AND

lower(a.title)='psycho' AND
a.production_year='1996'
GROUP BY r.id
HAVING count(*)>1;",2018-08-31 15:21:07.20332+10,10,0,297,partially correct
11691,"SELECT id,award_name,year_of_award,category
FROM director_award AS da,
director AS d
WHERE da.title=d.title
AND da.production_year=d.production_year
AND lower(da.result)='nominated'
AND d.id NOT IN (SELECT id 
FROM director_award AS da,
director AS d
WHERE da.title=d.title
AND da.production_year=d.production_year
AND lower(da.result)='won');",2018-08-31 15:21:19.587574+10,13,1,217,correct
11692,;,2018-08-31 15:21:20.197705+10,7,0,408,noninterpretable
11693,"select count(w.id) from writer w where w.id in (select p.id from person p where year_born = 1935);
",2018-08-31 15:21:21.238827+10,1,0,461,partially correct
11694,"SELECT id
FROM person p
WHERE ;",2018-08-31 15:21:25.916918+10,3,0,443,noninterpretable
11695,"select count(w.id) from writer w where w.id in (select p.id from person p where year_born = 1935);
",2018-08-31 15:21:30.317756+10,1,0,461,partially correct
11698,"SELECT id, first_name, last_name
FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING COUNT(*) >= 2;",2018-08-31 15:21:45.409092+10,4,1,465,correct
11699,;,2018-08-31 15:22:09.357945+10,8,0,408,noninterpretable
11700,"select count (*)
from person 
where exists (SELECT*FROM writer where writer.id = person.id and person.year_born =1935);",2018-08-31 15:22:12.510232+10,1,1,463,correct
11701,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    person p
WHERE
   
     wa.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:22:12.527667+10,9,1,386,correct
11702,"select title,production_year
from writer w,person 
where w.id = person.id
	and lower(person.first_name)= 'kevin'
	AND lower(person.last_name)= 'williamson';",2018-08-31 15:22:29.088958+10,5,1,134,correct
11703,"select id,first_name,last_name,title,production_year,description,count(*) as c
from (role NATURAL JOIN person) as r
where r.c=(select count(*)
from (role NATURAL JOIN person) as r
group by id)
group by id;",2018-08-31 15:22:36.403311+10,15,0,325,noninterpretable
11704,"SELECT id, first_name, last_name
FROM person
WHERE MAX(year_born);",2018-08-31 15:22:37.802695+10,7,0,420,noninterpretable
11705,"SELECT r.id

FROM scene s,
appearance a,
role r
WHERE

s.title=a.title AND
s.production_year=a.production_year AND
s.scene_no=a.scene_no AND

a.description=r.description AND
s.title=r.title AND
s.production_year=r.production_year AND

lower(a.title)='psycho' AND
a.production_year='1960'

GROUP BY r.id
HAVING count(*)=1;",2018-08-31 15:22:38.435735+10,10,1,297,correct
11706,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YER_BORN)
FROM PERSON;",2018-08-31 15:22:41.197538+10,11,0,356,noninterpretable
11707,"SELECT m.title, m.production_year
FROM MOVIE m NATURAL JOIN WRITER w NATURAL JOIN PERSON p
WHERE p.first_name = 'Kevin' AND p.last_name = 'Williamson';",2018-08-31 15:22:46.83593+10,5,1,455,correct
11708,"SELECT movie.title, movie.production_year
FROM movie (SELECT writer.id
FROM writer person
WHERE person.last_name = Kevin AND person.first_name = Williamson
GROUP BY writer.id) AS a
WHERE movie.title = a.title
GROUP BY movie.title;",2018-08-31 15:22:53.39107+10,5,0,251,noninterpretable
11709,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:22:59.955879+10,9,1,268,correct
11710,"select count(distinct w.id) from writer w, person p
where w.id=p.id AND p.year_born=1935;",2018-08-31 15:23:00.6438+10,1,1,466,correct
11711,"select p.id,p.first_name,p.last_name from person p ,writer w,director d
where p.id = d.id
and p.id = w.id
and w.title = d.title
and w.production_year = d.production_year 
group by p.id having count(*)>1;

",2018-08-31 15:23:05.642285+10,4,1,367,correct
11712,select count(*) from movie where production_year = 1993 or production_year = 1994 or production_year = 1995 group by production_year; ,2018-08-31 15:23:08.32817+10,2,0,66,partially correct
11713,;,2018-08-31 15:23:12.792868+10,9,0,408,noninterpretable
11714,;,2018-08-31 15:23:14.063201+10,14,0,217,noninterpretable
11715,;,2018-08-31 15:23:14.374586+10,9,0,408,noninterpretable
11716,"select title,production_year from writer w inner join person p
on p.id = w.id
where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-31 15:23:36.222514+10,5,1,203,correct
11717,"select production_year,count(*) from movie where production_year = 1993 or production_year = 1994 or production_year = 1995 group by production_year; ",2018-08-31 15:23:37.689449+10,2,0,66,partially correct
11718,"select count(*)
from(
select distinct person.id
from person, writer
where person.id=writer.id
and year_born=1935)
;",2018-08-31 15:23:39.746457+10,1,1,207,correct
11719,"SELECT d.id
FROM DIRECTOR d
INNER JOIN WRITER w ON w.id=d.id
WHERE d.title=w.title;",2018-08-31 15:23:41.500296+10,4,0,442,partially correct
11720,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:23:55.038052+10,13,1,453,correct
11721,select count(*) from movie where production_year between '1991' and '1993';,2018-08-31 15:24:06.26679+10,2,0,266,partially correct
11722,;,2018-08-31 15:24:18.358397+10,10,0,408,noninterpretable
11723,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born = (
	SELECT MIN(year_born)
	FROM person
);",2018-08-31 15:24:21.084617+10,7,0,420,partially correct
11724,"select count(distinct w.id) from writer w where w.id in (select p.id from person p where year_born = 1935);
",2018-08-31 15:24:24.64748+10,1,1,461,correct
11725,"select d.id,
da.award_name,
da.year_of_award,
da.category

from director_award da,
director d

where lower(da.result)='nominated'

and d.title=da.title
and d.production_year=da.production_year 
and d.id not in(
select id
from director_award da,
director d
where lower(da.result)='won'
and d.title=da.title
and d.production_year=da.production_year 
);
",2018-08-31 15:24:25.022963+10,13,1,377,correct
11726,"select production_year, count(*)
from movie
group by production_year
having production_year = 1993 or production_year = 1992 or production_year = 1991;",2018-08-31 15:24:26.155074+10,2,1,245,correct
11727,;,2018-08-31 15:24:28.156684+10,14,0,329,noninterpretable
11728,"select  id from (

select distinct id, title from (

select p.id, title from person p
join writer w
on p.id = w.id

union 

select p.id, title from person p
join director w
on p.id = w.id
)
z
)x
group by 1
having count(*) = 3

;",2018-08-31 15:24:37.525952+10,14,1,449,correct
11729,"select production_year,count(*) from movie where production_year = 1993 or production_year = 1992 or production_year = 1991 group by production_year; ",2018-08-31 15:24:39.910121+10,2,1,66,correct
11730,"select country from restriction
where title ='Shakespeare in Love' and description='M';",2018-08-31 15:24:42.849596+10,6,1,203,correct
11731,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born = (
	SELECT MAX(year_born)
	FROM person
);",2018-08-31 15:24:51.086686+10,7,1,420,correct
11732,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) 
                     FROM person p1 
                     WHERE p1.year_born<(SELECT MAX(year_born) from person p2));",2018-08-31 15:25:05.315712+10,3,1,443,correct
11733,"SELECT COUNT(*)
FROM writer NATURAL JOIN person
WHERE
	person.year_born = 1935;",2018-08-31 15:25:08.218586+10,1,0,285,partially correct
11734,"SELECT d.id,d.title,d.production_year
FROM DIRECTOR d
INNER JOIN WRITER w ON w.id=d.id
WHERE d.title=w.title;",2018-08-31 15:25:10.502597+10,4,0,442,partially correct
11735,"
select *
from appearance
where description;
",2018-08-31 15:25:12.261567+10,10,0,45,partially correct
11736,"select production_year,count(*) from movie where production_year between '1991' and '1993' group by production_year;",2018-08-31 15:25:16.397635+10,2,1,266,correct
11737,"select wp.title, wp.production_year
from (WRITER natural join PERSON) as wp
where wp.first_name = 'Kevin' and wp.last_name = 'Williamson';",2018-08-31 15:25:16.890554+10,5,1,465,correct
11738,"select min(year_born) 
from person
where year_born > (select min(year_born)
from person);",2018-08-31 15:25:21.947994+10,3,0,358,partially correct
11739,;,2018-08-31 15:25:25.809705+10,11,0,408,noninterpretable
11740,"select pr.id,pr.first_name,pr.last_name,pr.title,pr.production_year,pr.description
from (person natural join role)as pr
where pr.id in
(select pr.id
from (person natural join role)as pr
group by pr.id
having count(pr.id)=(select max(dw.number)
				from (select rp.id,count(*)as number
					from(person natural join role)as rp
					group by rp.id)as dw
));

",2018-08-31 15:25:45.106858+10,15,0,149,partially correct
11741,"select country
from RESTRICTION
where lower(title) = ""shakespeare in love"" and lower(description) = 'm';",2018-08-31 15:25:50.135671+10,6,1,465,correct
11742,"SELECT id, first_name, last_name FROM person
GROUP BY year_born
HAVING MIN(year_born);",2018-08-31 15:26:06.002541+10,7,0,393,partially correct
11743,"with wd as (
	select w.id, count(*) num from director d, writer w
	where d.title = w.title and d.production_year = w.production_year
	and w.id = d.id
	group by w.id
	having count(*) >= 2
)

select p.id, first_name, last_name from wd, person p
where wd.id = p.id;",2018-08-31 15:26:10.870366+10,4,1,156,correct
11744,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:26:10.982873+10,14,1,217,correct
11745,"select movie.title,movie.production_year from movie 
join movie_award on movie_award.title = movie.title
where movie_award.category = lower('best film') and award_name = lower('bafta film award');",2018-08-31 15:26:17.705074+10,8,0,447,partially correct
11746,"SELECT count(*)
FROM PERSON p
WHERE NOT EXISTS(SELECT * From DIRECTOR d WHERE p.id=d.id);",2018-08-31 15:26:23.010547+10,12,1,47,correct
11747,"select id, first_name, last_name
from (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER )as dw
group by dw.id
having count (*)>1;
",2018-08-31 15:26:25.341465+10,4,1,189,correct
11748,"SELECT md.title, md.production_year,pd.id,p.first_name,p.last_name
FROM 
(director natural join person)as pd
and(director natural join movie_award) as md
WHERE
lower(award_name)='bafta flim award'
and 
lower(category)='best flim'
;",2018-08-31 15:26:30.467349+10,8,0,260,noninterpretable
11749,"select id, first_name, last_name
from PERSON p
where p.year_born = (
	select MAX(year_born)
	from PERSON);",2018-08-31 15:26:32.30809+10,7,1,465,correct
11750,;,2018-08-31 15:26:35.754887+10,3,0,408,noninterpretable
11751,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YER_BORN)
FROM PERSON;",2018-08-31 15:26:37.773438+10,3,0,356,noninterpretable
11752,"select count(*) from writer_award wa
where wa.result='won' and wa.id in (
select p.id from person p
where p.first_name='Woody' and last_name = 'Allen');",2018-08-31 15:26:40.460294+10,9,1,196,correct
11753,"select pr.first_name,pr.last_name,pr.title,pr.production_year,pr.description
from (person natural join role)as pr
where pr.id in
(select pr.id
from (person natural join role)as pr
group by pr.id
having count(pr.id)=(select max(dw.number)
				from (select rp.id,count(*)as number
					from(person natural join role)as rp
					group by rp.id)as dw
));

",2018-08-31 15:26:44.497854+10,15,1,149,correct
11754,"select p.id,p.first_name,p.last_name from person p
where p.year_born in (select max(year_born) from person);",2018-08-31 15:26:47.314078+10,7,1,203,correct
11755," SELECT id FROM (SELECT wd.id, COUNT(wd.title) FROM (SELECT id,title FROM WRITER UNION SELECT id,title FROM DIRECTOR) AS wd GROUP BY wd.id);",2018-08-31 15:26:56.66982+10,14,0,404,partially correct
11756,"select id 
from
(select id,count(*) as num
	from
	(select id,title,production_year 
		from writer natural join director
		group by id,title,production_year)
	order by num)
limit 1;



",2018-08-31 15:27:04.201429+10,14,0,457,partially correct
11757,"select count(*)
from writer w,
person p
where w.id=p.id
and p.year_born=1935;
",2018-08-31 15:27:06.663291+10,1,0,377,partially correct
11758,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
FROM director d 
WHERE p.id = d.id);",2018-08-31 15:27:13.522953+10,12,1,462,correct
11759,;,2018-08-31 15:27:17.279844+10,13,0,408,noninterpretable
11760,"SELECT DISTINCT p.id, p.first_name, p.last_name
FROM PERSON p
INNER JOIN WRITER w ON w.id=p.id
INNER JOIN DIRECTOR d ON d.id=p.id
WHERE d.title=w.title
ORDER BY p.id;",2018-08-31 15:27:24.261583+10,4,0,442,partially correct
11761,"select mw.title, mw.production_year, pd.first_name, pd.last_name
from (
	select title, production_year
	from MOVIE_AWARD
	where lower(award_name) = ""bafta film award"" AND lower(category) = ""best film"" AND lower(result) = ""won"") as mw,
	(PERSON natural join DIRECTOR) as pd
where mw.title = pd.title and mw.production_year = pd.production_year;",2018-08-31 15:27:35.630818+10,8,1,465,correct
11762,"SELECT country
FROM RESTRICTION 
WHERE lower(title) = 'shakespeare in love' AND lower(description) = 'm';",2018-08-31 15:27:42.020848+10,6,1,455,correct
11763,"select *
FORM person;",2018-08-31 15:27:43.524148+10,15,0,252,noninterpretable
11764,"select production_year, count(*)
from movie
where production_year=1993
or production_year=1992
or production_year=1991
group by production_year
order by  production_year desc

 ;",2018-08-31 15:27:51.960015+10,2,1,207,correct
11765,"SELECT
	COUNT(*) AS number_awards 
FROM
	writer_award wa, writer w, person p
WHERE
	wa.id=w.id AND
	wa.title=w.title AND
	wa.production_year=w.production_year AND
	w.id=p.id AND
	lower(p.first_name)='woody' AND
	lower(p.last_name)='allen' AND
	lower(wa.result)='won' AND
	w.production_year BETWEEN 1990 AND 1996;",2018-08-31 15:27:58.551187+10,9,1,430,correct
11766,"select production_year, count(title) from movie
where production_year=1991 or production_year=1992 or production_year=1993
group by production_year;",2018-08-31 15:28:04.259095+10,2,1,461,correct
11767,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 15:28:04.614492+10,15,1,252,correct
11768,"select production_year, count(production_year) from movie 
where production_year = 1993 or production_year=1992 or  production_year=1991
group by production_year;",2018-08-31 15:28:10.69771+10,2,1,466,correct
11769,"SELECT id, first_name, last_name FROM person
WHERE person.year_born=
(SELECT MAX(person.year_born);",2018-08-31 15:28:15.135558+10,7,0,393,noninterpretable
11770,"select * from
((select * from director) union (select* from writer) on writer.id = director.id);",2018-08-31 15:28:26.967598+10,14,0,200,noninterpretable
11771,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 15:28:32.861046+10,4,1,462,correct
11772,"select title,production_year from person p,writer w
where w.id = p.id
and lower(p.first_name)='kevin'
and lower(p.last_name) ='williamson';
",2018-08-31 15:28:46.973643+10,5,1,367,correct
11773,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YER_BORN)
FROM PERSON;",2018-08-31 15:28:47.031653+10,13,0,356,noninterpretable
11774,"SELECT id, first_name, last_name FROM person
WHERE person.year_born=
(SELECT MIN(person.year_born);",2018-08-31 15:28:53.850641+10,7,0,393,noninterpretable
11775,"select production_year, count(*)
from movie m
where exists (select*from movie m where;",2018-08-31 15:28:56.851367+10,2,0,463,noninterpretable
11776,"SELECT COUNT(id) as NumberOfAwards
FROM (PERSON NATURAL JOIN WRITER_AWARD) as pa
WHERE 
	lower(pa.first_name) = ""woody"" 
	and lower(pa.last_name) = ""allen"" 
	and pa.year_of_award >= 1991 
	and pa.year_of_award <= 1995 
	and lower(result) = ""won"";",2018-08-31 15:29:01.683825+10,9,1,423,correct
11777,"SELECT COUNT(id) as NumberOfAwards
FROM (PERSON NATURAL JOIN WRITER_AWARD) as pa
WHERE 
	lower(pa.first_name) = ""woody"" 
	and lower(pa.last_name) = ""allen"" 
	and pa.year_of_award >= 1991 
	and pa.year_of_award <= 1995 
	and lower(result) = ""won"";",2018-08-31 15:29:12.42306+10,9,1,465,correct
11778,"select title,production_year from writer where writer.id=(select id from person where  first_name like 'Kevin' and last_name like 'williamson');",2018-08-31 15:29:13.851754+10,5,1,203,correct
11779,;,2018-08-31 15:29:22.925637+10,15,0,408,noninterpretable
11814,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:32:00.27304+10,10,1,260,correct
11780,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:29:26.557923+10,8,1,260,correct
11781,"select w.title, w.production_year from person p, writer w
where p.id = w.id and lower(p.first_name) = 'kevin'
and lower(p.last_name) = 'williamson';",2018-08-31 15:29:36.649617+10,5,1,156,correct
11782,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
GROUP BY p.id;",2018-08-31 15:29:48.453536+10,7,0,451,partially correct
11783,"select id,max(year_born) 
from person
where year_born < (select max(year_born)
from person);",2018-08-31 15:29:49.170933+10,3,0,358,partially correct
11784,"select id
from director, writer;",2018-08-31 15:29:50.850152+10,14,0,41,noninterpretable
11785,"select id
from role as r, appearance as a
where r.title=a.title
and r.production_year=a.production_year
and r.production_year=1960
and lower(r.title)='psycho'
and a.scene_no=1;",2018-08-31 15:29:54.476329+10,10,0,158,partially correct
11786,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:29:55.292367+10,14,1,457,correct
11787,"SELECT rs2.id
FROM (
	SELECT id, scene_no
	FROM (ROLE NATURAL JOIN APPEARANCE) as ra
	WHERE lower(ra.title) = ""psycho"" and ra.production_year = 1960) as rs2
GROUP BY rs2.id
HAVING COUNT(*) = 1;",2018-08-31 15:29:57.443802+10,10,1,465,correct
11788,"select count(*)
from movie m
where not exists (select title, production_year 
				from movie_award ma where ma.result ='won' and m.title=ma.title
				UNION
			select title, production_year 
				from crew_award ca where ca.result ='won'and m.title=ca.title
				UNION
			select title, production_year 
				from director_award da where da.result ='won'and m.title=da.title
				UNION
			select title, production_year 
				from writer_award wa where wa.result ='won'and m.title=wa.title
				UNION
			select title, production_year 
				from actor_award aa where aa.result ='won'and m.title=aa.title);",2018-08-31 15:30:00.026922+10,11,0,401,partially correct
11789,;,2018-08-31 15:30:01.419582+10,9,0,260,noninterpretable
11790,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:30:08.881032+10,3,1,358,correct
11791,"SELECT sp.person
FROM person p;",2018-08-31 15:30:14.613102+10,10,0,268,noninterpretable
11792,"select d.title,d.production_year,p.first_name,p.last_name from movie_award ma
inner join director d on d.title = ma.title and d.production_year = ma.production_year
inner join person p on p.id = d.id
where lower(ma.award_name) = 'bafta film award' and lower(result) = 'won' and lower(category) = 'best film';",2018-08-31 15:30:22.023041+10,8,1,203,correct
11793,"SELECT sp.person
FROM person p;",2018-08-31 15:30:24.134886+10,10,0,268,noninterpretable
11794,"select m.production_year , count(*)as amount
from movie m
where m.production_year<=1993
and   m.production_year>=1991
group by m.production_year;",2018-08-31 15:30:33.734456+10,2,1,293,correct
11795,"Select count(*)
from person
where exists (select *
from writer
where writer.id=person.id
and person.year_born=1935);",2018-08-31 15:30:39.527466+10,1,1,377,correct
11796,"select count(id) from person p
where p.id NOT IN (select d.id from director d);",2018-08-31 15:30:47.177404+10,12,1,466,correct
11797,"select production_year, count(*)
from movie 
where production_year > 1990 and production_year< 1994
group by production_year;
",2018-08-31 15:30:48.715896+10,2,1,463,correct
11798,"SELECT id, first_name, last_name FROM person
WHERE person.year_born=
(SELECT MAX(year_born) FROM person);",2018-08-31 15:30:54.365631+10,7,1,393,correct
11799,"SELECT
w.title, w.production_year
FROM
writer w,
person p
WHERE
w.id = p.id
AND lower(first_name)= 'kevin'
AND lower(last_name)= 'williamson';",2018-08-31 15:30:54.430564+10,5,1,462,correct
11800,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:30:57.461268+10,9,1,260,correct
11801,;,2018-08-31 15:31:00.026186+10,14,0,453,noninterpretable
11802,"select d.id, da.award_name, da.year_of_award, da.category
from (director d natural join director_award da) u
where lower(u.result)= 'nominated' ;",2018-08-31 15:31:03.556989+10,13,1,400,correct
11803,"SELECT COUNT(*) AS NumberOfMovies FROM MOVIE m
WHERE (m.title, m.production_year) NOT IN (
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) = ""won"");",2018-08-31 15:31:04.441675+10,11,1,423,correct
11804,"select pr.id
from (person natural join role natural join appearance) as pr
where lower(title)='psycho' and production_year=1960
group by pr.id
having count(*)=1;
",2018-08-31 15:31:08.633769+10,10,1,85,correct
11805,"SELECT COUNT(*) AS NumberOfMovies FROM MOVIE m
WHERE (m.title, m.production_year) NOT IN (
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN MOVIE_AWARD) as mm
	WHERE lower(mm.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN CREW_AWARD) as mc
	WHERE lower(mc.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN DIRECTOR_AWARD) as md
	WHERE lower(md.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN WRITER_AWARD) as mw
	WHERE lower(mw.result) = ""won""
	UNION
	SELECT title, production_year
	FROM (MOVIE NATURAL JOIN ACTOR_AWARD) as ma
	WHERE lower(ma.result) = ""won"");",2018-08-31 15:31:23.446613+10,11,1,465,correct
11806,;,2018-08-31 15:31:25.440435+10,10,0,260,noninterpretable
11807,"SELECT COUNT(*) AS number_of_award
FROM writer_award wa,
writer w,
person p
WHERE
wa.title = w.title
AND wa.production_year = w.production_year
AND wa.id = w.id
AND w.id = p.id
AND lower(p.first_name) = 'woody'
AND lower(p.last_name)= 'allen'
AND wa.year_of_award >= '1991'
AND wa.year_of_award <= '1995'
AND lower(wa.result) = 'won';
",2018-08-31 15:31:30.282366+10,9,1,23,correct
11808,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born) FROM PERSON);",2018-08-31 15:31:34.9671+10,7,1,451,correct
11809,"SELECT title, production_year
FROM person, writer
WHERE person.id = writer.id AND first_name = 'Kevin' AND last_name = 'Williamson';",2018-08-31 15:31:40.970632+10,5,1,251,correct
11810,"select count(*)
from (person natural join writer_award) as pw
where pw.first_name='Woody' and pw.last_name='Allen' and pw.year_of_award>=1991 and pw.year_of_award<=1995 and pw.result='won';",2018-08-31 15:31:57.546388+10,9,1,85,correct
11811,"select count(p.id) from person p
where not exists(
	select d.id from director d where d.id = p.id
);",2018-08-31 15:31:57.817565+10,12,1,66,correct
11812,"SELECT DISTINCT p.id, p.first_name, p.last_name
FROM PERSON p
INNER JOIN WRITER w ON w.id=p.id
INNER JOIN DIRECTOR d ON d.id=p.id
WHERE d.title=w.title
GROUP BY p.id, p.first_name, p.last_name
HAVING COUNT(*)>=2
ORDER BY p.id;",2018-08-31 15:31:59.437918+10,4,1,442,correct
11813,"SELECT COUNT(*)
FROM 
PERSON P
WHERE P.ID NOT IN (SELECT ID FROM DIRECTOR );",2018-08-31 15:32:00.108051+10,12,1,182,correct
11819,"
Select id from Person natural join 

(SELECT id,count(*) as most1 from
			(SELECT id,production_year,title from director
				union
			SELECT id,production_year,title from writer) 
		as t1 group by id having most1 in	
	
					(SELECT max(most) from
						(
						SELECT id,count(*) as most from
						(SELECT id,production_year,title from director
							union
						SELECT id,production_year,title from writer) 
						as t1 group by id
					)
) 			)
; ",2018-08-31 15:32:18.358344+10,14,1,16,correct
11820,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, 
     role r,
     (SELECT max(x1.noofroles)
      FROM (SELECT r.id, count(*) AS noofroles
	       FROM role r
		   GROUP BY r.id) x1) x
WHERE x.noofroles = (SELECT max(x1.noofroles)
                     FROM (SELECT r.id, count(*) AS noofroles
	                     FROM role r
		               GROUP BY r.id) x1);",2018-08-31 15:32:20.342551+10,15,0,450,noninterpretable
11821,;,2018-08-31 15:32:27.06367+10,11,0,260,noninterpretable
11822,"select t.title,t.production_year,t.first_name,t.last_name
from (person natural join director natural join movie_award)as t
where t.award_name='BAFTA Film Award' and lower(t.category)='best film' and result='won';",2018-08-31 15:32:40.558353+10,8,1,85,correct
11823,"select id,first_name,last_name
from (person natural join director natural join writer) as pwd
group by pwd.id
having count(*)>=2;",2018-08-31 15:32:43.332871+10,4,1,18,correct
11824,"select count(*) from writer_award wa
inner join writer w on w.id = wa.id
inner join person p on p.id = w.id
where p.first_name = 'Woody' and p.last_name = 'Allen' and wa.result = 'won' and year_of_award between 1991 and 1995;",2018-08-31 15:32:53.652114+10,9,0,203,partially correct
11825,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YER_BORN)
FROM PERSON;",2018-08-31 15:32:55.818484+10,14,0,356,noninterpretable
11826,"SELECT
country
FROM
restriction
WHERE
lower(title) = 'shakespeare in love'
AND description = 'M';",2018-08-31 15:32:57.656259+10,6,1,462,correct
11827,"select count(distinct id)
from (person natural join writer) as pw
where year_born = 1935;",2018-08-31 15:33:11.421681+10,1,1,347,correct
11828,"SELECT
    r.first_name,
    r.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    (person NATURAL JOIN ROLE) AS r,
    (SELECT id, count(*) AS number_of_roles FROM ROLE GROUP BY id ) AS c
WHERE
    r.id = c.id
    AND c.number_of_roles = (
        SELECT max(number_of_roles)
        FROM (SELECT id,count ( * ) AS number_of_roles FROM ROLE GROUP BY id ));",2018-08-31 15:33:12.238983+10,15,1,325,correct
11829,select count(p.id) from person p where p.id not in (select distinct w.id from director w);,2018-08-31 15:33:18.033608+10,12,1,461,correct
11830,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:33:30.135694+10,14,1,453,correct
11831,"SELECT p.id,da.award_name,da.year_of_award,da.category
FROM PERSON p,Director_Award da,DIRECTOR d
WHERE(da.title = d.title AND p.id = d.id AND lower(da.result) ='nominated')
;",2018-08-31 15:33:37.39125+10,13,1,329,correct
11832,"SELECT count(*) FROM Movie WHERe NOT EXISTS (
SELECT * FROM (movie_award NATURAL JOIN actor_award NATURAL JOIN director_award NATURAL JOIN writer_award
NATURAL JOIN crew_award));",2018-08-31 15:33:42.230318+10,11,0,297,partially correct
11833,"select production_year, count(*)
from movie m
where m.production_year=1991
union
select production_year, count(*)
from movie m
where m.production_year=1992
union
select production_year, count(*)
from movie m
where m.production_year=1993;",2018-08-31 15:33:42.492643+10,2,1,377,correct
11834,"SELECT COUNT(*)
FROM person p
WHERE EXISTS (SELECT *
FROM writer w
WHERE p.id = w.id
AND p.year_born = 1935);
",2018-08-31 15:33:51.866124+10,1,1,285,correct
11835,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
WHERE p.year_born = (SELECT MAX(year_born)
					FROM PERSON
					GROUP BY year_born);",2018-08-31 15:33:52.18957+10,7,0,455,partially correct
11836,"select first_name,last_name,title,production_year,description
from person p natural join role r
where id = (select id
		from role
		group by id
		having count(*)=(select max(total)
					from (select id,count(*) as total
						from role
						group by id)));",2018-08-31 15:33:53.312145+10,15,1,153,correct
11837,;,2018-08-31 15:33:55.305576+10,15,0,453,noninterpretable
11838,"select title, production_year
from PERSON , WRITER
where PERSON.id = WRITER.id and first_name = 'Kevin' and last_name=  'Williamson';",2018-08-31 15:33:56.771004+10,5,1,189,correct
11839,"SELECT count(*) FROM Movie WHERe NOT EXISTS (
SELECT * FROM (movie_award NATURAL JOIN actor_award NATURAL JOIN director_award NATURAL JOIN writer_award
NATURAL JOIN crew_award));",2018-08-31 15:34:06.534147+10,11,0,297,partially correct
11840,"select
  id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-31 15:34:16.192853+10,7,1,462,correct
11841,"SELECT mad.title, mad.production_year, mad.first_name, mad.last_name
FROM (movie_award m NATURAL JOIN director d NATURAL JOIN person p) AS mad
WHERE lower(mad.category) = 'best film' AND lower(mad.award_name) = 'bafta film award';",2018-08-31 15:34:25.326015+10,8,0,420,partially correct
11842,"select count(distinct w.id)
from writer AS w inner join person As P
ON W.id=p.id
where year_born ='1935';",2018-08-31 15:34:32.14173+10,1,1,44,correct
11843,"SELECT id
FROM PERSON
WHERE year_born = (
	SELECT MAX(year_born)
	FROM PERSON
	WHERE year_born < (
		SELECT MAX(year_born)
		FROM PERSON)
	);",2018-08-31 15:34:45.576789+10,3,1,465,correct
11844,"SELECT country
FROM restriction
WHERE title = 'Shakespeare in Love' AND description = 'M';",2018-08-31 15:34:46.55752+10,6,1,251,correct
11845,"SELECT dw.id,dw.first_name,dw.last_name
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) as dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 15:35:02.490382+10,4,1,47,correct
11846,"select count(*) from writer_award wa
inner join writer w on w.id = wa.id and w.title = wa.title
inner join person p on p.id = w.id
where p.first_name = 'Woody' and p.last_name = 'Allen' and lower(wa.result) = 'won' and year_of_award between 1991 and 1995;",2018-08-31 15:35:08.743703+10,9,1,203,correct
11847,"SELECT id, award_name, year_of_award, category
FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dd
WHERE 
	lower(dd.result) = ""nominated"" 
	AND 
	dd.id NOT IN (
		SELECT id
		FROM (DIRECTOR_AWARD NATURAL JOIN DIRECTOR) dd
		WHERE lower(dd.result) = ""won"")
;",2018-08-31 15:35:25.999829+10,13,1,465,correct
11848,;,2018-08-31 15:35:28.993426+10,15,0,438,noninterpretable
11849,"SELECT x.id
FROM(
	SELECT x1.id, count(*)as times	
	FROM(SELECT id, title, production_year
		FROM director  
		UNION 
		SELECT id, title, production_year
		FROM writer ) x1) x
WHERE x.times=(SELECT MAX(x2.times)
			FROM(
	SELECT x1.id, count(*)as times	
	FROM(SELECT id, title, production_year
		FROM director 
		UNION 
		SELECT id, title, production_year
		FROM writer) x1) X2);",2018-08-31 15:35:34.237883+10,14,0,328,partially correct
11850,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
INNER JOIN WRITER w ON w.id=p.id
INNER JOIN DIRECTOR d ON d.id=p.id
WHERE d.title=w.title
GROUP BY p.id, p.first_name, p.last_name
HAVING COUNT(*)>=2
ORDER BY p.id;",2018-08-31 15:35:36.077568+10,4,1,442,correct
11851,"select production_year, count(*) as num
from movie
where production_year >1990 and production_year<1994
group by production_year;",2018-08-31 15:35:37.088697+10,2,1,347,correct
11852,"select country from restriction r
where lower(r.title) = 'shakespeare in love' and lower(r.description) = 'm';",2018-08-31 15:35:38.237782+10,6,1,156,correct
11853,"select count(*)
from person
where not exists ( select*from person where Director.id = person.id);
",2018-08-31 15:35:40.111433+10,12,0,463,noninterpretable
11854,"SELECT m.title,m.production_year
FROM movie m, writer w, person p
WHERE m.title = w.title
AND m.production_year = w.production_year
AND p.id=w.id
AND lower(p.first_name)='kevin'
AND lower(p.last_name)='williamson'
Group by m.title;",2018-08-31 15:35:51.859253+10,5,1,218,correct
11857,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:36:08.206458+10,10,1,268,correct
11858,"SELECT m.production_year,COUNT(*)
FROM movie m
WHERE m.production_year BETWEEN 1991 AND 1993
GROUP BY m.production_year;",2018-08-31 15:36:10.533659+10,2,1,285,correct
11859,"SELECT WD.ID, P.FIRST_NAME,P.LAST_NAME
FROM
PERSON P,
(SELECT ID
FROM WRITER W,
	DIRECTOR D
WHERE W.ID=D.ID AND W.TITLE=D.TITLE AND W.PRODUCTION_YEAR=D.PRODUCTION_YEAR) AS WD
WHERE WE.ID=P.ID;",2018-08-31 15:36:11.961677+10,4,0,182,noninterpretable
11860,"select count(*) from
(select   distinct p.id
from person as p, director
where p.id !=director.id)
;",2018-08-31 15:36:13.012954+10,12,0,207,partially correct
11861,"select id,first_name,last_name from person where year_born=(select max(year_born) from person where year_born not in (select max(year_born) from person));",2018-08-31 15:36:24.6573+10,7,0,203,partially correct
11862,"SELECT id FROM (
	SELECT id, COUNT(*) as count
	FROM (
		SELECT id, title, production_year
		FROM DIRECTOR
		UNION
		SELECT id, title, production_year
		FROM WRITER) 
	GROUP BY id
	) AS info
GROUP BY id
HAVING info.count = (
	SELECT MAX(info2.count) FROM (
		SELECT id, COUNT(*) as count
		FROM (
			SELECT id, title, production_year
			FROM DIRECTOR
			UNION
			SELECT id, title, production_year
			FROM WRITER) 
		GROUP BY id) as info2);",2018-08-31 15:36:31.801609+10,14,1,465,correct
11863,"select x.id,x.first_name,x.last_name
from (person natural join writer natural join director)as x
group by x.id
having count(*)>1;",2018-08-31 15:36:38.372175+10,4,1,293,correct
11864,"DELETE FROM person p1
WHERE year_born=(SELECT MAX(year_born) FROM person p1
SELECT id 
FROM person p2
WHERE year_born=(SELECT MAX(year_of_born)FROM person p2);",2018-08-31 15:36:44.229975+10,3,0,441,cheating
11865,"select first_name,last_name ,title, production_year, description 
from person,role
where person.id=role.id
and role.id= (
select  r1.id from (select r.id,count(*) as noofroles from role  r group by  r.id) as r1
where r1.noofroles =(
    select max(noofroles) from (select r.id,count(*) as noofroles from role  r group by  r.id)
    )

);




",2018-08-31 15:36:51.953599+10,15,1,374,correct
11866,"select count(*)
from person
where not exists ( select*from director where person.id = director.id);
",2018-08-31 15:36:52.605624+10,12,1,463,correct
11867,"select title,production_year from writer w
where w.id = (select p.id from person p where
lower(p.first_name)='kevin'
and lower(p.last_name) ='williamson');
",2018-08-31 15:36:52.722152+10,5,1,367,correct
11868,"SELECT p.id, p.first_name, p.last_name
FROM PERSON p
INNER JOIN WRITER w ON w.id=p.id
INNER JOIN DIRECTOR d ON d.id=p.id
WHERE d.title=w.title
GROUP BY p.id, p.first_name, p.last_name
HAVING COUNT(*)>=2;
",2018-08-31 15:36:57.691479+10,4,1,442,correct
11869,"WITH rpcount AS (SELECT id, COUNT(*) as num FROM role NATURAL JOIN person GROUP BY id)
SELECT first_name, last_name, title, production_year, description FROM role NATURAL JOIN person
	WHERE id = (SELECT id FROM rpcount WHERE num = (SELECT MAX(num) FROM rpcount))
;",2018-08-31 15:37:06.711226+10,15,1,388,correct
11870,"SELECT first_name, last_name, title, production_year, description
FROM (PERSON p INNER JOIN ROLE r ON p.id = r.id) as pr,
	(SELECT id, COUNT(*) AS NumberOfRoles
	FROM ROLE
	GROUP BY id) as a
WHERE pr.id = a.id AND
	a.NumberOfRoles = (
	SELECT MAX(b.NumberOfRoles)
	FROM (
		SELECT id, COUNT(*) as NumberOfRoles
		FROM ROLE
		GROUP BY id) as b
	)
;",2018-08-31 15:37:08.909423+10,15,1,465,correct
11871,"DELETE FROM person 
WHERE year_born=(SELECT MAX(year_born) FROM person
SELECT id 
FROM person 
WHERE year_born=(SELECT MAX(year_of_born)FROM person);",2018-08-31 15:37:09.766967+10,3,0,441,cheating
11872,"SELECT x.id
FROM(
	SELECT x1.id, count(*)as times	
	FROM(SELECT d.id, title, production_year
		FROM director d 
		UNION 
		SELECT w.id, title, production_year
		FROM writer w ) x1
		GROUP BY x1.id) x
WHERE x.times=(SELECT MAX(x2.times)
			FROM(
	SELECT x1.id, count(*)as times	
	FROM(SELECT d.id, title, production_year
		FROM director d
		UNION 
		SELECT w.id, title, production_year
		FROM writer w) x1
		GROUP BY x1.id) X2);",2018-08-31 15:37:10.761995+10,14,1,328,correct
11873,"select p.first_name, p.last_name,  r.title, r.production_year, r.description  from role r
join person p on
p.id = r.id
join 
(select id, max(ct) from (

select p.id, count(*) as ct from role r
join person p on
p.id = r.id
group by 1))z
on p.id = z.id
;",2018-08-31 15:37:13.397705+10,15,1,449,correct
11874,"select crew.id from crew,movie,appearance where 
crew.title = appearance.title and appearance.title = movie.title and appearance.production_year = movie.production_year
and movie.production_year = 1960 and movie.title='Psycho'
and appearance.scene_no is not null;",2018-08-31 15:37:17.432864+10,10,0,73,partially correct
11875,"
select p.first_name, p.last_name, r.title, r.production_year, r.description
from person p, role r,
(select id, count(*) as number_of_roles
from role
group by id) as b
where p.id = r.id and p.id = b.id 
and b.number_of_roles in (
select max(number_of_roles)
from (select id, count(*) as number_of_roles
from role group by id) as a);",2018-08-31 15:37:23.796522+10,15,1,425,correct
11876,"select count(*)
from person p

where not exists(select id from director d
where p.id=d.id);",2018-08-31 15:37:35.755278+10,12,1,377,correct
11877,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, 
     role r,
     (SELECT r.id, count(*) AS noofroles
	 FROM role r
      GROUP BY r.id) x
WHERE 
p.id = r.id
AND r.id = x.id
AND x.noofroles = (SELECT max(x1.noofroles)
                     FROM (SELECT r.id, count(*) AS noofroles
	                     FROM role r
		               GROUP BY r.id) x1) ;",2018-08-31 15:37:36.745628+10,15,1,450,correct
11878,"select p.id
from person p
where p.year_born = ( select max(year_born) from person 
                      where year_born < (select max(year_born)
					  from person));",2018-08-31 15:37:46.281666+10,3,1,225,correct
11879,"SELECT rp.id,rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description
FROM (SELECT rp.id,rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description COUNT(*) AS NoOfRoles
	FROM (roles r NATURAL JOIN person p) AS rp
	GROUP BY rp.id) x
WHERE x.NoOfRoles = (SELECT rp.id,rp.first_name, rp.last_name, rp.title, rp.production_year, rp.description MAX(x1.NoOfRoles)
			    FROM (SELECT rp.id, COUNT(*) AS NoOfRoles
			    	 FROM (roles r NATURAL JOIN person p) AS rp
	                      GROUP BY rp.id) x1);",2018-08-31 15:37:53.177592+10,15,0,145,noninterpretable
11880,"SELECT count(*) 
FROM movie m 
WHERE not exists (
SELECT title, production_year 
FROM movie_award ma 
WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
UNION
SELECT title, production_year 
FROM crew_award ca 
WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
UNION
SELECT title, production_year 
FROM director_award da 
WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
UNION
SELECT title, production_year 
FROM actor_award aa 
WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
UNION
SELECT title, production_year 
FROM writer_award wa 
WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:37:58.815878+10,11,1,260,correct
11881,"select p.first_name, p.last_name,  r.title, r.production_year, r.description  from role r
join person p on
p.id = r.id
join 
(select id, max(ct) from (

select p.id, count(*) as ct from role r
join person p on
p.id = r.id
group by 1))z
on p.id = z.id
;",2018-08-31 15:38:01.788221+10,15,1,449,correct
11882,"select id, first_name, last_name from person
where year_born = (select max(year_born) from person);",2018-08-31 15:38:08.29048+10,7,1,156,correct
11883,;,2018-08-31 15:38:17.784328+10,3,0,260,noninterpretable
11884,"SELECT p.id, p.first_name,p.last_name 
FROM Person p
WHERE p.year_born = (SELECT MAX(p1.year_born) 
FROM Person p1)
GROUP BY p.id;",2018-08-31 15:38:18.408624+10,7,1,218,correct
11885,"
select count(*)
from movie m
where not exists (select ma.title from movie_award ma where ma.title=m.title 
                   and m.production_year=ma.production_year and lower(result)='won'
                   union
                   select ca.title from crew_award ca where ca.title=m.title 
                   and m.production_year=ca.production_year and lower(result)='won'
                    union
			  select da.title from director_award da where da.title=m.title 
                   and m.production_year=da.production_year and lower(result)='won'
			   union
			   select wa.title from writer_award wa where wa.title=m.title 
                   and m.production_year=wa.production_year and lower(result)='won'
			   union 
			   select aa.title from actor_award aa where aa.title=m.title 
                   and m.production_year=aa.production_year and lower(result)='won');",2018-08-31 15:38:21.209418+10,11,1,298,correct
11886,"select p.id, first_name, last_name from person p where exists(
	select id, count(*) from (director natural join movie natural join writer) dmw where dmw.id = p.id group by id having count(*) >1
);",2018-08-31 15:38:23.173751+10,4,1,66,correct
11887,"SELECT ID, FIRST_NAME, LAST_NAME, MAX(YER_BORN)
FROM PERSON;
",2018-08-31 15:38:24.554018+10,15,0,356,noninterpretable
11888,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:38:37.169019+10,3,1,260,correct
11889,"select id from role r
where r.production_year = 1960 and r.description in (
select description from appearance
where title = 'Psycho' and production_year = 1960
group by description
having count(*)=1);",2018-08-31 15:38:39.909545+10,10,1,203,correct
11890,"DELETE FROM person p 
WHERE p.year_born=(SELECT MAX(p.year_born) FROM p
SELECT id.p
FROM person p 
WHERE p.year_born=(SELECT MAX(p.year_of_born)FROM p);",2018-08-31 15:38:45.974207+10,3,0,441,cheating
11891,;,2018-08-31 15:38:56.446382+10,13,0,260,noninterpretable
11892,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:39:01.033946+10,9,1,418,correct
11893,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:39:15.677933+10,14,1,41,correct
11894,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:39:21.520156+10,13,1,260,correct
11895,"select X.id
from (SELECT  DW.id , count(*) AS Nuofwork
      from (SELECT DIRECTOR.id, DIRECTOR.title, DIRECTOR.production_year 
            FROM DIRECTOR 
	    UNION 
	    SELECT WRITER.id, WRITER.title, WRITER.production_year 
	    FROM WRITER) AS DW
            GROUP BY DW.id) as X
WHERE X.Nuofwork = (select MAX(XX.Nuofwork2)
                     FROM (SELECT  DWDW.id , count(*) AS Nuofwork2
                           from (SELECT DIRECTOR.id, DIRECTOR.title, DIRECTOR.production_year 
                                 FROM DIRECTOR 
	                          UNION 
	                          SELECT WRITER.id, WRITER.title, WRITER.production_year 
	                          FROM WRITER) AS DWDW
                                  GROUP BY DWDW.id) AS XX );",2018-08-31 15:39:25.07763+10,14,1,139,correct
11896,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:39:31.695374+10,10,1,73,correct
11897,"SELECT w.title,w.production_year
FROM writer w, (SELECT id FROM PERSON p WHERE p.first_name=""Kevin"" AND p.last_name=""Williamson"") as k
WHERE w.id=k.id;",2018-08-31 15:39:34.215771+10,5,1,47,correct
11898,;,2018-08-31 15:39:36.375547+10,14,0,260,noninterpretable
11899,"select id, count(director_award.result = 'nominated') > 0
from person
natural join director_award
group by person.id
order by person.id;",2018-08-31 15:39:39.654199+10,13,0,358,partially correct
11900,"select count(pnid) from
(select person.id as pnid from person,director
where person.id!=director.id
group by person.id) as num;",2018-08-31 15:39:40.82176+10,12,0,192,partially correct
11901,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:39:53.937462+10,14,1,260,correct
11902,"select country
from RESTRICTION 

where description ='M' and title = 'Shakespeare in Love';",2018-08-31 15:40:01.456156+10,6,1,189,correct
11903,"select count(movie.title) from movie
where not exists(
   select 1 from movie_award where movie.title = movie_award.title
) and not exists(
  select 1 from crew_award where movie.title=crew_award.title
) and not exists(
  select 1 from director_award where movie.title=director_award.title
) and not exists(
  select 1 from actor_award where movie.title=actor_award.title
) and not exists(
  select 1 from writer_award where movie.title=writer_award.title
);",2018-08-31 15:40:02.722811+10,11,0,73,partially correct
11904,"SELECT title, production_year, first_name, last_name FROM
person NATURAL JOIN director NATURAL JOIN movie_award'
WHERE lower(award_name)='bafta%' AND lower(category)='best film';",2018-08-31 15:40:06.48788+10,8,0,393,noninterpretable
11905,;,2018-08-31 15:40:11.443986+10,15,0,260,noninterpretable
11906,"select  country
from restriction
where lower(title)='shakespeare in love'
	and lower(description)='m';",2018-08-31 15:40:14.759526+10,6,1,134,correct
11907,"select ma.title,ma.production_year,p.first_name,p.last_name 
from person p, director d, movie_award ma
where d.id = p.id
and d.title = ma.title
and d.production_year = ma.production_year
and lower(ma.category) ='best film'
and lower(ma.award_name) = 'bafta film award'
and lower(ma.result) = 'won';",2018-08-31 15:40:17.722201+10,8,1,447,correct
11908,"select id,
first_name,
last_name

from (person natural join director natural join writer) as pd

group by id
having count(*)>1;",2018-08-31 15:40:18.478649+10,4,1,377,correct
11909,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:40:18.822099+10,8,1,462,correct
11910,"SELECT count(*) FROM Movie m WHERE NOT EXISTS (

SELECT title,production_year FROM movie_award ma WHERE lower(ma.result)='won'
AND ma.title=m.title AND ma.production_year=m.production_year
 UNION
 SELECT title,production_year FROM director_award da WHERE lower(da.result)='won'
AND da.title=m.title AND da.production_year=m.production_year
UNION 
SELECT title,production_year FROM crew_award  ca WHERE lower(ca.result)='won'
AND ca.title=m.title AND ca.production_year=m.production_year
UNION 
SELECT title,production_year FROM writer_award wa WHERE lower(wa.result)='won'
AND Wa.title=m.title AND wa.production_year=m.production_year
UNION 
SELECT title,production_year FROM actor_award aa WHERE lower(aa.result)='won'
AND aa.title=m.title AND aa.production_year=m.production_year

);",2018-08-31 15:40:26.512349+10,11,1,297,correct
11911,;,2018-08-31 15:40:35.933466+10,15,0,41,noninterpretable
11912,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 15:40:36.389774+10,15,1,260,correct
11913,"SELECT count(*) 
FROM person p 
WHERE p.year_born=1935 in (SELECT * FROM writer w WHERE w.id = p.id);
",2018-08-31 15:40:41.712936+10,1,0,131,noninterpretable
11914,"select count(*)
from person p
where not exists (select * 
from director d
where p.id = d.id);",2018-08-31 15:40:42.363657+10,12,1,245,correct
11915,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:40:42.665648+10,11,1,73,correct
11916,"SELECT r.id
FROM scene s,
appearance a,
role r
WHERE
s.title = a.title
AND s.title = r.title
AND s.production_year = a.production_year
AND s.production_year = r.production_year
AND a.production_year = '1960'
AND s.scene_no = a.scene_no
AND a.description = r.description
AND lower(a.title) = 'psycho'
GROUP BY r.id
HAVING count(*) = 1;",2018-08-31 15:40:42.837762+10,10,1,23,correct
11917,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:40:51.316159+10,14,1,454,correct
11918,"select id 
from ;",2018-08-31 15:40:51.662932+10,10,0,154,noninterpretable
11919,"select country
from RESTRICTION 

where description ='M' and lower  (title) = 'Shakespeare in Love';",2018-08-31 15:40:56.801593+10,6,0,189,partially correct
11920,"select c.id
from crew c, (select mn.title,mn.production_year
from (select title,production_year,count(id) num
from crew
group by title,production_year)as mn
where mn.num = (select max(num)
from(select title,production_year,count(id) num
from crew
group by title,production_year))) a
where c.title = a.title and c.production_year = a.production_year;",2018-08-31 15:41:01.435837+10,14,0,440,partially correct
11921,"select first_name, last_name
from person
where ;",2018-08-31 15:41:01.718946+10,4,0,463,noninterpretable
11922,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:41:04.948247+10,11,1,169,correct
11923,"SELECT mw.title, mw.production_year
FROM movie m natural join writer w
GROUP BY w.name
WHERE EXISTS w.first_name = Kevin and w.last_name = Williamson
;",2018-08-31 15:41:05.585474+10,5,0,260,noninterpretable
11924,"SELECT person.id FROM person GROUP BY year_born ORDER BY year_born DESC LIMIT 1, 1 ;",2018-08-31 15:41:20.711592+10,3,1,73,correct
11925,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 15:41:22.141049+10,5,1,260,correct
11926,"select count(*)
from person
where id not in(
		select id
		from director);",2018-08-31 15:41:23.555225+10,12,1,347,correct
11927,"select id, award_name, year_of_award, category
from director natural join director_award
where id not in(
select id
from director natural join director_award
where result = ""won""
)
group by id;
",2018-08-31 15:41:26.354163+10,13,1,378,correct
11928,;,2018-08-31 15:41:27.126718+10,15,0,454,noninterpretable
11929,"select first_name, last_name, title, production_year, description
from person p, role r
where p.id=r.id and p.id in(select max(r.id)
                            from role r
				     group by r.id);",2018-08-31 15:41:28.103809+10,15,0,233,partially correct
11930,"select director.id,director_award.award_name, director_award.year_of_award,movie_award.category from director,director_award,movie_award
where director.title=director_award.title and director_award.production_year = movie_award.production_year
and director_award.`result`='0';",2018-08-31 15:41:41.211167+10,13,0,73,partially correct
11931,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:41:42.738148+10,13,1,358,correct
11932,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 15:41:47.778385+10,15,1,454,correct
11933,"SELECT COUNT  (DISTINCT id)
FROM WRITER  NATURAL JOIN PERSON
WHERE year_born = 1935;",2018-08-31 15:41:54.204408+10,1,1,160,correct
11934,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:41:59.624156+10,13,1,73,correct
11935,"SELECT *
FROM movie;",2018-08-31 15:42:02.233235+10,3,0,169,partially correct
11936,;,2018-08-31 15:42:07.419758+10,8,0,451,noninterpretable
11937,;,2018-08-31 15:42:09.686842+10,4,0,466,noninterpretable
11938,"SELECT WD.ID, P.FIRST_NAME,P.LAST_NAME
FROM
PERSON P,
(SELECT D.ID
FROM WRITER W,
	DIRECTOR D
WHERE W.ID=D.ID AND W.TITLE=D.TITLE AND W.PRODUCTION_YEAR=D.PRODUCTION_YEAR) AS WD
WHERE WD.ID=P.ID
GROUP BY WD.ID HAVING COUNT(*)>1;",2018-08-31 15:42:10.766193+10,4,1,182,correct
11939,"SELECT id,award_name,year_of_award,category
FROM director d1,director_award da1
WHERE d1.title = da1.title AND d1.production_year = da1.production_year AND lower(da1.result)='dominated';
",2018-08-31 15:42:13.665497+10,13,0,443,partially correct
11940,"SELECT d.title, d.production_year, p.first_name, p.last_name
FROM director d NATurAL JOIN person p
where d.title=(select m.title
                from movie_award m
			where m.award_name='BAFTA Film Award' and m.category='Best Film');",2018-08-31 15:42:14.358405+10,8,0,253,partially correct
11941,"SELECT
    r.title
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:42:19.685676+10,10,0,90,partially correct
11942,"select id, award_name, year_of_award, category
from director natural join director_award
where id not in(
select id
from director natural join director_award
where result = ""won""
)
;
",2018-08-31 15:42:22.453457+10,13,1,378,correct
11943,"SELECT COUNT  (DISTINCT id)
FROM WRITER  NATURAL JOIN PERSON
WHERE year_born = 1935;",2018-08-31 15:42:23.299719+10,1,1,160,correct
11944,"SELECT count(*)
FROM writer, person
WHERE writer.id = person.id
AND person.year_born = '1935';",2018-08-31 15:42:25.097718+10,1,0,366,partially correct
11945,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) AS x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:42:29.416081+10,14,1,217,correct
11946,"SELECT country
FROM restriction r
WHERE title = ""Shakespeare in Love""
AND description = ""M"";",2018-08-31 15:42:46.064913+10,6,1,47,correct
11947,"SELECT COUNT(*)
FROM person p
WHERE p.id NOT IN(
	SELECT d.id
	FROM director d
);",2018-08-31 15:42:54.056775+10,12,1,285,correct
11948,"SELECT id, first_name, last_name
FROM person
WHERE (year_born);",2018-08-31 15:42:57.743712+10,7,0,251,partially correct
11949,"select country from restriction 
where lower(title) = 'shakespeare in love'
and low(descriptiom) = 'm';",2018-08-31 15:43:05.02664+10,6,0,367,noninterpretable
11950,"select country from restriction 
where lower(title) = 'shakespeare in love'
and low(description) = 'm';",2018-08-31 15:43:24.871125+10,6,0,367,noninterpretable
11951,"select country from restriction 
where lower(title) = 'shakespeare in love'
and lower(description) = 'm';",2018-08-31 15:43:34.021982+10,6,1,367,correct
11952,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 15:43:34.525308+10,5,1,293,correct
11953,"with ma as (
	select title,production_year from movie_award
	where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won'
)

select ma.title, ma.production_year, p.first_name, p.last_name from ma, director d, person p
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;",2018-08-31 15:43:37.539608+10,8,1,156,correct
11954,"select title ,
production_year

from writer w,

person p

where lower(p.first_name)='kevin'
and lower(p.last_name)='williamson'
and w.id=p.id;",2018-08-31 15:43:48.404849+10,5,1,377,correct
11955,"select md.title, md.production_year, md.first_name, md.last_name
from (movie_award natural join director natural join person) as md
where lower(md.award_name) = 'bafta film award' and lower(md.category) = 'best film';",2018-08-31 15:43:48.731019+10,8,0,455,partially correct
11956,"select dw1.id
from (select dw.id,count(*) as dwcount from (select id,title,production_year from director
                                       union
						     select id,title,production_year from writer) dw group by dw.id) dw1
where dw1.dwcount=
           (select max(dw2.dwcount) 
		   from (select dw.id,count(*) as dwcount from (select id,title,production_year from director
                                       union
						     select id,title,production_year from writer) dw group by dw.id) dw2);",2018-08-31 15:43:51.741082+10,14,1,223,correct
11957,"select title, production_year
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
where lower(dw.first_name) like ""kevin"" and lower(dw.last_name) like ""williamson"";",2018-08-31 15:43:54.421847+10,5,0,318,partially correct
11958,"SELECT COUNT(*)
FROM movie m, movie_award ma, crew_award ca, director_award da, writer_award wa, actor_award aa
WHERE NOT EXISTS (m.title = ma.title
			AND m.title = ca.title
			AND m.title = da.title
			AND m.title = wa.title
			AND m.title = aa.title
			AND m.production_year = ma.production_year
			AND m.production_year = ca.production_year
			AND m.production_year = da.production_year
			AND m.production_year = wa.production_year
			AND m.production_year = aa.production_year);",2018-08-31 15:43:58.245816+10,11,0,268,noninterpretable
11959,"select dw.id, dw.first_name, dw.last_name
from (person natural join director natural join writer) as dw
group by dw.id having count(*)>1;",2018-08-31 15:43:59.789631+10,4,1,463,correct
11960,"select country
from RESTRICTION 

where description ='M' and lower  (title) = 'Shakespeare in Love';",2018-08-31 15:44:00.88402+10,6,0,189,partially correct
11961,"SELECT p.id FROM person p WHERE year_born<(
SELECT max(year_born) FROM person
) ORDER BY year_born desc Limit 1;",2018-08-31 15:44:06.814493+10,3,1,297,correct
11962,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:44:08.227991+10,9,1,462,correct
11963,"select country
from RESTRICTION 

where description ='M' and title = 'Shakespeare in Love';",2018-08-31 15:44:22.32277+10,6,1,189,correct
11964,"select id, first_name, last_name
from (person natural join director natural join writer) as pdw
group by id having count(*) >1;",2018-08-31 15:44:23.634691+10,4,1,347,correct
11965,Select count(*) from person where year_born = 1935;,2018-08-31 15:44:31.133147+10,1,0,206,partially correct
11992,"SELECT count(*) 
FROM movie
where movie.title not in (select title from actor_award WHERE result = 'won' union select title from crew_award WHERE result = 'won' union select title from  director_award  WHERE result = 'won' union select title from  movie_award  WHERE result = 'won' union select title from writer_award WHERE result = 'won');",2018-08-31 15:46:38.996053+10,11,0,459,partially correct
11994,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 15:46:52.811275+10,4,1,73,correct
12097,SELECT COUNT(*) from PERSON where (SELECT distinct id FROM WRITER WHERE WRITER.id=PERSON.id AND PERSON.year_born=1935);,2018-08-31 15:54:40.783189+10,1,1,85,correct
11966,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:44:42.374235+10,11,1,268,correct
11967,"select person.first_name,person.last_name,role.* from person,role 
where person.id = role.id and exists(
 select 1 from movie where movie.production_year = role.production_year
);",2018-08-31 15:44:42.896185+10,15,0,73,partially correct
11968,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:44:44.133682+10,8,1,451,correct
11969,"SELECT COUNT(title), production_year
FROM Movie
WHERE production_year=1991 OR production_year=1992 OR production_year=1993
GROUP by production_year;",2018-08-31 15:44:49.15747+10,2,1,281,correct
11970,"select dw.title, dw.production_year
FROM (person p NATURAL JOIN writer) AS dw 
where lower(dw.first_name) like ""kevin"" and lower(dw.last_name) like ""williamson"";",2018-08-31 15:44:57.915543+10,5,1,318,correct
11971,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 15:45:02.715617+10,15,1,73,correct
11972,"select count(*) from movie m
where m.title not exist Movie_Award and
crew_award and director_award and writer_award and actor_award;",2018-08-31 15:45:04.857431+10,11,0,196,noninterpretable
11973,"SELECT count(*)
FROM person p
WHERE EXISTS (SELECT *
FROM writer w
WHERE p.id=w.id
AND p.year_born=1935);
",2018-08-31 15:45:07.713047+10,1,1,312,correct
11974,"select first_name, last_name, title, production_year, description
from
(select id, first_name, last_name, title, production_year, description, count(*) as cn
from person natural join role 
group by id
having cn =
(select max(cn) from
(select id, count(*) as cn
from person natural join role 
group by id)));

",2018-08-31 15:45:10.243646+10,15,0,378,partially correct
11975,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM (role r NATURAL JOIN person p) AS rp,
	(SELECT id, COUNT(*) AS NoOfRoles
	FROM role
	GROUP BY id) AS x
WHERE rp.id = x.id AND x.NoOfRoles = (SELECT MAX(NoOfRoles)
			   			    FROM (SELECT id, COUNT(*) AS NoOfRoles
								FROM role
								GROUP BY id) );",2018-08-31 15:45:25.796932+10,15,1,145,correct
11976,"With pr as 
(select id,count(*) as num
	from role
	group by id)

select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r, pr
where p.id =r.id
	and p.id in (select id from pr where num = (select max(num) from pr))
group by p.first_name,p.last_name,r.title,r.production_year,r.description
;",2018-08-31 15:45:28.595767+10,15,1,457,correct
11977,"SELECT mad.title, mad.production_year, mad.first_name, mad.last_name
FROM (movie_award m NATURAL JOIN director d NATURAL JOIN person p) AS mad
WHERE lower(mad.category) = 'best film' AND lower(mad.award_name) = 'bafta film award' AND lower(mad.result) = 'won';",2018-08-31 15:45:28.899348+10,8,1,420,correct
11978,"select count(director.id) from director where 
not exists (
select 1 from movie where director.title=movie.title and director.production_year=movie.production_year
);",2018-08-31 15:45:32.912841+10,12,0,73,partially correct
11979,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:45:43.599179+10,9,1,462,correct
11980,"SELECT id
FROM person
WHERE year_born = 
(
SELECT MAX(year_born)
FROM(
SELECT year_born
FROM person
WHERE year_born<
	(SELECT MAX(year_born)
	FROM person) )
);
",2018-08-31 15:45:45.403323+10,3,1,173,correct
11981,"select md.title, md.production_year, md.first_name, md.last_name
from (movie_award natural join director natural join person) as md
where lower(md.award_name) = 'bafta film award' and lower(md.category) = 'best film' and lower(md.result) = 'won';",2018-08-31 15:45:45.918239+10,8,1,455,correct
11982,"SELECT count(*) 
FROM person p 
WHERE NOT EXISTS (SELECT * 
	FROM director d 
	WHERE p.id = d.id);",2018-08-31 15:45:50.045821+10,12,1,73,correct
11983,"SELECT id, first_name,last_name
FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-31 15:45:50.500501+10,7,1,47,correct
11984,;,2018-08-31 15:46:00.733479+10,4,0,461,noninterpretable
11985,"SELECT mwp.title, mwp.production_year
FROM (MOVIE m 
NATURAL JOIN WRITER w
NATURAL JOIN PERSON p) AS mwp
WHERE mwp.first_name='Kevin' AND mwp.last_name='Williamson';",2018-08-31 15:46:07.188408+10,5,1,442,correct
11986,"SELECT id,award_name,year_of_award,category
FROM director d1,director_award da1
WHERE d1.title = da1.title AND d1.production_year = da1.production_year AND lower(da1.result)='nominated'
      AND d1.id NOT IN(SELECT id FROM director d,director_award da WHERE d.title = da.title AND d.production_year = da.production_year
	                                                                   AND lower(da.result) = 'won');
",2018-08-31 15:46:14.074965+10,13,1,443,correct
11987,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:46:17.781588+10,8,1,253,correct
11988,"select person.id,person.first_name,person.last_name  from director,movie,writer,person 
having count(writer.production_year) >= 2
where director.id=person.id and movie.production_year = director.production_year and movie.production_year = writer.production_year;",2018-08-31 15:46:21.453432+10,4,0,73,noninterpretable
11989,"SELECT TITLE, PRODUCTION_YEAR
FROM WRITER W,
PERSON P
WHERE P.ID=W.ID AND P.FIRST_NAME='Kevin' and P.LAST_NAME='Williamson';",2018-08-31 15:46:23.149146+10,5,1,182,correct
11990,"SELECT production_year, COUNT (title)
FROM movie
WHERE production_year in (1991,1992,1993)
GROUP BY production_year;",2018-08-31 15:46:30.073633+10,2,1,160,correct
11991,"select country
from restriction
where lower(title)='shakespeare in love'and lower(description)='m';",2018-08-31 15:46:31.36837+10,6,1,293,correct
11993,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT max(year_born)
FROM person);",2018-08-31 15:46:48.163852+10,7,1,251,correct
11995,"select id,first_name,last_name
from person
where year_born=(select max(year_born)
			from person);",2018-08-31 15:46:54.062991+10,7,1,134,correct
11997,"select movie.title,movie.production_year from movie,director,person 
where movie.title = director.title and movie.production_year = director.production_year 
and director.id=person.id and person.first_name = 'Kevin' and person.last_name='Williamson';",2018-08-31 15:47:17.251047+10,5,0,73,partially correct
11998,"SELECT title, production_year, first_name, last_name FROM
person NATURAL JOIN director NATURAL JOIN movie_award
WHERE award_name='BAFTA Film Award'
AND lower(category)='best film'
AND lower(result)='won';",2018-08-31 15:47:21.02438+10,8,1,393,correct
11999,"select count(*) from person
where not exists(select id from director
			where person.id=director.id);",2018-08-31 15:47:22.193681+10,12,1,192,correct
12000,"SELECT
    w.title, w.production_year
FROM
    writer w,
    person p
WHERE
    w.id = p.id
    AND lower(first_name)= 'kevin'
    AND lower(last_name)= 'williamson';",2018-08-31 15:47:33.857859+10,5,1,73,correct
12001,"SELECT m.title, m.production_year, p.first_name, p.last_name
FROM Movie m, Director d, movie_award ma, Person p
WHERE m.title = d.title
AND d.title = ma.title
AND m.production_year = d.production_year
AND d.production_year = ma.production_year
AND d.id = p.id
AND lower(ma.award_name) ='bafta film award'
AND lower(ma.category) = 'best film'
AND lower(ma.result) = 'won'
Group by m.title, p.first_name;",2018-08-31 15:47:36.866848+10,8,1,218,correct
12002,"select count(*)
from writer w, person p
where w.id = p.id 
and p.year_born = 1935
group by p.id;

",2018-08-31 15:47:40.24347+10,1,0,425,partially correct
12003,"select count(PERSON.id)
from PERSON
WHERE PERSON.id NOT IN( select id
                        from DIRECTOR);",2018-08-31 15:47:45.557857+10,12,1,139,correct
12004,"select p.id from person p
where p.year_born = (select MAX(year_born)from person 
				where person.year_born <(select MAX(year_born)from person));",2018-08-31 15:47:49.121716+10,3,1,401,correct
12005,"select restriction.country from restriction,restriction_category,movie where 
restriction.country = restriction_category.country and movie.country=restriction.country 
and movie.title=""Shakespeare in love as 'M'"";",2018-08-31 15:47:59.49993+10,6,0,73,partially correct
12006,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
                     FROM person
                     WHERE year_born < (SELECT MAX(year_born)
                                        FROM person));",2018-08-31 15:48:04.702449+10,3,1,169,correct
12007,;,2018-08-31 15:48:04.832069+10,5,0,461,noninterpretable
12008,"SELECT production_year, COUNT (title)
FROM movie
WHERE production_year =1991 or production_year =1992 or production_year = 1993
GROUP BY production_year;",2018-08-31 15:48:09.940222+10,2,1,160,correct
12009,"select kw.title, kw.production_year
from (;",2018-08-31 15:48:14.317461+10,5,0,463,noninterpretable
12010,"SELECT
    country
FROM
    restriction
WHERE
    lower(title) = 'shakespeare in love'
    AND description = 'M';",2018-08-31 15:48:15.928298+10,6,1,73,correct
12011,;,2018-08-31 15:48:19.076836+10,9,0,451,noninterpretable
12012,"Select title, production_year
from writer
where writer.id in
(
select person.id
from person
where first_name = 'Kevin' AND last_name = 'Williamson');",2018-08-31 15:48:23.682402+10,5,1,45,correct
12013,"SELECT production_year, COUNT (title)
FROM movie
WHERE production_year in (1991,1992,1993)
GROUP BY production_year;",2018-08-31 15:48:32.760128+10,2,1,160,correct
12014,"SELECT COUNT(*)
FROM PERSON p
WHERE p.year_born = 1935;",2018-08-31 15:48:34.577808+10,1,0,423,partially correct
12015,;,2018-08-31 15:48:44.199654+10,6,0,461,noninterpretable
12016,"select person.id,person.first_name,person.last_name from person where person.year_born = (select min(person.year_born)
from person group by year_born);",2018-08-31 15:48:46.976075+10,7,0,73,partially correct
12017,"SELECT id
FROM person 
WHERE year_born = ( 
SELECT MAX(year_born)
FROM person
WHERE year_born<(SELECT MAX(year_born)
FROM person));",2018-08-31 15:48:47.781422+10,3,1,193,correct
12018,select country from Restriction as r where lower(r.title) like 'shakespeare in love' and lower(r.description) like 'm';,2018-08-31 15:48:55.606634+10,6,1,318,correct
12019,"SELECT
    id,
    first_name,
    last_name
FROM
    person p
WHERE
    p.year_born = (
        SELECT
            max(year_born)
        FROM
            person );",2018-08-31 15:49:01.603581+10,7,1,73,correct
12020,"with ma as (select title, production_year from movie_award
 where lower(result)='won'),
 ca as (select title, production_year from crew_award
 where lower(result)='won'),
 da as (select title, production_year from director_award
 where lower(result)='won'),
 wa as (select title, production_year from writer_award
 where lower(result)='won'),
 aa as(select title, production_year from actor_award
 where lower(result)='won'),
 list as(select * from ma union select * from ca union select * from da union select * from wa union select * from aa)
 select count(*) from movie m
 where not exists (select * from list);
",2018-08-31 15:49:10.974206+10,11,0,323,partially correct
12021,"select title, production_year from writer natural join person where first_name = 'Kevin' and last_name = 'Williamson';",2018-08-31 15:49:11.057584+10,5,1,66,correct
12022,;,2018-08-31 15:49:20.437577+10,7,0,461,noninterpretable
12023,"select count(wa.id) from writer_award as wa
join writer on wa.id = writer.id and wa.production_year = writer.production_year
join person as p on p.id = writer.id
where wa.year_of_award in (1991,1992,1993,1994,1995)
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
Group by wa.year_of_award;",2018-08-31 15:49:21.095598+10,9,0,447,partially correct
12024,"select movie.title,movie.production_year,person.first_name,person.last_name from person,director,movie,movie_award
where person.id=director.id and director.title=movie.title and movie.production_year=movie_award.production_year
and movie_award.award_name='BAFTA Film Award' and movie_award.category = 'Best Film';",2018-08-31 15:49:25.34818+10,8,0,73,partially correct
12025,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 15:49:29.849403+10,4,1,466,correct
12026,"select count(*) from writer w, person p, writer_award wa
where w.title = wa.title and w.production_year = wa.production_year and w.id = p.id
and lower(wa.result) = 'won' and wa.year_of_award <=1995 and wa.year_of_award >=1991
and lower(p.first_name) = 'woody' and lower(p.last_name) = 'allen';",2018-08-31 15:49:31.340138+10,9,1,156,correct
12027,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:49:35.284438+10,10,1,462,correct
12028,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) 
FROM person 
WHERE year_born<MAX(year_born);",2018-08-31 15:49:38.505576+10,3,0,441,noninterpretable
12029,"with ma as (select title, production_year from movie_award
 where lower(result)='won'),
 ca as (select title, production_year from crew_award
 where lower(result)='won'),
 da as (select title, production_year from director_award
 where lower(result)='won'),
 wa as (select title, production_year from writer_award
 where lower(result)='won'),
 aa as(select title, production_year from actor_award
 where lower(result)='won'),
 list as(select * from ma union select * from ca union select * from da union select * from wa union select * from aa)
 select count(*) from movie m
 where m.title not in (select title from list);
",2018-08-31 15:49:39.138211+10,11,0,323,partially correct
12030,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 15:49:44.163689+10,8,1,73,correct
12031,;,2018-08-31 15:49:48.95522+10,8,0,461,noninterpretable
12098,"select count(*)
from person p 
where p.id not in (select d.id from director d);",2018-08-31 15:54:52.673484+10,12,1,201,correct
12032,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:49:51.409908+10,9,1,451,correct
12033,"select country from restriction
where title='Shakespeare in Love' and description='M';",2018-08-31 15:50:00.773899+10,6,1,85,correct
12034,"select count(writer_award.id) from writer_award,writer,person 
where writer.id=person.id and writer.title=writer_award.title and writer_award.production_year=writer.production_year
and writer_award.production_year between 1991 and 1995 ;",2018-08-31 15:50:06.054551+10,9,0,73,partially correct
12035,"SELECT d.id,dw.award_name,dw.yeaR_of_award,dw.category FROM director d, director_award dw WHERE (dw.result)='nominated'
;",2018-08-31 15:50:10.346526+10,13,0,297,partially correct
12036,"SELECT count(*)
FROM person p
WHERE EXISTS (
	SELECT *
	FROM writer w
	WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 15:50:11.325787+10,1,1,425,correct
12037,"select p.id,p.first_name,p.last_name
from person p
where p.year_born=(select max(year_born)from person);",2018-08-31 15:50:16.274315+10,7,1,293,correct
12038,"with ma as (select title, production_year from movie_award
 where lower(result)='won'),
 ca as (select title, production_year from crew_award
 where lower(result)='won'),
 da as (select title, production_year from director_award
 where lower(result)='won'),
 wa as (select title, production_year from writer_award
 where lower(result)='won'),
 aa as(select title, production_year from actor_award
 where lower(result)='won'),
 list as(select * from ma union select * from ca union select * from da union select * from wa union select * from aa)
 select count(*) from movie m
 where m.title not in (select title from list);
",2018-08-31 15:50:19.461946+10,11,0,323,partially correct
12039,"select count(*)
from (writer natural join writer_award natural join person) as wwp
where lower(wwp.first_name) = 'woody' and lower(wwp.last_name) = 'allen' and lower(wwp.result) = 'won' and wwp.year_of_award >= 1991 and wwp.year_of_award <= 1995
group by wwp.id;",2018-08-31 15:50:20.413653+10,9,1,455,correct
12040,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 15:50:24.441827+10,9,1,73,correct
12041,"select w.title,w.production_year
from person,writer as w
where person.id=w.id and person.first_name='Kevin' and person.last_name='Williamson';",2018-08-31 15:50:25.257481+10,5,1,85,correct
12042,"select count (*) form (
select distinct p.id from person p,writer w 
where p.id = w.id
and p.year_born = 1935);",2018-08-31 15:50:28.306517+10,1,0,367,noninterpretable
12043,"select writer.title, writer.production_year
from writer, person
where writer.id=person.id and lower(first_name)='kevin' and lower(last_name)='willianmson';",2018-08-31 15:50:29.298694+10,5,0,463,partially correct
12044,"SELECT count(*) FROM 
Writer_award wa, Person p
WHERE wa.id = p.id
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND wa.production_year>1990
AND wa.production_year<1996;
",2018-08-31 15:50:31.570673+10,9,1,218,correct
12045,;,2018-08-31 15:50:31.842158+10,9,0,461,noninterpretable
12046,"SELECT COUNT(id)
FROM person
WHERE EXISTS(SELECT id FROM director WHERE person.id != director.id);",2018-08-31 15:50:32.561579+10,12,0,281,partially correct
12047,"select 
scene_no = (
  select scene_no
  from appearance
  where lower(title) = 'psycho' and production_year = 1960)
;",2018-08-31 15:50:42.32579+10,10,0,211,noninterpretable
12048,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 15:50:53.942432+10,14,1,323,correct
12049,"select count(*)
from movie m
where not exists (select title, production_year from movie_award ma
where lower(result) = 'won'
and ma.title = m.title
and ma.production_year = m.production_year
union
select title, production_year from crew_award ca
where lower(result) = 'won'
and ca.title = m.title
and ca.production_year = m.production_year
union
select title, production_year from director_award da
where lower(result) = 'won'
and da.title = m.title
and da.production_year = m.production_year
union
select title, production_year from writer_award wa
where lower(result) = 'won'
and wa.title = m.title
and wa.production_year = m.production_year
union
select title, production_year from actor_award aa
where lower(result) = 'won'
and aa.title = m.title
and aa.production_year = m.production_year);",2018-08-31 15:50:54.116436+10,11,1,250,correct
12050,;,2018-08-31 15:51:05.755956+10,10,0,451,noninterpretable
12051,"select count(*) from (
select distinct p.id from person p,writer w 
where p.id = w.id
and p.year_born = 1935);",2018-08-31 15:51:06.640014+10,1,1,367,correct
12052,"SELECT COUNT(*)
FROM (PERSON p NATURAL JOIN WRITER) AS pw
WHERE pw.year_born = 1935;",2018-08-31 15:51:07.275115+10,1,0,423,partially correct
12053,"select writer.title, writer.production_year
from writer, person
where writer.id=person.id and lower(first_name)='kevin' and lower(last_name)='williamson';",2018-08-31 15:51:26.222438+10,5,1,463,correct
12054,"SELECT mwp.title, mwp.production_year
FROM (MOVIE m 
NATURAL JOIN WRITER
NATURAL JOIN PERSON) AS mwp
WHERE mwp.first_name='Kevin' AND mwp.last_name='Williamson';",2018-08-31 15:51:27.745843+10,5,1,442,correct
12055,"select count(wa.id) from writer_award as wa
join writer on wa.id = writer.id and wa.production_year = writer.production_year
and writer.title = wa.title
join person as p on p.id = writer.id
where wa.year_of_award in (1991,1992,1993,1994,1995)
and lower(p.first_name) = 'woody'
and lower(p.last_name) = 'allen'
and lower(result) = 'won'
Group by wa.year_of_award;",2018-08-31 15:51:32.914635+10,9,1,447,correct
12056,"select d.id, da.award_name,da.year_of_award,da.category
from director d, director_award da
where d.title=da.title and d.production_year=da.production_year 
      and lower(da.result)='nominated'
group by d.id
having count(*)>0;",2018-08-31 15:51:33.017021+10,13,1,298,correct
12057,"SELECT production_year, count (*)
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 15:51:40.774033+10,2,1,201,correct
12058,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) 
FROM person 
WHERE year_born<(SELECT (MAX(year_born) FROM person));",2018-08-31 15:51:45.471874+10,3,0,441,noninterpretable
12059,;,2018-08-31 15:51:51.756033+10,10,0,461,noninterpretable
12060,"SELECT count(*)
FROM (
SELECT DISTINCT P.id
	FROM writer w, person p
	WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 15:52:01.897629+10,1,1,425,correct
12061,"select count(id)-(select count(id) from (select distinct id from director) as t) from person;
",2018-08-31 15:52:03.239446+10,12,1,85,correct
12062,"select  p.id,first_name, last_name
from person as p,(
	select d.id as y,count(*)
	from director as d, writer as w
	where d.id =w.id
	and d.title=w.title
	group by d.id
	having count(*)>1) as x1
where p.id =x1.y
;",2018-08-31 15:52:14.004938+10,4,1,207,correct
12063,";
",2018-08-31 15:52:18.720392+10,11,0,461,noninterpretable
12064,"SELECT p.id
FROM person p
WHERE p.year_born=(SELECT MAX(year_born) 
FROM person 
WHERE year_born<(SELECT MAX(year_born) FROM person));",2018-08-31 15:52:23.512527+10,3,1,441,correct
12095,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r
WHERE p.id=r.id
AND   p.id=(SELECT x.id
            FROM (SELECT r1.id, count(*) as times
			FROM role r1
			GROUP BY r1.id) as x
		WHERE x.times=(SELECT MAX(x1.times)
		               FROM (SELECT r1.id, count(*) as times
						FROM role r1
						GROUP BY r1.id) as x1));",2018-08-31 15:54:29.891314+10,15,1,328,correct
12065,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);
",2018-08-31 15:52:28.540199+10,14,1,198,correct
12066,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:52:30.739873+10,11,1,459,correct
12067,"SELECT COUNT(DISTINCT title) AS movie_total, production_year FROM movie
WHERE production_year IN (select production_year from movie 
	WHERE production_year = '1993' OR production_year = '1992' or production_year = '1991')
GROUP BY production_year;
",2018-08-31 15:52:32.886856+10,2,1,38,correct
12068,"select id from role where description = (
select description from appearance where title like ""psycho"" and production_year=1960 
group by description 
having count(description)=1) and role.production_year=1960;",2018-08-31 15:52:42.508352+10,10,0,234,partially correct
12069,"SELECT id
FROM director d , writer w
GROUP BY id
HAVING COUNT(*)=(SELECT MAX(COUNT(*)) 
                 FROM drictor UNION writer  
                 GROUP BY id);",2018-08-31 15:52:46.790956+10,14,0,443,noninterpretable
12070,;,2018-08-31 15:52:59.836434+10,10,0,451,noninterpretable
12071,;,2018-08-31 15:53:02.41194+10,3,0,461,noninterpretable
12072,select count(*) from writer w where exists (select id from person p where w.id = p.id and p.year_born = 1935);  ,2018-08-31 15:53:13.912288+10,1,0,206,partially correct
12073,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:53:15.047771+10,10,1,451,correct
12074,"select id,first_name,last_name
from person
where year_born=(select max(year_born)
from person);",2018-08-31 15:53:15.719448+10,7,1,377,correct
12075,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-31 15:53:16.39356+10,6,1,66,correct
12076,"SELECT COUNT(*) from WRITER,person where WRITER.id=PERSON.id AND PERSON.year_born=1935;",2018-08-31 15:53:22.762082+10,1,0,85,partially correct
12077,"select id from role where description in (
select description from appearance where title like ""psycho"" and production_year=1960 
group by description 
having count(description)=1) and role.production_year=1960;",2018-08-31 15:53:23.817591+10,10,1,234,correct
12078,"SELECT id, first_name, last_name FROM person
where person.year_born = (select MAX(year_born) from person);",2018-08-31 15:53:24.292599+10,7,1,318,correct
12079,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-31 15:53:29.622584+10,6,1,45,correct
12080,;,2018-08-31 15:53:31.263117+10,11,0,451,noninterpretable
12081,select count(*) from writer w where exists (select * from person p where w.id = p.id and p.year_born = 1935);  ,2018-08-31 15:53:31.771353+10,1,0,206,partially correct
12082,;,2018-08-31 15:53:31.881547+10,10,0,386,noninterpretable
12083,;,2018-08-31 15:53:32.113583+10,13,0,461,noninterpretable
12084,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da 
WHERE d.title = da.title
AND d.production_year = da.production_year
GROUP BY d.id, da.award_name, da.year_of_award, da.category
HAVING COUNT(da.result = 0) AND COUNT(*) >= 1;",2018-08-31 15:53:36.453436+10,13,0,169,partially correct
12085,"select title, production_year from writer w
where w.id IN (select p.id from person p 
where p.last_name='Williamson' AND p.first_name='Kevin');",2018-08-31 15:53:36.566147+10,5,1,466,correct
12086,"select title, production_year
from writer
where id in (
		select id
		from person
		where lower(first_name) = lower('Kevin')
		and lower(last_name) = lower('Williamson'));",2018-08-31 15:53:36.730012+10,5,1,347,correct
12087,select count(*) from writer w where exists (select * from person p where w.id = p.id and p.year_born = 1935);  ,2018-08-31 15:53:39.67934+10,1,0,206,partially correct
12088,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year);",2018-08-31 15:53:43.597732+10,11,0,462,partially correct
12089,"


select z.* from
(select * from writer where title in (select title from writer
group by 1
having count(*) > 1))z

join 
(select * from writer where title in (select title from writer
group by 1
having count(*) > 1))q
on z.title = q.title
and z. production_year = q.production_year
and q.id != z.id
;",2018-08-31 15:54:01.110139+10,2,0,449,partially correct
12090,;,2018-08-31 15:54:03.344276+10,14,0,461,noninterpretable
12091,"SELECT count(*)
FROM (writer_award wa NATURAL JOIN writer w NATURAL JOIN person p) AS wwp
WHERE lower(wwp.first_name) = 'woody' AND lower(wwp.last_name) = 'allen' AND wwp.year_of_award >1990 AND wwp.year_of_award <1996;",2018-08-31 15:54:23.010568+10,9,0,420,partially correct
12092,"select count(*)
from movie m
where not exists 
(select ma.title, ma.production_year
from  movie_award ma
where lower(ma.result)='won'
and ma.title=m.title
and ma.production_year=m.production_year
union
select ca.title, ca.production_year
from  crew_award ca
where lower(ca.result)='won'
and ca.title=m.title
and ca.production_year=m.production_year
union
select da.title, da.production_year
from  director_award da
where lower(da.result)='won'
and da.title=m.title
and da.production_year=m.production_year
union
select wa.title, wa.production_year
from  writer_award wa
where lower(wa.result)='won'
and wa.title=m.title
and wa.production_year=m.production_year
union
select aa.title, aa.production_year
from  actor_award aa
where lower(aa.result)='won'
and aa.title=m.title
and aa.production_year=m.production_year
);",2018-08-31 15:54:23.759158+10,11,1,237,correct
12093,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d INNER JOIN director_award da
ON d.title=da.title AND d.production_year=da.production_year
WHERE lower(result)='nominated' 
AND d.id NOT IN
(
	SELECT d.id
	FROM director d INNER JOIN director_award da
	ON d.title=da.title AND d.production_year=da.production_year
	WHERE lower(result)='won'  

);",2018-08-31 15:54:24.799781+10,13,1,173,correct
12094,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:54:26.18922+10,11,1,462,correct
12096,;,2018-08-31 15:54:31.942491+10,15,0,461,noninterpretable
12100,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 15:55:01.457944+10,11,1,451,correct
12101,"select id, first_name, last_name
from person p
where exists (select *
from writer w , director d
where w.title = d.title and w.production_year = d.production_year)
group by id
having count(id) >= 2;",2018-08-31 15:55:09.866277+10,4,0,245,partially correct
12102,;,2018-08-31 15:55:12.789987+10,3,0,451,noninterpretable
12103,"SELECT production_year, COUNT(*) FROM movie
WHERE production_year IN (select production_year from movie 
	WHERE production_year = '1993' OR production_year = '1992' or production_year = '1991')
GROUP BY production_year;
",2018-08-31 15:55:13.249037+10,2,1,38,correct
12104,"select country
from restriction
where lower(title) = lower('Shakespeare in Love')
and lower(description) = 'm';",2018-08-31 15:55:33.222813+10,6,1,347,correct
12105,"Select id, first_name, last_name
from person
order by year_born DESC
limit 1;
",2018-08-31 15:55:38.839748+10,7,1,45,correct
12106,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:55:47.821588+10,3,1,451,correct
12107,"SELECT x.id
FROM (SELECT x1.id,count(*) AS number
	FROM (SELECT d.id,title,production_year
		FROM director d
	UNION
		SELECT w.id,title,w.production_year
		FROM writer w) x1
	GROUP BY x1.id)x
WHERE x.number =(SELECT MAX(x2.number)
			FROM (SELECT x1.id,count(*) AS number
				FROM (SELECT d.id,title,production_year
					FROM director d
				UNION
					SELECT w.id,title,production_year
					FROM writer w) x1
			GROUP BY x1.id) x2);",2018-08-31 15:55:51.355297+10,14,1,217,correct
12108,"SELECT COUNT(id)
FROM (PERSON NATURAL JOIN WRITER) AS pw
WHERE pw.year_born = 1935;",2018-08-31 15:56:00.865838+10,1,0,423,partially correct
12109,"select count(*)
from person p 
where p.id not in (select d.id from director d where p.id = d.id);",2018-08-31 15:56:03.047909+10,12,1,201,correct
12110,"SELECT id from ROLE as r natural join Appearance as a  group by title,production_year,description having 
		lower(title)='psycho'
		and
		production_year='1960'
		and 
		count(*)=1;",2018-08-31 15:56:13.991303+10,10,1,16,correct
12111,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM movie_award AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND lower(award_name)= 'bafta film award'
    AND lower(category)= 'best film'
    AND lower(RESULT)= 'won'
    AND d.id = p.id;",2018-08-31 15:56:16.885324+10,8,1,266,correct
12112,"select ma.title,ma.production_year,p.first_name,p.last_name
from movie_award ma,person p,director d
where ma.title=d.title
and ma.production_year=d.production_year
and lower(ma.category)='best film'
and lower(ma.result)='won'
and lower(ma.award_name)='bafta film award'
and d.id=p.id;",2018-08-31 15:56:26.769178+10,8,1,293,correct
12113,"SELECT d.TITLE, d.PRODUCTION_YEAR, p.FIRST_NAME, p.LAST_NAME
FROM PERSON P, 
MOVIE_AWARD MA,
DIRECTOR D
WHERE D.TITLE=MA.TITLE AND D.PRODUCTION_YEAR=MA.PRODUCTION_YEAR AND P.ID=D.ID AND lower(MA.AWARD_NAME)='bafta film award' AND lower(MA.CATEGORY)= 'best film' AND lower(MA.RESULT)='won';",2018-08-31 15:56:32.362022+10,8,1,182,correct
12114,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id )  b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id )  a );",2018-08-31 15:56:37.76229+10,15,1,136,correct
12115,"select d.title,d.production_year,p.first_name,p.last_name from person p,director d
where p.id=d.id and exists(select * from director,movie_award mw
where d.title=mw.title and lower(award_name)='bafta film award' and lower(result)='won' and lower(category)='best film');",2018-08-31 15:56:43.593995+10,8,1,18,correct
12116,"SELECT count(*) AS number_of_award
FROM (writer_award wa NATURAL JOIN writer w NATURAL JOIN person p) AS wwp
WHERE lower(wwp.first_name) = 'woody' AND lower(wwp.last_name) = 'allen' AND wwp.year_of_award >1990 AND wwp.year_of_award <1996 AND
	lower(wwp.result) = 'won';",2018-08-31 15:57:07.317408+10,9,1,420,correct
12117,"SELECT dw.id,dw.first_name,dw.last_name
FROM (SELECT id,first_name,last_name,COUNT(*) AS NoOfDW
	FROM director NATURAL JOIN writer NATURAL JOIN person
	GROUP BY id,id,first_name,last_name) dw
WHERE dw.NoOfDW > 1;
",2018-08-31 15:57:22.857573+10,4,1,285,correct
12118,"select r.country from restriction r
where r.title='Shakespeare in Love' AND r.description='M';",2018-08-31 15:57:22.929961+10,6,1,466,correct
12119,;,2018-08-31 15:57:24.509959+10,13,0,451,noninterpretable
12120,"select d.id, da.award_name,da.year_of_award,da.category
from director_award da,director d
where da.title =d.title and 
	da.production_year = d.production_year and
	lower(da.result) !='won'
group by d.id
having count(*)>0;
",2018-08-31 15:57:37.749604+10,13,1,401,correct
12121,"select id , first_name, last_name
from person
where year_born = (
		select max(year_born)
		from person);",2018-08-31 15:57:53.112748+10,7,1,347,correct
12122,"SELECT country 
FROM RESTRICTION
WHERE title='Shakespeare in Love' AND description='M';",2018-08-31 15:58:00.754162+10,6,1,442,correct
12123,"select count(*)
from movie as m
where not exists 
(select title, production_year
from movie_award as ma where m.title=ma.title and m.production_year=ma.production_year and lower(ma.result)='won'
union
select title, production_year
from crew_award as ca where m.title=ca.title and m.production_year=ca.production_year and lower(ca.result)='won'
union
select title, production_year
from director_award as da where m.title=da.title and m.production_year=da.production_year and lower(da.result)='won'
union
select title, production_year
from writer_award as wa where m.title=wa.title and m.production_year=wa.production_year and lower(wa.result)='won'
union
select title, production_year
from actor_award as aa where m.title=aa.title and m.production_year=aa.production_year and lower(aa.result)='won')
;",2018-08-31 15:58:09.960388+10,11,1,158,correct
12124,"SELECT COUNT(*)
FROM (WRITER w LEFT JOIN PERSON p ON w.id = p.id) AS pw
WHERE pw.year_born = 1935;",2018-08-31 15:58:22.910204+10,1,0,423,partially correct
12125,"SELECT id, rst_name, last_name
FROM person p
WHERE EXISTS(
	SELECT * FROM director d
	WHERE EXISTS(
	SELECT * FROM writer w WHERE d.id=w.id and d.title=w.title and d.id=p.id));",2018-08-31 15:58:29.333969+10,4,0,281,noninterpretable
12126,"select title production_year
from writer,(
	select id from person
	where first_name='Kevin'
	and last_name='Williamson'
	) as p
where writer.id=p.id;
",2018-08-31 15:58:35.490788+10,5,0,207,partially correct
12127,"select id
from person
where year_born = (select max(year_born) from person
where year_born < (select max(year_born) from person));",2018-08-31 15:58:36.954521+10,3,1,250,correct
12128,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE da.title=d.title
	AND da.production_year=d.production_year
	AND lower(da.result)='nominated'
GROUP BY d.id
HAVING COUNT(*)>=1;",2018-08-31 15:59:01.833529+10,13,1,193,correct
12129,"select title ,production_year
from writer,(
	select id from person
	where first_name='Kevin'
	and last_name='Williamson'
	) as p
where writer.id=p.id;
",2018-08-31 15:59:02.452914+10,5,1,207,correct
12130,"select restriction.country
from restriction
where (lower(restriction.title)='shakespeare in love' ; ",2018-08-31 15:59:03.098157+10,6,0,463,noninterpretable
12131,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:59:03.746134+10,3,1,446,correct
12132,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 15:59:06.599413+10,13,1,451,correct
12133,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da 
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower(da.result) = 'nominated'
AND d.id NOT IN(
  SELECT id FROM director d, director_award da 
  WHERE d.title = da.title
  AND d.production_year = da.production_year
  AND lower(da.result) = 'won');",2018-08-31 15:59:18.442206+10,13,1,169,correct
12134,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 15:59:19.870651+10,10,1,182,correct
12135,"SELECT p.id 
FROM person p 
WHERE (p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE (year_born < ((SELECT MAX(year_born) 
		FROM person)))));
",2018-08-31 15:59:23.898161+10,3,1,329,correct
12136,"SELECT COUNT(*) FROM
(SELECT * FROM person NATURAL JOIN writer NATURAL JOIN writer_award
WHERE first_name='Woody' AND last_name='Allen'
AND year_of_award>1990 AND year_of_award<1996);",2018-08-31 15:59:26.782316+10,9,0,393,partially correct
12137,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 15:59:29.015372+10,3,1,446,correct
12138,"SELECT *
FROM director 
WHERE DIRECTOR.id = PERSON.id ;
",2018-08-31 15:59:32.241507+10,12,0,160,noninterpretable
12139,"with temp as (
	select id,count(*) num from role r,appearance a
	where r.title = a.title and r.production_year = a.production_year and r.description = a.description
	and lower(r.title) = 'psycho' and r.production_year = 1960
	group by id
)

select id from temp
where num = 1;",2018-08-31 15:59:32.81716+10,10,1,156,correct
12140,"SELECT id
FROM person
WHERE year_born
IN (SELECT MAX(year_born) 
	FROM person
	WHERE year_born < (SELECT MAX(year_born) FROM person));",2018-08-31 15:59:38.441343+10,3,1,459,correct
12141,"select count(*)
from person
natural join director
group by id;",2018-08-31 15:59:40.967969+10,14,0,358,partially correct
12142,"select d.title,d.production_year,p.first_name,p.last_name
from person p,
	director d,
	movie_award ma
where p.id = d.id
	and d.title = ma.title
	and d.production_year = ma.production_year
	and lower(ma.award_name)='bafta film award'
	and lower(ma.category)='best film'
	and lower(result)='won'
group by d.title;",2018-08-31 15:59:41.445735+10,8,1,134,correct
12143,;,2018-08-31 15:59:44.482774+10,14,0,211,noninterpretable
12144,"SELECT DISTINCT w.id, year_born
FROM (WRITER w LEFT JOIN PERSON p ON w.id = p.id) AS pw
WHERE pw.year_born = 1935;",2018-08-31 15:59:46.255701+10,1,0,423,partially correct
12145,;,2018-08-31 15:59:54.260183+10,14,0,451,noninterpretable
12146,"select dw.id, dw.first_name, dw.last_name
from (person p natural join director natural join writer) as dw
group by dw.id
having count(*)>1;",2018-08-31 16:00:00.293959+10,4,1,245,correct
12147,"SELECT COUNT(*) FROM
(SELECT * FROM person NATURAL JOIN writer NATURAL JOIN writer_award
WHERE lower(first_name)='woody' AND lower(last_name)='allen'
AND year_of_award>1990 AND year_of_award<1996);",2018-08-31 16:00:10.629381+10,9,0,393,partially correct
12148,"SELECT  dw.id
FROM movie, director, writer,(SELECT person.id, movie.title, movie.production_year
                              FROM person, director, movie
                              WHERE person.id = director.id AND director.title = movie.title AND director.production_year =movie.production_year
                              UNION
                              SELECT person.id, movie.title, movie.production_year
                              FROM person, writer, movie
                              WHERE person.id = writer.id AND writer.title = movie.title 
						  AND writer.production_year =movie.production_year) AS dw
WHERE director.title = movie.title AND director.production_year =movie.production_year
      AND writer.title = movie.title AND writer.production_year =movie.production_year
GROUP BY dw.id
ORDER BY COUNT(*) DESC
LIMIT 3;
",2018-08-31 16:00:15.321692+10,14,1,165,correct
12149,"SELECT count(*)
FROM person p
WHERE EXISTS SELECT * FROM writer w WHERE p.id = w.id AND p.year_born = '1935');",2018-08-31 16:00:19.20561+10,1,0,366,noninterpretable
12150,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:00:24.529998+10,14,1,451,correct
12151,"select restriction.country
from restriction
where lower(restriction.title)='shakespeare in love' and description ='M' ;",2018-08-31 16:00:26.534404+10,6,1,463,correct
12152,"SELECT COUNT(*) FROM person AS p
WHERE NOT EXISTS (SELECT 1 FROM director AS d WHERE p.ID = d.ID); 
",2018-08-31 16:00:29.489252+10,12,1,38,correct
12153,;,2018-08-31 16:00:36.528107+10,15,0,451,noninterpretable
12154,"select id from person 
where year_born = (
select max(year_born) from person
where year_born != (select max(year_born) from person));",2018-08-31 16:00:37.214465+10,3,1,203,correct
12155,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 16:00:43.285131+10,10,1,386,correct
12156,"WITH work AS (SELECT id, title, production_year
              FROM director d
	        UNION
		  SELECT id, title, production_year
		  FROM writer w)
SELECT id
FROM work
GROUP BY id
HAVING COUNT(*) = (SELECT MAX(C) FROM 
                                 (SELECT COUNT(*) C
						FROM work w
						GROUP BY w.id));",2018-08-31 16:00:43.991568+10,14,1,443,correct
12157,"SELECT DISTINCT w.id, year_born
FROM (WRITER w LEFT JOIN PERSON p ON w.id = p.id) AS pw
WHERE pw.year_born = 1935;",2018-08-31 16:00:47.593573+10,1,0,423,partially correct
12158,"SELECT dw.id
FROM(SELECT writer.id, writer.title, writer.production_year
      FROM writer
      UNION 
      SELECT *
      FROM director) AS dw
GROUP BY dw.id
ORDER BY COUNT(*) DESC
LIMIT 3;
",2018-08-31 16:00:49.824314+10,14,1,165,correct
12159,"select r.id
from role r,
	appearance a

where r.title = a.title
	AND r.production_year = a.production_year

	and a.description = r.description
	AND lower(a.title)= 'psycho'
	AND a.production_year = 1960
GROUP BY id
having count(*) = 1;",2018-08-31 16:00:51.43017+10,10,1,154,correct
12263,"SELECT count(*)
FROM person p
WHERE p.id NOT IN (SELECT d.id
FROM director d);",2018-08-31 16:12:46.24803+10,12,1,425,correct
12160,"select count(*)
from director_award da,  director d, person p
where (1991<da.production_year<=1995 ) and (da.result='won') and (da.title=d.title)
       and (p.id=p.id) and (p.first_name='Woody Allen')
;",2018-08-31 16:00:54.501606+10,9,0,253,partially correct
12161,"SELECT id
FROM person;",2018-08-31 16:00:56.631135+10,14,0,169,partially correct
12162,"SELECT distinct
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM 
    movie_award  ma,
    director  d,
    person  p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id
    AND lower(award_name)= 'bafta film award'
    AND lower(category)= 'best film'
    AND lower(RESULT)= 'won';",2018-08-31 16:00:57.061661+10,8,1,367,correct
12163,"select s.id
from sence s
where exists (select * from movie m where m.title = s.title ='Psycho' and m.production_year = s.production_year = 1960 and s.sence_no = 1 );",2018-08-31 16:01:08.39587+10,10,0,418,noninterpretable
12164,"SELECT DISTINCT w.id, year_born
FROM (WRITER w NATURAL JOIN PERSON p) AS pw
WHERE pw.year_born = 1935;",2018-08-31 16:01:13.414767+10,1,0,423,partially correct
12165,"select country
from Restriction 
where description='M'
and title='Shakespeare in Love' ;",2018-08-31 16:01:22.403421+10,6,1,207,correct
12166,"SELECT id, first_name, last_name
FROM PERSON
WHERE year_born=(SELECT MIN(year_born)FROM PERSON);",2018-08-31 16:01:23.414262+10,7,0,442,partially correct
12167,"SELECT DISTINCT w.id
FROM (WRITER w NATURAL JOIN PERSON p) AS pw
WHERE pw.year_born = 1935;",2018-08-31 16:01:25.90621+10,1,0,423,partially correct
12168,"Select title, production_year
from movie_award
where award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won';",2018-08-31 16:01:29.978484+10,8,0,45,partially correct
12169,"SELECT prq.id, prq.first_name, prq.last_name, prq.title, prq.production_year, prq.description FROM 
(SELECT prw.id, prw.first_name, prw.last_name, prw.title, prw.production_year, prw.description, COUNT(*) AS num FROM (SELECT pr.id, pr.first_name, pr.last_name, pr.title, pr.production_year, pr.description FROM 
(PERSON p NATURAL JOIN ROLE r) AS pr)) AS prw GROUP BY prw.id) AS prq
WHERE prq.num = (SELECT MAX(count) FROM (SELECT p.id, COUNT(*) FROM (SELECT pr.id, pr.first_name, pr.last_name, pr.title, pr.production_year, pr.description
FROM (PERSON p NATURAL JOIN ROLE r) AS pr) AS p GROUP BY p.id) AS r);",2018-08-31 16:01:35.257295+10,15,0,404,noninterpretable
12170,"select id ,first_name, last_name from person p 
where p.year_born in (select max(year_born) 
from person);",2018-08-31 16:01:37.612851+10,7,1,466,correct
12171,"select count(*)
from movie m0 
where m0.title != ANY 
(select m.title  
from movie m
where exists (select * 
from movie_award ma where m.title=ma.title 
and m.production_year=ma.production_year
and ma.result='won')
or exists (select * 
from actor_award aa where m.title=aa.title
and m.production_year=aa.production_year
and aa.result='won')
or exists (select * from writer_award wa
where m.title=wa.title
and m.production_year=wa.production_year
and wa.result='won')
or exists (select * from director_award da
where m.title=da.title
and m.production_year=da.production_year
and da.result='won')
or exists(select * from crew_award ca
where m.title=ca.title
and m.production_year=ca.production_year
and ca.result='won'));  


",2018-08-31 16:01:40.520076+10,11,0,354,noninterpretable
12172,"select s.id
from scene s
where exists (select * from movie m where m.title = s.title ='Psycho' and m.production_year = s.production_year = 1960 and s.scene_no = 1 );",2018-08-31 16:01:44.473565+10,10,0,418,noninterpretable
12173,"Select title, production_year
from movie_award
where award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won';",2018-08-31 16:01:45.910502+10,8,0,45,partially correct
12174,"select count(*)
from writer_award wa,person p
where p.id=wa.id
and lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and lower(wa.result)='won'
and wa.year_of_award>=1991
and wa.year_of_award<=1995;
",2018-08-31 16:01:52.995+10,9,1,293,correct
12175,"SELECT w.title,w.production_year
FROM writer w
WHERE w.id = (
	SELECT p.id
	FROM person p
	WHERE lower(p.first_name) = 'kevin'
		AND lower(p.last_name) = 'williamson'
);",2018-08-31 16:01:58.256649+10,5,1,285,correct
12176,"select x.id, x.first_name, x.last_name
from    (person p 
        natural join
	role r
        natural join
            (select title, production_year, description
                 from Actor_Award
		where lower(result)='nominated' and title not in ( select aa.title
			  		 from actor_award aa
					   where lower(aa.result)='won' and aa.title= title and 		      
                                   aa.production_year=production_year and aa.description = description)
		group by title, production_year, description
	having count(*)>1) o)
as x
order by x.last_name;",2018-08-31 16:01:59.15507+10,15,0,338,partially correct
12177,"select id, first_name, last_name from person where year_born = (select max(year_born) from person );",2018-08-31 16:02:00.601896+10,7,1,66,correct
12178,"SELECT d.id, dw.award_name, dw.year_of_award,dw.category
FROM director d, director_award dw
WHERE dw.title=d.title
  AND dw.production_year=d.production_year
  AND dw.result='nominated';",2018-08-31 16:02:17.678086+10,13,1,441,correct
12179,"select d.id, da.award_name, da.year_of_award, da.category
from director_award da, director d
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'nominated'
	 and d.id not in (	           
			 select id 
			 from director_award da, director d
			 where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'won');",2018-08-31 16:02:18.494101+10,13,1,225,correct
12180,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (

SELECT title, production_year
FROM movie_award ma
WHERE lower(ma.result) = 'won' AND ma.title = m.title and ma.production_year = m.production_year
UNION

SELECT title, production_year
FROM crew_award ca
WHERE lower(ca.result) = 'won' AND ca.title = m.title and ca.production_year = m.production_year
UNION

SELECT title, production_year
FROM director_award da
WHERE lower(da.result) = 'won' AND da.title = m.title and da.production_year = m.production_year
UNION

SELECT title, production_year
FROM writer_award wa
WHERE lower(wa.result) = 'won' AND wa.title = m.title and wa.production_year = m.production_year
UNION

SELECT title, production_year
FROM actor_award aa
WHERE lower(aa.result) = 'won' AND aa.title = m.title and aa.production_year = m.production_year
);",2018-08-31 16:02:28.227199+10,11,1,23,correct
12181,"with resulttable
as
(

select id, count(*) as times
from person natural join role
group by id
order by times desc
)

select first_name,last_name,title,production_year,description
from resulttable natural join person natural join role
where times = (select max(times)
	from resulttable)
	order by production_year
;

",2018-08-31 16:02:29.389687+10,15,1,387,correct
12182,"
SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS (SELECT *
			FROM director d
			WHERE d.id = p.id );",2018-08-31 16:02:34.174044+10,12,1,160,correct
12183,"SELECT x.id, Count(*) as no_roles From
		(SELECT id, title, production_year, description From Role
		Group by id) x;",2018-08-31 16:02:42.736958+10,15,0,198,partially correct
12184,"select title, production_year from Movie_Award as ma 
where lower(ma.award_name) like ""bafta film award"" and lower(ma.category) like ""best film"";",2018-08-31 16:02:45.005187+10,8,0,318,partially correct
12185,"SELECT id, first_name, last_name
FROM PERSON
WHERE year_born=(SELECT MAX(year_born)FROM PERSON );",2018-08-31 16:02:52.221923+10,7,1,442,correct
12186,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 16:02:52.850423+10,9,1,253,correct
12314,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (PERSON p NATURAL JOIN DIrector NATURAL JOIN WRITER) AS dw
GROUP BY dw.id
HAVING count(*)>1;",2018-08-31 16:19:13.120989+10,4,1,355,correct
12316,"select r.id
from appearance a, role r
where a.scene_no='1' and (a.title='Psycho') and (r.description=a.description) ;",2018-08-31 16:19:24.048275+10,10,0,253,partially correct
12187,"SELECT distinct
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 16:02:59.102967+10,9,1,367,correct
12188,"select id, first_name, last_name
from (person p Natural join writer w natural join director d) as dw
group by dw.id
having count(*) > 1;
",2018-08-31 16:03:11.141399+10,4,1,201,correct
12189,"select id, first_name, last_name
from (person p Natural join writer w natural join director d) as dw
group by dw.id
having count(*) > 1;
",2018-08-31 16:03:26.887552+10,4,1,201,correct
12190,"select title, production_year from Movie_Award as ma 
where lower(ma.award_name) like ""bafta film award"" and lower(ma.category) like ""best film"" and lower(ma.result) like 'won';",2018-08-31 16:03:41.792365+10,8,0,318,partially correct
12191,"select title, production_year, first_name, last_name
from (person natural join director natural join movie_award) as pda
where lower(award_name) = lower('BAFTA Film Award')
and lower(category) = lower('Best Film')
and lower(result) = 'won';",2018-08-31 16:03:45.443886+10,8,1,347,correct
12192,"SELECT distinct
    COUNT(*) AS number_of_award
FROM
(select * from
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995);",2018-08-31 16:03:49.205294+10,9,1,367,correct
12193,"select count(*)
from person p
where exists (
	select *
	from writer w
	where p.id = w.id and p.year_born = 1935)
;",2018-08-31 16:03:54.26786+10,1,1,423,correct
12194,"SELECT COUNT(*) FROM
(SELECT * FROM person NATURAL JOIN writer NATURAL JOIN writer_award
WHERE lower(first_name)='woody' AND lower(last_name)='allen'
AND year_of_award>1990 AND year_of_award<1996
AND lower(result)='won');",2018-08-31 16:03:58.077503+10,9,1,393,correct
12195,"with ma as (
	select title, production_year from movie_award
	where lower(result) = 'won'
	union select title, production_year from crew_award
	where lower(result) = 'won'
	union select title, production_year from director_award
	where lower(result) = 'won'
	union select title, production_year from writer_award
	where lower(result) = 'won'
	union select title, production_year from actor_award
	where lower(result) = 'won'
)

select count(*) from movie
where (title, production_year) not in ma;",2018-08-31 16:04:00.210523+10,11,1,156,correct
12196,"SELECT m.title, m.production_year, x.first_name, x.last_name
FROM movie_award m, (SELECT p.id, first_name, last_name
				FROM person p, director d
				WHERE p.id = d.id) AS x
WHERE award_name = 'BAFTA Film Award' AND category = 'Best Film';",2018-08-31 16:04:06.015851+10,8,0,251,partially correct
12197,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 16:04:12.267953+10,15,1,343,correct
12198,"select r.id
from role r,
	appearance a

where r.title = a.title
	AND r.production_year = a.production_year

	and a.description = r.description
	AND lower(a.title)= 'psycho'
	AND a.production_year = 1960
GROUP BY id
having count(*) = 1;",2018-08-31 16:04:23.708517+10,10,1,154,correct
12199,"SELECT production_year, count(*)
FROM movie m
WHERE m.production_year = 1991 
OR m.production_year = 1992
OR m.production_year = 1993
GROUP BY m.production_year;

",2018-08-31 16:04:24.770472+10,2,1,425,correct
12200,"

select aid from
(select aid,bid from
(select aid,bid,count(*) as s
from(select w1.id as aid,w2.id as bid
from writer w1,writer w2
where w1.title=w2.title and w1.production_year=w2.production_year and w1.id!=w2.id and w1.title in
(select a.title
from(select title,production_year,count(*) as num
from writer 
group by title,production_year
having num>1)as a))
group by aid,bid)as b
where b.s= (select max(s)
from (select aid,bid,count(*) as s
from(select w1.id as aid,w2.id as bid
from writer w1,writer w2
where w1.title=w2.title and w1.production_year=w2.production_year and w1.id!=w2.id and w1.title in
(select a.title
from(select title,production_year,count(*) as num
from writer 
group by title,production_year
having num>1)as a))
group by aid,bid)));",2018-08-31 16:05:05.363256+10,1,0,64,partially correct
12201,"SELECT r.country
FROM restriction r
WHERE lower(r.title) = 'shakespeare in love'
	AND lower(r.description) = 'm';",2018-08-31 16:05:06.882396+10,6,1,285,correct
12202,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:05:10.266145+10,11,1,18,correct
12203,"select p.id, first_name,last_name from person p,(
select id from(
select id, writer.title from writer,movie
where movie.title=writer.title order by id) as mm group by id having count(id)>1) as nn
where p.id=nn.id;",2018-08-31 16:05:14.98612+10,4,0,192,partially correct
12204,"select c.id
from scene s 
crew c
movie m
where
m.title = s.title= c.title ='Psycho' and m.production_year =c.production_year= s.production_year = 1960 and s.scene_no = 1; 
",2018-08-31 16:05:15.643307+10,10,0,418,noninterpretable
12205,"select id, first_name, last_name
from person
where ;",2018-08-31 16:05:23.193727+10,7,0,463,noninterpretable
12206,"select distinct id 
from role, (select title, production_year, description
from appearance
where title='Psycho'
and production_year=1960) as h
where role.title=h.title
and role.production_year=h.production_year
and role.description=h.description
group by id
having count(id)=1;",2018-08-31 16:05:38.473167+10,10,1,140,correct
12207,"SELECT d.id, da.award_name, da.year_of_award,da.category
FROM director d JOIN director_award da ON d.title = da.title
WHERE NOT EXISTS (SELECT * FROM director NATURAL JOIN director_award as d WHERE LOWER(result) = 'won');",2018-08-31 16:05:41.362471+10,13,0,446,partially correct
12208,"select production_year, count(*)
from movie m
group by production_year
having m.production_year >=1991 and m.production_year <= 1993;",2018-08-31 16:06:04.871+10,2,1,423,correct
12264,"select count(*)
from movie m, Movie_Award ma, Crew_Award ca, Director_Award da, Writer_Award wa, Actor_Award aa
where m.title=ma.title
and m.title=ca.title
and m.title=da.title
and m.title=wa.title
and m.title=aa.title
and not exit (select *
from Movie_Award ma, Crew_Award ca, Director_Award da, Writer_Award wa, Actor_Award aa
where ma.result='won'
or ca.result='won'
or da.result='won'
or wa.result='won'
or aa.result='won')
group by title;",2018-08-31 16:12:48.414064+10,11,0,386,noninterpretable
12209,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ));",2018-08-31 16:06:12.521055+10,15,1,343,correct
12210,"SELECT count(*)
FROM ( SELECT Person.id FROM Person Natural join Writer WHERE year_born = 1935 GROUP BY Person.id );
",2018-08-31 16:06:15.649276+10,4,0,220,partially correct
12211,"select count(*)
from writer_award wa,
	person p
where p.id = wa.id
	and lower(p.first_name)='woody'
	and lower(p.last_name)='allen'
	and wa.production_year>=1992 and wa.production_year<=1995
group by wa.id;",2018-08-31 16:06:27.24028+10,9,1,134,correct
12212,"SELECT p.id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
FROM person
WHERE year_born < (
SELECT MAX(year_born)
FROM person));",2018-08-31 16:06:41.552043+10,3,1,23,correct
12213,"SELECT id
FROM scene s , movie m ,role r 
WHERE s.title = m.title
	AND s.production_year = m.production_year
	AND r.title = m.title
	AND r.production_year = m.production_year 
	AND lower(m.title )= 'psycho'
	AND m.production_year = 1960
GROUP BY id
HAVING count(*) =1 ;",2018-08-31 16:07:23.124357+10,10,0,49,partially correct
12214,"
select id1,id2, count(title)  from 
(select id1, id2 , title, production_year, count(title) from (

select z.id as id1, q.id as id2, z.production_year, z.title from
(select * from writer )z
join 
(select * from writer )q
on z.title = q.title
and z. production_year = q.production_year
and q.id != z.id
) 
group by title, production_year
)
group by id1,id2
;",2018-08-31 16:07:37.948834+10,2,0,449,partially correct
12215,"select count(*)
from person p
where not exists (
	select * 
	from director d
	where p.id = d.id);",2018-08-31 16:07:39.314381+10,12,1,423,correct
12216,"SELECT r.id FROM 
SCENE s, Role r, Appearance a
WHERE s.title = r.title
AND r.title = a.title
AND s.production_year = r.production_year
AND r.production_year = a.production_year
AND a.scene_no = s.scene_no
AND a.description = r.description
AND lower(r.title) = 'psycho'
AND a.production_year = 1960
Group by id HAVING count(r.id)=1;",2018-08-31 16:07:52.293049+10,10,1,218,correct
12217,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:07:55.621891+10,13,1,446,correct
12218,"select first_name,last_name,title,production_year,description
from person natural join role natural join (
 
select id
from person natural join role
group by id
having count(*) =( select count(*)
			from person natural join role
			group by id
			order by count(*) desc
			limit 1
		

))





;",2018-08-31 16:08:02.279574+10,15,1,387,correct
12219,"select x.id
from (role r natural join appearance a) as x
where lower(x.title)='psycho' and production_year='1960'
Group by x.id
Having count (x.id)=1;",2018-08-31 16:08:11.43114+10,10,1,424,correct
12220,"select id 
from role, (select title, production_year, description
from appearance
where title='Psycho'
and production_year=1960) as h
where role.title=h.title
and role.production_year=h.production_year
and role.description=h.description
group by id
having count(id)=1;",2018-08-31 16:08:20.829579+10,10,1,140,correct
12221,"SELECT title, production_year
FROM writer w
WHERE EXISTS(SELECT * FROM person p WHERE p.id = w.id AND p.first_name = ""Kevin"" AND p.last_name=""Williamson"");",2018-08-31 16:08:22.014093+10,5,1,281,correct
12222,"select x.id
from (role r natural join appearance a) as x
where lower(x.title)='psycho' and production_year='1960'
Group by x.id
Having count (*)=1;",2018-08-31 16:08:24.744255+10,10,1,424,correct
12223,"with temp as (
	select id,year_born from person
	where year_born < (select max(year_born) from person)
)

select id from temp
where year_born = (select max(year_born) from temp);",2018-08-31 16:08:26.340442+10,3,1,156,correct
12224,"select title, production_year, first_name, last_name from (Movie_Award ma NATURAL JOIN director d NATURAL JOIN person p) as mad
where lower(ma.award_name) like ""bafta film award"" and lower(ma.category) like ""best film"" and lower(ma.result) like 'won';",2018-08-31 16:08:28.164271+10,8,1,318,correct
12225,"SELECT mda.title, mda.production_year, mda.first_name, mda.last_name
FROM (MOVIE NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE_AWARD NATURAL JOIN PERSON) AS mda
WHERE mda.award_name='BAFTA Film Award' AND mda.category='Best Film';",2018-08-31 16:08:29.881511+10,8,0,442,partially correct
12226,"select id, first_name, last_name
from person
where person.year_born = (select max (year_born) from person);
",2018-08-31 16:08:33.448648+10,7,1,463,correct
12227,"select count(*) as number_of_award
from person p, writer_award wa
where wa.id = p.id 
	and lower(wa.result) = 'won'
	and lower(p.first_name) = 'woody'
	and lower(p.last_name) = 'allen'
	and wa.year_of_award >'1990'
	and wa.year_of_award <'1996';",2018-08-31 16:08:41.848191+10,9,1,229,correct
12228,"select p.first_name, p.last_name
from person p;",2018-08-31 16:08:54.929298+10,3,0,196,partially correct
12229,"select X.id
from (select p.id, count (*) as lnm
      from person p,
	      (select id
	       from  writer w
		 union
		 select id
		 from director d) as x1
	where x1.id=p.id
	group by p.id) as X
where x.lnm in (select max(x2.lnm)
                 from (select p.id, count (*) as lnm
      from person p,(select id
	       from  writer 
		   union
		 select id
		 from director ) as x3
	where x3.id=p.id
	group by p.id) as X2);",2018-08-31 16:09:09.1799+10,14,0,237,partially correct
12230,"SELECT count(*)
FROM person
WHERE NOT EXISTS(SELECT * FROM director WHERE person.id = director.id);",2018-08-31 16:09:56.743061+10,12,1,366,correct
12231,;,2018-08-31 16:10:01.154509+10,14,0,87,noninterpretable
12232,"SELECT COUNT(*)
FROM WRITER, PERSON
WHERE PERSON.year_born = 1935
AND PERSON.id = WRITER.id;",2018-08-31 16:10:04.831386+10,1,0,89,partially correct
12233,"with w_a as (
select id
from writer_award
where year_of_award > 1990 and year_of_award < 1996 and lower(result) = 'won')
select count(*)
from w_a
where id = (select id from person where lower(first_name) = lower('Woody') and lower(last_name) = lower('Allen'));",2018-08-31 16:10:08.090619+10,9,1,347,correct
12234,"select mw.title, mw.production_year
from (writer natural join person) as mw
where lower(mw.first_name) = 'kevin' and lower(mw.last_name) = 'willamson'
;
",2018-08-31 16:10:09.059703+10,5,0,201,partially correct
12235,"SELECT mda.title, mda.production_year, mda.first_name, mda.last_name
FROM (MOVIE NATURAL JOIN DIRECTOR NATURAL JOIN MOVIE_AWARD NATURAL JOIN PERSON) AS mda
WHERE lower(mda.award_name)='bafta film award' 
AND lower(mda.category)='best film'
AND lower(mda.result)='won';",2018-08-31 16:10:21.439509+10,8,1,442,correct
12236,;,2018-08-31 16:10:23.101923+10,15,0,87,noninterpretable
12237,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p, role r
WHERE r.id = (

SELECT a.id
FROM (SELECT id, COUNT(*) AS number_of_roles
	FROM role
	GROUP BY id) AS a
WHERE a.number_of_roles = (SELECT MAX(*)
FROM (SELECT COUNT(*) AS number_of_roles
	FROM role
	GROUP BY id) AS b));

",2018-08-31 16:10:29.183764+10,15,0,193,noninterpretable
12238,"select id
from crew_award
where lower(result)=""won"";",2018-08-31 16:10:30.403971+10,1,0,153,partially correct
12289,"select count(*)
from writer, person
where writer.id =person.id and person.year_born= 1935;",2018-08-31 16:16:39.933699+10,1,0,291,partially correct
12315,"select id
from (appearance natural join role) as ar
where lower(title) = lower('Psycho')
group by id having count(scene_no) = 1;",2018-08-31 16:19:17.449359+10,10,0,347,partially correct
12239,"


select count(*)
from (select distinct p.id
from person p inner join writer w on w.id=p.id
where p.year_born =1935);",2018-08-31 16:10:45.573359+10,1,1,64,correct
12240,"SELECT dd.id, dd.award_name, dd.year_of_award, dd.category
FROM
(select * from director_award NATURAL JOIN director) AS dd
WHERE dd.result = 'nominated';
",2018-08-31 16:10:47.021262+10,13,1,459,correct
12241,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:10:47.532028+10,14,1,313,correct
12242,"SELECT count(*)
FROM writer_award AS wa, (SELECT * FROM writer,person WHERE writer.id=person.id) as p
WHERE wa.id=p.id
AND wa.title=p.title
AND wa.production_year=p.production_year
AND wa.year_of_award in (1991,1992,1993,1994,1995)
AND lower(result)=""won""
AND lower(p.first_name)=""woody""
AND lower(p.last_name)=""allen""
GROUP BY wa.award_name;",2018-08-31 16:10:48.836189+10,9,1,216,correct
12243,"SELECT id
FROM person
WHERE (SELECT max(*)
	FROM person
	WHERE max(person));",2018-08-31 16:10:52.671175+10,3,0,268,noninterpretable
12244,"select count(*) 
from movie as m,
movie_award as ma, 
crew_award as ca, 
director_award as da, 
writer_award as wa, 
actor_award as aa, 
crew as c

where not exists(
m.title = ma.title );
",2018-08-31 16:10:54.404337+10,11,0,447,noninterpretable
12245,"select first_name, last_name, c.title, c.production_year 
from person NATURAL JOIN director AS c ,(select m.title, m.production_year from movie_award m
where lower(award_name)='bafta film award' AND category ='best film') d
where c. title= d.title AND c.production_year=d.production_year;",2018-08-31 16:10:54.820603+10,8,0,466,partially correct
12246,"
SELECT first_name last_name,title, production_year,description
FROM role r, person p
WHERE r.id = p.id
GROUP BY r.id 
HAVING COUNT(*)=(SELECT MAX(C)
                 FROM (SELECT COUNT(*) C
				 FROM role r1
				 GROUP BY r1.id));",2018-08-31 16:11:02.437801+10,15,0,443,partially correct
12247,"SELECT 
	r.id
FROM 
	role r,
	scene s,
	appearance a
WHERE
	a.title=s.title AND
	a.production_year=s.production_year AND
	a.scene_no=s.scene_no AND
	a.title=r.title AND
	a.production_year=r.production_year AND
	a.description=r.description AND
	lower(a.title)='psycho' AND
	a.production_year=1960
GROUP BY
	r.id
HAVING
	COUNT(*)=1;",2018-08-31 16:11:08.138668+10,10,1,430,correct
12248,"select count(*)
from (
select *
from person
where year_born = 1935)
;",2018-08-31 16:11:39.006791+10,1,0,152,partially correct
12249,select count(*) from movie m;,2018-08-31 16:11:45.519989+10,11,0,266,partially correct
12250,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:11:51.167017+10,11,1,447,correct
12251,"
SELECT first_name,last_name,title, production_year,description
FROM role r, person p
WHERE r.id = p.id
GROUP BY r.id 
HAVING COUNT(*)=(SELECT MAX(C)
                 FROM (SELECT COUNT(*) C
				 FROM role r1
				 GROUP BY r1.id));",2018-08-31 16:11:57.460416+10,15,0,443,partially correct
12252,"SELECT count(id)
FROM person
WHERE EXISTS (SELECT * FROM writer WHERE writer.id=person.id AND year_born=1935);
",2018-08-31 16:12:10.430359+10,1,1,422,correct
12253,"select ma.title,
ma.production_year,
first_name,
last_name

from director d,
movie_award ma,
person p

where lower(ma.award_name)='bafta film award'
and lower(ma.category)='best film'
and lower(ma.result)='won'
and d.id=p.id
and d.title=ma.title
and d.production_year=ma.production_year;
",2018-08-31 16:12:13.073835+10,8,1,377,correct
12254,"select id, first_name, last_name
from person p
where id IN (
	select id
	from director natural join writer as dw
	group by id
	having count(*) >= 2)
;",2018-08-31 16:12:17.356766+10,4,1,423,correct
12255,"SELECT count(*)
FROM writer_award AS wa, (SELECT * FROM writer,person WHERE writer.id=person.id) as p
WHERE wa.id=p.id
AND wa.title=p.title
AND wa.production_year=p.production_year
AND wa.year_of_award between 1991 and 1995
AND lower(result)=""won""
AND lower(p.first_name)=""woody""
AND lower(p.last_name)=""allen""
GROUP BY wa.award_name;",2018-08-31 16:12:19.250431+10,9,1,216,correct
12256,"SELECT a.title, a.production_year,p.first_name,p.last_name
FROM PERSON p, MOVIE_AWARD a,DIRECTOR d
WHERE a.title=d.title
AND d.id=p.id
AND lower(a.award_name)='bafta film award'
AND lower(a.category)='best film'
AND lower(a.result)='won';
",2018-08-31 16:12:27.160111+10,8,1,280,correct
12257,"select count(*)
from (person p natural join writer_award wa) as pwa
where lower(pwa.first_name)='woody'
and lower (pwa.last_name)='allen'
and pwa.year_of_award<=1995
and pwa.year_of_award>=1991;",2018-08-31 16:12:29.525258+10,9,0,424,partially correct
12258,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born)
				FROM person
				WHERE year_born < (SELECT MAX(year_born)
								FROM person));",2018-08-31 16:12:30.86386+10,3,1,268,correct
12259,"select first_name, last_name, c.title, c.production_year 
from person NATURAL JOIN director AS c ,(select m.title, m.production_year from movie_award m
where lower(award_name)='bafta film award' AND category ='best film' AND lower(result) ='won') d
where c. title= d.title AND c.production_year=d.production_year;",2018-08-31 16:12:32.849635+10,8,1,466,correct
12260,"select mw.title, mw.production_year
from (writer natural join person) as mw where mw.first_name = 'Kevin' and mw.last_name = 'Williamson';
",2018-08-31 16:12:36.052717+10,5,1,201,correct
12261,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT exists (
        SELECT
            *
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:12:43.715838+10,13,0,399,noninterpretable
12262,"SELECT p.first_name, p.last_name
FROM appearance a, movie m, role r, person p
WHERE a.title = m.title AND r.title = m.title AND r.id = p.id AND a.scene_no = 1 AND lower(a.title) = 'psycho' AND a.production_year = 1960;",2018-08-31 16:12:45.656222+10,10,0,420,partially correct
12265,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 16:12:48.868255+10,10,1,418,correct
12266,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d NOT exists (
        SELECT
            *
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:13:00.590388+10,13,0,399,noninterpretable
12267,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d NOT exists (
        SELECT
            *
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:13:05.315083+10,13,0,399,noninterpretable
12268,"select r.id
from appearance a,role r,scene s
where a.title=s.title
and a.title=r.title
and a.production_year=r.production_year
and a.production_year=s.production_year
and s.scene_no=a.scene_no
and lower(a.title)='psycho'
and a.production_year=1960
and a.description = r.description
group by r.id
having count(*)=1;",2018-08-31 16:13:07.06242+10,10,1,293,correct
12269,"select c.title, c.production_year,first_name, last_name 
from person NATURAL JOIN director AS c ,(select m.title, m.production_year from movie_award m
where lower(award_name)='bafta film award' AND category ='best film' AND lower(result) ='won') d
where c. title= d.title AND c.production_year=d.production_year;",2018-08-31 16:13:19.165224+10,8,1,466,correct
12270,"SELECT COUNT(id)
FROM WRITER_AWARD
WHERE year;",2018-08-31 16:13:43.548677+10,9,0,428,noninterpretable
12271,"select count(*)
from (person p natural join writer_award wa) as pwa
where lower(pwa.first_name)='woody'
and lower (pwa.last_name)='allen'
and pwa.year_of_award<=1995
and pwa.year_of_award>=1991
and lower(pwa.result)='won';",2018-08-31 16:13:50.281599+10,9,1,424,correct
12272,"SELECT country
FROM restriction r
WHERE lower(r.title) = ""shakespeare in love"" AND r.description = ""M"";",2018-08-31 16:13:52.781675+10,6,1,281,correct
12273,;,2018-08-31 16:14:04.116532+10,5,0,245,noninterpretable
12274,"select title, production_year, first_name, last_name 
from person natural join director natural join movie natural join movie_award
where lower(result) = 'won' and award_name = 'BAFTA Film Award' and lower(category) = 'best film';",2018-08-31 16:14:19.379883+10,8,1,66,correct
12275,"select mw.title, mw.production_year
from (writer natural join person) as mw where lower(first_name) = 'kevin' and lower(last_name) = 'williamson';
",2018-08-31 16:14:20.702098+10,5,1,201,correct
12276,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:14:21.214022+10,11,1,386,correct
12277,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 16:14:41.669893+10,9,1,428,correct
12278,"with x1 as
(select d.* from director d 
union
select w.id, title, production_year from writer w)

select x2.id
from (select x1.id, count(*) as NoOfM
from x1
group by x1.id) x2
where x2.NoOfM = (select max(NoOfM) from (select x1.id, count(*) as NoOfM
from x1
group by x1.id));",2018-08-31 16:14:49.631865+10,14,1,170,correct
12279,"WITH writtenanddirector AS
(SELECT count(title) AS noofmovie
FROM director d
WHERE d.id = writer.id 
GROUP BY id
)
SELECT id, first_name, last_name
FROM person p
WHERE EXISTS ( SELECT *
FROM writtenanddirector
WHERE noofmovie >= 2
);",2018-08-31 16:15:05.529679+10,4,0,160,noninterpretable
12280,"SELECT COUNT(*)
FROM MOVIE M
WHERE NOT EXISTS( 
SELECT title, production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and ma.result='won'
union
SELECT title, production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and wa.result='won'
union
SELECT title, production_year from director_award da where da.title=m.title and da.production_year=m.production_year and da.result='won'
union
SELECT title, production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and aa.result='won' 
union
SELECT title, production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and ca.result='won' );
",2018-08-31 16:15:11.879346+10,11,0,182,partially correct
12281,"SELECT COUNT(*)
FROM (WRITER_AWARD NATURAL JOIN PERSON) AS wp
WHERE lower(wp.first_name)='woody' 
AND lower(wp.last_name)='allen'
AND wp.production_year>1990
AND wp.production_year<1996;",2018-08-31 16:15:13.978177+10,9,1,442,correct
12282,;,2018-08-31 16:15:23.771788+10,3,0,386,noninterpretable
12283,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director_award da, director d
WHERE 

da.title = d.title
AND da.production_year = d.production_year
AND lower(da.result) = 'nominated'

AND d.id NOT IN (SELECT id FROM director_award da, director d
WHERE da.title= d.title
AND da.production_year = d.production_year
AND lower(da.result) = 'won');

",2018-08-31 16:15:37.196527+10,13,1,23,correct
12284,"select count(*)
from (person natural join writer natural join writer_award) as pwa
where year_of_award > 1990 and year_of_award < 1996 and lower(first_name) = lower('Woody') and lower(last_name) = lower('Allen')
and lower(result) = 'won';",2018-08-31 16:15:51.417591+10,9,1,347,correct
12285,"With newTable AS
(SELECT id,year_born FROM PERSON p
EXCEPT
SELECT id,MAX(year_born) FROM PERSON)
SELECT n.id FROM newTable n
WHERE n.year_born = (SELECT MAX(n1.year_born)
FROM newTable n1);",2018-08-31 16:15:52.952086+10,3,1,218,correct
12286,"select count(*)

from person p,
writer_award wa

where lower(p.first_name)='woody'
and lower(p.last_name)='allen'
and p.id=wa.id
and lower(wa.result)='won'
and wa.year_of_award>=1991
and wa.year_of_award<=1995;",2018-08-31 16:16:07.626295+10,9,1,377,correct
12287,"with wda as (
	select id from director_award da, director d
	where lower(result) = 'won' and da.title = d.title and da.production_year = d.production_year
), temp as (
	select id, award_name, year_of_award, category from director_award da, director d
	where da.title = d.title and da.production_year = d.production_year
)

select * from temp
where id not in (select * from wda);",2018-08-31 16:16:27.28977+10,13,1,156,correct
12288,"select p.count(p.title) as totalno from (select d.id,d.title,d.production_year from director d union
select w.id,w.title,w.production_year from writer w) as p
group by p.id oeder by totalno desc limit1;",2018-08-31 16:16:37.434985+10,14,0,255,noninterpretable
12290,"SELECT distinct
    COUNT(x.id) AS number_of_award
FROM
(select * from
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995) x;",2018-08-31 16:16:49.875633+10,9,1,367,correct
12291,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 16:16:50.16881+10,3,1,386,correct
12292,"select movie_award.title, movie_award.production_year, person.first_name, person.last_name
from movie_award, director, person
where lower(category)='best film' and lower(award_name)='bafta film' and movie_award.title=director.title 
and director.id=person.id;",2018-08-31 16:17:16.380312+10,8,0,463,partially correct
12293,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:17:18.548025+10,14,1,169,correct
12294,"select p.id, first_name,last_name from person p, director d,(
	select id from(
		select id, writer.title from writer,movie
		where movie.title=writer.title order by id) as mm 
	group by id having count(id)>1) as nn
where p.id=nn.id and p.id=d.id group by p.id order by p.id;",2018-08-31 16:17:22.943794+10,4,1,192,correct
12295,"select title, production_year
from writer natural join person as wp
where lower(wp.first_name) = ""kevin"" and lower(wp.last_name) = ""williamson"";",2018-08-31 16:17:26.069259+10,5,1,423,correct
12296,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 16:17:29.598052+10,5,0,220,partially correct
12297,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON
		FROM (SELECT d.id, title, production_year
				FROM director d
				UNION
				SELECT w.id, title, production_year
				FROM writer w) x1
				GROUP BY x1.id) x
WHERE x.NoOfWorkedON=
	(SELECT MAX(x2.NoOfWorkedON)
	FROM(SELECT x1.id, count(*) AS NoOfWorkedON
			FROM(SELECT d.id, title, production_year
					FROM director d
					UNION
					SELECT w.id, title, production_year
					FROM writer w) x1
					GROUP BY x1.id) x2);",2018-08-31 16:17:34.602076+10,14,1,162,correct
12298,"select w.title, w.production_year
from writer w, person p
where w.id = p.id 
and p.first_name = 'Kevin'
and p.last_name = 'Williamson';",2018-08-31 16:17:46.846594+10,5,1,245,correct
12299,"select count(*)
from writer_award wa,
	person p
where p.id = wa.id
	and lower(p.first_name)='woody'
	and lower(p.last_name)='allen'
	and wa.year_of_award>=1991 and wa.year_of_award<=1995
	and lower(wa.result)='won';",2018-08-31 16:17:48.739456+10,9,1,134,correct
12300,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:17:49.029355+10,13,1,446,correct
12301,"select count (*) 
from movie natural join movie_awards natural join crew_awards, director_awards, writer_awards and actor_awards;
",2018-08-31 16:17:51.832718+10,11,0,418,noninterpretable
12302,"select p.first_name,p.last_name, r.title,r.production_year,r.description
from person p, role r, (select id,count(*) as numBer from role group by id) rr
where p.id =rr.id and r.id =rr.id and rr.numBer = (select max(numBer)from (select id,count(*) as numBer
								from role group by id));",2018-08-31 16:17:57.043933+10,15,1,401,correct
12303,"select X.id
from (select x1.id,count (*) as lnm
      from (select w.id,w.title,w.production_year
	       from  writer w
		 union
		 select d.id,d.title,d.production_year
		 from director d) as x1
	      group by x1.id) as X
where x.lnm in (select max(x2.lnm)
                from (select x1.id, count (*) as lnm
              from (select w.id,w.title,w.production_year
	       from  writer w 
		   union
		 select d.id,d.title,d.production_year
		 from director d ) as x1
	       group by x1.id) as X2);",2018-08-31 16:18:04.54952+10,14,1,237,correct
12304,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description
FROM person p NATURAL JOIN role r NATURAL JOIN
	(SELECT id, COUNT(*) AS number_of_roles
	FROM role
	GROUP BY id) AS a
WHERE a.number_of_roles IN (SELECT MAX(number_of_roles)
	FROM (SELECT id, COUNT(*) AS number_of_roles
	FROM role
	GROUP BY id) AS a);",2018-08-31 16:18:16.308209+10,15,1,193,correct
12305,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:18:16.675047+10,11,1,266,correct
12306,"SELECT COUNT(*)
FROM MOVIE M
WHERE NOT EXISTS( 
SELECT title, production_year from movie_award ma where ma.title=m.title and ma.production_year=m.production_year and lower(ma.result)='won'
union
SELECT title, production_year from writer_award wa where wa.title=m.title and wa.production_year=m.production_year and lower(wa.result)='won'
union
SELECT title, production_year from director_award da where da.title=m.title and da.production_year=m.production_year and lower(da.result)='won'
union
SELECT title, production_year from actor_award aa where aa.title=m.title and aa.production_year=m.production_year and lower(aa.result)='won' 
union
SELECT title, production_year from crew_award ca where ca.title=m.title and ca.production_year=m.production_year and lower(ca.result)='won' );
",2018-08-31 16:18:21.783071+10,11,1,182,correct
12307,"select count(*) from writer_award
where id =
(select id from person
where lower(first_name)='woody' AND lower(last_name)='allen') AND year_of_award<=1995 AND year_of_award>=1991;",2018-08-31 16:18:26.487148+10,9,0,466,partially correct
12308,select country from restriction where title = 'Shakespeare in Love' and description = 'M';,2018-08-31 16:18:37.564757+10,6,1,305,correct
12309,"SELECT id,first_name,last_name
FROM person
WHERE year_born = (
	SELECT MAX(p.year_born)
	FROM person p
);",2018-08-31 16:18:41.326992+10,7,1,285,correct
12310,"SELECT id
FROM person;",2018-08-31 16:18:42.780063+10,15,0,169,partially correct
12311,"SELECT sp.id
FROM (SCENE NATURAL JOIN PERSON) AS sp
WHERE lower(sp.title)='psycho'
AND sp.production_year=1960
AND sp.scene_no=1;",2018-08-31 16:18:46.416358+10,10,0,442,partially correct
12312,"SELECT count(year_born)
FROM PERSON, WRITER
WHERE PERSON.id= WRITER.id and year_born=1935;",2018-08-31 16:18:59.190136+10,1,0,428,partially correct
12313,"SELECT p.first_name,p.last_name,r.title,r.production_year,r.description
FROM person p,
     role r,
	 (SELECT r.id,count(*) AS number
	  FROM role r
	  GROUP BY r.id) x
WHERE r.id=p.id
	AND r.id=x.id
	AND x.number = (SELECT MAX(y.number)
				FROM (SELECT r.id,count(*) AS number
					FROM role r
					GROUP BY r.id) y);",2018-08-31 16:19:12.898726+10,15,1,217,correct
12317,;,2018-08-31 16:19:26.10559+10,3,0,266,noninterpretable
12318,"select b.id
from (select a.id , count(*) as number
      from (select p.id,d.title
      from director d, person p
      where d.id=p.id
      union 
      select p.id ,w.title
      from writer w , person p
      where w.id=p.id) as a
      group by a.id)as b
where b.number =(select max(d.number)
                 from (select c.id , count(*) as number
                 from (select p.id,d.title
                 from director d, person p
                 where d.id=p.id
                 union 
                 select p.id ,w.title
                 from writer w , person p
                 where w.id=p.id) as c
                 group by c.id)as d);",2018-08-31 16:19:28.854031+10,14,1,298,correct
12319,"SELECT da.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE (SELECT count(*)
	FROM da.
	d.title = da.title
	AND d.production_year = da.production_year);",2018-08-31 16:19:30.2538+10,13,0,268,noninterpretable
12320,"select country
from restriction r
where lower(r.title) = ""shakespeare in love"" and lower(r.description) = ""m"";",2018-08-31 16:19:38.943357+10,6,1,423,correct
12321,"select country 
from 
(movie natural join restriction) as mr
where lower(title) = 'shakespeare in love'
and description = 'M';
",2018-08-31 16:19:46.088868+10,6,0,201,partially correct
12322,"SELECT id FROM
(SELECT sm.* FROM scene NATURAL JOIN movie NATURAL JOIN appearance NATURAL JOIN role NATURAL JOIN person AS sm
WHERE lower(title)='psycho')
GROUP BY sm.scene_no
HAVING COUNT(scene_no)=1;",2018-08-31 16:19:48.525775+10,10,0,393,noninterpretable
12323,"SELECT id, first_name, last_name
FROM movie NATURAL JOIN director NATURAL JOIN person AS dw
GROUP BY dw.id
HAVING count(title) >= 2 ;",2018-08-31 16:19:50.04219+10,4,0,160,partially correct
12324,"select id
from (appearance natural join role) as ar
where lower(title) = lower('Psycho') and production_year = 1960
group by id having count(scene_no) = 1;",2018-08-31 16:19:52.351985+10,10,1,347,correct
12325,"select r.id
from appearance a,  role r
where lower(a.title) = 'psycho'
	and r.title = a.title
	and a.production_year = r.production_year
	and a.description = r.description
	and a.production_year = '1960'
	group by r.id
	having count(*) = 1;
",2018-08-31 16:20:09.693652+10,10,1,229,correct
12326,"select count(*) from movie m where not exists(
select title, production_year
from movie_award ma 
where ma.title = m.title
and ma.production_year = m.production_year
union
select title, production_year
from crew_award ca 
where ca.title = m.title
and ca.production_year = m.production_year
union
select title, production_year
from director_award da 
where da.title = m.title
and da.production_year = m.production_year
union
select title, production_year
from writer_award wa 
where wa.title = m.title
and wa.production_year = m.production_year
union
select title, production_year
from actor_award aa 
where aa.title = m.title
and aa.production_year = m.production_year
);
",2018-08-31 16:20:10.951493+10,11,0,129,partially correct
12327,"select count(*)
from movie m
where m.title not in (
select title from movie_award where lower(result)='won'
union
select title from crew_award where lower(result)='won'
union
select title from director_award where lower(result)='won'
union
select title from writer_award where lower(result)='won'
union
select title from actor_award where lower(result)='won');

",2018-08-31 16:20:32.118117+10,11,0,293,partially correct
12328,"SELECT DISTINCE sp.id
FROM (APPEARANCE NATURAL JOIN PERSON) AS sp
WHERE lower(sp.title)='psycho'
AND sp.production_year=1960
AND sp.scene_no=1;",2018-08-31 16:20:45.350163+10,10,0,442,noninterpretable
12329,"select count(*)
from
writer
natural join
person
where
year_born = 1935;",2018-08-31 16:20:50.005817+10,1,0,271,partially correct
12330,"select mr.country 
from 
restriction as mr
where lower(mr.title) = 'shakespeare in love'
and mr.description = 'M';
",2018-08-31 16:21:03.125852+10,6,1,201,correct
12331,"select count(*) 
from writer natural join person natural join writer_award
where first_name = 'Woody' and last_name = 'Allen' and result = 'won' and year_of_award >= 1991 and year_of_award <= 1995;
",2018-08-31 16:21:03.316184+10,9,1,66,correct
12332,"select id, first_name, last_name
from person
where year_born = (
	select max(year_born)
	from person);",2018-08-31 16:21:07.758027+10,7,1,423,correct
12333,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 16:21:18.364245+10,1,1,428,correct
12334,"select count(*) from movie m where not exists(
select title, production_year
from movie_award ma 
where ma.title = m.title
and ma.production_year = m.production_year
and ma.result = 'won'
union
select title, production_year
from crew_award ca 
where ca.title = m.title
and ca.production_year = m.production_year
and ca.result = 'won'
union
select title, production_year
from director_award da 
where da.title = m.title
and da.production_year = m.production_year
and da.result = 'won'
union
select title, production_year
from writer_award wa 
where wa.title = m.title
and wa.production_year = m.production_year
and wa.result = 'won'
union
select title, production_year
from actor_award aa 
where aa.title = m.title
and aa.production_year = m.production_year
and aa.result = 'won'
);
",2018-08-31 16:21:20.087987+10,11,0,129,partially correct
12335,"select count(*) from writer_award
where id =
(select id from person
where lower(first_name)='woody' AND lower(last_name)='allen') AND year_of_award<=1995 AND year_of_award>=1991 AND lower(result)='won';",2018-08-31 16:21:22.786845+10,9,1,466,correct
12336,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:21:30.799164+10,13,1,268,correct
12337,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
	SELECT ma.title, ma.production_year
	FROM movie_award ma
	WHERE lower(ma.result)='won' AND
		ma.title=m.title AND
		ma.production_year=m.production_year
	UNION
	SELECT cw.title, cw.production_year
	FROM crew_award cw
	WHERE lower(cw.result)='won' AND
		cw.title=m.title AND
		cw.production_year=m.production_year
	UNION
	SELECT da.title, da.production_year
	FROM director_award da
	WHERE lower(da.result)='won' AND
		da.title=m.title AND
		da.production_year=m.production_year
	UNION
	SELECT wa.title, wa.production_year
	FROM writer_award wa
	WHERE lower(wa.result)='won' AND
		wa.title=m.title AND
		wa.production_year=m.production_year
	UNION
	SELECT aa.title, aa.production_year
	FROM actor_award aa
	WHERE lower(aa.result)='won' AND
		aa.title=m.title AND
		aa.production_year=m.production_year);",2018-08-31 16:21:30.897847+10,11,1,430,correct
12338,"SELECT ar.id
FROM (appearance a NATURAL JOIN role r) AS ar
WHERE lower(ar.title) = 'psycho' AND ar.production_year = 1960
GROUP BY ar.id
HAVING count(*) <2;",2018-08-31 16:21:32.467339+10,10,1,420,correct
12339,"select count(*)
from
(select distinct id
from
writer
natural join
person
where
year_born = 1935) as m
group by id;",2018-08-31 16:21:34.211518+10,1,1,271,correct
12340,"SELECT id FROM
(SELECT sm.* FROM scene NATURAL JOIN movie NATURAL JOIN appearance NATURAL JOIN role NATURAL JOIN person AS sm
WHERE lower(title)='psycho')
GROUP BY scene_no
HAVING COUNT(*)=1;",2018-08-31 16:21:44.222003+10,10,0,393,noninterpretable
12341,"select country 
from 
restriction 
where lower(title) = 'shakespeare in love'
and description = 'M';
",2018-08-31 16:21:46.481623+10,6,1,201,correct
12342,"select x.id from
(select x1.id, count(*) as no_of_workedon from
(select d.id, title, production_year from director d
union
select w.id, title, production_year from writer w) x1
group by x1.id )x
where x.no_of_workedon = 
(select max(x2.no_of_workedon) from
(select x1.id, count(*) as no_of_workedon from
(select d.id, title, production_year from director d
union 
select w.id, title, production_year from writer w)x1
group by x1.id) x2) ;",2018-08-31 16:21:56.960445+10,14,1,400,correct
12343,"select count(*)
from person
where person.year_born =1935 and person.id in (select id from writer);",2018-08-31 16:22:03.663859+10,1,1,291,correct
12344,"with wa_movie as (
select title, production_year 
from (Director d NATURAL JOIN Movie m NATURAL JOIN person p) as pdm
where lower(pdm.first_name) like ""woody"" and lower(pdm.last_name) like ""allen"" and pdm.production_year between 1991 AND 1995)
select count(*) 
from (wa_movie NATURAL JOIN Writer_Award w) as ww
where lower(ww.result) like ""won"";
",2018-08-31 16:22:06.518655+10,9,0,318,partially correct
12345,"SELECT count(*)
FROM person p;
",2018-08-31 16:22:24.75789+10,14,0,268,partially correct
12346,"WITH ci AS (SELECT id,count(*) as no
            FROM role
		GROUP BY ROLE.id)
SELECT first_name,last_name,title, production_year,description
FROM ci, person p,role r
WHERE ci.id = p.id AND ci.no = (SELECT MAX(no) FROM ci) AND ci.id = r.id;",2018-08-31 16:22:33.13842+10,15,1,443,correct
12347,"SELECT p.id, p.first_name, p.last_name
FROM ( person p NATURAL JOIN writer w NATURAL JOIN director d) as a
GROUP BY p.id
HAVING count(*)>1;",2018-08-31 16:23:03.036702+10,4,1,366,correct
12348,"SELECT id, first_name, last_name
FROM person
WHERE EXISTS(SELECT MIN(year_born) from person);",2018-08-31 16:23:09.459698+10,7,0,281,partially correct
12349,"select id, award_name, year_of_award, category
from (select * from director_award
where result = 'nominated') as n natural join director;

",2018-08-31 16:23:10.703616+10,13,1,250,correct
12350,"SELECT p.id 
FROM (SELECT id FROM director d, writer w WHERE d.id = w.id AND d.title = w.title) 
GROUP BY p.id
HAVING max(count);",2018-08-31 16:23:16.505661+10,14,0,446,noninterpretable
12351,"SELECT count(id)
FROM person
WHERE NOT EXISTS (SELECT * FROM director WHERE director.id=person.id);",2018-08-31 16:23:29.639457+10,12,1,422,correct
12352,"select count(*)  
from movie m where not exists 
(select title, production_year from movie_award ma where m.title=ma.title 
and m.production_year=ma.production_year
and ma.result='won'
union select title, production_year 
from actor_award aa where m.title=aa.title and m.production_year=aa.production_year
and aa.result='won'
union select title, production_year from writer_award wa
where m.title=wa.title and m.production_year=wa.production_year
and wa.result='won'
union select title, production_year from director_award da
where m.title=da.title
and m.production_year=da.production_year and da.result='won'
union select title, production_year from crew_award ca
where m.title=ca.title and m.production_year=ca.production_year
and ca.result='won');",2018-08-31 16:23:45.181763+10,11,0,354,partially correct
12353,"SELECT id, first_name, last_name
FROM writer NATURAL JOIN director NATURAL JOIN person
GROUP BY id
HAVING count(title) >= 2 ;
",2018-08-31 16:23:57.597601+10,4,1,160,correct
12354,"SELECT w.id,w.award_name,w.year_of_award,w.category
FROM (Director_award NATURAL JOIN Director) AS w
WHERE lower(w.result) = 'nominated'
Group by w.id;",2018-08-31 16:23:58.833415+10,13,1,218,correct
12355,"select count(*) 
from (writer w NATURAL JOIN writer_award wa NATURAL JOIN person p) as pdm
where lower(pdm.first_name) like ""woody"" and lower(pdm.last_name) like ""allen"" and pdm.production_year between 1991 AND 1995;
",2018-08-31 16:24:03.620018+10,9,1,318,correct
12356,"select id,first_name,last_name from person where year_born = (select max(year_born) from person);",2018-08-31 16:24:05.275761+10,7,1,305,correct
12357,"SELECT 
    p.first_name, p.last_name, r.title, r.production_year, r.description
FROM
    person p,
    role r,
(SELECT id,COUNT(*) number_of_roles
  FROM role
  GROUP BY id) b
WHERE r.id = p.id
AND p.id = b.id
AND b.number_of_roles IN (
    SELECT MAX(number_of_roles)
    FROM (
         SELECT id,COUNT(*) AS number_of_roles
         FROM role
         GROUP BY id)a);",2018-08-31 16:24:14.990656+10,15,1,169,correct
12358,"SELECT x.id
FROM (SELECT x1.id, count(*) AS NoOfWorkedON
	FROM (SELECT d.id, title,production_year
		FROM director d
		UNION
		Select w.id, title, production_year
		FROM writer w) x1
		GROUP BY x1.id) x

WHERE x.NoOfWorkedON = 
	(SELECT MAX(x2.NoOfWorkedON)
	FROM (SELECT x1.id, COUNT(*) AS NoOfWorkedON
		FROM (SELECT d.id, title, production_year
			FROM director d
			UNION
			SELECT w.id,title,production_year
			FROM writer w)x1
			GROUP BY x1.id) x2);
",2018-08-31 16:24:32.509569+10,14,1,23,correct
12359,"with wo as (
	select * from director
	union select w.id,w.title,w.production_year from writer w, director d
	where w.id <> d.id and w.title <> d.title and w.production_year <> d.production_year
), won as (
	select id,count(*) num from wo
	group by id
	having count(*)
)

select id from won
where num = (select max(num) from won);",2018-08-31 16:24:32.847561+10,14,1,156,correct
12360,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 16:24:35.000675+10,3,1,266,correct
12361,"select count(*) from movie m where not exists(
select title, production_year
from movie_award ma 
where ma.title = m.title
and ma.production_year = m.production_year
and lower(ma.result) = 'won'
union
select title, production_year
from crew_award ca 
where ca.title = m.title
and ca.production_year = m.production_year
and lower(ca.result) = 'won'
union
select title, production_year
from director_award da 
where da.title = m.title
and da.production_year = m.production_year
and lower(da.result) = 'won'
union
select title, production_year
from writer_award wa 
where wa.title = m.title
and wa.production_year = m.production_year
and lower(wa.result) = 'won'
union
select title, production_year
from actor_award aa 
where aa.title = m.title
and aa.production_year = m.production_year
and lower(aa.result) = 'won'
);
",2018-08-31 16:24:45.686822+10,11,1,129,correct
12362,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:25:13.517326+10,14,1,268,correct
12363,"with wo as (
	select * from director
	union select w.id,w.title,w.production_year from writer w, director d
	where w.id <> d.id and w.title <> d.title and w.production_year <> d.production_year
), won as (
	select id,count(*) num from wo
	group by id
)

select id from won
where num = (select max(num) from won);",2018-08-31 16:25:28.355941+10,14,1,156,correct
12364,"select id, first_name, last_name
from person p 
where p.year_born = (select max(year_born) from person);",2018-08-31 16:25:30.124135+10,7,1,201,correct
12365,"select count(p.id) 
from person p
where not exists 
(select d.id from director d where d.id=p.id) order by p.id;",2018-08-31 16:25:39.061339+10,12,1,200,correct
12366,"SELECT count(*)
FROM person;",2018-08-31 16:25:53.2112+10,15,0,268,partially correct
12367,"SELECT count(*)
FROM PERSON p
WHERE EXISTS (SELECT *FROM WRITER w WHERE w.id=p.id AND p.year_born=1935);",2018-08-31 16:26:10.174492+10,1,1,355,correct
12368,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 16:26:11.010631+10,15,1,268,correct
12369,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 AND production_year<1994
GROUP BY production_year;

",2018-08-31 16:26:13.385477+10,2,1,287,correct
12370,"select production_year, count(*)
from movie
where production_year between 1991 and 1993
group by production_year;",2018-08-31 16:26:19.03711+10,2,1,291,correct
12371,"SELECT COUNT()
FROM writer_award
WHERE award_name = 'Woody Allen' AND year_of_award = 1991 OR year_of_award = 1992 OR year_of_award = 1993 OR year_of_award = 1994 OR year_of_award = 1995;",2018-08-31 16:26:20.024831+10,9,0,251,partially correct
12372,"SELECT title, production_year
FROM movie NATURAL JOIN writer NATURAL JOIN person 
WHERE first_name = ""Kevin"" AND last_name = ""Williamson"" ;",2018-08-31 16:26:31.338271+10,5,1,160,correct
12373,"SELECT id
FROM person
WHERE year_born = (SELECT max(year_born)
				FROM person
				WHERE year_born < (SELECT max(year_born)
								FROM person));",2018-08-31 16:26:38.368839+10,3,1,430,correct
12374,"select count(*)

from writer w, person p

where p.id = w.id and p.year_born = 1935;",2018-08-31 16:26:46.220422+10,1,0,389,partially correct
12375,"with w_m as(
select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from crew_award
where lower(result) = 'won'
union
select title, production_year
from director_award
where lower(result) = 'won'
union
select title, production_year
from writer_award
where lower(result) = 'won'
union
select title, production_year
from actor_award
where lower(result) = 'won')
select count(*)
from movie
where(title, production_year) not in (select * from w_m);",2018-08-31 16:26:52.754265+10,11,1,347,correct
12376,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where not exists (
select result
from director_award
where lower(result)='won')
and exists (
select result
from director_award
where lower(result)='nominated')
and d.title=da.title;",2018-08-31 16:27:14.510198+10,13,0,386,partially correct
12377,"with w_m as(
select title, production_year
from movie_award
where lower(result) = 'won'
union
select title, production_year
from crew_award
where lower(result) = 'won'
union
select title, production_year
from director_award
where lower(result) = 'won'
union
select title, production_year
from writer_award
where lower(result) = 'won'
union
select title, production_year
from actor_award
where lower(result) = 'won')
select count(*)
from movie
where(title, production_year) not in w_m;",2018-08-31 16:27:17.163739+10,11,1,347,correct
12378,"SELECT dw.id, dw.first_name, dw.last_name
FROM (
	person NATURAL JOIN 
	writer NATURAL JOIN 
	director ) AS dw
GROUP BY dw.id
HAVING count(*) > 1;",2018-08-31 16:27:37.041977+10,4,1,425,correct
12379,"SELECT x.id

FROM(
	SELECT x1.id,count(*) AS times
		FROM(
			SELECT d.id, title, production_year
			FROM director d
			UNION
			SELECT w.id, title, production_year
			FROM writer w) AS x1
	GROUP BY x1.id) AS x
WHERE x.times =

(
SELECT MAX(times)

FROM(
	SELECT x2.id,count(*) AS times
		FROM(
			SELECT d.id, title, production_year
			FROM director d
			UNION
			SELECT w.id, title, production_year
			FROM writer w) AS x2
	GROUP BY x2.id) AS x
)	

;",2018-08-31 16:27:41.449873+10,14,1,173,correct
12380,"select movie_award.title, movie_award.production_year, person.first_name, person.last_name
from movie_award, director, person
where lower(category)='best film' and lower(award_name)='bafta film award' and lower(result)='won'and movie_award.title=director.title 
and director.id=person.id;",2018-08-31 16:27:48.356858+10,8,1,463,correct
12381,1;,2018-08-31 16:27:48.835992+10,8,0,281,noninterpretable
12382,"SELECT p.first_name,p.last_name, ma.title,ma.production_year
FROM person p, director d, 
	(SELECT title,production_year
	FROM movie_award
	WHERE lower(result) = 'won'
		AND lower(award_name) = 'bafta film award'
		AND lower(category) = 'best film') ma
WHERE p.id = d.id
	AND lower(d.title) = lower(ma.title)
	AND d.production_year = ma.production_year;",2018-08-31 16:27:50.393669+10,8,1,285,correct
12383,"SELECT id, COUNT(id)
FROM
(SELECT id, title, production_year 
FROM director d1
UNION 
SELECT id, title, production_year
FROM writer w2)
GROUP BY id
WHERE COUNT(id)=(SELECT MAX(COUNT(id)) FROM (SELECT id, title, production_year 
FROM director d2
UNION 
SELECT id, title, production_year
FROM writer w2));
",2018-08-31 16:28:13.040346+10,14,0,441,noninterpretable
12384,"select first_name, last_name, title, production_year,description
from
role
natural join
person
where id in (select id
			from (select id, count(id) as count
			      from
				  role
				  group by id
				  ) as m
				  where count = (select max(count)
				  			  from(select id, count(id) as count
			      			        from
				  				  role
				  				  group by id) as m
							  )
							);",2018-08-31 16:28:27.087939+10,15,1,271,correct
12385,"SELECT ma.title,ma.production_year,p.first_name,p.last_name
FROM person p, director d, 
	(SELECT title,production_year
	FROM movie_award
	WHERE lower(result) = 'won'
		AND lower(award_name) = 'bafta film award'
		AND lower(category) = 'best film') ma
WHERE p.id = d.id
	AND lower(d.title) = lower(ma.title)
	AND d.production_year = ma.production_year;",2018-08-31 16:28:29.5723+10,8,1,285,correct
12386,;,2018-08-31 16:28:32.171842+10,3,0,418,noninterpretable
12387,"SELECT COUNT(*)
FROM person p, writer w
WHERE p.id= w.id AND year_born= 1935
GROUP BY year_born;
",2018-08-31 16:28:39.243529+10,1,0,287,partially correct
12388,"select production_year, count(*)
from MOVIE
where production_year = 1993 or production_year = 1992 or production_year = 1991
group by production_year;",2018-08-31 16:28:45.329439+10,2,1,89,correct
12389,"select id, first_name, last_name
from person
where year_born 
> ANY (select year_born
from person);",2018-08-31 16:29:08.259966+10,7,0,245,noninterpretable
12390,"SELECT COUNT(*) FROM
(SELECT title FROM movie NATURAL JOIN movie_award NATURAL JOIN crew_award NATURAL JOIN director_award
NATURAL JOIN writer_award NATURAL JOIN actor_award NATURAL JOIN award
WHERE award_name is NULL);",2018-08-31 16:29:50.007079+10,11,0,393,partially correct
12391,"select p.id,p.first_name,p.last_name,title,production_year,description
from person p, role
where p.id = role.id
and p.id in
(select id
from role
group by id
having count(*) in
(select max(num)
from (select id,count(*) as num
from role
group by id ) as d));",2018-08-31 16:30:04.609486+10,15,0,344,partially correct
12392,"Select count(distinct writer.id)
From writer join person on writer.id = person.id
Where person.year_born = 1935;
",2018-08-31 16:30:17.609498+10,1,1,411,correct
12393,"select id, first_name, last_name
from person
where year_born = (select min(year_born)
from person);",2018-08-31 16:30:20.888416+10,7,0,245,partially correct
12394,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where d.title=da.title and
da.result='nominated' and 
d.id not in (
select f.id
from director f, director_award fa
where f.title=fa.title and
fa.result='won');",2018-08-31 16:30:26.451915+10,13,1,196,correct
12395,"select id, first_name, last_name
from person
where year_born = (select max(year_born)
from person);",2018-08-31 16:30:33.937118+10,7,1,245,correct
12396,"SELECT w.title, w.production_year
FROM person p, writer w
WHERE p.id = w.id AND 
	lower(p.first_name) = 'kevin' AND 
	lower(p.last_name) = 'williamson';",2018-08-31 16:30:35.262634+10,5,1,425,correct
12397,"select p.first_name,p.last_name,title,production_year,description
from person p, role
where p.id = role.id
and p.id in
(select id
from role
group by id
having count(*) in
(select max(num)
from (select id,count(*) as num
from role
group by id ) as d));",2018-08-31 16:30:36.90594+10,15,1,344,correct
12398,"select count(*)
from movie
where title not in (select title
				from movie_award
				where lower(result)='won'
			union
			select title
				from crew_award
				where lower(result)='won'
			union
			select title
				from director_award
				where lower(result)='won'
			union
			select title
				from writer_award
				where lower(result)='won'
			union
			select title
				from actor_award
				where lower(result)='won'
			);",2018-08-31 16:30:39.538598+10,11,0,432,partially correct
12399,"select id
from person
where year_born=(
select max(year_born)
from person 
where  year_born<(select max(year_born)from person));",2018-08-31 16:30:47.9517+10,3,1,293,correct
12428,"SELECT p.i
FROM 
(SELECT id i, count(id) c
FROM
person natural join director natural join writer
GROUP BY id) AS p
WHERE p.c IN
(SELECT max(c)
FROM
(SELECT id i, count(id) c
FROM
person natural join director natural join writer
GROUP BY id) AS q);",2018-08-31 16:34:54.988318+10,14,0,459,partially correct
12400,"select count(*)  
from movie m where not exists 
(select title, production_year from movie_award ma where m.title=ma.title 
and m.production_year=ma.production_year
and lower(ma.result)='won'
union select title, production_year 
from actor_award aa where m.title=aa.title and m.production_year=aa.production_year
and lower(aa.result)='won'
union select title, production_year from writer_award wa
where m.title=wa.title and m.production_year=wa.production_year
and lower(wa.result)='won'
union select title, production_year from director_award da
where m.title=da.title and m.production_year=da.production_year and lower(da.result)='won'
union select title, production_year from crew_award ca
where m.title=ca.title and m.production_year=ca.production_year
and lower(ca.result)='won');",2018-08-31 16:30:52.087498+10,11,1,354,correct
12401,"select count(*)
from movie_award natural join crew_award natural join director_award natural join writer_award  natural join actor_award
where lower(result)='nominated';",2018-08-31 16:31:03.192242+10,11,0,154,partially correct
12402,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON IN
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:31:05.56949+10,14,1,169,correct
12403,"SELECT p.id, first_name, last_name
FROM (
	SELECT d.id, d.title, count(*) AS No
	FROM writer w, director d
	WHERE w.id = d.id and w.title = d.title
	GROUP BY d.title
	HAVING count(*) > 1
) x1
WHERE p.id = x1.id ;

",2018-08-31 16:31:05.711631+10,4,0,215,noninterpretable
12404,"SELECT p.id, p.first_name, p.last_name
FROM ( person p NATURAL JOIN writer w NATURAL JOIN director d) as a
GROUP BY p.id
HAVING count(*)>1;",2018-08-31 16:31:15.32757+10,4,1,366,correct
12405,;,2018-08-31 16:31:31.64599+10,10,0,428,noninterpretable
12406,"select d.id, da.award_name, da.year_of_award, da.category
from director d, director_award da
where 

 d.title=da.title
AND da.production_year = d.production_year
and lower(result)='nominated'
AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:31:36.061111+10,13,1,386,correct
12407,"with rn as (
	select id,count(*) num from role
	group by id
)

select first_name,last_name,title,production_year,description from person p, rn, role r
where p.id = rn.id and p.id = r.id 
and num = (select max(num) from rn);",2018-08-31 16:31:56.082666+10,15,1,156,correct
12408,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;

",2018-08-31 16:31:57.48207+10,4,1,215,correct
12409,"select m1.title, m1.production_year, pd.first_name, pd.last_name
from 
	(director natural join person) as pd,
	(select title, production_year
	from movie_award m
	where
		lower(m.award_name) = ""bafta film award"" and
		lower(m.category) = ""best film"" and
		lower(m.result) = ""won"") as m1
where 
	m1.title = pd.title and
	m1.production_year = pd.production_year;",2018-08-31 16:32:04.596901+10,8,1,423,correct
12410,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 16:32:15.659013+10,10,1,428,correct
12411,"with p2 as (
select id, year_born from person 
where year_born < (
select max(year_born) from person))
select id, year_born from p2
where year_born = (
select max(year_born) from p2);",2018-08-31 16:32:18.258991+10,3,0,129,partially correct
12412,"select count(*)
from writer_award as wa, (
	select id from person where first_name='Woody' and last_name='Allen'
) as a
where wa.id=a.id
and year_of_award >=1991
and year_of_award <=1995
and lower(result)='won';",2018-08-31 16:32:19.773903+10,9,1,207,correct
12413,"SELECT COUNT(*)
FROM writer NATURAL JOIN person
WHERE year_born=1935;",2018-08-31 16:32:30.967547+10,1,0,382,partially correct
12414,"SELECT p.first_name, p.last_name, r.title,r.production_year, r.description
FROM person p,
role r,
(	SELECT id, COUNT(*) AS number_of_roles
	FROM role
	GROUP BY id) as b
WHERE r.id = p.id
AND p.id = b.id
AND b.number_of_roles IN(SELECT MAX(number_of_roles)
				FROM (
				SELECT id, count(*) AS number_of_roles
				FROM role
				GROUP BY id) AS a);

",2018-08-31 16:32:31.44315+10,15,1,23,correct
12415,"select count(*)
from person
where not exists (select* from person natural join director where person.id = director.id);",2018-08-31 16:32:37.739398+10,12,0,89,partially correct
12416,"with p2 as (
select id, year_born from person 
where year_born < (
select max(year_born) from person))
select id from p2
where year_born = (
select max(year_born) from p2);",2018-08-31 16:32:55.999242+10,3,1,129,correct
12417,"select production_year,count(*)

from movie m

where production_year = 1993 or production_year = 1992 or production_year = 1991

group by production_year;",2018-08-31 16:33:06.69528+10,2,1,389,correct
12418,"select m.title,production_year from movie m,
(select title from writer w,person p
where first_name='Kevin' and last_name='Williamson' and p.id=w.id) as t
where m.title=t.title;",2018-08-31 16:33:14.180623+10,5,1,192,correct
12419,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:33:20.861922+10,11,1,432,correct
12420,;,2018-08-31 16:33:34.478115+10,11,0,428,noninterpretable
12421,"SELECT COUNT(*)
FROM person
WHERE EXISTS (SELECT * FROM writer
              WHERE writer.id = person.id
              AND person.year_born = 1935);",2018-08-31 16:33:40.61954+10,1,1,169,correct
12422,;,2018-08-31 16:33:42.12983+10,3,0,393,noninterpretable
12423,Select count ;,2018-08-31 16:33:56.934362+10,15,0,105,noninterpretable
12424,"SELECT COUNT(*)
FROM writer_award wa
WHERE wa.id = (
	SELECT w.id
	FROM person p,writer w
	WHERE p.id = w.id
		AND lower(p.first_name) = 'woody'
		AND lower(p.last_name) = 'allen'
	GROUP BY w.id);
",2018-08-31 16:34:14.742084+10,9,0,285,partially correct
12425,"select p.count(p.title) as totalno from (select d.id,d.title,d.production_year from director d union
select w.id,w.title,w.production_year from writer w) as p
group by p.id oeder by totalno desc limit1;",2018-08-31 16:34:22.54114+10,14,0,255,noninterpretable
12426,"select title, production_year, first_name, last_name
from (movie_award natural join director natural join person) as md
where
	lower(category) = 'best film' 
	and lower(award_name) = 'bafta film award' 
	and lower(result) = 'won';",2018-08-31 16:34:24.248403+10,8,1,201,correct
12427,"SELECT count(wa.title)
FROM writer_award AS wa,person AS p
WHERE wa.id = p.id and lower(p.first_name)=""Woody"" and lower(p.last_name)=""Allen"" and wa.year_of_award<=1991 and wa.year_of_award>=1991;",2018-08-31 16:34:49.325693+10,9,0,281,partially correct
12429,"SELECT COUNT(DISTINCT id)
FROM writer NATURAL JOIN person
WHERE year_born=1935;",2018-08-31 16:34:55.486461+10,1,1,382,correct
12602,"SELECT id,first_name,last_name
FROM person
WHERE year_born=(SELECT MAX(year_born)
				FROM person);",2018-08-31 16:57:37.903244+10,7,1,382,correct
12430,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:34:57.755952+10,11,1,428,correct
12431,"select ma.title, ma.production_year, person.first_name, person.last_name
from (
Select movie_award.title, movie_award.production_year
from movie_award
where award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won') as ma,

where movie_award.title = director.title AND movie_award.production_year = director.production_year
and director.id = person.id;

",2018-08-31 16:34:58.370757+10,8,0,45,noninterpretable
12432,;,2018-08-31 16:35:13.147024+10,3,0,428,noninterpretable
12433,"select count(*)
from (writer_award natural join person) as wp
where 
	lower(wp.first_name) = ""woody"" and
	lower(wp.last_name) = ""allen"" and
	lower(wp.result) = ""won"" and
	wp.year_of_award >= 1991 and
	wp.year_of_award <= 1995;",2018-08-31 16:35:27.309587+10,9,1,423,correct
12434,;,2018-08-31 16:35:34.553396+10,13,0,418,noninterpretable
12435,SELECT;,2018-08-31 16:35:34.711422+10,15,0,352,noninterpretable
12436,"SELECT COUNT(*)
FROM writer_award wa,person p
WHERE wa.year_of_award>=1991 AND wa.year_of_award<=1995 AND p.id = wa.id
      AND lower(p.first_name) = 'woody' AND lower(p.last_name) = 'allen' AND lower(wa.result) = 'won';",2018-08-31 16:35:39.128015+10,9,1,443,correct
12437,"select d.id, da.award_name,da.year_of_award,da.category
from director_award da,director d
where da.title =d.title and 
	da.production_year = d.production_year and
	lower(da.result) !='won'
group by d.id
having count(*)>0;
",2018-08-31 16:35:43.543125+10,13,1,401,correct
12438,"SELECT production_year, COUNT(*)
FROM movie m
WHERE m.production_year >= 1991
AND m.production_year <= 1993
GROUP BY m.production_year;",2018-08-31 16:35:47.626612+10,2,1,169,correct
12439,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 16:35:50.889605+10,3,1,428,correct
12440,"select d.id,dam.award_name,dam.year_of_award,dam.category 
from(select award_name,year_of_award,category from director_award where result='lost' group by title having count(*)>1) as dam, director d; ",2018-08-31 16:35:53.81753+10,13,0,266,partially correct
12441,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 16:36:02.847747+10,15,1,352,correct
12442,;,2018-08-31 16:36:05.778995+10,14,0,386,noninterpretable
12443,"SELECT production_year,COUNT(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-31 16:36:29.186541+10,2,1,382,correct
12444,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT exists (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:36:30.735327+10,13,0,418,noninterpretable
12445,"SELECT COUNT(*)
FROM person p
WHERE NOT EXISTS(SELECT * FROM director d
                 WHERE p.id = d.id);",2018-08-31 16:36:39.74016+10,12,1,169,correct
12446,"SELECT COUNT(*)
FROM writer_award wa
WHERE wa.id = (
	SELECT w.id
	FROM person p,writer w
	WHERE p.id = w.id
		AND lower(p.first_name) = 'woody'
		AND lower(p.last_name) = 'allen'
	GROUP BY w.id)
	AND wa.year_of_award BETWEEN 1991 AND 1995
	AND lower(wa.result) = 'won';",2018-08-31 16:36:41.477612+10,9,1,285,correct
12447,"select id
from person
where person.year_born=(
	select max(year_born)
	from person
	where year_born<(
	select max(year_born)
	from person);",2018-08-31 16:36:44.388839+10,3,0,432,noninterpretable
12448,"select d.id,dam.award_name,dam.year_of_award,dam.category from director d, director_award dam; ",2018-08-31 16:36:48.555557+10,13,0,266,partially correct
12449,1;,2018-08-31 16:37:02.797153+10,10,0,281,noninterpretable
12450,"select id
from person
where person.year_born=(
	select max(year_born)
	from person
	where year_born<(
	select max(year_born)
	from person));",2018-08-31 16:37:29.380162+10,3,1,432,correct
12451,"select count(*)
from writer natural join person
where year_born = ""1935"";",2018-08-31 16:37:31.405566+10,1,0,330,partially correct
12452,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 199
GROUP BY production_YEAR;
",2018-08-31 16:37:36.173452+10,2,0,355,partially correct
12453,"SELECT p.first_name,p.last_name, r.title, r.production_year, r.description
   FROM
    person p,
    ROLE r,
    ( SELECT id, count(*) AS number_of_roles FROM ROLE GROUP BY id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (SELECT max(number_of_roles) FROM ( SELECT id, count ( * ) AS number_of_roles FROM ROLE
GROUP BY id ) AS a );",2018-08-31 16:37:43.135624+10,15,1,137,correct
12454,"SELECT p.first_name,p.last_name, r.title, r.production_year, r.description
   FROM
    person p,
    ROLE r,
    ( SELECT id, count(*) AS number_of_roles FROM ROLE GROUP BY id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (SELECT max(number_of_roles) FROM ( SELECT id, count ( * ) AS number_of_roles FROM ROLE
GROUP BY id ) AS a );",2018-08-31 16:37:43.923477+10,15,1,137,correct
12455,"SELECT count(*)
FROM (writer_award NATURAL JOIN writer NATURAL JOIN person) AS w
WHERE w.first_name = 'Woody' AND w.last_name = 'Allen' AND   1991 <= w.production_year <=1995 ;",2018-08-31 16:37:44.357491+10,9,0,59,noninterpretable
12456,"SELECT country
FROM restriction 
WHERE lower(title) = 'sharkespeare in love ' AND lower(description) = 'm' ;",2018-08-31 16:37:50.065867+10,6,0,160,partially correct
12457,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 16:37:54.171615+10,15,1,438,correct
12458,"SELECT production_year, count(*)
FROM movie
WHERE production_year > 1990 AND production_year < 199
GROUP BY production_YEAR;
",2018-08-31 16:37:56.141627+10,2,0,355,partially correct
12459,"SELECT COUNT(id)
FROM (SELECT id FROM person
	EXCEPT
	SELECT id FROM director);",2018-08-31 16:38:08.413752+10,12,1,382,correct
12460,;,2018-08-31 16:38:12.299357+10,13,0,428,noninterpretable
12461,"SELECT production_year, count(*) 
FROM movie 
WHERE production_year > 1990 AND production_year < 1994 
GROUP BY production_year;",2018-08-31 16:38:30.25258+10,2,1,355,correct
12661,"SELECT production_year, count(*)
FROM movie m
where m.production_year >1990 and production_year<1994
GROUP BY production_year;",2018-08-31 17:13:35.819841+10,2,1,217,correct
12462,"select role.id from role as r
join movie as m on m.title = r.title, m.production_year = r.production_year
join scene as s on s.title = r.title, s.production_year = r.production_year
join appearance as a on a.title = s.title,  a.scene_no = s.scene_no,
a.description  = r.description 

where lower(movie.title) = 'psycho' and movie.production_year = '1960'

group by role.id
having count(*) = 1;
",2018-08-31 16:38:31.274594+10,10,0,447,noninterpretable
12463,"select ma.title, ma.production_year, p.first_name, p.last_name
from (
Select movie_award.title, movie_award.production_year
from movie_award
where award_name = 'BAFTA Film Award' and category = 'best film' and result = 'won'
) as ma,
person as p,
director as d

where ma.title = d.title AND ma.production_year = d.production_year
and d.id = p.id;

",2018-08-31 16:38:33.853114+10,8,1,45,correct
12464,1;,2018-08-31 16:38:36.263273+10,11,0,281,noninterpretable
12465,"select m.title, m.production_year, p.first_name, p.last_name  
from movie_award m natural join person p natural join director d 
where award_name = 'BAFTA Film Award' and lower(category) = 'best film' and result = 'won' ;",2018-08-31 16:38:37.614285+10,8,1,305,correct
12466,"Select 
p.first_name,
p.last_name,
r.title,
r.production_year,
r.description
From person As p,
role As r,
(Select id,
count(*) As number_of_roles
From ROLE
group by
id) AS b
Where
r.id = p.id
And p.id = b.id
And b.number_of_roles IN (
Select 
max(number_of_roles)
From (
Select id,
count(*)AS number_of_roles
From
Role
Group by
id)
AS a);",2018-08-31 16:38:52.083659+10,15,1,105,correct
12467,"SELECT id, first_name, last_name
FROM (SELECT * FROM person ORDER BY year_born DESC)
LIMIT 1;",2018-08-31 16:38:58.796221+10,7,1,366,correct
12468,"SELECT country
FROM restriction 
WHERE lower(title) = 'sharkespeare in love ' AND description = 'M' ;",2018-08-31 16:39:06.644335+10,6,0,160,partially correct
12469,"select count(*)
from writer_award
where exists (select*from writer_award where lower(id)='woody allen' and year_of_award>1990 and year_of_award<1996) ;",2018-08-31 16:39:28.164837+10,9,0,463,partially correct
12470,"SELECT count( w.award_name)
FROM (writer_award NATURAL JOIN writer NATURAL JOIN person) AS w
WHERE w.first_name = 'Woody' AND w.last_name = 'Allen' AND   1991 <= w.production_year <=1995 AND  w.result = 'won';",2018-08-31 16:39:32.034547+10,9,0,59,noninterpretable
12471,select * from person p;,2018-08-31 16:39:34.074457+10,14,0,196,partially correct
12472,"SELECT ma.title,ma.production_year,p.first_name,p.last_name 
FROM person p,director d,(SELECT title,production_year 
FROM movie_award 
WHERE lower(award_name)='bafta film award'
AND lower(category)='best film'
AND lower(result)='won') AS ma
WHERE ma.title=d.title
AND ma.production_year=d.production_year
AND d.id=p.id;

",2018-08-31 16:39:35.708218+10,8,1,372,correct
12473,"SELECT count(*) 
FROM movie m 
WHERE not in (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:39:35.897481+10,11,0,418,noninterpretable
12474,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:39:36.096381+10,13,1,428,correct
12475,;,2018-08-31 16:40:02.343564+10,13,0,154,noninterpretable
12476,;,2018-08-31 16:40:06.954418+10,14,0,428,noninterpretable
12477,"SELECT title,production_year
FROM writer person
WHERE id IN (SELECT id FROM person WHERE first_name=""Kevin"" AND last_name=""Williamson"");",2018-08-31 16:40:11.360984+10,5,1,422,correct
12478,"SELECT COUNT()
FROM writer_award wa, writer w, person p
WHERE w.id = wa.id
	 AND w.title = wa.title
	 AND w.production_year = wa.production_year
	 AND wa.id = p.id
	 AND first_name = 'Woody'
	 AND last_name = 'Allen'
	 AND result = 'Won'
	 AND year_of_award >= 1991
	 AND year_of_award <= 1995;",2018-08-31 16:40:14.884559+10,9,0,251,partially correct
12479,"select count(*)
from(
select *
from writer natural join person
where year_born = 1935
group by first_name, last_name);",2018-08-31 16:40:16.073696+10,1,1,330,correct
12480,select count(*) from person p where not exists (select * from director d where d.id = p.id);,2018-08-31 16:40:25.440716+10,12,1,264,correct
12481,"SELECT production_year, count(*)
FROM movie
WHERE production_year=1993 OR production_year=1992 OR production_year=1991
GROUP BY production_year;",2018-08-31 16:40:44.615498+10,2,1,355,correct
12482,"select ma.title, ma.production_year, first_name, last_name
from 
	( movie_award as ma natural join director d natural join person p)
where 
	lower(category)='best film' 
	and lower(award_name)='bafta film award' 
	and lower(result)='won'
;",2018-08-31 16:40:51.476896+10,8,1,152,correct
12483,"select count(*)
from 
(writer natural join person natural join writer_award) as wpw
where lower(first_name) = 'woody'
and lower(last_name) = 'allen'
and lower(result) = 'won'
and year_of_award >= 1991
and year_of_award <= 1995;",2018-08-31 16:40:57.3926+10,9,1,201,correct
12484,"select production_year, count(title)
from movie
group by production_year
having production_year = 1993 or production_year=1992 or production_year = 1991
order by production_year DESC;",2018-08-31 16:41:03.80603+10,2,1,411,correct
12485,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:41:07.66269+10,14,1,428,correct
12486,"SELECT 
country
FROM 
restriction 
WHERE 
title = 'Shakespeare in Love'
AND description = 'M' ;",2018-08-31 16:41:19.594056+10,6,1,160,correct
12487,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:41:20.812196+10,11,1,418,correct
12488,"Select 
w.title,
w.production_year
From writer As w
Where w.id = person.id
person.first_name = 'Kevin'
And 
person.last_name = 'Williamson';",2018-08-31 16:41:30.103724+10,5,0,105,noninterpretable
12566,"with plist as (
select * from director
union
select id, title, production_year from writer)

select person.id from person, plist
where person.id = plist.id
group by plist.id
having count(plist.id) = (
select max(total) from (
select count(plist.id) as total from plist
group by plist.id));",2018-08-31 16:51:42.35787+10,14,1,129,correct
12489,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT in (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:41:43.235212+10,13,1,418,correct
12490,"SELECT 
country
FROM 
restriction 
WHERE 
lower(title) = 'shakespeare in love'
AND description = 'M' ;",2018-08-31 16:41:54.181695+10,6,1,160,correct
12491,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:41:54.5198+10,13,1,432,correct
12492,"SELECT id,first_name,last_name
FROM person
WHERE EXISTS

(SELECT d.id
FROM director d,writer w
WHERE d.id=w.id AND d.title=w.title AND d.production_year=w.production_year);",2018-08-31 16:42:02.749797+10,4,0,382,partially correct
12493,;,2018-08-31 16:42:13.105383+10,15,0,428,noninterpretable
12494,1;,2018-08-31 16:42:14.741519+10,3,0,281,noninterpretable
12495,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:42:16.390632+10,14,1,386,correct
12496,"select production_year, count(*)
from movie
where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-31 16:42:25.462064+10,2,1,330,correct
12497,select * from role;,2018-08-31 16:42:28.632431+10,15,0,255,partially correct
12498,"SELECT id,first_name,last_name
FROM person
WHERE id IN

(SELECT d.id
FROM director d,writer w
WHERE d.id=w.id AND d.title=w.title AND d.production_year=w.production_year);",2018-08-31 16:42:33.976038+10,4,0,382,partially correct
12499,select * from role;,2018-08-31 16:42:35.6062+10,15,0,255,partially correct
12500,"select distinct id, award_name, year_of_award, category
from director, director_award, 
(select title, production_year from director_award 
where (select count(*) from director_award where result='nominated')>0) as h
where director.title=director_award.title
and director.production_year=director_award.production_year
and result!='won';

",2018-08-31 16:42:53.023834+10,13,1,140,correct
12501,"select dw.id, dw.first_name, dw.last_name from (person p natural join writer w natural join director d) as dw group by dw.id having count(*) > 1;",2018-08-31 16:42:57.650692+10,4,1,264,correct
12502,"Select 
w.title,
w.production_year
From writer As w,
person As p
Where w.id = p.id
And Lower(first_name) = 'kevin'
And lower(last_name) = 'williamson';",2018-08-31 16:43:04.270792+10,5,1,105,correct
12503,"with nomd as(
select title, production_year from director_award
where lower(result) = 'nominated'),
wond as (
select title, production_year from director_award
where lower(result) = 'won')
select id, award_name, year_of_award, category
from director_award, director
where director.title = director_award.title
and director.production_year = director_award.production_year
and exists (select * from nomd
where nomd.title = director.title
and nomd.production_year = director.production_year)
and not exists (select * from wond
where wond.title = director.title
and wond.production_year = director.production_year);
",2018-08-31 16:43:05.56288+10,13,1,129,correct
12504,"SELECT id, first_name , last_name
FROM person 
WHERE year_born = MIN(year_born);",2018-08-31 16:43:11.135161+10,7,0,160,noninterpretable
12505,;,2018-08-31 16:43:13.021355+10,14,0,418,noninterpretable
12506,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * 
FROM director d
WHERE d.id=p.id);",2018-08-31 16:43:35.217277+10,12,1,355,correct
12507,"select p.first_name,p.last_name,r.title,r.production_year,r.description
from person p, role r,
     (select r.id, count (*) as lr
	 from role r
	 group by r.id) as x
where p.id=x.id
and r.id=p.id
and x.lr in (select max(x1.lr)
             from (select r.id, count (*) as lr
	       from role r
	       group by r.id) as x1);",2018-08-31 16:43:47.993828+10,15,1,237,correct
12508,"select id
from (select *
from person
order by year_born desc)limit 1,1;",2018-08-31 16:44:05.409929+10,3,1,163,correct
12509,"SELECT title,production_year
FROM writer w,person p
WHERE w.id = p.id AND lower(p.first_name) = 'kevin' AND lower(p.last_name) = 'williamson';",2018-08-31 16:44:11.341183+10,5,1,443,correct
12510,"select count(*) from person as p,
writer as w
where w.id = p.id
and year_born = 1935;",2018-08-31 16:44:13.82796+10,1,0,390,partially correct
12511,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 16:44:14.80286+10,14,1,446,correct
12512,"SELECT id, first_name , last_name
FROM person 
WHERE year_born =
(
SELECT max(year_born)
FROM person));",2018-08-31 16:44:21.734702+10,7,0,160,noninterpretable
12513,"select count(*)
from(
select *
from person
where not exists(
select *
from director
where person.id = director.id
));",2018-08-31 16:44:24.739432+10,12,1,330,correct
12514,"SELECT id, first_name , last_name
FROM person 
WHERE year_born =
(
SELECT max(year_born)
FROM person);",2018-08-31 16:44:31.700683+10,7,1,160,correct
12515,"select count(*)
from writer_award wa left join person p on wa.id
where 
	wa.id = p.id
	and lower(first_name)='woody'
	and lower(last_name)='allen'
	and year_of_award <= 1995
	and year_of_award >= 1991
	and lower(result)='won'
;",2018-08-31 16:44:34.49008+10,9,1,152,correct
12516,"SELECT DISTINCT person.id, d.award_name, d.year_of_award, d.category FROM person, movie NATURAL JOIN director_award as d
WHERE d.award_name is not NULL
AND d.result is not 'won';",2018-08-31 16:44:36.306422+10,13,0,393,partially correct
12517,"Select r.country
m.title
From 
Restriction As r
Movie As m
Where 
m.titie = r.title;",2018-08-31 16:44:42.759775+10,6,0,105,noninterpretable
12518,;,2018-08-31 16:44:52.21946+10,15,0,418,noninterpretable
12519,"select w.title, w.production_year from writer w, person p where w.id = p.id and lower(first_name) = 'kevin' and lower(last_name) = 'williamson';",2018-08-31 16:45:01.427237+10,5,1,264,correct
12520,"SELECT id
FROM person;",2018-08-31 16:45:02.486269+10,15,0,446,partially correct
12521,;,2018-08-31 16:45:09.386126+10,15,0,386,noninterpretable
12522,"SELECT m.title,m.production_year,p.first_name,p.last_name
FROM (SELECT * FROM movie_award ma WHERE lower(ma.award_name)=""bafta film award""
AND lower(ma.category=""best film"") AND lower(ma.result)=""won""
)as m,person p,director d
WHERE p.id=d.id AND m.title=d.title AND m.production_year=d.production_year;",2018-08-31 16:45:44.505015+10,8,1,47,correct
12523,"select count(*)
from person
where person.id not in (select director.id from director);",2018-08-31 16:45:44.846319+10,12,1,411,correct
12524,"select d.id,da.award_name,da.year_of_award,da.category
from director d,director_award da
where d.title=da.title
and d.production_year=da.production_year
and d.id not in (select d.id from director_award da,director d 
where
da.title=d.title
and da.production_year=d.production_year
and lower(da.result)='won'); ",2018-08-31 16:45:49.878963+10,13,1,293,correct
12525,"SELECT id FROM person
WHERE id != '00000903'
ORDER BY year_born DESC
LIMIT 1;",2018-08-31 16:45:54.856575+10,3,0,320,cheating
12600,"select w.title, w.production_year
from writer w,
	person p
where lower(first_name) = 'kevin'
	and lower(last_name) = 'williamson'
	and w.id = p.id;",2018-08-31 16:57:23.064509+10,5,1,136,correct
12526,"SELECT 
	d.id,
	da.award_name,
	da.year_of_award,
	da.category
FROM 
	director d,
	director_award da
WHERE
	d.title=da.title AND
	d.production_year=da.production_year AND
	lower(da.result)='nominated' AND
	d.id NOT IN (
				SELECT
					id
				FROM 
					director r,
					director_award da
				WHERE 
					d.title=da.title AND
					d.production_year=da.production_year AND
					lower(da.result)='won');",2018-08-31 16:45:58.115379+10,13,1,430,correct
12527,"select p.id
from person p
where p.id not in (select distinct p.id
				from person p, writer w
				where p.id = w.id);",2018-08-31 16:46:01.683358+10,12,0,136,partially correct
12528,"Select 
country
From 
restriction
Where
lower(title) = 'shakespeare in love'
And description = 'M';",2018-08-31 16:46:06.582284+10,6,1,105,correct
12529,"select ma.title, ma.production_year
from movie_award ma

group by ma.title;
",2018-08-31 16:46:12.844348+10,11,0,221,partially correct
12530,"WITH newTable AS
(SELECT t.id,t.title,t.production_year, count(*) AS noOfWork FROM 
(SELECT d.id,d.title,d.production_year FROM (Movie m Natural Join Director d)
UNION
SELECT w.id, w.title, w.production_year FROM (writer w Natural Join Movie m)
) AS t
Group by t.id)
SELECT n.id FROM newTable n
WHERE n.noOfWork = (SELECT MAX(n1.noOfWork)
FROM newTable n1);",2018-08-31 16:46:13.173616+10,14,1,218,correct
12531,"select title, production_year, first_name, last_name from (movie_award natural join director) md, person p
	where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won'
	and md.id = p.id;",2018-08-31 16:46:26.060634+10,8,1,26,correct
12532,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 16:46:27.72193+10,15,1,386,correct
12533,"select count( p.id) from person as p , writer as w where p.id=w.id
AND p.year_born=1935;
",2018-08-31 16:46:29.231796+10,1,0,31,partially correct
12534,"select id
from (role natural join appearance) as ra
where id in (
		select ra1.id
		from (
			select id
			from (role natural join appearance) as ra
			where
				lower(ra.title) = ""psycho"" and
				ra.production_year = 1960) as ra1
		group by ra1.id
		having count(*) = 1
		);",2018-08-31 16:46:44.439658+10,10,0,423,partially correct
12535,"select p.id
from person p
where p.id not in (select distinct p.id
				from person p, director d
				where p.id = d.id);",2018-08-31 16:46:48.718021+10,12,0,136,partially correct
12536,select country from restriction where lower(title) = 'shakespeare in love' and description = 'm';,2018-08-31 16:46:52.877346+10,6,0,264,partially correct
12537,"select count(*) from person as p , writer as w where p.id=w.id
AND p.year_born=1935;
",2018-08-31 16:46:56.089095+10,1,0,31,partially correct
12538,"Select 
p.id
p.first_name
p.last_name
From 
person As p
Where 
min(p.year_born);",2018-08-31 16:47:06.819449+10,7,0,105,noninterpretable
12539,select country from restriction where lower(title) = 'shakespeare in love' and description = 'M';,2018-08-31 16:47:27.401716+10,6,1,264,correct
12540,"SELECT country
FROM restriction
WHERE title='Shakespeare in Love' AND description='M';
",2018-08-31 16:47:49.043292+10,6,1,422,correct
12541,"select p.id
from person p
where not exists (select *
			 from director d
			 where p.id = d.id);",2018-08-31 16:47:50.767278+10,12,0,136,partially correct
12542,"SELECT title, production_year, first_name, last_name
FROM movie natural join director natural join person natural join movie_award
WHERE lower(award_name) = 'bafta film award' and lower(category) = 'best film' ;",2018-08-31 16:48:06.18119+10,8,0,160,partially correct
12543,"Select 
id,
first_name,
last_name
From 
person As p
Where 
p.year_born =
(Select 
max(year_born)
From person);",2018-08-31 16:48:13.229324+10,7,1,105,correct
12544,"select count(*)
from person p
where not exists (select *
			 from director d
			 where p.id = d.id);",2018-08-31 16:48:28.998328+10,12,1,136,correct
12545,SELECT;,2018-08-31 16:48:29.399709+10,10,0,251,noninterpretable
12546,"select count(*) 
from writer_award wd, writer w, person p
where wd.id = w.id 
and wd.production_year=w.production_year
and w.id=p.id
and lower(result)='won'
and lower(first_name)='woody'
and lower(last_name)='allen'
and wd.year_of_award>=1991
and wd.year_of_award<=1995;",2018-08-31 16:48:36.036373+10,9,1,463,correct
12547,"SELECT count(*)
FROM person
where exists (select *from person, writer where writer.id=person.id and person.year_born=1935);",2018-08-31 16:48:47.291319+10,1,0,432,partially correct
12548,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:49:04.261861+10,11,1,258,correct
12549,"select count(*)
from person p
where exists 
(select *
from writer w
where p.id=w.id
and p.year_born = 1935);",2018-08-31 16:49:10.834651+10,1,1,237,correct
12550,;,2018-08-31 16:49:13.95714+10,8,0,105,noninterpretable
12551,"select count(*)
from person p
where p.id not in (select distinct p.id
			 from director d, person p
			 where p.id = d.id);",2018-08-31 16:49:14.298044+10,12,1,136,correct
12552,1;,2018-08-31 16:49:22.152356+10,13,0,281,noninterpretable
12553,"SELECT count(id) FROM PERSON
WHERE year_born=1935;",2018-08-31 16:49:35.406886+10,1,0,289,partially correct
12554,"SELECT count(*)
FROM person
where exists (select *from  writer where writer.id=person.id and person.year_born=1935);",2018-08-31 16:49:52.869513+10,1,1,432,correct
12555,"SELECT title, production_year, first_name, last_name
FROM movie natural join director natural join person natural join movie_award
WHERE lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won';",2018-08-31 16:49:53.332317+10,8,1,160,correct
12556,"SELECT COUNT(*)
FROM person,writer_award
WHERE person.first_name='Woody'
AND person.last_name='Allen'
AND writer_award.id=person.id
AND writer_award.year_of_award>=1991
AND writer_award.year_of_award<=1995;

",2018-08-31 16:50:09.981614+10,9,0,372,partially correct
12557,1;,2018-08-31 16:50:20.634711+10,14,0,281,noninterpretable
12558,1;,2018-08-31 16:50:52.571279+10,15,0,281,noninterpretable
12559,"SELECT COUNT(*)
FROM person,writer_award
WHERE person.first_name='Woody'
AND person.last_name='Allen'
AND writer_award.id=person.id
AND writer_award.year_of_award>=1991
AND writer_award.result='won'
AND writer_award.year_of_award<=1995;

",2018-08-31 16:51:13.803992+10,9,1,372,correct
12560,"select distinct p.id
from person p, writer w
where p.id = w.id and p.year_born = 1935;
",2018-08-31 16:51:16.939295+10,1,0,136,partially correct
12561,"select rp.id
from(role natural join appearance)as rp
where lower(rp.title)='psycho'
 and rp.production_year=1960
 group by rp.id
 having count(rp.id)=1;",2018-08-31 16:51:19.277534+10,10,1,280,correct
12562,"select distinct p.id
from person p, writer w
where p.id = w.id and p.year_born = 1935;
",2018-08-31 16:51:24.608919+10,1,0,136,partially correct
12563,"select person.id,first_name,last_name
from ;
",2018-08-31 16:51:28.034748+10,4,0,411,noninterpretable
12564,"select production_year, count(*)
from movie
where production_year in (1991,1992,1993)
group by production_year;",2018-08-31 16:51:28.909115+10,2,1,237,correct
12565,"select person.id,first_name,last_name
from ;
",2018-08-31 16:51:36.51118+10,4,0,411,noninterpretable
12567,"(SELECT p.id, p.first_name, p.last_name r.title, r.production_year, r.description, COUNT(*) AS noOfroles
FROM person p, role r
WHERE p.id=r.id
GROUP BY p.id;",2018-08-31 16:51:51.366841+10,15,0,441,noninterpretable
12568,"SELECT id,first_name,last_name
FROM person
WHERE id IN
(SELECT d.id
FROM director d,writer w
WHERE d.id=w.id AND d.title=w.title AND d.production_year=w.production_year 
GROUP BY d.id
HAVING COUNT(*)>1);

",2018-08-31 16:52:06.974804+10,4,1,382,correct
12569,"select count(*)
from person p
where id not in (select id
		from director);",2018-08-31 16:52:10.184576+10,12,1,432,correct
12570,"Select
a.title
a.production_year
p.first_name
p.last_name
From
(select title, production_year
From 
movie_award
Where lower(award_name)='bafta film award'
And lower(catagory)='best film'
And lower(result)='won')As a,
director As d
person As p
Where 
a.title = d.title
And a.production_year = d.produecion_year
And d.id = p.id;",2018-08-31 16:52:24.965236+10,8,0,105,noninterpretable
12571,"select count(*)
from
(select distinct p.id
from person p, writer w
where p.id = w.id and p.year_born = 1935);
",2018-08-31 16:52:55.413541+10,1,1,136,correct
12572,"select count(*) from writer_award where lower(result) = 'won' and title = 
	(select title from writer natural join person 
		where lower(person.first_name) = 'woody' and
		lower(person.last_name) = 'allen');",2018-08-31 16:52:57.744234+10,9,1,305,correct
12573,"select *
from award;",2018-08-31 16:53:13.964582+10,9,0,160,partially correct
12574,"SELECT title, production_year
FROM movie m
WHERE (SELECT * 
FROM writer w
WHERE w.title=m.title
SELECT *
FROM person p
WHERE (p.id=m.id AND p.first_name='Kevin' AND p.last_name='Williamson'));",2018-08-31 16:53:14.03453+10,5,0,355,noninterpretable
12575,"SELECT p.i
FROM 
(SELECT id i, count(id) c
FROM
person NATURAL JOIN role
GROUP BY id) AS p
WHERE p.c in
(SELECT MAX(t.c)
FROM
(SELECT id i, count(id) c
FROM
person NATURAL JOIN role
GROUP BY id) AS t);
",2018-08-31 16:53:19.690879+10,15,0,459,partially correct
12576,"SELECT a.id
FROM (person NATURAL JOIN role) AS a
WHERE a.title = 'Psycho' AND a.production_year = 1960
GROUP BY a.id;",2018-08-31 16:53:45.75434+10,10,0,59,partially correct
12577,"SELECT title,production_year
FROM movie NATURAL JOIN writer NATURAL JOIN person
WHERE lower(first_name)=""kevin"" AND lower(last_name)=""williamson"";",2018-08-31 16:54:04.045655+10,5,1,382,correct
12578,"select count(*) from writer_award where lower(result) = 'won' and 
	year_of_award > 1990 and year_of_award < 1996 and 
	title = 
	(select title from writer natural join person 
		where lower(person.first_name) = 'woody' and
		lower(person.last_name) = 'allen');",2018-08-31 16:54:04.631357+10,9,1,305,correct
12579,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;
",2018-08-31 16:54:05.194692+10,4,1,411,correct
12580,"Select
a.title,
a.production_year,
p.first_name,
p.last_name
From
(select title, production_year
From 
movie_award
Where lower(award_name)='bafta film award'
And lower(category)='best film'
And lower(result)='won')As a,
director As d,
person As p
Where 
a.title = d.title
And a.production_year = d.production_year
And d.id = p.id;",2018-08-31 16:54:10.376243+10,8,1,105,correct
12581,"select md.title,md.production_year,p.first_name,p.last_name
from (select * from movie_award ma, director d where ma.title=d.title and ma.production_year=d.production_year) as md,person p
where md.award_name = 'BAFTA Film Award' and md.category='best film' and md.result='won';",2018-08-31 16:54:18.478738+10,8,0,200,partially correct
12582,"SELECT r.id
FROM role r,
	(SELECT a.title,a.production_year,a.description
	FROM appearance a, scene s
	WHERE lower(a.title) = 'psycho'
		AND lower(a.title) = lower(s.title)
		AND a.production_year = s.production_year
		AND a.scene_no = s.scene_no) ra
WHERE lower(r.title) = lower(ra.title)
	AND r.production_year = ra.production_year
	AND lower(r.description) = lower(ra.description)
GROUP BY r.id
	HAVING COUNT(*) = 1;",2018-08-31 16:54:26.809458+10,10,0,285,partially correct
12583,"select id,first_name,last_name
from director,person,(select director.id from director, writer where director.id = writer.id and writer.title = director.title and writer.production_year=writer.production_year) as t
where director.id = person.id and director.id = t.id;",2018-08-31 16:54:30.978077+10,4,0,89,noninterpretable
12584,"SELECT pdw.id, pdw.first_name, pdw.last_name
FROM (person NATURAL JOIN director NATURAL JOIN writer) AS pdw
GROUP BY pdw.id
HAVING COUNT(*) > 1;
",2018-08-31 16:54:45.527662+10,4,1,169,correct
12585,"select count(*)
from writer_award natural join writer natural join person
WHERE lower(RESULT)= 'won' and  lower(first_name)= 'woody' and  lower(last_name)= 'allen' and year_of_award >= 1991 and year_of_award <= 1995;",2018-08-31 16:54:58.286995+10,9,1,160,correct
12586,"with temp as (SELECT *, count(*) as num
FROM role
GROUP BY id,title,production_year),

maxid as(SELECT id
FROM temp
WHERE num= (SELECT max(num) from temp))

SELECT first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
WHERE id IN maxid;",2018-08-31 16:55:04.93226+10,15,0,128,partially correct
12587,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 16:55:21.45391+10,11,1,221,correct
12588,"SELECT country
FROM restriction
WHERE title=""Shakespeare in Love"" AND description=""M"";",2018-08-31 16:55:23.271943+10,6,1,382,correct
12589,"select p.id from person as p
;",2018-08-31 16:55:48.622441+10,3,0,447,partially correct
12590,"SELECT *
FROM AWARD;",2018-08-31 16:55:50.17302+10,10,0,160,partially correct
12591,"select md.title,md.production_year,p.first_name,p.last_name
from (select * from movie_award ma, director d where ma.title=d.title and ma.production_year=d.production_year) as md,person p
where md.award_name = 'BAFTA Film Award' and md.category='best film' and md.result='won' and md.id=p.id;",2018-08-31 16:56:24.163387+10,8,1,200,correct
12592,"SELECT w.title, w.production_year
FROM writer w, person p
WHERE w.id=p.id AND P.first_name='Kevin' AND p.last_name='Williamson';",2018-08-31 16:56:33.846936+10,5,1,355,correct
12593,"select m.
where;",2018-08-31 16:56:37.020992+10,5,0,411,noninterpretable
12594,"Select count(*)
from writer_award
where year_of_award in (1991,1992,1993,1994,1995) and result = 'won' and 
writer_award.id in
	(select writer.id
	from writer
	where writer.id in 
	(select person.id
	from person
	where person.first_name = 'Woody' and person.last_name = 'Allen'));",2018-08-31 16:56:44.380194+10,9,1,45,correct
12595,"with temp as (SELECT *, count(*) as num
FROM role
GROUP BY id),

maxid as(SELECT id
FROM temp
WHERE num= (SELECT max(num) from temp))

SELECT first_name, last_name, title, production_year, description
FROM person NATURAL JOIN role
WHERE id IN maxid;",2018-08-31 16:56:46.181122+10,15,1,128,correct
12596,"SELECT r.id
FROM role r,
	(SELECT a.title,a.production_year,a.description
	FROM appearance a, scene s
	WHERE lower(a.title) = 'psycho'
		AND lower(a.title) = lower(s.title)
		AND a.production_year = s.production_year
		AND a.production_year = 1960
		AND a.scene_no = s.scene_no) ra
WHERE lower(r.title) = 'psycho'
	AND lower(r.title) = lower(ra.title)
	AND r.production_year = ra.production_year
	AND lower(r.description) = lower(ra.description)
GROUP BY r.id
	HAVING COUNT(*) = 1;",2018-08-31 16:56:49.045407+10,10,1,285,correct
12597,"SELECT production_year, count(*)
FROM movie
WHERE production_year>1990 and production_year<1994
GROUP BY production_year;",2018-08-31 16:57:01.124273+10,2,1,441,correct
12598,"select id, award_name, year_of_award, ategory
from director natural join director_award
where exists lower(result) = 'nominated' and not exists lower(result) = 'won';",2018-08-31 16:57:11.73603+10,13,0,163,noninterpretable
12599,"SELECT id
FROM scene natural join appearance natural join ROLE
GROUP by id
having count(*) = 1;",2018-08-31 16:57:18.89439+10,10,0,160,partially correct
12603,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 16:58:15.498952+10,13,1,266,correct
12604,"SELECT p.first_name, p.last_name, r.title, r.production_year, r.description 
FROM PERSON p, ROLE r, (SELECT id, count(*) AS number FROM ROLE GROUP BY id) AS b
WHERE r.id = p.id AND p.id = b.id AND b.number in (SELECT MAX(number) FROM (SELECT id, COUNT(*) AS number FROM ROLE GROUP BY id) As a);",2018-08-31 16:58:21.010558+10,15,1,451,correct
12605,"SELECT dw.id, dw.first_name, dw.last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) AS dw 
GROUP BY dw.id 
HAVING count(*) > 1;",2018-08-31 16:58:38.474517+10,4,1,142,correct
12606,"SELECT first_name, last_name, title, production_year, description
FROM
person NATURAL JOIN role
WHERE id in 
(SELECT p.i
FROM 
(SELECT id i, count(id) c
FROM
person NATURAL JOIN role
GROUP BY id) AS p
WHERE p.c in
(SELECT MAX(t.c)
FROM
(SELECT id i, count(id) c
FROM
person NATURAL JOIN role
GROUP BY id) AS t));
",2018-08-31 16:58:44.635966+10,15,1,459,correct
12607,"SELECT w.title, w.production_year
FROM writer w
WHERE EXISTS (SELECT * FROM person p
              WHERE p.id = w.id
              AND lower(p.first_name) = 'kevin'
              AND lower(p.last_name) = 'williamson');

",2018-08-31 16:58:45.620426+10,5,1,169,correct
12608,"select p.id from person as p
where p.year_born = (select max(person.year_born) from person
where year_born < (select max(person.year_born) from person));",2018-08-31 16:58:58.972826+10,3,1,447,correct
12609,"SELECT id
FROM scene natural join appearance natural join ROLE
where lower(title) = 'psycho'
    AND production_year = 1960
GROUP by id
having count(*) = 1 ;",2018-08-31 16:59:00.282343+10,10,0,160,partially correct
12610,;,2018-08-31 16:59:16.672765+10,14,0,266,noninterpretable
12611,"select id, first_name, last_name
from(
select *, count(*) c
from director natural join person
where exists(
select *
from writer natural join person
where director.id = writer.id and director.title = writer.title and director.production_year = writer.production_year)
group by id
having c > 1);",2018-08-31 16:59:29.685738+10,4,1,330,correct
12612,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id )  );
",2018-08-31 16:59:42.494608+10,15,1,264,correct
12613,"select title,production_year
from writer, person
where writer.id=person.id and person.first_name=Kevin and person.last_name=Williamson;",2018-08-31 16:59:46.183702+10,5,0,89,noninterpretable
12614,"select x.id
from(select xx.id,count(*)as amount from(
select id,title,production_year from director
union
select id,title,production_year from writer)as xx group by xx.id)as x
where x.amount=(select max(x.amount)from (select xx.id,count(*)as amount from(
select id,title,production_year from director
union
select id,title,production_year from writer)as xx group by xx.id)as x
);",2018-08-31 16:59:49.823638+10,14,1,293,correct
12615,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE
	da.title=d.title AND
	da.production_year=d.production_year AND
	lower(da.result)='nominated' AND
	d.id NOT IN (
	SELECT id FROM
	director_award da,
	director d
	WHERE
	da.title=d.title AND
	da.production_year=d.production_year AND
	lower(da.result)='won'
	
	);",2018-08-31 16:59:52.206347+10,13,1,297,correct
12616,"SELECT r.id
FROM scene s, role r, appearance a 
WHERE s.title = r.title
AND s.production_year = r.production_year
AND s.title = a.title
AND s.production_year = a.production_year
AND lower(a.title) = 'psycho'
AND a.description = r.description
AND s.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-31 17:00:05.845309+10,10,0,251,partially correct
12617,"SELECT d.id,da.award_name,da.year_of_award,da.category
FROM director_award da,director d
WHERE
	da.title=d.title AND
	da.production_year=d.production_year AND
	lower(da.result)='nominated' ;",2018-08-31 17:00:27.109701+10,13,1,297,correct
12618,"SELECT country
FROM restriction r
WHERE lower(r.title) = 'shakespeare in love'
AND lower(r.description) = 'm';

",2018-08-31 17:00:54.821832+10,6,1,169,correct
12619,"select title, production_year
from writer natural join person
where first_name = ""Kevin"" and last_name = ""Williamson"";",2018-08-31 17:01:10.949634+10,5,1,330,correct
12620,"SELECT production_year FROM MOVIE
WHERE production_year BETWEEN 1991 AND 1993;",2018-08-31 17:01:30.026213+10,2,0,289,partially correct
12621,;,2018-08-31 17:02:21.5362+10,15,0,266,noninterpretable
12622,"select country
from restriction
where title = ""Shakespeare in Love"" and description = ""M"";",2018-08-31 17:02:24.129582+10,6,1,330,correct
12623,"select id
from (Appearance NATURAL JOIN role NATURAL JOIN person) as s 
where lower(s.title) like ""psycho"" and s.production_year=1960 and s.scene_no=1;
",2018-08-31 17:02:52.248629+10,10,0,318,partially correct
12624,"SELECT id, first_name, last_name
FROM person
WHERE year_born = (SELECT MAX(year_born) FROM person);",2018-08-31 17:02:58.172407+10,7,1,169,correct
12625,"SELECT a.title,a.production_year,a.first_name,a.last_name
FROM (movie_award NATURAL JOIN director NATURAL JOIN person) a
WHERE a.award_name=""BAFTA Film Award"" AND a.result=""won"" AND lower(a.category)=""best film"";

",2018-08-31 17:03:10.248395+10,8,1,382,correct
12626,"select id, first_name, last_name
from(
select *, max(year_born)
from person);",2018-08-31 17:03:29.682799+10,7,1,330,correct
12627,"SELECT production_year, count(production_year) FROM MOVIE
WHERE production_year BETWEEN 1991 AND 1993
GROUP BY production_year;",2018-08-31 17:03:36.979618+10,2,1,289,correct
12628,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 17:03:47.579178+10,10,1,59,correct
12629,"SELECT COUNT()
FROM movie_award, crew_award, director_award, writer_award, actor_award
WHERE ;",2018-08-31 17:04:08.06385+10,11,0,251,noninterpretable
12630,"select id
from person
order by year_born DESC
LIMIT 1 OFFSET 1;",2018-08-31 17:04:33.816001+10,3,1,221,correct
12631,"with brole as(
select id from role 
group by id having count(id) = 
(select max(total) from (
select count(id) as total 
from role
group by id)))
select first_name, last_name, title, production_year, description
from person, role
where person.id = role.id
and person.id in(select id from brole);",2018-08-31 17:04:49.682525+10,15,1,129,correct
12632,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 17:05:02.569675+10,10,1,372,correct
12633,"select id, award_name, year_of_award, ategory
from (select * from director d
where d.id = da.id
union 
select * from director_award da
where d.id = a.id);
",2018-08-31 17:05:08.577199+10,13,0,163,noninterpretable
12634,"select id, award_name, year_of_award, ategory
from (select * from director d
where d.id = da.id
union 
select * from director_award da
where d.id = a.id);
",2018-08-31 17:05:08.900429+10,13,0,163,noninterpretable
12635,"SELECT COUNT(*)
FROM (person NATURAL JOIN writer_award) a
WHERE a.first_name=""Woody""
	AND a.last_name=""Allen""
	AND year_of_award>=1991
	AND year_of_award<=1995
	AND result=""won"";",2018-08-31 17:05:45.494155+10,9,1,382,correct
12636,";
",2018-08-31 17:06:06.075369+10,3,0,442,noninterpretable
12637,"SELECT country
FROM restriction r
WHERE lower(title)='Shakespeare in Love' AND lower(description)='m';",2018-08-31 17:06:09.530223+10,6,0,355,partially correct
12638,"SELECT country
FROM restriction r
WHERE lower(title)='shakespeare in love' AND lower(description)='m';",2018-08-31 17:07:13.837621+10,6,1,355,correct
12639,"select country
from restriction
where title = 'Shakespeare in Love' and description = 'M';",2018-08-31 17:08:40.628734+10,6,1,89,correct
12640,"SELECT count(*)
FROM person p
WHERE exists (SELECT * 
			FROM writer w
			WHERE w.id=p.id
			AND p.year_born=1935);",2018-08-31 17:08:41.035634+10,1,1,217,correct
12641,"SELECT p.id,p.first_name,p.last_name
	FROM person p where exists
	(select * from director d,writer w where d.id=w.id and d.title=w.title and d.production_year=w.production_year group by d.id having count(d.id)>1);",2018-08-31 17:08:57.12146+10,4,0,200,partially correct
12642,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS(
	SELECT ma.title,ma.production_year
	FROM movie_award ma
	WHERE lower(m.title) = lower(ma.title)
		AND m.production_year = ma.production_year
		AND lower(ma.result) = 'won'
	UNION
	SELECT ca.title,ca.production_year
	FROM crew_award ca
	WHERE lower(m.title) = lower(ca.title)
		AND m.production_year = ca.production_year
		AND lower(ca.result) = 'won'
	UNION
	SELECT da.title,da.production_year
	FROM director_award da
	WHERE lower(m.title) = lower(da.title)
		AND m.production_year = da.production_year
		AND lower(da.result) = 'won'
	UNION
	SELECT wa.title,wa.production_year
	FROM writer_award wa
	WHERE lower(m.title) = lower(wa.title)
		AND m.production_year = wa.production_year
		AND lower(wa.result) = 'won'
	UNION
	SELECT aa.title,aa.production_year
	FROM actor_award aa
	WHERE lower(m.title) = lower(aa.title)
		AND m.production_year = aa.production_year
		AND lower(aa.result) = 'won'
);",2018-08-31 17:08:57.486624+10,11,1,285,correct
12643,"select title, production_year, first_name, last_name
from director natural join movie_award natural join person
where award_name = ""BAFTA Film Award"" and lower(result) = ""won"";",2018-08-31 17:09:01.98595+10,8,0,330,partially correct
12644,"SELECT dw.title, dw.production_year, p.first_name, p.last_name
FROM (SELECT * FROM director d, movie_award m
      WHERE d.title = m.title
      AND d.production_year = m.production_year) dw, person p
WHERE dw.id = p.id
AND lower(dw.award_name) = 'bafta film award'
AND lower(dw.category) = 'best film'
AND lower(dw.result) = 'won';",2018-08-31 17:09:10.169292+10,8,1,169,correct
12645,"select country from Restriction
where description='M'and title='Shakespeare in Love';",2018-08-31 17:09:16.621288+10,6,1,192,correct
12646,"SELECT MA.title, MA.production_year, P.first_name, P.last_name 

FROM

MOVIE_AWARD MA,
DIRECTOR D,
PERSON P

WHERE
MA.title = D.title AND
P.id = D.id AND
award_name = ""BAFTA Film Award"" AND 
category = ""best film"" AND 
result = ""won"";",2018-08-31 17:09:29.921618+10,8,1,384,correct
12647,"select description
from pearance natural join scene
where ;",2018-08-31 17:09:48.822872+10,10,0,455,noninterpretable
12648,;,2018-08-31 17:10:10.621638+10,13,0,442,noninterpretable
12649,"select title, production_year, first_name, last_name
from director natural join movie_award natural join person
where award_name = ""BAFTA Film Award"" and lower(result) = ""won"" and category = ""best film"";",2018-08-31 17:10:14.906114+10,8,1,330,correct
12650,"SELECT W.title, M.production_year FROM MOVIE M JOIN WRITER W ON M.title = W.title WHERE W.id = (
SELECT P.id FROM WRITER W JOIN PERSON P ON W.id = P.id WHERE lower(P.first_name) = ""kevin"" AND P.last_name = ""Williamson"");",2018-08-31 17:10:44.816848+10,5,1,384,correct
12651,select id from person natural join role natural join appearance where lower(title)='psycho' and production_year=1960 group by id having count(*) = 1;,2018-08-31 17:11:05.299906+10,10,1,26,correct
12652,"SELECT id, first_name, last_name
FROM person p
WHERE p.year_born=(
  SELECT max(year_born)
  FROM person
  );",2018-08-31 17:11:06.005617+10,7,1,355,correct
12653,"select *
from writer_award natural join person;",2018-08-31 17:11:21.558367+10,9,0,330,partially correct
12654,"select id 
from person
where first_name in (select description 
from appearance 
where lower(title) = 'psycho' and production_year = 1960 and scene_no = 1);",2018-08-31 17:11:30.62732+10,10,0,305,partially correct
12655,"SELECT count(*)
FROM movie m
WHERE not exists (select * from movie_award a where a.title = m.title) 
      AND not exists (select * from  crew_award b where b.title = m.title)
      AND not exists (select * from director_award c where c.title = m.title)
      AND not exists (select * from writer_award d where d.title = m.title)
      AND not exists (select * from  actor_award e where e.title = m.title)
;",2018-08-31 17:11:38.199208+10,11,0,59,partially correct
12656,"select x.id 
from (select x1.id, count(*) as noofworkedon
      from ( select d.id, title, production_year 
             from director d 
                     union 
                  select w.id, title, production_year
                  from writer w) x1 group by x1.id) x
where x.noofworkedon = (select max(x2.noofworkedon) 
                        from  (select x1.id, count(*) as noofworkedon 
                               from (select d.id, title, production_year 
                                     from director d         
                                              union
                                                  select w.id, title, production_year
                                                  from writer w) x1 group by x1.id)x2);",2018-08-31 17:11:41.36344+10,14,1,264,correct
12657,"SELECT COUNT()
FROM movie m
WHERE NOT EXISTS (
SELECT title, production_year
FROM movie_award ma
WHERE m.title = ma.title AND m.production_year = ma.production_year AND ma.result = 'Won'
UNION
SELECT title, production_year
FROM crew_award ca
WHERE m.title = ca.title AND m.production_year = ca.production_year AND ca.result = 'Won'
UNION
SELECT title, production_year
FROM director_award da
WHERE m.title = da.title AND m.production_year = da.production_year AND da.result = 'Won'
UNION
SELECT title, production_year
FROM writer_award wa
WHERE m.title = wa.title AND m.production_year = wa.production_year AND wa.result = 'Won'
UNION
SELECT title, production_year
FROM actor_award aa
WHERE m.title = aa.title AND m.production_year = aa.production_year AND aa.result = 'Won');",2018-08-31 17:11:51.947106+10,11,0,251,partially correct
12658,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 17:12:40.810469+10,10,1,246,correct
12659,"select count(*)
from writer_award natural join person
where year_of_award > 1990 and year_of_award < 1996 and first_name = ""Woody"" and last_name = ""Allen"";",2018-08-31 17:12:56.179084+10,9,0,330,partially correct
12660,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 17:13:07.329686+10,11,1,372,correct
12662,;,2018-08-31 17:13:36.401989+10,14,0,442,noninterpretable
12663,"SELECT COUNT(*)
FROM writer_award wa natural join writer w natural join person p
WHERE p.id = w.id
AND w.id = wa.id
AND lower(p.first_name) = 'woody'
AND lower(p.last_name)= 'allen'
AND wa.year_of_award >= 1991
AND wa.year_of_award <= 1995;",2018-08-31 17:13:44.547351+10,9,0,169,partially correct
12664,"select p.id, p.first_name, p.last_name from person p,(
select max(year_born) as m from person) as pp
where year_born=pp.m;",2018-08-31 17:13:45.200907+10,7,1,192,correct
12665,"SELECT id
FROM person
WHERE year_born = (
  SELECT MAX(year_born)
  FROM person
	WHERE year_born < (
	SELECT MAX(p.year_born)
	FROM person p));",2018-08-31 17:13:48.437933+10,3,1,285,correct
12666,"select *
from writer_award natural join person
where year_of_award > 1990 and year_of_award < 1996 and first_name = ""Woody"" and last_name = ""Allen"" and lower(result) = ""won"";",2018-08-31 17:13:56.214634+10,9,0,330,partially correct
12667,"select id, first_name, last_name
from person,(select max(year_born)as max_year from person ) as t
where year_born=t.max_year;",2018-08-31 17:14:13.577753+10,7,1,89,correct
12668,"select count(*)
from writer_award natural join person
where year_of_award > 1990 and year_of_award < 1996 and first_name = ""Woody"" and last_name = ""Allen"" and lower(result) = ""won"";",2018-08-31 17:14:19.573317+10,9,1,330,correct
12669,"SELECT count(*) FROM person
WHERE NOT person.id = director.id;",2018-08-31 17:14:44.41406+10,12,0,289,noninterpretable
12670,"select d.id, da.award_name, da.year_of_award, da.category 
from director_award da, director d 
where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'nominated' and d.id not in
                    (select id 
                     from director_award da, director d 
                     where da.title = d.title and da.production_year = d.production_year and lower(da.result) = 'won');",2018-08-31 17:16:23.022445+10,13,1,264,correct
12671,select * from director;,2018-08-31 17:16:44.893723+10,14,0,297,partially correct
12672,"SELECT count(*) FROM person p
WHERE NOT EXISTS (
SELECT * FROM director d
WHERE d.id=p.id);",2018-08-31 17:16:46.850757+10,12,1,289,correct
12673,"select d.id,da.award_name,da.year_of_award,da.category 
from director_award as da,director as d
where d.title = da.title 
and d.production_year = da.production_year
and not exists (da.result = 'won');",2018-08-31 17:16:54.184588+10,13,0,447,noninterpretable
12674,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
SELECT title, production_year
FROM movie_award ma
WHERE m.title = ma.title AND m.production_year = ma.production_year AND lower(ma.result) = 'won'
UNION
SELECT title, production_year
FROM crew_award ca
WHERE m.title = ca.title AND m.production_year = ca.production_year AND lower(ca.result) = 'won'
UNION
SELECT title, production_year
FROM director_award da
WHERE m.title = da.title AND m.production_year = da.production_year AND lower(da.result) = 'won'
UNION
SELECT title, production_year
FROM writer_award wa
WHERE m.title = wa.title AND m.production_year = wa.production_year AND lower(wa.result) = 'won'
UNION
SELECT title, production_year
FROM actor_award aa
WHERE m.title = aa.title AND m.production_year = aa.production_year AND lower(aa.result) = 'won');",2018-08-31 17:16:55.731421+10,11,1,251,correct
12675,"SELECT id 
FROM person p 
WHERE p.year_born=(SELECT MAX(year_born)
FROM person 
WHERE person.year_born<(SELECT MAX(year_born) FROM person));
",2018-08-31 17:17:02.265743+10,3,1,372,correct
12676,"select * 
from director_award da
where result='nominated';",2018-08-31 17:17:03.34647+10,13,0,221,partially correct
12677,"SELECT count(*)
FROM person p
WHERE NOT EXISTS(SELECT *
FROM director d
WHERE p.id=d.id);",2018-08-31 17:17:04.169576+10,12,1,217,correct
12678,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p
      WHERE p.id = w.id
      AND lower(p.first_name) = 'woody'
      AND lower(p.last_name) = 'allen')pw, writer_award wa
WHERE wa.year_of_award >= 1991
AND wa.year_of_award <= 1995;",2018-08-31 17:17:31.441718+10,9,0,169,partially correct
12679,select p.id from person p where year_born = (select max(year_born) from person p where year_born < (select max(year_born) from person));,2018-08-31 17:18:15.920523+10,3,1,264,correct
12680,"select title,production_year from Movie_Award
where award_name='BAFTA Film Award' and category='best film'
 union director;",2018-08-31 17:18:49.660418+10,8,0,192,noninterpretable
12681,"SELECT
    ma.title,
    ma.production_year,
    p.first_name,
    p.last_name
FROM (
        SELECT
            title,
            production_year
        FROM
            movie_award
        WHERE
            lower(award_name)= 'bafta film award'
            AND lower(category)= 'best film'
            AND lower(RESULT)= 'won' ) AS ma,
    director AS d,
    person AS p
WHERE
    ma.title = d.title
    AND ma.production_year = d.production_year
    AND d.id = p.id;",2018-08-31 17:19:35.580783+10,8,1,192,correct
12682,"SELECT m.title, m.production_year, x.first_name, x.last_name
FROM movie_award m, (SELECT p.id, first_name, last_name
				FROM person p, director d
				WHERE p.id = d.id) AS x
WHERE lower(award_name) = 'bafta film award' AND lower(category) = 'best film';",2018-08-31 17:19:40.682696+10,8,0,251,partially correct
12683,"select d.id,da.award_name,da.year_of_award,da.category 
from director_award as da,director as d
where d.title = da.title 
and d.production_year = da.production_year
and lower(da.result) = 'nominated'
and d.id not in(
select d.id from director_award as da,director as d
where d.title = da.title 
and d.production_year = da.production_year
and lower(da.result) = 'won');",2018-08-31 17:20:01.697546+10,13,1,447,correct
12684,1;,2018-08-31 17:20:11.307051+10,9,0,192,noninterpretable
12685,"select r.id
from appearance a, scene s, role r
where
	a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and lower(s.title) = 'psycho'
group by r.id
having count(*) = 1;",2018-08-31 17:20:14.069635+10,10,0,455,partially correct
12686,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 17:20:18.845956+10,13,1,372,correct
12687,select * from person;,2018-08-31 17:20:20.812065+10,9,0,192,partially correct
12688,"select id from  (select id,count(*) as c from (select * from director union select id,title,production_year from writer) as u group by id) as u3 where u3.c in (select max(u2.c) from (select id,count(*) as c from (select * from director union select id,title,production_year from writer) as u group by id) as u2);",2018-08-31 17:20:28.941621+10,14,1,365,correct
12689,select id from person;,2018-08-31 17:20:32.423628+10,9,0,192,partially correct
12690,"select r.id
from appearance a, scene s, role r
where
	a.title = s.title
	and a.production_year = s.production_year
	and a.scene_no = s.scene_no
	and a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and lower(s.title) = 'psycho'
	and a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-31 17:20:43.647233+10,10,1,455,correct
12691,"SELECT
    COUNT(*) AS number_of_award
FROM
    writer_award wa,
    writer w,
    person p
WHERE
    wa.title = w.title
    AND wa.production_year = w.production_year
    AND wa.id = w.id
    AND w.id = p.id
    AND lower(RESULT)= 'won'
    AND lower(first_name)= 'woody'
    AND lower(last_name)= 'allen'
    AND year_of_award >= 1991
    AND year_of_award <= 1995;",2018-08-31 17:20:50.434466+10,9,1,192,correct
12692,"select movie_award.title,movie_award.production_year,first_name,last_name
from movie_award,director,person
where award_name = ""BAFTA Film Award"" and category = 'Best Film' and director.title = movie_award.title and director.production_year = movie_award.production_year and person.id = director.id;",2018-08-31 17:20:53.604672+10,8,0,89,partially correct
12717,"SELECT id, first_name, last_name FROM person p
WHERE EXISTS (SELECT * FROM writer w 
              WHERE w.id=p.id);",2018-08-31 17:27:45.507778+10,4,0,289,partially correct
12693,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 17:21:01.235449+10,14,1,372,correct
12694,"with ap as (
select * from appearance
where lower(title) = 'psycho'
and production_year = 1960)
select id from role, ap
where role.title = ap.title
and role.production_year = ap.production_year
and role.description = ap.description
group by id having count(id) = 1;",2018-08-31 17:21:02.835443+10,10,1,129,correct
12695,"select count(*) 
from writer,person
where writer.id=person.id and person.year_born =1935;",2018-08-31 17:21:11.925687+10,1,0,192,partially correct
12696,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 17:21:12.185494+10,11,1,59,correct
12697,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 17:21:30.711239+10,15,0,372,partially correct
12698,"SELECT id 
from role natural join appearance
group by id, title, production_year
having
lower(title) = 'psycho'
and production_year = 1960
and count(id) = 1;",2018-08-31 17:21:31.958084+10,10,1,201,correct
12699,"select p0.id
from person p0
where year_born= (select max(yb2)
from (select p1.id, p1.year_born as yb2
from person p1
where p1.year_born = (select max(yb)
from (select year_born as yb from person p2) as year))as year2);",2018-08-31 17:21:33.239143+10,3,0,354,partially correct
12700,"SELECT COUNT(*)
FROM (SELECT DISTINCT p.id FROM writer w, person p
      WHERE p.id = w.id
      AND lower(p.first_name) = 'woody'
      AND lower(p.last_name) = 'allen')pw, writer_award wa
WHERE pw.id = wa.id 
AND wa.year_of_award >= 1991
AND wa.year_of_award <= 1995
AND lower(wa.result) = 'won';",2018-08-31 17:21:41.816326+10,9,1,169,correct
12701,"SELECT id, first_name, last_name 
FROM (person p NATURAL JOIN director NATURAL JOIN writer) dw 
GROUP BY id 
HAVING count(*) > 1;",2018-08-31 17:22:06.318331+10,4,1,217,correct
12702,"select p0.id
from person p0
where year_born= (select max(yb2)
from (select p1.year_born as yb2
from person p1
where p1.year_born != (select max(yb)
from (select year_born as yb from person p2) as year))as year2);",2018-08-31 17:23:00.915071+10,3,1,354,correct
12703,"select id
from role natural join 
(
select count(*) c , description
from(
select *
from appearance
where title = ""Psycho"" and production_year = ""1960"")
group by description
having c = 1)
where title = ""Psycho"" and production_year = ""1960""
 ;",2018-08-31 17:23:24.880227+10,10,1,330,correct
12704,"SELECT id, COUNT(*) FROM 
(
SELECT id, title, production_year FROM DIRECTOR
UNION
SELECT id, title, production_year FROM WRITER
)
GROUP BY id ORDER BY COUNT(*) DESC LIMIT 1;",2018-08-31 17:23:28.627457+10,14,0,384,partially correct
12705,"SELECT id, first_name, last_name 
FROM (person p NATURAL JOIN director d NATURAL JOIN writer w) dw 
GROUP BY id 
HAVING count(*) > 1;",2018-08-31 17:23:46.160702+10,4,1,217,correct
12706,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 17:24:19.563138+10,15,1,372,correct
12707,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM (
  SELECT title, production_year
    FROM movie_award
    WHERE lower(award_name)='bafta film award'
      AND lower(category)='best film'
      AND lower(result)='won')
      AS ma,
  director AS d,
  person AS p
WHERE ma.title=d.title
AND  ma.production_year=d.production_year
AND  d.id=p.id;",2018-08-31 17:24:54.12485+10,8,1,355,correct
12708,"select count(ww.id) from(
select distinct p.id
from writer w,person p
where w.id=p.id and p.year_born =1935) as ww;",2018-08-31 17:25:07.76663+10,1,1,192,correct
12709,"select count(*) from movie m where not exists ( 
select title, production_year from movie_award ma 
                           where lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
union
select title, production_year from crew_award ca 
                           where lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year 
union
select title, production_year from director_award da 
                           where lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
union
select title, production_year from writer_award wa 
                           where lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
union
select title, production_year from actor_award aa 
                           where lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year);






       ",2018-08-31 17:25:36.666193+10,11,1,264,correct
12710,"SELECT a.id
FROM (appearance NATURAL JOIN role) a,scene s
WHERE a.title=s.title
	AND a.production_year=s.production_year
	AND a.scene_no=s.scene_no
	AND a.title=""Psycho""
	AND a.production_year=1960
GROUP BY a.id
HAVING COUNT(*)=1
;


",2018-08-31 17:25:37.666002+10,10,1,382,correct
12711,SELECT * from person;,2018-08-31 17:25:40.823521+10,15,0,297,partially correct
12712,"SELECT
    d.id,
    da.award_name,
    da.year_of_award,
    da.category
FROM
    director_award da,
    director d
WHERE
    da.title = d.title
    AND da.production_year = d.production_year
    AND lower(da.result)= 'nominated'
    AND d.id NOT IN (
        SELECT
            id
        FROM
            director_award da,
            director d
        WHERE
            da.title = d.title
            AND da.production_year = d.production_year
            AND lower(da.result)= 'won' );",2018-08-31 17:25:56.751488+10,13,1,221,correct
12713,"SELECT wp.id,wp.first_name,wp.last_name
	FROM (person natural join writer) as wp,movie as m 
	where wp.title = m.title and wp.production_year = m.production_year group by id having count(*)>1; ",2018-08-31 17:26:26.326414+10,4,0,200,partially correct
12714,"
select count(*) from person, writer_award
where person.id = writer_award.id
and lower(first_name) = 'woody'
and lower(last_name) = 'allen'
and year_of_award >=1991
and year_of_award <=1995
and lower(result) = 'won';
",2018-08-31 17:26:42.353599+10,9,1,129,correct
12715,;,2018-08-31 17:26:43.582165+10,9,0,89,noninterpretable
12716,;,2018-08-31 17:27:16.623628+10,10,0,89,noninterpretable
12718,;,2018-08-31 17:27:51.638633+10,11,0,89,noninterpretable
12719,"select id from role natural join appearance 
where title = 'Psycho' and production_year = 1960
group by description having count(*) = 1;",2018-08-31 17:27:55.700315+10,10,1,305,correct
12720,;,2018-08-31 17:28:02.391555+10,3,0,89,noninterpretable
12721,;,2018-08-31 17:28:08.061597+10,13,0,89,noninterpretable
12722,;,2018-08-31 17:28:43.831994+10,3,0,89,noninterpretable
12723,"select r.id
from appearance a, role r
where
	 a.title = r.title
	and a.production_year = r.production_year
	and a.description = r.description
	and lower(a.title) = 'psycho'
	and a.production_year = 1960
group by r.id
having count(*) = 1;",2018-08-31 17:28:50.2298+10,10,1,455,correct
12724,"SELECT w.title, w.production_year
FROM writer w, 
     person p
WHERE w.id=p.id
      AND lower(p.first_name)= 'kevin'
    AND lower(p.last_name)= 'williamson';",2018-08-31 17:28:56.599869+10,5,1,217,correct
12725,"select p.id
from person p
where p.year_born > (select min(year_born) from person p) ;",2018-08-31 17:29:01.791285+10,3,0,59,partially correct
12726,;,2018-08-31 17:29:31.846096+10,14,0,89,noninterpretable
12727,"SELECT id FROM 
(
SELECT id, title, production_year FROM DIRECTOR
UNION
SELECT id, title, production_year FROM WRITER
)
GROUP BY id
HAVING COUNT(*) = (
SELECT COUNT(*) FROM 
(
SELECT id, title, production_year FROM DIRECTOR
UNION
SELECT id, title, production_year FROM WRITER
)
GROUP BY id ORDER BY COUNT(*) DESC LIMIT 1);",2018-08-31 17:29:36.345879+10,14,1,384,correct
12728,"select r.id from scene s, appearance a,role r 
where s.title = a.title and s.production_year = a.production_year and s.scene_no = a.scene_no and
s.title = r.title and s.production_year = r.production_year and a.description = r.description
and lower(a.title) = 'psycho' and a.production_year = 1960 group by r.id having count(*) = 1;",2018-08-31 17:29:36.700097+10,10,1,264,correct
12729,;,2018-08-31 17:29:38.187717+10,15,0,89,noninterpretable
12730,"SELECT COUNT(*) 
FROM PERSON
WHERE EXISTS (SELECT * FROM WRITER WHERE WRITER.id = PERSON.id
AND year_born = 1935);",2018-08-31 17:30:01.86668+10,1,1,356,correct
12731,"SELECT d.id, da.award_name, da.year_of_award, da.category
from director d
inner join director_award da on d.title=da.title
where da.result='nominated';",2018-08-31 17:30:49.538337+10,13,1,221,correct
12732,"SELECT count(*) 
FROM movie m 
WHERE m.title not in (
	SELECT title
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 17:31:12.143718+10,11,1,201,correct
12733,"select p.id from person as p
;",2018-08-31 17:31:29.829875+10,14,0,447,partially correct
12734,"
where result =  'nominated' and director_award.title ) as dr, ;",2018-08-31 17:31:39.797043+10,13,0,45,noninterpretable
12735,"select x.id
from (role r natural join appearance a) as x
where lower(x.title)='psycho' and x.production_year='1960'
Group by x.id
Having count (*)=1;",2018-08-31 17:31:43.590672+10,10,1,424,correct
12736,"
select first_name, last_name
from person, movie_award, director
where person.id = director.id
and movie_award.title = director.title
and movie_award.production_year = director.production_year
and lower(result) = 'won'
and lower(award_name) = 'bafta film award'
and lower(category) = 'best film';",2018-08-31 17:31:44.279175+10,8,0,129,partially correct
12737,"select p.id
from person p
where p.year_born = (select max(year_born) from person p where year_born < (select max(year_born) from person)) ;",2018-08-31 17:31:54.69191+10,3,1,59,correct
12738,;,2018-08-31 17:31:54.972063+10,15,0,358,noninterpretable
12739,"select x.id
from (role r natural join appearance a) as x
where lower(x.title)='psycho' and x.production_year='1960'
Group by x.id
Having count (x.id)=1;",2018-08-31 17:31:56.84391+10,10,1,424,correct
12740,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 17:32:07.170177+10,15,1,358,correct
12741,"SELECT production_year, COUNT(*)
FROM MOVIE
WHERE production_year > 1990
AND production_year < 1994
GROUP BY production_year;",2018-08-31 17:32:10.868183+10,2,1,356,correct
12742,"SELECT r.id
FROM role r, scene s, appearance a
WHERE r.title = s.title
AND r.production_year = s.production_year
AND s.title = a.title
AND s.scene_no = a.scene_no
AND s.production_year = a.production_year
AND a.description = r.description
AND lower(a.title) = 'psycho'
AND a.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-31 17:32:11.049086+10,10,1,169,correct
12743,"SELECT
  count(*) AS number_of_reward
FROM
  writer_award wa,
  writer w,
  person p
WHERE 
  wa.title=w.title
  AND wa.production_year=w.production_year
  AND wa.id=w.id
  AND w.id=p.id
  AND lower(result)='won'
  AND lower(first_name)='woody'
  AND lower(last_name)='allen'
  AND year_born>=1991
  AND year_born<=1995;",2018-08-31 17:32:16.773312+10,9,0,355,partially correct
12744,"select id from role natural join appearance 
where title = 'Psycho' and production_year = 1960
group by description having count(*) = 1;",2018-08-31 17:32:21.795749+10,10,1,305,correct
12745,"
select director.title, director.production_year, first_name, last_name
from person, movie_award, director
where person.id = director.id
and movie_award.title = director.title
and movie_award.production_year = director.production_year
and lower(result) = 'won'
and lower(award_name) = 'bafta film award'
and lower(category) = 'best film';",2018-08-31 17:32:43.860742+10,8,1,129,correct
12746,"select ma.title, ma.production_year, p.first_name, p.last_name from 
(select title, production_year from movie_award where lower(award_name) = 'bafta film award' and lower(category) = 'best film' and lower(result) = 'won')
as ma, director as d, person as p
where ma.title = d.title and ma.production_year = d.production_year and d.id = p.id;",2018-08-31 17:32:56.609647+10,8,1,264,correct
12747,"SELECT COUNT(*)
FROM PERSON
WHERE NOT EXISTS (SELECT * 
				FROM DIRECTOR
				WHERE PERSON.id = DIRECTOR.id);",2018-08-31 17:33:57.535347+10,12,1,356,correct
12748,"SELECT d.title, d.production_year, p.first_name, p.last_name
FROM person p, director d, (SELECT title, production_year
FROM movie_award
WHERE lower(result) = 'won'
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film') AS a
WHERE d.production_year = a.production_year
AND d.title = a.title
AND d.id = p.id;",2018-08-31 17:34:12.350791+10,8,1,251,correct
12749,"select id, first_name, last_name from person
where year_born = (select max(year_born) from person);",2018-08-31 17:34:23.363251+10,7,1,129,correct
12750,"SELECT d.id,res.award_name,res.year_of_award,res.category
FROM director d,
	(SELECT title,production_year,award_name,category,year_of_award
	FROM director_award
	WHERE lower(result) = 'nominated' 
	EXCEPT
	SELECT title,production_year,award_name,category,year_of_award
	FROM director_award
	WHERE lower(result) = 'won') res
WHERE lower(d.title) = lower(res.title)
	AND d.production_year = res.production_year;",2018-08-31 17:34:28.189691+10,13,1,285,correct
12751,"select id
from(
select max(year_born), *
from person p1
where not exists(
select *
from(
select *, max(year_born)
from person
) p2
where p1.id = p2.id
));",2018-08-31 17:35:16.248367+10,3,1,330,correct
12752,"SELECT COUNT()
FROM writer_award wa, writer w, person p
WHERE w.id = wa.id
	 AND w.title = wa.title
	 AND w.production_year = wa.production_year
	 AND wa.id = p.id
	 AND lower(first_name) = 'woody'
	 AND lower(last_name) = 'allen'
	 AND lower(result) = 'won'
	 AND year_of_award >= 1991
	 AND year_of_award <= 1995;",2018-08-31 17:35:18.961809+10,9,1,251,correct
12753,"SELECT m.title,m.production_year
	FROM (writer natural join person) as wp,movie as m
	where wp.title = m.title
	and wp.production_year=m.production_year
	and lower(wp.first_name) = 'kevin'
	and lower(wp.last_name)='williamson';

",2018-08-31 17:35:20.518953+10,5,1,200,correct
12754,"SELECT wd.title, wd.production_year
FROM (movie NATURAL JOIN writer NATURAL JOIN person) AS wd
WHERE wd.first_name = 'Kevin' AND wd.last_name = 'Williamson';",2018-08-31 17:36:44.391227+10,5,1,289,correct
12755,"select title, production_year
from person, writer
where person.id = writer.id
and lower(first_name) = 'kevin'
and lower(last_name) = 'williamson';",2018-08-31 17:36:49.728282+10,5,1,129,correct
12756,"select id,award_name, year_of_award,category
from Director_Award a NATURAL JOIN director d
where  result = 'nominated';",2018-08-31 17:37:32.289226+10,13,1,59,correct
12757,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
SELECT title, production_year FROM movie_award ma WHERE ma.title = m.title AND ma.production_year = m.production_year
UNION
SELECT title, production_year FROM crew_award ca WHERE ca.title = m.title AND ca.production_year = m.production_year
UNION
SELECT title, production_year FROM director_award da WHERE da.title = m.title AND da.production_year = m.production_year
UNION
SELECT title, production_year FROM writer_award wa WHERE wa.title = m.title AND wa.production_year = m.production_year
UNION
SELECT title, production_year FROM actor_award aa WHERE aa.title = m.title AND aa.production_year = m.production_year
);",2018-08-31 17:37:38.401842+10,11,0,169,partially correct
12758,"SELECT tt.id,tt.first_name,tt.last_name
	FROM (writer natural join person natural join director) as tt
	group by tt.id
	having count(*)>1;",2018-08-31 17:38:02.173385+10,4,1,200,correct
12759,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS 
( 	SELECT ma.title,ma.production_year FROM movie_award ma
	WHERE lower(ma.result)=""won"" AND m.production_year=ma.production_year AND m.title=ma.title
	UNION
	SELECT ca.title,ca.production_year FROM crew_award ca
	WHERE lower(ca.result)=""won""  AND m.production_year=ca.production_year AND m.title=ca.title
	UNION
	SELECT da.title,da.production_year FROM director_award da
	WHERE lower(da.result)=""won""  AND m.production_year=da.production_year AND m.title=da.title
	UNION
	SELECT wa.title,wa.production_year FROM writer_award wa
	WHERE lower(wa.result)=""won""  AND m.production_year=wa.production_year AND m.title=wa.title
	UNION
	SELECT aa.title,aa.production_year FROM actor_award aa
	WHERE lower(aa.result)=""won""  AND m.production_year=aa.production_year AND m.title=aa.title);

",2018-08-31 17:39:02.773696+10,11,1,382,correct
12760,"select  distinct title,production_year,first_name,last_name
from (director natural join person) natural join movie_award
where title in (
select title from movie_award
where award_name=""BAFTA Film Award"" and category=""best film"" and result=""won"");",2018-08-31 17:39:31.655831+10,8,1,336,correct
12761,"SELECT A.id, A.first_name, A.last_name
FROM (PERSON NATURAL JOIN DIRECTOR NATURAL JOIN WRITER) AS A
GROUP BY A.id
HAVING COUNT(*) > 1;",2018-08-31 17:39:35.876267+10,4,1,356,correct
12762,"select id, award_name, year_of_award, category 
from director_award natural join director
where result = ""nominated""
;",2018-08-31 17:39:36.16193+10,13,1,330,correct
12763,"SELECT COUNT(*)
FROM movie m
WHERE NOT EXISTS (
SELECT title, production_year FROM movie_award ma WHERE ma.title = m.title AND ma.production_year = m.production_year AND lower(ma.result) = 'won'
UNION
SELECT title, production_year FROM crew_award ca WHERE ca.title = m.title AND ca.production_year = m.production_year AND lower(ca.result) = 'won'
UNION
SELECT title, production_year FROM director_award da WHERE da.title = m.title AND da.production_year = m.production_year AND lower(da.result) = 'won'
UNION
SELECT title, production_year FROM writer_award wa WHERE wa.title = m.title AND wa.production_year = m.production_year AND lower(wa.result) = 'won'
UNION
SELECT title, production_year FROM actor_award aa WHERE aa.title = m.title AND aa.production_year = m.production_year AND lower(aa.result) = 'won'
);",2018-08-31 17:40:48.413182+10,11,1,169,correct
12764,"select id from role r,scene s
where r.description=s.description;",2018-08-31 17:40:49.070382+10,10,0,192,partially correct
12765,"select id, award_name, year_of_award, category
from director natural join director_award
where 
	lower(result) = 'nominated'
	and id not in (select id from director natural join director_award
				where lower(result) = 'won');",2018-08-31 17:40:55.125605+10,13,1,201,correct
12766,"SELECT country FROM restriction
WHERE title='Shakespeare in Love' AND description='M';",2018-08-31 17:41:12.385605+10,6,1,289,correct
12767,"select id, award_name, year_of_award, category
from director natural join director_award
where 
	lower(result) = 'nominated'
	;",2018-08-31 17:41:21.925285+10,13,1,201,correct
12768,"select first_name,last_name, role.title,production_year,description
from person, role,(
select id,max(r.c)
from
(
select id,count(*) as c
from role
group by id
order by count(*) desc) as r) as m_c
where person.id = m_c.id
and person.id=role.id

;",2018-08-31 17:41:29.519407+10,15,1,207,correct
12769,"select id, award_name, year_of_award, category
from director natural join director_award
where 
	lower(result) = 'nominated'
	and id not in (select id from director natural join director_award
				where lower(result) = 'won');",2018-08-31 17:41:34.709793+10,13,1,201,correct
12770,select * from restriction where description = 'M' and title='Shakespeare in Love' group by country;,2018-08-31 17:42:53.61829+10,6,0,200,partially correct
12771,"SELECT r.id
FROM scene s, role r, appearance a 
WHERE s.title = r.title
AND s.production_year = r.production_year
AND s.title = a.title
AND s.production_year = a.production_year
AND s.scene_no = a.scene_no
AND lower(a.title) = 'psycho'
AND a.description = r.description
AND s.production_year = 1960
GROUP BY r.id
HAVING COUNT(*) = 1;",2018-08-31 17:43:16.94807+10,10,1,251,correct
12772,select country from restriction where description = 'M' and title='Shakespeare in Love';,2018-08-31 17:43:27.164188+10,6,1,200,correct
12773,"SELECT title, production_year
FROM MOVIE 
WHERE EXISTS (SELECT *
			FROM WRITER, PERSON
			WHERE MOVIE.title = WRITER.title
			AND MOVIE.production_year = WRITER.production_year
			AND PERSON.id = WRITER.id
			AND lower(first_name) = 'kevin'
			AND lower(lats_name) = 'williamson');",2018-08-31 17:43:56.144856+10,5,0,356,noninterpretable
12774,"SELECT id
FROM person p
WHERE p.year_born = (SELECT MAX(year_born) FROM person p
                     WHERE p.year_born < (SELECT MAX(p.year_born)
                     FROM person p));",2018-08-31 17:44:06.948807+10,3,1,169,correct
12775,"select id
from (movie INNER join director on movie.title = director.title)AS md,(movie  inner join writer on movie.title = writer.id )as mj;",2018-08-31 17:44:26.638813+10,14,0,59,noninterpretable
12776,"SELECT title, production_year
FROM WRITER
WHERE EXISTS (SELECT *
			FROM PERSON
			AND PERSON.id = WRITER.id
			AND lower(first_name) = 'kevin'
			AND lower(lats_name) = 'williamson');",2018-08-31 17:44:46.290716+10,5,0,356,noninterpretable
12777,"SELECT id,first_name, last_name
FROM person
WHERE year_born=MIN(year_born);",2018-08-31 17:45:01.034745+10,7,0,289,noninterpretable
12778,"select first_name,last_name
from director natural join person
where title in (select title
from movie_award
where lower(award_name)=""bafta film award""
      and lower(category)=""best film""
	  and result=""won"");",2018-08-31 17:45:44.149935+10,8,0,336,partially correct
12779,"SELECT title, production_year
FROM WRITER, PERSON
WHERE PERSON.id = WRITER.id
AND lower(first_name) = 'kevin'
AND lower(lats_name) = 'williamson';",2018-08-31 17:45:46.008029+10,5,0,356,noninterpretable
12822,"SELECT id, first_name, last_name
FROM PERSON
WHERE PERSON.MAX(year_born) = (SELECT MAX(year_born)
						FROM PERSON);",2018-08-31 17:58:07.259026+10,7,0,356,noninterpretable
12780,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 17:46:16.773957+10,14,1,59,correct
12781,"select first_name,last_name,title,production_year
from director natural join person
where title in (select title
from movie_award
where lower(award_name)=""bafta film award""
      and lower(category)=""best film""
	  and result=""won"");",2018-08-31 17:46:27.939364+10,8,1,336,correct
12782,"SELECT W.title, W.production_year
FROM WRITER W, PERSON
WHERE PERSON.id = W.id
AND lower(first_name) = 'kevin'
AND lower(lats_name) = 'williamson';",2018-08-31 17:46:32.561438+10,5,0,356,noninterpretable
12783,"SELECT W.title, W.production_year
FROM WRITER W, PERSON
WHERE PERSON.id = W.id
AND lower(first_name) = 'kevin'
AND lower(lats_name) = 'williamson';",2018-08-31 17:46:42.483693+10,5,0,356,noninterpretable
12784,;,2018-08-31 17:46:46.090558+10,11,0,455,noninterpretable
12785,"select title, production_year,first_name,last_name
from director natural join person
where title in (select title
from movie_award
where lower(award_name)=""bafta film award""
      and lower(category)=""best film""
	  and result=""won"");",2018-08-31 17:46:54.451362+10,8,1,336,correct
12786,;,2018-08-31 17:47:18.677554+10,3,0,455,noninterpretable
12787,"SELECT W.title, W.production_year
FROM WRITER W, PERSON P
WHERE P.id = W.id
AND lower(first_name) = 'kevin'
AND lower(la_name) = 'williamson';",2018-08-31 17:47:27.350326+10,5,0,356,noninterpretable
12788,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 17:47:42.218301+10,14,1,447,correct
12789,"SELECT W.title, W.production_year
FROM WRITER W, PERSON P
WHERE P.id = W.id
AND lower(first_name) = 'kevin'
AND lower(last_name) = 'williamson';",2018-08-31 17:47:44.371477+10,5,1,356,correct
12790,"
select person.id, first_name, last_name
from person natural join director natural join writer
group by person.id
having count(person.id)>1;
",2018-08-31 17:48:02.460926+10,4,1,129,correct
12791,"SELECT id
FROM
(SELECT id, MAX(year_born)
FROM person
WHERE id!=
(SELECT id
FROM
(SELECT id,MAX(year_born)
FROM person)));",2018-08-31 17:48:26.42239+10,3,1,382,correct
12792,;,2018-08-31 17:48:37.379529+10,13,0,455,noninterpretable
12793,"
select count(*) from person
where id in (select id from director);",2018-08-31 17:49:15.767337+10,12,0,129,partially correct
12794,"
select count(*) from person
where id not in (select id from director);",2018-08-31 17:49:39.583602+10,12,1,129,correct
12795,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            r.id,
            count(*) AS number_of_roles
        FROM
            ROLE r
        GROUP BY
            r.id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    r.id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE r
                GROUP BY
                   r.id ) AS a );",2018-08-31 17:49:54.089833+10,15,1,223,correct
12796,";
",2018-08-31 17:50:06.911602+10,14,0,455,noninterpretable
12797,"SELECT COUNTRY
FROM RESTRICTION
WHERE lower(title) = 'shakespace of love'
AND DESCRIPTION = 'M';",2018-08-31 17:50:11.683932+10,6,0,356,partially correct
12798,"SELECT country
FROM RESTRICTION
WHERE lower(title) = 'shakespace of love'
AND DESCRIPTION = 'M';",2018-08-31 17:50:33.654204+10,6,0,356,partially correct
12799,";
",2018-08-31 17:50:55.054727+10,15,0,455,noninterpretable
12800,"SELECT country
FROM RESTRICTION
WHERE lower(title) = 'shakespace of love'
AND description = 'M';",2018-08-31 17:51:11.471314+10,6,0,356,partially correct
12801,"SELECT id, award_name, year_of_award, category
FROM director d, director_award da
WHERE result;",2018-08-31 17:51:14.213611+10,13,0,251,partially correct
12802,"select production_year, count(*) 
from movie
where production_year > 1990
and production_year < 1994
group by production_year;",2018-08-31 17:51:18.543779+10,2,1,129,correct
12803,"select count (distinct w.id)
from writer w, person p
where w.id=p.id and p.year_born=1935;",2018-08-31 17:51:39.594222+10,1,1,273,correct
12804,"select count(*) from person, writer
where person.id = writer.id
and year_born = 1935;",2018-08-31 17:52:13.709893+10,1,0,129,partially correct
12805,"select d.id,da.award_name,da.year_of_award,da.category 
from director d natural join director_award da
where lower(da.result)='nominated'
except
select d.id,da.award_name,da.year_of_award,da.category 
from director d natural join director_award da
where lower(da.result)='won';",2018-08-31 17:53:32.113495+10,13,1,354,correct
12806,"select m.production_year, count (distinct m.title)
from movie m
where m.production_year>1990 and m.production_year<1994
group by m.production_year;",2018-08-31 17:53:32.414454+10,2,1,273,correct
12807,"select count(distinct person.id) from person, writer
where person.id = writer.id
and year_born = 1935;",2018-08-31 17:53:34.852237+10,1,1,129,correct
12808,"WITH dw AS (SELECT w.id,COUNT(*) AS c
            FROM writer w,director d 
            WHERE w.title = d.title and w.production_year = d.production_year and w.id = d.id
            GROUP BY w.id
            )
SELECT p.id,first_name,last_name
FROM person p , dw
WHERE dw.id = p.id and dw.c>=2;
",2018-08-31 17:53:37.033444+10,4,1,443,correct
12809,"SELECT country
FROM RESTRICTION
WHERE title = 'Shakespace of Love'
AND description = 'M';",2018-08-31 17:53:42.469186+10,6,0,356,partially correct
12810,"SELECT country
FROM RESTRICTION
WHERE lower(title) = 'shakespace of love'
AND description = 'M';",2018-08-31 17:54:10.244158+10,6,0,356,partially correct
12811,"SELECT country
FROM RESTRICTION
WHERE 
lower(title) = 'shakespace of love'
AND description = 'M';",2018-08-31 17:54:23.654969+10,6,0,356,partially correct
12812,"select id from person 
where year_born = (select (year_born) from person order by year_born desc limit 1 offset 1);",2018-08-31 17:54:27.075336+10,3,1,200,correct
12813,"select id
from (select id,description
 from role
 where title=""Psycho""
   and production_year=1960) as a natural join appearance
 group by id
 having count(*)=1;",2018-08-31 17:54:41.067679+10,10,0,336,partially correct
12814,"
	select title,production_year from movie_award union
	 select title,production_year from crew_award union
	 select title,production_year from director_award union
	 select title,production_year from writer_award union
	 select title,production_year from actor_award;",2018-08-31 17:55:12.286796+10,11,0,305,partially correct
12815,"select count(*)
from person p
where not exists (select d.id from director d where p.id=d.id);",2018-08-31 17:55:40.362268+10,12,1,273,correct
12816,"SELECT id, first_name, lats_name, MAX(year_born)
FROM PERSON;",2018-08-31 17:55:46.586442+10,7,0,356,noninterpretable
12817,"select id
from (select id,description,title, production_year
 from role
 where title=""Psycho""
   and production_year=1960) as a natural join appearance
 group by id
 having count(*)=1;",2018-08-31 17:55:59.787285+10,10,1,336,correct
12818,"SELECT id, first_name, last_name, MAX(year_born)
FROM PERSON;",2018-08-31 17:56:01.43722+10,7,0,356,partially correct
12819,"select id from person 
where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person));",2018-08-31 17:56:08.791643+10,3,1,200,correct
12820,"select id
from
(
select d.id, d.title, d.production_year
from director d
union
select w.id, w.title, w.production_year
from writer w
group by id
)
;",2018-08-31 17:57:01.267961+10,14,0,221,partially correct
12821,"SELECT  id,title,award_name,year_of_award,category
FROM director_award NATURAL JOIN director
WHERE result=""nominated""
EXCEPT
SELECT  id,title,award_name,year_of_award,category
FROM director_award NATURAL JOIN director
WHERE result=""won"";",2018-08-31 17:58:06.478018+10,13,0,382,partially correct
12823,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d, director_award da
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower(da.result) = 'nominated'
AND d.id NOT IN(SELECT id
FROM director d, director_award da
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower(da.result) = 'won');",2018-08-31 17:58:20.725891+10,13,1,251,correct
12824,"SELECT id, first_name, last_name
FROM PERSON
WHERE PERSON.year_born = (SELECT MAX(year_born)
						FROM PERSON);",2018-08-31 17:58:35.861763+10,7,1,356,correct
12825,"SELECT
  count(*) AS number_of_reward
FROM
  writer_award wa,
  writer w,
  person p
WHERE 
  wa.title=w.title
  AND wa.production_year=w.production_year
  AND wa.id=w.id
  AND w.id=p.id
  AND lower(result)='won'
  AND lower(first_name)='woody'
  AND lower(last_name)='allen'
  AND year_of_award>=1991
  AND year_of_award<=1995;",2018-08-31 17:58:37.133366+10,9,1,355,correct
12826,"SELECT  id,award_name,year_of_award,category
FROM director_award NATURAL JOIN director
WHERE result=""nominated""
EXCEPT
SELECT  id,award_name,year_of_award,category
FROM director_award NATURAL JOIN director
WHERE result=""won"";",2018-08-31 17:58:37.686417+10,13,1,382,correct
12827,"select p.id, p.first_name, p.last_name
from person p, director d, writer w
where p.id=d.id and d.id=w.id and d.title=w.title and d.production_year=w.production_year
group by p.id, p.first_name, p.last_name
having count (p.id)>=2;",2018-08-31 17:59:03.029665+10,4,1,273,correct
12828,"SELECT wd.title, wd.production_year, wd.first_name, wd.last_name
FROM (MOVIE_AWARD NATURAL JOIN director NATURAL JOIN person) AS wd 
WHERE wd.award_name='BAFTA Film Award' AND wd.category='Best Film';",2018-08-31 17:59:17.9833+10,8,0,289,partially correct
12829,"SELECT count(*)
FROM writer_award AS wa,
	person AS p,
	writer AS w
WHERE wa.id=w.id
AND wa.title=w.title
AND wa.production_year=w.production_year
AND w.id=p.id
AND lower(result)='won'
AND lower(p.first_name)='woody'
AND lower(p.last_name)='allen'
AND year_of_award>1990
AND year_of_award<1996;",2018-08-31 17:59:37.292305+10,9,1,217,correct
12830,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (   SELECT id, count(*) AS number_of_roles
        FROM ROLE
        GROUP BY id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT max(number_of_roles)
        FROM (SELECT id, count ( * ) AS number_of_roles FROM ROLE
                GROUP BY id ) AS a );",2018-08-31 18:00:26.203847+10,15,1,174,correct
12831,"select p.first_name, p.last_name, r.description
from person p, role r
where p.id=r.id;",2018-08-31 18:00:36.117874+10,15,0,196,partially correct
12832,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year 
		FROM director d 
		UNION 
		SELECT w.id, title, production_year 
		FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year 
			FROM director d 
			UNION 
			SELECT w.id, title, production_year 
			FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 18:00:55.456014+10,14,1,221,correct
12833,"select id from
(select id,count(*) as noof from (select id,title,production_year from director d union select id,title,production_year from writer w)x1 group by x1.id)x
where x.noof = (select max(noof) from  (select id,count(*) as noof from (select id,title,production_year from director d union select id,title,production_year from writer w)x1 group by x1.id));",2018-08-31 18:01:20.301755+10,14,1,265,correct
12834,"SELECT x.id 
FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
	FROM (SELECT d.id, title, production_year FROM director d 
		UNION 
		SELECT w.id, title, production_year FROM writer w) x1 
		GROUP BY x1.id) x 
WHERE x.NoOfWorkedON= 
	(SELECT MAX(x2.NoOfWorkedON) 
	FROM (SELECT x1.id, count(*) AS NoOfWorkedON 
		FROM (SELECT d.id, title, production_year FROM director d 
			UNION 
			SELECT w.id, title, production_year FROM writer w) x1 
			GROUP BY x1.id) x2);",2018-08-31 18:01:35.287471+10,14,1,174,correct
12835,"select rst_name, last_name, title, production_year, description
from (select  rst_name, last_name, title, production_year, description, 
      from person inner join role on person.id = role.id
	  where ) x
where noofrole = (select max(*) 
from
);",2018-08-31 18:01:49.540299+10,15,0,59,noninterpretable
12836,"select count(*) from person p
where p.id in ( select w.id from writer w
where p.id = w.id and year_born = 1935);",2018-08-31 18:01:59.917751+10,1,1,390,correct
12837,"select r.id
from Role r,Appearance a,scene s
where 
	r.title = r.title
	and a.title = s.title
	and a.production_year = s.production_year
	and a.production_year=s.production_year
	
	and a.scene_no= s.scene_no
	and a.description=r.description 
	and lower(a.title) ='psycho'
	and a.production_year = 1960
	group by r.id
	
	having count(*)=1;",2018-08-31 18:02:23.234202+10,10,0,200,partially correct
12838,"select m.title, m.production_year
from movie m, writer w, person p
where m.title=w.title and m.production_year=w.production_year and p.id=w.id and lower(p.first_name)='kevin' and lower(p.last_name)='williamson';",2018-08-31 18:02:24.229382+10,5,1,273,correct
12839,"select mad.title, mad.production_year, mad.first_name, mad.last_name
from (movie_award natural join director natural join person) as mad
where lower(mad.award_name) = 'bafta film award'  and lower(mad.category) = 'best film';
",2018-08-31 18:03:01.120916+10,8,0,245,partially correct
12840,"select Count(distinct w.id)
from writer w where w.id in(Select id from person where person.year_born='1935');
",2018-08-31 18:03:10.71335+10,1,1,234,correct
12841,"select first_name,last_name from person;",2018-08-31 18:03:37.943291+10,15,0,456,partially correct
12842,"SELECT id
FROM ;",2018-08-31 18:03:54.923369+10,14,0,251,noninterpretable
12843,"select r.country
from restriction r
where lower(r.title)='shakespeare in love' and lower(r.description)='m';",2018-08-31 18:04:06.341242+10,6,1,273,correct
12844,"SELECT title, production_year, first_name, last_name
FROM MOVIE_AWARD, PERSON, DIRECTOR
WHERE MOVIE_AWARD.title = DIRECTOR.title
AND MOVIE_AWARD.production_year = DIRECTOR.production_year
AND DIRECTOR.id = PERSON.id
AND lower(award_name) = 'bafta film award'
AND lower(category) = 'best film';",2018-08-31 18:04:23.642504+10,8,0,356,noninterpretable
12845,"select * from movie
where not exists(movie.title =movie_awards.title
or movie.title =movie_awards.title 
or movie.title =crew_awards.title 
or movie.title =director_awards.title 
or movie.title =writer_awards.title 
or movie.title =actor_awards.title);",2018-08-31 18:05:24.750418+10,11,0,192,noninterpretable
12846,"select mad.title, mad.production_year, mad.first_name, mad.last_name
from (movie_award natural join director natural join person) as mad
where lower(mad.award_name) = 'bafta film award'  and lower(mad.category) = 'best film' and lower(mad.result) = 'won';
",2018-08-31 18:05:28.302271+10,8,1,245,correct
12847,"select p.id, p.first_name, p.last_name
from person p
where p.year_born=(select max(year_born) from person);",2018-08-31 18:05:29.461826+10,7,1,273,correct
12848,"with a as (select id, count(*)as c
from (select id, title,production_year
from director
union 
select id,title,production_year
from writer)
group by id)


select id
from a
where c=(
select max(c)
from a);",2018-08-31 18:06:26.961881+10,14,1,336,correct
12849,"select production_year, count(*) from movie
where production_year in (1993, 1992, 1991)
group by production_year;",2018-08-31 18:06:28.165601+10,2,1,390,correct
12850,"SELECT first name, last name, title, production_year, description
FROM;",2018-08-31 18:06:50.113933+10,15,0,251,noninterpretable
12851,"select count(*), production_year from movie
where production_year in (1993, 1992, 1991)
group by production_year;",2018-08-31 18:07:06.428601+10,2,1,390,correct
12852,"SELECT id
FROM
(SELECT MAX(a),id
FROM
(SELECT COUNT(*) AS a,id
FROM (SELECT id ,title,production_year
FROM director
UNION 
SELECT id,title,production_year
FROM writer)
GROUP BY id));",2018-08-31 18:07:09.209769+10,14,0,382,partially correct
12967,"SELECT Count(*)
FROM person p
WHERE Exists (SELECT * FROM director d WHERE p.id != d.id);",2018-08-31 19:12:47.116795+10,12,0,62,partially correct
12853,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles in (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 18:07:23.742764+10,15,1,265,correct
12854,"select production_year as ""Production Year"", count(*) from movie
where production_year in (1993, 1992, 1991)
group by production_year;",2018-08-31 18:07:45.543847+10,2,1,390,correct
12855,"SELECT id
FROM;",2018-08-31 18:07:52.55986+10,3,0,251,noninterpretable
12856,"select id
from role
where description = ;",2018-08-31 18:08:07.18836+10,10,0,463,noninterpretable
12857,"SELECT count(*) FROM (writer_award NATURAL JOIN person) AS wp
WHERE wp.year_of_award BETWEEN 1991 AND 1995
AND wp.last_name='Allen' AND wp.first_name='Woody'
AND wp.result='won';
",2018-08-31 18:08:25.751729+10,9,1,289,correct
12858,"SELECT COUNT(*)
FROM (writer NATURAL JOIN person)w
WHERE w.year_born = '1935';",2018-08-31 18:08:32.886045+10,1,0,145,partially correct
12859,"select *
from role
where id = '00000002'
;",2018-08-31 18:08:55.47846+10,15,0,221,partially correct
12860,"SELECT id
FROM scene s, appearance a, role r
WHERE s.title=a.title
  and s.production_year=a.production_year
  and s.scene_no=a.scene.no
  and s.title=r.title
  and a.production_year=r.production_year
  and a.description=r.description
  and lower(a.title)='psycho'
  and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 18:09:08.457687+10,10,0,355,noninterpretable
12861,"select ma.title, ma.production_year, p.first_name, p.last_name
from movie_award ma, director d, person p
where p.id=d.id and d.title=ma.title and d.production_year= ma.production_year
         and lower(ma.award_name)='bafta film award'
		 and lower(ma.category)='best film'
		 and lower(ma.result)='won';",2018-08-31 18:09:31.172853+10,8,1,273,correct
12862,"SELECT r.id
FROM role AS r,
scene AS s,
appearance AS a
WHERE s.title=a.title
AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(s.title) = 'psycho'
    AND s.production_year = 1960
GROUP BY r.id
HAVING
    count(*) = 1;",2018-08-31 18:09:48.819669+10,10,1,217,correct
12863,"SELECT id
FROM(SELECT COUNT(*) AS a,id
FROM (SELECT id ,title,production_year
FROM director
UNION 
SELECT id,title,production_year
FROM writer)
GROUP BY id)
WHERE a=
(SELECT MAX(a)
FROM
(SELECT COUNT(*) AS a,id
FROM (SELECT id ,title,production_year
FROM director
UNION 
SELECT id,title,production_year
FROM writer)
GROUP BY id))
;",2018-08-31 18:10:03.165718+10,14,1,382,correct
12864,"SELECT r.id
FROM scene s, appearance a, role r
WHERE s.title=a.title
  and s.production_year=a.production_year
  and s.scene_no=a.scene_no
  and s.title=r.title
  and a.production_year=r.production_year
  and a.description=r.description
  and lower(a.title)='psycho'
  and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 18:10:11.077322+10,10,1,355,correct
12865,"select count(*) from person p 
where p.id not in (
	select distinct d.id from director d
	where d.id = p.id);",2018-08-31 18:10:12.467126+10,12,1,390,correct
12866,"SELECT id
FROM person
WHERE year_born = (SELECT MAX(year_born)
FROM person
WHERE year_born < (SELECT MAX(year_born)
FROM PERSON));",2018-08-31 18:10:41.514108+10,3,1,251,correct
12867,"SELECT r.id
FROM scene s, appearance a, role r
WHERE s.title=a.title
  and s.production_year=a.production_year
  and s.scene_no=a.scene_no
  and a.description=r.description
  and lower(a.title)='psycho'
  and a.production_year=1960
group by r.id
having count(*)=1;",2018-08-31 18:10:44.145147+10,10,0,355,partially correct
12868,"SELECT ma.title, ma.production_year, p.first_name, p.last_name
FROM PERSON p, DIRECTOR d,
	(SELECT title, production_year
	FROM MOVIE_AWARD
	WHERE lower(award_name) = 'bafta film award'
	AND lower(category) = 'beat film'
	AND lower(result) = 'won') AS ma
WHERE ma.title = d.title
AND ma.production_year = d.production_year
AND d.id = p.id;",2018-08-31 18:11:01.767941+10,8,0,356,partially correct
12869,"select wa.year_of_award, count(*) 
from (writer_award natural join writer natural join person) wa
where lower(wa.first_name) = 'woody'
and lower(wa.last_name) = 'allen'
and wa.year_of_award > 1990 
and wa.year_of_award < 1996
group by wa.year_of_award;",2018-08-31 18:11:33.105712+10,9,0,245,partially correct
12870,;,2018-08-31 18:11:35.03083+10,10,0,289,noninterpretable
12871,"SELECT r.id
FROM role AS r,
scene AS s,
appearance AS a
WHERE s.title=a.title
AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND a.title = r.title
    AND a.production_year = r.production_year
    AND a.description = r.description
    AND lower(s.title) = 'psycho'
    AND r.production_year = 1960
GROUP BY r.id
HAVING
    count(*) = 1;",2018-08-31 18:12:41.087739+10,10,1,217,correct
12872,"select count(*) as number_of_award
from (writer_award natural join writer natural join person) wa
where lower(wa.first_name) = 'woody'
and lower(wa.last_name) = 'allen'
and lower(wa.result) = 'won'
and wa.year_of_award > 1990 
and wa.year_of_award < 1996
group by wa.year_of_award;",2018-08-31 18:12:57.523956+10,9,1,245,correct
12873,"SELECT d.id, da.award_name, da.year_of_award, da.category
FROM director d,director_award da
WHERE d.title = da.title
AND d.production_year = da.production_year
AND lower(da.result) = 'nominated'
AND d.id NOT IN (SELECT d.id
                 FROM director d,director_award da
                 WHERE d.title = da.title
                 AND d.production_year = da.production_year
                 AND lower(da.result) = 'won');",2018-08-31 18:13:21.85626+10,13,1,169,correct
12874,"select count(*)
from 
	movie m
where not exists(

	select title, production_year 
	from movie_award ma
	where ma.title = m.title and ma.production_year = m.production_year and lower(ma.result) = 'won'
	
	union
	
	select title, production_year
	from crew_award ca
	where ca.title = m.title and ca.production_year = m.production_year and lower(ca.result) = 'won'
	
	union
	
	select title, production_year 
	from director_award da
	where da.title = m.title and da.production_year = m.production_year and lower(da.result) = 'won'
	
	union
	
	select title, production_year 
	from writer_award wa
	where wa.title = m.title and wa.production_year = m.production_year and lower(wa.result) = 'won'
	
	union
	
	select title, production_year 
	from actor_award aa
	where aa.title = m.title and aa.production_year = m.production_year and lower(aa.result) = 'won'
	
);",2018-08-31 18:13:22.362222+10,11,1,455,correct
12875,"select ma.title, ma.production_year, p.first_name, p.last_name
from director d natural join person p natural join movie_award ma
where lower(ma.award_name) = 'bafta film award' and lower(ma.category)='best film';",2018-08-31 18:14:13.490109+10,8,0,196,partially correct
12876,"SELECT COUNT(DISTINCT p.id) AS BornIn1935
FROM writer w, person p
WHERE p.id = w.id AND p.year_born = 1935
GROUP BY year_born;",2018-08-31 18:15:13.841665+10,1,1,251,correct
12877,"select ma.title, ma.production_year, p.first_name, p.last_name
from director d natural join person p natural join movie_award ma
where lower(ma.award_name) = 'bafta film award' and lower(ma.category)='best film' and result = 'won';",2018-08-31 18:15:21.656684+10,8,1,196,correct
12878,"select id from person where year_born = (select max(year_born) from person where year_born < (select max(year_born) from person)) ;
",2018-08-31 18:15:25.493676+10,3,1,305,correct
12879,"SELECT production_year, COUNT() AS NumberOfMovie
FROM movie
WHERE production_year >= 1991 AND production_year <= 1993
GROUP BY production_year;",2018-08-31 18:16:33.473597+10,2,1,251,correct
12880,"select first_name, last_name, title, production_year, description
from(
  select *
  from role natural join person
) a1
where a1.id = (
  select id
  from(
	select *, max(c)
	from(
	  select *, count(*) c
	  from role natural join person
	  group by id
	)
  )
);",2018-08-31 18:17:06.543558+10,15,1,330,correct
12881,"SELECT first_name,last_name,title,production_year,description
FROM role NATURAL JOIN person
WHERE id=


(SELECT id
FROM (SELECT id,COUNT(*) AS number
FROM role NATURAL JOIN person 
GROUP BY id)

WHERE number =
(SELECT MAX(number)
FROM
(
SELECT id,COUNT(*) AS number
FROM role NATURAL JOIN person 
GROUP BY id)));
",2018-08-31 18:17:17.650173+10,15,1,382,correct
12882,"
select max(year_born) from person;",2018-08-31 18:17:30.223454+10,3,0,192,partially correct
12883,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles IN (
        SELECT
            max(number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 18:17:45.324265+10,15,1,456,correct
12884,"SELECT COUNT(*)
FROM writer,person
WHERE writer.id=person.id AND person.year_born=1935;",2018-08-31 18:18:02.571084+10,1,0,335,partially correct
12885,"select count(*)
from (writer_award natural join person natural join writer) as wp
where lower(wp.first_name)='woody' 
         and lower(wp.last_name)='allen'
	  and wp.year_of_award>1990
	  and wp.year_of_award<1996
	  and lower(wp.result)='won'
group by wp.id;",2018-08-31 18:18:26.166126+10,9,1,273,correct
12886,"select count(*)
from movie m
where not exists(
  select title, production_year
  from movie_award ma
  where lower(result)='won' and ma.title=m.title and ma.production_year=m.production_year
  union 
  select title, production_year
  from crew_award ca
  where lower(result)='won' and ca.title=m.title and ca.production_year=m.production_year  
  union
   select title, production_year
  from director_award da
  where lower(result)='won' and da.title=m.title and da.production_year=m.production_year
  union
   select title, production_year
  from actor_award aa
  where lower(result)='won' and aa.title=m.title and aa.production_year=m.production_year
  union
   select title, production_year
  from writer_award ra
  where lower(result)='won' and ra.title=m.title and ra.production_year=m.production_year
  );",2018-08-31 18:18:42.867804+10,11,1,355,correct
12887,"select id,first_name,last_name from(person natural join director natural join writer) 
group by id having count(*)>1;",2018-08-31 18:19:45.139302+10,4,1,341,correct
12888,"SELECT COUNT(*)
FROM person
WHERE EXISTS(SELECT * FROM writer WHERE writer.id=person.id AND person.year_born=1935);",2018-08-31 18:19:59.036677+10,1,1,335,correct
12889,"select id, award_name,year_of_award,category from director_award natural join director where result != 'won';",2018-08-31 18:20:03.140809+10,13,1,305,correct
12890,"SELECT count(*)
FROM person p
WHERE NOT EXISTS (SELECT * 
				FROM director d
				WHERE d.id = p.id);",2018-08-31 18:21:44.437674+10,12,1,339,correct
12891,;,2018-08-31 18:22:04.615676+10,15,0,215,noninterpretable
12892,"select p.id
from person p
where p.year_born=(
  select max(year_born)
  from person
  where year_born<(select max(year_born) from person)
  );",2018-08-31 18:22:16.153794+10,3,1,355,correct
12893,"SELECT COUNT(*)
FROM person p 
WHERE EXISTS (SELECT * FROM writer w
              WHERE p.id = w.id
              AND p.year_born = 1935);",2018-08-31 18:22:35.401596+10,1,1,169,correct
12894,"with z as (select count(*)as a,id from role group by id)
select first_name,last_name,title,production_year from person natural join role where id in (select id from z where a in (select max(a) from z));",2018-08-31 18:22:47.330753+10,15,0,190,partially correct
12895,"select p.id from person p where p.year_born = (
select max(year_born) from person where year_born < (
select max(year_born) from person));
",2018-08-31 18:22:54.229165+10,3,1,192,correct
12896,"with z as (select count(*)as a,id from role group by id)
select first_name,last_name,title,production_year,desciption from person natural join role where id in (select id from z where a in (select max(a) from z));",2018-08-31 18:23:10.244419+10,15,0,190,noninterpretable
12897,"with z as (select count(*)as a,id from role group by id)
select first_name,last_name,title,production_year,desciption from person natural join role where id in (select id from z where a in (select max(a) from z));",2018-08-31 18:23:18.685428+10,15,0,190,noninterpretable
12898,"Select max(year_born), id
from person
where year_born not in (select max (year_born) from person);


",2018-08-31 18:23:25.834929+10,3,0,45,partially correct
12899,"select p.id
from person p
where 
	p.year_born = (select max(year_born)
				from person
				where year_born < (select max(year_born)
								from person));",2018-08-31 18:23:38.610866+10,3,1,455,correct
12900,"select p.id from person p where p.year_born = (
select max(id) from person where id < (select max(id) from person));
",2018-08-31 18:23:40.864144+10,13,0,192,partially correct
12901,"with z as (select count(*)as a,id from role group by id)
select first_name,last_name,title,production_year,description from person natural join role where id in (select id from z where a in (select max(a) from z));",2018-08-31 18:23:42.132811+10,15,1,190,correct
12902,"SELECT production_year, COUNT(*)
FROM movie m
WHERE m.production_year >= 1991
AND m.production_year <= 1993
GROUP BY m.production_year;",2018-08-31 18:24:32.926312+10,2,1,169,correct
12903,"select count(ww.id) from(
select distinct p.id from writer w,person p
where w.id=p.id and p.year_born =1935) as ww;
",2018-08-31 18:25:01.362344+10,14,0,192,partially correct
12904,"
select count(id),title from writer natural join movie group by id;",2018-08-31 18:25:29.861834+10,14,0,305,partially correct
12905,"select count(ww.id) from(
select distinct p.id from writer w,person p
where w.id=p.id and p.year_born =1935) as ww;

",2018-08-31 18:25:46.937317+10,15,0,192,partially correct
12906,"SELECT COUNT(*)
FROM writer_award AS da
WHERE da.year_of_award>=1991 and da.year_of_award<=1995 AND
(SELECT id FROM person WHERE first_name='Woody' AND last_name='Allen')=da.id;",2018-08-31 18:25:51.7556+10,9,0,335,partially correct
12907,"select id
from person
where id in (select count(*) as ct, id
from (select d.id, d.title, d.production_year from director d 
union
select w.id, w.title, w.production_year from writer w 
except
select d2.id, d2.title, d2.production_year
from director d2 inner join writer w2 on d2.id=w2.id 
and d2.title=w2.title and d2.production_year=w2.production_year) as r
group by id) ;
",2018-08-31 18:26:38.581934+10,14,0,354,noninterpretable
12908,"SELECT COUNT(*)
FROM writer_award AS da
WHERE da.year_of_award>=1991 and da.year_of_award<=1995 AND
(SELECT id FROM person WHERE first_name='Woody' AND last_name='Allen' AND result='won')=da.id;",2018-08-31 18:26:44.638925+10,9,1,335,correct
12909,"select count(*)
from person p
where exists(select * from writer w where p.id = w.id and p.year_born  = 1935);",2018-08-31 18:26:52.159613+10,1,1,225,correct
12910,"with a as (select count(*) as b, id from (select id,title,production_year from director union select id,title,production_year from writer) group by id)
select id from a where b=(select max(b) from a);",2018-08-31 18:26:58.29551+10,14,1,190,correct
12911,"SELECT p.FIRST_NAME, 
	p.LAST_NAME, 
	r.title, 
	r.production_year, 
	r.description

FROM person p,
	role r,
	(SELECT id, Count(*) as no_workon from role
	Group by id) as b

Where r.id=p.id
AND p.id=b.id
AND	b.no_workon = 
			(SELECT MAX(no_workon) from 
					(SELECT id, Count(*) as no_workon from role
					Group by id) as a);
",2018-08-31 18:28:50.323487+10,15,1,198,correct
12912,"SELECT id
FROM person
WHERE(SELECT COUNT(*)
	FROM movie
	WHERE title='Psycho' AND production_year=1960)=1;",2018-08-31 18:29:02.762311+10,10,0,335,partially correct
12913,"select production_year, count(*)
from movie 
where production_year > 1990 and production_year < 1994
group by production_year;",2018-08-31 18:29:03.914546+10,2,1,225,correct
12914,"select ma.title,ma.production_year,p.first_name,p.last_name from movie_award ma, person p,director d 
where
lower(ma.category)='best film' 
and lower(ma.award_name)='bafta film award'
and lower(ma.result)='won'
and ma.title=d.title
and ma.production_year=d.production_year
and d.id=p.id;
",2018-08-31 18:29:04.353326+10,8,1,341,correct
12915,"select p.id,p.first_name,p.last_name
from (writer natural join director)as x,person p
where p.id =x.id
group by p.id
having count(*)>1;",2018-08-31 18:30:00.420054+10,4,1,293,correct
12916,select max(count(id)) from role group by description;,2018-08-31 18:30:57.381958+10,15,0,305,noninterpretable
12917,"select d.id,da.award_name,da.year_of_award,da.category
from director d, director_award da
where d.title=da.title
  and lower(da.result)='nominated'
  and d.id not in(
    select id
    from director_award da, director d
    where da.title=d.title
	and lower(da.result)='won');",2018-08-31 18:30:58.974673+10,13,1,355,correct
12918,"select count(*)
from director d 
where not exists ( select * from person p where p.id = d.id );",2018-08-31 18:31:08.15059+10,12,0,225,partially correct
12919,"select d.id,da.award_name,da.year_of_award,da.category
from director d, director_award da
where d.title=da.title
  and lower(da.result)='nominated'
  and d.id not in(
    select id
    from director_award da, director d
    where lower(da.result)='won');",2018-08-31 18:31:31.230951+10,13,0,355,partially correct
12920,"with peopleworkinthemovie as
(select x1.id, count(*) as noofworkedon
from (select d.id, title, production_year
from director d
union
select w.id, title, production_year
from writer w) x1
group by x1.id)

select id 
from peopleworkinthemovie p
where noofworkedon = (select max(noofworkedon)
from peopleworkinthemovie p2);",2018-08-31 18:31:48.998137+10,14,1,250,correct
12921,"select count(*)
from person p
where not exists ( select * from director d where p.id = d.id );",2018-08-31 18:31:51.797639+10,12,1,225,correct
12922,"select id,award_name,year_of_award,category from director_award natural join director where (title,production_year) in (select title,production_year from director_award where lower(result)='nominated'
except select title,production_year from director_award where lower(result)='won');",2018-08-31 18:32:16.213784+10,13,1,190,correct
12923,"select id
from ;",2018-08-31 18:32:43.824323+10,14,0,355,noninterpretable
12924,;,2018-08-31 18:33:59.0425+10,1,0,436,noninterpretable
12925,"SELECT COUNT(*)
FROM movie
WHERE NOT EXISTS(SELECT * FROM ;",2018-08-31 18:34:01.506305+10,11,0,335,noninterpretable
12926,;,2018-08-31 18:34:38.279619+10,2,0,436,noninterpretable
12927,SELECT 2;,2018-08-31 18:34:54.543819+10,14,0,45,noninterpretable
12928,;,2018-08-31 18:35:05.229065+10,12,0,436,noninterpretable
12929,"SELECT count(*)
FROM writer,person
Where person.id = writer.id AND person.year_born = 1935;",2018-08-31 18:35:08.352771+10,1,0,62,partially correct
12930,;,2018-08-31 18:35:28.544737+10,5,0,436,noninterpretable
12931,;,2018-08-31 18:35:49.469566+10,6,0,436,noninterpretable
12932,"select ma.title, ma.production_year, p.first_name, p.last_name 
from movie_award ma natural join director d natural join person p
where ma.award_name = 'BAFTA Film Award' and lower(ma.result) = 'won' and lower(ma.category) = 'best film';",2018-08-31 18:36:00.971877+10,8,1,194,correct
12933,;,2018-08-31 18:36:09.273008+10,7,0,436,noninterpretable
12934," select id from(select id,max(year_born) from person where year_born not in (select max(year_born)from person));",2018-08-31 18:36:26.625363+10,3,1,234,correct
12935,;,2018-08-31 18:36:29.881682+10,8,0,436,noninterpretable
12936,;,2018-08-31 18:36:47.7436+10,9,0,436,noninterpretable
12937,"SELECT id DESC
FROM person
WHERE (SELECT MAX(year_born)
	FROM person;",2018-08-31 18:37:10.095501+10,3,0,335,noninterpretable
12938,;,2018-08-31 18:37:10.489184+10,10,0,436,noninterpretable
12939,;,2018-08-31 18:37:28.933003+10,11,0,436,noninterpretable
12940,;,2018-08-31 18:37:31.42521+10,11,0,463,noninterpretable
12941,;,2018-08-31 18:37:46.356326+10,3,0,436,noninterpretable
12942,"SELECT count(DISTINCT id)
FROM (person NATURAL JOIN writer)
WHERE year_born=1935;",2018-08-31 18:37:52.726756+10,1,1,426,correct
12943,;,2018-08-31 18:38:03.338277+10,13,0,436,noninterpretable
12944,;,2018-08-31 18:38:14.159746+10,3,0,463,noninterpretable
12945,;,2018-08-31 18:38:20.944313+10,14,0,436,noninterpretable
12946,"SELECT p.first_name, p.last_name, r.title, r. production_year, r.description
FROM person p, role r, (SELECT id, COUNT(*) NoOfRoles
					FROM role
					GROUP BY id) a
WHERE p.id = r.id
	AND p.id = a.id
	AND a.NoOfRoles = (SELECT MAX (b.NoOfRoles) 
					FROM (SELECT id, COUNT(*) NoOfRoles
							FROM role
							GROUP BY id) b );",2018-08-31 18:38:21.455796+10,15,1,81,correct
12947,;,2018-08-31 18:38:47.228089+10,15,0,436,noninterpretable
12948,;,2018-08-31 18:38:52.107803+10,13,0,463,noninterpretable
12949,;,2018-08-31 18:39:29.680772+10,14,0,463,noninterpretable
12950,;,2018-08-31 18:40:10.555077+10,15,0,463,noninterpretable
12951,"SELECT id,award_name,year_of_award,category 
FROM director,movie_award
WHERE (SELECT COUNT(*)
	FROM movie_award;",2018-08-31 18:40:32.440603+10,13,0,335,noninterpretable
12952,"SELECT count(*) 
FROM person p 
WHERE EXISTS (SELECT * FROM writer w WHERE w.id = p.id AND p.year_born = 1935);",2018-08-31 18:40:48.200987+10,1,1,62,correct
12953,"SELECT
    p.first_name,
    p.last_name,
    r.title,
    r.production_year,
    r.description
FROM
    person p,
    ROLE r,
    (
        SELECT
            id,
            count(*) AS number_of_roles
        FROM
            ROLE
        GROUP BY
            id ) AS b
WHERE
    r.id = p.id
    AND p.id = b.id
    AND b.number_of_roles = (
        SELECT
            max(a.number_of_roles)
        FROM (
                SELECT
                    id,
                    count ( * ) AS number_of_roles
                FROM
                    ROLE
                GROUP BY
                    id ) AS a );",2018-08-31 18:43:27.926196+10,15,1,217,correct
12954,"SELECT *
FROM person;",2018-08-31 18:43:44.241867+10,15,0,45,partially correct
12955,"SELECT production_year,Count(*)
FROM Movie m
GROUP BY production_year
HAVING production_year = 1993 AND production_year = 1992 AND production_year = 1991;",2018-08-31 18:45:47.831461+10,2,0,62,partially correct
12956,"SELECT production_year,Count(*)
FROM Movie m
GROUP BY production_year
HAVING production_year > 1990 AND production_year < 1994;",2018-08-31 18:46:56.60904+10,2,1,62,correct
12957,"SELECT production_year,Count(*)
FROM Movie m
GROUP BY production_year
HAVING production_year > 1990 AND production_year < 1994;",2018-08-31 18:47:19.099754+10,2,1,62,correct
12958,"SELECT COUNT(*)
FROM (writer NATURAL JOIN person)w
WHERE w.year_born = '1935';",2018-08-31 19:04:10.221651+10,1,0,145,partially correct
12959,"SELECT
    r.id
FROM
    scene s,
    appearance a,
    ROLE r
WHERE
    s.title = a.title
    AND s.production_year = a.production_year
    AND s.scene_no = a.scene_no
    AND s.title = r.title
    AND s.production_year = r.production_year
    AND a.description = r.description
    AND lower(a.title) = 'psycho'
    AND a.production_year = 1960
GROUP BY
    r.id
HAVING
    count(*) = 1;",2018-08-31 19:07:43.495835+10,10,1,318,correct
12960,;,2018-08-31 19:08:08.605847+10,11,0,318,noninterpretable
12961,"select d.id, award_name, year_of_award, category from director_award a
natural join director d
where lower(a.result) <> 'won';",2018-08-31 19:08:33.742496+10,13,1,194,correct
12962,"SELECT count(*) 
FROM movie m 
WHERE not exists (
	SELECT title, production_year 
	FROM movie_award ma 
	WHERE lower(ma.result) = 'won' and ma.title = m.title and ma.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM crew_award ca 
	WHERE lower(ca.result) = 'won' and ca.title = m.title and ca.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM director_award da 
	WHERE lower(da.result) = 'won' and da.title = m.title and da.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM actor_award aa 
	WHERE lower(aa.result) = 'won' and aa.title = m.title and aa.production_year = m.production_year
	UNION
	SELECT title, production_year 
	FROM writer_award wa 
	WHERE lower(wa.result) = 'won' and wa.title = m.title and wa.production_year = m.production_year
);",2018-08-31 19:10:19.563071+10,11,1,318,correct
12963,;,2018-08-31 19:10:54.778866+10,3,0,318,noninterpretable
12964,"SELECT p.id 
FROM person p 
WHERE p.year_born = (SELECT MAX(year_born) 
	FROM person 
	WHERE year_born < (SELECT MAX(year_born) 
		FROM person));",2018-08-31 19:11:23.558788+10,3,1,318,correct
12965,"select p.first_name, p.last_name, r.title, r.production_year, r.description from 
role r natural join person p
where r.id in (
select q1.id from (
select id, count(*) as c from role group by id) as q1
where q1.c = 
(select max(q1.c) from (select id, count(*) as c from role group by id) as q1));",2018-08-31 19:12:17.55047+10,15,1,194,correct
12966,;,2018-08-31 19:12:22.441164+10,13,0,318,noninterpretable
